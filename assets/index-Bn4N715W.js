function RI(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const r=Object.getOwnPropertyDescriptor(s,a);r&&Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();var Ir=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ei(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Mk(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),n}var AI={exports:{}},cg={},OI={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ap=Symbol.for("react.element"),eF=Symbol.for("react.portal"),tF=Symbol.for("react.fragment"),nF=Symbol.for("react.strict_mode"),sF=Symbol.for("react.profiler"),aF=Symbol.for("react.provider"),rF=Symbol.for("react.context"),iF=Symbol.for("react.forward_ref"),oF=Symbol.for("react.suspense"),lF=Symbol.for("react.memo"),uF=Symbol.for("react.lazy"),H2=Symbol.iterator;function cF(t){return t===null||typeof t!="object"?null:(t=H2&&t[H2]||t["@@iterator"],typeof t=="function"?t:null)}var DI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jI=Object.assign,_I={};function pu(t,e,n){this.props=t,this.context=e,this.refs=_I,this.updater=n||DI}pu.prototype.isReactComponent={};pu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};pu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function FI(){}FI.prototype=pu.prototype;function Vk(t,e,n){this.props=t,this.context=e,this.refs=_I,this.updater=n||DI}var Wk=Vk.prototype=new FI;Wk.constructor=Vk;jI(Wk,pu.prototype);Wk.isPureReactComponent=!0;var K2=Array.isArray,PI=Object.prototype.hasOwnProperty,Uk={current:null},LI={key:!0,ref:!0,__self:!0,__source:!0};function BI(t,e,n){var s,a={},r=null,i=null;if(e!=null)for(s in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(r=""+e.key),e)PI.call(e,s)&&!LI.hasOwnProperty(s)&&(a[s]=e[s]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];a.children=l}if(t&&t.defaultProps)for(s in o=t.defaultProps,o)a[s]===void 0&&(a[s]=o[s]);return{$$typeof:ap,type:t,key:r,ref:i,props:a,_owner:Uk.current}}function dF(t,e){return{$$typeof:ap,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Gk(t){return typeof t=="object"&&t!==null&&t.$$typeof===ap}function pF(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var q2=/\/+/g;function K0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?pF(""+t.key):e.toString(36)}function Lf(t,e,n,s,a){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(r){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case ap:case eF:i=!0}}if(i)return i=t,a=a(i),t=s===""?"."+K0(i,0):s,K2(a)?(n="",t!=null&&(n=t.replace(q2,"$&/")+"/"),Lf(a,e,n,"",function(u){return u})):a!=null&&(Gk(a)&&(a=dF(a,n+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(q2,"$&/")+"/")+t)),e.push(a)),1;if(i=0,s=s===""?".":s+":",K2(t))for(var o=0;o<t.length;o++){r=t[o];var l=s+K0(r,o);i+=Lf(r,e,n,l,a)}else if(l=cF(t),typeof l=="function")for(t=l.call(t),o=0;!(r=t.next()).done;)r=r.value,l=s+K0(r,o++),i+=Lf(r,e,n,l,a);else if(r==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function af(t,e,n){if(t==null)return t;var s=[],a=0;return Lf(t,s,"","",function(r){return e.call(n,r,a++)}),s}function hF(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xn={current:null},Bf={transition:null},fF={ReactCurrentDispatcher:Xn,ReactCurrentBatchConfig:Bf,ReactCurrentOwner:Uk};function zI(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:af,forEach:function(t,e,n){af(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return af(t,function(){e++}),e},toArray:function(t){return af(t,function(e){return e})||[]},only:function(t){if(!Gk(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ve.Component=pu;Ve.Fragment=tF;Ve.Profiler=sF;Ve.PureComponent=Vk;Ve.StrictMode=nF;Ve.Suspense=oF;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fF;Ve.act=zI;Ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=jI({},t.props),a=t.key,r=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,i=Uk.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)PI.call(e,l)&&!LI.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:ap,type:t.type,key:a,ref:r,props:s,_owner:i}};Ve.createContext=function(t){return t={$$typeof:rF,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:aF,_context:t},t.Consumer=t};Ve.createElement=BI;Ve.createFactory=function(t){var e=BI.bind(null,t);return e.type=t,e};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(t){return{$$typeof:iF,render:t}};Ve.isValidElement=Gk;Ve.lazy=function(t){return{$$typeof:uF,_payload:{_status:-1,_result:t},_init:hF}};Ve.memo=function(t,e){return{$$typeof:lF,type:t,compare:e===void 0?null:e}};Ve.startTransition=function(t){var e=Bf.transition;Bf.transition={};try{t()}finally{Bf.transition=e}};Ve.unstable_act=zI;Ve.useCallback=function(t,e){return Xn.current.useCallback(t,e)};Ve.useContext=function(t){return Xn.current.useContext(t)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(t){return Xn.current.useDeferredValue(t)};Ve.useEffect=function(t,e){return Xn.current.useEffect(t,e)};Ve.useId=function(){return Xn.current.useId()};Ve.useImperativeHandle=function(t,e,n){return Xn.current.useImperativeHandle(t,e,n)};Ve.useInsertionEffect=function(t,e){return Xn.current.useInsertionEffect(t,e)};Ve.useLayoutEffect=function(t,e){return Xn.current.useLayoutEffect(t,e)};Ve.useMemo=function(t,e){return Xn.current.useMemo(t,e)};Ve.useReducer=function(t,e,n){return Xn.current.useReducer(t,e,n)};Ve.useRef=function(t){return Xn.current.useRef(t)};Ve.useState=function(t){return Xn.current.useState(t)};Ve.useSyncExternalStore=function(t,e,n){return Xn.current.useSyncExternalStore(t,e,n)};Ve.useTransition=function(){return Xn.current.useTransition()};Ve.version="18.3.1";OI.exports=Ve;var B=OI.exports;const Ee=Ei(B),mF=RI({__proto__:null,default:Ee},[B]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gF=B,yF=Symbol.for("react.element"),bF=Symbol.for("react.fragment"),wF=Object.prototype.hasOwnProperty,kF=gF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xF={key:!0,ref:!0,__self:!0,__source:!0};function MI(t,e,n){var s,a={},r=null,i=null;n!==void 0&&(r=""+n),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)wF.call(e,s)&&!xF.hasOwnProperty(s)&&(a[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)a[s]===void 0&&(a[s]=e[s]);return{$$typeof:yF,type:t,key:r,ref:i,props:a,_owner:kF.current}}cg.Fragment=bF;cg.jsx=MI;cg.jsxs=MI;AI.exports=cg;var N=AI.exports,VI={exports:{}},Rs={},WI={exports:{}},UI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,V){var q=j.length;j.push(V);e:for(;0<q;){var Y=q-1>>>1,Z=j[Y];if(0<a(Z,V))j[Y]=V,j[q]=Z,q=Y;else break e}}function n(j){return j.length===0?null:j[0]}function s(j){if(j.length===0)return null;var V=j[0],q=j.pop();if(q!==V){j[0]=q;e:for(var Y=0,Z=j.length,ne=Z>>>1;Y<ne;){var re=2*(Y+1)-1,ae=j[re],ce=re+1,we=j[ce];if(0>a(ae,q))ce<Z&&0>a(we,ae)?(j[Y]=we,j[ce]=q,Y=ce):(j[Y]=ae,j[re]=q,Y=re);else if(ce<Z&&0>a(we,q))j[Y]=we,j[ce]=q,Y=ce;else break e}}return V}function a(j,V){var q=j.sortIndex-V.sortIndex;return q!==0?q:j.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],u=[],c=1,d=null,p=3,h=!1,f=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(j){for(var V=n(u);V!==null;){if(V.callback===null)s(u);else if(V.startTime<=j)s(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function k(j){if(m=!1,w(j),!f)if(n(l)!==null)f=!0,H(x);else{var V=n(u);V!==null&&X(k,V.startTime-j)}}function x(j,V){f=!1,m&&(m=!1,g(T),T=-1),h=!0;var q=p;try{for(w(V),d=n(l);d!==null&&(!(d.expirationTime>V)||j&&!L());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,p=d.priorityLevel;var Z=Y(d.expirationTime<=V);V=t.unstable_now(),typeof Z=="function"?d.callback=Z:d===n(l)&&s(l),w(V)}else s(l);d=n(l)}if(d!==null)var ne=!0;else{var re=n(u);re!==null&&X(k,re.startTime-V),ne=!1}return ne}finally{d=null,p=q,h=!1}}var S=!1,C=null,T=-1,E=5,R=-1;function L(){return!(t.unstable_now()-R<E)}function U(){if(C!==null){var j=t.unstable_now();R=j;var V=!0;try{V=C(!0,j)}finally{V?G():(S=!1,C=null)}}else S=!1}var G;if(typeof b=="function")G=function(){b(U)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,z=F.port2;F.port1.onmessage=U,G=function(){z.postMessage(null)}}else G=function(){y(U,0)};function H(j){C=j,S||(S=!0,G())}function X(j,V){T=y(function(){j(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){f||h||(f=!0,H(x))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(j){switch(p){case 1:case 2:case 3:var V=3;break;default:V=p}var q=p;p=V;try{return j()}finally{p=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,V){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var q=p;p=j;try{return V()}finally{p=q}},t.unstable_scheduleCallback=function(j,V,q){var Y=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?Y+q:Y):q=Y,j){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=q+Z,j={id:c++,callback:V,priorityLevel:j,startTime:q,expirationTime:Z,sortIndex:-1},q>Y?(j.sortIndex=q,e(u,j),n(l)===null&&j===n(u)&&(m?(g(T),T=-1):m=!0,X(k,q-Y))):(j.sortIndex=Z,e(l,j),f||h||(f=!0,H(x))),j},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(j){var V=p;return function(){var q=p;p=V;try{return j.apply(this,arguments)}finally{p=q}}}})(UI);WI.exports=UI;var vF=WI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SF=B,Ts=vF;function se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GI=new Set,md={};function Mo(t,e){Bl(t,e),Bl(t+"Capture",e)}function Bl(t,e){for(md[t]=e,t=0;t<e.length;t++)GI.add(e[t])}var yr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vb=Object.prototype.hasOwnProperty,NF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,J2={},X2={};function CF(t){return Vb.call(X2,t)?!0:Vb.call(J2,t)?!1:NF.test(t)?X2[t]=!0:(J2[t]=!0,!1)}function IF(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function TF(t,e,n,s){if(e===null||typeof e>"u"||IF(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Yn(t,e,n,s,a,r,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=r,this.removeEmptyString=i}var xn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xn[t]=new Yn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xn[e]=new Yn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xn[t]=new Yn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xn[t]=new Yn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xn[t]=new Yn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xn[t]=new Yn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xn[t]=new Yn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xn[t]=new Yn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xn[t]=new Yn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Hk=/[\-:]([a-z])/g;function Kk(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Hk,Kk);xn[e]=new Yn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Hk,Kk);xn[e]=new Yn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Hk,Kk);xn[e]=new Yn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xn[t]=new Yn(t,1,!1,t.toLowerCase(),null,!1,!1)});xn.xlinkHref=new Yn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xn[t]=new Yn(t,1,!1,t.toLowerCase(),null,!0,!0)});function qk(t,e,n,s){var a=xn.hasOwnProperty(e)?xn[e]:null;(a!==null?a.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(TF(e,n,a,s)&&(n=null),s||a===null?CF(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,s=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var Tr=SF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,rf=Symbol.for("react.element"),fl=Symbol.for("react.portal"),ml=Symbol.for("react.fragment"),Jk=Symbol.for("react.strict_mode"),Wb=Symbol.for("react.profiler"),HI=Symbol.for("react.provider"),KI=Symbol.for("react.context"),Xk=Symbol.for("react.forward_ref"),Ub=Symbol.for("react.suspense"),Gb=Symbol.for("react.suspense_list"),Yk=Symbol.for("react.memo"),Wr=Symbol.for("react.lazy"),qI=Symbol.for("react.offscreen"),Y2=Symbol.iterator;function Rc(t){return t===null||typeof t!="object"?null:(t=Y2&&t[Y2]||t["@@iterator"],typeof t=="function"?t:null)}var Et=Object.assign,q0;function Kc(t){if(q0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);q0=e&&e[1]||""}return`
`+q0+t}var J0=!1;function X0(t,e){if(!t||J0)return"";J0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),r=s.stack.split(`
`),i=a.length-1,o=r.length-1;1<=i&&0<=o&&a[i]!==r[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==r[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==r[o]){var l=`
`+a[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{J0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Kc(t):""}function $F(t){switch(t.tag){case 5:return Kc(t.type);case 16:return Kc("Lazy");case 13:return Kc("Suspense");case 19:return Kc("SuspenseList");case 0:case 2:case 15:return t=X0(t.type,!1),t;case 11:return t=X0(t.type.render,!1),t;case 1:return t=X0(t.type,!0),t;default:return""}}function Hb(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ml:return"Fragment";case fl:return"Portal";case Wb:return"Profiler";case Jk:return"StrictMode";case Ub:return"Suspense";case Gb:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case KI:return(t.displayName||"Context")+".Consumer";case HI:return(t._context.displayName||"Context")+".Provider";case Xk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Yk:return e=t.displayName||null,e!==null?e:Hb(t.type)||"Memo";case Wr:e=t._payload,t=t._init;try{return Hb(t(e))}catch{}}return null}function EF(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hb(e);case 8:return e===Jk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function JI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function RF(t){var e=JI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,r=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(i){s=""+i,r.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function of(t){t._valueTracker||(t._valueTracker=RF(t))}function XI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=JI(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function nm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Kb(t,e){var n=e.checked;return Et({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Q2(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=hi(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function YI(t,e){e=e.checked,e!=null&&qk(t,"checked",e,!1)}function qb(t,e){YI(t,e);var n=hi(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Jb(t,e.type,n):e.hasOwnProperty("defaultValue")&&Jb(t,e.type,hi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Z2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Jb(t,e,n){(e!=="number"||nm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var qc=Array.isArray;function Tl(t,e,n,s){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&s&&(t[n].defaultSelected=!0)}else{for(n=""+hi(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,s&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function Xb(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(se(91));return Et({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function eS(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(se(92));if(qc(n)){if(1<n.length)throw Error(se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:hi(n)}}function QI(t,e){var n=hi(e.value),s=hi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function tS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ZI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yb(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ZI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var lf,eT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(lf=lf||document.createElement("div"),lf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=lf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function gd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ad={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AF=["Webkit","ms","Moz","O"];Object.keys(ad).forEach(function(t){AF.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ad[e]=ad[t]})});function tT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ad.hasOwnProperty(t)&&ad[t]?(""+e).trim():e+"px"}function nT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,a=tT(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,a):t[n]=a}}var OF=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qb(t,e){if(e){if(OF[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(se(62))}}function Zb(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ew=null;function Qk(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var tw=null,$l=null,El=null;function nS(t){if(t=op(t)){if(typeof tw!="function")throw Error(se(280));var e=t.stateNode;e&&(e=mg(e),tw(t.stateNode,t.type,e))}}function sT(t){$l?El?El.push(t):El=[t]:$l=t}function aT(){if($l){var t=$l,e=El;if(El=$l=null,nS(t),e)for(t=0;t<e.length;t++)nS(e[t])}}function rT(t,e){return t(e)}function iT(){}var Y0=!1;function oT(t,e,n){if(Y0)return t(e,n);Y0=!0;try{return rT(t,e,n)}finally{Y0=!1,($l!==null||El!==null)&&(iT(),aT())}}function yd(t,e){var n=t.stateNode;if(n===null)return null;var s=mg(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(se(231,e,typeof n));return n}var nw=!1;if(yr)try{var Ac={};Object.defineProperty(Ac,"passive",{get:function(){nw=!0}}),window.addEventListener("test",Ac,Ac),window.removeEventListener("test",Ac,Ac)}catch{nw=!1}function DF(t,e,n,s,a,r,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var rd=!1,sm=null,am=!1,sw=null,jF={onError:function(t){rd=!0,sm=t}};function _F(t,e,n,s,a,r,i,o,l){rd=!1,sm=null,DF.apply(jF,arguments)}function FF(t,e,n,s,a,r,i,o,l){if(_F.apply(this,arguments),rd){if(rd){var u=sm;rd=!1,sm=null}else throw Error(se(198));am||(am=!0,sw=u)}}function Vo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function lT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function sS(t){if(Vo(t)!==t)throw Error(se(188))}function PF(t){var e=t.alternate;if(!e){if(e=Vo(t),e===null)throw Error(se(188));return e!==t?null:t}for(var n=t,s=e;;){var a=n.return;if(a===null)break;var r=a.alternate;if(r===null){if(s=a.return,s!==null){n=s;continue}break}if(a.child===r.child){for(r=a.child;r;){if(r===n)return sS(a),t;if(r===s)return sS(a),e;r=r.sibling}throw Error(se(188))}if(n.return!==s.return)n=a,s=r;else{for(var i=!1,o=a.child;o;){if(o===n){i=!0,n=a,s=r;break}if(o===s){i=!0,s=a,n=r;break}o=o.sibling}if(!i){for(o=r.child;o;){if(o===n){i=!0,n=r,s=a;break}if(o===s){i=!0,s=r,n=a;break}o=o.sibling}if(!i)throw Error(se(189))}}if(n.alternate!==s)throw Error(se(190))}if(n.tag!==3)throw Error(se(188));return n.stateNode.current===n?t:e}function uT(t){return t=PF(t),t!==null?cT(t):null}function cT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=cT(t);if(e!==null)return e;t=t.sibling}return null}var dT=Ts.unstable_scheduleCallback,aS=Ts.unstable_cancelCallback,LF=Ts.unstable_shouldYield,BF=Ts.unstable_requestPaint,Pt=Ts.unstable_now,zF=Ts.unstable_getCurrentPriorityLevel,Zk=Ts.unstable_ImmediatePriority,pT=Ts.unstable_UserBlockingPriority,rm=Ts.unstable_NormalPriority,MF=Ts.unstable_LowPriority,hT=Ts.unstable_IdlePriority,dg=null,Ma=null;function VF(t){if(Ma&&typeof Ma.onCommitFiberRoot=="function")try{Ma.onCommitFiberRoot(dg,t,void 0,(t.current.flags&128)===128)}catch{}}var ha=Math.clz32?Math.clz32:GF,WF=Math.log,UF=Math.LN2;function GF(t){return t>>>=0,t===0?32:31-(WF(t)/UF|0)|0}var uf=64,cf=4194304;function Jc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function im(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,a=t.suspendedLanes,r=t.pingedLanes,i=n&268435455;if(i!==0){var o=i&~a;o!==0?s=Jc(o):(r&=i,r!==0&&(s=Jc(r)))}else i=n&~a,i!==0?s=Jc(i):r!==0&&(s=Jc(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&a)&&(a=s&-s,r=e&-e,a>=r||a===16&&(r&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-ha(e),a=1<<n,s|=t[n],e&=~a;return s}function HF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function KF(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,a=t.expirationTimes,r=t.pendingLanes;0<r;){var i=31-ha(r),o=1<<i,l=a[i];l===-1?(!(o&n)||o&s)&&(a[i]=HF(o,e)):l<=e&&(t.expiredLanes|=o),r&=~o}}function aw(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function fT(){var t=uf;return uf<<=1,!(uf&4194240)&&(uf=64),t}function Q0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function rp(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ha(e),t[e]=n}function qF(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-ha(n),r=1<<a;e[a]=0,s[a]=-1,t[a]=-1,n&=~r}}function ex(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-ha(n),a=1<<s;a&e|t[s]&e&&(t[s]|=e),n&=~a}}var tt=0;function mT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var gT,tx,yT,bT,wT,rw=!1,df=[],ti=null,ni=null,si=null,bd=new Map,wd=new Map,Hr=[],JF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rS(t,e){switch(t){case"focusin":case"focusout":ti=null;break;case"dragenter":case"dragleave":ni=null;break;case"mouseover":case"mouseout":si=null;break;case"pointerover":case"pointerout":bd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":wd.delete(e.pointerId)}}function Oc(t,e,n,s,a,r){return t===null||t.nativeEvent!==r?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:r,targetContainers:[a]},e!==null&&(e=op(e),e!==null&&tx(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function XF(t,e,n,s,a){switch(e){case"focusin":return ti=Oc(ti,t,e,n,s,a),!0;case"dragenter":return ni=Oc(ni,t,e,n,s,a),!0;case"mouseover":return si=Oc(si,t,e,n,s,a),!0;case"pointerover":var r=a.pointerId;return bd.set(r,Oc(bd.get(r)||null,t,e,n,s,a)),!0;case"gotpointercapture":return r=a.pointerId,wd.set(r,Oc(wd.get(r)||null,t,e,n,s,a)),!0}return!1}function kT(t){var e=ro(t.target);if(e!==null){var n=Vo(e);if(n!==null){if(e=n.tag,e===13){if(e=lT(n),e!==null){t.blockedOn=e,wT(t.priority,function(){yT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function zf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=iw(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);ew=s,n.target.dispatchEvent(s),ew=null}else return e=op(n),e!==null&&tx(e),t.blockedOn=n,!1;e.shift()}return!0}function iS(t,e,n){zf(t)&&n.delete(e)}function YF(){rw=!1,ti!==null&&zf(ti)&&(ti=null),ni!==null&&zf(ni)&&(ni=null),si!==null&&zf(si)&&(si=null),bd.forEach(iS),wd.forEach(iS)}function Dc(t,e){t.blockedOn===e&&(t.blockedOn=null,rw||(rw=!0,Ts.unstable_scheduleCallback(Ts.unstable_NormalPriority,YF)))}function kd(t){function e(a){return Dc(a,t)}if(0<df.length){Dc(df[0],t);for(var n=1;n<df.length;n++){var s=df[n];s.blockedOn===t&&(s.blockedOn=null)}}for(ti!==null&&Dc(ti,t),ni!==null&&Dc(ni,t),si!==null&&Dc(si,t),bd.forEach(e),wd.forEach(e),n=0;n<Hr.length;n++)s=Hr[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Hr.length&&(n=Hr[0],n.blockedOn===null);)kT(n),n.blockedOn===null&&Hr.shift()}var Rl=Tr.ReactCurrentBatchConfig,om=!0;function QF(t,e,n,s){var a=tt,r=Rl.transition;Rl.transition=null;try{tt=1,nx(t,e,n,s)}finally{tt=a,Rl.transition=r}}function ZF(t,e,n,s){var a=tt,r=Rl.transition;Rl.transition=null;try{tt=4,nx(t,e,n,s)}finally{tt=a,Rl.transition=r}}function nx(t,e,n,s){if(om){var a=iw(t,e,n,s);if(a===null)lb(t,e,s,lm,n),rS(t,s);else if(XF(a,t,e,n,s))s.stopPropagation();else if(rS(t,s),e&4&&-1<JF.indexOf(t)){for(;a!==null;){var r=op(a);if(r!==null&&gT(r),r=iw(t,e,n,s),r===null&&lb(t,e,s,lm,n),r===a)break;a=r}a!==null&&s.stopPropagation()}else lb(t,e,s,null,n)}}var lm=null;function iw(t,e,n,s){if(lm=null,t=Qk(s),t=ro(t),t!==null)if(e=Vo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=lT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return lm=t,null}function xT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zF()){case Zk:return 1;case pT:return 4;case rm:case MF:return 16;case hT:return 536870912;default:return 16}default:return 16}}var Jr=null,sx=null,Mf=null;function vT(){if(Mf)return Mf;var t,e=sx,n=e.length,s,a="value"in Jr?Jr.value:Jr.textContent,r=a.length;for(t=0;t<n&&e[t]===a[t];t++);var i=n-t;for(s=1;s<=i&&e[n-s]===a[r-s];s++);return Mf=a.slice(t,1<s?1-s:void 0)}function Vf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function pf(){return!0}function oS(){return!1}function As(t){function e(n,s,a,r,i){this._reactName=n,this._targetInst=a,this.type=s,this.nativeEvent=r,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?pf:oS,this.isPropagationStopped=oS,this}return Et(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=pf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=pf)},persist:function(){},isPersistent:pf}),e}var hu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ax=As(hu),ip=Et({},hu,{view:0,detail:0}),eP=As(ip),Z0,eb,jc,pg=Et({},ip,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==jc&&(jc&&t.type==="mousemove"?(Z0=t.screenX-jc.screenX,eb=t.screenY-jc.screenY):eb=Z0=0,jc=t),Z0)},movementY:function(t){return"movementY"in t?t.movementY:eb}}),lS=As(pg),tP=Et({},pg,{dataTransfer:0}),nP=As(tP),sP=Et({},ip,{relatedTarget:0}),tb=As(sP),aP=Et({},hu,{animationName:0,elapsedTime:0,pseudoElement:0}),rP=As(aP),iP=Et({},hu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),oP=As(iP),lP=Et({},hu,{data:0}),uS=As(lP),uP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=dP[t])?!!e[t]:!1}function rx(){return pP}var hP=Et({},ip,{key:function(t){if(t.key){var e=uP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Vf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?cP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rx,charCode:function(t){return t.type==="keypress"?Vf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Vf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),fP=As(hP),mP=Et({},pg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cS=As(mP),gP=Et({},ip,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rx}),yP=As(gP),bP=Et({},hu,{propertyName:0,elapsedTime:0,pseudoElement:0}),wP=As(bP),kP=Et({},pg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xP=As(kP),vP=[9,13,27,32],ix=yr&&"CompositionEvent"in window,id=null;yr&&"documentMode"in document&&(id=document.documentMode);var SP=yr&&"TextEvent"in window&&!id,ST=yr&&(!ix||id&&8<id&&11>=id),dS=" ",pS=!1;function NT(t,e){switch(t){case"keyup":return vP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function CT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var gl=!1;function NP(t,e){switch(t){case"compositionend":return CT(e);case"keypress":return e.which!==32?null:(pS=!0,dS);case"textInput":return t=e.data,t===dS&&pS?null:t;default:return null}}function CP(t,e){if(gl)return t==="compositionend"||!ix&&NT(t,e)?(t=vT(),Mf=sx=Jr=null,gl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ST&&e.locale!=="ko"?null:e.data;default:return null}}var IP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!IP[t.type]:e==="textarea"}function IT(t,e,n,s){sT(s),e=um(e,"onChange"),0<e.length&&(n=new ax("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var od=null,xd=null;function TP(t){PT(t,0)}function hg(t){var e=wl(t);if(XI(e))return t}function $P(t,e){if(t==="change")return e}var TT=!1;if(yr){var nb;if(yr){var sb="oninput"in document;if(!sb){var fS=document.createElement("div");fS.setAttribute("oninput","return;"),sb=typeof fS.oninput=="function"}nb=sb}else nb=!1;TT=nb&&(!document.documentMode||9<document.documentMode)}function mS(){od&&(od.detachEvent("onpropertychange",$T),xd=od=null)}function $T(t){if(t.propertyName==="value"&&hg(xd)){var e=[];IT(e,xd,t,Qk(t)),oT(TP,e)}}function EP(t,e,n){t==="focusin"?(mS(),od=e,xd=n,od.attachEvent("onpropertychange",$T)):t==="focusout"&&mS()}function RP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return hg(xd)}function AP(t,e){if(t==="click")return hg(e)}function OP(t,e){if(t==="input"||t==="change")return hg(e)}function DP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ba=typeof Object.is=="function"?Object.is:DP;function vd(t,e){if(ba(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!Vb.call(e,a)||!ba(t[a],e[a]))return!1}return!0}function gS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function yS(t,e){var n=gS(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=gS(n)}}function ET(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ET(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function RT(){for(var t=window,e=nm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=nm(t.document)}return e}function ox(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function jP(t){var e=RT(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ET(n.ownerDocument.documentElement,n)){if(s!==null&&ox(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,r=Math.min(s.start,a);s=s.end===void 0?r:Math.min(s.end,a),!t.extend&&r>s&&(a=s,s=r,r=a),a=yS(n,r);var i=yS(n,s);a&&i&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),r>s?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var _P=yr&&"documentMode"in document&&11>=document.documentMode,yl=null,ow=null,ld=null,lw=!1;function bS(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;lw||yl==null||yl!==nm(s)||(s=yl,"selectionStart"in s&&ox(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),ld&&vd(ld,s)||(ld=s,s=um(ow,"onSelect"),0<s.length&&(e=new ax("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=yl)))}function hf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var bl={animationend:hf("Animation","AnimationEnd"),animationiteration:hf("Animation","AnimationIteration"),animationstart:hf("Animation","AnimationStart"),transitionend:hf("Transition","TransitionEnd")},ab={},AT={};yr&&(AT=document.createElement("div").style,"AnimationEvent"in window||(delete bl.animationend.animation,delete bl.animationiteration.animation,delete bl.animationstart.animation),"TransitionEvent"in window||delete bl.transitionend.transition);function fg(t){if(ab[t])return ab[t];if(!bl[t])return t;var e=bl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in AT)return ab[t]=e[n];return t}var OT=fg("animationend"),DT=fg("animationiteration"),jT=fg("animationstart"),_T=fg("transitionend"),FT=new Map,wS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ri(t,e){FT.set(t,e),Mo(e,[t])}for(var rb=0;rb<wS.length;rb++){var ib=wS[rb],FP=ib.toLowerCase(),PP=ib[0].toUpperCase()+ib.slice(1);Ri(FP,"on"+PP)}Ri(OT,"onAnimationEnd");Ri(DT,"onAnimationIteration");Ri(jT,"onAnimationStart");Ri("dblclick","onDoubleClick");Ri("focusin","onFocus");Ri("focusout","onBlur");Ri(_T,"onTransitionEnd");Bl("onMouseEnter",["mouseout","mouseover"]);Bl("onMouseLeave",["mouseout","mouseover"]);Bl("onPointerEnter",["pointerout","pointerover"]);Bl("onPointerLeave",["pointerout","pointerover"]);Mo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xc));function kS(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,FF(s,e,void 0,t),t.currentTarget=null}function PT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],a=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var i=s.length-1;0<=i;i--){var o=s[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==r&&a.isPropagationStopped())break e;kS(a,o,u),r=l}else for(i=0;i<s.length;i++){if(o=s[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==r&&a.isPropagationStopped())break e;kS(a,o,u),r=l}}}if(am)throw t=sw,am=!1,sw=null,t}function ht(t,e){var n=e[hw];n===void 0&&(n=e[hw]=new Set);var s=t+"__bubble";n.has(s)||(LT(e,t,2,!1),n.add(s))}function ob(t,e,n){var s=0;e&&(s|=4),LT(n,t,s,e)}var ff="_reactListening"+Math.random().toString(36).slice(2);function Sd(t){if(!t[ff]){t[ff]=!0,GI.forEach(function(n){n!=="selectionchange"&&(LP.has(n)||ob(n,!1,t),ob(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ff]||(e[ff]=!0,ob("selectionchange",!1,e))}}function LT(t,e,n,s){switch(xT(e)){case 1:var a=QF;break;case 4:a=ZF;break;default:a=nx}n=a.bind(null,e,n,t),a=void 0,!nw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),s?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function lb(t,e,n,s,a){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var o=s.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=s.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=ro(o),i===null)return;if(l=i.tag,l===5||l===6){s=r=i;continue e}o=o.parentNode}}s=s.return}oT(function(){var u=r,c=Qk(n),d=[];e:{var p=FT.get(t);if(p!==void 0){var h=ax,f=t;switch(t){case"keypress":if(Vf(n)===0)break e;case"keydown":case"keyup":h=fP;break;case"focusin":f="focus",h=tb;break;case"focusout":f="blur",h=tb;break;case"beforeblur":case"afterblur":h=tb;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=lS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=nP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=yP;break;case OT:case DT:case jT:h=rP;break;case _T:h=wP;break;case"scroll":h=eP;break;case"wheel":h=xP;break;case"copy":case"cut":case"paste":h=oP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=cS}var m=(e&4)!==0,y=!m&&t==="scroll",g=m?p!==null?p+"Capture":null:p;m=[];for(var b=u,w;b!==null;){w=b;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,g!==null&&(k=yd(b,g),k!=null&&m.push(Nd(b,k,w)))),y)break;b=b.return}0<m.length&&(p=new h(p,f,null,n,c),d.push({event:p,listeners:m}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",p&&n!==ew&&(f=n.relatedTarget||n.fromElement)&&(ro(f)||f[br]))break e;if((h||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,h?(f=n.relatedTarget||n.toElement,h=u,f=f?ro(f):null,f!==null&&(y=Vo(f),f!==y||f.tag!==5&&f.tag!==6)&&(f=null)):(h=null,f=u),h!==f)){if(m=lS,k="onMouseLeave",g="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(m=cS,k="onPointerLeave",g="onPointerEnter",b="pointer"),y=h==null?p:wl(h),w=f==null?p:wl(f),p=new m(k,b+"leave",h,n,c),p.target=y,p.relatedTarget=w,k=null,ro(c)===u&&(m=new m(g,b+"enter",f,n,c),m.target=w,m.relatedTarget=y,k=m),y=k,h&&f)t:{for(m=h,g=f,b=0,w=m;w;w=ll(w))b++;for(w=0,k=g;k;k=ll(k))w++;for(;0<b-w;)m=ll(m),b--;for(;0<w-b;)g=ll(g),w--;for(;b--;){if(m===g||g!==null&&m===g.alternate)break t;m=ll(m),g=ll(g)}m=null}else m=null;h!==null&&xS(d,p,h,m,!1),f!==null&&y!==null&&xS(d,y,f,m,!0)}}e:{if(p=u?wl(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var x=$P;else if(hS(p))if(TT)x=OP;else{x=RP;var S=EP}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(x=AP);if(x&&(x=x(t,u))){IT(d,x,n,c);break e}S&&S(t,p,u),t==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&Jb(p,"number",p.value)}switch(S=u?wl(u):window,t){case"focusin":(hS(S)||S.contentEditable==="true")&&(yl=S,ow=u,ld=null);break;case"focusout":ld=ow=yl=null;break;case"mousedown":lw=!0;break;case"contextmenu":case"mouseup":case"dragend":lw=!1,bS(d,n,c);break;case"selectionchange":if(_P)break;case"keydown":case"keyup":bS(d,n,c)}var C;if(ix)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else gl?NT(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(ST&&n.locale!=="ko"&&(gl||T!=="onCompositionStart"?T==="onCompositionEnd"&&gl&&(C=vT()):(Jr=c,sx="value"in Jr?Jr.value:Jr.textContent,gl=!0)),S=um(u,T),0<S.length&&(T=new uS(T,t,null,n,c),d.push({event:T,listeners:S}),C?T.data=C:(C=CT(n),C!==null&&(T.data=C)))),(C=SP?NP(t,n):CP(t,n))&&(u=um(u,"onBeforeInput"),0<u.length&&(c=new uS("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=C))}PT(d,e)})}function Nd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function um(t,e){for(var n=e+"Capture",s=[];t!==null;){var a=t,r=a.stateNode;a.tag===5&&r!==null&&(a=r,r=yd(t,n),r!=null&&s.unshift(Nd(t,r,a)),r=yd(t,e),r!=null&&s.push(Nd(t,r,a))),t=t.return}return s}function ll(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function xS(t,e,n,s,a){for(var r=e._reactName,i=[];n!==null&&n!==s;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===s)break;o.tag===5&&u!==null&&(o=u,a?(l=yd(n,r),l!=null&&i.unshift(Nd(n,l,o))):a||(l=yd(n,r),l!=null&&i.push(Nd(n,l,o)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var BP=/\r\n?/g,zP=/\u0000|\uFFFD/g;function vS(t){return(typeof t=="string"?t:""+t).replace(BP,`
`).replace(zP,"")}function mf(t,e,n){if(e=vS(e),vS(t)!==e&&n)throw Error(se(425))}function cm(){}var uw=null,cw=null;function dw(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var pw=typeof setTimeout=="function"?setTimeout:void 0,MP=typeof clearTimeout=="function"?clearTimeout:void 0,SS=typeof Promise=="function"?Promise:void 0,VP=typeof queueMicrotask=="function"?queueMicrotask:typeof SS<"u"?function(t){return SS.resolve(null).then(t).catch(WP)}:pw;function WP(t){setTimeout(function(){throw t})}function ub(t,e){var n=e,s=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(s===0){t.removeChild(a),kd(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=a}while(n);kd(e)}function ai(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function NS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var fu=Math.random().toString(36).slice(2),Fa="__reactFiber$"+fu,Cd="__reactProps$"+fu,br="__reactContainer$"+fu,hw="__reactEvents$"+fu,UP="__reactListeners$"+fu,GP="__reactHandles$"+fu;function ro(t){var e=t[Fa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[br]||n[Fa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=NS(t);t!==null;){if(n=t[Fa])return n;t=NS(t)}return e}t=n,n=t.parentNode}return null}function op(t){return t=t[Fa]||t[br],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function wl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(se(33))}function mg(t){return t[Cd]||null}var fw=[],kl=-1;function Ai(t){return{current:t}}function ft(t){0>kl||(t.current=fw[kl],fw[kl]=null,kl--)}function ut(t,e){kl++,fw[kl]=t.current,t.current=e}var fi={},jn=Ai(fi),ls=Ai(!1),ko=fi;function zl(t,e){var n=t.type.contextTypes;if(!n)return fi;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var a={},r;for(r in n)a[r]=e[r];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function us(t){return t=t.childContextTypes,t!=null}function dm(){ft(ls),ft(jn)}function CS(t,e,n){if(jn.current!==fi)throw Error(se(168));ut(jn,e),ut(ls,n)}function BT(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var a in s)if(!(a in e))throw Error(se(108,EF(t)||"Unknown",a));return Et({},n,s)}function pm(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||fi,ko=jn.current,ut(jn,t),ut(ls,ls.current),!0}function IS(t,e,n){var s=t.stateNode;if(!s)throw Error(se(169));n?(t=BT(t,e,ko),s.__reactInternalMemoizedMergedChildContext=t,ft(ls),ft(jn),ut(jn,t)):ft(ls),ut(ls,n)}var ir=null,gg=!1,cb=!1;function zT(t){ir===null?ir=[t]:ir.push(t)}function HP(t){gg=!0,zT(t)}function Oi(){if(!cb&&ir!==null){cb=!0;var t=0,e=tt;try{var n=ir;for(tt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}ir=null,gg=!1}catch(a){throw ir!==null&&(ir=ir.slice(t+1)),dT(Zk,Oi),a}finally{tt=e,cb=!1}}return null}var xl=[],vl=0,hm=null,fm=0,Ps=[],Ls=0,xo=null,pr=1,hr="";function Xi(t,e){xl[vl++]=fm,xl[vl++]=hm,hm=t,fm=e}function MT(t,e,n){Ps[Ls++]=pr,Ps[Ls++]=hr,Ps[Ls++]=xo,xo=t;var s=pr;t=hr;var a=32-ha(s)-1;s&=~(1<<a),n+=1;var r=32-ha(e)+a;if(30<r){var i=a-a%5;r=(s&(1<<i)-1).toString(32),s>>=i,a-=i,pr=1<<32-ha(e)+a|n<<a|s,hr=r+t}else pr=1<<r|n<<a|s,hr=t}function lx(t){t.return!==null&&(Xi(t,1),MT(t,1,0))}function ux(t){for(;t===hm;)hm=xl[--vl],xl[vl]=null,fm=xl[--vl],xl[vl]=null;for(;t===xo;)xo=Ps[--Ls],Ps[Ls]=null,hr=Ps[--Ls],Ps[Ls]=null,pr=Ps[--Ls],Ps[Ls]=null}var Ns=null,xs=null,kt=!1,oa=null;function VT(t,e){var n=Bs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function TS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ns=t,xs=ai(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ns=t,xs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xo!==null?{id:pr,overflow:hr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Bs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ns=t,xs=null,!0):!1;default:return!1}}function mw(t){return(t.mode&1)!==0&&(t.flags&128)===0}function gw(t){if(kt){var e=xs;if(e){var n=e;if(!TS(t,e)){if(mw(t))throw Error(se(418));e=ai(n.nextSibling);var s=Ns;e&&TS(t,e)?VT(s,n):(t.flags=t.flags&-4097|2,kt=!1,Ns=t)}}else{if(mw(t))throw Error(se(418));t.flags=t.flags&-4097|2,kt=!1,Ns=t}}}function $S(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ns=t}function gf(t){if(t!==Ns)return!1;if(!kt)return $S(t),kt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!dw(t.type,t.memoizedProps)),e&&(e=xs)){if(mw(t))throw WT(),Error(se(418));for(;e;)VT(t,e),e=ai(e.nextSibling)}if($S(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){xs=ai(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}xs=null}}else xs=Ns?ai(t.stateNode.nextSibling):null;return!0}function WT(){for(var t=xs;t;)t=ai(t.nextSibling)}function Ml(){xs=Ns=null,kt=!1}function cx(t){oa===null?oa=[t]:oa.push(t)}var KP=Tr.ReactCurrentBatchConfig;function _c(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(se(309));var s=n.stateNode}if(!s)throw Error(se(147,t));var a=s,r=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(i){var o=a.refs;i===null?delete o[r]:o[r]=i},e._stringRef=r,e)}if(typeof t!="string")throw Error(se(284));if(!n._owner)throw Error(se(290,t))}return t}function yf(t,e){throw t=Object.prototype.toString.call(e),Error(se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function ES(t){var e=t._init;return e(t._payload)}function UT(t){function e(g,b){if(t){var w=g.deletions;w===null?(g.deletions=[b],g.flags|=16):w.push(b)}}function n(g,b){if(!t)return null;for(;b!==null;)e(g,b),b=b.sibling;return null}function s(g,b){for(g=new Map;b!==null;)b.key!==null?g.set(b.key,b):g.set(b.index,b),b=b.sibling;return g}function a(g,b){return g=li(g,b),g.index=0,g.sibling=null,g}function r(g,b,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<b?(g.flags|=2,b):w):(g.flags|=2,b)):(g.flags|=1048576,b)}function i(g){return t&&g.alternate===null&&(g.flags|=2),g}function o(g,b,w,k){return b===null||b.tag!==6?(b=yb(w,g.mode,k),b.return=g,b):(b=a(b,w),b.return=g,b)}function l(g,b,w,k){var x=w.type;return x===ml?c(g,b,w.props.children,k,w.key):b!==null&&(b.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Wr&&ES(x)===b.type)?(k=a(b,w.props),k.ref=_c(g,b,w),k.return=g,k):(k=Jf(w.type,w.key,w.props,null,g.mode,k),k.ref=_c(g,b,w),k.return=g,k)}function u(g,b,w,k){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=bb(w,g.mode,k),b.return=g,b):(b=a(b,w.children||[]),b.return=g,b)}function c(g,b,w,k,x){return b===null||b.tag!==7?(b=fo(w,g.mode,k,x),b.return=g,b):(b=a(b,w),b.return=g,b)}function d(g,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=yb(""+b,g.mode,w),b.return=g,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case rf:return w=Jf(b.type,b.key,b.props,null,g.mode,w),w.ref=_c(g,null,b),w.return=g,w;case fl:return b=bb(b,g.mode,w),b.return=g,b;case Wr:var k=b._init;return d(g,k(b._payload),w)}if(qc(b)||Rc(b))return b=fo(b,g.mode,w,null),b.return=g,b;yf(g,b)}return null}function p(g,b,w,k){var x=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return x!==null?null:o(g,b,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case rf:return w.key===x?l(g,b,w,k):null;case fl:return w.key===x?u(g,b,w,k):null;case Wr:return x=w._init,p(g,b,x(w._payload),k)}if(qc(w)||Rc(w))return x!==null?null:c(g,b,w,k,null);yf(g,w)}return null}function h(g,b,w,k,x){if(typeof k=="string"&&k!==""||typeof k=="number")return g=g.get(w)||null,o(b,g,""+k,x);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case rf:return g=g.get(k.key===null?w:k.key)||null,l(b,g,k,x);case fl:return g=g.get(k.key===null?w:k.key)||null,u(b,g,k,x);case Wr:var S=k._init;return h(g,b,w,S(k._payload),x)}if(qc(k)||Rc(k))return g=g.get(w)||null,c(b,g,k,x,null);yf(b,k)}return null}function f(g,b,w,k){for(var x=null,S=null,C=b,T=b=0,E=null;C!==null&&T<w.length;T++){C.index>T?(E=C,C=null):E=C.sibling;var R=p(g,C,w[T],k);if(R===null){C===null&&(C=E);break}t&&C&&R.alternate===null&&e(g,C),b=r(R,b,T),S===null?x=R:S.sibling=R,S=R,C=E}if(T===w.length)return n(g,C),kt&&Xi(g,T),x;if(C===null){for(;T<w.length;T++)C=d(g,w[T],k),C!==null&&(b=r(C,b,T),S===null?x=C:S.sibling=C,S=C);return kt&&Xi(g,T),x}for(C=s(g,C);T<w.length;T++)E=h(C,g,T,w[T],k),E!==null&&(t&&E.alternate!==null&&C.delete(E.key===null?T:E.key),b=r(E,b,T),S===null?x=E:S.sibling=E,S=E);return t&&C.forEach(function(L){return e(g,L)}),kt&&Xi(g,T),x}function m(g,b,w,k){var x=Rc(w);if(typeof x!="function")throw Error(se(150));if(w=x.call(w),w==null)throw Error(se(151));for(var S=x=null,C=b,T=b=0,E=null,R=w.next();C!==null&&!R.done;T++,R=w.next()){C.index>T?(E=C,C=null):E=C.sibling;var L=p(g,C,R.value,k);if(L===null){C===null&&(C=E);break}t&&C&&L.alternate===null&&e(g,C),b=r(L,b,T),S===null?x=L:S.sibling=L,S=L,C=E}if(R.done)return n(g,C),kt&&Xi(g,T),x;if(C===null){for(;!R.done;T++,R=w.next())R=d(g,R.value,k),R!==null&&(b=r(R,b,T),S===null?x=R:S.sibling=R,S=R);return kt&&Xi(g,T),x}for(C=s(g,C);!R.done;T++,R=w.next())R=h(C,g,T,R.value,k),R!==null&&(t&&R.alternate!==null&&C.delete(R.key===null?T:R.key),b=r(R,b,T),S===null?x=R:S.sibling=R,S=R);return t&&C.forEach(function(U){return e(g,U)}),kt&&Xi(g,T),x}function y(g,b,w,k){if(typeof w=="object"&&w!==null&&w.type===ml&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case rf:e:{for(var x=w.key,S=b;S!==null;){if(S.key===x){if(x=w.type,x===ml){if(S.tag===7){n(g,S.sibling),b=a(S,w.props.children),b.return=g,g=b;break e}}else if(S.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Wr&&ES(x)===S.type){n(g,S.sibling),b=a(S,w.props),b.ref=_c(g,S,w),b.return=g,g=b;break e}n(g,S);break}else e(g,S);S=S.sibling}w.type===ml?(b=fo(w.props.children,g.mode,k,w.key),b.return=g,g=b):(k=Jf(w.type,w.key,w.props,null,g.mode,k),k.ref=_c(g,b,w),k.return=g,g=k)}return i(g);case fl:e:{for(S=w.key;b!==null;){if(b.key===S)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){n(g,b.sibling),b=a(b,w.children||[]),b.return=g,g=b;break e}else{n(g,b);break}else e(g,b);b=b.sibling}b=bb(w,g.mode,k),b.return=g,g=b}return i(g);case Wr:return S=w._init,y(g,b,S(w._payload),k)}if(qc(w))return f(g,b,w,k);if(Rc(w))return m(g,b,w,k);yf(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(n(g,b.sibling),b=a(b,w),b.return=g,g=b):(n(g,b),b=yb(w,g.mode,k),b.return=g,g=b),i(g)):n(g,b)}return y}var Vl=UT(!0),GT=UT(!1),mm=Ai(null),gm=null,Sl=null,dx=null;function px(){dx=Sl=gm=null}function hx(t){var e=mm.current;ft(mm),t._currentValue=e}function yw(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Al(t,e){gm=t,dx=Sl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rs=!0),t.firstContext=null)}function qs(t){var e=t._currentValue;if(dx!==t)if(t={context:t,memoizedValue:e,next:null},Sl===null){if(gm===null)throw Error(se(308));Sl=t,gm.dependencies={lanes:0,firstContext:t}}else Sl=Sl.next=t;return e}var io=null;function fx(t){io===null?io=[t]:io.push(t)}function HT(t,e,n,s){var a=e.interleaved;return a===null?(n.next=n,fx(e)):(n.next=a.next,a.next=n),e.interleaved=n,wr(t,s)}function wr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ur=!1;function mx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function KT(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function mr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ri(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Ke&2){var a=s.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),s.pending=e,wr(t,n)}return a=s.interleaved,a===null?(e.next=e,fx(s)):(e.next=a.next,a.next=e),s.interleaved=e,wr(t,n)}function Wf(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ex(t,n)}}function RS(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var a=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};r===null?a=r=i:r=r.next=i,n=n.next}while(n!==null);r===null?a=r=e:r=r.next=e}else a=r=e;n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:r,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ym(t,e,n,s){var a=t.updateQueue;Ur=!1;var r=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?r=u:i.next=u,i=l;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==i&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(r!==null){var d=a.baseState;i=0,c=u=l=null,o=r;do{var p=o.lane,h=o.eventTime;if((s&p)===p){c!==null&&(c=c.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=t,m=o;switch(p=e,h=n,m.tag){case 1:if(f=m.payload,typeof f=="function"){d=f.call(h,d,p);break e}d=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=m.payload,p=typeof f=="function"?f.call(h,d,p):f,p==null)break e;d=Et({},d,p);break e;case 2:Ur=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=h,l=d):c=c.next=h,i|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(c===null&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=c,e=a.shared.interleaved,e!==null){a=e;do i|=a.lane,a=a.next;while(a!==e)}else r===null&&(a.shared.lanes=0);So|=i,t.lanes=i,t.memoizedState=d}}function AS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],a=s.callback;if(a!==null){if(s.callback=null,s=n,typeof a!="function")throw Error(se(191,a));a.call(s)}}}var lp={},Va=Ai(lp),Id=Ai(lp),Td=Ai(lp);function oo(t){if(t===lp)throw Error(se(174));return t}function gx(t,e){switch(ut(Td,e),ut(Id,t),ut(Va,lp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yb(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Yb(e,t)}ft(Va),ut(Va,e)}function Wl(){ft(Va),ft(Id),ft(Td)}function qT(t){oo(Td.current);var e=oo(Va.current),n=Yb(e,t.type);e!==n&&(ut(Id,t),ut(Va,n))}function yx(t){Id.current===t&&(ft(Va),ft(Id))}var It=Ai(0);function bm(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var db=[];function bx(){for(var t=0;t<db.length;t++)db[t]._workInProgressVersionPrimary=null;db.length=0}var Uf=Tr.ReactCurrentDispatcher,pb=Tr.ReactCurrentBatchConfig,vo=0,$t=null,Jt=null,rn=null,wm=!1,ud=!1,$d=0,qP=0;function Cn(){throw Error(se(321))}function wx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ba(t[n],e[n]))return!1;return!0}function kx(t,e,n,s,a,r){if(vo=r,$t=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Uf.current=t===null||t.memoizedState===null?QP:ZP,t=n(s,a),ud){r=0;do{if(ud=!1,$d=0,25<=r)throw Error(se(301));r+=1,rn=Jt=null,e.updateQueue=null,Uf.current=eL,t=n(s,a)}while(ud)}if(Uf.current=km,e=Jt!==null&&Jt.next!==null,vo=0,rn=Jt=$t=null,wm=!1,e)throw Error(se(300));return t}function xx(){var t=$d!==0;return $d=0,t}function Ra(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?$t.memoizedState=rn=t:rn=rn.next=t,rn}function Js(){if(Jt===null){var t=$t.alternate;t=t!==null?t.memoizedState:null}else t=Jt.next;var e=rn===null?$t.memoizedState:rn.next;if(e!==null)rn=e,Jt=t;else{if(t===null)throw Error(se(310));Jt=t,t={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},rn===null?$t.memoizedState=rn=t:rn=rn.next=t}return rn}function Ed(t,e){return typeof e=="function"?e(t):e}function hb(t){var e=Js(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var s=Jt,a=s.baseQueue,r=n.pending;if(r!==null){if(a!==null){var i=a.next;a.next=r.next,r.next=i}s.baseQueue=a=r,n.pending=null}if(a!==null){r=a.next,s=s.baseState;var o=i=null,l=null,u=r;do{var c=u.lane;if((vo&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,i=s):l=l.next=d,$t.lanes|=c,So|=c}u=u.next}while(u!==null&&u!==r);l===null?i=s:l.next=o,ba(s,e.memoizedState)||(rs=!0),e.memoizedState=s,e.baseState=i,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){a=t;do r=a.lane,$t.lanes|=r,So|=r,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function fb(t){var e=Js(),n=e.queue;if(n===null)throw Error(se(311));n.lastRenderedReducer=t;var s=n.dispatch,a=n.pending,r=e.memoizedState;if(a!==null){n.pending=null;var i=a=a.next;do r=t(r,i.action),i=i.next;while(i!==a);ba(r,e.memoizedState)||(rs=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),n.lastRenderedState=r}return[r,s]}function JT(){}function XT(t,e){var n=$t,s=Js(),a=e(),r=!ba(s.memoizedState,a);if(r&&(s.memoizedState=a,rs=!0),s=s.queue,vx(ZT.bind(null,n,s,t),[t]),s.getSnapshot!==e||r||rn!==null&&rn.memoizedState.tag&1){if(n.flags|=2048,Rd(9,QT.bind(null,n,s,a,e),void 0,null),un===null)throw Error(se(349));vo&30||YT(n,e,a)}return a}function YT(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$t.updateQueue,e===null?(e={lastEffect:null,stores:null},$t.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function QT(t,e,n,s){e.value=n,e.getSnapshot=s,e$(e)&&t$(t)}function ZT(t,e,n){return n(function(){e$(e)&&t$(t)})}function e$(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ba(t,n)}catch{return!0}}function t$(t){var e=wr(t,1);e!==null&&fa(e,t,1,-1)}function OS(t){var e=Ra();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ed,lastRenderedState:t},e.queue=t,t=t.dispatch=YP.bind(null,$t,t),[e.memoizedState,t]}function Rd(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=$t.updateQueue,e===null?(e={lastEffect:null,stores:null},$t.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function n$(){return Js().memoizedState}function Gf(t,e,n,s){var a=Ra();$t.flags|=t,a.memoizedState=Rd(1|e,n,void 0,s===void 0?null:s)}function yg(t,e,n,s){var a=Js();s=s===void 0?null:s;var r=void 0;if(Jt!==null){var i=Jt.memoizedState;if(r=i.destroy,s!==null&&wx(s,i.deps)){a.memoizedState=Rd(e,n,r,s);return}}$t.flags|=t,a.memoizedState=Rd(1|e,n,r,s)}function DS(t,e){return Gf(8390656,8,t,e)}function vx(t,e){return yg(2048,8,t,e)}function s$(t,e){return yg(4,2,t,e)}function a$(t,e){return yg(4,4,t,e)}function r$(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function i$(t,e,n){return n=n!=null?n.concat([t]):null,yg(4,4,r$.bind(null,e,t),n)}function Sx(){}function o$(t,e){var n=Js();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&wx(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function l$(t,e){var n=Js();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&wx(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function u$(t,e,n){return vo&21?(ba(n,e)||(n=fT(),$t.lanes|=n,So|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rs=!0),t.memoizedState=n)}function JP(t,e){var n=tt;tt=n!==0&&4>n?n:4,t(!0);var s=pb.transition;pb.transition={};try{t(!1),e()}finally{tt=n,pb.transition=s}}function c$(){return Js().memoizedState}function XP(t,e,n){var s=oi(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},d$(t))p$(e,n);else if(n=HT(t,e,n,s),n!==null){var a=Vn();fa(n,t,s,a),h$(n,e,s)}}function YP(t,e,n){var s=oi(t),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(d$(t))p$(e,a);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var i=e.lastRenderedState,o=r(i,n);if(a.hasEagerState=!0,a.eagerState=o,ba(o,i)){var l=e.interleaved;l===null?(a.next=a,fx(e)):(a.next=l.next,l.next=a),e.interleaved=a;return}}catch{}finally{}n=HT(t,e,a,s),n!==null&&(a=Vn(),fa(n,t,s,a),h$(n,e,s))}}function d$(t){var e=t.alternate;return t===$t||e!==null&&e===$t}function p$(t,e){ud=wm=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function h$(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ex(t,n)}}var km={readContext:qs,useCallback:Cn,useContext:Cn,useEffect:Cn,useImperativeHandle:Cn,useInsertionEffect:Cn,useLayoutEffect:Cn,useMemo:Cn,useReducer:Cn,useRef:Cn,useState:Cn,useDebugValue:Cn,useDeferredValue:Cn,useTransition:Cn,useMutableSource:Cn,useSyncExternalStore:Cn,useId:Cn,unstable_isNewReconciler:!1},QP={readContext:qs,useCallback:function(t,e){return Ra().memoizedState=[t,e===void 0?null:e],t},useContext:qs,useEffect:DS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Gf(4194308,4,r$.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Gf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Gf(4,2,t,e)},useMemo:function(t,e){var n=Ra();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Ra();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=XP.bind(null,$t,t),[s.memoizedState,t]},useRef:function(t){var e=Ra();return t={current:t},e.memoizedState=t},useState:OS,useDebugValue:Sx,useDeferredValue:function(t){return Ra().memoizedState=t},useTransition:function(){var t=OS(!1),e=t[0];return t=JP.bind(null,t[1]),Ra().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=$t,a=Ra();if(kt){if(n===void 0)throw Error(se(407));n=n()}else{if(n=e(),un===null)throw Error(se(349));vo&30||YT(s,e,n)}a.memoizedState=n;var r={value:n,getSnapshot:e};return a.queue=r,DS(ZT.bind(null,s,r,t),[t]),s.flags|=2048,Rd(9,QT.bind(null,s,r,n,e),void 0,null),n},useId:function(){var t=Ra(),e=un.identifierPrefix;if(kt){var n=hr,s=pr;n=(s&~(1<<32-ha(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=$d++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=qP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ZP={readContext:qs,useCallback:o$,useContext:qs,useEffect:vx,useImperativeHandle:i$,useInsertionEffect:s$,useLayoutEffect:a$,useMemo:l$,useReducer:hb,useRef:n$,useState:function(){return hb(Ed)},useDebugValue:Sx,useDeferredValue:function(t){var e=Js();return u$(e,Jt.memoizedState,t)},useTransition:function(){var t=hb(Ed)[0],e=Js().memoizedState;return[t,e]},useMutableSource:JT,useSyncExternalStore:XT,useId:c$,unstable_isNewReconciler:!1},eL={readContext:qs,useCallback:o$,useContext:qs,useEffect:vx,useImperativeHandle:i$,useInsertionEffect:s$,useLayoutEffect:a$,useMemo:l$,useReducer:fb,useRef:n$,useState:function(){return fb(Ed)},useDebugValue:Sx,useDeferredValue:function(t){var e=Js();return Jt===null?e.memoizedState=t:u$(e,Jt.memoizedState,t)},useTransition:function(){var t=fb(Ed)[0],e=Js().memoizedState;return[t,e]},useMutableSource:JT,useSyncExternalStore:XT,useId:c$,unstable_isNewReconciler:!1};function aa(t,e){if(t&&t.defaultProps){e=Et({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function bw(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Et({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var bg={isMounted:function(t){return(t=t._reactInternals)?Vo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Vn(),a=oi(t),r=mr(s,a);r.payload=e,n!=null&&(r.callback=n),e=ri(t,r,a),e!==null&&(fa(e,t,a,s),Wf(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Vn(),a=oi(t),r=mr(s,a);r.tag=1,r.payload=e,n!=null&&(r.callback=n),e=ri(t,r,a),e!==null&&(fa(e,t,a,s),Wf(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vn(),s=oi(t),a=mr(n,s);a.tag=2,e!=null&&(a.callback=e),e=ri(t,a,s),e!==null&&(fa(e,t,s,n),Wf(e,t,s))}};function jS(t,e,n,s,a,r,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,r,i):e.prototype&&e.prototype.isPureReactComponent?!vd(n,s)||!vd(a,r):!0}function f$(t,e,n){var s=!1,a=fi,r=e.contextType;return typeof r=="object"&&r!==null?r=qs(r):(a=us(e)?ko:jn.current,s=e.contextTypes,r=(s=s!=null)?zl(t,a):fi),e=new e(n,r),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bg,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=r),e}function _S(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&bg.enqueueReplaceState(e,e.state,null)}function ww(t,e,n,s){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},mx(t);var r=e.contextType;typeof r=="object"&&r!==null?a.context=qs(r):(r=us(e)?ko:jn.current,a.context=zl(t,r)),a.state=t.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(bw(t,e,r,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&bg.enqueueReplaceState(a,a.state,null),ym(t,n,a,s),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Ul(t,e){try{var n="",s=e;do n+=$F(s),s=s.return;while(s);var a=n}catch(r){a=`
Error generating stack: `+r.message+`
`+r.stack}return{value:t,source:e,stack:a,digest:null}}function mb(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function kw(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var tL=typeof WeakMap=="function"?WeakMap:Map;function m$(t,e,n){n=mr(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){vm||(vm=!0,Rw=s),kw(t,e)},n}function g$(t,e,n){n=mr(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var a=e.value;n.payload=function(){return s(a)},n.callback=function(){kw(t,e)}}var r=t.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(n.callback=function(){kw(t,e),typeof s!="function"&&(ii===null?ii=new Set([this]):ii.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function FS(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new tL;var a=new Set;s.set(e,a)}else a=s.get(e),a===void 0&&(a=new Set,s.set(e,a));a.has(n)||(a.add(n),t=mL.bind(null,t,e,n),e.then(t,t))}function PS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function LS(t,e,n,s,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=mr(-1,1),e.tag=2,ri(n,e,1))),n.lanes|=1),t)}var nL=Tr.ReactCurrentOwner,rs=!1;function Ln(t,e,n,s){e.child=t===null?GT(e,null,n,s):Vl(e,t.child,n,s)}function BS(t,e,n,s,a){n=n.render;var r=e.ref;return Al(e,a),s=kx(t,e,n,s,r,a),n=xx(),t!==null&&!rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,kr(t,e,a)):(kt&&n&&lx(e),e.flags|=1,Ln(t,e,s,a),e.child)}function zS(t,e,n,s,a){if(t===null){var r=n.type;return typeof r=="function"&&!Ax(r)&&r.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=r,y$(t,e,r,s,a)):(t=Jf(n.type,null,s,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(r=t.child,!(t.lanes&a)){var i=r.memoizedProps;if(n=n.compare,n=n!==null?n:vd,n(i,s)&&t.ref===e.ref)return kr(t,e,a)}return e.flags|=1,t=li(r,s),t.ref=e.ref,t.return=e,e.child=t}function y$(t,e,n,s,a){if(t!==null){var r=t.memoizedProps;if(vd(r,s)&&t.ref===e.ref)if(rs=!1,e.pendingProps=s=r,(t.lanes&a)!==0)t.flags&131072&&(rs=!0);else return e.lanes=t.lanes,kr(t,e,a)}return xw(t,e,n,s,a)}function b$(t,e,n){var s=e.pendingProps,a=s.children,r=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(Cl,bs),bs|=n;else{if(!(n&1073741824))return t=r!==null?r.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ut(Cl,bs),bs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:n,ut(Cl,bs),bs|=s}else r!==null?(s=r.baseLanes|n,e.memoizedState=null):s=n,ut(Cl,bs),bs|=s;return Ln(t,e,a,n),e.child}function w$(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function xw(t,e,n,s,a){var r=us(n)?ko:jn.current;return r=zl(e,r),Al(e,a),n=kx(t,e,n,s,r,a),s=xx(),t!==null&&!rs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,kr(t,e,a)):(kt&&s&&lx(e),e.flags|=1,Ln(t,e,n,a),e.child)}function MS(t,e,n,s,a){if(us(n)){var r=!0;pm(e)}else r=!1;if(Al(e,a),e.stateNode===null)Hf(t,e),f$(e,n,s),ww(e,n,s,a),s=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=qs(u):(u=us(n)?ko:jn.current,u=zl(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==s||l!==u)&&_S(e,i,s,u),Ur=!1;var p=e.memoizedState;i.state=p,ym(e,s,i,a),l=e.memoizedState,o!==s||p!==l||ls.current||Ur?(typeof c=="function"&&(bw(e,n,c,s),l=e.memoizedState),(o=Ur||jS(e,n,o,s,p,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),i.props=s,i.state=l,i.context=u,s=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{i=e.stateNode,KT(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:aa(e.type,o),i.props=u,d=e.pendingProps,p=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=qs(l):(l=us(n)?ko:jn.current,l=zl(e,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||p!==l)&&_S(e,i,s,l),Ur=!1,p=e.memoizedState,i.state=p,ym(e,s,i,a);var f=e.memoizedState;o!==d||p!==f||ls.current||Ur?(typeof h=="function"&&(bw(e,n,h,s),f=e.memoizedState),(u=Ur||jS(e,n,u,s,p,f,l)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,f,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,f,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=f),i.props=s,i.state=f,i.context=l,s=u):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),s=!1)}return vw(t,e,n,s,r,a)}function vw(t,e,n,s,a,r){w$(t,e);var i=(e.flags&128)!==0;if(!s&&!i)return a&&IS(e,n,!1),kr(t,e,r);s=e.stateNode,nL.current=e;var o=i&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&i?(e.child=Vl(e,t.child,null,r),e.child=Vl(e,null,o,r)):Ln(t,e,o,r),e.memoizedState=s.state,a&&IS(e,n,!0),e.child}function k$(t){var e=t.stateNode;e.pendingContext?CS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&CS(t,e.context,!1),gx(t,e.containerInfo)}function VS(t,e,n,s,a){return Ml(),cx(a),e.flags|=256,Ln(t,e,n,s),e.child}var Sw={dehydrated:null,treeContext:null,retryLane:0};function Nw(t){return{baseLanes:t,cachePool:null,transitions:null}}function x$(t,e,n){var s=e.pendingProps,a=It.current,r=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(a&2)!==0),o?(r=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),ut(It,a&1),t===null)return gw(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=s.children,t=s.fallback,r?(s=e.mode,r=e.child,i={mode:"hidden",children:i},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=i):r=xg(i,s,0,null),t=fo(t,s,n,null),r.return=e,t.return=e,r.sibling=t,e.child=r,e.child.memoizedState=Nw(n),e.memoizedState=Sw,t):Nx(e,i));if(a=t.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return sL(t,e,i,s,o,a,n);if(r){r=s.fallback,i=e.mode,a=t.child,o=a.sibling;var l={mode:"hidden",children:s.children};return!(i&1)&&e.child!==a?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=li(a,l),s.subtreeFlags=a.subtreeFlags&14680064),o!==null?r=li(o,r):(r=fo(r,i,n,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,i=t.child.memoizedState,i=i===null?Nw(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},r.memoizedState=i,r.childLanes=t.childLanes&~n,e.memoizedState=Sw,s}return r=t.child,t=r.sibling,s=li(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Nx(t,e){return e=xg({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function bf(t,e,n,s){return s!==null&&cx(s),Vl(e,t.child,null,n),t=Nx(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function sL(t,e,n,s,a,r,i){if(n)return e.flags&256?(e.flags&=-257,s=mb(Error(se(422))),bf(t,e,i,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(r=s.fallback,a=e.mode,s=xg({mode:"visible",children:s.children},a,0,null),r=fo(r,a,i,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&Vl(e,t.child,null,i),e.child.memoizedState=Nw(i),e.memoizedState=Sw,r);if(!(e.mode&1))return bf(t,e,i,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var o=s.dgst;return s=o,r=Error(se(419)),s=mb(r,s,void 0),bf(t,e,i,s)}if(o=(i&t.childLanes)!==0,rs||o){if(s=un,s!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|i)?0:a,a!==0&&a!==r.retryLane&&(r.retryLane=a,wr(t,a),fa(s,t,a,-1))}return Rx(),s=mb(Error(se(421))),bf(t,e,i,s)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=gL.bind(null,t),a._reactRetry=e,null):(t=r.treeContext,xs=ai(a.nextSibling),Ns=e,kt=!0,oa=null,t!==null&&(Ps[Ls++]=pr,Ps[Ls++]=hr,Ps[Ls++]=xo,pr=t.id,hr=t.overflow,xo=e),e=Nx(e,s.children),e.flags|=4096,e)}function WS(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),yw(t.return,e,n)}function gb(t,e,n,s,a){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=n,r.tailMode=a)}function v$(t,e,n){var s=e.pendingProps,a=s.revealOrder,r=s.tail;if(Ln(t,e,s.children,n),s=It.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&WS(t,n,e);else if(t.tag===19)WS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(ut(It,s),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&bm(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),gb(e,!1,a,n,r);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&bm(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}gb(e,!0,n,null,r);break;case"together":gb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Hf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function kr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),So|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(se(153));if(e.child!==null){for(t=e.child,n=li(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=li(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function aL(t,e,n){switch(e.tag){case 3:k$(e),Ml();break;case 5:qT(e);break;case 1:us(e.type)&&pm(e);break;case 4:gx(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,a=e.memoizedProps.value;ut(mm,s._currentValue),s._currentValue=a;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(ut(It,It.current&1),e.flags|=128,null):n&e.child.childLanes?x$(t,e,n):(ut(It,It.current&1),t=kr(t,e,n),t!==null?t.sibling:null);ut(It,It.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return v$(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ut(It,It.current),s)break;return null;case 22:case 23:return e.lanes=0,b$(t,e,n)}return kr(t,e,n)}var S$,Cw,N$,C$;S$=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Cw=function(){};N$=function(t,e,n,s){var a=t.memoizedProps;if(a!==s){t=e.stateNode,oo(Va.current);var r=null;switch(n){case"input":a=Kb(t,a),s=Kb(t,s),r=[];break;case"select":a=Et({},a,{value:void 0}),s=Et({},s,{value:void 0}),r=[];break;case"textarea":a=Xb(t,a),s=Xb(t,s),r=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=cm)}Qb(n,s);var i;n=null;for(u in a)if(!s.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(i in o)o.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(md.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var l=s[u];if(o=a!=null?a[u]:void 0,s.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(r||(r=[]),r.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(r=r||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(r=r||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(md.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ht("scroll",t),r||o===l||(r=[])):(r=r||[]).push(u,l))}n&&(r=r||[]).push("style",n);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};C$=function(t,e,n,s){n!==s&&(e.flags|=4)};function Fc(t,e){if(!kt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function In(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function rL(t,e,n){var s=e.pendingProps;switch(ux(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return In(e),null;case 1:return us(e.type)&&dm(),In(e),null;case 3:return s=e.stateNode,Wl(),ft(ls),ft(jn),bx(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(gf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,oa!==null&&(Dw(oa),oa=null))),Cw(t,e),In(e),null;case 5:yx(e);var a=oo(Td.current);if(n=e.type,t!==null&&e.stateNode!=null)N$(t,e,n,s,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(se(166));return In(e),null}if(t=oo(Va.current),gf(e)){s=e.stateNode,n=e.type;var r=e.memoizedProps;switch(s[Fa]=e,s[Cd]=r,t=(e.mode&1)!==0,n){case"dialog":ht("cancel",s),ht("close",s);break;case"iframe":case"object":case"embed":ht("load",s);break;case"video":case"audio":for(a=0;a<Xc.length;a++)ht(Xc[a],s);break;case"source":ht("error",s);break;case"img":case"image":case"link":ht("error",s),ht("load",s);break;case"details":ht("toggle",s);break;case"input":Q2(s,r),ht("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},ht("invalid",s);break;case"textarea":eS(s,r),ht("invalid",s)}Qb(n,r),a=null;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];i==="children"?typeof o=="string"?s.textContent!==o&&(r.suppressHydrationWarning!==!0&&mf(s.textContent,o,t),a=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&mf(s.textContent,o,t),a=["children",""+o]):md.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&ht("scroll",s)}switch(n){case"input":of(s),Z2(s,r,!0);break;case"textarea":of(s),tS(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=cm)}s=a,e.updateQueue=s,s!==null&&(e.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ZI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=i.createElement(n,{is:s.is}):(t=i.createElement(n),n==="select"&&(i=t,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):t=i.createElementNS(t,n),t[Fa]=e,t[Cd]=s,S$(t,e,!1,!1),e.stateNode=t;e:{switch(i=Zb(n,s),n){case"dialog":ht("cancel",t),ht("close",t),a=s;break;case"iframe":case"object":case"embed":ht("load",t),a=s;break;case"video":case"audio":for(a=0;a<Xc.length;a++)ht(Xc[a],t);a=s;break;case"source":ht("error",t),a=s;break;case"img":case"image":case"link":ht("error",t),ht("load",t),a=s;break;case"details":ht("toggle",t),a=s;break;case"input":Q2(t,s),a=Kb(t,s),ht("invalid",t);break;case"option":a=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},a=Et({},s,{value:void 0}),ht("invalid",t);break;case"textarea":eS(t,s),a=Xb(t,s),ht("invalid",t);break;default:a=s}Qb(n,a),o=a;for(r in o)if(o.hasOwnProperty(r)){var l=o[r];r==="style"?nT(t,l):r==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&eT(t,l)):r==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&gd(t,l):typeof l=="number"&&gd(t,""+l):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(md.hasOwnProperty(r)?l!=null&&r==="onScroll"&&ht("scroll",t):l!=null&&qk(t,r,l,i))}switch(n){case"input":of(t),Z2(t,s,!1);break;case"textarea":of(t),tS(t);break;case"option":s.value!=null&&t.setAttribute("value",""+hi(s.value));break;case"select":t.multiple=!!s.multiple,r=s.value,r!=null?Tl(t,!!s.multiple,r,!1):s.defaultValue!=null&&Tl(t,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=cm)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return In(e),null;case 6:if(t&&e.stateNode!=null)C$(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(se(166));if(n=oo(Td.current),oo(Va.current),gf(e)){if(s=e.stateNode,n=e.memoizedProps,s[Fa]=e,(r=s.nodeValue!==n)&&(t=Ns,t!==null))switch(t.tag){case 3:mf(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&mf(s.nodeValue,n,(t.mode&1)!==0)}r&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Fa]=e,e.stateNode=s}return In(e),null;case 13:if(ft(It),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(kt&&xs!==null&&e.mode&1&&!(e.flags&128))WT(),Ml(),e.flags|=98560,r=!1;else if(r=gf(e),s!==null&&s.dehydrated!==null){if(t===null){if(!r)throw Error(se(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(se(317));r[Fa]=e}else Ml(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;In(e),r=!1}else oa!==null&&(Dw(oa),oa=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||It.current&1?Qt===0&&(Qt=3):Rx())),e.updateQueue!==null&&(e.flags|=4),In(e),null);case 4:return Wl(),Cw(t,e),t===null&&Sd(e.stateNode.containerInfo),In(e),null;case 10:return hx(e.type._context),In(e),null;case 17:return us(e.type)&&dm(),In(e),null;case 19:if(ft(It),r=e.memoizedState,r===null)return In(e),null;if(s=(e.flags&128)!==0,i=r.rendering,i===null)if(s)Fc(r,!1);else{if(Qt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=bm(t),i!==null){for(e.flags|=128,Fc(r,!1),s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)r=n,t=s,r.flags&=14680066,i=r.alternate,i===null?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=i.childLanes,r.lanes=i.lanes,r.child=i.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=i.memoizedProps,r.memoizedState=i.memoizedState,r.updateQueue=i.updateQueue,r.type=i.type,t=i.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ut(It,It.current&1|2),e.child}t=t.sibling}r.tail!==null&&Pt()>Gl&&(e.flags|=128,s=!0,Fc(r,!1),e.lanes=4194304)}else{if(!s)if(t=bm(i),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Fc(r,!0),r.tail===null&&r.tailMode==="hidden"&&!i.alternate&&!kt)return In(e),null}else 2*Pt()-r.renderingStartTime>Gl&&n!==1073741824&&(e.flags|=128,s=!0,Fc(r,!1),e.lanes=4194304);r.isBackwards?(i.sibling=e.child,e.child=i):(n=r.last,n!==null?n.sibling=i:e.child=i,r.last=i)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Pt(),e.sibling=null,n=It.current,ut(It,s?n&1|2:n&1),e):(In(e),null);case 22:case 23:return Ex(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?bs&1073741824&&(In(e),e.subtreeFlags&6&&(e.flags|=8192)):In(e),null;case 24:return null;case 25:return null}throw Error(se(156,e.tag))}function iL(t,e){switch(ux(e),e.tag){case 1:return us(e.type)&&dm(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Wl(),ft(ls),ft(jn),bx(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return yx(e),null;case 13:if(ft(It),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(se(340));Ml()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ft(It),null;case 4:return Wl(),null;case 10:return hx(e.type._context),null;case 22:case 23:return Ex(),null;case 24:return null;default:return null}}var wf=!1,Rn=!1,oL=typeof WeakSet=="function"?WeakSet:Set,fe=null;function Nl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Rt(t,e,s)}else n.current=null}function Iw(t,e,n){try{n()}catch(s){Rt(t,e,s)}}var US=!1;function lL(t,e){if(uw=om,t=RT(),ox(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var a=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var i=0,o=-1,l=-1,u=0,c=0,d=t,p=null;t:for(;;){for(var h;d!==n||a!==0&&d.nodeType!==3||(o=i+a),d!==r||s!==0&&d.nodeType!==3||(l=i+s),d.nodeType===3&&(i+=d.nodeValue.length),(h=d.firstChild)!==null;)p=d,d=h;for(;;){if(d===t)break t;if(p===n&&++u===a&&(o=i),p===r&&++c===s&&(l=i),(h=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=h}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(cw={focusedElem:t,selectionRange:n},om=!1,fe=e;fe!==null;)if(e=fe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,fe=t;else for(;fe!==null;){e=fe;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var m=f.memoizedProps,y=f.memoizedState,g=e.stateNode,b=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:aa(e.type,m),y);g.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(se(163))}}catch(k){Rt(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,fe=t;break}fe=e.return}return f=US,US=!1,f}function cd(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var r=a.destroy;a.destroy=void 0,r!==void 0&&Iw(e,n,r)}a=a.next}while(a!==s)}}function wg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function Tw(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function I$(t){var e=t.alternate;e!==null&&(t.alternate=null,I$(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Fa],delete e[Cd],delete e[hw],delete e[UP],delete e[GP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function T$(t){return t.tag===5||t.tag===3||t.tag===4}function GS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||T$(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $w(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=cm));else if(s!==4&&(t=t.child,t!==null))for($w(t,e,n),t=t.sibling;t!==null;)$w(t,e,n),t=t.sibling}function Ew(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Ew(t,e,n),t=t.sibling;t!==null;)Ew(t,e,n),t=t.sibling}var yn=null,ia=!1;function Mr(t,e,n){for(n=n.child;n!==null;)$$(t,e,n),n=n.sibling}function $$(t,e,n){if(Ma&&typeof Ma.onCommitFiberUnmount=="function")try{Ma.onCommitFiberUnmount(dg,n)}catch{}switch(n.tag){case 5:Rn||Nl(n,e);case 6:var s=yn,a=ia;yn=null,Mr(t,e,n),yn=s,ia=a,yn!==null&&(ia?(t=yn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):yn.removeChild(n.stateNode));break;case 18:yn!==null&&(ia?(t=yn,n=n.stateNode,t.nodeType===8?ub(t.parentNode,n):t.nodeType===1&&ub(t,n),kd(t)):ub(yn,n.stateNode));break;case 4:s=yn,a=ia,yn=n.stateNode.containerInfo,ia=!0,Mr(t,e,n),yn=s,ia=a;break;case 0:case 11:case 14:case 15:if(!Rn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var r=a,i=r.destroy;r=r.tag,i!==void 0&&(r&2||r&4)&&Iw(n,e,i),a=a.next}while(a!==s)}Mr(t,e,n);break;case 1:if(!Rn&&(Nl(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(o){Rt(n,e,o)}Mr(t,e,n);break;case 21:Mr(t,e,n);break;case 22:n.mode&1?(Rn=(s=Rn)||n.memoizedState!==null,Mr(t,e,n),Rn=s):Mr(t,e,n);break;default:Mr(t,e,n)}}function HS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new oL),e.forEach(function(s){var a=yL.bind(null,t,s);n.has(s)||(n.add(s),s.then(a,a))})}}function ta(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var a=n[s];try{var r=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:yn=o.stateNode,ia=!1;break e;case 3:yn=o.stateNode.containerInfo,ia=!0;break e;case 4:yn=o.stateNode.containerInfo,ia=!0;break e}o=o.return}if(yn===null)throw Error(se(160));$$(r,i,a),yn=null,ia=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){Rt(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)E$(e,t),e=e.sibling}function E$(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ta(e,t),Ea(t),s&4){try{cd(3,t,t.return),wg(3,t)}catch(m){Rt(t,t.return,m)}try{cd(5,t,t.return)}catch(m){Rt(t,t.return,m)}}break;case 1:ta(e,t),Ea(t),s&512&&n!==null&&Nl(n,n.return);break;case 5:if(ta(e,t),Ea(t),s&512&&n!==null&&Nl(n,n.return),t.flags&32){var a=t.stateNode;try{gd(a,"")}catch(m){Rt(t,t.return,m)}}if(s&4&&(a=t.stateNode,a!=null)){var r=t.memoizedProps,i=n!==null?n.memoizedProps:r,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&YI(a,r),Zb(o,i);var u=Zb(o,r);for(i=0;i<l.length;i+=2){var c=l[i],d=l[i+1];c==="style"?nT(a,d):c==="dangerouslySetInnerHTML"?eT(a,d):c==="children"?gd(a,d):qk(a,c,d,u)}switch(o){case"input":qb(a,r);break;case"textarea":QI(a,r);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!r.multiple;var h=r.value;h!=null?Tl(a,!!r.multiple,h,!1):p!==!!r.multiple&&(r.defaultValue!=null?Tl(a,!!r.multiple,r.defaultValue,!0):Tl(a,!!r.multiple,r.multiple?[]:"",!1))}a[Cd]=r}catch(m){Rt(t,t.return,m)}}break;case 6:if(ta(e,t),Ea(t),s&4){if(t.stateNode===null)throw Error(se(162));a=t.stateNode,r=t.memoizedProps;try{a.nodeValue=r}catch(m){Rt(t,t.return,m)}}break;case 3:if(ta(e,t),Ea(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{kd(e.containerInfo)}catch(m){Rt(t,t.return,m)}break;case 4:ta(e,t),Ea(t);break;case 13:ta(e,t),Ea(t),a=t.child,a.flags&8192&&(r=a.memoizedState!==null,a.stateNode.isHidden=r,!r||a.alternate!==null&&a.alternate.memoizedState!==null||(Tx=Pt())),s&4&&HS(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Rn=(u=Rn)||c,ta(e,t),Rn=u):ta(e,t),Ea(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(fe=t,c=t.child;c!==null;){for(d=fe=c;fe!==null;){switch(p=fe,h=p.child,p.tag){case 0:case 11:case 14:case 15:cd(4,p,p.return);break;case 1:Nl(p,p.return);var f=p.stateNode;if(typeof f.componentWillUnmount=="function"){s=p,n=p.return;try{e=s,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(m){Rt(s,n,m)}}break;case 5:Nl(p,p.return);break;case 22:if(p.memoizedState!==null){qS(d);continue}}h!==null?(h.return=p,fe=h):qS(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{a=d.stateNode,u?(r=a.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=tT("display",i))}catch(m){Rt(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Rt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ta(e,t),Ea(t),s&4&&HS(t);break;case 21:break;default:ta(e,t),Ea(t)}}function Ea(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(T$(n)){var s=n;break e}n=n.return}throw Error(se(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(gd(a,""),s.flags&=-33);var r=GS(t);Ew(t,r,a);break;case 3:case 4:var i=s.stateNode.containerInfo,o=GS(t);$w(t,o,i);break;default:throw Error(se(161))}}catch(l){Rt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function uL(t,e,n){fe=t,R$(t)}function R$(t,e,n){for(var s=(t.mode&1)!==0;fe!==null;){var a=fe,r=a.child;if(a.tag===22&&s){var i=a.memoizedState!==null||wf;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Rn;o=wf;var u=Rn;if(wf=i,(Rn=l)&&!u)for(fe=a;fe!==null;)i=fe,l=i.child,i.tag===22&&i.memoizedState!==null?JS(a):l!==null?(l.return=i,fe=l):JS(a);for(;r!==null;)fe=r,R$(r),r=r.sibling;fe=a,wf=o,Rn=u}KS(t)}else a.subtreeFlags&8772&&r!==null?(r.return=a,fe=r):KS(t)}}function KS(t){for(;fe!==null;){var e=fe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Rn||wg(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Rn)if(n===null)s.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:aa(e.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&AS(e,r,s);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}AS(e,i,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&kd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(se(163))}Rn||e.flags&512&&Tw(e)}catch(p){Rt(e,e.return,p)}}if(e===t){fe=null;break}if(n=e.sibling,n!==null){n.return=e.return,fe=n;break}fe=e.return}}function qS(t){for(;fe!==null;){var e=fe;if(e===t){fe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,fe=n;break}fe=e.return}}function JS(t){for(;fe!==null;){var e=fe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{wg(4,e)}catch(l){Rt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var a=e.return;try{s.componentDidMount()}catch(l){Rt(e,a,l)}}var r=e.return;try{Tw(e)}catch(l){Rt(e,r,l)}break;case 5:var i=e.return;try{Tw(e)}catch(l){Rt(e,i,l)}}}catch(l){Rt(e,e.return,l)}if(e===t){fe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,fe=o;break}fe=e.return}}var cL=Math.ceil,xm=Tr.ReactCurrentDispatcher,Cx=Tr.ReactCurrentOwner,Hs=Tr.ReactCurrentBatchConfig,Ke=0,un=null,Mt=null,kn=0,bs=0,Cl=Ai(0),Qt=0,Ad=null,So=0,kg=0,Ix=0,dd=null,ns=null,Tx=0,Gl=1/0,rr=null,vm=!1,Rw=null,ii=null,kf=!1,Xr=null,Sm=0,pd=0,Aw=null,Kf=-1,qf=0;function Vn(){return Ke&6?Pt():Kf!==-1?Kf:Kf=Pt()}function oi(t){return t.mode&1?Ke&2&&kn!==0?kn&-kn:KP.transition!==null?(qf===0&&(qf=fT()),qf):(t=tt,t!==0||(t=window.event,t=t===void 0?16:xT(t.type)),t):1}function fa(t,e,n,s){if(50<pd)throw pd=0,Aw=null,Error(se(185));rp(t,n,s),(!(Ke&2)||t!==un)&&(t===un&&(!(Ke&2)&&(kg|=n),Qt===4&&Kr(t,kn)),cs(t,s),n===1&&Ke===0&&!(e.mode&1)&&(Gl=Pt()+500,gg&&Oi()))}function cs(t,e){var n=t.callbackNode;KF(t,e);var s=im(t,t===un?kn:0);if(s===0)n!==null&&aS(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&aS(n),e===1)t.tag===0?HP(XS.bind(null,t)):zT(XS.bind(null,t)),VP(function(){!(Ke&6)&&Oi()}),n=null;else{switch(mT(s)){case 1:n=Zk;break;case 4:n=pT;break;case 16:n=rm;break;case 536870912:n=hT;break;default:n=rm}n=L$(n,A$.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function A$(t,e){if(Kf=-1,qf=0,Ke&6)throw Error(se(327));var n=t.callbackNode;if(Ol()&&t.callbackNode!==n)return null;var s=im(t,t===un?kn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Nm(t,s);else{e=s;var a=Ke;Ke|=2;var r=D$();(un!==t||kn!==e)&&(rr=null,Gl=Pt()+500,ho(t,e));do try{hL();break}catch(o){O$(t,o)}while(!0);px(),xm.current=r,Ke=a,Mt!==null?e=0:(un=null,kn=0,e=Qt)}if(e!==0){if(e===2&&(a=aw(t),a!==0&&(s=a,e=Ow(t,a))),e===1)throw n=Ad,ho(t,0),Kr(t,s),cs(t,Pt()),n;if(e===6)Kr(t,s);else{if(a=t.current.alternate,!(s&30)&&!dL(a)&&(e=Nm(t,s),e===2&&(r=aw(t),r!==0&&(s=r,e=Ow(t,r))),e===1))throw n=Ad,ho(t,0),Kr(t,s),cs(t,Pt()),n;switch(t.finishedWork=a,t.finishedLanes=s,e){case 0:case 1:throw Error(se(345));case 2:Yi(t,ns,rr);break;case 3:if(Kr(t,s),(s&130023424)===s&&(e=Tx+500-Pt(),10<e)){if(im(t,0)!==0)break;if(a=t.suspendedLanes,(a&s)!==s){Vn(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=pw(Yi.bind(null,t,ns,rr),e);break}Yi(t,ns,rr);break;case 4:if(Kr(t,s),(s&4194240)===s)break;for(e=t.eventTimes,a=-1;0<s;){var i=31-ha(s);r=1<<i,i=e[i],i>a&&(a=i),s&=~r}if(s=a,s=Pt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*cL(s/1960))-s,10<s){t.timeoutHandle=pw(Yi.bind(null,t,ns,rr),s);break}Yi(t,ns,rr);break;case 5:Yi(t,ns,rr);break;default:throw Error(se(329))}}}return cs(t,Pt()),t.callbackNode===n?A$.bind(null,t):null}function Ow(t,e){var n=dd;return t.current.memoizedState.isDehydrated&&(ho(t,e).flags|=256),t=Nm(t,e),t!==2&&(e=ns,ns=n,e!==null&&Dw(e)),t}function Dw(t){ns===null?ns=t:ns.push.apply(ns,t)}function dL(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var a=n[s],r=a.getSnapshot;a=a.value;try{if(!ba(r(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Kr(t,e){for(e&=~Ix,e&=~kg,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ha(e),s=1<<n;t[n]=-1,e&=~s}}function XS(t){if(Ke&6)throw Error(se(327));Ol();var e=im(t,0);if(!(e&1))return cs(t,Pt()),null;var n=Nm(t,e);if(t.tag!==0&&n===2){var s=aw(t);s!==0&&(e=s,n=Ow(t,s))}if(n===1)throw n=Ad,ho(t,0),Kr(t,e),cs(t,Pt()),n;if(n===6)throw Error(se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Yi(t,ns,rr),cs(t,Pt()),null}function $x(t,e){var n=Ke;Ke|=1;try{return t(e)}finally{Ke=n,Ke===0&&(Gl=Pt()+500,gg&&Oi())}}function No(t){Xr!==null&&Xr.tag===0&&!(Ke&6)&&Ol();var e=Ke;Ke|=1;var n=Hs.transition,s=tt;try{if(Hs.transition=null,tt=1,t)return t()}finally{tt=s,Hs.transition=n,Ke=e,!(Ke&6)&&Oi()}}function Ex(){bs=Cl.current,ft(Cl)}function ho(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,MP(n)),Mt!==null)for(n=Mt.return;n!==null;){var s=n;switch(ux(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&dm();break;case 3:Wl(),ft(ls),ft(jn),bx();break;case 5:yx(s);break;case 4:Wl();break;case 13:ft(It);break;case 19:ft(It);break;case 10:hx(s.type._context);break;case 22:case 23:Ex()}n=n.return}if(un=t,Mt=t=li(t.current,null),kn=bs=e,Qt=0,Ad=null,Ix=kg=So=0,ns=dd=null,io!==null){for(e=0;e<io.length;e++)if(n=io[e],s=n.interleaved,s!==null){n.interleaved=null;var a=s.next,r=n.pending;if(r!==null){var i=r.next;r.next=a,s.next=i}n.pending=s}io=null}return t}function O$(t,e){do{var n=Mt;try{if(px(),Uf.current=km,wm){for(var s=$t.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}wm=!1}if(vo=0,rn=Jt=$t=null,ud=!1,$d=0,Cx.current=null,n===null||n.return===null){Qt=1,Ad=e,Mt=null;break}e:{var r=t,i=n.return,o=n,l=e;if(e=kn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=PS(i);if(h!==null){h.flags&=-257,LS(h,i,o,r,e),h.mode&1&&FS(r,u,e),e=h,l=u;var f=e.updateQueue;if(f===null){var m=new Set;m.add(l),e.updateQueue=m}else f.add(l);break e}else{if(!(e&1)){FS(r,u,e),Rx();break e}l=Error(se(426))}}else if(kt&&o.mode&1){var y=PS(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),LS(y,i,o,r,e),cx(Ul(l,o));break e}}r=l=Ul(l,o),Qt!==4&&(Qt=2),dd===null?dd=[r]:dd.push(r),r=i;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var g=m$(r,l,e);RS(r,g);break e;case 1:o=l;var b=r.type,w=r.stateNode;if(!(r.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ii===null||!ii.has(w)))){r.flags|=65536,e&=-e,r.lanes|=e;var k=g$(r,o,e);RS(r,k);break e}}r=r.return}while(r!==null)}_$(n)}catch(x){e=x,Mt===n&&n!==null&&(Mt=n=n.return);continue}break}while(!0)}function D$(){var t=xm.current;return xm.current=km,t===null?km:t}function Rx(){(Qt===0||Qt===3||Qt===2)&&(Qt=4),un===null||!(So&268435455)&&!(kg&268435455)||Kr(un,kn)}function Nm(t,e){var n=Ke;Ke|=2;var s=D$();(un!==t||kn!==e)&&(rr=null,ho(t,e));do try{pL();break}catch(a){O$(t,a)}while(!0);if(px(),Ke=n,xm.current=s,Mt!==null)throw Error(se(261));return un=null,kn=0,Qt}function pL(){for(;Mt!==null;)j$(Mt)}function hL(){for(;Mt!==null&&!LF();)j$(Mt)}function j$(t){var e=P$(t.alternate,t,bs);t.memoizedProps=t.pendingProps,e===null?_$(t):Mt=e,Cx.current=null}function _$(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=iL(n,e),n!==null){n.flags&=32767,Mt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qt=6,Mt=null;return}}else if(n=rL(n,e,bs),n!==null){Mt=n;return}if(e=e.sibling,e!==null){Mt=e;return}Mt=e=t}while(e!==null);Qt===0&&(Qt=5)}function Yi(t,e,n){var s=tt,a=Hs.transition;try{Hs.transition=null,tt=1,fL(t,e,n,s)}finally{Hs.transition=a,tt=s}return null}function fL(t,e,n,s){do Ol();while(Xr!==null);if(Ke&6)throw Error(se(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(se(177));t.callbackNode=null,t.callbackPriority=0;var r=n.lanes|n.childLanes;if(qF(t,r),t===un&&(Mt=un=null,kn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||kf||(kf=!0,L$(rm,function(){return Ol(),null})),r=(n.flags&15990)!==0,n.subtreeFlags&15990||r){r=Hs.transition,Hs.transition=null;var i=tt;tt=1;var o=Ke;Ke|=4,Cx.current=null,lL(t,n),E$(n,t),jP(cw),om=!!uw,cw=uw=null,t.current=n,uL(n),BF(),Ke=o,tt=i,Hs.transition=r}else t.current=n;if(kf&&(kf=!1,Xr=t,Sm=a),r=t.pendingLanes,r===0&&(ii=null),VF(n.stateNode),cs(t,Pt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],s(a.value,{componentStack:a.stack,digest:a.digest});if(vm)throw vm=!1,t=Rw,Rw=null,t;return Sm&1&&t.tag!==0&&Ol(),r=t.pendingLanes,r&1?t===Aw?pd++:(pd=0,Aw=t):pd=0,Oi(),null}function Ol(){if(Xr!==null){var t=mT(Sm),e=Hs.transition,n=tt;try{if(Hs.transition=null,tt=16>t?16:t,Xr===null)var s=!1;else{if(t=Xr,Xr=null,Sm=0,Ke&6)throw Error(se(331));var a=Ke;for(Ke|=4,fe=t.current;fe!==null;){var r=fe,i=r.child;if(fe.flags&16){var o=r.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(fe=u;fe!==null;){var c=fe;switch(c.tag){case 0:case 11:case 15:cd(8,c,r)}var d=c.child;if(d!==null)d.return=c,fe=d;else for(;fe!==null;){c=fe;var p=c.sibling,h=c.return;if(I$(c),c===u){fe=null;break}if(p!==null){p.return=h,fe=p;break}fe=h}}}var f=r.alternate;if(f!==null){var m=f.child;if(m!==null){f.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}fe=r}}if(r.subtreeFlags&2064&&i!==null)i.return=r,fe=i;else e:for(;fe!==null;){if(r=fe,r.flags&2048)switch(r.tag){case 0:case 11:case 15:cd(9,r,r.return)}var g=r.sibling;if(g!==null){g.return=r.return,fe=g;break e}fe=r.return}}var b=t.current;for(fe=b;fe!==null;){i=fe;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,fe=w;else e:for(i=b;fe!==null;){if(o=fe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:wg(9,o)}}catch(x){Rt(o,o.return,x)}if(o===i){fe=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,fe=k;break e}fe=o.return}}if(Ke=a,Oi(),Ma&&typeof Ma.onPostCommitFiberRoot=="function")try{Ma.onPostCommitFiberRoot(dg,t)}catch{}s=!0}return s}finally{tt=n,Hs.transition=e}}return!1}function YS(t,e,n){e=Ul(n,e),e=m$(t,e,1),t=ri(t,e,1),e=Vn(),t!==null&&(rp(t,1,e),cs(t,e))}function Rt(t,e,n){if(t.tag===3)YS(t,t,n);else for(;e!==null;){if(e.tag===3){YS(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ii===null||!ii.has(s))){t=Ul(n,t),t=g$(e,t,1),e=ri(e,t,1),t=Vn(),e!==null&&(rp(e,1,t),cs(e,t));break}}e=e.return}}function mL(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Vn(),t.pingedLanes|=t.suspendedLanes&n,un===t&&(kn&n)===n&&(Qt===4||Qt===3&&(kn&130023424)===kn&&500>Pt()-Tx?ho(t,0):Ix|=n),cs(t,e)}function F$(t,e){e===0&&(t.mode&1?(e=cf,cf<<=1,!(cf&130023424)&&(cf=4194304)):e=1);var n=Vn();t=wr(t,e),t!==null&&(rp(t,e,n),cs(t,n))}function gL(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),F$(t,n)}function yL(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(se(314))}s!==null&&s.delete(e),F$(t,n)}var P$;P$=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ls.current)rs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return rs=!1,aL(t,e,n);rs=!!(t.flags&131072)}else rs=!1,kt&&e.flags&1048576&&MT(e,fm,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Hf(t,e),t=e.pendingProps;var a=zl(e,jn.current);Al(e,n),a=kx(null,e,s,t,a,n);var r=xx();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,us(s)?(r=!0,pm(e)):r=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,mx(e),a.updater=bg,e.stateNode=a,a._reactInternals=e,ww(e,s,t,n),e=vw(null,e,s,!0,r,n)):(e.tag=0,kt&&r&&lx(e),Ln(null,e,a,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Hf(t,e),t=e.pendingProps,a=s._init,s=a(s._payload),e.type=s,a=e.tag=wL(s),t=aa(s,t),a){case 0:e=xw(null,e,s,t,n);break e;case 1:e=MS(null,e,s,t,n);break e;case 11:e=BS(null,e,s,t,n);break e;case 14:e=zS(null,e,s,aa(s.type,t),n);break e}throw Error(se(306,s,""))}return e;case 0:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:aa(s,a),xw(t,e,s,a,n);case 1:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:aa(s,a),MS(t,e,s,a,n);case 3:e:{if(k$(e),t===null)throw Error(se(387));s=e.pendingProps,r=e.memoizedState,a=r.element,KT(t,e),ym(e,s,null,n);var i=e.memoizedState;if(s=i.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){a=Ul(Error(se(423)),e),e=VS(t,e,s,n,a);break e}else if(s!==a){a=Ul(Error(se(424)),e),e=VS(t,e,s,n,a);break e}else for(xs=ai(e.stateNode.containerInfo.firstChild),Ns=e,kt=!0,oa=null,n=GT(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ml(),s===a){e=kr(t,e,n);break e}Ln(t,e,s,n)}e=e.child}return e;case 5:return qT(e),t===null&&gw(e),s=e.type,a=e.pendingProps,r=t!==null?t.memoizedProps:null,i=a.children,dw(s,a)?i=null:r!==null&&dw(s,r)&&(e.flags|=32),w$(t,e),Ln(t,e,i,n),e.child;case 6:return t===null&&gw(e),null;case 13:return x$(t,e,n);case 4:return gx(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Vl(e,null,s,n):Ln(t,e,s,n),e.child;case 11:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:aa(s,a),BS(t,e,s,a,n);case 7:return Ln(t,e,e.pendingProps,n),e.child;case 8:return Ln(t,e,e.pendingProps.children,n),e.child;case 12:return Ln(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,a=e.pendingProps,r=e.memoizedProps,i=a.value,ut(mm,s._currentValue),s._currentValue=i,r!==null)if(ba(r.value,i)){if(r.children===a.children&&!ls.current){e=kr(t,e,n);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var o=r.dependencies;if(o!==null){i=r.child;for(var l=o.firstContext;l!==null;){if(l.context===s){if(r.tag===1){l=mr(-1,n&-n),l.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}r.lanes|=n,l=r.alternate,l!==null&&(l.lanes|=n),yw(r.return,n,e),o.lanes|=n;break}l=l.next}}else if(r.tag===10)i=r.type===e.type?null:r.child;else if(r.tag===18){if(i=r.return,i===null)throw Error(se(341));i.lanes|=n,o=i.alternate,o!==null&&(o.lanes|=n),yw(i,n,e),i=r.sibling}else i=r.child;if(i!==null)i.return=r;else for(i=r;i!==null;){if(i===e){i=null;break}if(r=i.sibling,r!==null){r.return=i.return,i=r;break}i=i.return}r=i}Ln(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,s=e.pendingProps.children,Al(e,n),a=qs(a),s=s(a),e.flags|=1,Ln(t,e,s,n),e.child;case 14:return s=e.type,a=aa(s,e.pendingProps),a=aa(s.type,a),zS(t,e,s,a,n);case 15:return y$(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:aa(s,a),Hf(t,e),e.tag=1,us(s)?(t=!0,pm(e)):t=!1,Al(e,n),f$(e,s,a),ww(e,s,a,n),vw(null,e,s,!0,t,n);case 19:return v$(t,e,n);case 22:return b$(t,e,n)}throw Error(se(156,e.tag))};function L$(t,e){return dT(t,e)}function bL(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bs(t,e,n,s){return new bL(t,e,n,s)}function Ax(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wL(t){if(typeof t=="function")return Ax(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xk)return 11;if(t===Yk)return 14}return 2}function li(t,e){var n=t.alternate;return n===null?(n=Bs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Jf(t,e,n,s,a,r){var i=2;if(s=t,typeof t=="function")Ax(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case ml:return fo(n.children,a,r,e);case Jk:i=8,a|=8;break;case Wb:return t=Bs(12,n,e,a|2),t.elementType=Wb,t.lanes=r,t;case Ub:return t=Bs(13,n,e,a),t.elementType=Ub,t.lanes=r,t;case Gb:return t=Bs(19,n,e,a),t.elementType=Gb,t.lanes=r,t;case qI:return xg(n,a,r,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case HI:i=10;break e;case KI:i=9;break e;case Xk:i=11;break e;case Yk:i=14;break e;case Wr:i=16,s=null;break e}throw Error(se(130,t==null?t:typeof t,""))}return e=Bs(i,n,e,a),e.elementType=t,e.type=s,e.lanes=r,e}function fo(t,e,n,s){return t=Bs(7,t,s,e),t.lanes=n,t}function xg(t,e,n,s){return t=Bs(22,t,s,e),t.elementType=qI,t.lanes=n,t.stateNode={isHidden:!1},t}function yb(t,e,n){return t=Bs(6,t,null,e),t.lanes=n,t}function bb(t,e,n){return e=Bs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function kL(t,e,n,s,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Q0(0),this.expirationTimes=Q0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Q0(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Ox(t,e,n,s,a,r,i,o,l){return t=new kL(t,e,n,o,l),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Bs(3,null,null,e),t.current=r,r.stateNode=t,r.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},mx(r),t}function xL(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fl,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function B$(t){if(!t)return fi;t=t._reactInternals;e:{if(Vo(t)!==t||t.tag!==1)throw Error(se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(us(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(se(171))}if(t.tag===1){var n=t.type;if(us(n))return BT(t,n,e)}return e}function z$(t,e,n,s,a,r,i,o,l){return t=Ox(n,s,!0,t,a,r,i,o,l),t.context=B$(null),n=t.current,s=Vn(),a=oi(n),r=mr(s,a),r.callback=e??null,ri(n,r,a),t.current.lanes=a,rp(t,a,s),cs(t,s),t}function vg(t,e,n,s){var a=e.current,r=Vn(),i=oi(a);return n=B$(n),e.context===null?e.context=n:e.pendingContext=n,e=mr(r,i),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=ri(a,e,i),t!==null&&(fa(t,a,i,r),Wf(t,a,i)),i}function Cm(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function QS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Dx(t,e){QS(t,e),(t=t.alternate)&&QS(t,e)}function vL(){return null}var M$=typeof reportError=="function"?reportError:function(t){console.error(t)};function jx(t){this._internalRoot=t}Sg.prototype.render=jx.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(se(409));vg(t,e,null,null)};Sg.prototype.unmount=jx.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;No(function(){vg(null,t,null,null)}),e[br]=null}};function Sg(t){this._internalRoot=t}Sg.prototype.unstable_scheduleHydration=function(t){if(t){var e=bT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hr.length&&e!==0&&e<Hr[n].priority;n++);Hr.splice(n,0,t),n===0&&kT(t)}};function _x(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ng(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ZS(){}function SL(t,e,n,s,a){if(a){if(typeof s=="function"){var r=s;s=function(){var u=Cm(i);r.call(u)}}var i=z$(e,s,t,0,null,!1,!1,"",ZS);return t._reactRootContainer=i,t[br]=i.current,Sd(t.nodeType===8?t.parentNode:t),No(),i}for(;a=t.lastChild;)t.removeChild(a);if(typeof s=="function"){var o=s;s=function(){var u=Cm(l);o.call(u)}}var l=Ox(t,0,!1,null,null,!1,!1,"",ZS);return t._reactRootContainer=l,t[br]=l.current,Sd(t.nodeType===8?t.parentNode:t),No(function(){vg(e,l,n,s)}),l}function Cg(t,e,n,s,a){var r=n._reactRootContainer;if(r){var i=r;if(typeof a=="function"){var o=a;a=function(){var l=Cm(i);o.call(l)}}vg(e,i,t,a)}else i=SL(n,e,t,a,s);return Cm(i)}gT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Jc(e.pendingLanes);n!==0&&(ex(e,n|1),cs(e,Pt()),!(Ke&6)&&(Gl=Pt()+500,Oi()))}break;case 13:No(function(){var s=wr(t,1);if(s!==null){var a=Vn();fa(s,t,1,a)}}),Dx(t,1)}};tx=function(t){if(t.tag===13){var e=wr(t,134217728);if(e!==null){var n=Vn();fa(e,t,134217728,n)}Dx(t,134217728)}};yT=function(t){if(t.tag===13){var e=oi(t),n=wr(t,e);if(n!==null){var s=Vn();fa(n,t,e,s)}Dx(t,e)}};bT=function(){return tt};wT=function(t,e){var n=tt;try{return tt=t,e()}finally{tt=n}};tw=function(t,e,n){switch(e){case"input":if(qb(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var a=mg(s);if(!a)throw Error(se(90));XI(s),qb(s,a)}}}break;case"textarea":QI(t,n);break;case"select":e=n.value,e!=null&&Tl(t,!!n.multiple,e,!1)}};rT=$x;iT=No;var NL={usingClientEntryPoint:!1,Events:[op,wl,mg,sT,aT,$x]},Pc={findFiberByHostInstance:ro,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},CL={bundleType:Pc.bundleType,version:Pc.version,rendererPackageName:Pc.rendererPackageName,rendererConfig:Pc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Tr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=uT(t),t===null?null:t.stateNode},findFiberByHostInstance:Pc.findFiberByHostInstance||vL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xf.isDisabled&&xf.supportsFiber)try{dg=xf.inject(CL),Ma=xf}catch{}}Rs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NL;Rs.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_x(e))throw Error(se(200));return xL(t,e,null,n)};Rs.createRoot=function(t,e){if(!_x(t))throw Error(se(299));var n=!1,s="",a=M$;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Ox(t,1,!1,null,null,n,!1,s,a),t[br]=e.current,Sd(t.nodeType===8?t.parentNode:t),new jx(e)};Rs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(se(188)):(t=Object.keys(t).join(","),Error(se(268,t)));return t=uT(e),t=t===null?null:t.stateNode,t};Rs.flushSync=function(t){return No(t)};Rs.hydrate=function(t,e,n){if(!Ng(e))throw Error(se(200));return Cg(null,t,e,!0,n)};Rs.hydrateRoot=function(t,e,n){if(!_x(t))throw Error(se(405));var s=n!=null&&n.hydratedSources||null,a=!1,r="",i=M$;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=z$(e,null,t,1,n??null,a,!1,r,i),t[br]=e.current,Sd(t),s)for(t=0;t<s.length;t++)n=s[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new Sg(e)};Rs.render=function(t,e,n){if(!Ng(e))throw Error(se(200));return Cg(null,t,e,!1,n)};Rs.unmountComponentAtNode=function(t){if(!Ng(t))throw Error(se(40));return t._reactRootContainer?(No(function(){Cg(null,null,t,!1,function(){t._reactRootContainer=null,t[br]=null})}),!0):!1};Rs.unstable_batchedUpdates=$x;Rs.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!Ng(n))throw Error(se(200));if(t==null||t._reactInternals===void 0)throw Error(se(38));return Cg(t,e,n,!1,s)};Rs.version="18.3.1-next-f1338f8080-20240426";function V$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(V$)}catch(t){console.error(t)}}V$(),VI.exports=Rs;var Dl=VI.exports;const Xf=Ei(Dl);var W$,eN=Dl;W$=eN.createRoot,eN.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Od(){return Od=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Od.apply(this,arguments)}var Yr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Yr||(Yr={}));const tN="popstate";function IL(t){t===void 0&&(t={});function e(a,r){let{pathname:i="/",search:o="",hash:l=""}=Wo(a.location.hash.substr(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),jw("",{pathname:i,search:o,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(a,r){let i=a.document.querySelector("base"),o="";if(i&&i.getAttribute("href")){let l=a.location.href,u=l.indexOf("#");o=u===-1?l:l.slice(0,u)}return o+"#"+(typeof r=="string"?r:Im(r))}function s(a,r){Fx(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(r)+")")}return $L(e,n,s,t)}function Gt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Fx(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function TL(){return Math.random().toString(36).substr(2,8)}function nN(t,e){return{usr:t.state,key:t.key,idx:e}}function jw(t,e,n,s){return n===void 0&&(n=null),Od({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Wo(e):e,{state:n,key:e&&e.key||s||TL()})}function Im(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Wo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function $L(t,e,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:r=!1}=s,i=a.history,o=Yr.Pop,l=null,u=c();u==null&&(u=0,i.replaceState(Od({},i.state,{idx:u}),""));function c(){return(i.state||{idx:null}).idx}function d(){o=Yr.Pop;let y=c(),g=y==null?null:y-u;u=y,l&&l({action:o,location:m.location,delta:g})}function p(y,g){o=Yr.Push;let b=jw(m.location,y,g);n&&n(b,y),u=c()+1;let w=nN(b,u),k=m.createHref(b);try{i.pushState(w,"",k)}catch(x){if(x instanceof DOMException&&x.name==="DataCloneError")throw x;a.location.assign(k)}r&&l&&l({action:o,location:m.location,delta:1})}function h(y,g){o=Yr.Replace;let b=jw(m.location,y,g);n&&n(b,y),u=c();let w=nN(b,u),k=m.createHref(b);i.replaceState(w,"",k),r&&l&&l({action:o,location:m.location,delta:0})}function f(y){let g=a.location.origin!=="null"?a.location.origin:a.location.href,b=typeof y=="string"?y:Im(y);return b=b.replace(/ $/,"%20"),Gt(g,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,g)}let m={get action(){return o},get location(){return t(a,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(tN,d),l=y,()=>{a.removeEventListener(tN,d),l=null}},createHref(y){return e(a,y)},createURL:f,encodeLocation(y){let g=f(y);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:p,replace:h,go(y){return i.go(y)}};return m}var sN;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(sN||(sN={}));function EL(t,e,n){return n===void 0&&(n="/"),RL(t,e,n,!1)}function RL(t,e,n,s){let a=typeof e=="string"?Wo(e):e,r=Px(a.pathname||"/",n);if(r==null)return null;let i=U$(t);AL(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=VL(r);o=zL(i[l],u,s)}return o}function U$(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(r,i,o)=>{let l={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:i,route:r};l.relativePath.startsWith("/")&&(Gt(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=ui([s,l.relativePath]),c=n.concat(l);r.children&&r.children.length>0&&(Gt(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),U$(r.children,e,c,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:LL(u,r.index),routesMeta:c})};return t.forEach((r,i)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))a(r,i);else for(let l of G$(r.path))a(r,i,l)}),e}function G$(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,a=n.endsWith("?"),r=n.replace(/\?$/,"");if(s.length===0)return a?[r,""]:[r];let i=G$(s.join("/")),o=[];return o.push(...i.map(l=>l===""?r:[r,l].join("/"))),a&&o.push(...i),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function AL(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:BL(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const OL=/^:[\w-]+$/,DL=3,jL=2,_L=1,FL=10,PL=-2,aN=t=>t==="*";function LL(t,e){let n=t.split("/"),s=n.length;return n.some(aN)&&(s+=PL),e&&(s+=jL),n.filter(a=>!aN(a)).reduce((a,r)=>a+(OL.test(r)?DL:r===""?_L:FL),s)}function BL(t,e){return t.length===e.length&&t.slice(0,-1).every((s,a)=>s===e[a])?t[t.length-1]-e[e.length-1]:0}function zL(t,e,n){let{routesMeta:s}=t,a={},r="/",i=[];for(let o=0;o<s.length;++o){let l=s[o],u=o===s.length-1,c=r==="/"?e:e.slice(r.length)||"/",d=rN({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),p=l.route;if(!d&&u&&n&&!s[s.length-1].route.index&&(d=rN({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:ui([r,d.pathname]),pathnameBase:HL(ui([r,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(r=ui([r,d.pathnameBase]))}return i}function rN(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=ML(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let r=a[0],i=r.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:s.reduce((u,c,d)=>{let{paramName:p,isOptional:h}=c;if(p==="*"){let m=o[d]||"";i=r.slice(0,r.length-m.length).replace(/(.)\/+$/,"$1")}const f=o[d];return h&&!f?u[p]=void 0:u[p]=(f||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:i,pattern:t}}function ML(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Fx(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function VL(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Fx(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Px(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function WL(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?Wo(t):t;return{pathname:n?n.startsWith("/")?n:UL(n,e):e,search:KL(s),hash:qL(a)}}function UL(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function wb(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function GL(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function H$(t,e){let n=GL(t);return e?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function K$(t,e,n,s){s===void 0&&(s=!1);let a;typeof t=="string"?a=Wo(t):(a=Od({},t),Gt(!a.pathname||!a.pathname.includes("?"),wb("?","pathname","search",a)),Gt(!a.pathname||!a.pathname.includes("#"),wb("#","pathname","hash",a)),Gt(!a.search||!a.search.includes("#"),wb("#","search","hash",a)));let r=t===""||a.pathname==="",i=r?"/":a.pathname,o;if(i==null)o=n;else{let d=e.length-1;if(!s&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),d-=1;a.pathname=p.join("/")}o=d>=0?e[d]:"/"}let l=WL(a,o),u=i&&i!=="/"&&i.endsWith("/"),c=(r||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const ui=t=>t.join("/").replace(/\/\/+/g,"/"),HL=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),KL=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,qL=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function JL(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const q$=["post","put","patch","delete"];new Set(q$);const XL=["get",...q$];new Set(XL);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dd(){return Dd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Dd.apply(this,arguments)}const Lx=B.createContext(null),YL=B.createContext(null),Uo=B.createContext(null),Ig=B.createContext(null),Di=B.createContext({outlet:null,matches:[],isDataRoute:!1}),J$=B.createContext(null);function QL(t,e){let{relative:n}=e===void 0?{}:e;up()||Gt(!1);let{basename:s,navigator:a}=B.useContext(Uo),{hash:r,pathname:i,search:o}=Q$(t,{relative:n}),l=i;return s!=="/"&&(l=i==="/"?s:ui([s,i])),a.createHref({pathname:l,search:o,hash:r})}function up(){return B.useContext(Ig)!=null}function ji(){return up()||Gt(!1),B.useContext(Ig).location}function X$(t){B.useContext(Uo).static||B.useLayoutEffect(t)}function Bx(){let{isDataRoute:t}=B.useContext(Di);return t?dB():ZL()}function ZL(){up()||Gt(!1);let t=B.useContext(Lx),{basename:e,future:n,navigator:s}=B.useContext(Uo),{matches:a}=B.useContext(Di),{pathname:r}=ji(),i=JSON.stringify(H$(a,n.v7_relativeSplatPath)),o=B.useRef(!1);return X$(()=>{o.current=!0}),B.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let d=K$(u,JSON.parse(i),r,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:ui([e,d.pathname])),(c.replace?s.replace:s.push)(d,c.state,c)},[e,s,i,r,t])}function Y$(){let{matches:t}=B.useContext(Di),e=t[t.length-1];return e?e.params:{}}function Q$(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=B.useContext(Uo),{matches:a}=B.useContext(Di),{pathname:r}=ji(),i=JSON.stringify(H$(a,s.v7_relativeSplatPath));return B.useMemo(()=>K$(t,JSON.parse(i),r,n==="path"),[t,i,r,n])}function eB(t,e){return tB(t,e)}function tB(t,e,n,s){up()||Gt(!1);let{navigator:a,static:r}=B.useContext(Uo),{matches:i}=B.useContext(Di),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let c=ji(),d;if(e){var p;let g=typeof e=="string"?Wo(e):e;u==="/"||(p=g.pathname)!=null&&p.startsWith(u)||Gt(!1),d=g}else d=c;let h=d.pathname||"/",f=h;if(u!=="/"){let g=u.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let m=!r&&n&&n.matches&&n.matches.length>0?n.matches:EL(t,{pathname:f}),y=iB(m&&m.map(g=>Object.assign({},g,{params:Object.assign({},l,g.params),pathname:ui([u,a.encodeLocation?a.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?u:ui([u,a.encodeLocation?a.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,s);return e&&y?B.createElement(Ig.Provider,{value:{location:Dd({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Yr.Pop}},y):y}function nB(){let t=cB(),e=JL(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return B.createElement(B.Fragment,null,B.createElement("h2",null,"Unexpected Application Error!"),B.createElement("h3",{style:{fontStyle:"italic"}},e),n?B.createElement("pre",{style:a},n):null,null)}const sB=B.createElement(nB,null);class aB extends B.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?B.createElement(Di.Provider,{value:this.props.routeContext},B.createElement(J$.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function rB(t){let{routeContext:e,match:n,children:s}=t,a=B.useContext(Lx);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),B.createElement(Di.Provider,{value:e},s)}function iB(t,e,n,s){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var r;if(!n)return null;if(n.errors)t=n.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=(a=n)==null?void 0:a.errors;if(o!=null){let c=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);c>=0||Gt(!1),i=i.slice(0,Math.min(i.length,c+1))}let l=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let c=0;c<i.length;c++){let d=i[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:p,errors:h}=n,f=d.route.loader&&p[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||f){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((c,d,p)=>{let h,f=!1,m=null,y=null;n&&(h=o&&d.route.id?o[d.route.id]:void 0,m=d.route.errorElement||sB,l&&(u<0&&p===0?(f=!0,y=null):u===p&&(f=!0,y=d.route.hydrateFallbackElement||null)));let g=e.concat(i.slice(0,p+1)),b=()=>{let w;return h?w=m:f?w=y:d.route.Component?w=B.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=c,B.createElement(rB,{match:d,routeContext:{outlet:c,matches:g,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?B.createElement(aB,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:b(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):b()},null)}var Z$=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Z$||{}),Tm=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Tm||{});function oB(t){let e=B.useContext(Lx);return e||Gt(!1),e}function lB(t){let e=B.useContext(YL);return e||Gt(!1),e}function uB(t){let e=B.useContext(Di);return e||Gt(!1),e}function eE(t){let e=uB(),n=e.matches[e.matches.length-1];return n.route.id||Gt(!1),n.route.id}function cB(){var t;let e=B.useContext(J$),n=lB(Tm.UseRouteError),s=eE(Tm.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function dB(){let{router:t}=oB(Z$.UseNavigateStable),e=eE(Tm.UseNavigateStable),n=B.useRef(!1);return X$(()=>{n.current=!0}),B.useCallback(function(a,r){r===void 0&&(r={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Dd({fromRouteId:e},r)))},[t,e])}function pB(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Vr(t){Gt(!1)}function hB(t){let{basename:e="/",children:n=null,location:s,navigationType:a=Yr.Pop,navigator:r,static:i=!1,future:o}=t;up()&&Gt(!1);let l=e.replace(/^\/*/,"/"),u=B.useMemo(()=>({basename:l,navigator:r,static:i,future:Dd({v7_relativeSplatPath:!1},o)}),[l,o,r,i]);typeof s=="string"&&(s=Wo(s));let{pathname:c="/",search:d="",hash:p="",state:h=null,key:f="default"}=s,m=B.useMemo(()=>{let y=Px(c,l);return y==null?null:{location:{pathname:y,search:d,hash:p,state:h,key:f},navigationType:a}},[l,c,d,p,h,f,a]);return m==null?null:B.createElement(Uo.Provider,{value:u},B.createElement(Ig.Provider,{children:n,value:m}))}function fB(t){let{children:e,location:n}=t;return eB(_w(e),n)}new Promise(()=>{});function _w(t,e){e===void 0&&(e=[]);let n=[];return B.Children.forEach(t,(s,a)=>{if(!B.isValidElement(s))return;let r=[...e,a];if(s.type===B.Fragment){n.push.apply(n,_w(s.props.children,r));return}s.type!==Vr&&Gt(!1),!s.props.index||!s.props.children||Gt(!1);let i={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=_w(s.props.children,r)),n.push(i)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fw(){return Fw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Fw.apply(this,arguments)}function mB(t,e){if(t==null)return{};var n={},s=Object.keys(t),a,r;for(r=0;r<s.length;r++)a=s[r],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function gB(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function yB(t,e){return t.button===0&&(!e||e==="_self")&&!gB(t)}const bB=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],wB="6";try{window.__reactRouterVersion=wB}catch{}const kB="startTransition",iN=mF[kB];function xB(t){let{basename:e,children:n,future:s,window:a}=t,r=B.useRef();r.current==null&&(r.current=IL({window:a,v5Compat:!0}));let i=r.current,[o,l]=B.useState({action:i.action,location:i.location}),{v7_startTransition:u}=s||{},c=B.useCallback(d=>{u&&iN?iN(()=>l(d)):l(d)},[l,u]);return B.useLayoutEffect(()=>i.listen(c),[i,c]),B.useEffect(()=>pB(s),[s]),B.createElement(hB,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:i,future:s})}const vB=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",SB=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ss=B.forwardRef(function(e,n){let{onClick:s,relative:a,reloadDocument:r,replace:i,state:o,target:l,to:u,preventScrollReset:c,viewTransition:d}=e,p=mB(e,bB),{basename:h}=B.useContext(Uo),f,m=!1;if(typeof u=="string"&&SB.test(u)&&(f=u,vB))try{let w=new URL(window.location.href),k=u.startsWith("//")?new URL(w.protocol+u):new URL(u),x=Px(k.pathname,h);k.origin===w.origin&&x!=null?u=x+k.search+k.hash:m=!0}catch{}let y=QL(u,{relative:a}),g=NB(u,{replace:i,state:o,target:l,preventScrollReset:c,relative:a,viewTransition:d});function b(w){s&&s(w),w.defaultPrevented||g(w)}return B.createElement("a",Fw({},p,{href:f||y,onClick:m||r?s:b,ref:n,target:l}))});var oN;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(oN||(oN={}));var lN;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(lN||(lN={}));function NB(t,e){let{target:n,replace:s,state:a,preventScrollReset:r,relative:i,viewTransition:o}=e===void 0?{}:e,l=Bx(),u=ji(),c=Q$(t,{relative:i});return B.useCallback(d=>{if(yB(d,n)){d.preventDefault();let p=s!==void 0?s:Im(u)===Im(c);l(t,{replace:p,state:a,preventScrollReset:r,relative:i,viewTransition:o})}},[u,l,c,s,a,n,t,r,i,o])}/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var CB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),vn=(t,e)=>{const n=B.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:o="",children:l,...u},c)=>B.createElement("svg",{ref:c,...CB,width:a,height:a,stroke:s,strokeWidth:i?Number(r)*24/Number(a):r,className:["lucide",`lucide-${IB(t)}`,o].join(" "),...u},[...e.map(([d,p])=>B.createElement(d,p)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=vn("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uN=vn("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=vn("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=vn("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=vn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=vn("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=vn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=vn("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dN=vn("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=vn("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=vn("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=vn("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=vn("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=vn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=vn("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pN=vn("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=vn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),hN=[{name:"Beranda",href:"/"},{name:"Deteksi Benda",href:"/deteksi-benda"},{name:"Kuis",href:"/kuis"},{name:"Artikel",href:"/artikel"},{name:"Tentang",href:"/tentang"}],FB=72,PB=()=>{const t=ji(),[e,n]=B.useState(!1),[s,a]=B.useState(!1),r=o=>t.pathname===o;B.useEffect(()=>{const o=()=>{a(window.scrollY>50),e&&n(!1)};return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[e]),B.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]);const i=()=>{n(!e)};return N.jsxs(N.Fragment,{children:[N.jsx("div",{className:`fixed inset-0 bg-black/70 backdrop-blur-sm z-30 md:hidden transition-opacity duration-300 ${e?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>n(!1),"aria-hidden":"true"}),N.jsx("header",{className:`fixed top-0 left-0 right-0 z-40 transition-all duration-300 ${s?"bg-surface-50 py-3 shadow-lg backdrop-blur-lg":"bg-transparent py-5"}`,children:N.jsxs("div",{className:"container mx-auto flex items-center justify-between relative px-6",children:[" ",N.jsx(ss,{to:"/",className:"flex items-center gap-2",onClick:()=>e&&n(!1),children:N.jsx("img",{src:"/nihonme/img/icon/nihonme-icon.svg",alt:"NihonMe Logo",className:"h-8 w-auto"})}),N.jsx("nav",{className:"hidden md:flex flex-1 justify-end items-center",children:N.jsx("ul",{className:"flex items-center space-x-6 lg:space-x-8",children:hN.map(o=>N.jsx("li",{children:N.jsx(ss,{to:o.href,className:`font-medium text-sm lg:text-base transition-colors relative after:absolute after:-bottom-1 after:left-0 after:h-[2px] after:w-0 after:bg-primary-600 hover:after:w-full after:transition-all after:duration-300 ${r(o.href)?"text-primary-600 after:w-full":"text-gray-500 hover:text-primary-600"}`,children:o.name})},o.name))})}),N.jsxs("button",{className:"md:hidden text-primary-500 p-2 z-50 relative",onClick:i,"aria-label":e?"Close menu":"Open menu","aria-expanded":e,"aria-controls":"mobile-menu",children:[N.jsx(jB,{size:28,className:`transition-opacity duration-300 ${e?"opacity-0 absolute":"opacity-100"}`}),N.jsx(hd,{size:28,className:`transition-opacity duration-300 ${e?"opacity-100":"opacity-0 absolute"}`})]})]})}),N.jsx("div",{id:"mobile-menu",className:`md:hidden fixed inset-x-0 top-0 bg-surface-50 z-30 h-screen transform transition-transform duration-300 ease-in-out flex flex-col ${e?"translate-x-0":"translate-x-full"}`,style:{paddingTop:`${FB}px`},children:N.jsxs("div",{className:"flex flex-col items-center justify-center flex-grow space-y-8 pb-16",children:[" ",hN.map(o=>N.jsx(ss,{to:o.href,className:`text-xl font-medium transition-colors ${r(o.href)?"text-primary-600":"text-surface-700 hover:text-primary-600"}`,onClick:()=>n(!1),children:o.name},o.name))]})})]})},LB=()=>{const[t,e]=B.useState(!1),n=ji();return B.useEffect(()=>{const s=setTimeout(()=>{e(!0);const a=setTimeout(()=>{e(!1)},3e3);return()=>clearTimeout(a)},2e3);return()=>clearTimeout(s)},[n.pathname]),n.pathname==="/deteksi-benda"||n.pathname==="/kuis/hiragana"||n.pathname==="/kuis/katakana"||n.pathname==="/kuis/kosakata"?null:N.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:N.jsxs("div",{className:"relative",children:[N.jsxs("div",{className:`absolute bottom-full right-0 mb-2 px-4 py-2 bg-surface-900 text-white rounded-lg shadow-lg
                     transform transition-all duration-300 ease-in-out whitespace-nowrap
                     ${t?"opacity-100 translate-y-0":"opacity-0 translate-y-2 pointer-events-none"}`,children:[N.jsx("div",{className:"text-sm",children:"Deteksi Benda dengan AI"}),N.jsx("div",{className:"absolute bottom-0 right-6 transform translate-y-1/2 rotate-45 w-2 h-2 bg-surface-900"})]}),N.jsx(ss,{to:"/deteksi-benda",className:`flex items-center justify-center w-14 h-14 rounded-full bg-primary-600 text-white\r
                   shadow-lg hover:shadow-xl transform hover:-translate-y-1 active:translate-y-0\r
                   transition-all duration-300 ease-in-out`,onMouseEnter:()=>e(!0),onMouseLeave:()=>e(!1),"aria-label":"Go to Object Detection",children:N.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})})},BB=({children:t})=>N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-surface-50 to-surface-100",children:[N.jsx(PB,{}),N.jsxs("main",{className:"pt-16 px-4",children:[" ",t]}),N.jsx(LB,{})]}),mi={:{japanese:"",romaji:"hito",indonesian:"orang",imageUrl:"/nihonme/img/object/1.webp",sentences:[{japanese:"",romaji:"Hito wa nihongo o benkyou shiteimasu.",indonesian:"Orang itu sedang belajar bahasa Jepang."},{japanese:"",romaji:"Sono hito wa sensei desu.",indonesian:"Orang itu adalah seorang guru."},{japanese:"",romaji:"Hito wa tomodachi to asobimasu.",indonesian:"Orang itu bermain dengan teman-temannya."}],description:"Kata  berarti orang, dan ini adalah salah satu kata benda paling dasar dalam bahasa Jepang, digunakan untuk merujuk pada setiap manusia."},:{japanese:"",romaji:"jitensha",indonesian:"sepeda",imageUrl:"/nihonme/img/object/2.webp",sentences:[{japanese:"",romaji:"Jitensha de gakkou e ikimasu.",indonesian:"Saya pergi ke sekolah dengan sepeda."},{japanese:"",romaji:"Atarashii jitensha o kaimashita.",indonesian:"Saya membeli sepeda baru."},{japanese:"",romaji:"Jitensha wa kankyou ni ii desu.",indonesian:"Sepeda baik untuk lingkungan."}],description:" berarti sepeda, gabungan dari  (sendiri) dan  (kendaraan), menjadikannya kendaraan yang Anda kayuh sendiri."},:{japanese:"",romaji:"kuruma",indonesian:"mobil",imageUrl:"/nihonme/img/object/3.webp",sentences:[{japanese:"",romaji:"Kuruma de suupaa ni ikimasu.",indonesian:"Saya pergi ke supermarket dengan mobil."},{japanese:"",romaji:"Kuruma wa hayai desu.",indonesian:"Mobil itu cepat."},{japanese:"",romaji:"Kuruma o unten shimasu.",indonesian:"Saya mengendarai mobil."}],description:" berarti mobil, alat transportasi umum di Jepang dan seluruh dunia."},:{japanese:"",romaji:"ootobai",indonesian:"sepeda motor",imageUrl:"/nihonme/img/object/4.webp",sentences:[{japanese:"",romaji:"Ootobai de tsuuringu shimasu.",indonesian:"Saya pergi touring dengan sepeda motor."},{japanese:"",romaji:"Ootobai wa hayai desu.",indonesian:"Sepeda motor itu cepat."},{japanese:"",romaji:"Ootobai ni noru no ga suki desu.",indonesian:"Saya suka mengendarai sepeda motor."}],description:" dipinjam dari kata bahasa Inggris 'auto bike' yang berarti sepeda motor, banyak digunakan di Jepang."},:{japanese:"",romaji:"hikouki",indonesian:"pesawat terbang",imageUrl:"/nihonme/img/object/5.webp",sentences:[{japanese:"",romaji:"Hikouki de tobimasu.",indonesian:"Saya terbang dengan pesawat."},{japanese:"",romaji:"Hikouki wa sora o tobimasu.",indonesian:"Pesawat terbang di langit."},{japanese:"",romaji:"Hikouki no chiketto o kaimashita.",indonesian:"Saya membeli tiket pesawat."}],description:" berarti pesawat terbang, dari  (penerbangan) dan  (mesin)."},:{japanese:"",romaji:"basu",indonesian:"bus",imageUrl:"/nihonme/img/object/6.webp",sentences:[{japanese:"",romaji:"Basu de gakkou e ikimasu.",indonesian:"Saya pergi ke sekolah dengan bus."},{japanese:"",romaji:"Basu wa ookii desu.",indonesian:"Bus itu besar."},{japanese:"",romaji:"Basu o matteimasu.",indonesian:"Saya sedang menunggu bus."}],description:" adalah kata pinjaman dari bahasa Inggris 'bus,' merujuk pada kendaraan transportasi umum."},:{japanese:"",romaji:"densha",indonesian:"kereta listrik",imageUrl:"/nihonme/img/object/7.webp",sentences:[{japanese:"",romaji:"Densha ni norimasu.",indonesian:"Saya naik kereta listrik."},{japanese:"",romaji:"Densha wa hayai desu.",indonesian:"Kereta listrik itu cepat."},{japanese:"",romaji:"Densha de shigoto ni ikimasu.",indonesian:"Saya pergi kerja dengan kereta listrik."}],description:" berarti kereta listrik, metode transportasi yang sangat populer di Jepang."},:{japanese:"",romaji:"torakku",indonesian:"truk",imageUrl:"/nihonme/img/object/8.webp",sentences:[{japanese:"",romaji:"Torakku ga douro o hashitteimasu.",indonesian:"Truk itu berjalan di jalan raya."},{japanese:"",romaji:"Torakku wa ookii desu.",indonesian:"Truk itu besar."},{japanese:"",romaji:"Torakku de nimotsu o hakobimasu.",indonesian:"Saya membawa barang dengan truk."}],description:" dipinjam dari bahasa Inggris 'truck,' digunakan untuk mengangkut barang."},:{japanese:"",romaji:"booto",indonesian:"perahu",imageUrl:"/nihonme/img/object/9.webp",sentences:[{japanese:"",romaji:"Booto de umi o watarimasu.",indonesian:"Saya menyeberangi laut dengan perahu."},{japanese:"",romaji:"Booto wa mizu no ue o utsukushii desu.",indonesian:"Perahu itu indah di atas air."},{japanese:"",romaji:"Booto ni noru no ga tanoshii desu.",indonesian:"Naik perahu itu menyenangkan."}],description:" dipinjam dari bahasa Inggris 'boat,' sebuah kapal air kecil."},:{japanese:"",romaji:"shingouki",indonesian:"lampu lalu lintas",imageUrl:"/nihonme/img/object/10.webp",sentences:[{japanese:"",romaji:"Shingouki wa aka desu.",indonesian:"Lampu lalu lintas berwarna merah."},{japanese:"",romaji:"Shingouki ga midori ni narimashita.",indonesian:"Lampu lalu lintas berubah menjadi hijau."},{japanese:"",romaji:"Michi o shingouki de watarimasu.",indonesian:"Saya menyeberang jalan di lampu lalu lintas."}],description:"Kata  (shingouki) menggabungkan  (shingou) yang berarti 'sinyal' dan  (ki) yang berarti 'mesin'. Lampu lalu lintas di Jepang seringkali berwarna biru, bukan hijau, untuk 'jalan', yang disebut  (ao)!"},:{japanese:"",romaji:"shoukasen",indonesian:"hidran kebakaran",imageUrl:"/nihonme/img/object/11.webp",sentences:[{japanese:"",romaji:"Shoukasen wa akai desu.",indonesian:"Hidran kebakaran itu berwarna merah."},{japanese:"",romaji:"Koko ni shoukasen ga arimasu.",indonesian:"Ada hidran kebakaran di sini."},{japanese:"",romaji:"Shoukasen no mizu wa tsuyoi desu.",indonesian:"Air dari hidran kebakaran itu kuat."}],description:" (shoukasen) berarti 'hidran kebakaran'. Anda akan melihatnya di jalanan di Jepang, seringkali berwarna merah, siap membantu petugas pemadam kebakaran. Kata ini terdiri dari  (shouka - pemadaman api) dan  (sen - sumbat/katup)."},:{japanese:"",romaji:"sutoppu sain",indonesian:"rambu berhenti",imageUrl:"/nihonme/img/object/12.webp",sentences:[{japanese:"",romaji:"Sutoppu sain de tomarimasu.",indonesian:"Saya berhenti di rambu berhenti."},{japanese:"",romaji:"Ano sutoppu sain ga miemasu ka.",indonesian:"Apakah Anda bisa melihat rambu berhenti itu?"},{japanese:"",romaji:"Sutoppu sain wa taisetsu desu.",indonesian:"Rambu berhenti itu penting."}],description:" (sutoppu sain) adalah kata Jepang untuk 'rambu berhenti', diambil langsung dari bahasa Inggris! Di Jepang, rambu berhenti berbentuk segitiga terbalik berwarna merah dan seringkali bertuliskan  (tomare), yang berarti 'Berhenti!'."},:{japanese:"",romaji:"paakingu meetaa",indonesian:"meteran parkir",imageUrl:"/nihonme/img/object/13.webp",sentences:[{japanese:"",romaji:"Paakingu meetaa ni okane o iremasu.",indonesian:"Saya memasukkan uang ke meteran parkir."},{japanese:"",romaji:"Kono paakingu meetaa wa kowareteimasu.",indonesian:"Meteran parkir ini rusak."},{japanese:"",romaji:"Paakingu meetaa no jikan ga kiremashita.",indonesian:"Waktu di meteran parkir sudah habis."}],description:" (paakingu meetaa) adalah kata pinjaman dari bahasa Inggris untuk 'meteran parkir'. Di Jepang, Anda akan menemukannya di area kota yang sibuk untuk mengatur ruang dan waktu parkir."},:{japanese:"",romaji:"benchi",indonesian:"bangku",imageUrl:"/nihonme/img/object/14.webp",sentences:[{japanese:"",romaji:"Kouen no benchi ni suwarimasu.",indonesian:"Saya duduk di bangku di taman."},{japanese:"",romaji:"Kono benchi wa atarashii desu.",indonesian:"Bangku ini baru."},{japanese:"",romaji:"Eki no hoomu ni benchi ga arimasu.",indonesian:"Ada bangku di peron stasiun."}],description:" (benchi) berasal dari kata Inggris 'bench'. Anda dapat menemukan bangku di taman, stasiun kereta, dan banyak tempat umum di Jepang untuk orang duduk dan beristirahat."},:{japanese:"",romaji:"tori",indonesian:"burung",imageUrl:"/nihonme/img/object/15.webp",sentences:[{japanese:"",romaji:"Tori ga sora o tondeimasu.",indonesian:"Seekor burung sedang terbang di langit."},{japanese:"",romaji:"Kawaii tori ga imasu ne.",indonesian:"Ada burung yang lucu ya."},{japanese:"",romaji:"Asa, tori no koe ga kikoemasu.",indonesian:"Di pagi hari, saya bisa mendengar suara burung."}],description:" (tori) berarti 'burung' dalam bahasa Jepang. Ini adalah kata yang sederhana dan umum. Jepang memiliki banyak spesies burung asli yang indah, dan motif burung populer dalam seni tradisional."},:{japanese:"",romaji:"neko",indonesian:"kucing",imageUrl:"/nihonme/img/object/16.webp",sentences:[{japanese:"",romaji:"Neko ga suki desu.",indonesian:"Saya suka kucing."},{japanese:"",romaji:"Sono neko wa shiroi desu.",indonesian:"Kucing itu berwarna putih."},{japanese:"",romaji:"Neko ga hirune o shiteimasu.",indonesian:"Kucing itu sedang tidur siang."}],description:" (neko) berarti 'kucing'. Kucing sangat populer di Jepang, dan Anda mungkin tahu  (maneki-neko), patung kucing yang melambai yang dipercaya membawa keberuntungan!"},:{japanese:"",romaji:"inu",indonesian:"anjing",imageUrl:"/nihonme/img/object/17.webp",sentences:[{japanese:"",romaji:"Inu to sanpo ni ikimasu.",indonesian:"Saya pergi jalan-jalan dengan anjing."},{japanese:"",romaji:"Kono inu wa otonashii desu.",indonesian:"Anjing ini tenang."},{japanese:"",romaji:"Inu ga wanwan hoeteimasu.",indonesian:'Anjing itu menggonggong "guk guk".'}],description:" (inu) berarti 'anjing'. Anjing juga merupakan hewan peliharaan populer di Jepang. Akita Inu dan Shiba Inu adalah ras anjing Jepang terkenal di seluruh dunia."},:{japanese:"",romaji:"uma",indonesian:"kuda",imageUrl:"/nihonme/img/object/18.webp",sentences:[{japanese:"",romaji:"Uma ga hashitteimasu.",indonesian:"Kuda itu sedang berlari."},{japanese:"",romaji:"Watashi wa uma ni noru koto ga dekimasu.",indonesian:"Saya bisa menunggang kuda."},{japanese:"",romaji:"Uma wa ninjin ga suki desu.",indonesian:"Kuda suka wortel."}],description:" (uma) berarti 'kuda'. Kuda telah menjadi penting dalam sejarah Jepang, terutama bagi samurai. Anda juga bisa melihatnya dalam festival tradisional dan pacuan kuda."},:{japanese:"",romaji:"hitsuji",indonesian:"domba",imageUrl:"/nihonme/img/object/19.webp",sentences:[{japanese:"",romaji:"Hitsuji wa shirokute fuwafuwa desu.",indonesian:"Domba itu putih dan berbulu halus."},{japanese:"",romaji:"Bokujou ni takusan no hitsuji ga imasu.",indonesian:"Ada banyak domba di peternakan."},{japanese:"",romaji:"Hitsuji wa mee mee nakimasu.",indonesian:'Domba mengembik "mbe mbe".'}],description:" (hitsuji) berarti 'domba'. Meskipun secara historis tidak seumum hewan lain di Jepang, domba dikenal karena wolnya dan sering terlihat di kebun binatang mini atau peternakan di pedesaan."},:{japanese:"",romaji:"ushi",indonesian:"sapi",imageUrl:"/nihonme/img/object/20.webp",sentences:[{japanese:"",romaji:"Ushi ga kusa o tabeteimasu.",indonesian:"Sapi itu sedang makan rumput."},{japanese:"",romaji:"Kono ushi wa ookii desu.",indonesian:"Sapi ini besar."},{japanese:"",romaji:"Ushi kara gyuunyuu ga toremasu.",indonesian:"Kita bisa mendapatkan susu dari sapi."}],description:" (ushi) berarti 'sapi' atau 'ternak'. Daging sapi Jepang terkenal seperti Wagyu berasal dari hewan ini. Mereka juga penting untuk produk susu."},:{japanese:"",romaji:"zou",indonesian:"gajah",imageUrl:"/nihonme/img/object/21.webp",sentences:[{japanese:"",romaji:"Doubutsuen de zou o mimashita.",indonesian:"Saya melihat gajah di kebun binatang."},{japanese:"",romaji:"Zou no hana wa nagai desu.",indonesian:"Belalai gajah itu panjang."},{japanese:"",romaji:"Zou wa kashikoi doubutsu desu.",indonesian:"Gajah adalah hewan yang cerdas."}],description:" (zou) adalah kata Jepang untuk 'gajah'. Meskipun bukan asli Jepang, gajah adalah hewan populer yang ditemukan di kebun binatang dan sering ditampilkan dalam cerita anak-anak."},:{japanese:"",romaji:"kuma",indonesian:"beruang",imageUrl:"/nihonme/img/object/22.webp",sentences:[{japanese:"",romaji:"Mori no naka ni kuma ga imasu.",indonesian:"Ada beruang di dalam hutan."},{japanese:"",romaji:"Kuma wa hachimitsu ga suki desu.",indonesian:"Beruang suka madu."},{japanese:"",romaji:"Ano kuma no nuigurumi wa kawaii desu.",indonesian:"Boneka beruang itu lucu."}],description:" (kuma) berarti 'beruang'. Jepang memiliki spesies beruang asli, seperti beruang coklat Ussuri di Hokkaido dan beruang hitam Asia. Hati-hati saat mendaki di habitat beruang!"},:{japanese:"",romaji:"shimauma",indonesian:"zebra",imageUrl:"/nihonme/img/object/23.webp",sentences:[{japanese:"",romaji:"Shimauma wa kuro to shiro desu.",indonesian:"Zebra berwarna hitam dan putih."},{japanese:"",romaji:"Doubutsuen de shimauma o mimashita.",indonesian:"Saya melihat zebra di kebun binatang."},{japanese:"",romaji:"Shimauma wa afurika ni sundeimasu.",indonesian:"Zebra tinggal di Afrika."}],description:" (shimauma) secara harfiah berarti 'kuda bergaris' ( shima = garis,  uma = kuda). Ini adalah nama yang lugas dan deskriptif untuk hewan ini!"},:{japanese:"",romaji:"kirin",indonesian:"jerapah",imageUrl:"/nihonme/img/object/24.webp",sentences:[{japanese:"",romaji:"Kirin wa kubi ga nagai desu.",indonesian:"Jerapah memiliki leher yang panjang."},{japanese:"",romaji:"Kirin wa takai ki no ha o tabemasu.",indonesian:"Jerapah makan daun dari pohon tinggi."},{japanese:"",romaji:"Ano kirin wa ookii desu ne.",indonesian:"Jerapah itu besar ya."}],description:" (kirin) adalah kata Jepang untuk 'jerapah'. Menariknya, 'Kirin' juga merupakan makhluk mitos dalam cerita rakyat Asia Timur, mirip unicorn, dan jerapah dinamai menurut namanya karena sifatnya yang lembut dan tinggi badannya yang mengesankan."},:{japanese:"",romaji:"ryukkusakku",indonesian:"ransel",imageUrl:"/nihonme/img/object/25.webp",sentences:[{japanese:"",romaji:"Ryukkusakku ni okashi o iremasu.",indonesian:"Saya memasukkan makanan ringan ke dalam ransel."},{japanese:"",romaji:"Kono ryukkusakku wa karui desu.",indonesian:"Ransel ini ringan."},{japanese:"",romaji:"Gakkou e ryukkusakku o motte ikimasu.",indonesian:"Saya membawa ransel ke sekolah."}],description:" (ryukkusakku) berasal dari kata Jerman 'Rucksack'. Ini umum digunakan di Jepang untuk ransel, sering disingkat menjadi  (ryukku)."},:{japanese:"",romaji:"kasa",indonesian:"payung",imageUrl:"/nihonme/img/object/26.webp",sentences:[{japanese:"",romaji:"Ame ga futteiru node, kasa o sashimasu.",indonesian:"Karena hujan, saya akan menggunakan payung."},{japanese:"",romaji:"Watashi wa aoi kasa o motteimasu.",indonesian:"Saya punya payung biru."},{japanese:"",romaji:"Dekakeru mae ni, kasa o wasurenaide kudasai.",indonesian:"Tolong jangan lupa payungmu sebelum pergi keluar."}],description:" (kasa) berarti 'payung' atau 'parasol'. Jepang memiliki budaya payung yang kuat karena musim hujannya, dan Anda akan melihat banyak payung yang unik dan bergaya."},:{japanese:"",romaji:"handobaggu",indonesian:"tas tangan",imageUrl:"/nihonme/img/object/27.webp",sentences:[{japanese:"",romaji:"Ano hito wa atarashii handobaggu o kaimashita.",indonesian:"Orang itu membeli tas tangan baru."},{japanese:"",romaji:"Handobaggu no naka ni saifu ga arimasu.",indonesian:"Ada dompet di dalam tas tangan."},{japanese:"",romaji:"Kono handobaggu wa totemo oshare desu.",indonesian:"Tas tangan ini sangat modis."}],description:" (handobaggu) adalah kata pinjaman langsung dari bahasa Inggris untuk 'tas tangan'. Ini digunakan untuk merujuk pada berbagai gaya tas yang dibawa dengan tangan atau di lengan."},:{japanese:"",romaji:"nekutai",indonesian:"dasi",imageUrl:"/nihonme/img/object/28.webp",sentences:[{japanese:"",romaji:"Chichi wa shigoto ni nekutai o shimasu.",indonesian:"Ayah saya memakai dasi untuk bekerja."},{japanese:"",romaji:"Akai nekutai ga suki desu.",indonesian:"Saya suka dasi merah."},{japanese:"",romaji:"Kono nekutai wa purezento desu.",indonesian:"Dasi ini adalah hadiah."}],description:" (nekutai) berasal dari kata Inggris 'necktie'. Ini adalah bagian penting dari pakaian bisnis untuk pria di Jepang, yang sering disebut 'salaryman'."},:{japanese:"",romaji:"suutsukeesu",indonesian:"koper",imageUrl:"/nihonme/img/object/29.webp",sentences:[{japanese:"",romaji:"Ryokou no tame ni suutsukeesu o junbi shimasu.",indonesian:"Saya akan menyiapkan koper untuk perjalanan."},{japanese:"",romaji:"Suutsukeesu ga omoi desu.",indonesian:"Koper itu berat."},{japanese:"",romaji:"Kuukou de suutsukeesu o azukemasu.",indonesian:"Saya akan menitipkan koper saya di bandara."}],description:" (suutsukeesu) adalah kata pinjaman dari bahasa Inggris, 'suitcase'. Ini sangat diperlukan untuk bepergian, dan di Jepang, Anda akan sering melihat orang menggunakannya, terutama di kereta ke dan dari bandara."},:{japanese:"",romaji:"furisubii",indonesian:"frisbi",imageUrl:"/nihonme/img/object/30.webp",sentences:[{japanese:"",romaji:"Kouen de furisubii o shimashou.",indonesian:"Ayo bermain frisbi di taman."},{japanese:"",romaji:"Inu ga furisubii o torimashita.",indonesian:"Anjing itu menangkap frisbi."},{japanese:"",romaji:"Furisubii o tooku e nagemasu.",indonesian:"Saya melempar frisbi jauh."}],description:" (furisubii) berasal langsung dari nama merek 'Frisbee'. Ini adalah barang populer untuk bermain di taman dan di pantai di Jepang."},:{japanese:"",romaji:"sukii",indonesian:"ski",imageUrl:"/nihonme/img/object/31.webp",sentences:[{japanese:"",romaji:"Watashi wa atarashii sukii ga hoshii desu.",indonesian:"Saya ingin ski (peralatan) baru."},{japanese:"",romaji:"Kono sukii wa nagakute aoi desu.",indonesian:"Ski (peralatan) ini panjang dan biru."},{japanese:"",romaji:"Sukii o kuruma ni tsumimashita.",indonesian:"Saya memuat ski (peralatan) ke dalam mobil."}],description:" (sukii) adalah 'ski', peralatan yang digunakan untuk meluncur di atas salju. Menyewa  umum dilakukan di resor ski Jepang."},:{japanese:"",romaji:"sunooboodo",indonesian:"papan salju",imageUrl:"/nihonme/img/object/32.webp",sentences:[{japanese:"",romaji:"Atarashii sunooboodo o kaitai desu.",indonesian:"Saya ingin membeli papan salju baru."},{japanese:"",romaji:"Ano hito no atarashii sunooboodo wa kakkoii desu.",indonesian:"Papan salju baru orang itu keren."},{japanese:"",romaji:"Kono sunooboodo wa dezain ga suteki desu.",indonesian:"Papan salju ini desainnya bagus."}],description:" (sunooboodo) adalah 'papan salju', sebuah papan yang digunakan untuk meluncur di atas salju. Banyak anak muda di Jepang menikmati menggunakan ."},:{japanese:"",romaji:"supootsubooru",indonesian:"bola olahraga",imageUrl:"/nihonme/img/object/33.webp",sentences:[{japanese:"",romaji:"Kodomotachi wa supootsubooru de asondeimasu.",indonesian:"Anak-anak sedang bermain dengan bola olahraga."},{japanese:"",romaji:"Kono supootsubooru wa sakkaa you desu ka.",indonesian:"Apakah bola olahraga ini untuk sepak bola?"},{japanese:"",romaji:"Takusan no shurui no supootsubooru ga arimasu.",indonesian:"Ada banyak jenis bola olahraga."}],description:" (supootsubooru) adalah gabungan dari 'sports' (olahraga) dan 'ball' (bola). Ini adalah istilah umum untuk bola yang digunakan dalam berbagai olahraga seperti sepak bola, bola basket, dll."},:{japanese:"",romaji:"tako",indonesian:"layang-layang",imageUrl:"/nihonme/img/object/34.webp",sentences:[{japanese:"",romaji:"Oshougatsu ni tako o agemasu.",indonesian:"Kami menerbangkan layang-layang pada Hari Tahun Baru."},{japanese:"",romaji:"Tako ga takaku agarimashita.",indonesian:"Layang-layang itu terbang tinggi."},{japanese:"",romaji:"Kaze ga tsuyoi node, tako ga yoku tobimasu.",indonesian:"Karena anginnya kencang, layang-layang terbang dengan baik."}],description:" (tako) bisa berarti 'layang-layang' atau 'gurita' dalam bahasa Jepang! Konteks biasanya memperjelasnya. Menerbangkan layang-layang adalah kegiatan tradisional Tahun Baru di Jepang."},:{japanese:"",romaji:"yakyuu batto",indonesian:"tongkat bisbol",imageUrl:"/nihonme/img/object/35.webp",sentences:[{japanese:"",romaji:"Ano hito wa yakyuu batto o motteimasu.",indonesian:"Orang itu memegang tongkat bisbol."},{japanese:"",romaji:"Yakyuu batto de booru o uchimasu.",indonesian:"Saya memukul bola dengan tongkat bisbol."},{japanese:"",romaji:"Kono yakyuu batto wa karui desu.",indonesian:"Tongkat bisbol ini ringan."}],description:" (yakyuu) berarti 'bisbol' dan  (batto) berasal dari bahasa Inggris 'bat'. Bisbol adalah olahraga yang sangat populer di Jepang!"},:{japanese:"",romaji:"yakyuu guroobu",indonesian:"sarung tangan bisbol",imageUrl:"/nihonme/img/object/36.webp",sentences:[{japanese:"",romaji:"Atarashii yakyuu guroobu o kaimashita.",indonesian:"Saya membeli sarung tangan bisbol baru."},{japanese:"",romaji:"Yakyuu guroobu de booru o torimasu.",indonesian:"Saya menangkap bola dengan sarung tangan bisbol."},{japanese:"",romaji:"Kono yakyuu guroobu wa kawa de dekiteimasu.",indonesian:"Sarung tangan bisbol ini terbuat dari kulit."}],description:" (yakyuu) adalah 'bisbol' dan  (guroobu) berasal dari 'glove'. Pemain bisbol Jepang dikenal dengan sarung tangan berkualitas tinggi mereka."},:{japanese:"",romaji:"sukeetoboodo",indonesian:"papan luncur",imageUrl:"/nihonme/img/object/37.webp",sentences:[{japanese:"",romaji:"Kouen de sukeetoboodo o shimasu.",indonesian:"Saya bermain papan luncur di taman."},{japanese:"",romaji:"Sukeetoboodo ni noru no wa tanoshii desu.",indonesian:"Naik papan luncur itu menyenangkan."},{japanese:"",romaji:"Ano ko wa sukeetoboodo ga jouzu desu.",indonesian:"Anak itu pandai bermain papan luncur."}],description:" (sukeetoboodo) berasal dari 'skateboard'. Papan luncur menjadi semakin populer di Jepang, terutama setelah dimasukkan dalam Olimpiade."},:{japanese:"",romaji:"saafuboodo",indonesian:"papan selancar",imageUrl:"/nihonme/img/object/38.webp",sentences:[{japanese:"",romaji:"Nami ni noru tame ni saafuboodo o tsukaimasu.",indonesian:"Saya menggunakan papan selancar untuk menaiki ombak."},{japanese:"",romaji:"Ano hito no saafuboodo wa karafuru desu.",indonesian:"Papan selancar orang itu berwarna-warni."},{japanese:"",romaji:"Atarashii saafuboodo ga hoshii desu.",indonesian:"Saya ingin papan selancar baru."}],description:" (saafuboodo) berasal dari 'surfboard'. Jepang memiliki banyak daerah pesisir di mana berselancar adalah kegiatan populer, terutama di tempat-tempat seperti Chiba dan Shonan."},:{japanese:"",romaji:"tenisu raketto",indonesian:"raket tenis",imageUrl:"/nihonme/img/object/39.webp",sentences:[{japanese:"",romaji:"Tenisu o suru toki, tenisu raketto ga irimasu.",indonesian:"Anda memerlukan raket tenis saat bermain tenis."},{japanese:"",romaji:"Kono tenisu raketto wa totemo karui desu.",indonesian:"Raket tenis ini sangat ringan."},{japanese:"",romaji:"Tomodachi to tenisu raketto o katte, tenisu o shimashita.",indonesian:"Saya membeli raket tenis dengan teman saya dan bermain tenis."}],description:" (tenisu raketto) berarti 'raket tenis'. Tenis adalah olahraga populer di Jepang, baik untuk dimainkan maupun ditonton, dengan pemain tenis Jepang yang terkenal."},:{japanese:"",romaji:"botoru",indonesian:"botol",imageUrl:"/nihonme/img/object/40.webp",sentences:[{japanese:"",romaji:"Mizu ga botoru ni haitteimasu.",indonesian:"Air ada di dalam botol."},{japanese:"",romaji:"Kono botoru wa purasuchikku de dekiteimasu.",indonesian:"Botol ini terbuat dari plastik."},{japanese:"",romaji:"Ano hito wa atarashii botoru o kaimashita.",indonesian:"Orang itu membeli botol baru."}],description:" (botoru) berasal dari kata Inggris 'bottle'. Anda akan sering melihat orang membawa  (botoru) mereka sendiri yang dapat digunakan kembali di Jepang, yang disebut  (mai botoru - botol saya)."},:{japanese:"",romaji:"wain gurasu",indonesian:"gelas anggur",imageUrl:"/nihonme/img/object/41.webp",sentences:[{japanese:"",romaji:"Wain gurasu de wain o nomimasu.",indonesian:"Saya minum anggur dari gelas anggur."},{japanese:"",romaji:"Kono wain gurasu wa kirei desu.",indonesian:"Gelas anggur ini cantik."},{japanese:"",romaji:"Resutoran de wain gurasu o mikakemashita.",indonesian:"Saya melihat gelas anggur di restoran."}],description:" (wain gurasu) adalah gabungan dari 'wine' (anggur) dan 'glass' (gelas). Meskipun sake adalah minuman tradisional, anggur juga dinikmati di Jepang, dan Anda akan menemukan  di banyak restoran."},:{japanese:"",romaji:"kappu",indonesian:"cangkir",imageUrl:"/nihonme/img/object/42.webp",sentences:[{japanese:"",romaji:"Koohii o kappu ni iremasu.",indonesian:"Saya menuang kopi ke dalam cangkir."},{japanese:"",romaji:"Atsui ocha ga kappu ni haitteimasu.",indonesian:"Teh panas ada di dalam cangkir."},{japanese:"",romaji:"Kono kappu wa watashi no okiniiri desu.",indonesian:"Cangkir ini favorit saya."}],description:" (kappu) berasal dari 'cup'. Ini bisa merujuk pada cangkir teh, cangkir kopi, atau bahkan gelas ukur. Gelas kertas untuk minuman juga umum."},:{japanese:"",romaji:"fooku",indonesian:"garpu",imageUrl:"/nihonme/img/object/43.webp",sentences:[{japanese:"",romaji:"Fooku de supagetti o tabemasu.",indonesian:"Saya makan spageti dengan garpu."},{japanese:"",romaji:"Teeburu no ue ni naifu to fooku ga arimasu.",indonesian:"Ada pisau dan garpu di atas meja."},{japanese:"",romaji:"Kono fooku wa gin'iro desu.",indonesian:"Garpu ini berwarna perak."}],description:" (fooku) berasal dari kata Inggris 'fork'. Meskipun sumpit ( - hashi) adalah tradisional,  umum digunakan untuk makanan gaya Barat di Jepang."},:{japanese:"",romaji:"naifu",indonesian:"pisau",imageUrl:"/nihonme/img/object/44.webp",sentences:[{japanese:"",romaji:"Naifu de pan o kirimasu.",indonesian:"Saya memotong roti dengan pisau."},{japanese:"",romaji:"Suteeki o taberu toki, naifu o tsukaimasu.",indonesian:"Saya menggunakan pisau saat makan steik."},{japanese:"",romaji:"Kono naifu wa yoku kiremasu.",indonesian:"Pisau ini tajam."}],description:" (naifu) berasal dari 'knife'. Ini digunakan untuk memotong makanan, terutama dalam masakan Barat. Masakan Jepang juga memiliki pisau khusus sendiri ( - houchou)."},:{japanese:"",romaji:"supuun",indonesian:"sendok",imageUrl:"/nihonme/img/object/45.webp",sentences:[{japanese:"",romaji:"Supuun de suupu o nomimasu.",indonesian:"Saya minum sup dengan sendok."},{japanese:"",romaji:"Kareeraisu wa supuun de taberu koto ga ooi desu.",indonesian:"Nasi kari sering dimakan dengan sendok."},{japanese:"",romaji:"Kodomo wa chiisai supuun o tsukaimasu.",indonesian:"Anak-anak menggunakan sendok kecil."}],description:" (supuun) berasal dari 'spoon'. Ini digunakan untuk makan sup, kari, makanan penutup, dan juga untuk mengaduk minuman seperti kopi atau teh."},:{japanese:"",romaji:"booru",indonesian:"mangkuk",imageUrl:"/nihonme/img/object/46.webp",sentences:[{japanese:"",romaji:"Sarada o booru ni iremashita.",indonesian:"Saya menaruh salad di mangkuk."},{japanese:"",romaji:"Kono booru wa suupu ni choudo ii desu.",indonesian:"Mangkuk ini pas untuk sup."},{japanese:"",romaji:"Asagohan ni shiriaru o booru de tabemasu.",indonesian:"Saya makan sereal di mangkuk untuk sarapan."}],description:" (booru) berasal dari 'bowl'. Di Jepang, Anda akan menggunakan berbagai jenis mangkuk untuk nasi ( - ochawan), sup ( - owan), atau salad dan mi."},:{japanese:"",romaji:"banana",indonesian:"pisang",imageUrl:"/nihonme/img/object/47.webp",sentences:[{japanese:"",romaji:"Banana wa kiiroi desu.",indonesian:"Pisang berwarna kuning."},{japanese:"",romaji:"Asagohan ni banana o tabemasu.",indonesian:"Saya makan pisang untuk sarapan."},{japanese:"",romaji:"Banana wa karada ni ii desu.",indonesian:"Pisang baik untuk tubuh."}],description:" (banana) adalah buah populer di Jepang, sering dimakan sebagai camilan cepat atau untuk sarapan. Biasanya diimpor tetapi sangat umum di supermarket."},:{japanese:"",romaji:"ringo",indonesian:"apel",imageUrl:"/nihonme/img/object/48.webp",sentences:[{japanese:"",romaji:"Ringo wa akakute oishii desu.",indonesian:"Apel berwarna merah dan enak."},{japanese:"",romaji:"Mainichi ringo o hitotsu tabemasu.",indonesian:"Saya makan satu apel setiap hari."},{japanese:"",romaji:"Kono ringo wa totemo ookii desu.",indonesian:"Apel ini sangat besar."}],description:" (ringo) berarti 'apel'. Prefektur Aomori di Jepang terkenal dengan  yang lezat, dan ada banyak varietas yang tersedia."},:{japanese:"",romaji:"sandouicchi",indonesian:"roti lapis",imageUrl:"/nihonme/img/object/49.webp",sentences:[{japanese:"",romaji:"Hirugohan ni sandouicchi o tabemasu.",indonesian:"Saya makan roti lapis untuk makan siang."},{japanese:"",romaji:"Tamago sandouicchi ga suki desu.",indonesian:"Saya suka roti lapis telur."},{japanese:"",romaji:"Pikunikku ni sandouicchi o motte ikimashou.",indonesian:"Ayo bawa roti lapis ke piknik."}],description:" (sandouicchi) berasal dari 'sandwich'. Toko serba ada Jepang ( - konbini) menjual berbagai macam  yang lezat dan seringkali unik!"},:{japanese:"",romaji:"orenji",indonesian:"jeruk",imageUrl:"/nihonme/img/object/50.webp",sentences:[{japanese:"",romaji:"Orenji wa bitamin shii ga ooi desu.",indonesian:"Jeruk kaya akan Vitamin C."},{japanese:"",romaji:"Orenji juusu o nomitai desu.",indonesian:"Saya ingin minum jus jeruk."},{japanese:"",romaji:"Kono orenji wa totemo amai desu.",indonesian:"Jeruk ini sangat manis."}],description:" (orenji) berarti 'jeruk' (buah). Ini adalah buah jeruk populer di Jepang, dan Anda juga dapat menemukan banyak minuman dan permen rasa jeruk."},:{japanese:"",romaji:"burokkorii",indonesian:"brokoli",imageUrl:"/nihonme/img/object/51.webp",sentences:[{japanese:"",romaji:"Burokkorii wa midoriiro no yasai desu.",indonesian:"Brokoli adalah sayuran berwarna hijau."},{japanese:"",romaji:"Watashi wa burokkorii ga suki desu.",indonesian:"Saya suka brokoli."},{japanese:"",romaji:"Burokkorii o yudete tabemasu.",indonesian:"Saya merebus brokoli dan memakannya."}],description:" (burokkorii) adalah 'brokoli'. Ini adalah sayuran umum dalam masakan Jepang, sering digunakan dalam salad, tumisan, atau sebagai lauk."},:{japanese:"",romaji:"ninjin",indonesian:"wortel",imageUrl:"/nihonme/img/object/52.webp",sentences:[{japanese:"",romaji:"Ninjin wa orenji iro desu.",indonesian:"Wortel berwarna oranye."},{japanese:"",romaji:"Usagi wa ninjin ga daisuki desu.",indonesian:"Kelinci sangat suka wortel."},{japanese:"",romaji:"Suupu ni ninjin o iremashita.",indonesian:"Saya memasukkan wortel ke dalam sup."}],description:" (ninjin) berarti 'wortel'. Wortel digunakan dalam banyak hidangan Jepang, seperti nasi kari () dan nikujaga ( - semur daging dan kentang)."},:{japanese:"",romaji:"hottodoggu",indonesian:"hot dog",imageUrl:"/nihonme/img/object/53.webp",sentences:[{japanese:"",romaji:"Hottodoggu ni kechappu o kakemasu.",indonesian:"Saya memberi saus tomat pada hot dog saya."},{japanese:"",romaji:"Yakyuu no shiai de hottodoggu o tabemashita.",indonesian:"Saya makan hot dog di pertandingan bisbol."},{japanese:"",romaji:"Kono hottodoggu wa oishisou desu.",indonesian:"Hot dog ini kelihatannya enak."}],description:" (hottodoggu) berasal dari 'hot dog'. Anda dapat menemukannya di toko serba ada, festival, dan beberapa tempat makanan cepat saji di Jepang."},:{japanese:"",romaji:"piza",indonesian:"pizza",imageUrl:"/nihonme/img/object/54.webp",sentences:[{japanese:"",romaji:"Tomodachi to piza o tabemasu.",indonesian:"Saya makan pizza dengan teman-teman."},{japanese:"",romaji:"Ookii piza o chuumon shimashita.",indonesian:"Saya memesan pizza besar."},{japanese:"",romaji:"Kono piza ni wa chiizu ga takusan haitteimasu.",indonesian:"Pizza ini banyak kejunya."}],description:" (piza) adalah 'pizza'. Ini sangat populer di Jepang, dengan banyak rantai pizza Jepang yang menawarkan topping unik seperti makanan laut atau ayam teriyaki."},:{japanese:"",romaji:"doonatsu",indonesian:"donat",imageUrl:"/nihonme/img/object/55.webp",sentences:[{japanese:"",romaji:"Amai doonatsu ga suki desu.",indonesian:"Saya suka donat manis."},{japanese:"",romaji:"Koohii to issho ni doonatsu o tabemasu.",indonesian:"Saya makan donat dengan kopi."},{japanese:"",romaji:"Iroiro na doonatsu ga arimasu ne.",indonesian:"Ada berbagai macam donat ya."}],description:" (doonatsu) berasal dari 'donut'. Ada banyak toko donat populer di Jepang yang menawarkan berbagai macam rasa dan desain lucu."},:{japanese:"",romaji:"keeki",indonesian:"kue",imageUrl:"/nihonme/img/object/56.webp",sentences:[{japanese:" ",romaji:"Tanjoubi ni keeki o tabemasu.",indonesian:"Saya makan kue di hari ulang tahun saya."},{japanese:"",romaji:"Kono keeki wa totemo oishii desu.",indonesian:"Kue ini sangat enak."},{japanese:"",romaji:"Chokoreeto keeki o tsukurimashita.",indonesian:"Saya membuat kue cokelat."}],description:" (keeki) adalah 'kue'. Kue Jepang terkenal ringan, lembut, dan dihias dengan indah, terutama kue tart stroberi."},:{japanese:"",romaji:"isu",indonesian:"kursi",imageUrl:"/nihonme/img/object/57.webp",sentences:[{japanese:"",romaji:"Heya ni isu ga arimasu.",indonesian:"Ada kursi di kamar."},{japanese:"",romaji:"Kono isu ni suwatte kudasai.",indonesian:"Silakan duduk di kursi ini."},{japanese:"",romaji:"Isu wa ki de dekiteimasu.",indonesian:"Kursi itu terbuat dari kayu."}],description:" (isu) berarti 'kursi'. Di rumah tradisional Jepang, orang sering duduk di atas tikar tatami, tetapi  umum di rumah modern, kantor, dan restoran."},:{japanese:"",romaji:"sofaa",indonesian:"sofa",imageUrl:"/nihonme/img/object/58.webp",sentences:[{japanese:"",romaji:"Ribingu ni sofaa ga arimasu.",indonesian:"Ada sofa di ruang tamu."},{japanese:"",romaji:"Kono sofaa wa totemo fukafuka desu.",indonesian:"Sofa ini sangat empuk."},{japanese:"",romaji:"Sofaa de hon o yomimasu.",indonesian:"Saya membaca buku di sofa."}],description:" (sofaa) berasal dari 'sofa'. Ini adalah perabot umum di ruang tamu Jepang untuk bersantai dan menonton TV."},:{japanese:"",romaji:"uekibachi",indonesian:"tanaman pot",imageUrl:"/nihonme/img/object/59.webp",sentences:[{japanese:"",romaji:"Kono uekibachi ni wa kirei na hana ga arimasu.",indonesian:"Tanaman pot ini memiliki bunga yang indah."},{japanese:"",romaji:"Madobe ni chiisana uekibachi o okimashita.",indonesian:"Saya meletakkan tanaman pot kecil di dekat jendela."},{japanese:"",romaji:"Mise no mae ni takusan no uekibachi ga narandeimasu.",indonesian:"Banyak tanaman pot berjejer di depan toko."}],description:" (uekibachi) merujuk pada 'tanaman pot' ( ueki = tanaman,  hachi = pot). Umumnya terlihat berbagai  menambah kehijauan di rumah dan jalanan di Jepang."},:{japanese:"",romaji:"beddo",indonesian:"tempat tidur",imageUrl:"/nihonme/img/object/60.webp",sentences:[{japanese:"",romaji:"Watashi wa beddo de nemasu.",indonesian:"Saya tidur di tempat tidur."},{japanese:"",romaji:"Kono beddo wa ookii desu.",indonesian:"Tempat tidur ini besar."},{japanese:"",romaji:"Maiasa beddo o kirei ni shimasu.",indonesian:"Saya merapikan tempat tidur setiap pagi."}],description:" (beddo) berasal dari 'bed'. Meskipun futon () yang diletakkan di atas tikar tatami adalah tradisional,  gaya Barat sangat umum di rumah modern Jepang."},:{japanese:"",romaji:"shokutaku",indonesian:"meja makan",imageUrl:"/nihonme/img/object/61.webp",sentences:[{japanese:"",romaji:"Shokutaku no ue ni ryouri ga arimasu.",indonesian:"Ada makanan di atas meja makan."},{japanese:"",romaji:"Minna de shokutaku o kakomimasu.",indonesian:"Semua orang berkumpul di sekitar meja makan."},{japanese:"",romaji:"Kono shokutaku wa mokusei desu.",indonesian:"Meja makan ini terbuat dari kayu."}],description:" (shokutaku) berarti 'meja makan'. Keluarga berkumpul di sekitar  untuk makan bersama."},:{japanese:"",romaji:"toire",indonesian:"toilet",imageUrl:"/nihonme/img/object/62.webp",sentences:[{japanese:"",romaji:"Toire wa doko desu ka.",indonesian:"Di mana toiletnya?"},{japanese:"",romaji:"Kono hoteru no toire wa kirei desu.",indonesian:"Toilet di hotel ini bersih."},{japanese:"",romaji:"Toire no ato, te o araimasu.",indonesian:"Saya mencuci tangan setelah menggunakan toilet."}],description:" (toire) berasal dari 'toilet'.  Jepang terkenal di seluruh dunia karena sangat berteknologi tinggi, dengan fitur seperti kursi berpemanas dan bidet internal!"},:{japanese:"",romaji:"terebi",indonesian:"TV",imageUrl:"/nihonme/img/object/63.webp",sentences:[{japanese:"",romaji:"Ribingu de terebi o mimasu.",indonesian:"Saya menonton TV di ruang tamu."},{japanese:"",romaji:"Atarashii terebi o kaimashita.",indonesian:"Saya membeli TV baru."},{japanese:"",romaji:"Suki na terebi bangumi ga arimasu.",indonesian:"Saya punya acara TV favorit."}],description:" (terebi) adalah singkatan dari  (terebijon - televisi). Menonton  adalah hiburan umum di Jepang, dengan banyak acara TV Jepang yang unik."},:{japanese:"",romaji:"nooto pasokon",indonesian:"laptop",imageUrl:"/nihonme/img/object/64.webp",sentences:[{japanese:"",romaji:"Nooto pasokon de shigoto o shimasu.",indonesian:"Saya bekerja dengan laptop saya."},{japanese:"",romaji:"Kono nooto pasokon wa karukute benri desu.",indonesian:"Laptop ini ringan dan praktis."},{japanese:"",romaji:"Kafe de nooto pasokon o tsukatteimasu.",indonesian:"Saya sedang menggunakan laptop saya di kafe."}],description:" (nooto pasokon) berarti 'laptop', secara harfiah 'komputer pribadi buku catatan'. Sering disingkat menjadi PC (nooto pii shii)."},:{japanese:"",romaji:"mausu",indonesian:"mouse",imageUrl:"/nihonme/img/object/65.webp",sentences:[{japanese:"",romaji:"Mausu de kurikku shimasu.",indonesian:"Saya mengklik dengan mouse."},{japanese:"",romaji:"Kono mausu wa waiyaresu desu.",indonesian:"Mouse ini nirkabel."},{japanese:"",romaji:"Atarashii mausu ga hoshii desu.",indonesian:"Saya ingin mouse baru."}],description:" (mausu) berasal dari 'mouse', merujuk pada mouse komputer. Ini adalah aksesori penting bagi sebagian besar pengguna desktop dan banyak pengguna laptop."},:{japanese:"",romaji:"rimokon",indonesian:"remote control",imageUrl:"/nihonme/img/object/66.webp",sentences:[{japanese:"",romaji:"Terebi no rimokon wa doko desu ka.",indonesian:"Di mana remote control TV?"},{japanese:"",romaji:"Rimokon de channeru o kaemasu.",indonesian:"Saya mengganti saluran dengan remote control."},{japanese:"",romaji:"Kono rimokon wa tsukaiyasui desu.",indonesian:"Remote control ini mudah digunakan."}],description:" (rimokon) adalah singkatan dari 'remote controller'. Ini digunakan untuk TV, pendingin udara ( - eakon), dan banyak perangkat elektronik lainnya di Jepang."},:{japanese:"",romaji:"kiiboodo",indonesian:"keyboard",imageUrl:"/nihonme/img/object/67.webp",sentences:[{japanese:"",romaji:"Kiiboodo de taipu shimasu.",indonesian:"Saya mengetik di keyboard."},{japanese:"",romaji:"Kono kiiboodo wa atarashii desu.",indonesian:"Keyboard ini baru."},{japanese:"",romaji:"Nooto pasokon ni kiiboodo ga tsuiteimasu.",indonesian:"Laptop itu memiliki keyboard terpasang."}],description:" (kiiboodo) berasal dari 'keyboard'. Keyboard Jepang memiliki tombol ekstra untuk beralih antara huruf Romawi ( - roomaji) dan karakter Jepang ( - kana)."},:{japanese:"",romaji:"keitai denwa",indonesian:"telepon seluler",imageUrl:"/nihonme/img/object/68.webp",sentences:[{japanese:"",romaji:"Keitai denwa de tomodachi ni hanashimasu.",indonesian:"Saya berbicara dengan teman saya di telepon seluler."},{japanese:"",romaji:"Atarashii keitai denwa o kaimashita.",indonesian:"Saya membeli telepon seluler baru."},{japanese:"",romaji:"Keitai denwa de shashin o torimasu.",indonesian:"Saya mengambil foto dengan telepon seluler saya."}],description:" (keitai denwa) berarti 'telepon seluler', sering disingkat menjadi  (keitai). Jepang dikenal dengan teknologi dan budaya telepon selulernya yang canggih."},:{japanese:"",romaji:"denshi renji",indonesian:"oven microwave",imageUrl:"/nihonme/img/object/69.webp",sentences:[{japanese:"",romaji:"Tabemono o denshi renji de atatamemasu.",indonesian:"Saya memanaskan makanan di oven microwave."},{japanese:"",romaji:"Kono ryouri wa denshi renji de tsukuremasu.",indonesian:"Hidangan ini bisa dibuat di oven microwave."},{japanese:"",romaji:"Denshi renji wa totemo benri desu.",indonesian:"Oven microwave sangat praktis."}],description:" (denshi renji) berarti 'oven microwave' ( denshi = elektron,  renji = rentang/oven). Ini adalah peralatan yang sangat umum dan penting di dapur Jepang untuk memanaskan makanan dengan cepat."},:{japanese:"",romaji:"oobun",indonesian:"oven",imageUrl:"/nihonme/img/object/70.webp",sentences:[{japanese:"",romaji:"Oobun de keeki o yakimasu.",indonesian:"Saya memanggang kue di oven."},{japanese:"",romaji:"Kono oobun wa atarashii desu.",indonesian:"Oven ini baru."},{japanese:"",romaji:"Piza o oobun ni iremasu.",indonesian:"Saya memasukkan pizza ke dalam oven."}],description:" (oobun) berasal dari 'oven'. Meskipun tidak se-standar oven microwave di semua dapur Jepang, banyak dapur modern memiliki fungsi , seringkali digabungkan dengan microwave ( - oobun renji)."},:{japanese:"",romaji:"toosutaa",indonesian:"pemanggang roti",imageUrl:"/nihonme/img/object/71.webp",sentences:[{japanese:"",romaji:"Toosutaa de pan o yakimasu.",indonesian:"Saya memanggang roti di pemanggang roti."},{japanese:"",romaji:"Maiasa toosutaa o tsukaimasu.",indonesian:"Saya menggunakan pemanggang roti setiap pagi."},{japanese:"",romaji:"Kono toosutaa wa chiisai desu.",indonesian:"Pemanggang roti ini kecil."}],description:" (toosutaa) berasal dari 'toaster', khusus untuk memanggang roti. Banyak orang Jepang menikmati roti panggang tebal ( - shokupan) untuk sarapan."},:{japanese:"",romaji:"nagashi",indonesian:"bak cuci piring",imageUrl:"/nihonme/img/object/72.webp",sentences:[{japanese:"",romaji:"Shokki o nagashi de araimasu.",indonesian:"Saya mencuci piring di bak cuci piring."},{japanese:"",romaji:"Nagashi o kirei ni shite kudasai.",indonesian:"Tolong bersihkan bak cuci piring."},{japanese:"",romaji:"Nagashi de te o araimasu.",indonesian:"Saya mencuci tangan di bak cuci piring."}],description:" (nagashi) atau  (nagashidai) merujuk pada bak cuci piring dapur. Di sinilah Anda mencuci piring ( - saraarai) dan menyiapkan makanan."},:{japanese:"",romaji:"reizouko",indonesian:"kulkas",imageUrl:"/nihonme/img/object/73.webp",sentences:[{japanese:"",romaji:"Tabemono o reizouko ni iremasu.",indonesian:"Saya memasukkan makanan ke dalam kulkas."},{japanese:"",romaji:"Reizouko no naka ni juusu ga arimasu.",indonesian:"Ada jus di dalam kulkas."},{japanese:"",romaji:"Kono reizouko wa ookii desu.",indonesian:"Kulkas ini besar."}],description:" (reizouko) berarti 'kulkas'. Ini adalah peralatan penting di setiap rumah untuk menjaga makanan tetap segar. Kulkas Jepang sering memiliki kompartemen khusus."},:{japanese:"",romaji:"hon",indonesian:"buku",imageUrl:"/nihonme/img/object/74.webp",sentences:[{japanese:"",romaji:"Watashi wa hon o yomu no ga suki desu.",indonesian:"Saya suka membaca buku."},{japanese:"",romaji:"Toshokan de hon o karimasu.",indonesian:"Saya meminjam buku dari perpustakaan."},{japanese:"",romaji:"Kono hon wa omoshiroi desu.",indonesian:"Buku ini menarik."}],description:" (hon) berarti 'buku'. Jepang memiliki tradisi sastra yang kaya, dan toko buku ( - honya) umum ditemukan. Manga () adalah jenis  yang sangat populer."},:{japanese:"",romaji:"tokei",indonesian:"jam",imageUrl:"/nihonme/img/object/75.webp",sentences:[{japanese:"",romaji:"Heya ni kabekake no tokei ga arimasu.",indonesian:"Ada jam dinding di kamar."},{japanese:"",romaji:"Ano furui tokei wa mada ugoiteimasu.",indonesian:"Jam tua itu masih berfungsi."},{japanese:"",romaji:"Dejitaru tokei yori anarogu tokei ga suki desu.",indonesian:"Saya lebih suka jam analog daripada jam digital."}],description:" (tokei) berarti 'jam'. Ini adalah alat yang digunakan untuk mengetahui waktu, ditemukan di dinding ( - kabedokei) atau meja di rumah dan gedung."},:{japanese:"",romaji:"kabin",indonesian:"vas",imageUrl:"/nihonme/img/object/76.webp",sentences:[{japanese:"",romaji:"Kabin ni hana o ikemasu.",indonesian:"Saya merangkai bunga di vas."},{japanese:"",romaji:"Kono kabin wa totemo kirei desu.",indonesian:"Vas ini sangat indah."},{japanese:"",romaji:"Teeburu no ue ni kabin o okimashita.",indonesian:"Saya meletakkan vas di atas meja."}],description:" (kabin) berarti 'vas'. Ini digunakan untuk memajang bunga ( - hana). Merangkai bunga, atau  (ikebana), adalah seni tradisional Jepang."},:{japanese:"",romaji:"hasami",indonesian:"gunting",imageUrl:"/nihonme/img/object/77.webp",sentences:[{japanese:"",romaji:"Kami o hasami de kirimasu.",indonesian:"Saya memotong kertas dengan gunting."},{japanese:"",romaji:"Kono hasami wa yoku kiremasu ka.",indonesian:"Apakah gunting ini tajam?"},{japanese:"",romaji:"Kodomo wa anzen na hasami o tsukaimasu.",indonesian:"Anak-anak menggunakan gunting yang aman."}],description:" (hasami) berarti 'gunting'. Digunakan untuk memotong kertas, kain, dan banyak hal lainnya. Ada berbagai jenis untuk tujuan yang berbeda."},:{japanese:"",romaji:"tedi bea",indonesian:"boneka beruang",imageUrl:"/nihonme/img/object/78.webp",sentences:[{japanese:"",romaji:"Watashi wa chiisai toki, tedi bea o motteimashita.",indonesian:"Saya punya boneka beruang ketika saya kecil."},{japanese:"",romaji:"Kono tedi bea wa totemo kawaii desu.",indonesian:"Boneka beruang ini sangat lucu."},{japanese:"",romaji:"Tomodachi ni tedi bea o purezento shimashita.",indonesian:"Saya memberi teman saya hadiah boneka beruang."}],description:" (tedi bea) berasal dari 'teddy bear'. Boneka beruang ini adalah mainan dan barang koleksi populer di Jepang, sama seperti di banyak negara lain."},:{japanese:"",romaji:"hea doraiyaa",indonesian:"pengering rambut",imageUrl:"/nihonme/img/object/79.webp",sentences:[{japanese:"",romaji:"Ofuro no ato, hea doraiyaa o tsukaimasu.",indonesian:"Saya menggunakan pengering rambut setelah mandi."},{japanese:"",romaji:"Kono hea doraiyaa wa atarashii moderu desu.",indonesian:"Pengering rambut ini model baru."},{japanese:"",romaji:"Hea doraiyaa de kami o kawakashimasu.",indonesian:"Saya mengeringkan rambut dengan pengering rambut."}],description:" (hea doraiyaa) berasal dari 'hair dryer'. Ini adalah peralatan umum yang digunakan setelah mandi untuk mengeringkan rambut."},:{japanese:"",romaji:"ha burashi",indonesian:"sikat gigi",imageUrl:"/nihonme/img/object/80.webp",sentences:[{japanese:"",romaji:"Mainichi, ha burashi de ha o migakimasu.",indonesian:"Setiap hari, saya menggosok gigi dengan sikat gigi."},{japanese:"",romaji:"Atarashii ha burashi o kaimashita.",indonesian:"Saya membeli sikat gigi baru."},{japanese:"",romaji:"Kono ha burashi wa yawarakai desu.",indonesian:"Sikat gigi ini lembut."}],description:" (ha burashi), sering ditulis , berarti 'sikat gigi'. Kebersihan mulut itu penting, dan toko obat di Jepang menawarkan berbagai macam ."}},Lw=[{link:"https://wkwk-japanese.com/?p=4330",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/thumbnail_standard-520x300.png",title:"Cara Mulai Belajar Bahasa Jepang Ala WKWK JAPANESE!",date:"2023-10-03"},{link:"https://wkwk-japanese.com/?p=4257",img:"https://wkwk-japanese.com/wp-content/uploads/2023/09/200.png",title:"Jenis Kata dalam Bahasa Jepang ()",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=2772",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Kata-penghubung-Tapi.png",title:"Penggunaan Konjungsi (Kata Penghubung) TAPI | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=2378",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Cuaca.png",title:"Kosakata tentang Cuaca dalam bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2401",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Dalam-kelas.png",title:"Kosakata Bahasa Jepang yang Sering Digunakan di Dalam Kelas",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2357",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Minuman.png",title:"Kosakata tentang Minuman dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2362",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Barang-rumah.png",title:"Kosakata tentang Barang yang ada di rumah dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=2370",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Tempat-bangunan.png",title:"Kosakata tentang nama tempat dan Bangunan dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=2471",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Letak-posisi.png",title:"Kosakata tentang Letak dan Posisi dalam bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2670",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Bulan.png",title:"Kosakata Bahasa Jepang yang Berkaitan dengan Bulan",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2374",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Pekerjaan.png",title:"Kosakata tentang Pekerjaan/Profesi dalam bahasa Jepang",date:"2023-08-16"},{link:"https://wkwk-japanese.com/?p=2405",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Negara.png",title:"Nama-nama negara dalam bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2398",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Musik.png",title:"Kosakata tentang Musik dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2395",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Orahraga.png",title:"Kosakata tentang Olahraga dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2389",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Hobi.png",title:"Kosakata tentang Hobi dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2382",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Transportasi.png",title:"Kosakata tentang Alat Transportasi dalam Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2435",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Musim.png",title:"Kosakata tentang Musim dalam bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2463",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Hari.png",title:"Kosakata Bahasa Jepang yang Berkaitan dengan Hari",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2345",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Makanan.png",title:"Kosakata tentang Makanan dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2330",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/1-1.png",title:"Daftar Artikel Tingkat Pemula (N5)",date:"2023-10-23"},{link:"https://wkwk-japanese.com/?p=134",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/14-1-520x300.png",title:"Daftar Kata Kerja Bahasa Jepang N5",date:"2023-09-05"},{link:"https://wkwk-japanese.com/?p=1344",img:"https://wkwk-japanese.com/wp-content/uploads/2022/12/135.png",title:"Tata Bahasa / Pola Kalimat N5 : ~darou | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=953",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/63-3-520x300.png",title:"Kata Keterangan: Takusan, Sukoshi, Amari, Zenzen | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=950",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/64-3-520x300.png",title:"Kata Keterangan: Yoku, Daitai, Sukoshi, Amari, Zenzen | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=947",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/182-1-520x300.png",title:"Kata Bantu Bilangan untuk Bangunan dan Lantai | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=943",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/182.png",title:"Kata Bantu Bilangan untuk Hewan dalam bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=939",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/185.png",title:"Kata Bantu Bilangan untuk Benda dalam bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=936",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/181.png",title:"Kata Bantu Bilangan Orang dalam bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=930",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/180.png",title:"Perubahan Kata Sifat Positif dan Negatif Lampau | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=925",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/179.png",title:"Perubahan Kata Sifat ke Bentuk Negatif | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=916",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/178.png",title:"Daftar Kata Sifat Bahasa Jepang N5",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=907",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/154.png",title:"Perbedaan  made VS  made ni | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=903",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/158.png",title:"8 Kata Tanya dalam bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=899",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/149.png",title:"Tata Bahasa / Pola Kalimat N5 : ~(ga) kakarimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=892",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/159.png",title:"Kata Tunjuk dalam bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=888",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/175.png",title:"Perbedaan Partikel TO dan YA () & () | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=884",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/166.png",title:"Mengenal Partikel TO | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=881",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/170.png",title:"Mengenal Partikel Yori | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=876",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/177.png",title:"Perbedaan Partikel NE dan YO () & () | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=872",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/176.png",title:"Perbedaan Partikel E dan NI () & () | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=869",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/174.png",title:"Perbedaan Partikel  WA dan Partikel  GA | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=866",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/173.png",title:"Perbedaan Partikel  NI dan  DE | Bahasa Jepang",date:"2023-10-25"},{link:"https://wkwk-japanese.com/?p=861",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/172.png",title:"Mengenal Partikel NE  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=857",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/171.png",title:"Mengenal Partikel YO  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=853",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/169.png",title:"Mengenal Partikel Made | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=850",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/Thumbnail-Artikel-N5-1056--609-piksel-12-520x300.png",title:"Mengenal Partikel YA  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=841",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/168.png",title:"Mengenal Partikel Kara | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=837",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/64-2-520x300.png",title:"Mengenal Partikel NO  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=833",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/167.png",title:"Mengenal Partikel KA   | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=830",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/165.png",title:"Mengenal Partikel E  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=826",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/164.png",title:"Mengenal Partikel O  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=823",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/163.png",title:"Mengenal Partikel MO  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=817",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/Thumbnail-Artikel-N5-1056--609-piksel-11-520x300.png",title:"Mengenal Partikel GA  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=813",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/162.png",title:"Mengenal Partikel WA  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=792",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/161.png",title:"Mengenal Partikel NI | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=788",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/157.png",title:"Kata Tanya 5W1H dalam bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=784",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/143-1.png",title:"Tata Bahasa / Pola Kalimat N5 : ga kikoemasu / miemasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=781",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/140.png",title:"Tata Bahasa / Pola Kalimat N5 : sugiru  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=778",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/160.png",title:"Mengenal Partikel DE  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=772",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/156.png",title:"Cara Memperkenalkan Diri dalam bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=767",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/155.png",title:"Perbedaan Agemasu dan Kuremasu",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=763",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/153.png",title:"Perbedaan IMASU dan ARIMASU",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=759",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/152.png",title:"Tata Bahasa / Pola Kalimat N5 : Modifikasi Kata Benda dengan Kata Kerja | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=756",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/151.png",title:"Tata Bahasa / Pola Kalimat N5 : (KS + KB) womasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=752",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/150.png",title:"Tata Bahasa / Pola Kalimat N5 : KS + KB desu (Modifikasi KB dengan KS) | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=749",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/148.png",title:"Tata Bahasa / Pola Kalimat N5 : (Jangka Waktu) masu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=745",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/147.png",title:"Tata Bahasa / Pola Kalimat N5 : . Shikashi, | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=742",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/146.png",title:"Tata Bahasa / Pola Kalimat N5 : dake | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=739",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/145.png",title:"Tata Bahasa / Pola Kalimat N5 : demo | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=736",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/144.png",title:"Tata Bahasa / Pola Kalimat N5 : wa, dou desu ka | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=733",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/142.png",title:"Tata Bahasa / Pola Kalimat N5 : no ga heta | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=729",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/141.png",title:"Tata Bahasa / Pola Kalimat N5 : no ga jouzu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=726",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/139.png",title:"Tata Bahasa / Pola Kalimat N5:tsumori da  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=723",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/137.png",title:"Tata Bahasa / Pola Kalimat N5 : kedo/dakedo, | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=715",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/138.png",title:"Tata Bahasa / Pola Kalimat N5 :cha ikenai /ja ikenai | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=712",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/136.png",title:"Tata Bahasa / Pola Kalimat N5 : nakucha | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=708",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/134.png",title:"Tata Bahasa / Pola Kalimat N5 : ~keredomo/keredo, ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=705",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/29.png",title:"Jangka Waktu (Jam, Menit dan Detik) dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=702",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/132.png",title:"Tata Bahasa / Pola Kalimat N5 : nakute wa ikenai | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=698",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/133.png",title:"Tata Bahasa / Pola Kalimat N5 : . Demo, | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=694",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/39.png",title:"Kosakata tentang Alam dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=688",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/32.png",title:"Nama-nama Hewan dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=683",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/34.png",title:"Cara Menyatakan dan Menanyakan Umur/Usia dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=676",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/35.png",title:"Kosakata tentang Pakaian dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=672",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/26.png",title:"10 Kata Kerja Memakai dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=668",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/130.png",title:"Tata Bahasa / Pola Kalimat N5 : naide | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=664",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/129.png",title:"Tata Bahasa / Pola Kalimat N5 : wo kudasai | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=661",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/126.png",title:"Tata Bahasa / Pola Kalimat N5 : naito ikemasen | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=658",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/124.png",title:"Tata Bahasa / Pola Kalimat N5 :kata | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=654",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/123.png",title:"Tata Bahasa / Pola Kalimat N5 : no ga suki | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=651",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/121.png",title:"Tata Bahasa / Pola Kalimat N5 : Mada | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=647",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/116.png",title:"Tata Bahasa / Pola Kalimat N5 :toki | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=643",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/114.png",title:"Tata Bahasa / Pola Kalimat N5 : Mada te imasen | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=638",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/112.png",title:"Tata Bahasa / Pola Kalimat N5 : tari, tari shimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=630",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/131.png",title:"Tata Bahasa / Pola Kalimat N5 : nakya ikenai | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=622",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/127.png",title:"Tata Bahasa / Pola Kalimat N5 :yori, hou ga | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=613",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/125.png",title:"Tata Bahasa / Pola Kalimat N5 :node,  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=605",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/122.png",title:"Tata Bahasa / Pola Kalimat N5 : hou ga ii | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=590",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/120.png",title:"Tata Bahasa / Pola Kalimat N5 : dega arimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=585",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/Thumbnail-Artikel-N5-1056--609-piksel-9-520x300.png",title:"Tradisi Musim Panas di Jepang",date:"2023-07-20"},{link:"https://wkwk-japanese.com/?p=582",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/119.png",title:"Tata Bahasa / Pola Kalimat N5 : deshou? | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=579",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/118.png",title:"Tata Bahasa / Pola Kalimat N5 : to,  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=576",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/117.png",title:"Tata Bahasa / Pola Kalimat N5 : te imasu (secara rutin) | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=572",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/115.png",title:"Tata Bahasa / Pola Kalimat N5 : Moumashita | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=569",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/113.png",title:"Tata Bahasa / Pola Kalimat N5 : ku/ni narimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=566",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/55-2-520x300.png",title:"Tata Bahasa / Pola Kalimat N5 : to iimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=563",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/111.png",title:"Tata Bahasa / Pola Kalimat N5 : to omoimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=560",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/109.png",title:"Tata Bahasa / Pola Kalimat N5: kaka | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=556",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/95.png",title:"Tata Bahasa / Pola Kalimat N5 : KB wo KK transitif | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=553",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/93.png",title:"Tata Bahasa / Pola Kalimat N5 : ta koto ga arimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=550",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/86.png",title:"Tata Bahasa / Pola Kalimat N5 : te wa ikemasen | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=541",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/104.png",title:"Tata Bahasa / Pola Kalimat N5 : kara,  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=537",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/102.png",title:"Tata Bahasa / Pola Kalimat N5 : ~te ~te ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=534",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/98.png",title:"Tata Bahasa / Pola Kalimat N5 : KB demasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=531",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/108.png",title:"Tata Bahasa / Pola Kalimat N5: ~ ya ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=527",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/107.png",title:"Tata Bahasa / Pola Kalimat N5 : no naka dega ichibandesu| Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=523",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/106.png",title:"Tata Bahasa / Pola Kalimat N5 : wayoridesu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=519",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/105.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ ga ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=516",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/103.png",title:"Tata Bahasa / Pola Kalimat N5: ~ kute / de | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=511",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/101.png",title:"Tata Bahasa / Pola Kalimat N5: ~ te kara, ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=507",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/100.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ mashou ka | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=503",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/99.png",title:"Tata Bahasa / Pola Kalimat N5 : wago dedesu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=500",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/97.png",title:"Tata Bahasa / Pola Kalimat N5 : KB1 wa KB2 ga KS desu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=496",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/96.png",title:"Tata Bahasa / Pola Kalimat N5 : KB wa KS deshita/ -katta desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=492",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/94.png",title:"Tata Bahasa N5: Kata Benda de Kata Kerja | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=489",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/91.png",title:"Tata Bahasa / Pola Kalimat N5 : no shumi wa~ desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=485",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/92.png",title:"Tata Bahasa / Pola Kalimat N5 : ga dekimasu /koto ga dekimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=482",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/90.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ made ni | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=479",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/89.png",title:"Tata Bahasa / Pola Kalimat N5: ~ nakute mo ii | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=472",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/88.png",title:"Tata Bahasa / Pola Kalimat N5 : agemasu /moraimasu/kuremasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=468",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/87.png",title:"Tata Bahasa / Pola Kalimat N5 : mae ni, | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=463",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/85.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ te mo ii | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=459",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/84.png",title:"Tata Bahasa / Pola Kalimat N5 : nakereba narimasen | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=456",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/83.png",title:"Tata Bahasa / Pola Kalimat N5 :  naide kudasai | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=452",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/82.png",title:"Tata Bahasa / Pola Kalimat N5 : ga tokui / nigate | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=448",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/81.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ ga jouzu / tokui / heta | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=444",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/80.png",title:"Tata Bahasa / Pola Kalimat N5 :  ga suki / ga kirai | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=440",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/33.png",title:"Anggota Tubuh dalam bahasa Jepang | Kosakata dan Ungkapan",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=436",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/31.png",title:"Nama-nama Warna dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=431",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/25.png",title:"Jangka Waktu (Tahun, Bulan, Minggu, Hari) dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=428",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/30.png",title:"Kosakata tentang Anggota Keluarga dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=418",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/16.png",title:"Daftar Kata Kerja Bahasa Jepang N5",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=413",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/28.png",title:"Jam, Menit dan Detik dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=408",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/24.png",title:"Nama-nama Bulan dan Penyebutan Tanggal dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=318",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/27.png",title:"Angka dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=313",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/23.png",title:"Nama-nama Hari dan Kata Keterangan Waktu dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=310",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/79.png",title:"Tata Bahasa / Pola Kalimat N5 : KB to KK | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=308",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/78.png",title:"Tata Bahasa / Pola Kalimat N5 : A to B | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=305",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/77.png",title:"Tata Bahasa / Pola Kalimat N5 : eni ikimasu / kimasu / kaerimasu| Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=303",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/76.png",title:"Tata Bahasa / Pola Kalimat N5 : KB de ikimasu / kimasu / kaerimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=301",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/75.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ kara ~ made KK-masu/desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=299",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/74.png",title:"Tata Bahasa / Pola Kalimat N5 : e ikimasu / kimasu / kaerimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=294",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/73.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ tai desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=290",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/72.png",title:"Tata Bahasa / Pola Kalimat N5 :  ga hoshii | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=288",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/71.png",title:"Tata Bahasa / Pola Kalimat N5 : te imasu (sedang) | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=286",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/22.png",title:"Kata Kerja -MASU, -MASEN, -MASHITA, -MASEN DESHITA",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=282",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/70.png",title:"Tata Bahasa / Pola Kalimat N5 : te kudasai | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=278",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/69.png",title:"Pola Kalimat N5 : KB wa KS dewa arimasen / -kunai desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=275",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/68.png",title:"Tata Bahasa / Pola Kalimat N5 : KB wa KS desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=273",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/67.png",title:"Tata Bahasa / Pola Kalimat N5 : mashou | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=271",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/66.png",title:"Tata Bahasa / Pola Kalimat N5 : masen ka | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=269",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/65.png",title:"Tata Bahasa / Pola Kalimat N5 : A ni B | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=267",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/64.png",title:"Tata Bahasa / Pola Kalimat N5 : wani imasu / arimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=264",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/63.png",title:"Tata Bahasa / Pola Kalimat N5 : niga imasu / arimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=254",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/62.png",title:"Tata Bahasa / Pola Kalimat N5 : ga imasu / arimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=250",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/61.png",title:"Tata Bahasa / Pola Kalimat N5 : wa kochira / sochira / achira desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=248",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/60.png",title:"Tata Bahasa / Pola Kalimat N5 : wa koko / soko / asoko desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=245",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/59.png",title:"Tata Bahasa / Pola Kalimat N5 : Kono / Sono / Anowadesu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=242",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/58.png",title:"Tata Bahasa / Pola Kalimat N5 : Kore / Sore / Are wadesu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=239",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/57.png",title:"Tata Bahasa / Pola Kalimat N5 : A  B | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=232",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/62-2-520x300.png",title:"Tata Bahasa / Pola Kalimat N5 : A mo B desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=223",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/14.png",title:"Daftar Kanji JLPT N5 | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=210",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/18.png",title:"Kata Kerja Bentuk Lampau / Bentuk -TA | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=199",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/56.png",title:"Tata Bahasa / Pola Kalimat N5 : A wa B desu ka | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=196",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/55.png",title:"Tata Bahasa / Pola Kalimat N5 : A wa B dewa/ja arimasen | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=183",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/52-1.png",title:"A wa B desu : Tata Bahasa / Pola Kalimat N5 | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=128",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/17.png",title:"Kata Kerja Bentuk Kamus dan Bentuk -MASU | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=120",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/15.png",title:"Pengelompokkan Kata Kerja Bahasa Jepang (Golongan 1, 2 dan 3)",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=113",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/21.png",title:"Perubahan Kata Kerja Bentuk Biasa (Doushi Futsuu-kei) | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=107",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/20.png",title:"Kata Kerja Bentuk Negatif (Bentuk -NAI dan Bentuk -NAKATTA) | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=103",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/19.png",title:"Perubahan Kata Kerja Bentuk  TE | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=93",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/11.png",title:"Mengenal Kanji | Huruf bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=74",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/10.png",title:"Tips Menghafal Hiragana dan Katakana dengan Mudah dan Efektif",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=71",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/9.png",title:"Katakana Dakuon, Handakuon, Youon, Sokuon dan Chouon",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=65",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/8.png",title:"Mengenal Katakana | Huruf bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=55",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/7.png",title:"Hiragana Dakuon, Handakuon, Youon, Sokuon dan Chouon",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=54",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/6.png",title:"Mengenal Hiragana | Huruf bahasa Jepang",date:"2023-10-25"},{link:"https://wkwk-japanese.com/?p=34",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/5.png",title:"Bahasa Jepang : Sejarah, Sistem Penulisan dan Struktur Kalimat",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=14",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/4.png",title:"Peta Pembelajaran N5/N4",date:"2023-10-09"}],zB=[{id:1,fact:"Jepang memiliki lebih dari 5 juta mesin penjual otomatis (vending machine) - lebih banyak dari negara manapun di dunia!",icon:"",gradient:"from-blue-500/20 to-purple-500/20"},{id:2,fact:"Di Jepang, ada lebih dari 200 gunung berapi aktif, termasuk Gunung Fuji yang terkenal.",icon:"",gradient:"from-red-500/20 to-orange-500/20"},{id:3,fact:"Jepang memiliki lebih dari 1.500 gempa bumi setiap tahunnya, tapi kebanyakan tidak terasa.",icon:"",gradient:"from-yellow-500/20 to-red-500/20"},{id:4,fact:"Kereta Shinkansen (bullet train) di Jepang memiliki keterlambatan rata-rata hanya 36 detik per tahun!",icon:"",gradient:"from-green-500/20 to-blue-500/20"},{id:5,fact:"Jepang memiliki lebih dari 6.800 pulau, tapi hanya sekitar 430 yang berpenghuni.",icon:"",gradient:"from-teal-500/20 to-blue-500/20"},{id:6,fact:"Tokyo adalah kota dengan jumlah restoran bintang Michelin terbanyak di dunia.",icon:"",gradient:"from-purple-500/20 to-pink-500/20"},{id:7,fact:"Sumo adalah olahraga nasional Jepang dan telah ada selama berabad-abad.",icon:"",gradient:"from-orange-500/20 to-yellow-500/20"},{id:8,fact:"Bunga sakura (cherry blossom) adalah simbol nasional Jepang dan melambangkan keindahan dan kefanaan hidup.",icon:"",gradient:"from-pink-500/20 to-red-500/20"},{id:9,fact:"Tidur siang di tempat kerja, yang disebut 'inemuri', dianggap dapat meningkatkan produktivitas di Jepang.",icon:"",gradient:"from-indigo-500/20 to-purple-500/20"},{id:10,fact:"Jepang adalah salah satu negara dengan harapan hidup tertinggi di dunia.",icon:"",gradient:"from-green-500/20 to-teal-500/20"},{id:11,fact:"Ada kafe khusus kucing di Jepang di mana Anda bisa minum kopi sambil bermain dengan kucing.",icon:"",gradient:"from-brown-500/20 to-orange-500/20"},{id:12,fact:"Istana Kekaisaran Tokyo dibangun di atas bekas reruntuhan Kastil Edo.",icon:"",gradient:"from-gray-500/20 to-blue-500/20"},{id:13,fact:"Jepang memiliki tingkat melek huruf hampir 100%.",icon:"",gradient:"from-blue-500/20 to-indigo-500/20"},{id:14,fact:"Menyeruput mi saat makan dianggap sopan di Jepang sebagai tanda menikmati makanan.",icon:"",gradient:"from-yellow-500/20 to-green-500/20"},{id:15,fact:"Kit Kat memiliki lebih dari 300 rasa unik di Jepang, termasuk wasabi, sake, dan teh hijau.",icon:"",gradient:"from-red-500/20 to-brown-500/20"},{id:16,fact:"Ada sebuah pulau di Jepang yang dihuni oleh ribuan kelinci liar, bernama kunoshima.",icon:"",gradient:"from-pink-500/20 to-gray-500/20"},{id:17,fact:"Kimono, pakaian tradisional Jepang, secara harfiah berarti 'sesuatu untuk dipakai'.",icon:"",gradient:"from-purple-500/20 to-teal-500/20"},{id:18,fact:"Jepang memiliki salah satu sistem transportasi umum paling efisien dan tepat waktu di dunia.",icon:"",gradient:"from-blue-500/20 to-green-500/20"},{id:19,fact:"Musim semi di Jepang dirayakan dengan festival 'Hanami' (melihat bunga).",icon:"",gradient:"from-orange-500/20 to-pink-500/20"},{id:20,fact:"Wasabi asli sangat langka dan mahal; kebanyakan yang dijual adalah lobak pedas yang diwarnai.",icon:"",gradient:"from-green-500/20 to-teal-500/20"},{id:21,fact:"Manga (komik Jepang) dan Anime (animasi Jepang) sangat populer di seluruh dunia.",icon:"",gradient:"from-blue-500/20 to-purple-500/20"},{id:22,fact:"Di Jepang, gigi yang sedikit bengkok atau 'yaeba' sering dianggap menarik dan imut.",icon:"",gradient:"from-pink-500/20 to-gray-500/20"},{id:23,fact:"Ada lebih dari 34.000 perusahaan yang berusia lebih dari 100 tahun di Jepang, yang tertua di dunia.",icon:"",gradient:"from-gray-500/20 to-brown-500/20"},{id:24,fact:"Setiap tahun, ada festival 'Hadaka Matsuri' di mana ribuan pria hanya memakai cawat.",icon:"",gradient:"from-red-500/20 to-orange-500/20"},{id:25,fact:"Memberi tip tidak umum dan bahkan bisa dianggap tidak sopan di Jepang.",icon:"",gradient:"from-yellow-500/20 to-green-500/20"},{id:26,fact:"Desa Nagoro di Jepang memiliki lebih banyak boneka seukuran manusia daripada penduduk.",icon:"",gradient:"from-pink-500/20 to-purple-500/20"},{id:27,fact:"Karaoke, yang berarti 'orkestra kosong', ditemukan di Jepang.",icon:"",gradient:"from-blue-500/20 to-teal-500/20"},{id:28,fact:"Sekolah di Jepang tidak memiliki petugas kebersihan; siswa dan guru membersihkan sekolah sendiri.",icon:"",gradient:"from-brown-500/20 to-gray-500/20"},{id:29,fact:"Jepang memiliki 'Pulau Kucing' lain bernama Aoshima, di mana rasio kucing dan manusia adalah 36:1.",icon:"",gradient:"from-black-500/20 to-gray-500/20"},{id:30,fact:"Mata uang Jepang adalah Yen ().",icon:"",gradient:"from-green-500/20 to-yellow-500/20"},{id:31,fact:"Jepang memiliki ribuan 'onsen' (pemandian air panas alami) yang digunakan untuk relaksasi.",icon:"",gradient:"from-red-500/20 to-orange-500/20"},{id:32,fact:"Fugu (ikan buntal) adalah hidangan lezat yang bisa mematikan jika tidak disiapkan oleh koki bersertifikat.",icon:"",gradient:"from-blue-500/20 to-green-500/20"},{id:33,fact:"Hutan Bambu Arashiyama di Kyoto terkenal dengan suara anginnya yang menenangkan.",icon:"",gradient:"from-green-500/20 to-teal-500/20"},{id:34,fact:"Boneka Daruma adalah jimat keberuntungan di Jepang. Satu mata diisi saat membuat harapan, dan mata kedua diisi saat harapan terkabul.",icon:"",gradient:"from-red-500/20 to-blue-500/20"},{id:35,fact:"Pulau Naoshima di Jepang didedikasikan untuk seni kontemporer, penuh dengan museum dan patung.",icon:"",gradient:"from-purple-500/20 to-pink-500/20"},{id:36,fact:"Kuil Fushimi Inari-taisha di Kyoto terkenal dengan ribuan gerbang torii merahnya.",icon:"",gradient:"from-orange-500/20 to-red-500/20"},{id:37,fact:"Jepang adalah salah satu produsen robot industri terbesar di dunia.",icon:"",gradient:"from-gray-500/20 to-blue-500/20"},{id:38,fact:"Jepang memegang rekor kecepatan kereta api dunia dengan kereta maglev SCMaglev.",icon:"",gradient:"from-blue-500/20 to-purple-500/20"},{id:39,fact:"Hutan di sekitar Kuil Meiji Jingu, Tokyo, adalah hutan buatan yang ditanami oleh relawan.",icon:"",gradient:"from-green-500/20 to-brown-500/20"},{id:40,fact:"Upacara minum teh Jepang, atau 'Sad', adalah seni ritual yang sangat dihormati.",icon:"",gradient:"from-teal-500/20 to-green-500/20"},{id:41,fact:"Festival Salju Sapporo menampilkan patung-patung es dan salju raksasa yang menakjubkan.",icon:"",gradient:"from-blue-500/20 to-white-500/20"},{id:42,fact:"Jepang memiliki salah satu tingkat kejahatan terendah di dunia. Barang yang hilang sering kali kembali ke pemiliknya.",icon:"",gradient:"from-black-500/20 to-gray-500/20"},{id:43,fact:"Semangka berbentuk kotak ditanam di Jepang agar lebih mudah disimpan di kulkas.",icon:"",gradient:"from-green-500/20 to-yellow-500/20"},{id:44,fact:"Jepang memiliki hari libur nasional untuk menghargai gunung, yaitu Hari Gunung (Yama no Hi).",icon:"",gradient:"from-brown-500/20 to-green-500/20"},{id:45,fact:"Origami, seni melipat kertas, berasal dari Jepang.",icon:"",gradient:"from-white-500/20 to-pink-500/20"},{id:46,fact:"Banyak bangunan di Jepang tidak memiliki lantai 4 karena angka 'empat' (shi) terdengar seperti 'kematian'.",icon:"",gradient:"from-gray-500/20 to-black-500/20"},{id:47,fact:"Jepang adalah salah satu dari sedikit negara di dunia yang masih memiliki kaisar sebagai simbol negara.",icon:"",gradient:"from-yellow-500/20 to-orange-500/20"},{id:48,fact:"The Tale of Genji, yang ditulis pada abad ke-11 oleh seorang wanita bangsawan, dianggap sebagai novel pertama di dunia.",icon:"",gradient:"from-purple-500/20 to-indigo-500/20"},{id:49,fact:"Monyet salju Jepang (Japanese Macaque) terkenal karena berendam di pemandian air panas saat musim dingin.",icon:"",gradient:"from-brown-500/20 to-blue-500/20"},{id:50,fact:"Ada sebuah 'Museum Ramen' di Yokohama yang memungkinkan pengunjung untuk menjelajahi sejarah ramen.",icon:"",gradient:"from-orange-500/20 to-red-500/20"},{id:51,fact:"Jepang memiliki tiga sistem tulisan yang berbeda: Kanji, Hiragana, dan Katakana.",icon:"",gradient:"from-black-500/20 to-white-500/20"},{id:52,fact:"Hotel kapsul, penginapan dengan 'kamar' seukuran tempat tidur, pertama kali muncul di Osaka, Jepang.",icon:"",gradient:"from-blue-500/20 to-gray-500/20"},{id:53,fact:"Pachinko, permainan mekanis seperti pinball, adalah industri perjudian yang sangat besar di Jepang.",icon:"",gradient:"from-red-500/20 to-yellow-500/20"},{id:54,fact:"Geisha secara harfiah berarti 'seniman'. Mereka adalah penghibur profesional yang sangat terampil dalam seni tradisional.",icon:"",gradient:"from-pink-500/20 to-red-500/20"},{id:55,fact:"Hutan Aokigahara di kaki Gunung Fuji, yang dikenal sebagai 'Lautan Pohon', memiliki reputasi yang suram karena sering dikaitkan dengan mitos.",icon:"",gradient:"from-green-500/20 to-black-500/20"},{id:56,fact:"Toilet di Jepang sering kali berteknologi tinggi, dengan fitur seperti penghangat kursi, semprotan air (washlet), dan suara privasi.",icon:"",gradient:"from-blue-500/20 to-teal-500/20"},{id:57,fact:"Di Jepang, ada layanan untuk menyewa 'teman' atau 'keluarga' untuk menemani acara sosial.",icon:"",gradient:"from-indigo-500/20 to-purple-500/20"},{id:58,fact:"Samurai, kelas prajurit Jepang, mengikuti kode etik yang disebut 'Bushido' atau 'Jalan Prajurit'.",icon:"",gradient:"from-gray-500/20 to-red-500/20"},{id:59,fact:"Jepang adalah rumah bagi ikan Koi, yang dianggap sebagai simbol keberuntungan, kemakmuran, dan nasib baik.",icon:"",gradient:"from-orange-500/20 to-white-500/20"},{id:60,fact:"Kintsugi adalah seni Jepang memperbaiki tembikar yang pecah dengan pernis yang dicampur bubuk emas, perak, atau platina.",icon:"",gradient:"from-yellow-500/20 to-brown-500/20"},{id:61,fact:"Makan sambil berjalan dianggap kurang sopan di sebagian besar wilayah Jepang.",icon:"",gradient:"from-red-500/20 to-gray-500/20"},{id:62,fact:"Lebih banyak popok dewasa terjual di Jepang daripada popok bayi, mencerminkan populasi yang menua.",icon:"",gradient:"from-blue-500/20 to-yellow-500/20"},{id:63,fact:"Hampir semua ponsel di Jepang tahan air karena banyak orang menggunakannya bahkan saat mandi.",icon:"",gradient:"from-teal-500/20 to-blue-500/20"},{id:64,fact:"Karate, olahraga bela diri yang terkenal di dunia, berasal dari Okinawa, Jepang.",icon:"",gradient:"from-white-500/20 to-black-500/20"},{id:65,fact:"Ada lebih dari 80.000 kuil Shinto dan 77.000 kuil Buddha di seluruh Jepang.",icon:"",gradient:"from-orange-500/20 to-purple-500/20"},{id:66,fact:"Kawasan perbelanjaan Ginza di Tokyo adalah salah satu real estat paling mahal di dunia.",icon:"",gradient:"from-pink-500/20 to-yellow-500/20"},{id:67,fact:"Di Jepang, menunjuk seseorang secara langsung dengan jari dianggap tidak sopan.",icon:"",gradient:"from-red-500/20 to-yellow-500/20"},{id:68,fact:"Jepang memiliki 'love hotel', hotel dengan tarif per jam yang dirancang untuk privasi pasangan.",icon:"",gradient:"from-pink-500/20 to-purple-500/20"},{id:69,fact:"Ikebana adalah seni merangkai bunga tradisional Jepang yang menekankan bentuk, garis, dan minimalisme.",icon:"",gradient:"from-green-500/20 to-pink-500/20"},{id:70,fact:"Jigoku Mushi, atau 'masakan neraka', adalah metode memasak makanan dengan uap panas dari onsen.",icon:"",gradient:"from-red-500/20 to-gray-500/20"},{id:71,fact:"Persimpangan Shibuya di Tokyo adalah persimpangan pejalan kaki tersibuk di dunia.",icon:"",gradient:"from-blue-500/20 to-green-500/20"},{id:72,fact:"Shod, atau kaligrafi Jepang, dianggap sebagai bentuk seni dan meditasi.",icon:"",gradient:"from-black-500/20 to-gray-500/20"},{id:73,fact:"Festival Kanamara di Kawasaki merayakan kesuburan dan penis, dengan permen, dekorasi, dan kuil portabel bertema falus.",icon:"",gradient:"from-pink-500/20 to-blue-500/20"},{id:74,fact:"Ada sebuah museum di Jepang yang didedikasikan sepenuhnya untuk batu yang terlihat seperti wajah manusia, disebut Chinsekikan.",icon:"",gradient:"from-gray-500/20 to-brown-500/20"},{id:75,fact:"Mochi, kue beras ketan, adalah makanan tradisional Tahun Baru, tetapi bisa berbahaya karena risiko tersedak.",icon:"",gradient:"from-white-500/20 to-green-500/20"},{id:76,fact:"Di Jepang, membungkuk adalah bagian penting dari etiket untuk menunjukkan rasa hormat, terima kasih, atau permintaan maaf.",icon:"",gradient:"from-blue-500/20 to-indigo-500/20"},{id:77,fact:"Haiku, bentuk puisi pendek Jepang, terdiri dari tiga frasa dengan pola 5, 7, 5 suku kata.",icon:"",gradient:"from-gray-500/20 to-white-500/20"},{id:78,fact:"Jepang adalah konsumen ikan terbesar kelima di dunia.",icon:"",gradient:"from-blue-500/20 to-cyan-500/20"},{id:79,fact:"Ada lebih banyak hewan peliharaan di Jepang daripada anak-anak di bawah usia 15 tahun.",icon:"",gradient:"from-brown-500/20 to-yellow-500/20"},{id:80,fact:"Godzilla adalah ikon budaya pop Jepang dan telah muncul di lebih dari 30 film.",icon:"",gradient:"from-green-500/20 to-gray-500/20"},{id:81,fact:"Jepang adalah rumah bagi salamander raksasa, amfibi terbesar kedua di dunia.",icon:"",gradient:"from-brown-500/20 to-green-500/20"},{id:82,fact:"Stasiun Shinjuku di Tokyo adalah stasiun kereta api tersibuk di dunia, melayani lebih dari 3,5 juta orang setiap hari.",icon:"",gradient:"from-yellow-500/20 to-blue-500/20"},{id:83,fact:"Festival Gion Matsuri di Kyoto adalah salah satu festival paling terkenal di Jepang dan berlangsung selama sebulan penuh di bulan Juli.",icon:"",gradient:"from-red-500/20 to-purple-500/20"},{id:84,fact:"Di beberapa restoran di Jepang, Anda memesan dan membayar makanan melalui mesin penjual otomatis sebelum duduk.",icon:"",gradient:"from-blue-500/20 to-yellow-500/20"},{id:85,fact:"Jepang adalah negara dengan pemenang Hadiah Nobel terbanyak di Asia.",icon:"",gradient:"from-yellow-500/20 to-brown-500/20"},{id:86,fact:"Hampir 70% wilayah Jepang tertutup oleh hutan.",icon:"",gradient:"from-green-500/20 to-darkgreen-500/20"},{id:87,fact:"Konstitusi Jepang memiliki 'Pasal 9' yang melarang negara untuk berperang.",icon:"",gradient:"from-white-500/20 to-blue-500/20"},{id:88,fact:"Ada sebuah hotel di Jepang, Nishiyama Onsen Keiunkan, yang telah beroperasi sejak tahun 705 M, menjadikannya hotel tertua di dunia.",icon:"",gradient:"from-brown-500/20 to-gray-500/20"},{id:89,fact:"Di Jepang, Natal lebih sering dirayakan sebagai hari romantis bagi pasangan daripada hari raya keluarga.",icon:"",gradient:"from-red-500/20 to-pink-500/20"},{id:90,fact:"Makan di KFC telah menjadi tradisi Natal yang populer di Jepang sejak kampanye pemasaran tahun 1974.",icon:"",gradient:"from-red-500/20 to-brown-500/20"},{id:91,fact:"Tokyo Skytree adalah menara tertinggi di dunia, dengan ketinggian 634 meter.",icon:"",gradient:"from-blue-500/20 to-purple-500/20"},{id:92,fact:"Okinawa, sebuah prefektur di selatan Jepang, memiliki beberapa konsentrasi centenarian (orang berusia di atas 100 tahun) tertinggi di dunia.",icon:"",gradient:"from-green-500/20 to-blue-500/20"},{id:93,fact:"Bunraku adalah bentuk teater boneka tradisional Jepang di mana tiga dalang mengoperasikan satu boneka besar.",icon:"",gradient:"from-purple-500/20 to-black-500/20"},{id:94,fact:"Jepang memiliki hari libur nasional bernama Hari Kedewasaan (Seijin no Hi) untuk merayakan mereka yang mencapai usia 20 tahun.",icon:"",gradient:"from-red-500/20 to-white-500/20"},{id:95,fact:"Ada desa rubah di pegunungan Miyagi (Zao Kitsune Mura) di mana lebih dari seratus rubah berkeliaran dengan bebas.",icon:"",gradient:"from-orange-500/20 to-brown-500/20"},{id:96,fact:"Bento adalah kotak makan siang bekal sekali saji khas Jepang, sering kali disiapkan dengan sangat artistik.",icon:"",gradient:"from-green-500/20 to-red-500/20"},{id:97,fact:"Jepang adalah salah satu importir kopi terbesar di dunia, dengan budaya kafe yang kuat dan beragam.",icon:"",gradient:"from-brown-500/20 to-black-500/20"},{id:98,fact:"Anime menyumbang sekitar 60% dari semua serial animasi di dunia.",icon:"",gradient:"from-blue-500/20 to-pink-500/20"},{id:99,fact:"Para pemanah berkuda, atau Yabusame, adalah tradisi samurai kuno yang masih dipraktikkan hingga hari ini.",icon:"",gradient:"from-green-500/20 to-brown-500/20"},{id:100,fact:"Mempertukarkan kartu nama (meishi) adalah ritual bisnis yang sangat penting di Jepang, dengan aturan etiket yang ketat.",icon:"",gradient:"from-gray-500/20 to-blue-500/20"}],MB=()=>{const[t,e]=B.useState(0),[n,s]=B.useState(!1),a=B.useMemo(()=>[...zB].sort(()=>.5-Math.random()).slice(0,4),[]);B.useEffect(()=>{if(!n){const o=setInterval(()=>{e(l=>(l+1)%a.length)},5e3);return()=>clearInterval(o)}},[n,a.length]);const r=()=>{e(o=>o===0?a.length-1:o-1)},i=()=>{e(o=>(o+1)%a.length)};return N.jsx("div",{className:"w-full mb-8",children:N.jsx("div",{className:`backdrop-blur-lg bg-white/30 rounded-2xl p-4 sm:p-6 md:p-8 shadow-lg border border-white/20\r
                   hover:shadow-xl transition-all duration-300`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:N.jsxs("div",{className:"relative overflow-hidden",children:[N.jsx("button",{onClick:r,className:`hidden sm:block absolute left-3 top-1/2 -translate-y-1/2 z-10 p-2 sm:p-3 rounded-full\r
                     bg-white/50 hover:bg-white/80 transition-all duration-300\r
                     shadow-lg hover:shadow-xl border border-white/30\r
                     transform hover:scale-110 active:scale-95`,"aria-label":"Previous fact",children:N.jsx("svg",{className:"w-5 h-5 sm:w-7 sm:h-7 text-surface-900",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),N.jsx("button",{onClick:i,className:`hidden sm:block absolute right-3 top-1/2 -translate-y-1/2 z-10 p-2 sm:p-3 rounded-full\r
                     bg-white/50 hover:bg-white/80 transition-all duration-300\r
                     shadow-lg hover:shadow-xl border border-white/30\r
                     transform hover:scale-110 active:scale-95`,"aria-label":"Next fact",children:N.jsx("svg",{className:"w-5 h-5 sm:w-7 sm:h-7 text-surface-900",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),N.jsx("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:`translateX(-${t*100}%)`},children:a.map(o=>N.jsxs("div",{className:`w-full flex-shrink-0 flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-6 md:gap-8 p-4 sm:p-6 md:p-8
                           bg-gradient-to-r ${o.gradient} rounded-xl min-h-[180px] sm:min-h-[200px]`,children:[N.jsx("div",{className:`flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-full\r
                              bg-white/50 backdrop-blur-sm shadow-lg border border-white/30\r
                              transform transition-transform duration-300 hover:scale-110`,children:N.jsx("span",{className:"text-4xl sm:text-5xl",children:o.icon})}),N.jsx("p",{className:"text-base sm:text-lg md:text-xl text-surface-900 font-medium max-w-2xl leading-relaxed text-center sm:text-left",children:o.fact})]},o.id))}),N.jsx("div",{className:"flex justify-center gap-2 sm:gap-3 mt-4 sm:mt-6 md:mt-8",children:a.map((o,l)=>N.jsx("button",{onClick:()=>e(l),className:`h-2 sm:h-2.5 rounded-full transition-all duration-300 ${l===t?"bg-primary-600 w-8 sm:w-10":"bg-surface-300 w-2 sm:w-2.5 hover:bg-surface-400"}`,"aria-label":`Go to fact ${l+1}`},l))})]})})})},VB=()=>{ji();const[t,e]=B.useState(""),n=()=>{const h=window.innerWidth;return h<768?4:h<1024?6:9},[s,a]=B.useState(()=>{const h=sessionStorage.getItem("visibleItems");return h?parseInt(h,10):n()}),[r,i]=B.useState(()=>{const h=window.innerWidth;return h<768?"mobile":h<1024?"tablet":"desktop"});B.useEffect(()=>{const h=sessionStorage.getItem("scrollPos");if(h){const f=parseInt(h,10);if(!isNaN(f)){let m=setTimeout(()=>{requestAnimationFrame(()=>{window.scrollTo(0,f)})},10);return()=>clearTimeout(m)}}},[]),B.useEffect(()=>{const h=()=>{sessionStorage.removeItem("visibleItems"),sessionStorage.removeItem("scrollPos")};return window.addEventListener("beforeunload",h),()=>window.removeEventListener("beforeunload",h)},[]),B.useEffect(()=>{const h=()=>{const f=window.innerWidth;let m,y;f<768?(m="mobile",y=4):f<1024?(m="tablet",y=6):(m="desktop",y=9),i(m),a(y),sessionStorage.setItem("visibleItems",y.toString())};return window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]);const o=B.useMemo(()=>{const h=t.toLowerCase();return Object.entries(mi).filter(([f,m])=>m.japanese.toLowerCase().includes(h)||m.romaji.toLowerCase().includes(h)||m.indonesian.toLowerCase().includes(h))},[t]),l=()=>{a(h=>{let f;switch(r){case"mobile":f=4;break;case"tablet":f=6;break;case"desktop":default:f=9;break}const m=h+f;return sessionStorage.setItem("visibleItems",m.toString()),m})},u=o.slice(0,s),c=s<o.length,d=Lw.slice(0,2),p=()=>{sessionStorage.setItem("visibleItems",s.toString()),sessionStorage.setItem("scrollPos",window.scrollY.toString())};return N.jsxs("main",{className:"container mx-auto px-4 py-8",children:[N.jsx(MB,{}),N.jsx("div",{className:"mb-12",children:N.jsxs("div",{className:"backdrop-blur-lg bg-white/30 rounded-2xl p-6 shadow-lg border border-white/20",children:[N.jsx("h2",{className:"text-2xl font-bold text-surface-900 mb-4",children:"Uji Kemampuanmu"}),N.jsx("p",{className:"text-surface-600 mb-6",children:"Latih kemampuan bahasa Jepangmu dengan berbagai jenis kuis"}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[N.jsxs(ss,{to:"/kuis/hiragana",className:"group bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-6 text-white hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:translate-y-0 transition-all duration-300",children:[N.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[N.jsx("span",{className:"text-2xl",children:""}),N.jsx("h3",{className:"text-lg font-semibold",children:"Kuis Hiragana"})]}),N.jsx("p",{className:"text-blue-100 text-sm",children:"Latih kemampuan membaca Hiragana"})]}),N.jsxs(ss,{to:"/kuis/katakana",className:"group bg-gradient-to-r from-green-500 to-green-600 rounded-xl p-6 text-white hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:translate-y-0 transition-all duration-300",children:[N.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[N.jsx("span",{className:"text-2xl",children:""}),N.jsx("h3",{className:"text-lg font-semibold",children:"Kuis Katakana"})]}),N.jsx("p",{className:"text-green-100 text-sm",children:"Latih kemampuan membaca Katakana"})]}),N.jsxs(ss,{to:"/kuis/kosakata",className:"group bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl p-6 text-white hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:translate-y-0 transition-all duration-300",children:[N.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[N.jsx("span",{className:"text-2xl",children:""}),N.jsx("h3",{className:"text-lg font-semibold",children:"Kuis Kosakata"})]}),N.jsx("p",{className:"text-purple-100 text-sm",children:"Uji pengetahuan kosakata bahasa Jepang"})]})]})]})}),N.jsx("div",{className:"w-full mb-12 pt-4 sticky top-14 z-50",children:N.jsx("div",{className:"backdrop-blur-lg bg-white/90 rounded-2xl p-6 shadow-lg border border-white/20",children:N.jsxs("div",{className:"flex items-center gap-6",children:[N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("h2",{className:"text-2xl font-bold text-surface-900",children:"List Benda"}),N.jsxs("span",{className:"hidden md:inline text-surface-500",children:["(",o.length," benda)"]})]}),N.jsxs("div",{className:"relative flex-1",children:[N.jsx("input",{type:"text",placeholder:"Cari benda...",value:t,onChange:h=>e(h.target.value),className:"w-full px-4 py-3 pl-12 rounded-xl border border-surface-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),N.jsx(_B,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-surface-400",size:20})]})]})})}),N.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:u.map(([h,f])=>N.jsxs(ss,{to:`/benda/${h}`,state:{from:"homePage"},onClick:p,className:"group bg-white/50 rounded-xl overflow-hidden transition-all duration-300 hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0 border border-white/30",children:[N.jsx("div",{className:"aspect-video overflow-hidden",children:N.jsx("img",{src:f.imageUrl,alt:f.indonesian,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),N.jsxs("div",{className:"p-4",children:[N.jsxs("h3",{className:"text-lg font-semibold text-surface-900 mb-2",children:[f.japanese," (",f.indonesian,")"]}),N.jsx("p",{className:"text-surface-600 mb-1",children:f.romaji})]})]},h))}),c&&N.jsx("div",{className:"flex justify-center",children:N.jsxs("button",{onClick:l,className:"group relative inline-flex items-center gap-2 px-8 py-3.5 bg-gradient-to-r from-primary-500 to-primary-600 rounded-xl text-white font-medium overflow-hidden transition-all duration-300 hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:translate-y-0",children:[N.jsx("span",{className:"relative z-10",children:"Lihat Lebih Banyak"}),N.jsx("svg",{className:"w-5 h-5 relative z-10 transition-transform duration-300 group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),N.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary-600 to-primary-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})}),N.jsxs("div",{className:"backdrop-blur-lg bg-white/30 rounded-2xl p-6 shadow-lg border border-white/20 mt-12",children:[N.jsxs("div",{className:"flex justify-between items-center mb-6",children:[N.jsxs("div",{className:"flex items-center gap-4",children:[N.jsx("h2",{className:"hidden md:block text-2xl font-bold text-surface-900",children:"Belajar Bersama"}),N.jsx("img",{src:"https://wkwk-japanese.com/wp-content/uploads/2022/12/logo_wkwkjapanese.png",alt:"WKWK Japanese Logo",className:"h-8 w-auto"}),N.jsx("span",{className:"hidden md:block text-lg font-medium text-surface-900",children:"WKWK JAPANESE"})]}),N.jsx(ss,{to:"/artikel",className:"px-4 py-2 bg-white/50 rounded-xl border border-white/30 hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0 transition-all duration-300 text-surface-900 font-medium",children:"Lihat Artikel"})]}),N.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map((h,f)=>N.jsxs("a",{href:h.link,target:"_blank",rel:"noopener noreferrer",className:"group bg-white/50 rounded-xl overflow-hidden transition-all duration-300 hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0 border border-white/30",children:[N.jsx("div",{className:"aspect-video overflow-hidden",children:N.jsx("img",{src:h.img,alt:h.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),N.jsxs("div",{className:"p-4",children:[N.jsx("h3",{className:"text-lg font-semibold text-surface-900 mb-2 line-clamp-2",children:h.title}),N.jsx("p",{className:"text-surface-500 text-sm",children:new Date(h.date).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})})]})]},f))})]})]})},WB=()=>N.jsx("main",{className:"container mx-auto px-4 py-8",children:N.jsxs("div",{className:"max-w-3xl mx-auto space-y-8",children:[N.jsxs("div",{className:"neu-card p-8",children:[N.jsx("h1",{className:"text-3xl font-bold text-surface-900 mb-6",children:"Tentang NihonMe"}),N.jsx("p",{className:"text-surface-600 leading-relaxed",children:"NihonMe adalah aplikasi pembelajaran bahasa Jepang yang menggunakan teknologi AI untuk membantu pengguna mempelajari kosakata bahasa Jepang melalui deteksi benda. Aplikasi ini dirancang untuk membuat pembelajaran bahasa Jepang lebih interaktif dan menyenangkan."})]}),N.jsxs("div",{className:"neu-card p-8",children:[N.jsx("h2",{className:"text-2xl font-bold text-surface-900 mb-4",children:"Teknologi yang Digunakan"}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[N.jsxs("div",{className:"space-y-2",children:[N.jsx("h3",{className:"font-semibold text-surface-800",children:"Frontend"}),N.jsxs("ul",{className:"list-disc list-inside text-surface-600",children:[N.jsx("li",{children:"React 18"}),N.jsx("li",{children:"TypeScript"}),N.jsx("li",{children:"Tailwind CSS"}),N.jsx("li",{children:"Vite"}),N.jsx("li",{children:"React Router DOM"})]})]}),N.jsxs("div",{className:"space-y-2",children:[N.jsx("h3",{className:"font-semibold text-surface-800",children:"AI & Machine Learning"}),N.jsxs("ul",{className:"list-disc list-inside text-surface-600",children:[N.jsx("li",{children:"TensorFlow.js"}),N.jsx("li",{children:"COCO-SSD model"})]})]})]})]}),N.jsxs("div",{className:"neu-card p-8",children:[N.jsx("h2",{className:"text-2xl font-bold text-surface-900 mb-6",children:"Tentang Pengembang"}),N.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[N.jsx("div",{className:"w-48 h-48 rounded-full overflow-hidden",children:N.jsx("img",{src:"https://media.licdn.com/dms/image/v2/D5603AQEkQs8ABe_Ipg/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1709478662180?e=1752710400&v=beta&t=CFmIEshJQ2ImGw8HUWRBe4wxRoIEJoc8_EVKhBFU_BI",alt:"Foto Pengembang",className:"w-full h-full object-cover"})}),N.jsxs("div",{className:"flex-1 space-y-4",children:[N.jsxs("div",{children:[N.jsx("h3",{className:"text-xl font-semibold text-surface-800",children:"Arindra Rifky Saputra"}),N.jsx("p",{className:"text-surface-600",children:"Mahasiswa Program Studi Pendidikan Bahasa Jepang UNNES"})]}),N.jsx("p",{className:"text-surface-600",children:"Seorang mahasiswa yang bersemangat dalam mengembangkan aplikasi web untuk pengenalan kosakata benda dalam bahasa Jepang, yang dirancang khusus untuk pembelajar pemula. Saya bertujuan untuk mengintegrasikan teknologi AI object detection guna menciptakan pengalaman belajar yang sangat visual dan interaktif. Melalui aplikasi ini, pengguna dapat dengan mudah mengarahkan kamera pada objek di sekitar mereka, dan AI akan membantu mengidentifikasi serta menyajikan kosakata bahasa Jepang yang relevan, sehingga proses belajar menjadi lebih menarik, kontekstual, dan efektif dalam meningkatkan keinginan belajar siswa."}),N.jsxs("div",{className:"flex gap-4",children:[N.jsx("a",{href:"https://github.com/rifkydelta",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700",children:"GitHub"}),N.jsx("a",{href:"https://linkedin.com/in/rifkydelta",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700",children:"LinkedIn"})]})]})]})]})]})});function sE(t){return e=>typeof e===t}var UB=sE("function"),GB=t=>t===null,fN=t=>Object.prototype.toString.call(t).slice(8,-1)==="RegExp",mN=t=>!HB(t)&&!GB(t)&&(UB(t)||typeof t=="object"),HB=sE("undefined");function KB(t,e){const{length:n}=t;if(n!==e.length)return!1;for(let s=n;s--!==0;)if(!zn(t[s],e[s]))return!1;return!0}function qB(t,e){if(t.byteLength!==e.byteLength)return!1;const n=new DataView(t.buffer),s=new DataView(e.buffer);let a=t.byteLength;for(;a--;)if(n.getUint8(a)!==s.getUint8(a))return!1;return!0}function JB(t,e){if(t.size!==e.size)return!1;for(const n of t.entries())if(!e.has(n[0]))return!1;for(const n of t.entries())if(!zn(n[1],e.get(n[0])))return!1;return!0}function XB(t,e){if(t.size!==e.size)return!1;for(const n of t.entries())if(!e.has(n[0]))return!1;return!0}function zn(t,e){if(t===e)return!0;if(t&&mN(t)&&e&&mN(e)){if(t.constructor!==e.constructor)return!1;if(Array.isArray(t)&&Array.isArray(e))return KB(t,e);if(t instanceof Map&&e instanceof Map)return JB(t,e);if(t instanceof Set&&e instanceof Set)return XB(t,e);if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return qB(t,e);if(fN(t)&&fN(e))return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(let a=n.length;a--!==0;)if(!Object.prototype.hasOwnProperty.call(e,n[a]))return!1;for(let a=n.length;a--!==0;){const r=n[a];if(!(r==="_owner"&&t.$$typeof)&&!zn(t[r],e[r]))return!1}return!0}return Number.isNaN(t)&&Number.isNaN(e)?!0:t===e}var YB=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],QB=["bigint","boolean","null","number","string","symbol","undefined"];function Tg(t){const e=Object.prototype.toString.call(t).slice(8,-1);if(/HTML\w+Element/.test(e))return"HTMLElement";if(ZB(e))return e}function Sa(t){return e=>Tg(e)===t}function ZB(t){return YB.includes(t)}function mu(t){return e=>typeof e===t}function ez(t){return QB.includes(t)}var tz=["innerHTML","ownerDocument","style","attributes","nodeValue"];function he(t){if(t===null)return"null";switch(typeof t){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(he.array(t))return"Array";if(he.plainFunction(t))return"Function";const e=Tg(t);return e||"Object"}he.array=Array.isArray;he.arrayOf=(t,e)=>!he.array(t)&&!he.function(e)?!1:t.every(n=>e(n));he.asyncGeneratorFunction=t=>Tg(t)==="AsyncGeneratorFunction";he.asyncFunction=Sa("AsyncFunction");he.bigint=mu("bigint");he.boolean=t=>t===!0||t===!1;he.date=Sa("Date");he.defined=t=>!he.undefined(t);he.domElement=t=>he.object(t)&&!he.plainObject(t)&&t.nodeType===1&&he.string(t.nodeName)&&tz.every(e=>e in t);he.empty=t=>he.string(t)&&t.length===0||he.array(t)&&t.length===0||he.object(t)&&!he.map(t)&&!he.set(t)&&Object.keys(t).length===0||he.set(t)&&t.size===0||he.map(t)&&t.size===0;he.error=Sa("Error");he.function=mu("function");he.generator=t=>he.iterable(t)&&he.function(t.next)&&he.function(t.throw);he.generatorFunction=Sa("GeneratorFunction");he.instanceOf=(t,e)=>!t||!e?!1:Object.getPrototypeOf(t)===e.prototype;he.iterable=t=>!he.nullOrUndefined(t)&&he.function(t[Symbol.iterator]);he.map=Sa("Map");he.nan=t=>Number.isNaN(t);he.null=t=>t===null;he.nullOrUndefined=t=>he.null(t)||he.undefined(t);he.number=t=>mu("number")(t)&&!he.nan(t);he.numericString=t=>he.string(t)&&t.length>0&&!Number.isNaN(Number(t));he.object=t=>!he.nullOrUndefined(t)&&(he.function(t)||typeof t=="object");he.oneOf=(t,e)=>he.array(t)?t.indexOf(e)>-1:!1;he.plainFunction=Sa("Function");he.plainObject=t=>{if(Tg(t)!=="Object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.getPrototypeOf({})};he.primitive=t=>he.null(t)||ez(typeof t);he.promise=Sa("Promise");he.propertyOf=(t,e,n)=>{if(!he.object(t)||!e)return!1;const s=t[e];return he.function(n)?n(s):he.defined(s)};he.regexp=Sa("RegExp");he.set=Sa("Set");he.string=mu("string");he.symbol=mu("symbol");he.undefined=mu("undefined");he.weakMap=Sa("WeakMap");he.weakSet=Sa("WeakSet");var ye=he;function nz(...t){return t.every(e=>ye.string(e)||ye.array(e)||ye.plainObject(e))}function sz(t,e,n){return aE(t,e)?[t,e].every(ye.array)?!t.some(kN(n))&&e.some(kN(n)):[t,e].every(ye.plainObject)?!Object.entries(t).some(wN(n))&&Object.entries(e).some(wN(n)):e===n:!1}function gN(t,e,n){const{actual:s,key:a,previous:r,type:i}=n,o=Pa(t,a),l=Pa(e,a);let u=[o,l].every(ye.number)&&(i==="increased"?o<l:o>l);return ye.undefined(s)||(u=u&&l===s),ye.undefined(r)||(u=u&&o===r),u}function yN(t,e,n){const{key:s,type:a,value:r}=n,i=Pa(t,s),o=Pa(e,s),l=a==="added"?i:o,u=a==="added"?o:i;if(!ye.nullOrUndefined(r)){if(ye.defined(l)){if(ye.array(l)||ye.plainObject(l))return sz(l,u,r)}else return zn(u,r);return!1}return[i,o].every(ye.array)?!u.every(zx(l)):[i,o].every(ye.plainObject)?az(Object.keys(l),Object.keys(u)):![i,o].every(c=>ye.primitive(c)&&ye.defined(c))&&(a==="added"?!ye.defined(i)&&ye.defined(o):ye.defined(i)&&!ye.defined(o))}function bN(t,e,{key:n}={}){let s=Pa(t,n),a=Pa(e,n);if(!aE(s,a))throw new TypeError("Inputs have different types");if(!nz(s,a))throw new TypeError("Inputs don't have length");return[s,a].every(ye.plainObject)&&(s=Object.keys(s),a=Object.keys(a)),[s,a]}function wN(t){return([e,n])=>ye.array(t)?zn(t,n)||t.some(s=>zn(s,n)||ye.array(n)&&zx(n)(s)):ye.plainObject(t)&&t[e]?!!t[e]&&zn(t[e],n):zn(t,n)}function az(t,e){return e.some(n=>!t.includes(n))}function kN(t){return e=>ye.array(t)?t.some(n=>zn(n,e)||ye.array(e)&&zx(e)(n)):zn(t,e)}function Lc(t,e){return ye.array(t)?t.some(n=>zn(n,e)):zn(t,e)}function zx(t){return e=>t.some(n=>zn(n,e))}function aE(...t){return t.every(ye.array)||t.every(ye.number)||t.every(ye.plainObject)||t.every(ye.string)}function Pa(t,e){return ye.plainObject(t)||ye.array(t)?ye.string(e)?e.split(".").reduce((s,a)=>s&&s[a],t):ye.number(e)?t[e]:t:t}function $m(t,e){if([t,e].some(ye.nullOrUndefined))throw new Error("Missing required parameters");if(![t,e].every(c=>ye.plainObject(c)||ye.array(c)))throw new Error("Expected plain objects or array");return{added:(c,d)=>{try{return yN(t,e,{key:c,type:"added",value:d})}catch{return!1}},changed:(c,d,p)=>{try{const h=Pa(t,c),f=Pa(e,c),m=ye.defined(d),y=ye.defined(p);if(m||y){const g=y?Lc(p,h):!Lc(d,h),b=Lc(d,f);return g&&b}return[h,f].every(ye.array)||[h,f].every(ye.plainObject)?!zn(h,f):h!==f}catch{return!1}},changedFrom:(c,d,p)=>{if(!ye.defined(c))return!1;try{const h=Pa(t,c),f=Pa(e,c),m=ye.defined(p);return Lc(d,h)&&(m?Lc(p,f):!m)}catch{return!1}},decreased:(c,d,p)=>{if(!ye.defined(c))return!1;try{return gN(t,e,{key:c,actual:d,previous:p,type:"decreased"})}catch{return!1}},emptied:c=>{try{const[d,p]=bN(t,e,{key:c});return!!d.length&&!p.length}catch{return!1}},filled:c=>{try{const[d,p]=bN(t,e,{key:c});return!d.length&&!!p.length}catch{return!1}},increased:(c,d,p)=>{if(!ye.defined(c))return!1;try{return gN(t,e,{key:c,actual:d,previous:p,type:"increased"})}catch{return!1}},removed:(c,d)=>{try{return yN(t,e,{key:c,type:"removed",value:d})}catch{return!1}}}}var rz=new Error("Element already at target scroll position"),iz=new Error("Scroll cancelled"),oz=Math.min,xN=Date.now,lz={left:vN("scrollLeft"),top:vN("scrollTop")};function vN(t){return function(n,s,a,r){a=a||{},typeof a=="function"&&(r=a,a={}),typeof r!="function"&&(r=cz);var i=xN(),o=n[t],l=a.ease||uz,u=isNaN(a.duration)?350:+a.duration,c=!1;return o===s?r(rz,n[t]):requestAnimationFrame(p),d;function d(){c=!0}function p(h){if(c)return r(iz,n[t]);var f=xN(),m=oz(1,(f-i)/u),y=l(m);n[t]=y*(s-o)+o,m<1?requestAnimationFrame(p):requestAnimationFrame(function(){r(null,n[t])})}}}function uz(t){return .5*(1-Math.cos(Math.PI*t))}function cz(){}const dz=Ei(lz);var rE={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.Scrollparent=n()})(Ir,function(){function e(s){var a=getComputedStyle(s,null).getPropertyValue("overflow");return a.indexOf("scroll")>-1||a.indexOf("auto")>-1}function n(s){if(s instanceof HTMLElement||s instanceof SVGElement){for(var a=s.parentNode;a.parentNode;){if(e(a))return a;a=a.parentNode}return document.scrollingElement||document.documentElement}}return n})})(rE);var pz=rE.exports;const iE=Ei(pz);var hz=function(t){return Object.prototype.hasOwnProperty.call(t,"props")},fz=function(t,e){return t+jd(e)},jd=function(t){return t===null||typeof t=="boolean"||typeof t>"u"?"":typeof t=="number"?t.toString():typeof t=="string"?t:Array.isArray(t)?t.reduce(fz,""):hz(t)&&Object.prototype.hasOwnProperty.call(t.props,"children")?jd(t.props.children):""};jd.default=jd;var mz=jd;const SN=Ei(mz);var gz=function(e){return yz(e)&&!bz(e)};function yz(t){return!!t&&typeof t=="object"}function bz(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||xz(t)}var wz=typeof Symbol=="function"&&Symbol.for,kz=wz?Symbol.for("react.element"):60103;function xz(t){return t.$$typeof===kz}function vz(t){return Array.isArray(t)?[]:{}}function _d(t,e){return e.clone!==!1&&e.isMergeableObject(t)?Hl(vz(t),t,e):t}function Sz(t,e,n){return t.concat(e).map(function(s){return _d(s,n)})}function Nz(t,e){if(!e.customMerge)return Hl;var n=e.customMerge(t);return typeof n=="function"?n:Hl}function Cz(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function NN(t){return Object.keys(t).concat(Cz(t))}function oE(t,e){try{return e in t}catch{return!1}}function Iz(t,e){return oE(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function Tz(t,e,n){var s={};return n.isMergeableObject(t)&&NN(t).forEach(function(a){s[a]=_d(t[a],n)}),NN(e).forEach(function(a){Iz(t,a)||(oE(t,a)&&n.isMergeableObject(e[a])?s[a]=Nz(a,n)(t[a],e[a],n):s[a]=_d(e[a],n))}),s}function Hl(t,e,n){n=n||{},n.arrayMerge=n.arrayMerge||Sz,n.isMergeableObject=n.isMergeableObject||gz,n.cloneUnlessOtherwiseSpecified=_d;var s=Array.isArray(e),a=Array.isArray(t),r=s===a;return r?s?n.arrayMerge(t,e,n):Tz(t,e,n):_d(e,n)}Hl.all=function(e,n){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(s,a){return Hl(s,a,n)},{})};var $z=Hl,Ez=$z;const da=Ei(Ez);var lE={exports:{}},Rz="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Az=Rz,Oz=Az;function uE(){}function cE(){}cE.resetWarningCache=uE;var Dz=function(){function t(s,a,r,i,o,l){if(l!==Oz){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:cE,resetWarningCache:uE};return n.PropTypes=n,n};lE.exports=Dz();var jz=lE.exports;const ie=Ei(jz);/**!
 * @fileOverview Kickass library to create and place poppers near their reference elements.
 * @version 1.16.1
 * @license
 * Copyright (c) 2016 Federico Zivolo and contributors
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var cp=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",_z=function(){for(var t=["Edge","Trident","Firefox"],e=0;e<t.length;e+=1)if(cp&&navigator.userAgent.indexOf(t[e])>=0)return 1;return 0}();function Fz(t){var e=!1;return function(){e||(e=!0,window.Promise.resolve().then(function(){e=!1,t()}))}}function Pz(t){var e=!1;return function(){e||(e=!0,setTimeout(function(){e=!1,t()},_z))}}var Lz=cp&&window.Promise,Bz=Lz?Fz:Pz;function dE(t){var e={};return t&&e.toString.call(t)==="[object Function]"}function Go(t,e){if(t.nodeType!==1)return[];var n=t.ownerDocument.defaultView,s=n.getComputedStyle(t,null);return e?s[e]:s}function Mx(t){return t.nodeName==="HTML"?t:t.parentNode||t.host}function dp(t){if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}var e=Go(t),n=e.overflow,s=e.overflowX,a=e.overflowY;return/(auto|scroll|overlay)/.test(n+a+s)?t:dp(Mx(t))}function pE(t){return t&&t.referenceNode?t.referenceNode:t}var CN=cp&&!!(window.MSInputMethodContext&&document.documentMode),IN=cp&&/MSIE 10/.test(navigator.userAgent);function gu(t){return t===11?CN:t===10?IN:CN||IN}function Kl(t){if(!t)return document.documentElement;for(var e=gu(10)?document.body:null,n=t.offsetParent||null;n===e&&t.nextElementSibling;)n=(t=t.nextElementSibling).offsetParent;var s=n&&n.nodeName;return!s||s==="BODY"||s==="HTML"?t?t.ownerDocument.documentElement:document.documentElement:["TH","TD","TABLE"].indexOf(n.nodeName)!==-1&&Go(n,"position")==="static"?Kl(n):n}function zz(t){var e=t.nodeName;return e==="BODY"?!1:e==="HTML"||Kl(t.firstElementChild)===t}function Bw(t){return t.parentNode!==null?Bw(t.parentNode):t}function Em(t,e){if(!t||!t.nodeType||!e||!e.nodeType)return document.documentElement;var n=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING,s=n?t:e,a=n?e:t,r=document.createRange();r.setStart(s,0),r.setEnd(a,0);var i=r.commonAncestorContainer;if(t!==i&&e!==i||s.contains(a))return zz(i)?i:Kl(i);var o=Bw(t);return o.host?Em(o.host,e):Em(t,Bw(e).host)}function ql(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"top",n=e==="top"?"scrollTop":"scrollLeft",s=t.nodeName;if(s==="BODY"||s==="HTML"){var a=t.ownerDocument.documentElement,r=t.ownerDocument.scrollingElement||a;return r[n]}return t[n]}function Mz(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=ql(e,"top"),a=ql(e,"left"),r=n?-1:1;return t.top+=s*r,t.bottom+=s*r,t.left+=a*r,t.right+=a*r,t}function TN(t,e){var n=e==="x"?"Left":"Top",s=n==="Left"?"Right":"Bottom";return parseFloat(t["border"+n+"Width"])+parseFloat(t["border"+s+"Width"])}function $N(t,e,n,s){return Math.max(e["offset"+t],e["scroll"+t],n["client"+t],n["offset"+t],n["scroll"+t],gu(10)?parseInt(n["offset"+t])+parseInt(s["margin"+(t==="Height"?"Top":"Left")])+parseInt(s["margin"+(t==="Height"?"Bottom":"Right")]):0)}function hE(t){var e=t.body,n=t.documentElement,s=gu(10)&&getComputedStyle(n);return{height:$N("Height",e,n,s),width:$N("Width",e,n,s)}}var Vz=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Wz=function(){function t(e,n){for(var s=0;s<n.length;s++){var a=n[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,n,s){return n&&t(e.prototype,n),s&&t(e,s),e}}(),Jl=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},zs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t};function gi(t){return zs({},t,{right:t.left+t.width,bottom:t.top+t.height})}function zw(t){var e={};try{if(gu(10)){e=t.getBoundingClientRect();var n=ql(t,"top"),s=ql(t,"left");e.top+=n,e.left+=s,e.bottom+=n,e.right+=s}else e=t.getBoundingClientRect()}catch{}var a={left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top},r=t.nodeName==="HTML"?hE(t.ownerDocument):{},i=r.width||t.clientWidth||a.width,o=r.height||t.clientHeight||a.height,l=t.offsetWidth-i,u=t.offsetHeight-o;if(l||u){var c=Go(t);l-=TN(c,"x"),u-=TN(c,"y"),a.width-=l,a.height-=u}return gi(a)}function Vx(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=gu(10),a=e.nodeName==="HTML",r=zw(t),i=zw(e),o=dp(t),l=Go(e),u=parseFloat(l.borderTopWidth),c=parseFloat(l.borderLeftWidth);n&&a&&(i.top=Math.max(i.top,0),i.left=Math.max(i.left,0));var d=gi({top:r.top-i.top-u,left:r.left-i.left-c,width:r.width,height:r.height});if(d.marginTop=0,d.marginLeft=0,!s&&a){var p=parseFloat(l.marginTop),h=parseFloat(l.marginLeft);d.top-=u-p,d.bottom-=u-p,d.left-=c-h,d.right-=c-h,d.marginTop=p,d.marginLeft=h}return(s&&!n?e.contains(o):e===o&&o.nodeName!=="BODY")&&(d=Mz(d,e)),d}function Uz(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=t.ownerDocument.documentElement,s=Vx(t,n),a=Math.max(n.clientWidth,window.innerWidth||0),r=Math.max(n.clientHeight,window.innerHeight||0),i=e?0:ql(n),o=e?0:ql(n,"left"),l={top:i-s.top+s.marginTop,left:o-s.left+s.marginLeft,width:a,height:r};return gi(l)}function fE(t){var e=t.nodeName;if(e==="BODY"||e==="HTML")return!1;if(Go(t,"position")==="fixed")return!0;var n=Mx(t);return n?fE(n):!1}function mE(t){if(!t||!t.parentElement||gu())return document.documentElement;for(var e=t.parentElement;e&&Go(e,"transform")==="none";)e=e.parentElement;return e||document.documentElement}function Wx(t,e,n,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,r={top:0,left:0},i=a?mE(t):Em(t,pE(e));if(s==="viewport")r=Uz(i,a);else{var o=void 0;s==="scrollParent"?(o=dp(Mx(e)),o.nodeName==="BODY"&&(o=t.ownerDocument.documentElement)):s==="window"?o=t.ownerDocument.documentElement:o=s;var l=Vx(o,i,a);if(o.nodeName==="HTML"&&!fE(i)){var u=hE(t.ownerDocument),c=u.height,d=u.width;r.top+=l.top-l.marginTop,r.bottom=c+l.top,r.left+=l.left-l.marginLeft,r.right=d+l.left}else r=l}n=n||0;var p=typeof n=="number";return r.left+=p?n:n.left||0,r.top+=p?n:n.top||0,r.right-=p?n:n.right||0,r.bottom-=p?n:n.bottom||0,r}function Gz(t){var e=t.width,n=t.height;return e*n}function gE(t,e,n,s,a){var r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0;if(t.indexOf("auto")===-1)return t;var i=Wx(n,s,r,a),o={top:{width:i.width,height:e.top-i.top},right:{width:i.right-e.right,height:i.height},bottom:{width:i.width,height:i.bottom-e.bottom},left:{width:e.left-i.left,height:i.height}},l=Object.keys(o).map(function(p){return zs({key:p},o[p],{area:Gz(o[p])})}).sort(function(p,h){return h.area-p.area}),u=l.filter(function(p){var h=p.width,f=p.height;return h>=n.clientWidth&&f>=n.clientHeight}),c=u.length>0?u[0].key:l[0].key,d=t.split("-")[1];return c+(d?"-"+d:"")}function yE(t,e,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,a=s?mE(e):Em(e,pE(n));return Vx(n,a,s)}function bE(t){var e=t.ownerDocument.defaultView,n=e.getComputedStyle(t),s=parseFloat(n.marginTop||0)+parseFloat(n.marginBottom||0),a=parseFloat(n.marginLeft||0)+parseFloat(n.marginRight||0),r={width:t.offsetWidth+a,height:t.offsetHeight+s};return r}function Rm(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(n){return e[n]})}function wE(t,e,n){n=n.split("-")[0];var s=bE(t),a={width:s.width,height:s.height},r=["right","left"].indexOf(n)!==-1,i=r?"top":"left",o=r?"left":"top",l=r?"height":"width",u=r?"width":"height";return a[i]=e[i]+e[l]/2-s[l]/2,n===o?a[o]=e[o]-s[u]:a[o]=e[Rm(o)],a}function pp(t,e){return Array.prototype.find?t.find(e):t.filter(e)[0]}function Hz(t,e,n){if(Array.prototype.findIndex)return t.findIndex(function(a){return a[e]===n});var s=pp(t,function(a){return a[e]===n});return t.indexOf(s)}function kE(t,e,n){var s=n===void 0?t:t.slice(0,Hz(t,"name",n));return s.forEach(function(a){a.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var r=a.function||a.fn;a.enabled&&dE(r)&&(e.offsets.popper=gi(e.offsets.popper),e.offsets.reference=gi(e.offsets.reference),e=r(e,a))}),e}function Kz(){if(!this.state.isDestroyed){var t={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};t.offsets.reference=yE(this.state,this.popper,this.reference,this.options.positionFixed),t.placement=gE(this.options.placement,t.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),t.originalPlacement=t.placement,t.positionFixed=this.options.positionFixed,t.offsets.popper=wE(this.popper,t.offsets.reference,t.placement),t.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",t=kE(this.modifiers,t),this.state.isCreated?this.options.onUpdate(t):(this.state.isCreated=!0,this.options.onCreate(t))}}function xE(t,e){return t.some(function(n){var s=n.name,a=n.enabled;return a&&s===e})}function Ux(t){for(var e=[!1,"ms","Webkit","Moz","O"],n=t.charAt(0).toUpperCase()+t.slice(1),s=0;s<e.length;s++){var a=e[s],r=a?""+a+n:t;if(typeof document.body.style[r]<"u")return r}return null}function qz(){return this.state.isDestroyed=!0,xE(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[Ux("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function vE(t){var e=t.ownerDocument;return e?e.defaultView:window}function SE(t,e,n,s){var a=t.nodeName==="BODY",r=a?t.ownerDocument.defaultView:t;r.addEventListener(e,n,{passive:!0}),a||SE(dp(r.parentNode),e,n,s),s.push(r)}function Jz(t,e,n,s){n.updateBound=s,vE(t).addEventListener("resize",n.updateBound,{passive:!0});var a=dp(t);return SE(a,"scroll",n.updateBound,n.scrollParents),n.scrollElement=a,n.eventsEnabled=!0,n}function Xz(){this.state.eventsEnabled||(this.state=Jz(this.reference,this.options,this.state,this.scheduleUpdate))}function Yz(t,e){return vE(t).removeEventListener("resize",e.updateBound),e.scrollParents.forEach(function(n){n.removeEventListener("scroll",e.updateBound)}),e.updateBound=null,e.scrollParents=[],e.scrollElement=null,e.eventsEnabled=!1,e}function Qz(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=Yz(this.reference,this.state))}function Gx(t){return t!==""&&!isNaN(parseFloat(t))&&isFinite(t)}function Mw(t,e){Object.keys(e).forEach(function(n){var s="";["width","height","top","right","bottom","left"].indexOf(n)!==-1&&Gx(e[n])&&(s="px"),t.style[n]=e[n]+s})}function Zz(t,e){Object.keys(e).forEach(function(n){var s=e[n];s!==!1?t.setAttribute(n,e[n]):t.removeAttribute(n)})}function eM(t){return Mw(t.instance.popper,t.styles),Zz(t.instance.popper,t.attributes),t.arrowElement&&Object.keys(t.arrowStyles).length&&Mw(t.arrowElement,t.arrowStyles),t}function tM(t,e,n,s,a){var r=yE(a,e,t,n.positionFixed),i=gE(n.placement,r,e,t,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return e.setAttribute("x-placement",i),Mw(e,{position:n.positionFixed?"fixed":"absolute"}),n}function nM(t,e){var n=t.offsets,s=n.popper,a=n.reference,r=Math.round,i=Math.floor,o=function(g){return g},l=r(a.width),u=r(s.width),c=["left","right"].indexOf(t.placement)!==-1,d=t.placement.indexOf("-")!==-1,p=l%2===u%2,h=l%2===1&&u%2===1,f=e?c||d||p?r:i:o,m=e?r:o;return{left:f(h&&!d&&e?s.left-1:s.left),top:m(s.top),bottom:m(s.bottom),right:f(s.right)}}var sM=cp&&/Firefox/i.test(navigator.userAgent);function aM(t,e){var n=e.x,s=e.y,a=t.offsets.popper,r=pp(t.instance.modifiers,function(w){return w.name==="applyStyle"}).gpuAcceleration;r!==void 0&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var i=r!==void 0?r:e.gpuAcceleration,o=Kl(t.instance.popper),l=zw(o),u={position:a.position},c=nM(t,window.devicePixelRatio<2||!sM),d=n==="bottom"?"top":"bottom",p=s==="right"?"left":"right",h=Ux("transform"),f=void 0,m=void 0;if(d==="bottom"?o.nodeName==="HTML"?m=-o.clientHeight+c.bottom:m=-l.height+c.bottom:m=c.top,p==="right"?o.nodeName==="HTML"?f=-o.clientWidth+c.right:f=-l.width+c.right:f=c.left,i&&h)u[h]="translate3d("+f+"px, "+m+"px, 0)",u[d]=0,u[p]=0,u.willChange="transform";else{var y=d==="bottom"?-1:1,g=p==="right"?-1:1;u[d]=m*y,u[p]=f*g,u.willChange=d+", "+p}var b={"x-placement":t.placement};return t.attributes=zs({},b,t.attributes),t.styles=zs({},u,t.styles),t.arrowStyles=zs({},t.offsets.arrow,t.arrowStyles),t}function NE(t,e,n){var s=pp(t,function(o){var l=o.name;return l===e}),a=!!s&&t.some(function(o){return o.name===n&&o.enabled&&o.order<s.order});if(!a){var r="`"+e+"`",i="`"+n+"`";console.warn(i+" modifier is required by "+r+" modifier in order to work, be sure to include it before "+r+"!")}return a}function rM(t,e){var n;if(!NE(t.instance.modifiers,"arrow","keepTogether"))return t;var s=e.element;if(typeof s=="string"){if(s=t.instance.popper.querySelector(s),!s)return t}else if(!t.instance.popper.contains(s))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),t;var a=t.placement.split("-")[0],r=t.offsets,i=r.popper,o=r.reference,l=["left","right"].indexOf(a)!==-1,u=l?"height":"width",c=l?"Top":"Left",d=c.toLowerCase(),p=l?"left":"top",h=l?"bottom":"right",f=bE(s)[u];o[h]-f<i[d]&&(t.offsets.popper[d]-=i[d]-(o[h]-f)),o[d]+f>i[h]&&(t.offsets.popper[d]+=o[d]+f-i[h]),t.offsets.popper=gi(t.offsets.popper);var m=o[d]+o[u]/2-f/2,y=Go(t.instance.popper),g=parseFloat(y["margin"+c]),b=parseFloat(y["border"+c+"Width"]),w=m-t.offsets.popper[d]-g-b;return w=Math.max(Math.min(i[u]-f,w),0),t.arrowElement=s,t.offsets.arrow=(n={},Jl(n,d,Math.round(w)),Jl(n,p,""),n),t}function iM(t){return t==="end"?"start":t==="start"?"end":t}var CE=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],kb=CE.slice(3);function EN(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=kb.indexOf(t),s=kb.slice(n+1).concat(kb.slice(0,n));return e?s.reverse():s}var xb={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"};function oM(t,e){if(xE(t.instance.modifiers,"inner")||t.flipped&&t.placement===t.originalPlacement)return t;var n=Wx(t.instance.popper,t.instance.reference,e.padding,e.boundariesElement,t.positionFixed),s=t.placement.split("-")[0],a=Rm(s),r=t.placement.split("-")[1]||"",i=[];switch(e.behavior){case xb.FLIP:i=[s,a];break;case xb.CLOCKWISE:i=EN(s);break;case xb.COUNTERCLOCKWISE:i=EN(s,!0);break;default:i=e.behavior}return i.forEach(function(o,l){if(s!==o||i.length===l+1)return t;s=t.placement.split("-")[0],a=Rm(s);var u=t.offsets.popper,c=t.offsets.reference,d=Math.floor,p=s==="left"&&d(u.right)>d(c.left)||s==="right"&&d(u.left)<d(c.right)||s==="top"&&d(u.bottom)>d(c.top)||s==="bottom"&&d(u.top)<d(c.bottom),h=d(u.left)<d(n.left),f=d(u.right)>d(n.right),m=d(u.top)<d(n.top),y=d(u.bottom)>d(n.bottom),g=s==="left"&&h||s==="right"&&f||s==="top"&&m||s==="bottom"&&y,b=["top","bottom"].indexOf(s)!==-1,w=!!e.flipVariations&&(b&&r==="start"&&h||b&&r==="end"&&f||!b&&r==="start"&&m||!b&&r==="end"&&y),k=!!e.flipVariationsByContent&&(b&&r==="start"&&f||b&&r==="end"&&h||!b&&r==="start"&&y||!b&&r==="end"&&m),x=w||k;(p||g||x)&&(t.flipped=!0,(p||g)&&(s=i[l+1]),x&&(r=iM(r)),t.placement=s+(r?"-"+r:""),t.offsets.popper=zs({},t.offsets.popper,wE(t.instance.popper,t.offsets.reference,t.placement)),t=kE(t.instance.modifiers,t,"flip"))}),t}function lM(t){var e=t.offsets,n=e.popper,s=e.reference,a=t.placement.split("-")[0],r=Math.floor,i=["top","bottom"].indexOf(a)!==-1,o=i?"right":"bottom",l=i?"left":"top",u=i?"width":"height";return n[o]<r(s[l])&&(t.offsets.popper[l]=r(s[l])-n[u]),n[l]>r(s[o])&&(t.offsets.popper[l]=r(s[o])),t}function uM(t,e,n,s){var a=t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),r=+a[1],i=a[2];if(!r)return t;if(i.indexOf("%")===0){var o=void 0;switch(i){case"%p":o=n;break;case"%":case"%r":default:o=s}var l=gi(o);return l[e]/100*r}else if(i==="vh"||i==="vw"){var u=void 0;return i==="vh"?u=Math.max(document.documentElement.clientHeight,window.innerHeight||0):u=Math.max(document.documentElement.clientWidth,window.innerWidth||0),u/100*r}else return r}function cM(t,e,n,s){var a=[0,0],r=["right","left"].indexOf(s)!==-1,i=t.split(/(\+|\-)/).map(function(c){return c.trim()}),o=i.indexOf(pp(i,function(c){return c.search(/,|\s/)!==-1}));i[o]&&i[o].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,u=o!==-1?[i.slice(0,o).concat([i[o].split(l)[0]]),[i[o].split(l)[1]].concat(i.slice(o+1))]:[i];return u=u.map(function(c,d){var p=(d===1?!r:r)?"height":"width",h=!1;return c.reduce(function(f,m){return f[f.length-1]===""&&["+","-"].indexOf(m)!==-1?(f[f.length-1]=m,h=!0,f):h?(f[f.length-1]+=m,h=!1,f):f.concat(m)},[]).map(function(f){return uM(f,p,e,n)})}),u.forEach(function(c,d){c.forEach(function(p,h){Gx(p)&&(a[d]+=p*(c[h-1]==="-"?-1:1))})}),a}function dM(t,e){var n=e.offset,s=t.placement,a=t.offsets,r=a.popper,i=a.reference,o=s.split("-")[0],l=void 0;return Gx(+n)?l=[+n,0]:l=cM(n,r,i,o),o==="left"?(r.top+=l[0],r.left-=l[1]):o==="right"?(r.top+=l[0],r.left+=l[1]):o==="top"?(r.left+=l[0],r.top-=l[1]):o==="bottom"&&(r.left+=l[0],r.top+=l[1]),t.popper=r,t}function pM(t,e){var n=e.boundariesElement||Kl(t.instance.popper);t.instance.reference===n&&(n=Kl(n));var s=Ux("transform"),a=t.instance.popper.style,r=a.top,i=a.left,o=a[s];a.top="",a.left="",a[s]="";var l=Wx(t.instance.popper,t.instance.reference,e.padding,n,t.positionFixed);a.top=r,a.left=i,a[s]=o,e.boundaries=l;var u=e.priority,c=t.offsets.popper,d={primary:function(h){var f=c[h];return c[h]<l[h]&&!e.escapeWithReference&&(f=Math.max(c[h],l[h])),Jl({},h,f)},secondary:function(h){var f=h==="right"?"left":"top",m=c[f];return c[h]>l[h]&&!e.escapeWithReference&&(m=Math.min(c[f],l[h]-(h==="right"?c.width:c.height))),Jl({},f,m)}};return u.forEach(function(p){var h=["left","top"].indexOf(p)!==-1?"primary":"secondary";c=zs({},c,d[h](p))}),t.offsets.popper=c,t}function hM(t){var e=t.placement,n=e.split("-")[0],s=e.split("-")[1];if(s){var a=t.offsets,r=a.reference,i=a.popper,o=["bottom","top"].indexOf(n)!==-1,l=o?"left":"top",u=o?"width":"height",c={start:Jl({},l,r[l]),end:Jl({},l,r[l]+r[u]-i[u])};t.offsets.popper=zs({},i,c[s])}return t}function fM(t){if(!NE(t.instance.modifiers,"hide","preventOverflow"))return t;var e=t.offsets.reference,n=pp(t.instance.modifiers,function(s){return s.name==="preventOverflow"}).boundaries;if(e.bottom<n.top||e.left>n.right||e.top>n.bottom||e.right<n.left){if(t.hide===!0)return t;t.hide=!0,t.attributes["x-out-of-boundaries"]=""}else{if(t.hide===!1)return t;t.hide=!1,t.attributes["x-out-of-boundaries"]=!1}return t}function mM(t){var e=t.placement,n=e.split("-")[0],s=t.offsets,a=s.popper,r=s.reference,i=["left","right"].indexOf(n)!==-1,o=["top","left"].indexOf(n)===-1;return a[i?"left":"top"]=r[n]-(o?a[i?"width":"height"]:0),t.placement=Rm(e),t.offsets.popper=gi(a),t}var gM={shift:{order:100,enabled:!0,fn:hM},offset:{order:200,enabled:!0,fn:dM,offset:0},preventOverflow:{order:300,enabled:!0,fn:pM,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:lM},arrow:{order:500,enabled:!0,fn:rM,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:oM,behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:mM},hide:{order:800,enabled:!0,fn:fM},computeStyle:{order:850,enabled:!0,fn:aM,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:eM,onLoad:tM,gpuAcceleration:void 0}},yM={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:gM},Fd=function(){function t(e,n){var s=this,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Vz(this,t),this.scheduleUpdate=function(){return requestAnimationFrame(s.update)},this.update=Bz(this.update.bind(this)),this.options=zs({},t.Defaults,a),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=e&&e.jquery?e[0]:e,this.popper=n&&n.jquery?n[0]:n,this.options.modifiers={},Object.keys(zs({},t.Defaults.modifiers,a.modifiers)).forEach(function(i){s.options.modifiers[i]=zs({},t.Defaults.modifiers[i]||{},a.modifiers?a.modifiers[i]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(i){return zs({name:i},s.options.modifiers[i])}).sort(function(i,o){return i.order-o.order}),this.modifiers.forEach(function(i){i.enabled&&dE(i.onLoad)&&i.onLoad(s.reference,s.popper,s.options,i,s.state)}),this.update();var r=this.options.eventsEnabled;r&&this.enableEventListeners(),this.state.eventsEnabled=r}return Wz(t,[{key:"update",value:function(){return Kz.call(this)}},{key:"destroy",value:function(){return qz.call(this)}},{key:"enableEventListeners",value:function(){return Xz.call(this)}},{key:"disableEventListeners",value:function(){return Qz.call(this)}}]),t}();Fd.Utils=(typeof window<"u"?window:global).PopperUtils;Fd.placements=CE;Fd.Defaults=yM;var bM=["innerHTML","ownerDocument","style","attributes","nodeValue"],wM=["Array","ArrayBuffer","AsyncFunction","AsyncGenerator","AsyncGeneratorFunction","Date","Error","Function","Generator","GeneratorFunction","HTMLElement","Map","Object","Promise","RegExp","Set","WeakMap","WeakSet"],kM=["bigint","boolean","null","number","string","symbol","undefined"];function $g(t){var e=Object.prototype.toString.call(t).slice(8,-1);if(/HTML\w+Element/.test(e))return"HTMLElement";if(xM(e))return e}function Na(t){return function(e){return $g(e)===t}}function xM(t){return wM.includes(t)}function yu(t){return function(e){return typeof e===t}}function vM(t){return kM.includes(t)}function Q(t){if(t===null)return"null";switch(typeof t){case"bigint":return"bigint";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";case"undefined":return"undefined"}if(Q.array(t))return"Array";if(Q.plainFunction(t))return"Function";var e=$g(t);return e||"Object"}Q.array=Array.isArray;Q.arrayOf=function(t,e){return!Q.array(t)&&!Q.function(e)?!1:t.every(function(n){return e(n)})};Q.asyncGeneratorFunction=function(t){return $g(t)==="AsyncGeneratorFunction"};Q.asyncFunction=Na("AsyncFunction");Q.bigint=yu("bigint");Q.boolean=function(t){return t===!0||t===!1};Q.date=Na("Date");Q.defined=function(t){return!Q.undefined(t)};Q.domElement=function(t){return Q.object(t)&&!Q.plainObject(t)&&t.nodeType===1&&Q.string(t.nodeName)&&bM.every(function(e){return e in t})};Q.empty=function(t){return Q.string(t)&&t.length===0||Q.array(t)&&t.length===0||Q.object(t)&&!Q.map(t)&&!Q.set(t)&&Object.keys(t).length===0||Q.set(t)&&t.size===0||Q.map(t)&&t.size===0};Q.error=Na("Error");Q.function=yu("function");Q.generator=function(t){return Q.iterable(t)&&Q.function(t.next)&&Q.function(t.throw)};Q.generatorFunction=Na("GeneratorFunction");Q.instanceOf=function(t,e){return!t||!e?!1:Object.getPrototypeOf(t)===e.prototype};Q.iterable=function(t){return!Q.nullOrUndefined(t)&&Q.function(t[Symbol.iterator])};Q.map=Na("Map");Q.nan=function(t){return Number.isNaN(t)};Q.null=function(t){return t===null};Q.nullOrUndefined=function(t){return Q.null(t)||Q.undefined(t)};Q.number=function(t){return yu("number")(t)&&!Q.nan(t)};Q.numericString=function(t){return Q.string(t)&&t.length>0&&!Number.isNaN(Number(t))};Q.object=function(t){return!Q.nullOrUndefined(t)&&(Q.function(t)||typeof t=="object")};Q.oneOf=function(t,e){return Q.array(t)?t.indexOf(e)>-1:!1};Q.plainFunction=Na("Function");Q.plainObject=function(t){if($g(t)!=="Object")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.getPrototypeOf({})};Q.primitive=function(t){return Q.null(t)||vM(typeof t)};Q.promise=Na("Promise");Q.propertyOf=function(t,e,n){if(!Q.object(t)||!e)return!1;var s=t[e];return Q.function(n)?n(s):Q.defined(s)};Q.regexp=Na("RegExp");Q.set=Na("Set");Q.string=yu("string");Q.symbol=yu("symbol");Q.undefined=yu("undefined");Q.weakMap=Na("WeakMap");Q.weakSet=Na("WeakSet");function IE(t){return function(e){return typeof e===t}}var SM=IE("function"),NM=function(t){return t===null},RN=function(t){return Object.prototype.toString.call(t).slice(8,-1)==="RegExp"},AN=function(t){return!CM(t)&&!NM(t)&&(SM(t)||typeof t=="object")},CM=IE("undefined"),Vw=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],s=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function IM(t,e){var n=t.length;if(n!==e.length)return!1;for(var s=n;s--!==0;)if(!is(t[s],e[s]))return!1;return!0}function TM(t,e){if(t.byteLength!==e.byteLength)return!1;for(var n=new DataView(t.buffer),s=new DataView(e.buffer),a=t.byteLength;a--;)if(n.getUint8(a)!==s.getUint8(a))return!1;return!0}function $M(t,e){var n,s,a,r;if(t.size!==e.size)return!1;try{for(var i=Vw(t.entries()),o=i.next();!o.done;o=i.next()){var l=o.value;if(!e.has(l[0]))return!1}}catch(d){n={error:d}}finally{try{o&&!o.done&&(s=i.return)&&s.call(i)}finally{if(n)throw n.error}}try{for(var u=Vw(t.entries()),c=u.next();!c.done;c=u.next()){var l=c.value;if(!is(l[1],e.get(l[0])))return!1}}catch(d){a={error:d}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(a)throw a.error}}return!0}function EM(t,e){var n,s;if(t.size!==e.size)return!1;try{for(var a=Vw(t.entries()),r=a.next();!r.done;r=a.next()){var i=r.value;if(!e.has(i[0]))return!1}}catch(o){n={error:o}}finally{try{r&&!r.done&&(s=a.return)&&s.call(a)}finally{if(n)throw n.error}}return!0}function is(t,e){if(t===e)return!0;if(t&&AN(t)&&e&&AN(e)){if(t.constructor!==e.constructor)return!1;if(Array.isArray(t)&&Array.isArray(e))return IM(t,e);if(t instanceof Map&&e instanceof Map)return $M(t,e);if(t instanceof Set&&e instanceof Set)return EM(t,e);if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return TM(t,e);if(RN(t)&&RN(e))return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(var a=n.length;a--!==0;)if(!Object.prototype.hasOwnProperty.call(e,n[a]))return!1;for(var a=n.length;a--!==0;){var r=n[a];if(!(r==="_owner"&&t.$$typeof)&&!is(t[r],e[r]))return!1}return!0}return Number.isNaN(t)&&Number.isNaN(e)?!0:t===e}function RM(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.every(function(n){return Q.string(n)||Q.array(n)||Q.plainObject(n)})}function AM(t,e,n){return TE(t,e)?[t,e].every(Q.array)?!t.some(FN(n))&&e.some(FN(n)):[t,e].every(Q.plainObject)?!Object.entries(t).some(_N(n))&&Object.entries(e).some(_N(n)):e===n:!1}function ON(t,e,n){var s=n.actual,a=n.key,r=n.previous,i=n.type,o=La(t,a),l=La(e,a),u=[o,l].every(Q.number)&&(i==="increased"?o<l:o>l);return Q.undefined(s)||(u=u&&l===s),Q.undefined(r)||(u=u&&o===r),u}function DN(t,e,n){var s=n.key,a=n.type,r=n.value,i=La(t,s),o=La(e,s),l=a==="added"?i:o,u=a==="added"?o:i;if(!Q.nullOrUndefined(r)){if(Q.defined(l)){if(Q.array(l)||Q.plainObject(l))return AM(l,u,r)}else return is(u,r);return!1}return[i,o].every(Q.array)?!u.every(Hx(l)):[i,o].every(Q.plainObject)?OM(Object.keys(l),Object.keys(u)):![i,o].every(function(c){return Q.primitive(c)&&Q.defined(c)})&&(a==="added"?!Q.defined(i)&&Q.defined(o):Q.defined(i)&&!Q.defined(o))}function jN(t,e,n){var s=n===void 0?{}:n,a=s.key,r=La(t,a),i=La(e,a);if(!TE(r,i))throw new TypeError("Inputs have different types");if(!RM(r,i))throw new TypeError("Inputs don't have length");return[r,i].every(Q.plainObject)&&(r=Object.keys(r),i=Object.keys(i)),[r,i]}function _N(t){return function(e){var n=e[0],s=e[1];return Q.array(t)?is(t,s)||t.some(function(a){return is(a,s)||Q.array(s)&&Hx(s)(a)}):Q.plainObject(t)&&t[n]?!!t[n]&&is(t[n],s):is(t,s)}}function OM(t,e){return e.some(function(n){return!t.includes(n)})}function FN(t){return function(e){return Q.array(t)?t.some(function(n){return is(n,e)||Q.array(e)&&Hx(e)(n)}):is(t,e)}}function Bc(t,e){return Q.array(t)?t.some(function(n){return is(n,e)}):is(t,e)}function Hx(t){return function(e){return t.some(function(n){return is(n,e)})}}function TE(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.every(Q.array)||t.every(Q.number)||t.every(Q.plainObject)||t.every(Q.string)}function La(t,e){if(Q.plainObject(t)||Q.array(t)){if(Q.string(e)){var n=e.split(".");return n.reduce(function(s,a){return s&&s[a]},t)}return Q.number(e)?t[e]:t}return t}function DM(t,e){if([t,e].some(Q.nullOrUndefined))throw new Error("Missing required parameters");if(![t,e].every(function(d){return Q.plainObject(d)||Q.array(d)}))throw new Error("Expected plain objects or array");var n=function(d,p){try{return DN(t,e,{key:d,type:"added",value:p})}catch{return!1}},s=function(d,p,h){try{var f=La(t,d),m=La(e,d),y=Q.defined(p),g=Q.defined(h);if(y||g){var b=g?Bc(h,f):!Bc(p,f),w=Bc(p,m);return b&&w}return[f,m].every(Q.array)||[f,m].every(Q.plainObject)?!is(f,m):f!==m}catch{return!1}},a=function(d,p,h){if(!Q.defined(d))return!1;try{var f=La(t,d),m=La(e,d),y=Q.defined(h);return Bc(p,f)&&(y?Bc(h,m):!y)}catch{return!1}},r=function(d,p){return Q.defined(d)?s(d,p):!1},i=function(d,p,h){if(!Q.defined(d))return!1;try{return ON(t,e,{key:d,actual:p,previous:h,type:"decreased"})}catch{return!1}},o=function(d){try{var p=jN(t,e,{key:d}),h=p[0],f=p[1];return!!h.length&&!f.length}catch{return!1}},l=function(d){try{var p=jN(t,e,{key:d}),h=p[0],f=p[1];return!h.length&&!!f.length}catch{return!1}},u=function(d,p,h){if(!Q.defined(d))return!1;try{return ON(t,e,{key:d,actual:p,previous:h,type:"increased"})}catch{return!1}},c=function(d,p){try{return DN(t,e,{key:d,type:"removed",value:p})}catch{return!1}};return{added:n,changed:s,changedFrom:a,changedTo:r,decreased:i,emptied:o,filled:l,increased:u,removed:c}}function PN(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,s)}return n}function bt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?PN(Object(n),!0).forEach(function(s){Tn(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):PN(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function hp(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jM(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,EE(s.key),s)}}function fp(t,e,n){return e&&jM(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tn(t,e,n){return e=EE(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mp(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ww(t,e)}function Am(t){return Am=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Am(t)}function Ww(t,e){return Ww=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},Ww(t,e)}function _M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function FM(t,e){if(t==null)return{};var n={},s=Object.keys(t),a,r;for(r=0;r<s.length;r++)a=s[r],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function $E(t,e){if(t==null)return{};var n=FM(t,e),s,a;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)s=r[a],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function ar(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PM(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ar(t)}function gp(t){var e=_M();return function(){var s=Am(t),a;if(e){var r=Am(this).constructor;a=Reflect.construct(s,arguments,r)}else a=s.apply(this,arguments);return PM(this,a)}}function LM(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EE(t){var e=LM(t,"string");return typeof e=="symbol"?e:String(e)}var BM={flip:{padding:20},preventOverflow:{padding:10}},zM="The typeValidator argument must be a function with the signature function(props, propName, componentName).",MM="The error message is optional, but must be a string if provided.";function VM(t,e,n,s){return typeof t=="boolean"?t:typeof t=="function"?t(e,n,s):t?!!t:!1}function WM(t,e){return Object.hasOwnProperty.call(t,e)}function UM(t,e,n,s){return new Error("Required ".concat(t[e]," `").concat(e,"` was not specified in `").concat(n,"`."))}function GM(t,e){if(typeof t!="function")throw new TypeError(zM);if(e&&typeof e!="string")throw new TypeError(MM)}function LN(t,e,n){return GM(t,n),function(s,a,r){for(var i=arguments.length,o=new Array(i>3?i-3:0),l=3;l<i;l++)o[l-3]=arguments[l];return VM(e,s,a,r)?WM(s,a)?t.apply(void 0,[s,a,r].concat(o)):UM(s,a,r):t.apply(void 0,[s,a,r].concat(o))}}var Ge={INIT:"init",IDLE:"idle",OPENING:"opening",OPEN:"open",CLOSING:"closing",ERROR:"error"},zc=Xf.createPortal!==void 0;function Aa(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function vb(){return"ontouchstart"in window&&/Mobi/.test(navigator.userAgent)}function vf(t){var e=t.title,n=t.data,s=t.warn,a=s===void 0?!1:s,r=t.debug,i=r===void 0?!1:r,o=a?console.warn||console.error:console.log;i&&e&&n&&(console.groupCollapsed("%creact-floater: ".concat(e),"color: #9b00ff; font-weight: bold; font-size: 12px;"),Array.isArray(n)?n.forEach(function(l){Q.plainObject(l)&&l.key?o.apply(console,[l.key,l.value]):o.apply(console,[l])}):o.apply(console,[n]),console.groupEnd())}function HM(t,e,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;t.addEventListener(e,n,s)}function KM(t,e,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;t.removeEventListener(e,n,s)}function qM(t,e,n){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a;a=function(i){n(i),KM(t,e,a)},HM(t,e,a,s)}function BN(){}var RE=function(t){mp(n,t);var e=gp(n);function n(){return hp(this,n),e.apply(this,arguments)}return fp(n,[{key:"componentDidMount",value:function(){Aa()&&(this.node||this.appendNode(),zc||this.renderPortal())}},{key:"componentDidUpdate",value:function(){Aa()&&(zc||this.renderPortal())}},{key:"componentWillUnmount",value:function(){!Aa()||!this.node||(zc||Xf.unmountComponentAtNode(this.node),this.node&&this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=void 0))}},{key:"appendNode",value:function(){var a=this.props,r=a.id,i=a.zIndex;this.node||(this.node=document.createElement("div"),r&&(this.node.id=r),i&&(this.node.style.zIndex=i),document.body.appendChild(this.node))}},{key:"renderPortal",value:function(){if(!Aa())return null;var a=this.props,r=a.children,i=a.setRef;if(this.node||this.appendNode(),zc)return Xf.createPortal(r,this.node);var o=Xf.unstable_renderSubtreeIntoContainer(this,r.length>1?Ee.createElement("div",null,r):r[0],this.node);return i(o),null}},{key:"renderReact16",value:function(){var a=this.props,r=a.hasChildren,i=a.placement,o=a.target;return r?this.renderPortal():o||i==="center"?this.renderPortal():null}},{key:"render",value:function(){return zc?this.renderReact16():null}}]),n}(Ee.Component);Tn(RE,"propTypes",{children:ie.oneOfType([ie.element,ie.array]),hasChildren:ie.bool,id:ie.oneOfType([ie.string,ie.number]),placement:ie.string,setRef:ie.func.isRequired,target:ie.oneOfType([ie.object,ie.string]),zIndex:ie.number});var AE=function(t){mp(n,t);var e=gp(n);function n(){return hp(this,n),e.apply(this,arguments)}return fp(n,[{key:"parentStyle",get:function(){var a=this.props,r=a.placement,i=a.styles,o=i.arrow.length,l={pointerEvents:"none",position:"absolute",width:"100%"};return r.startsWith("top")?(l.bottom=0,l.left=0,l.right=0,l.height=o):r.startsWith("bottom")?(l.left=0,l.right=0,l.top=0,l.height=o):r.startsWith("left")?(l.right=0,l.top=0,l.bottom=0):r.startsWith("right")&&(l.left=0,l.top=0),l}},{key:"render",value:function(){var a=this.props,r=a.placement,i=a.setArrowRef,o=a.styles,l=o.arrow,u=l.color,c=l.display,d=l.length,p=l.margin,h=l.position,f=l.spread,m={display:c,position:h},y,g=f,b=d;return r.startsWith("top")?(y="0,0 ".concat(g/2,",").concat(b," ").concat(g,",0"),m.bottom=0,m.marginLeft=p,m.marginRight=p):r.startsWith("bottom")?(y="".concat(g,",").concat(b," ").concat(g/2,",0 0,").concat(b),m.top=0,m.marginLeft=p,m.marginRight=p):r.startsWith("left")?(b=f,g=d,y="0,0 ".concat(g,",").concat(b/2," 0,").concat(b),m.right=0,m.marginTop=p,m.marginBottom=p):r.startsWith("right")&&(b=f,g=d,y="".concat(g,",").concat(b," ").concat(g,",0 0,").concat(b/2),m.left=0,m.marginTop=p,m.marginBottom=p),Ee.createElement("div",{className:"__floater__arrow",style:this.parentStyle},Ee.createElement("span",{ref:i,style:m},Ee.createElement("svg",{width:g,height:b,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ee.createElement("polygon",{points:y,fill:u}))))}}]),n}(Ee.Component);Tn(AE,"propTypes",{placement:ie.string.isRequired,setArrowRef:ie.func.isRequired,styles:ie.object.isRequired});var JM=["color","height","width"];function OE(t){var e=t.handleClick,n=t.styles,s=n.color,a=n.height,r=n.width,i=$E(n,JM);return Ee.createElement("button",{"aria-label":"close",onClick:e,style:i,type:"button"},Ee.createElement("svg",{width:"".concat(r,"px"),height:"".concat(a,"px"),viewBox:"0 0 18 18",version:"1.1",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid"},Ee.createElement("g",null,Ee.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:s}))))}OE.propTypes={handleClick:ie.func.isRequired,styles:ie.object.isRequired};function DE(t){var e=t.content,n=t.footer,s=t.handleClick,a=t.open,r=t.positionWrapper,i=t.showCloseButton,o=t.title,l=t.styles,u={content:Ee.isValidElement(e)?e:Ee.createElement("div",{className:"__floater__content",style:l.content},e)};return o&&(u.title=Ee.isValidElement(o)?o:Ee.createElement("div",{className:"__floater__title",style:l.title},o)),n&&(u.footer=Ee.isValidElement(n)?n:Ee.createElement("div",{className:"__floater__footer",style:l.footer},n)),(i||r)&&!Q.boolean(a)&&(u.close=Ee.createElement(OE,{styles:l.close,handleClick:s})),Ee.createElement("div",{className:"__floater__container",style:l.container},u.close,u.title,u.content,u.footer)}DE.propTypes={content:ie.node.isRequired,footer:ie.node,handleClick:ie.func.isRequired,open:ie.bool,positionWrapper:ie.bool.isRequired,showCloseButton:ie.bool.isRequired,styles:ie.object.isRequired,title:ie.node};var jE=function(t){mp(n,t);var e=gp(n);function n(){return hp(this,n),e.apply(this,arguments)}return fp(n,[{key:"style",get:function(){var a=this.props,r=a.disableAnimation,i=a.component,o=a.placement,l=a.hideArrow,u=a.status,c=a.styles,d=c.arrow.length,p=c.floater,h=c.floaterCentered,f=c.floaterClosing,m=c.floaterOpening,y=c.floaterWithAnimation,g=c.floaterWithComponent,b={};return l||(o.startsWith("top")?b.padding="0 0 ".concat(d,"px"):o.startsWith("bottom")?b.padding="".concat(d,"px 0 0"):o.startsWith("left")?b.padding="0 ".concat(d,"px 0 0"):o.startsWith("right")&&(b.padding="0 0 0 ".concat(d,"px"))),[Ge.OPENING,Ge.OPEN].indexOf(u)!==-1&&(b=bt(bt({},b),m)),u===Ge.CLOSING&&(b=bt(bt({},b),f)),u===Ge.OPEN&&!r&&(b=bt(bt({},b),y)),o==="center"&&(b=bt(bt({},b),h)),i&&(b=bt(bt({},b),g)),bt(bt({},p),b)}},{key:"render",value:function(){var a=this.props,r=a.component,i=a.handleClick,o=a.hideArrow,l=a.setFloaterRef,u=a.status,c={},d=["__floater"];return r?Ee.isValidElement(r)?c.content=Ee.cloneElement(r,{closeFn:i}):c.content=r({closeFn:i}):c.content=Ee.createElement(DE,this.props),u===Ge.OPEN&&d.push("__floater__open"),o||(c.arrow=Ee.createElement(AE,this.props)),Ee.createElement("div",{ref:l,className:d.join(" "),style:this.style},Ee.createElement("div",{className:"__floater__body"},c.content,c.arrow))}}]),n}(Ee.Component);Tn(jE,"propTypes",{component:ie.oneOfType([ie.func,ie.element]),content:ie.node,disableAnimation:ie.bool.isRequired,footer:ie.node,handleClick:ie.func.isRequired,hideArrow:ie.bool.isRequired,open:ie.bool,placement:ie.string.isRequired,positionWrapper:ie.bool.isRequired,setArrowRef:ie.func.isRequired,setFloaterRef:ie.func.isRequired,showCloseButton:ie.bool,status:ie.string.isRequired,styles:ie.object.isRequired,title:ie.node});var _E=function(t){mp(n,t);var e=gp(n);function n(){return hp(this,n),e.apply(this,arguments)}return fp(n,[{key:"render",value:function(){var a=this.props,r=a.children,i=a.handleClick,o=a.handleMouseEnter,l=a.handleMouseLeave,u=a.setChildRef,c=a.setWrapperRef,d=a.style,p=a.styles,h;if(r)if(Ee.Children.count(r)===1)if(!Ee.isValidElement(r))h=Ee.createElement("span",null,r);else{var f=Q.function(r.type)?"innerRef":"ref";h=Ee.cloneElement(Ee.Children.only(r),Tn({},f,u))}else h=r;return h?Ee.createElement("span",{ref:c,style:bt(bt({},p),d),onClick:i,onMouseEnter:o,onMouseLeave:l},h):null}}]),n}(Ee.Component);Tn(_E,"propTypes",{children:ie.node,handleClick:ie.func.isRequired,handleMouseEnter:ie.func.isRequired,handleMouseLeave:ie.func.isRequired,setChildRef:ie.func.isRequired,setWrapperRef:ie.func.isRequired,style:ie.object,styles:ie.object.isRequired});var XM={zIndex:100};function YM(t){var e=da(XM,t.options||{});return{wrapper:{cursor:"help",display:"inline-flex",flexDirection:"column",zIndex:e.zIndex},wrapperPosition:{left:-1e3,position:"absolute",top:-1e3,visibility:"hidden"},floater:{display:"inline-block",filter:"drop-shadow(0 0 3px rgba(0, 0, 0, 0.3))",maxWidth:300,opacity:0,position:"relative",transition:"opacity 0.3s",visibility:"hidden",zIndex:e.zIndex},floaterOpening:{opacity:1,visibility:"visible"},floaterWithAnimation:{opacity:1,transition:"opacity 0.3s, transform 0.2s",visibility:"visible"},floaterWithComponent:{maxWidth:"100%"},floaterClosing:{opacity:0,visibility:"visible"},floaterCentered:{left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)"},container:{backgroundColor:"#fff",color:"#666",minHeight:60,minWidth:200,padding:20,position:"relative",zIndex:10},title:{borderBottom:"1px solid #555",color:"#555",fontSize:18,marginBottom:5,paddingBottom:6,paddingRight:18},content:{fontSize:15},close:{backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",fontSize:0,height:15,outline:"none",padding:10,position:"absolute",right:0,top:0,width:15,WebkitAppearance:"none"},footer:{borderTop:"1px solid #ccc",fontSize:13,marginTop:10,paddingTop:5},arrow:{color:"#fff",display:"inline-flex",length:16,margin:8,position:"absolute",spread:32},options:e}}var QM=["arrow","flip","offset"],ZM=["position","top","right","bottom","left"],Kx=function(t){mp(n,t);var e=gp(n);function n(s){var a;return hp(this,n),a=e.call(this,s),Tn(ar(a),"setArrowRef",function(r){a.arrowRef=r}),Tn(ar(a),"setChildRef",function(r){a.childRef=r}),Tn(ar(a),"setFloaterRef",function(r){a.floaterRef=r}),Tn(ar(a),"setWrapperRef",function(r){a.wrapperRef=r}),Tn(ar(a),"handleTransitionEnd",function(){var r=a.state.status,i=a.props.callback;a.wrapperPopper&&a.wrapperPopper.instance.update(),a.setState({status:r===Ge.OPENING?Ge.OPEN:Ge.IDLE},function(){var o=a.state.status;i(o===Ge.OPEN?"open":"close",a.props)})}),Tn(ar(a),"handleClick",function(){var r=a.props,i=r.event,o=r.open;if(!Q.boolean(o)){var l=a.state,u=l.positionWrapper,c=l.status;(a.event==="click"||a.event==="hover"&&u)&&(vf({title:"click",data:[{event:i,status:c===Ge.OPEN?"closing":"opening"}],debug:a.debug}),a.toggle())}}),Tn(ar(a),"handleMouseEnter",function(){var r=a.props,i=r.event,o=r.open;if(!(Q.boolean(o)||vb())){var l=a.state.status;a.event==="hover"&&l===Ge.IDLE&&(vf({title:"mouseEnter",data:[{key:"originalEvent",value:i}],debug:a.debug}),clearTimeout(a.eventDelayTimeout),a.toggle())}}),Tn(ar(a),"handleMouseLeave",function(){var r=a.props,i=r.event,o=r.eventDelay,l=r.open;if(!(Q.boolean(l)||vb())){var u=a.state,c=u.status,d=u.positionWrapper;a.event==="hover"&&(vf({title:"mouseLeave",data:[{key:"originalEvent",value:i}],debug:a.debug}),o?[Ge.OPENING,Ge.OPEN].indexOf(c)!==-1&&!d&&!a.eventDelayTimeout&&(a.eventDelayTimeout=setTimeout(function(){delete a.eventDelayTimeout,a.toggle()},o*1e3)):a.toggle(Ge.IDLE))}}),a.state={currentPlacement:s.placement,needsUpdate:!1,positionWrapper:s.wrapperOptions.position&&!!s.target,status:Ge.INIT,statusWrapper:Ge.INIT},a._isMounted=!1,a.hasMounted=!1,Aa()&&window.addEventListener("load",function(){a.popper&&a.popper.instance.update(),a.wrapperPopper&&a.wrapperPopper.instance.update()}),a}return fp(n,[{key:"componentDidMount",value:function(){if(Aa()){var a=this.state.positionWrapper,r=this.props,i=r.children,o=r.open,l=r.target;this._isMounted=!0,vf({title:"init",data:{hasChildren:!!i,hasTarget:!!l,isControlled:Q.boolean(o),positionWrapper:a,target:this.target,floater:this.floaterRef},debug:this.debug}),this.hasMounted||(this.initPopper(),this.hasMounted=!0),!i&&l&&Q.boolean(o)}}},{key:"componentDidUpdate",value:function(a,r){if(Aa()){var i=this.props,o=i.autoOpen,l=i.open,u=i.target,c=i.wrapperOptions,d=DM(r,this.state),p=d.changedFrom,h=d.changed;if(a.open!==l){var f;Q.boolean(l)&&(f=l?Ge.OPENING:Ge.CLOSING),this.toggle(f)}(a.wrapperOptions.position!==c.position||a.target!==u)&&this.changeWrapperPosition(this.props),h("status",Ge.IDLE)&&l?this.toggle(Ge.OPEN):p("status",Ge.INIT,Ge.IDLE)&&o&&this.toggle(Ge.OPEN),this.popper&&h("status",Ge.OPENING)&&this.popper.instance.update(),this.floaterRef&&(h("status",Ge.OPENING)||h("status",Ge.CLOSING))&&qM(this.floaterRef,"transitionend",this.handleTransitionEnd),h("needsUpdate",!0)&&this.rebuildPopper()}}},{key:"componentWillUnmount",value:function(){Aa()&&(this._isMounted=!1,this.popper&&this.popper.instance.destroy(),this.wrapperPopper&&this.wrapperPopper.instance.destroy())}},{key:"initPopper",value:function(){var a=this,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.target,i=this.state.positionWrapper,o=this.props,l=o.disableFlip,u=o.getPopper,c=o.hideArrow,d=o.offset,p=o.placement,h=o.wrapperOptions,f=p==="top"||p==="bottom"?"flip":["right","bottom-end","top-end","left","top-start","bottom-start"];if(p==="center")this.setState({status:Ge.IDLE});else if(r&&this.floaterRef){var m=this.options,y=m.arrow,g=m.flip,b=m.offset,w=$E(m,QM);new Fd(r,this.floaterRef,{placement:p,modifiers:bt({arrow:bt({enabled:!c,element:this.arrowRef},y),flip:bt({enabled:!l,behavior:f},g),offset:bt({offset:"0, ".concat(d,"px")},b)},w),onCreate:function(S){var C;if(a.popper=S,!((C=a.floaterRef)!==null&&C!==void 0&&C.isConnected)){a.setState({needsUpdate:!0});return}u(S,"floater"),a._isMounted&&a.setState({currentPlacement:S.placement,status:Ge.IDLE}),p!==S.placement&&setTimeout(function(){S.instance.update()},1)},onUpdate:function(S){a.popper=S;var C=a.state.currentPlacement;a._isMounted&&S.placement!==C&&a.setState({currentPlacement:S.placement})}})}if(i){var k=Q.undefined(h.offset)?0:h.offset;new Fd(this.target,this.wrapperRef,{placement:h.placement||p,modifiers:{arrow:{enabled:!1},offset:{offset:"0, ".concat(k,"px")},flip:{enabled:!1}},onCreate:function(S){a.wrapperPopper=S,a._isMounted&&a.setState({statusWrapper:Ge.IDLE}),u(S,"wrapper"),p!==S.placement&&setTimeout(function(){S.instance.update()},1)}})}}},{key:"rebuildPopper",value:function(){var a=this;this.floaterRefInterval=setInterval(function(){var r;(r=a.floaterRef)!==null&&r!==void 0&&r.isConnected&&(clearInterval(a.floaterRefInterval),a.setState({needsUpdate:!1}),a.initPopper())},50)}},{key:"changeWrapperPosition",value:function(a){var r=a.target,i=a.wrapperOptions;this.setState({positionWrapper:i.position&&!!r})}},{key:"toggle",value:function(a){var r=this.state.status,i=r===Ge.OPEN?Ge.CLOSING:Ge.OPENING;Q.undefined(a)||(i=a),this.setState({status:i})}},{key:"debug",get:function(){var a=this.props.debug;return a||Aa()&&"ReactFloaterDebug"in window&&!!window.ReactFloaterDebug}},{key:"event",get:function(){var a=this.props,r=a.disableHoverToClick,i=a.event;return i==="hover"&&vb()&&!r?"click":i}},{key:"options",get:function(){var a=this.props.options;return da(BM,a||{})}},{key:"styles",get:function(){var a=this,r=this.state,i=r.status,o=r.positionWrapper,l=r.statusWrapper,u=this.props.styles,c=da(YM(u),u);if(o){var d;[Ge.IDLE].indexOf(i)===-1||[Ge.IDLE].indexOf(l)===-1?d=c.wrapperPosition:d=this.wrapperPopper.styles,c.wrapper=bt(bt({},c.wrapper),d)}if(this.target){var p=window.getComputedStyle(this.target);this.wrapperStyles?c.wrapper=bt(bt({},c.wrapper),this.wrapperStyles):["relative","static"].indexOf(p.position)===-1&&(this.wrapperStyles={},o||(ZM.forEach(function(h){a.wrapperStyles[h]=p[h]}),c.wrapper=bt(bt({},c.wrapper),this.wrapperStyles),this.target.style.position="relative",this.target.style.top="auto",this.target.style.right="auto",this.target.style.bottom="auto",this.target.style.left="auto"))}return c}},{key:"target",get:function(){if(!Aa())return null;var a=this.props.target;return a?Q.domElement(a)?a:document.querySelector(a):this.childRef||this.wrapperRef}},{key:"render",value:function(){var a=this.state,r=a.currentPlacement,i=a.positionWrapper,o=a.status,l=this.props,u=l.children,c=l.component,d=l.content,p=l.disableAnimation,h=l.footer,f=l.hideArrow,m=l.id,y=l.open,g=l.showCloseButton,b=l.style,w=l.target,k=l.title,x=Ee.createElement(_E,{handleClick:this.handleClick,handleMouseEnter:this.handleMouseEnter,handleMouseLeave:this.handleMouseLeave,setChildRef:this.setChildRef,setWrapperRef:this.setWrapperRef,style:b,styles:this.styles.wrapper},u),S={};return i?S.wrapperInPortal=x:S.wrapperAsChildren=x,Ee.createElement("span",null,Ee.createElement(RE,{hasChildren:!!u,id:m,placement:r,setRef:this.setFloaterRef,target:w,zIndex:this.styles.options.zIndex},Ee.createElement(jE,{component:c,content:d,disableAnimation:p,footer:h,handleClick:this.handleClick,hideArrow:f||r==="center",open:y,placement:r,positionWrapper:i,setArrowRef:this.setArrowRef,setFloaterRef:this.setFloaterRef,showCloseButton:g,status:o,styles:this.styles,title:k}),S.wrapperInPortal),S.wrapperAsChildren)}}]),n}(Ee.Component);Tn(Kx,"propTypes",{autoOpen:ie.bool,callback:ie.func,children:ie.node,component:LN(ie.oneOfType([ie.func,ie.element]),function(t){return!t.content}),content:LN(ie.node,function(t){return!t.component}),debug:ie.bool,disableAnimation:ie.bool,disableFlip:ie.bool,disableHoverToClick:ie.bool,event:ie.oneOf(["hover","click"]),eventDelay:ie.number,footer:ie.node,getPopper:ie.func,hideArrow:ie.bool,id:ie.oneOfType([ie.string,ie.number]),offset:ie.number,open:ie.bool,options:ie.object,placement:ie.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto","center"]),showCloseButton:ie.bool,style:ie.object,styles:ie.object,target:ie.oneOfType([ie.object,ie.string]),title:ie.node,wrapperOptions:ie.shape({offset:ie.number,placement:ie.oneOf(["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end","auto"]),position:ie.bool})});Tn(Kx,"defaultProps",{autoOpen:!1,callback:BN,debug:!1,disableAnimation:!1,disableFlip:!1,disableHoverToClick:!1,event:"click",eventDelay:.4,getPopper:BN,hideArrow:!1,offset:15,placement:"bottom",showCloseButton:!1,styles:{},target:null,wrapperOptions:{position:!1}});var e4=Object.defineProperty,t4=(t,e,n)=>e in t?e4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ke=(t,e,n)=>t4(t,typeof e!="symbol"?e+"":e,n),Ye={INIT:"init",START:"start",STOP:"stop",RESET:"reset",PREV:"prev",NEXT:"next",GO:"go",CLOSE:"close",SKIP:"skip",UPDATE:"update"},la={TOUR_START:"tour:start",STEP_BEFORE:"step:before",BEACON:"beacon",TOOLTIP:"tooltip",STEP_AFTER:"step:after",TOUR_END:"tour:end",TOUR_STATUS:"tour:status",TARGET_NOT_FOUND:"error:target_not_found",ERROR:"error"},$e={INIT:"init",READY:"ready",BEACON:"beacon",TOOLTIP:"tooltip",COMPLETE:"complete",ERROR:"error"},We={IDLE:"idle",READY:"ready",WAITING:"waiting",RUNNING:"running",PAUSED:"paused",SKIPPED:"skipped",FINISHED:"finished",ERROR:"error"};function qr(){var t;return!!(typeof window<"u"&&((t=window.document)!=null&&t.createElement))}function FE(t){return t?t.getBoundingClientRect():null}function n4(t=!1){const{body:e,documentElement:n}=document;if(!e||!n)return 0;if(t){const s=[e.scrollHeight,e.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight].sort((r,i)=>r-i),a=Math.floor(s.length/2);return s.length%2===0?(s[a-1]+s[a])/2:s[a]}return Math.max(e.scrollHeight,e.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight)}function fr(t){if(typeof t=="string")try{return document.querySelector(t)}catch{return null}return t}function s4(t){return!t||t.nodeType!==1?null:getComputedStyle(t)}function Pd(t,e,n){if(!t)return lo();const s=iE(t);if(s){if(s.isSameNode(lo()))return n?document:lo();if(!(s.scrollHeight>s.offsetHeight)&&!e)return s.style.overflow="initial",lo()}return s}function Eg(t,e){if(!t)return!1;const n=Pd(t,e);return n?!n.isSameNode(lo()):!1}function a4(t){return t.offsetParent!==document.body}function Xl(t,e="fixed"){if(!t||!(t instanceof HTMLElement))return!1;const{nodeName:n}=t,s=s4(t);return n==="BODY"||n==="HTML"?!1:s&&s.position===e?!0:t.parentNode?Xl(t.parentNode,e):!1}function r4(t){var e;if(!t)return!1;let n=t;for(;n&&n!==document.body;){if(n instanceof HTMLElement){const{display:s,visibility:a}=getComputedStyle(n);if(s==="none"||a==="hidden")return!1}n=(e=n.parentElement)!=null?e:null}return!0}function i4(t,e,n){var s,a,r;const i=FE(t),o=Pd(t,n),l=Eg(t,n),u=Xl(t);let c=0,d=(s=i==null?void 0:i.top)!=null?s:0;if(l&&u){const p=(a=t==null?void 0:t.offsetTop)!=null?a:0,h=(r=o==null?void 0:o.scrollTop)!=null?r:0;d=p-h}else o instanceof HTMLElement&&(c=o.scrollTop,!l&&!Xl(t)&&(d+=c),o.isSameNode(lo())||(d+=lo().scrollTop));return Math.floor(d-e)}function o4(t,e,n){var s;if(!t)return 0;const{offsetTop:a=0,scrollTop:r=0}=(s=iE(t))!=null?s:{};let i=t.getBoundingClientRect().top+r;a&&(Eg(t,n)||a4(t))&&(i-=a);const o=Math.floor(i-e);return o<0?0:o}function lo(){var t;return(t=document.scrollingElement)!=null?t:document.documentElement}function l4(t,e){const{duration:n,element:s}=e;return new Promise((a,r)=>{const{scrollTop:i}=s,o=t>i?t-i:i-t;dz.top(s,t,{duration:o<100?50:n},l=>l&&l.message!=="Element already at target scroll position"?r(l):a())})}var Mc=Dl.createPortal!==void 0;function PE(t=navigator.userAgent){let e=t;return typeof window>"u"?e="node":document.documentMode?e="ie":/Edge/.test(t)?e="edge":window.opera||t.includes(" OPR/")?e="opera":typeof window.InstallTrigger<"u"?e="firefox":window.chrome?e="chrome":/(Version\/([\d._]+).*Safari|CriOS|FxiOS| Mobile\/)/.test(t)&&(e="safari"),e}function Yf(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function Oa(t,e={}){const{defaultValue:n,step:s,steps:a}=e;let r=SN(t);if(r)(r.includes("{step}")||r.includes("{steps}"))&&s&&a&&(r=r.replace("{step}",s.toString()).replace("{steps}",a.toString()));else if(B.isValidElement(t)&&!Object.values(t.props).length&&Yf(t.type)==="function"){const i=t.type({});r=Oa(i,e)}else r=SN(n);return r}function u4(t,e){return!ye.plainObject(t)||!ye.array(e)?!1:Object.keys(t).every(n=>e.includes(n))}function c4(t){const e=/^#?([\da-f])([\da-f])([\da-f])$/i,n=t.replace(e,(a,r,i,o)=>r+r+i+i+o+o),s=/^#?([\da-f]{2})([\da-f]{2})([\da-f]{2})$/i.exec(n);return s?[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]:[]}function zN(t){return t.disableBeacon||t.placement==="center"}function MN(){return!["chrome","safari","firefox","opera"].includes(PE())}function Co({data:t,debug:e=!1,title:n,warn:s=!1}){const a=s?console.warn||console.error:console.log;e&&(n&&t?(console.groupCollapsed(`%creact-joyride: ${n}`,"color: #ff0044; font-weight: bold; font-size: 12px;"),Array.isArray(t)?t.forEach(r=>{ye.plainObject(r)&&r.key?a.apply(console,[r.key,r.value]):a.apply(console,[r])}):a.apply(console,[t]),console.groupEnd()):console.error("Missing title or data props"))}function d4(t){return Object.keys(t)}function LE(t,...e){if(!ye.plainObject(t))throw new TypeError("Expected an object");const n={};for(const s in t)({}).hasOwnProperty.call(t,s)&&(e.includes(s)||(n[s]=t[s]));return n}function p4(t,...e){if(!ye.plainObject(t))throw new TypeError("Expected an object");if(!e.length)return t;const n={};for(const s in t)({}).hasOwnProperty.call(t,s)&&e.includes(s)&&(n[s]=t[s]);return n}function Uw(t,e,n){const s=r=>r.replace("{step}",String(e)).replace("{steps}",String(n));if(Yf(t)==="string")return s(t);if(!B.isValidElement(t))return t;const{children:a}=t.props;if(Yf(a)==="string"&&a.includes("{step}"))return B.cloneElement(t,{children:s(a)});if(Array.isArray(a))return B.cloneElement(t,{children:a.map(r=>typeof r=="string"?s(r):Uw(r,e,n))});if(Yf(t.type)==="function"&&!Object.values(t.props).length){const r=t.type({});return Uw(r,e,n)}return t}function h4(t){const{isFirstStep:e,lifecycle:n,previousLifecycle:s,scrollToFirstStep:a,step:r,target:i}=t;return!r.disableScrolling&&(!e||a||n===$e.TOOLTIP)&&r.placement!=="center"&&(!r.isFixed||!Xl(i))&&s!==n&&[$e.BEACON,$e.TOOLTIP].includes(n)}var f4={options:{preventOverflow:{boundariesElement:"scrollParent"}},wrapperOptions:{offset:-18,position:!0}},BE={back:"Back",close:"Close",last:"Last",next:"Next",nextLabelWithProgress:"Next (Step {step} of {steps})",open:"Open the dialog",skip:"Skip"},m4={event:"click",placement:"bottom",offset:10,disableBeacon:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrollParentFix:!1,disableScrolling:!1,hideBackButton:!1,hideCloseButton:!1,hideFooter:!1,isFixed:!1,locale:BE,showProgress:!1,showSkipButton:!1,spotlightClicks:!1,spotlightPadding:10},g4={continuous:!1,debug:!1,disableCloseOnEsc:!1,disableOverlay:!1,disableOverlayClose:!1,disableScrolling:!1,disableScrollParentFix:!1,getHelpers:void 0,hideBackButton:!1,run:!0,scrollOffset:20,scrollDuration:300,scrollToFirstStep:!1,showSkipButton:!1,showProgress:!1,spotlightClicks:!1,spotlightPadding:10,steps:[]},y4={arrowColor:"#fff",backgroundColor:"#fff",beaconSize:36,overlayColor:"rgba(0, 0, 0, 0.5)",primaryColor:"#f04",spotlightShadow:"0 0 15px rgba(0, 0, 0, 0.5)",textColor:"#333",width:380,zIndex:100},Vc={backgroundColor:"transparent",border:0,borderRadius:0,color:"#555",cursor:"pointer",fontSize:16,lineHeight:1,padding:8,WebkitAppearance:"none"},VN={borderRadius:4,position:"absolute"};function b4(t,e){var n,s,a,r,i;const{floaterProps:o,styles:l}=t,u=da((n=e.floaterProps)!=null?n:{},o??{}),c=da(l??{},(s=e.styles)!=null?s:{}),d=da(y4,c.options||{}),p=e.placement==="center"||e.disableBeacon;let{width:h}=d;window.innerWidth>480&&(h=380),"width"in d&&(h=typeof d.width=="number"&&window.innerWidth<d.width?window.innerWidth-30:d.width);const f={bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,top:0,zIndex:d.zIndex},m={beacon:{...Vc,display:p?"none":"inline-block",height:d.beaconSize,position:"relative",width:d.beaconSize,zIndex:d.zIndex},beaconInner:{animation:"joyride-beacon-inner 1.2s infinite ease-in-out",backgroundColor:d.primaryColor,borderRadius:"50%",display:"block",height:"50%",left:"50%",opacity:.7,position:"absolute",top:"50%",transform:"translate(-50%, -50%)",width:"50%"},beaconOuter:{animation:"joyride-beacon-outer 1.2s infinite ease-in-out",backgroundColor:`rgba(${c4(d.primaryColor).join(",")}, 0.2)`,border:`2px solid ${d.primaryColor}`,borderRadius:"50%",boxSizing:"border-box",display:"block",height:"100%",left:0,opacity:.9,position:"absolute",top:0,transformOrigin:"center",width:"100%"},tooltip:{backgroundColor:d.backgroundColor,borderRadius:5,boxSizing:"border-box",color:d.textColor,fontSize:16,maxWidth:"100%",padding:15,position:"relative",width:h},tooltipContainer:{lineHeight:1.4,textAlign:"center"},tooltipTitle:{fontSize:18,margin:0},tooltipContent:{padding:"20px 10px"},tooltipFooter:{alignItems:"center",display:"flex",justifyContent:"flex-end",marginTop:15},tooltipFooterSpacer:{flex:1},buttonNext:{...Vc,backgroundColor:d.primaryColor,borderRadius:4,color:"#fff"},buttonBack:{...Vc,color:d.primaryColor,marginLeft:"auto",marginRight:5},buttonClose:{...Vc,color:d.textColor,height:14,padding:15,position:"absolute",right:0,top:0,width:14},buttonSkip:{...Vc,color:d.textColor,fontSize:14},overlay:{...f,backgroundColor:d.overlayColor,mixBlendMode:"hard-light"},overlayLegacy:{...f},overlayLegacyCenter:{...f,backgroundColor:d.overlayColor},spotlight:{...VN,backgroundColor:"gray"},spotlightLegacy:{...VN,boxShadow:`0 0 0 9999px ${d.overlayColor}, ${d.spotlightShadow}`},floaterStyles:{arrow:{color:(i=(r=(a=u==null?void 0:u.styles)==null?void 0:a.arrow)==null?void 0:r.color)!=null?i:d.arrowColor},options:{zIndex:d.zIndex+100}},options:d};return da(m,c)}function w4(t){return p4(t,"beaconComponent","disableCloseOnEsc","disableOverlay","disableOverlayClose","disableScrolling","disableScrollParentFix","floaterProps","hideBackButton","hideCloseButton","locale","showProgress","showSkipButton","spotlightClicks","spotlightPadding","styles","tooltipComponent")}function ul(t,e){var n,s,a,r,i,o;const l=e??{},u=da.all([m4,w4(t),l],{isMergeableObject:ye.plainObject}),c=b4(t,u),d=Eg(fr(u.target),u.disableScrollParentFix),p=da.all([f4,(n=t.floaterProps)!=null?n:{},(s=u.floaterProps)!=null?s:{}]);return p.offset=u.offset,p.styles=da((a=p.styles)!=null?a:{},c.floaterStyles),p.offset+=(i=(r=t.spotlightPadding)!=null?r:u.spotlightPadding)!=null?i:0,u.placementBeacon&&p.wrapperOptions&&(p.wrapperOptions.placement=u.placementBeacon),d&&p.options.preventOverflow&&(p.options.preventOverflow.boundariesElement="window"),{...u,locale:da.all([BE,(o=t.locale)!=null?o:{},u.locale||{}]),floaterProps:p,styles:LE(c,"floaterStyles")}}function zE(t,e=!1){return ye.plainObject(t)?t.target?!0:(Co({title:"validateStep",data:"target is missing from the step",warn:!0,debug:e}),!1):(Co({title:"validateStep",data:"step must be an object",warn:!0,debug:e}),!1)}function WN(t,e=!1){return ye.array(t)?t.every(n=>zE(n,e)):(Co({title:"validateSteps",data:"steps must be an array",warn:!0,debug:e}),!1)}var ME={action:"init",controlled:!1,index:0,lifecycle:$e.INIT,origin:null,size:0,status:We.IDLE},UN=d4(LE(ME,"controlled","size")),k4=class{constructor(t){ke(this,"beaconPopper"),ke(this,"tooltipPopper"),ke(this,"data",new Map),ke(this,"listener"),ke(this,"store",new Map),ke(this,"addListener",a=>{this.listener=a}),ke(this,"setSteps",a=>{const{size:r,status:i}=this.getState(),o={size:a.length,status:i};this.data.set("steps",a),i===We.WAITING&&!r&&a.length&&(o.status=We.RUNNING),this.setState(o)}),ke(this,"getPopper",a=>a==="beacon"?this.beaconPopper:this.tooltipPopper),ke(this,"setPopper",(a,r)=>{a==="beacon"?this.beaconPopper=r:this.tooltipPopper=r}),ke(this,"cleanupPoppers",()=>{this.beaconPopper=null,this.tooltipPopper=null}),ke(this,"close",(a=null)=>{const{index:r,status:i}=this.getState();i===We.RUNNING&&this.setState({...this.getNextState({action:Ye.CLOSE,index:r+1,origin:a})})}),ke(this,"go",a=>{const{controlled:r,status:i}=this.getState();if(r||i!==We.RUNNING)return;const o=this.getSteps()[a];this.setState({...this.getNextState({action:Ye.GO,index:a}),status:o?i:We.FINISHED})}),ke(this,"info",()=>this.getState()),ke(this,"next",()=>{const{index:a,status:r}=this.getState();r===We.RUNNING&&this.setState(this.getNextState({action:Ye.NEXT,index:a+1}))}),ke(this,"open",()=>{const{status:a}=this.getState();a===We.RUNNING&&this.setState({...this.getNextState({action:Ye.UPDATE,lifecycle:$e.TOOLTIP})})}),ke(this,"prev",()=>{const{index:a,status:r}=this.getState();r===We.RUNNING&&this.setState({...this.getNextState({action:Ye.PREV,index:a-1})})}),ke(this,"reset",(a=!1)=>{const{controlled:r}=this.getState();r||this.setState({...this.getNextState({action:Ye.RESET,index:0}),status:a?We.RUNNING:We.READY})}),ke(this,"skip",()=>{const{status:a}=this.getState();a===We.RUNNING&&this.setState({action:Ye.SKIP,lifecycle:$e.INIT,status:We.SKIPPED})}),ke(this,"start",a=>{const{index:r,size:i}=this.getState();this.setState({...this.getNextState({action:Ye.START,index:ye.number(a)?a:r},!0),status:i?We.RUNNING:We.WAITING})}),ke(this,"stop",(a=!1)=>{const{index:r,status:i}=this.getState();[We.FINISHED,We.SKIPPED].includes(i)||this.setState({...this.getNextState({action:Ye.STOP,index:r+(a?1:0)}),status:We.PAUSED})}),ke(this,"update",a=>{var r,i;if(!u4(a,UN))throw new Error(`State is not valid. Valid keys: ${UN.join(", ")}`);this.setState({...this.getNextState({...this.getState(),...a,action:(r=a.action)!=null?r:Ye.UPDATE,origin:(i=a.origin)!=null?i:null},!0)})});const{continuous:e=!1,stepIndex:n,steps:s=[]}=t??{};this.setState({action:Ye.INIT,controlled:ye.number(n),continuous:e,index:ye.number(n)?n:0,lifecycle:$e.INIT,origin:null,status:s.length?We.READY:We.IDLE},!0),this.beaconPopper=null,this.tooltipPopper=null,this.listener=null,this.setSteps(s)}getState(){return this.store.size?{action:this.store.get("action")||"",controlled:this.store.get("controlled")||!1,index:parseInt(this.store.get("index"),10),lifecycle:this.store.get("lifecycle")||"",origin:this.store.get("origin")||null,size:this.store.get("size")||0,status:this.store.get("status")||""}:{...ME}}getNextState(t,e=!1){var n,s,a,r,i;const{action:o,controlled:l,index:u,size:c,status:d}=this.getState(),p=ye.number(t.index)?t.index:u,h=l&&!e?u:Math.min(Math.max(p,0),c);return{action:(n=t.action)!=null?n:o,controlled:l,index:h,lifecycle:(s=t.lifecycle)!=null?s:$e.INIT,origin:(a=t.origin)!=null?a:null,size:(r=t.size)!=null?r:c,status:h===c?We.FINISHED:(i=t.status)!=null?i:d}}getSteps(){const t=this.data.get("steps");return Array.isArray(t)?t:[]}hasUpdatedState(t){const e=JSON.stringify(t),n=JSON.stringify(this.getState());return e!==n}setState(t,e=!1){const n=this.getState(),{action:s,index:a,lifecycle:r,origin:i=null,size:o,status:l}={...n,...t};this.store.set("action",s),this.store.set("index",a),this.store.set("lifecycle",r),this.store.set("origin",i),this.store.set("size",o),this.store.set("status",l),e&&(this.store.set("controlled",t.controlled),this.store.set("continuous",t.continuous)),this.listener&&this.hasUpdatedState(n)&&this.listener(this.getState())}getHelpers(){return{close:this.close,go:this.go,info:this.info,next:this.next,open:this.open,prev:this.prev,reset:this.reset,skip:this.skip}}};function x4(t){return new k4(t)}function v4({styles:t}){return B.createElement("div",{key:"JoyrideSpotlight",className:"react-joyride__spotlight","data-test-id":"spotlight",style:t})}var S4=v4,N4=class extends B.Component{constructor(){super(...arguments),ke(this,"isActive",!1),ke(this,"resizeTimeout"),ke(this,"scrollTimeout"),ke(this,"scrollParent"),ke(this,"state",{isScrolling:!1,mouseOverSpotlight:!1,showSpotlight:!0}),ke(this,"hideSpotlight",()=>{const{continuous:t,disableOverlay:e,lifecycle:n}=this.props,s=[$e.INIT,$e.BEACON,$e.COMPLETE,$e.ERROR];return e||(t?s.includes(n):n!==$e.TOOLTIP)}),ke(this,"handleMouseMove",t=>{const{mouseOverSpotlight:e}=this.state,{height:n,left:s,position:a,top:r,width:i}=this.spotlightStyles,o=a==="fixed"?t.clientY:t.pageY,l=a==="fixed"?t.clientX:t.pageX,u=o>=r&&o<=r+n,d=l>=s&&l<=s+i&&u;d!==e&&this.updateState({mouseOverSpotlight:d})}),ke(this,"handleScroll",()=>{const{target:t}=this.props,e=fr(t);if(this.scrollParent!==document){const{isScrolling:n}=this.state;n||this.updateState({isScrolling:!0,showSpotlight:!1}),clearTimeout(this.scrollTimeout),this.scrollTimeout=window.setTimeout(()=>{this.updateState({isScrolling:!1,showSpotlight:!0})},50)}else Xl(e,"sticky")&&this.updateState({})}),ke(this,"handleResize",()=>{clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>{this.isActive&&this.forceUpdate()},100)})}componentDidMount(){const{debug:t,disableScrolling:e,disableScrollParentFix:n=!1,target:s}=this.props,a=fr(s);this.scrollParent=Pd(a??document.body,n,!0),this.isActive=!0,window.addEventListener("resize",this.handleResize)}componentDidUpdate(t){var e;const{disableScrollParentFix:n,lifecycle:s,spotlightClicks:a,target:r}=this.props,{changed:i}=$m(t,this.props);if(i("target")||i("disableScrollParentFix")){const o=fr(r);this.scrollParent=Pd(o??document.body,n,!0)}i("lifecycle",$e.TOOLTIP)&&((e=this.scrollParent)==null||e.addEventListener("scroll",this.handleScroll,{passive:!0}),setTimeout(()=>{const{isScrolling:o}=this.state;o||this.updateState({showSpotlight:!0})},100)),(i("spotlightClicks")||i("disableOverlay")||i("lifecycle"))&&(a&&s===$e.TOOLTIP?window.addEventListener("mousemove",this.handleMouseMove,!1):s!==$e.TOOLTIP&&window.removeEventListener("mousemove",this.handleMouseMove))}componentWillUnmount(){var t;this.isActive=!1,window.removeEventListener("mousemove",this.handleMouseMove),window.removeEventListener("resize",this.handleResize),clearTimeout(this.resizeTimeout),clearTimeout(this.scrollTimeout),(t=this.scrollParent)==null||t.removeEventListener("scroll",this.handleScroll)}get overlayStyles(){const{mouseOverSpotlight:t}=this.state,{disableOverlayClose:e,placement:n,styles:s}=this.props;let a=s.overlay;return MN()&&(a=n==="center"?s.overlayLegacyCenter:s.overlayLegacy),{cursor:e?"default":"pointer",height:n4(),pointerEvents:t?"none":"auto",...a}}get spotlightStyles(){var t,e,n;const{showSpotlight:s}=this.state,{disableScrollParentFix:a=!1,spotlightClicks:r,spotlightPadding:i=0,styles:o,target:l}=this.props,u=fr(l),c=FE(u),d=Xl(u),p=i4(u,i,a);return{...MN()?o.spotlightLegacy:o.spotlight,height:Math.round(((t=c==null?void 0:c.height)!=null?t:0)+i*2),left:Math.round(((e=c==null?void 0:c.left)!=null?e:0)-i),opacity:s?1:0,pointerEvents:r?"none":"auto",position:d?"fixed":"absolute",top:p,transition:"opacity 0.2s",width:Math.round(((n=c==null?void 0:c.width)!=null?n:0)+i*2)}}updateState(t){this.isActive&&this.setState(e=>({...e,...t}))}render(){const{showSpotlight:t}=this.state,{onClickOverlay:e,placement:n}=this.props,{hideSpotlight:s,overlayStyles:a,spotlightStyles:r}=this;if(s())return null;let i=n!=="center"&&t&&B.createElement(S4,{styles:r});if(PE()==="safari"){const{mixBlendMode:o,zIndex:l,...u}=a;i=B.createElement("div",{style:{...u}},i),delete a.backgroundColor}return B.createElement("div",{className:"react-joyride__overlay","data-test-id":"overlay",onClick:e,role:"presentation",style:a},i)}},C4=class extends B.Component{constructor(){super(...arguments),ke(this,"node",null)}componentDidMount(){const{id:t}=this.props;qr()&&(this.node=document.createElement("div"),this.node.id=t,document.body.appendChild(this.node),Mc||this.renderReact15())}componentDidUpdate(){qr()&&(Mc||this.renderReact15())}componentWillUnmount(){!qr()||!this.node||(Mc||Dl.unmountComponentAtNode(this.node),this.node.parentNode===document.body&&(document.body.removeChild(this.node),this.node=null))}renderReact15(){if(!qr())return;const{children:t}=this.props;this.node&&Dl.unstable_renderSubtreeIntoContainer(this,t,this.node)}renderReact16(){if(!qr()||!Mc)return null;const{children:t}=this.props;return this.node?Dl.createPortal(t,this.node):null}render(){return Mc?this.renderReact16():null}},I4=class{constructor(t,e){if(ke(this,"element"),ke(this,"options"),ke(this,"canBeTabbed",n=>{const{tabIndex:s}=n;return s===null||s<0?!1:this.canHaveFocus(n)}),ke(this,"canHaveFocus",n=>{const s=/input|select|textarea|button|object/,a=n.nodeName.toLowerCase();return(s.test(a)&&!n.getAttribute("disabled")||a==="a"&&!!n.getAttribute("href"))&&this.isVisible(n)}),ke(this,"findValidTabElements",()=>[].slice.call(this.element.querySelectorAll("*"),0).filter(this.canBeTabbed)),ke(this,"handleKeyDown",n=>{const{code:s="Tab"}=this.options;n.code===s&&this.interceptTab(n)}),ke(this,"interceptTab",n=>{n.preventDefault();const s=this.findValidTabElements(),{shiftKey:a}=n;if(!s.length)return;let r=document.activeElement?s.indexOf(document.activeElement):0;r===-1||!a&&r+1===s.length?r=0:a&&r===0?r=s.length-1:r+=a?-1:1,s[r].focus()}),ke(this,"isHidden",n=>{const s=n.offsetWidth<=0&&n.offsetHeight<=0,a=window.getComputedStyle(n);return s&&!n.innerHTML?!0:s&&a.getPropertyValue("overflow")!=="visible"||a.getPropertyValue("display")==="none"}),ke(this,"isVisible",n=>{let s=n;for(;s;)if(s instanceof HTMLElement){if(s===document.body)break;if(this.isHidden(s))return!1;s=s.parentNode}return!0}),ke(this,"removeScope",()=>{window.removeEventListener("keydown",this.handleKeyDown)}),ke(this,"checkFocus",n=>{document.activeElement!==n&&(n.focus(),window.requestAnimationFrame(()=>this.checkFocus(n)))}),ke(this,"setFocus",()=>{const{selector:n}=this.options;if(!n)return;const s=this.element.querySelector(n);s&&window.requestAnimationFrame(()=>this.checkFocus(s))}),!(t instanceof HTMLElement))throw new TypeError("Invalid parameter: element must be an HTMLElement");this.element=t,this.options=e,window.addEventListener("keydown",this.handleKeyDown,!1),this.setFocus()}},T4=class extends B.Component{constructor(t){if(super(t),ke(this,"beacon",null),ke(this,"setBeaconRef",a=>{this.beacon=a}),t.beaconComponent)return;const e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.id="joyride-beacon-animation",t.nonce&&n.setAttribute("nonce",t.nonce),n.appendChild(document.createTextNode(`
        @keyframes joyride-beacon-inner {
          20% {
            opacity: 0.9;
          }
        
          90% {
            opacity: 0.7;
          }
        }
        
        @keyframes joyride-beacon-outer {
          0% {
            transform: scale(1);
          }
        
          45% {
            opacity: 0.7;
            transform: scale(0.75);
          }
        
          100% {
            opacity: 0.9;
            transform: scale(1);
          }
        }
      `)),e.appendChild(n)}componentDidMount(){const{shouldFocus:t}=this.props;setTimeout(()=>{ye.domElement(this.beacon)&&t&&this.beacon.focus()},0)}componentWillUnmount(){const t=document.getElementById("joyride-beacon-animation");t!=null&&t.parentNode&&t.parentNode.removeChild(t)}render(){const{beaconComponent:t,continuous:e,index:n,isLastStep:s,locale:a,onClickOrHover:r,size:i,step:o,styles:l}=this.props,u=Oa(a.open),c={"aria-label":u,onClick:r,onMouseEnter:r,ref:this.setBeaconRef,title:u};let d;if(t){const p=t;d=B.createElement(p,{continuous:e,index:n,isLastStep:s,size:i,step:o,...c})}else d=B.createElement("button",{key:"JoyrideBeacon",className:"react-joyride__beacon","data-test-id":"button-beacon",style:l.beacon,type:"button",...c},B.createElement("span",{style:l.beaconInner}),B.createElement("span",{style:l.beaconOuter}));return d}};function $4({styles:t,...e}){const{color:n,height:s,width:a,...r}=t;return Ee.createElement("button",{style:r,type:"button",...e},Ee.createElement("svg",{height:typeof s=="number"?`${s}px`:s,preserveAspectRatio:"xMidYMid",version:"1.1",viewBox:"0 0 18 18",width:typeof a=="number"?`${a}px`:a,xmlns:"http://www.w3.org/2000/svg"},Ee.createElement("g",null,Ee.createElement("path",{d:"M8.13911129,9.00268191 L0.171521827,17.0258467 C-0.0498027049,17.248715 -0.0498027049,17.6098394 0.171521827,17.8327545 C0.28204354,17.9443526 0.427188206,17.9998706 0.572051765,17.9998706 C0.71714958,17.9998706 0.862013139,17.9443526 0.972581703,17.8327545 L9.0000937,9.74924618 L17.0276057,17.8327545 C17.1384085,17.9443526 17.2832721,17.9998706 17.4281356,17.9998706 C17.5729992,17.9998706 17.718097,17.9443526 17.8286656,17.8327545 C18.0499901,17.6098862 18.0499901,17.2487618 17.8286656,17.0258467 L9.86135722,9.00268191 L17.8340066,0.973848225 C18.0553311,0.750979934 18.0553311,0.389855532 17.8340066,0.16694039 C17.6126821,-0.0556467968 17.254037,-0.0556467968 17.0329467,0.16694039 L9.00042166,8.25611765 L0.967006424,0.167268345 C0.745681892,-0.0553188426 0.387317931,-0.0553188426 0.165993399,0.167268345 C-0.0553311331,0.390136635 -0.0553311331,0.751261038 0.165993399,0.974176179 L8.13920499,9.00268191 L8.13911129,9.00268191 Z",fill:n}))))}var E4=$4;function R4(t){const{backProps:e,closeProps:n,index:s,isLastStep:a,primaryProps:r,skipProps:i,step:o,tooltipProps:l}=t,{content:u,hideBackButton:c,hideCloseButton:d,hideFooter:p,showSkipButton:h,styles:f,title:m}=o,y={};return y.primary=B.createElement("button",{"data-test-id":"button-primary",style:f.buttonNext,type:"button",...r}),h&&!a&&(y.skip=B.createElement("button",{"aria-live":"off","data-test-id":"button-skip",style:f.buttonSkip,type:"button",...i})),!c&&s>0&&(y.back=B.createElement("button",{"data-test-id":"button-back",style:f.buttonBack,type:"button",...e})),y.close=!d&&B.createElement(E4,{"data-test-id":"button-close",styles:f.buttonClose,...n}),B.createElement("div",{key:"JoyrideTooltip","aria-label":Oa(m??u),className:"react-joyride__tooltip",style:f.tooltip,...l},B.createElement("div",{style:f.tooltipContainer},m&&B.createElement("h1",{"aria-label":Oa(m),style:f.tooltipTitle},m),B.createElement("div",{style:f.tooltipContent},u)),!p&&B.createElement("div",{style:f.tooltipFooter},B.createElement("div",{style:f.tooltipFooterSpacer},y.skip),y.back,y.primary),y.close)}var A4=R4,O4=class extends B.Component{constructor(){super(...arguments),ke(this,"handleClickBack",t=>{t.preventDefault();const{helpers:e}=this.props;e.prev()}),ke(this,"handleClickClose",t=>{t.preventDefault();const{helpers:e}=this.props;e.close("button_close")}),ke(this,"handleClickPrimary",t=>{t.preventDefault();const{continuous:e,helpers:n}=this.props;if(!e){n.close("button_primary");return}n.next()}),ke(this,"handleClickSkip",t=>{t.preventDefault();const{helpers:e}=this.props;e.skip()}),ke(this,"getElementsProps",()=>{const{continuous:t,index:e,isLastStep:n,setTooltipRef:s,size:a,step:r}=this.props,{back:i,close:o,last:l,next:u,nextLabelWithProgress:c,skip:d}=r.locale,p=Oa(i),h=Oa(o),f=Oa(l),m=Oa(u),y=Oa(d);let g=o,b=h;if(t){if(g=u,b=m,r.showProgress&&!n){const w=Oa(c,{step:e+1,steps:a});g=Uw(c,e+1,a),b=w}n&&(g=l,b=f)}return{backProps:{"aria-label":p,children:i,"data-action":"back",onClick:this.handleClickBack,role:"button",title:p},closeProps:{"aria-label":h,children:o,"data-action":"close",onClick:this.handleClickClose,role:"button",title:h},primaryProps:{"aria-label":b,children:g,"data-action":"primary",onClick:this.handleClickPrimary,role:"button",title:b},skipProps:{"aria-label":y,children:d,"data-action":"skip",onClick:this.handleClickSkip,role:"button",title:y},tooltipProps:{"aria-modal":!0,ref:s,role:"alertdialog"}}})}render(){const{continuous:t,index:e,isLastStep:n,setTooltipRef:s,size:a,step:r}=this.props,{beaconComponent:i,tooltipComponent:o,...l}=r;let u;if(o){const c={...this.getElementsProps(),continuous:t,index:e,isLastStep:n,size:a,step:l,setTooltipRef:s},d=o;u=B.createElement(d,{...c})}else u=B.createElement(A4,{...this.getElementsProps(),continuous:t,index:e,isLastStep:n,size:a,step:r});return u}},D4=class extends B.Component{constructor(){super(...arguments),ke(this,"scope",null),ke(this,"tooltip",null),ke(this,"handleClickHoverBeacon",t=>{const{step:e,store:n}=this.props;t.type==="mouseenter"&&e.event!=="hover"||n.update({lifecycle:$e.TOOLTIP})}),ke(this,"setTooltipRef",t=>{this.tooltip=t}),ke(this,"setPopper",(t,e)=>{var n;const{action:s,lifecycle:a,step:r,store:i}=this.props;e==="wrapper"?i.setPopper("beacon",t):i.setPopper("tooltip",t),i.getPopper("beacon")&&(i.getPopper("tooltip")||r.placement==="center")&&a===$e.INIT&&i.update({action:s,lifecycle:$e.READY}),(n=r.floaterProps)!=null&&n.getPopper&&r.floaterProps.getPopper(t,e)}),ke(this,"renderTooltip",t=>{const{continuous:e,helpers:n,index:s,size:a,step:r}=this.props;return B.createElement(O4,{continuous:e,helpers:n,index:s,isLastStep:s+1===a,setTooltipRef:this.setTooltipRef,size:a,step:r,...t})})}componentDidMount(){const{debug:t,index:e}=this.props;Co({title:`step:${e}`,data:[{key:"props",value:this.props}],debug:t})}componentDidUpdate(t){var e;const{action:n,callback:s,continuous:a,controlled:r,debug:i,helpers:o,index:l,lifecycle:u,shouldScroll:c,status:d,step:p,store:h}=this.props,{changed:f,changedFrom:m}=$m(t,this.props),y=o.info(),g=a&&n!==Ye.CLOSE&&(l>0||n===Ye.PREV),b=f("action")||f("index")||f("lifecycle")||f("status"),w=m("lifecycle",[$e.TOOLTIP,$e.INIT],$e.INIT),k=f("action",[Ye.NEXT,Ye.PREV,Ye.SKIP,Ye.CLOSE]),x=r&&l===t.index;if(k&&(w||x)&&s({...y,index:t.index,lifecycle:$e.COMPLETE,step:t.step,type:la.STEP_AFTER}),p.placement==="center"&&d===We.RUNNING&&f("index")&&n!==Ye.START&&u===$e.INIT&&h.update({lifecycle:$e.READY}),b){const S=fr(p.target),C=!!S;C&&r4(S)?(m("status",We.READY,We.RUNNING)||m("lifecycle",$e.INIT,$e.READY))&&s({...y,step:p,type:la.STEP_BEFORE}):(console.warn(C?"Target not visible":"Target not mounted",p),s({...y,type:la.TARGET_NOT_FOUND,step:p}),r||h.update({index:l+(n===Ye.PREV?-1:1)}))}m("lifecycle",$e.INIT,$e.READY)&&h.update({lifecycle:zN(p)||g?$e.TOOLTIP:$e.BEACON}),f("index")&&Co({title:`step:${u}`,data:[{key:"props",value:this.props}],debug:i}),f("lifecycle",$e.BEACON)&&s({...y,step:p,type:la.BEACON}),f("lifecycle",$e.TOOLTIP)&&(s({...y,step:p,type:la.TOOLTIP}),c&&this.tooltip&&(this.scope=new I4(this.tooltip,{selector:"[data-action=primary]"}),this.scope.setFocus())),m("lifecycle",[$e.TOOLTIP,$e.INIT],$e.INIT)&&((e=this.scope)==null||e.removeScope(),h.cleanupPoppers())}componentWillUnmount(){var t;(t=this.scope)==null||t.removeScope()}get open(){const{lifecycle:t,step:e}=this.props;return zN(e)||t===$e.TOOLTIP}render(){const{continuous:t,debug:e,index:n,nonce:s,shouldScroll:a,size:r,step:i}=this.props,o=fr(i.target);return!zE(i)||!ye.domElement(o)?null:B.createElement("div",{key:`JoyrideStep-${n}`,className:"react-joyride__step"},B.createElement(Kx,{...i.floaterProps,component:this.renderTooltip,debug:e,getPopper:this.setPopper,id:`react-joyride-step-${n}`,open:this.open,placement:i.placement,target:i.target},B.createElement(T4,{beaconComponent:i.beaconComponent,continuous:t,index:n,isLastStep:n+1===r,locale:i.locale,nonce:s,onClickOrHover:this.handleClickHoverBeacon,shouldFocus:a,size:r,step:i,styles:i.styles})))}},VE=class extends B.Component{constructor(t){super(t),ke(this,"helpers"),ke(this,"store"),ke(this,"callback",i=>{const{callback:o}=this.props;ye.function(o)&&o(i)}),ke(this,"handleKeyboard",i=>{const{index:o,lifecycle:l}=this.state,{steps:u}=this.props,c=u[o];l===$e.TOOLTIP&&i.code==="Escape"&&c&&!c.disableCloseOnEsc&&this.store.close("keyboard")}),ke(this,"handleClickOverlay",()=>{const{index:i}=this.state,{steps:o}=this.props;ul(this.props,o[i]).disableOverlayClose||this.helpers.close("overlay")}),ke(this,"syncState",i=>{this.setState(i)});const{debug:e,getHelpers:n,run:s=!0,stepIndex:a}=t;this.store=x4({...t,controlled:s&&ye.number(a)}),this.helpers=this.store.getHelpers();const{addListener:r}=this.store;Co({title:"init",data:[{key:"props",value:this.props},{key:"state",value:this.state}],debug:e}),r(this.syncState),n&&n(this.helpers),this.state=this.store.getState()}componentDidMount(){if(!qr())return;const{debug:t,disableCloseOnEsc:e,run:n,steps:s}=this.props,{start:a}=this.store;WN(s,t)&&n&&a(),e||document.body.addEventListener("keydown",this.handleKeyboard,{passive:!0})}componentDidUpdate(t,e){if(!qr())return;const{action:n,controlled:s,index:a,status:r}=this.state,{debug:i,run:o,stepIndex:l,steps:u}=this.props,{stepIndex:c,steps:d}=t,{reset:p,setSteps:h,start:f,stop:m,update:y}=this.store,{changed:g}=$m(t,this.props),{changed:b,changedFrom:w}=$m(e,this.state),k=ul(this.props,u[a]),x=!zn(d,u),S=ye.number(l)&&g("stepIndex"),C=fr(k.target);if(x&&(WN(u,i)?h(u):console.warn("Steps are not valid",u)),g("run")&&(o?f(l):m()),S){let R=ye.number(c)&&c<l?Ye.NEXT:Ye.PREV;n===Ye.STOP&&(R=Ye.START),[We.FINISHED,We.SKIPPED].includes(r)||y({action:n===Ye.CLOSE?Ye.CLOSE:R,index:l,lifecycle:$e.INIT})}!s&&r===We.RUNNING&&a===0&&!C&&(this.store.update({index:a+1}),this.callback({...this.state,type:la.TARGET_NOT_FOUND,step:k}));const T={...this.state,index:a,step:k};if(b("action",[Ye.NEXT,Ye.PREV,Ye.SKIP,Ye.CLOSE])&&b("status",We.PAUSED)){const R=ul(this.props,u[e.index]);this.callback({...T,index:e.index,lifecycle:$e.COMPLETE,step:R,type:la.STEP_AFTER})}if(b("status",[We.FINISHED,We.SKIPPED])){const R=ul(this.props,u[e.index]);s||this.callback({...T,index:e.index,lifecycle:$e.COMPLETE,step:R,type:la.STEP_AFTER}),this.callback({...T,type:la.TOUR_END,step:R,index:e.index}),p()}else w("status",[We.IDLE,We.READY],We.RUNNING)?this.callback({...T,type:la.TOUR_START}):(b("status")||b("action",Ye.RESET))&&this.callback({...T,type:la.TOUR_STATUS});this.scrollToStep(e)}componentWillUnmount(){const{disableCloseOnEsc:t}=this.props;t||document.body.removeEventListener("keydown",this.handleKeyboard)}scrollToStep(t){const{index:e,lifecycle:n,status:s}=this.state,{debug:a,disableScrollParentFix:r=!1,scrollDuration:i,scrollOffset:o=20,scrollToFirstStep:l=!1,steps:u}=this.props,c=ul(this.props,u[e]),d=fr(c.target),p=h4({isFirstStep:e===0,lifecycle:n,previousLifecycle:t.lifecycle,scrollToFirstStep:l,step:c,target:d});if(s===We.RUNNING&&p){const h=Eg(d,r),f=Pd(d,r);let m=Math.floor(o4(d,o,r))||0;Co({title:"scrollToStep",data:[{key:"index",value:e},{key:"lifecycle",value:n},{key:"status",value:s}],debug:a});const y=this.store.getPopper("beacon"),g=this.store.getPopper("tooltip");if(n===$e.BEACON&&y){const{offsets:b,placement:w}=y;!["bottom"].includes(w)&&!h&&(m=Math.floor(b.popper.top-o))}else if(n===$e.TOOLTIP&&g){const{flipped:b,offsets:w,placement:k}=g;["top","right","left"].includes(k)&&!b&&!h?m=Math.floor(w.popper.top-o):m-=c.spotlightPadding}m=m>=0?m:0,s===We.RUNNING&&l4(m,{element:f,duration:i}).then(()=>{setTimeout(()=>{var b;(b=this.store.getPopper("tooltip"))==null||b.instance.update()},10)})}}render(){if(!qr())return null;const{index:t,lifecycle:e,status:n}=this.state,{continuous:s=!1,debug:a=!1,nonce:r,scrollToFirstStep:i=!1,steps:o}=this.props,l=n===We.RUNNING,u={};if(l&&o[t]){const c=ul(this.props,o[t]);u.step=B.createElement(D4,{...this.state,callback:this.callback,continuous:s,debug:a,helpers:this.helpers,nonce:r,shouldScroll:!c.disableScrolling&&(t!==0||i),step:c,store:this.store}),u.overlay=B.createElement(C4,{id:"react-joyride-portal"},B.createElement(N4,{...c,continuous:s,debug:a,lifecycle:e,onClickOverlay:this.handleClickOverlay}))}return B.createElement("div",{className:"react-joyride"},u.step,u.overlay)}};ke(VE,"defaultProps",g4);var j4=VE;const _4=({mode:t,onModeChange:e,modelLoaded:n})=>N.jsxs("div",{className:"flex w-full gap-2",children:[N.jsxs("button",{onClick:()=>e("webcam"),disabled:!n,className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl transition-all ${t==="webcam"?"bg-primary-500 text-white shadow-lg":"bg-surface-100 text-surface-700 shadow-neu"} ${n?"":"opacity-50 cursor-not-allowed"}`,children:[N.jsx(nE,{size:20}),N.jsx("span",{children:"Webcam"})]}),N.jsxs("button",{id:"uploadImageBtn",onClick:()=>e("upload"),disabled:!n,className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl transition-all ${t==="upload"?"bg-primary-500 text-white shadow-lg":"bg-surface-100 text-surface-700 shadow-neu"} ${n?"":"opacity-50 cursor-not-allowed"}`,children:[N.jsx(Pw,{size:20}),N.jsx("span",{children:"Upload"})]})]});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F4=1e-7,P4=1e-4;class qx{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Rg{refCount(e){return Zn("refCount")}incRef(e){return Zn("incRef")}timerAvailable(){return!0}time(e){return Zn("time")}read(e){return Zn("read")}readSync(e){return Zn("readSync")}readToGPU(e,n){return Zn("readToGPU")}numDataIds(){return Zn("numDataIds")}disposeData(e,n){return Zn("disposeData")}write(e,n,s){return Zn("write")}move(e,n,s,a,r){return Zn("move")}createTensorFromGPUData(e,n,s){return Zn("createTensorFromGPUData")}memory(){return Zn("memory")}floatPrecision(){return Zn("floatPrecision")}epsilon(){return this.floatPrecision()===32?F4:P4}dispose(){return Zn("dispose")}}function Zn(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jx(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,cr(t,e,n)}function L4(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,s=0;for(;n>0;)s=Math.random()*n|0,n--,cr(t,n,s),cr(e,n,s)}function yi(t,e,n){return Math.max(t,Math.min(e,n))}function Ag(t){return t%2===0?t:t+1}function cr(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function WE(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function B4(t,e){const n=Math.random();return e*n+(1-n)*t}function z4(t,e){let n=0;for(let s=0;s<t.length;s++){const a=Number(t[s])-Number(e[s]);n+=a*a}return n}function I(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function pn(t,e,n=""){I(Le(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Ho(t){I(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function K(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function M4(t){return t.length===0}function UE(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function Le(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Io(t){return t%1===0}function V4(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function Om(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function W4(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return Jx(e),e}function mo(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Gw(t,e=a=>0,n,s){return new Promise((a,r)=>{let i=0;const o=()=>{if(t()){a();return}i++;const l=e(i);if(n!=null&&i>=n){r();return}s!=null?s(o,l):setTimeout(o,l)};o()})}function Xx(t,e){let n=1,s=-1;for(let r=0;r<t.length;++r)if(t[r]>=0)n*=t[r];else if(t[r]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${r}`);s=r}else if(t[r]<0)throw Error(`Shapes can not be < 0. Found ${t[r]} at dim ${r}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const a=t.slice();return a[s]=e/n,a}function Fe(t,e){const n=e.length;return t=t==null?e.map((s,a)=>a):[].concat(t),I(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),I(t.every(s=>Io(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function $r(t,e){const n=[],s=[],a=e!=null&&Array.isArray(e)&&e.length===0,r=e==null||a?null:Fe(e,t).sort();let i=0;for(let o=0;o<t.length;++o){if(r!=null){if(r[i]===o&&t[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${t[o]}' is not 1`);(r[i]==null||r[i]>o)&&t[o]===1&&(n.push(t[o]),s.push(o)),r[i]<=o&&i++}t[o]!==1&&(n.push(t[o]),s.push(o))}return{newShape:n,keptDims:s}}function en(t,e){return Tt(t,e)}function Tt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function GE(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function HE(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function Yx(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Ld(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function KE(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Ba(t){return typeof t=="string"||t instanceof String}function qE(t){return typeof t=="boolean"}function Dm(t){return typeof t=="number"}function Ko(t){return Array.isArray(t)?Ko(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Dm(t)?"float32":Ba(t)?"string":qE(t)?"bool":"float32"}function bi(t){return!!(t&&t.constructor&&t.call&&t.apply)}function jm(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function ve(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function JE(t,e,n,s=!1){const a=new Array;if(e.length===1){const r=e[0]*(s?2:1);for(let i=0;i<r;i++)a[i]=n[t+i]}else{const r=e[0],i=e.slice(1),o=i.reduce((l,u)=>l*u)*(s?2:1);for(let l=0;l<r;l++)a[l]=JE(t+l*o,i,n,s)}return a}function Cs(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((a,r)=>a*r)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return JE(0,t,e,n)}function XE(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function Og(t,e){const n=dn(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function dn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function Qx(t,e){const n=t.reduce((s,a)=>s*a,1);if(e==null||e==="float32")return Cs(t,new Float32Array(n));if(e==="int32")return Cs(t,new Int32Array(n));if(e==="bool")return Cs(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function ms(t){t.forEach(e=>{I(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function ma(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let a=0;a<t.length-1;++a)s+=n[a]*t[a];return s}function qo(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let a=0;a<s.length-1;++a)s[a]=Math.floor(t/n[a]),t-=s[a]*n[a];return s[s.length-1]=t,s}function wi(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GN="tfjsflags";class YE{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=U4,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(W().getBool("IS_TEST")||W().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const a=this.urlFlags[e];W().getBool("IS_TEST")||W().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${a}.`),this.set(e,a)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(wi(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);GN in e&&e[GN].split(",").forEach(s=>{const[a,r]=s.split(":");this.urlFlags[a]=H4(a,r)})}}function U4(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(G4(e,s[0],s[1]),s.join("="))),e}function G4(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function H4(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function W(){return Zx}let Zx=null;function K4(t){Zx=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Sb;function QE(){if(Sb==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");Sb=t}return Sb}function q4(){const t=QE();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function e1(t,e){const n=q4();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const yp="Abs",bu="Acos",wu="Acosh",Jo="Add",bp="AddN",Dg="All",jg="Any",wp="ArgMax",kp="ArgMin",ku="Asin",xu="Asinh",vu="Atan",Su="Atanh",Nu="Atan2",xp="AvgPool",_g="AvgPoolGrad",vp="AvgPool3D",Fg="AvgPool3DGrad",Sp="BatchMatMul",Np="BatchToSpaceND",Pg="Bincount",Cp="BitwiseAnd",ZE="BroadcastTo",Lg="BroadcastArgs",Cu="Cast",Iu="Ceil",Tu="ClipByValue",Bg="Complex",Ip="ComplexAbs",Tp="Concat",$p="Conv2D",zg="Conv2DBackpropFilter",Ep="Conv2DBackpropInput",Rp="Conv3D",Mg="Conv3DBackpropFilterV2",Vg="Conv3DBackpropInputV2",$u="Cos",Eu="Cosh",Wg="Cumprod",Ap="Cumsum",Ug="CropAndResize",Gg="DenseBincount",Hg="DepthToSpace",Op="DepthwiseConv2dNative",Kg="DepthwiseConv2dNativeBackpropFilter",qg="DepthwiseConv2dNativeBackpropInput",Jg="Diag",Dp="Dilation2D",_m="Dilation2DBackpropInput",Fm="Dilation2DBackpropFilter",Xg="Draw",Ru="RealDiv",Yg="Einsum",Au="Elu",Qg="EluGrad",Ou="Erf",jp="Equal",Du="Exp",_p="ExpandDims",ju="Expm1",Zg="FFT",ey="Fill",ty="FlipLeftRight",_u="Floor",Fu="FloorDiv",Fp="FusedBatchNorm",Pp="GatherV2",ny="GatherNd",Lp="Greater",Pu="GreaterEqual",Lu="Identity",sy="IFFT",ay="Imag",Bu="IsFinite",zu="IsInf",Mu="IsNan",Bp="LeakyRelu",zp="Less",Mp="LessEqual",ry="LinSpace",Vu="Log",Wu="Log1p",Vp="LogicalAnd",Wp="LogicalNot",Up="LogicalOr",J4="LogicalXor",eR="LogSoftmax",X4="LowerBound",Gp="LRN",iy="LRNGrad",Y4="MatrixBandPart",Hp="Max",Uu="Maximum",Kp="MaxPool",oy="MaxPoolGrad",qp="MaxPool3D",ly="MaxPool3DGrad",uy="MaxPoolWithArgmax",Jp="Mean",Xp="Min",Gu="Minimum",Yp="MirrorPad",Hu="Mod",cy="Multinomial",Ku="Multiply",Qp="Neg",Zp="NotEqual",dy="NonMaxSuppressionV3",py="NonMaxSuppressionV4",hy="NonMaxSuppressionV5",eh="OnesLike",th="OneHot",nh="Pack",sh="PadV2",Q4="Pool",qu="Pow",ah="Prelu",rh="Prod",fy="RaggedGather",my="RaggedRange",gy="RaggedTensorToTensor",yy="Range",by="Real",Ju="Reciprocal",Xu="Relu",ih="Reshape",oh="ResizeNearestNeighbor",wy="ResizeNearestNeighborGrad",lh="ResizeBilinear",ky="ResizeBilinearGrad",Yu="Relu6",uh="Reverse",Qu="Round",Zu="Rsqrt",xy="ScatterNd",vy="TensorScatterUpdate",Sy="SearchSorted",ch="Select",ec="Selu",dh="Slice",tc="Sin",nc="Sinh",sc="Sign",ac="Sigmoid",rc="Softplus",ic="Sqrt",ph="Sum",hh="SpaceToBatchND",fh="SplitV",mh="Softmax",Ny="SparseFillEmptyRows",Cy="SparseReshape",Iy="SparseSegmentMean",Ty="SparseSegmentSum",$y="SparseToDense",oc="SquaredDifference",Ey="Square",gh="StaticRegexReplace",Ry="StridedSlice",Ay="StringNGrams",Oy="StringSplit",Dy="StringToHashBucketFast",lc="Sub",uc="Tan",cc="Tanh",dc="Tile",jy="TopK",_y="Transform",go="Transpose",Fy="Unique",yh="Unpack",bh="UnsortedSegmentSum",Z4="UpperBound",wh="ZerosLike",pc="Step",Pm="FromPixels",Py="RotateWithOffset",Bd="_FusedMatMul",zd="FusedConv2D",Md="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ws(...t){W().getBool("IS_TEST")||W().getBool("PROD")||console.warn(...t)}function eV(...t){W().getBool("IS_TEST")||W().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yl=e1("kernelRegistry",()=>new Map),Vd=e1("gradRegistry",()=>new Map);function Wd(t,e){const n=t1(t,e);return Yl.get(n)}function Hw(t){return Vd.get(t)}function Lm(t){const e=Yl.entries(),n=[];for(;;){const{done:s,value:a}=e.next();if(s)break;const[r,i]=a,[o]=r.split("_");o===t&&n.push(i)}return n}function Ly(t){const{kernelName:e,backendName:n}=t,s=t1(e,n);Yl.has(s)&&ws(`The kernel '${e}' for backend '${n}' is already registered`),Yl.set(s,t)}function tR(t){const{kernelName:e}=t;Vd.has(e)&&W().getBool("DEBUG")&&ws(`Overriding the gradient for '${e}'`),Vd.set(e,t)}function tV(t,e){const n=t1(t,e);if(!Yl.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);Yl.delete(n)}function nV(t){if(!Vd.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);Vd.delete(t)}function sV(t,e){Lm(t).forEach(s=>{const a=Object.assign({},s,{backendName:e});Ly(a)})}function t1(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nR(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var sR=ct,Ms=null;try{Ms=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ct(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}ct.prototype.__isLong__;Object.defineProperty(ct.prototype,"__isLong__",{value:!0});function gs(t){return(t&&t.__isLong__)===!0}ct.isLong=gs;var HN={},KN={};function Xo(t,e){var n,s,a;return e?(t>>>=0,(a=0<=t&&t<256)&&(s=KN[t],s)?s:(n=dt(t,(t|0)<0?-1:0,!0),a&&(KN[t]=n),n)):(t|=0,(a=-128<=t&&t<128)&&(s=HN[t],s)?s:(n=dt(t,t<0?-1:0,!1),a&&(HN[t]=n),n))}ct.fromInt=Xo;function Vs(t,e){if(isNaN(t))return e?uo:Ws;if(e){if(t<0)return uo;if(t>=aR)return oR}else{if(t<=-JN)return os;if(t+1>=JN)return iR}return t<0?Vs(-t,e).neg():dt(t%Ql|0,t/Ql|0,e)}ct.fromNumber=Vs;function dt(t,e,n){return new ct(t,e,n)}ct.fromBits=dt;var Bm=Math.pow;function n1(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ws;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return n1(t.substring(1),e,n).neg();for(var a=Vs(Bm(n,8)),r=Ws,i=0;i<t.length;i+=8){var o=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+o),n);if(o<8){var u=Vs(Bm(n,o));r=r.mul(u).add(Vs(l))}else r=r.mul(a),r=r.add(Vs(l))}return r.unsigned=e,r}ct.fromString=n1;function Ca(t,e){return typeof t=="number"?Vs(t,e):typeof t=="string"?n1(t,e):dt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}ct.fromValue=Ca;var qN=65536,aV=1<<24,Ql=qN*qN,aR=Ql*Ql,JN=aR/2,XN=Xo(aV),Ws=Xo(0);ct.ZERO=Ws;var uo=Xo(0,!0);ct.UZERO=uo;var Il=Xo(1);ct.ONE=Il;var rR=Xo(1,!0);ct.UONE=rR;var Kw=Xo(-1);ct.NEG_ONE=Kw;var iR=dt(-1,2147483647,!1);ct.MAX_VALUE=iR;var oR=dt(-1,-1,!0);ct.MAX_UNSIGNED_VALUE=oR;var os=dt(0,-2147483648,!1);ct.MIN_VALUE=os;var ue=ct.prototype;ue.toInt=function(){return this.unsigned?this.low>>>0:this.low};ue.toNumber=function(){return this.unsigned?(this.high>>>0)*Ql+(this.low>>>0):this.high*Ql+(this.low>>>0)};ue.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(os)){var n=Vs(e),s=this.div(n),a=s.mul(n).sub(this);return s.toString(e)+a.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var r=Vs(Bm(e,6),this.unsigned),i=this,o="";;){var l=i.div(r),u=i.sub(l.mul(r)).toInt()>>>0,c=u.toString(e);if(i=l,i.isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}};ue.getHighBits=function(){return this.high};ue.getHighBitsUnsigned=function(){return this.high>>>0};ue.getLowBits=function(){return this.low};ue.getLowBitsUnsigned=function(){return this.low>>>0};ue.getNumBitsAbs=function(){if(this.isNegative())return this.eq(os)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ue.isZero=function(){return this.high===0&&this.low===0};ue.eqz=ue.isZero;ue.isNegative=function(){return!this.unsigned&&this.high<0};ue.isPositive=function(){return this.unsigned||this.high>=0};ue.isOdd=function(){return(this.low&1)===1};ue.isEven=function(){return(this.low&1)===0};ue.equals=function(e){return gs(e)||(e=Ca(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ue.eq=ue.equals;ue.notEquals=function(e){return!this.eq(e)};ue.neq=ue.notEquals;ue.ne=ue.notEquals;ue.lessThan=function(e){return this.comp(e)<0};ue.lt=ue.lessThan;ue.lessThanOrEqual=function(e){return this.comp(e)<=0};ue.lte=ue.lessThanOrEqual;ue.le=ue.lessThanOrEqual;ue.greaterThan=function(e){return this.comp(e)>0};ue.gt=ue.greaterThan;ue.greaterThanOrEqual=function(e){return this.comp(e)>=0};ue.gte=ue.greaterThanOrEqual;ue.ge=ue.greaterThanOrEqual;ue.compare=function(e){if(gs(e)||(e=Ca(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ue.comp=ue.compare;ue.negate=function(){return!this.unsigned&&this.eq(os)?os:this.not().add(Il)};ue.neg=ue.negate;ue.add=function(e){gs(e)||(e=Ca(e));var n=this.high>>>16,s=this.high&65535,a=this.low>>>16,r=this.low&65535,i=e.high>>>16,o=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,p=0,h=0;return h+=r+u,p+=h>>>16,h&=65535,p+=a+l,d+=p>>>16,p&=65535,d+=s+o,c+=d>>>16,d&=65535,c+=n+i,c&=65535,dt(p<<16|h,c<<16|d,this.unsigned)};ue.subtract=function(e){return gs(e)||(e=Ca(e)),this.add(e.neg())};ue.sub=ue.subtract;ue.multiply=function(e){if(this.isZero())return Ws;if(gs(e)||(e=Ca(e)),Ms){var n=Ms.mul(this.low,this.high,e.low,e.high);return dt(n,Ms.get_high(),this.unsigned)}if(e.isZero())return Ws;if(this.eq(os))return e.isOdd()?os:Ws;if(e.eq(os))return this.isOdd()?os:Ws;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(XN)&&e.lt(XN))return Vs(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,a=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,p=0,h=0,f=0;return f+=i*c,h+=f>>>16,f&=65535,h+=r*c,p+=h>>>16,h&=65535,h+=i*u,p+=h>>>16,h&=65535,p+=a*c,d+=p>>>16,p&=65535,p+=r*u,d+=p>>>16,p&=65535,p+=i*l,d+=p>>>16,p&=65535,d+=s*c+a*u+r*l+i*o,d&=65535,dt(h<<16|f,d<<16|p,this.unsigned)};ue.mul=ue.multiply;ue.divide=function(e){if(gs(e)||(e=Ca(e)),e.isZero())throw Error("division by zero");if(Ms){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Ms.div_u:Ms.div_s)(this.low,this.high,e.low,e.high);return dt(n,Ms.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?uo:Ws;var s,a,r;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return uo;if(e.gt(this.shru(1)))return rR;r=uo}else{if(this.eq(os)){if(e.eq(Il)||e.eq(Kw))return os;if(e.eq(os))return Il;var i=this.shr(1);return s=i.div(e).shl(1),s.eq(Ws)?e.isNegative()?Il:Kw:(a=this.sub(e.mul(s)),r=s.add(a.div(e)),r)}else if(e.eq(os))return this.unsigned?uo:Ws;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=Ws}for(a=this;a.gte(e);){s=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(s)/Math.LN2),l=o<=48?1:Bm(2,o-48),u=Vs(s),c=u.mul(e);c.isNegative()||c.gt(a);)s-=l,u=Vs(s,this.unsigned),c=u.mul(e);u.isZero()&&(u=Il),r=r.add(u),a=a.sub(c)}return r};ue.div=ue.divide;ue.modulo=function(e){if(gs(e)||(e=Ca(e)),Ms){var n=(this.unsigned?Ms.rem_u:Ms.rem_s)(this.low,this.high,e.low,e.high);return dt(n,Ms.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ue.mod=ue.modulo;ue.rem=ue.modulo;ue.not=function(){return dt(~this.low,~this.high,this.unsigned)};ue.and=function(e){return gs(e)||(e=Ca(e)),dt(this.low&e.low,this.high&e.high,this.unsigned)};ue.or=function(e){return gs(e)||(e=Ca(e)),dt(this.low|e.low,this.high|e.high,this.unsigned)};ue.xor=function(e){return gs(e)||(e=Ca(e)),dt(this.low^e.low,this.high^e.high,this.unsigned)};ue.shiftLeft=function(e){return gs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?dt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):dt(0,this.low<<e-32,this.unsigned)};ue.shl=ue.shiftLeft;ue.shiftRight=function(e){return gs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?dt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):dt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ue.shr=ue.shiftRight;ue.shiftRightUnsigned=function(e){if(gs(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return dt(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?dt(n,0,this.unsigned):dt(n>>>e-32,0,this.unsigned)};ue.shru=ue.shiftRightUnsigned;ue.shr_u=ue.shiftRightUnsigned;ue.toSigned=function(){return this.unsigned?dt(this.low,this.high,!1):this};ue.toUnsigned=function(){return this.unsigned?this:dt(this.low,this.high,!0)};ue.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ue.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ue.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};ct.fromBytes=function(e,n,s){return s?ct.fromBytesLE(e,n):ct.fromBytesBE(e,n)};ct.fromBytesLE=function(e,n){return new ct(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};ct.fromBytesBE=function(e,n){return new ct(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const lR=Ei(sR),rV=RI({__proto__:null,default:lR},[sR]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eo=lR||rV;function kh(t){return eo.fromString(t,!0,16)}const uR=kh("c3a5c85c97cb3127"),Qi=kh("b492b66fbe98f273"),An=kh("9ae16a3b2f90404f");function qw(t){return t.xor(t.shru(47))}function cR(t,e,n){const s=t.slice(e,e+n);return eo.fromBytes(Array.from(s),!0,!0)}function it(t,e){return cR(t,e,8)}function YN(t,e){return cR(t,e,4)}function Xt(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function ci(t,e,n=kh("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let a=e.xor(s).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function iV(t,e,n,s,a,r){a=a.add(t),r=Xt(r.add(a).add(s),21);const i=a;return a=a.add(e),a=a.add(n),r=r.add(Xt(a,44)),[a.add(s),r.add(i)]}function Sf(t,e,n,s){return iV(it(t,e),it(t,e+8),it(t,e+16),it(t,e+24),n,s)}function oV(t,e=t.length){if(e>=8){const n=An.add(e*2),s=it(t,0).add(An),a=it(t,e-8),r=Xt(a,37).mul(n).add(s),i=Xt(s,25).add(a).mul(n);return ci(r,i,n)}if(e>=4){const n=An.add(e*2),s=YN(t,0);return ci(s.shl(3).add(e),YN(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],a=t[e-1],r=n+(s<<8),i=e+(a<<2);return qw(An.mul(r).xor(uR.mul(i))).mul(An)}return An}function lV(t,e=t.length){const n=An.add(e*2),s=it(t,0).mul(Qi),a=it(t,8),r=it(t,e-8).mul(n),i=it(t,e-16).mul(An);return ci(Xt(s.add(a),43).add(Xt(r,30)).add(i),s.add(Xt(a.add(An),18)).add(r),n)}function uV(t,e=t.length){const n=An.add(e*2),s=it(t,0).mul(An),a=it(t,8),r=it(t,e-8).mul(n),i=it(t,e-16).mul(An),o=Xt(s.add(a),43).add(Xt(r,30)).add(i),l=ci(o,s.add(Xt(a.add(An),18)).add(r),n),u=it(t,16).mul(n),c=it(t,24),d=o.add(it(t,e-32)).mul(n),p=l.add(it(t,e-24)).mul(n);return ci(Xt(u.add(c),43).add(Xt(d,30)).add(p),u.add(Xt(c.add(s),18)).add(d),n)}function dR(t,e=t.length){const n=eo.fromNumber(81,!0);if(e<=32)return e<=16?oV(t,e):lV(t,e);if(e<=64)return uV(t,e);let s=n,a=n.mul(Qi).add(113),r=qw(a.mul(An).add(113)).mul(An),i=[eo.UZERO,eo.UZERO],o=[eo.UZERO,eo.UZERO];s=s.mul(An).add(it(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do s=Xt(s.add(a).add(i[0]).add(it(t,l+8)),37).mul(Qi),a=Xt(a.add(i[1]).add(it(t,l+48)),42).mul(Qi),s=s.xor(o[1]),a=a.add(i[0]).add(it(t,l+40)),r=Xt(r.add(o[0]),33).mul(Qi),i=Sf(t,l,i[1].mul(Qi),s.add(o[0])),o=Sf(t,l+32,r.add(o[1]),a.add(it(t,l+16))),[r,s]=[s,r],l+=64;while(l!==u);const d=Qi.add(r.and(255).shl(1));return l=c,o[0]=o[0].add(e-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),s=Xt(s.add(a).add(i[0]).add(it(t,l+8)),37).mul(d),a=Xt(a.add(i[1]).add(it(t,l+48)),42).mul(d),s=s.xor(o[1].mul(9)),a=a.add(i[0].mul(9).add(it(t,l+40))),r=Xt(r.add(o[0]),33).mul(d),i=Sf(t,l,i[1].mul(d),s.add(o[0])),o=Sf(t,l+32,r.add(o[1]),a.add(it(t,l+16))),[r,s]=[s,r],ci(ci(i[0],o[0],d).add(qw(a).mul(uR)).add(r),ci(i[1],o[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Er(t,e){return e==="string"?Wa(t):_i([t],e)}function cV(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function _i(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=qa(t)),W().getBool("DEBUG")&&GE(t,e),cV(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function $n(){return W().platform.now()}function dV(t,e){return W().platform.fetch(t,e)}function Wa(t,e="utf-8"){return e=e||"utf-8",W().platform.encode(t,e)}function xr(t,e="utf-8"){return e=e||"utf-8",W().platform.decode(t,e)}function Yt(t){return W().platform.isTypedArray!=null?W().platform.isTypedArray(t):nR(t)}function qa(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||wi(t)||t==null||Yt(t)&&n)e.push(t);else if(Array.isArray(t)||Yt(t))for(let s=0;s<t.length;++s)qa(t[s],e,n);else{let s=-1;for(const a of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(a)&&(s=Math.max(s,Number(a)));for(let a=0;a<=s;a++)qa(t[a],e,n)}return e}const pV=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Le,arraysEqualWithNull:UE,assert:I,assertNonNegativeIntegerDimensions:ms,assertNonNull:Ho,assertShapesMatch:pn,bytesFromStringArray:KE,bytesPerElement:Ld,checkConversionForErrors:GE,clamp:yi,computeStrides:ve,convertBackendValuesAndArrayBuffer:XE,createScalarValue:Er,createShuffledIndices:W4,decodeString:xr,distSquared:z4,encodeString:Wa,fetch:dV,fingerPrint64:dR,flatten:qa,getArrayFromDType:Tt,getTypedArrayFromDType:en,hasEncodingLoss:Yx,hexToLong:kh,indexToLoc:qo,inferDtype:Ko,inferFromImplicitShape:Xx,isBoolean:qE,isFunction:bi,isInt:Io,isNumber:Dm,isPromise:wi,isScalarShape:M4,isString:Ba,isTypedArray:Yt,isValidDtype:HE,locToIndex:ma,makeOnesTypedArray:Og,makeZerosNestedTypedArray:Qx,makeZerosTypedArray:dn,nearestDivisor:jm,nearestLargerEven:Ag,now:$n,parseAxisParam:Fe,randUniform:B4,repeatedTry:Gw,rightPad:mo,shuffle:Jx,shuffleCombo:L4,sizeFromShape:K,sizeToSquarishShape:Om,squeezeShape:$r,sum:WE,swap:cr,tanh:V4,toNestedArray:Cs,toTypedArray:_i},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hV{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new mV)}profileKernel(e,n,s){let a;const r=()=>{a=s()};let i;const o=$n();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(r);else{r();for(const u of a)u.dataSync();i=Promise.resolve({kernelMs:$n()-o})}if(W().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<a.length;u++){const c=a[u];c.data().then(d=>{fV(d,c.dtype,e)})}return{kernelName:e,outputs:a,inputs:n,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:a,inputs:r,extraInfo:i}=e;s.forEach(o=>{Promise.all([o.data(),a,i]).then(l=>{this.logger.logKernelProfile(n,o,l[0],l[1],r,l[2])})})}}function fV(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const a=t[s];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${n}'`),!0}return!1}class mV{logKernelProfile(e,n,s,a,r,i){const o=typeof a=="number"?mo(`${a}ms`,9):a.error,l=mo(e,25),u=n.rank,c=n.size,d=mo(n.shape.toString(),14);let p="";for(const h in r){const f=r[h];if(f!=null){const m=f.shape||n.shape,y=m.length;p+=`${h}: ${y}D ${y>0?m:""} `}}console.log(`%c${l}	%c${o}	%c${u}D ${d}	%c${c}	%c${p}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gV(t,e,n){const s={},a={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const p=c[d];let h=!1;for(let f=0;f<e.length;f++)if(s[p.id]){u.outputs.forEach(m=>s[m.id]=!0),h=!0,a[u.id]=!0;break}if(h)break}}const r={};r[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(r[u.outputs[d].id]){for(const p in c)r[c[p].id]=!0,i[u.id]=!0;break}}const o=[];for(let l=0;l<t.length;l++){const u=t[l];if(a[u.id]&&i[u.id]){const c={};for(const p in u.inputs){const h=u.inputs[p];s[h.id]&&(c[p]=h)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,o.push(d)}}return o}function yV(t,e,n,s){for(let a=e.length-1;a>=0;a--){const r=e[a],i=[];if(r.outputs.forEach(l=>{const u=t[l.id];u!=null?i.push(u):i.push(null)}),r.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${r.kernelName}.`);const o=r.gradient(i);for(const l in r.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const u=n(()=>o[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=r.inputs[l];if(!Le(u.shape,c.shape))throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=s(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QN=20,Wc=3,Nb=7;function bV(t,e,n,s){const a=ve(e),r=wV(t,e,n,a),i=e.length,o=Qf(t,e,n,a,r),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(u=>"    "+u).join(`
`)),l.join(`
`)}function wV(t,e,n,s){const a=K(e),r=s[s.length-1],i=new Array(r).fill(0),o=e.length,l=n==="complex64"?Qc(t):t;if(o>1)for(let u=0;u<a/r;u++){const c=u*r;for(let d=0;d<r;d++)i[d]=Math.max(i[d],Yc(l[c+d],0,n).length)}return i}function Yc(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(Nb))} + ${parseFloat(t[1].toFixed(Nb))}j`:Ba(t)?s=`'${t}'`:n==="bool"?s=pR(t):s=parseFloat(t.toFixed(Nb)).toString(),mo(s,e)}function pR(t){return t===0?"false":"true"}function Qf(t,e,n,s,a,r=!0){const i=n==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=Qc(t);return[Yc(m[0],0,n)]}return n==="bool"?[pR(t[0])]:[t[0].toString()]}if(l===1){if(o>QN){const y=Wc*i;let g=Array.from(t.slice(0,y)),b=Array.from(t.slice((o-Wc)*i,o*i));return n==="complex64"&&(g=Qc(g),b=Qc(b)),["["+g.map((w,k)=>Yc(w,a[k],n)).join(", ")+", ..., "+b.map((w,k)=>Yc(w,a[o-Wc+k],n)).join(", ")+"]"]}return["["+(n==="complex64"?Qc(t):Array.from(t)).map((y,g)=>Yc(y,a[g],n)).join(", ")+"]"]}const u=e.slice(1),c=s.slice(1),d=s[0]*i,p=[];if(o>QN){for(let m=0;m<Wc;m++){const y=m*d,g=y+d;p.push(...Qf(t.slice(y,g),u,n,c,a,!1))}p.push("...");for(let m=o-Wc;m<o;m++){const y=m*d,g=y+d;p.push(...Qf(t.slice(y,g),u,n,c,a,m===o-1))}}else for(let m=0;m<o;m++){const y=m*d,g=y+d;p.push(...Qf(t.slice(y,g),u,n,c,a,m===o-1))}const h=l===2?",":"";p[0]="["+(o>0?p[0]+h:"");for(let m=1;m<p.length-1;m++)p[m]=" "+p[m]+h;let f=`,
`;for(let m=2;m<l;m++)f+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(r?"":f),p}function Qc(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bt{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=K(e),s!=null){const a=s.length;I(a===this.size,()=>`Length of values '${a}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Tt(n,this.size),this.strides=ve(e)}set(e,...n){n.length===0&&(n=[0]),I(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const a of e){if(a<0||a>=this.shape[n]){const r=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(r)}n++}let s=e[e.length-1];for(let a=0;a<e.length-1;++a)s+=this.strides[a]*e[a];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return ua().makeTensor(this.values,this.shape,this.dtype)}}let ua=null,pl=null;function kV(t){ua=t}function xV(t){pl=t}class qe{constructor(e,n,s,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=K(e),this.strides=ve(e),this.dataId=s,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return pl.buffer(this.shape,this.dtype,e)}bufferSync(){return pl.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Cs(this.shape,e,this.dtype==="complex64")}arraySync(){return Cs(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=ua().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>xr(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),ua().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=ua().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>xr(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await ua().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),ua().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return pl.print(this,e)}clone(){return this.throwIfDisposed(),pl.clone(this)}toString(e=!1){const n=this.dataSync();return bV(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),pl.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),ua().makeVariable(this,e,n,s)}}Object.defineProperty(qe,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function J(){return e1("Tensor",()=>qe)}J();class Ud extends qe{constructor(e,n,s,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Le(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);ua().disposeTensor(this),this.dataId=e.dataId,ua().incRef(this,null)}dispose(){ua().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Ud,Symbol.hasInstance,{value:t=>t instanceof qe&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Jw;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(Jw||(Jw={}));var Xw;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Xw||(Xw={}));var Yw;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Yw||(Yw={}));var Qw;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Qw||(Qw={}));var Zw;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Zw||(Zw={}));const vV={float32:Qw,int32:Xw,bool:Yw,complex64:Zw};function Un(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return vV[t][e]}function By(t){return Un(t,"int32")}function hR(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function fR(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function St(t,e){if(t.dtype===e.dtype)return[t,e];const n=Un(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function mR(t,e){I(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function SV(t,e){return e.some(n=>n.id===t.id)}function s1(t){const e=[];return gR(t,e,new Set),e}function gR(t,e,n){if(t==null)return;if(t instanceof qe){e.push(t);return}if(!NV(t))return;const s=t;for(const a in s){const r=s[a];n.has(r)||(n.add(r),gR(r,e,n))}}function NV(t){return Array.isArray(t)||typeof t=="object"}const CV=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:mR,getTensorsInContainer:s1,isTensorInList:SV,makeTypesMatch:St},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cb(t){return t.kernelName!=null}class ZN{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Zl{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new ZN}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(ws(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new hV(this.backendInstance),!0}setupRegisteredKernels(){Lm(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Lm(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof Rg)&&typeof s.then=="function"){const a=++this.pendingBackendInitId,r=s.then(i=>a<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,ws(`Initialization of backend ${e} failed`),ws(i.stack||i.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return ws(`Initialization of backend ${e} failed`),ws(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:a,asyncInit:r}=this.initializeBackend(s);if(r||a)return{name:s,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),a=s.backend,r=this.readSync(n),i=a.refCount(n);a.disposeData(n,!0),s.backend=e,e.move(n,r,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let a;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(a),()=>(a=n(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(e,n,s){e();try{const a=s();return n(),a}catch(a){throw n(),a}}nextTensorId(){return Zl.nextTensorId++}nextVariableId(){return Zl.nextVariableId++}clone(e){const n=A.runKernel(Lu,{x:e}),s={x:e},a=i=>({x:()=>{const o="float32",l={x:i},u={dtype:o};return A.runKernel(Cu,l,u)}}),r=[];return this.addTapeNode(this.state.activeScope.name,s,[n],a,r,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(Wd(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const a=this.backend.numDataIds();let r=0;s.forEach(l=>{r+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=a-n-r-i;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const a=this.isTapeOn(),r=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const u=Cb(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Cb(e)){const{kernelName:f,inputs:m,attrs:y}=e;this.backendName==null&&this.backend;const g=Wd(f,this.backendName);I(g!=null,()=>`Cannot find registered kernel '${f}' for backend '${this.backendName}'`),o=()=>{const b=this.backend.numDataIds();l=g.kernelFunc({inputs:m,attrs:y,backend:this.backend});const w=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(f,b,w);const k=w.map(x=>x.rank!=null?x:this.makeTensorFromTensorInfo(x));if(a){const x=this.getTensorsForGradient(f,m,k);s=this.saveTensorsForBackwardMode(x)}return k}}else{const{forwardFunc:f}=e,m=y=>{a&&(s=y.map(g=>this.keep(this.clone(g))))};o=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>f(this.backend,m));const g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,y,g),g}}const{inputs:c,attrs:d}=e,p=Cb(e)?null:e.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=o():(h=this.profiler.profileKernel(u,c,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),a&&this.addTapeNode(u,c,n,p,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-r,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(f=>c[f]!=null?c[f].shape:null),outputShapes:n.map(f=>f.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const a=Hw(e);if(a!=null){const r=a.inputsToSave||[],i=a.outputsToSave||[];let o;a.saveAllInputs?(I(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(n).map(u=>n[u])):o=r.map(u=>n[u]);const l=s.filter((u,c)=>i[c]);return o.concat(l)}return[]}makeTensor(e,n,s,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",a=a||this.backend;let r=e;s==="string"&&Ba(e[0])&&(r=e.map(l=>Wa(l)));const i=a.write(r,n,s),o=new qe(n,s,i,this.nextTensorId());if(this.trackTensor(o,a),s==="string"){const l=this.state.tensorInfo.get(i),u=KE(r);this.state.numBytes+=u-l.bytes,l.bytes=u}return o}makeTensorFromDataId(e,n,s,a){s=s||"float32";const r={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(r,a)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:a,dtype:r}=e,i=new qe(a,r,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,s,a){s=s||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.cast(a));const r=new Ud(e,n,s,this.nextTensorId());if(this.state.registeredVariables[r.name]!=null)throw new Error(`Variable with name ${r.name} was already registered`);return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*Ld(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof Ud||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*Ld(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,a,r,i){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:r},l=Hw(e);l!=null&&(a=l.gradFunc),a!=null&&(o.gradient=u=>(u=u.map((c,d)=>{if(c==null){const p=s[d],h=dn(p.size,p.dtype);return this.makeTensor(h,p.shape,p.dtype)}return c}),a(u.length>1?u:u[0],r,i))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=s1(e),s=new Set(n.map(r=>r.id));for(let r=0;r<this.state.activeScope.track.length;r++){const i=this.state.activeScope.track[r];!i.kept&&!s.has(i.id)&&i.dispose()}const a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(r=>{!r.kept&&r.scopeId===a.id&&this.track(r)})}gradients(e,n,s,a=!1){if(I(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const r=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));I(r instanceof qe,()=>"The result y returned by f() must be a tensor.");const i=gV(this.state.activeTape,n,r);if(!a&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[r.id]=s??IV(r.shape),yV(o,i,u=>this.tidy(u),TV);const l=n.map(u=>o[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:r,grads:l}})}customGrad(e){return I(bi(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{I(n.every(o=>o instanceof qe),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const a={};n.forEach((o,l)=>{a[l]=o});const r=(o,l)=>(s=e(...n,l),I(s.value instanceof qe,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),I(bi(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(o,l)=>{const u=s.gradFunc(o,l),c=Array.isArray(u)?u:[u];I(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),I(c.every(p=>p instanceof qe),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((p,h)=>{d[h]=()=>p}),d};return this.runKernelFunc({forwardFunc:r,backwardsFunc:i,inputs:a})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=$n(),s=await this.backend.time(e);return s.wallMs=$n()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new ZN;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Zl.nextTensorId=0;Zl.nextVariableId=0;function IV(t){const e=Og(K(t),"float32");return A.makeTensor(e,t,"float32")}function yR(){const t=QE();if(t._tfengine==null){const e=new YE(t);t._tfengine=new Zl(e)}return K4(t._tfengine.ENV),kV(()=>t._tfengine),t._tfengine}const A=yR();function TV(t,e){const n={a:t,b:e};return A.runKernel(Jo,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $V(){return typeof navigator<"u"&&navigator!=null}let ek;function EV(t){ek=t}function a1(t){if(ek!==void 0)return ek;if(t||$V()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function r1(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const RV=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:r1,isMobile:a1,mockIsMobile:EV},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gn=W();Gn.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Gn.registerFlag("IS_BROWSER",()=>r1());Gn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Gn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Gn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Gn.registerFlag("PROD",()=>!1);Gn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Gn.getBool("DEBUG"));Gn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Gn.registerFlag("IS_TEST",()=>!1);Gn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Gn.getBool("DEBUG"));Gn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Gn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Gn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ja(t,e){let n=t;if(Yt(t))return e==="string"?[]:[t.length];if(hR(t)){const a=t.channels||"RGBA";return[t.height,t.width*a.length]}else if(fR(t))return[t.buffer.size/(e==null?4:Ld(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||Yt(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&W().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&bR(t,s,[]),s}function bR(t,e,n){if(n=n||[],!Array.isArray(t)&&!Yt(t)){I(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}I(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),I(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let a=0;a<t.length;++a)bR(t[a],s,n.concat(a))}function eC(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function $(t,e,n,s="numeric"){if(t instanceof J())return eC(s,t.dtype,e,n),t;let a=Ko(t);if(a!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(a=s),eC(s,a,e,n),t==null||!Yt(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const r=Ja(t,a);!Yt(t)&&!Array.isArray(t)&&(t=[t]);const o=a!=="string"?_i(t,a):qa(t,[],!0);return A.makeTensor(o,r,a)}function Gd(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((r,i)=>$(r,`${e}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i1="__op";function O(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+i1;const a=(...r)=>{A.startScope(n);try{const i=s(...r);return wi(i)&&console.error("Cannot return a Promise inside of tidy."),A.endScope(i),i}catch(i){throw A.endScope(null),i}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AV(t,e){const n=$(t,"real","complex"),s=$(e,"imag","complex");pn(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const a={real:n,imag:s};return A.runKernel(Bg,a)}const vr=O({complex_:AV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fi(t,e,n,s){if(s==null)s=Ko(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(fR(t)||hR(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return A.backend.createTensorFromGPUData(t,e||n,s)}if(!Yt(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ms(e);const a=K(e),r=K(n);I(a===r,()=>`Based on the provided shape, [${e}], the tensor should have ${a} values but has ${r}`);for(let i=0;i<n.length;++i){const o=n[i],l=i===n.length-1?o!==K(e.slice(i)):!0;I(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Yt(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?_i(t,s):qa(t,[],!0),A.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ks(t,e,n){const s=Ja(t,n);return Fi(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const To={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Ia{static join(e){return new Ia(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>Yt(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const a=e[s];s!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const r=n+a.byteLength;this.shards.push({buffer:a,start:n,end:r}),n=r}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const a=n-e,r=new ArrayBuffer(a),i=new Uint8Array(r);let o=0;for(let l=s;l<this.shards.length;l++){const u=this.shards[l],d=e+o-u.start,p=o,f=Math.min(n,u.end)-u.start,m=new Uint8Array(u.buffer,d,f-d);if(i.set(m,p),o+=m.length,n<u.end)break}return r}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(a){return e<a.start?-1:e>=a.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=OV(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function OV(t,e){let n=0,s=t.length;for(;n<=s;){const a=Math.floor((s-n)/2)+n,r=e(t[a]);if(r===0)return a;r<0?s=a:n=a+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DV(){W().set("PROD",!0)}function jV(){W().set("DEBUG",!0)}function _V(){W().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function FV(t){W().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function PV(){A.disposeVariables()}function ra(){return A}function tk(){return A.memory()}function LV(t){return A.profile(t)}function M(t,e){return A.tidy(t,e)}function _e(t){s1(t).forEach(n=>n.dispose())}function Vt(t){return A.keep(t)}function BV(t){return A.time(t)}function zV(t){return A.setBackend(t)}function wR(){return A.ready()}function kR(){return A.backendName}function MV(t){A.removeBackend(t)}function VV(t){return A.findBackend(t)}function WV(t){return A.findBackendFactory(t)}function o1(t,e,n=1){return A.registerBackend(t,e,n)}function l1(){return A.backend}function UV(t,e){W().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ki=4;async function nk(t,e){const n=[],s=[],a=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<a.length;++i){const o=a[i],l=Array.isArray(t)?t[i].tensor:t[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const u={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const p=await l.bytes(),h=p.reduce((y,g)=>y+g.length,0)+ki*p.length,f=new Uint8Array(h);let m=0;for(let y=0;y<p.length;y++){const g=p[y],b=new Uint8Array(new Uint32Array([g.length]).buffer);f.set(b,m),m+=ki,f.set(g,m),m+=g.length}d(f)});s.push(c)}else s.push(l.data());e!=null&&(u.group=e),n.push(u)}const r=await Promise.all(s);return{data:KV(r),specs:n}}function xR(t,e){const n=new Ia(t),s={};let a=0;for(const r of e){const i=GV(r,(o,l)=>n.slice(a+o,a+l));s[r.name]=vR(r,n.slice(a,a+i)),a+=i}return s}function GV(t,e){const n=K(t.shape);let s;if("quantization"in t){const a=t.quantization;s=To[a.dtype]}else if(t.dtype==="string"){let a=0;for(let r=0;r<n;r++)a+=ki+new Uint32Array(e(a,a+ki))[0];return a}else s=To[t.dtype];return n*s}async function HV(t,e){const n=K(t.shape);let s;if("quantization"in t){const a=t.quantization;s=To[a.dtype]}else if(t.dtype==="string"){let a=0;for(let r=0;r<n;r++)a+=ki+new Uint32Array(await e(a,a+ki))[0];return a}else s=To[t.dtype];return n*s}function vR(t,e){const n=t.name,s=t.dtype,a=t.shape,r=K(a);let i,o=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=To[l.dtype],c=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(c.length);for(let d=0;d<c.length;d++){const p=c[d];i[d]=p*l.scale+l.min}}else if(l.dtype==="float16")i=ZV()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(c.length);for(let d=0;d<c.length;d++){const p=c[d];i[d]=Math.round(p*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);o+=r*u}else if(s==="string"){const l=K(t.shape);i=[];for(let u=0;u<l;u++){const c=new Uint32Array(e.slice(o,o+ki))[0];o+=ki;const d=new Uint8Array(e.slice(o,o+c));i.push(d),o+=c}}else{const l=To[s];if(s==="float32")i=new Float32Array(e);else if(s==="int32")i=new Int32Array(e);else if(s==="bool")i=new Uint8Array(e);else if(s==="complex64"){i=new Float32Array(e);const u=new Float32Array(i.length/2),c=new Float32Array(i.length/2);for(let f=0;f<u.length;f++)u[f]=i[f*2],c[f]=i[f*2+1];const d=Ks(u,a,"float32"),p=Ks(c,a,"float32"),h=vr(d,p);return d.dispose(),p.dispose(),h}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);o+=r*l}return Ks(i,a,s)}async function tC(t,e,n){let s=new Uint8Array(e);for(;s.byteLength<n;){const{done:a,value:r}=await t.read();if(a&&r==null){const o=n-s.byteLength;throw new Error(`Reader is done but ${o} bytes are still expected`)}const i=new Uint8Array(s.length+r.byteLength);i.set(s,0),i.set(new Uint8Array(r),s.length),s=i}return s.buffer}async function SR(t,e){const n={},s=t.getReader();let a=new ArrayBuffer(0);for(const r of e){const i=await HV(r,async(u,c)=>(a=await tC(s,a,c),a.slice(u,c)));a=await tC(s,a,i);const o=a.slice(0,i);a=a.slice(i);const l=vR(r,o);if(n[r.name]=l,kR()==="webgpu"){const u=l1();"uploadToGPU"in u&&K(l.shape)>=W().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function KV(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(r=>{if(e+=r.byteLength,n.push(r.byteLength===r.buffer.byteLength?r:new r.constructor(r)),!(r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${r.constructor.name}`)});const s=new Uint8Array(e);let a=0;return n.forEach(r=>{s.set(new Uint8Array(r.buffer),a),a+=r.byteLength}),s.buffer}const u1=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function nC(t){return u1?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function qV(t){if(u1)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,a=e.length;s<a;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function JV(t){if(u1){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function NR(t){return Ia.join(t)}function sC(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function CR(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function c1(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function d1(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),c1(t,n,s)}function xh(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:nC(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:nC(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Ia(t.weightData).byteLength}}function zm(t){const e=[];for(const n of t)e.push(...n.weights);return e}function XV(){const t=n=>{let s=n<<13,a=0;for(;!(s&8388608);)a-=8388608,s<<=1;return s&=-8388609,a+=947912704,s|a},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function YV(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function QV(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function ZV(){const t=XV(),e=YV(),n=QV();return s=>{const a=new ArrayBuffer(4*s.length),r=new Uint32Array(a);for(let i=0;i<s.length;i++){const o=s[i],l=t[n[o>>10]+(o&1023)]+e[o>>10];r[i]=l}return new Float32Array(a)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return wt.instance==null&&(wt.instance=new wt),wt.instance}static registerSaveRouter(e){wt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){wt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return wt.getHandlers(e,"save")}static getLoadHandlers(e,n){return wt.getHandlers(e,"load",n)}static getHandlers(e,n,s){const a=[];return(n==="load"?wt.getInstance().loadRouters:wt.getInstance().saveRouters).forEach(i=>{const o=i(e,s);o!==null&&a.push(o)}),a}}const eW=t=>wt.registerSaveRouter(t),tW=t=>wt.registerLoadRouter(t),IR=t=>wt.getSaveHandlers(t),nW=(t,e)=>wt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sk="tensorflowjs",ak=1,co="models_store",Qr="model_info_store";function TR(){if(!W().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function rk(t){const e=t.result;e.createObjectStore(co,{keyPath:"modelPath"}),e.createObjectStore(Qr,{keyPath:"modelPath"})}class $o{constructor(e){if(this.indexedDB=TR(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,a)=>{const r=this.indexedDB.open(sk,ak);r.onupgradeneeded=()=>rk(r),r.onsuccess=()=>{const i=r.result;if(n==null){const o=i.transaction(co,"readonly"),u=o.objectStore(co).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),a(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=c=>(i.close(),a(u.error)),o.oncomplete=()=>i.close()}else{n.weightData=Ia.join(n.weightData);const o=xh(n),l=i.transaction(Qr,"readwrite");let u=l.objectStore(Qr),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(p){return a(p)}let d;c.onsuccess=()=>{d=i.transaction(co,"readwrite");const p=d.objectStore(co);let h;try{h=p.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:o})}catch(f){return a(f)}h.onsuccess=()=>s({modelArtifactsInfo:o}),h.onerror=f=>{u=l.objectStore(Qr);const m=u.delete(this.modelPath);m.onsuccess=()=>(i.close(),a(h.error)),m.onerror=y=>(i.close(),a(h.error))}},c.onerror=p=>(i.close(),a(c.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},r.onerror=i=>a(r.error)})}}$o.URL_SCHEME="indexeddb://";const $R=t=>W().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith($o.URL_SCHEME)?sW(t.slice($o.URL_SCHEME.length)):null;wt.registerSaveRouter($R);wt.registerLoadRouter($R);function sW(t){return new $o(t)}function aW(t){return t.startsWith($o.URL_SCHEME)?t.slice($o.URL_SCHEME.length):t}class rW{constructor(){this.indexedDB=TR()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(sk,ak);s.onupgradeneeded=()=>rk(s),s.onsuccess=()=>{const a=s.result,r=a.transaction(Qr,"readonly"),o=r.objectStore(Qr).getAll();o.onsuccess=()=>{const l={};for(const u of o.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},o.onerror=l=>(a.close(),n(o.error)),r.oncomplete=()=>a.close()},s.onerror=a=>n(s.error)})}async removeModel(e){return e=aW(e),new Promise((n,s)=>{const a=this.indexedDB.open(sk,ak);a.onupgradeneeded=()=>rk(a),a.onsuccess=()=>{const r=a.result,i=r.transaction(Qr,"readwrite"),o=i.objectStore(Qr),l=o.get(e);let u;l.onsuccess=()=>{if(l.result==null)return r.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=o.delete(e),d=()=>{u=r.transaction(co,"readwrite");const h=u.objectStore(co).delete(e);h.onsuccess=()=>n(l.result.modelArtifactsInfo),h.onerror=f=>s(l.error)};c.onsuccess=d,c.onerror=p=>(d(),r.close(),s(l.error))}},l.onerror=c=>(r.close(),s(l.error)),i.oncomplete=()=>{u==null?r.close():u.oncomplete=()=>r.close()}},a.onerror=r=>s(a.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dr="/",hl="tensorflowjs_models",ER="info",iW="model_topology",oW="weight_specs",lW="weight_data",uW="model_metadata";function RR(t){return{info:[hl,t,ER].join(dr),topology:[hl,t,iW].join(dr),weightSpecs:[hl,t,oW].join(dr),weightData:[hl,t,lW].join(dr),modelMetadata:[hl,t,uW].join(dr)}}function AR(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function cW(t){const e=t.split(dr);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(dr)}function dW(t){return t.startsWith(Eo.URL_SCHEME)?t.slice(Eo.URL_SCHEME.length):t}class Eo{constructor(e){if(!W().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=RR(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),a=xh(e),r=Ia.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,qV(r));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:a}}catch{throw AR(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${a.modelTopologyBytes}, weightSpecsBytes=${a.weightSpecsBytes}, weightDataBytes=${a.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(a==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=a;const r=this.LS.getItem(this.keys.modelMetadata);if(r!=null){const o=JSON.parse(r);n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,o.signature!=null&&(n.signature=o.signature),o.userDefinedMetadata!=null&&(n.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(n.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(n.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(n.trainingConfig=o.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=JV(i),n}}Eo.URL_SCHEME="localstorage://";const OR=t=>W().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Eo.URL_SCHEME)?pW(t.slice(Eo.URL_SCHEME.length)):null;wt.registerSaveRouter(OR);wt.registerLoadRouter(OR);function pW(t){return new Eo(t)}class hW{constructor(){I(W().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),I(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=hl+dr,s=dr+ER;for(let a=0;a<this.LS.length;++a){const r=this.LS.key(a);if(r.startsWith(n)&&r.endsWith(s)){const i=cW(r);e[i]=JSON.parse(this.LS.getItem(r))}}return e}async removeModel(e){e=dW(e);const n=RR(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return AR(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jl="://";class En{constructor(){this.managers={}}static getInstance(){return En.instance==null&&(En.instance=new En),En.instance}static registerManager(e,n){I(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(jl)&&(e=e.slice(0,e.indexOf(jl))),I(e.length>0,()=>"scheme must not be an empty string.");const s=En.getInstance();I(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=En.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(En.getInstance().managers)}}function Zf(t){if(t.indexOf(jl)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${En.getSchemes().join(",")}`);return{scheme:t.split(jl)[0],path:t.split(jl)[1]}}async function DR(t,e,n=!1){I(t!==e,()=>`Old path and new path are the same: '${t}'`);const s=wt.getLoadHandlers(t);I(s.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),I(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${t}.`);const a=s[0],r=wt.getSaveHandlers(e);I(r.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),I(r.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const i=r[0],o=Zf(t).scheme,l=Zf(t).path,u=o===Zf(t).scheme,c=await a.load();n&&u&&await En.getManager(o).removeModel(l);const d=await i.save(c);return n&&!u&&await En.getManager(o).removeModel(l),d.modelArtifactsInfo}async function fW(){const t=En.getSchemes(),e={};for(const n of t){const s=await En.getManager(n).listModels();for(const a in s){const r=n+jl+a;e[r]=s[a]}}return e}async function mW(t){const e=Zf(t);return En.getManager(e.scheme).removeModel(e.path)}async function gW(t,e){return DR(t,e,!1)}async function yW(t,e){return DR(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bW{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!W().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const a=this.functionRefs[s.data.index];a(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return nR(e)}}if(W().get("IS_BROWSER")){W().setPlatform("browser",new bW);try{En.registerManager(Eo.URL_SCHEME,new hW)}catch{}try{En.registerManager($o.URL_SCHEME,new rW)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wW={importFetch:()=>require("node-fetch")};let Ib;class kW{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return W().global.fetch!=null?W().global.fetch(e,n):(Ib==null&&(Ib=wW.importFetch()),Ib(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}W().get("IS_NODE")&&!W().get("IS_BROWSER")&&W().setPlatform("node",new kW);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Re(t,e="float32",n){return e=e||"float32",ms(t),new Bt(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(t,e){const n=$(t,"x","cast");if(!HE(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},a={dtype:e};return A.runKernel(Cu,s,a)}const oe=O({cast_:xW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(t){const n={x:$(t,"x","clone","string_or_numeric")};return A.runKernel(Lu,n)}const Ua=O({clone_:vW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p1(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */yR();const SW={buffer:Re,cast:oe,clone:Ua,print:p1};xV(SW);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NW(t,e){let n=$(t,"a","add"),s=$(e,"b","add");[n,s]=St(n,s);const a={a:n,b:s};return A.runKernel(Jo,a)}const ee=O({add_:NW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(t,e){let n=$(t,"a","floorDiv"),s=$(e,"b","floorDiv");[n,s]=St(n,s);const a={a:n,b:s};return A.runKernel(Fu,a)}const zy=O({floorDiv_:CW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IW(t,e){let n=$(t,"a","div"),s=$(e,"b","div");if([n,s]=St(n,s),n.dtype==="int32"&&s.dtype==="int32")return zy(n,s);const a={a:n,b:s},r={};return A.runKernel(Ru,a,r)}const xe=O({div_:IW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TW(t,e){let n=$(t,"a","mul"),s=$(e,"b","mul");[n,s]=St(n,s);const a={a:n,b:s};return A.runKernel(Ku,a)}const D=O({mul_:TW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(t){const e=$(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return A.runKernel(Ip,n)}else{const n={x:e};return A.runKernel(yp,n)}}const Ft=O({abs_:$W});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EW(t){const n={x:$(t,"x","acos")};return A.runKernel(bu,n)}const h1=O({acos_:EW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(t){const n={x:$(t,"x","acosh")};return A.runKernel(wu,n)}const f1=O({acosh_:RW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(t){I(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),I(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((a,r)=>$(a,`tensors${r}`,"addN")),n=e[0];e.forEach(a=>{if(a.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(a=>{if(!Le(a.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return A.runKernel(bp,s)}const jR=O({addN_:AW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(t,e=null,n=!1){const a={x:$(t,"x","all","bool")},r={axis:e,keepDims:n};return A.runKernel(Dg,a,r)}const My=O({all_:OW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(t,e=null,n=!1){const a={x:$(t,"x","any","bool")},r={axis:e,keepDims:n};return A.runKernel(jg,a,r)}const Hd=O({any_:DW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jW(t,e=0){const s={x:$(t,"x","argMax")},a={axis:e};return A.runKernel(wp,s,a)}const Ro=O({argMax_:jW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(t,e=0){const s={x:$(t,"x","argMin")},a={axis:e};return A.runKernel(kp,s,a)}const m1=O({argMin_:_W});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FW(t){const n={x:$(t,"x","asin")};return A.runKernel(ku,n)}const g1=O({asin_:FW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(t){const n={x:$(t,"x","asinh")};return A.runKernel(xu,n)}const y1=O({asinh_:PW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(t){const n={x:$(t,"x","atan")};return A.runKernel(vu,n)}const b1=O({atan_:LW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BW(t,e){let n=$(t,"a","atan2"),s=$(e,"b","atan2");[n,s]=St(n,s);const a={a:n,b:s};return A.runKernel(Nu,a)}const w1=O({atan2_:BW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(t){const n={x:$(t,"x","atanh")};return A.runKernel(Su,n)}const k1=O({atanh_:zW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vh(t,e,n,s,a="NHWC",r){const i=t[3],o=[...e,i],l=Ar(a);return nn(t,o,n,r,s,null,null,l)}function Ys(t,e,n,s,a,r,i="channelsLast"){const[o,l]=Kd(e);let u;if(i==="channelsLast")u=[o,l,t[3],t[3]];else if(i==="channelsFirst")u=[o,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return nn(t,u,n,s,a,r,!1,i)}function Rr(t,e,n,s,a,r,i="NDHWC"){const[o,l,u]=ik(e);let c,d;if(i==="NDHWC")d="channelsLast",c=[o,l,u,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",c=[o,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Pi(t,c,n,s,a,!1,d,r)}function nn(t,e,n,s,a,r,i=!1,o="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,d]=t;else if(o==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${o}`);const[p,h,,f]=e,[m,y]=Kd(n),[g,b]=Kd(s),w=_l(p,g),k=_l(h,b),{padInfo:x,outHeight:S,outWidth:C}=WW(a,u,c,m,y,w,k,r,o),T=i?f*d:f;let E;return o==="channelsFirst"?E=[l,T,S,C]:o==="channelsLast"&&(E=[l,S,C,T]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:d,outHeight:S,outWidth:C,outChannels:T,padInfo:x,strideHeight:m,strideWidth:y,filterHeight:p,filterWidth:h,effectiveFilterHeight:w,effectiveFilterWidth:k,dilationHeight:g,dilationWidth:b,inShape:t,outShape:E,filterShape:e}}function Pi(t,e,n,s,a,r=!1,i="channelsLast",o){let[l,u,c,d,p]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d,p]=t;else if(i==="channelsFirst")[l,p,u,c,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[h,f,m,,y]=e,[g,b,w]=ik(n),[k,x,S]=ik(s),C=_l(h,k),T=_l(f,x),E=_l(m,S),{padInfo:R,outDepth:L,outHeight:U,outWidth:G}=UW(a,u,c,d,g,b,w,C,T,E,o),F=r?y*p:y;let z;return i==="channelsFirst"?z=[l,F,L,U,G]:i==="channelsLast"&&(z=[l,L,U,G,F]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:c,inWidth:d,inChannels:p,outDepth:L,outHeight:U,outWidth:G,outChannels:F,padInfo:R,strideDepth:g,strideHeight:b,strideWidth:w,filterDepth:h,filterHeight:f,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:T,effectiveFilterWidth:E,dilationDepth:k,dilationHeight:x,dilationWidth:S,inShape:t,outShape:z,filterShape:e}}function MW(t,e,n,s,a){s==null&&(s=x1(t,e,n));const r=t[0],i=t[1],o=qd((r-e+2*s)/n+1,a),l=qd((i-e+2*s)/n+1,a);return[o,l]}function VW(t,e,n,s,a,r){a==null&&(a=x1(t,e[0],s[0]));const i=[0,0,0,n];for(let o=0;o<3;o++)t[o]+2*a>=e[o]&&(i[o]=qd((t[o]-e[o]+2*a)/s[o]+1,r));return i}function x1(t,e,n,s=1){const a=_l(e,s);return Math.floor((t[0]*(n-1)-n+a)/2)}function Kd(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function ik(t){return typeof t=="number"?[t,t,t]:t}function _l(t,e){return e<=1?t:t+(t-1)*(e-1)}function WW(t,e,n,s,a,r,i,o,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const h=MW([e,n],r,s,t,o);c=h[0],d=h[1]}else if(t==="same"){c=Math.ceil(e/s),d=Math.ceil(n/a);const p=Math.max(0,(c-1)*s+r-e),h=Math.max(0,(d-1)*a+i-n),f=Math.floor(p/2),m=p-f,y=Math.floor(h/2),g=h-y;u={top:f,bottom:m,left:y,right:g,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-r+1)/s),d=Math.ceil((n-i+1)/a);else if(typeof t=="object"){const p=l==="channelsLast"?t[1][0]:t[2][0],h=l==="channelsLast"?t[1][1]:t[2][1],f=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];u={top:p,bottom:h,left:f,right:m,type:p===0&&h===0&&f===0&&m===0?"VALID":"EXPLICIT"},c=qd((e-r+p+h)/s+1,o),d=qd((n-i+f+m)/a+1,o)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function UW(t,e,n,s,a,r,i,o,l,u,c){let d,p,h,f;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=VW([e,n,s,1],[o,l,u],1,[a,r,i],t,c);p=y[0],h=y[1],f=y[2]}else if(t==="same"){p=Math.ceil(e/a),h=Math.ceil(n/r),f=Math.ceil(s/i);const m=(p-1)*a+o-e,y=(h-1)*r+l-n,g=(f-1)*i+u-s,b=Math.floor(m/2),w=m-b,k=Math.floor(y/2),x=y-k,S=Math.floor(g/2),C=g-S;d={top:k,bottom:x,left:S,right:C,front:b,back:w,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:p,outHeight:h,outWidth:f}}function qd(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function xi(t){const[e,n,s]=Kd(t);return e===1&&n===1&&s===1}function hn(t,e){return xi(t)||xi(e)}function Ao(t){return Kd(t).every(e=>e>0)}function Ar(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Fn(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")I(Io(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(a=>{I(Io(a),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${a}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(t,e){const s={x:$(t,"x","reshape","string_or_numeric")},a={shape:e};return A.runKernel(ih,s,a)}const _=O({reshape_:GW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(t,e,n,s,a){const r=$(t,"x","avgPool","float32"),i=1;I(hn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let o=r,l=!1;r.rank===3&&(l=!0,o=_(r,[1,r.shape[0],r.shape[1],r.shape[2]])),I(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),Fn("avgPool",s,a);const u={x:o},c={filterSize:e,strides:n,pad:s,dimRoundingMode:a};let d=A.runKernel(xp,u,c);return d=oe(d,r.dtype),l?_(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Sh=O({avgPool_:HW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(t,e,n,s,a,r="NDHWC"){const i=$(t,"x","avgPool3d","float32");let o=i,l=!1;i.rank===4&&(l=!0,o=_(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),I(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),I(r==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),I(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Fn("avgPool3d",s,a);const u={x:o},c={filterSize:e,strides:n,pad:s,dimRoundingMode:a,dataFormat:r};let d=A.runKernel(vp,u,c);return d=oe(d,o.dtype),l?_(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const v1=O({avgPool3d_:KW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(t,e=0){I(t.length>=1,()=>"Pass at least one tensor to concat");const n=Gd(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(r=>{if(r.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${r.dtype}. `)}),n.length===1)return Ua(n[0]);const s=n,a={axis:e};return A.runKernel(Tp,s,a)}const At=O({concat_:qW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JW(t,e,n=!1,s=!1){let a=$(t,"a","matMul"),r=$(e,"b","matMul");[a,r]=St(a,r);const i={a,b:r},o={transposeA:n,transposeB:s};return A.runKernel(Sp,i,o)}const je=O({matMul_:JW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(t){const n={x:$(t,"x","sigmoid","float32")};return A.runKernel(ac,n)}const ga=O({sigmoid_:XW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(t,e,n){const s=$(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const a={x:s},r={begin:e,size:n};return A.runKernel(dh,a,r)}const ze=O({slice_:YW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(t){const n={x:$(t,"x","tanh","float32")};return A.runKernel(cc,n)}const vi=O({tanh_:QW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,e,n,s,a,r){const i=$(t,"forgetBias","basicLSTMCell"),o=$(e,"lstmKernel","basicLSTMCell"),l=$(n,"lstmBias","basicLSTMCell"),u=$(s,"data","basicLSTMCell"),c=$(a,"c","basicLSTMCell"),d=$(r,"h","basicLSTMCell"),p=At([u,d],1),h=je(p,o),f=ee(h,l),m=f.shape[0],y=f.shape[1]/4,g=[m,y],b=ze(f,[0,0],g),w=ze(f,[0,y],g),k=ze(f,[0,y*2],g),x=ze(f,[0,y*3],g),S=ee(D(ga(b),vi(w)),D(c,ga(ee(i,k)))),C=D(vi(S),ga(x));return[S,C]}const _R=O({basicLSTMCell_:ZW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eU(t,e,n){const s=$(t,"x","batchToSpaceND"),a=e.reduce((o,l)=>o*l);I(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),I(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),I(s.shape[0]%a===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${a}`);const r={x:s},i={blockShape:e,crops:n};return A.runKernel(Np,r,i)}const Nh=O({batchToSpaceND_:eU});function tU(t){let e;return t.rank===0||t.rank===1?e=_(t,[1,1,1,t.size]):t.rank===2?e=_(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=_(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nU(t,e,n,s,a,r){r==null&&(r=.001);const i=$(t,"x","batchNorm"),o=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;a!=null&&(u=$(a,"scale","batchNorm"));let c;s!=null&&(c=$(s,"offset","batchNorm")),I(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),I(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),I(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:tU(i),scale:u,offset:c,mean:o,variance:l},h={varianceEpsilon:r},f=A.runKernel(Fp,p,h);return _(f,i.shape)}const hc=O({batchNorm_:nU});function sU(t,e,n,s,a,r){const i=$(t,"x","batchNorm"),o=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;a!=null&&(u=$(a,"scale","batchNorm"));let c;return s!=null&&(c=$(s,"offset","batchNorm")),I(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),I(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),I(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&I(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&I(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),hc(i,o,l,c,u,r)}const S1=O({batchNorm2d_:sU});function aU(t,e,n,s,a,r){const i=$(t,"x","batchNorm"),o=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;a!=null&&(u=$(a,"scale","batchNorm"));let c;return s!=null&&(c=$(s,"offset","batchNorm")),I(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),I(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),I(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&I(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&I(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),hc(i,o,l,c,u,r)}const N1=O({batchNorm3d_:aU});function rU(t,e,n,s,a,r){const i=$(t,"x","batchNorm"),o=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;a!=null&&(u=$(a,"scale","batchNorm"));let c;return s!=null&&(c=$(s,"offset","batchNorm")),I(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),I(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),I(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&I(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&I(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),hc(i,o,l,c,u,r)}const C1=O({batchNorm4d_:rU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(t,e,n){const s=$(t,"x","bincount"),a=$(e,"weights","bincount");I(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),I(n>=0,()=>`size must be non-negative, but got ${n}.`),I(a.size===s.size||a.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${a.shape}.`);const r={x:s,weights:a},i={size:n};return A.runKernel(Pg,r,i)}const I1=O({bincount_:iU});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(t,e){const n=$(t,"x","bitwiseAnd"),s=$(e,"y","bitwiseAnd");if(!Le(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const a={a:n,b:s};return A.runKernel(Cp,a)}const FR=O({bitwiseAnd_:oU});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lU(t,e){const n=$(t,"s0","broadcastArgs","int32"),s=$(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const a={s0:n,s1:s};return A.runKernel(Lg,a)}const PR=O({broadcastArgs_:lU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uU(t,e){let n=$(t,"broadcastTo","x");const s=n.shape;if(ms(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=_(n,u)}const a=n.shape,r=Array.from(e);for(let u=e.length-1;u>=0;u--)if(a[u]===e[u])r[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(r.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Ua(n);const o={x:n},l={reps:r};return A.runKernel(dc,o,l)}const yo=O({broadcastTo_:uU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cU(t){const n={x:$(t,"x","ceil","float32")};return A.runKernel(Iu,n)}const T1=O({ceil_:cU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yo(t,e,n){ms(t),n=n||Ko(e);const s={shape:t,value:e,dtype:n};return A.runKernel(ey,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dU(t,e,n){const s=$(t,"x","clipByValue");if(I(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Yo(s.shape,e,s.dtype);const a={x:s},r={clipValueMin:e,clipValueMax:n};return A.runKernel(Tu,a,r)}const Hn=O({clipByValue_:dU});function pU(t){return At(t,0)}const $1=O({concat1d_:pU});function hU(t,e){return At(t,e)}const E1=O({concat2d_:hU});function fU(t,e){return At(t,e)}const R1=O({concat3d_:fU});function mU(t,e){return At(t,e)}const A1=O({concat4d_:mU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gU(t,e,n,s,a="NHWC",r=[1,1],i){const o=$(t,"x","conv2d","float32"),l=$(e,"filter","conv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=_(o,[1,o.shape[0],o.shape[1],o.shape[2]])),I(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),I(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Fn("conv2d",s,i);const d=a==="NHWC"?u.shape[3]:u.shape[1];I(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),I(hn(n,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`),I(Ao(r),()=>"Error in conv2D: Dilated rates should be larger than 0."),I(Ao(n),()=>"Error in conv2D: Strides should be larger than 0.");const p={x:u,filter:l},h={strides:n,pad:s,dataFormat:a,dilations:r,dimRoundingMode:i},f=A.runKernel($p,p,h);return c?_(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Sr=O({conv2d_:gU});function yU(t,e,n,s,a="NWC",r=1,i){const o=$(t,"x","conv1d"),l=$(e,"filter","conv1d");let u=o,c=!1;o.rank===2&&(c=!0,u=_(o,[1,o.shape[0],o.shape[1]])),I(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),I(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Fn("conv1d",s,i),I(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),I(hn(n,r),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${r}'`),I(Ao(r),()=>"Error in conv1D: Dilated rates should be larger than 0."),I(Ao(n),()=>"Error in conv1D: Stride should be larger than 0."),I(a==="NWC",()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);const d=_(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=_(u,[u.shape[0],1,u.shape[1],u.shape[2]]),y=Sr(p,d,[1,n],s,"NHWC",[1,r],i);return c?_(y,[y.shape[2],y.shape[3]]):_(y,[y.shape[0],y.shape[2],y.shape[3]])}const Vy=O({conv1d_:yU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(t,e,n,s,a,r="NHWC",i){I(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,l=e,u=!1;e.rank===3&&(u=!0,l=_(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,t[0],t[1],t[2]]),I(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),I(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),I(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=r==="NHWC"?o[3]:o[1],d=r==="NHWC"?l.shape[3]:l.shape[1];I(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),I(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Fn("conv2dDerInput",a,i);const p={dy:l,filter:n},h={strides:s,pad:a,dataFormat:r,dimRoundingMode:i,inputShape:o},f=A.runKernel(Ep,p,h);return u?_(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const O1=O({conv2DBackpropInput_:bU});function wU(t,e,n,s,a,r){const i=$(t,"x","conv2dTranspose"),o=$(e,"filter","conv2dTranspose");return O1(n,i,o,s,a,"NHWC",r)}const Wy=O({conv2dTranspose_:wU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(t,e,n,s,a="NDHWC",r=[1,1,1]){const i=$(t,"x","conv3d"),o=$(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=_(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),I(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),I(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),I(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),I(hn(n,r),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`),I(a==="NDHWC",()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`),I(Ao(r),()=>"Error in conv3D: Dilated rates should be larger than 0."),I(Ao(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:o},d={strides:n,pad:s,dataFormat:a,dilations:r},p=A.runKernel(Rp,c,d);return u?_(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const D1=O({conv3d_:kU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xU(t,e,n,s,a){I(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let r=t,i=e,o=!1;e.rank===4&&(o=!0,i=_(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),r=[1,t[0],t[1],t[2],t[3]]);const l=r[4],u=i.shape[4];I(r.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${r.length}.`),I(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),I(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),I(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),I(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:i,filter:n},d={pad:a,strides:s,inputShape:r},p=A.runKernel(Vg,c,d);return o?_(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const LR=O({conv3DBackpropInput_:xU});function vU(t,e,n,s,a){const r=$(t,"x","conv3dTranspose"),i=$(e,"filter","conv3dTranspose");return LR(n,r,i,s,a)}const j1=O({conv3dTranspose_:vU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SU(t){const n={x:$(t,"x","cos","float32")};return A.runKernel($u,n)}const Ch=O({cos_:SU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(t){const n={x:$(t,"x","cosh","float32")};return A.runKernel(Eu,n)}const Uy=O({cosh_:NU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(t,e=0,n=!1,s=!1){const r={x:$(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:s};return A.runKernel(Wg,r,i)}const Jd=O({cumprod_:CU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(t,e=0,n=!1,s=!1){const r={x:$(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:s};return A.runKernel(Ap,r,i)}const Gy=O({cumsum_:IU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(t,e,n,s=!1){const a=$(t,"x","denseBincount"),r=$(e,"weights","denseBincount");I(a.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`),I(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),I(n>=0,()=>`size must be non-negative, but got ${n}.`),I(r.size===a.size||r.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${r.shape}.`);const i={x:a,weights:r},o={size:n,binaryOutput:s};return A.runKernel(Gg,i,o)}const Mm=O({denseBincount_:TU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $U(t,e,n="NHWC"){const s=$(t,"x","depthToSpace","float32"),a=n==="NHWC"?s.shape[1]:s.shape[2],r=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];I(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),I(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e}  for depthToSpace with input shape
    ${s.shape}`),I(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e} for depthToSpace with input shape
        ${s.shape}`),I(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const o={x:s},l={blockSize:e,dataFormat:n};return A.runKernel(Hg,o,l)}const _1=O({depthToSpace_:$U});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EU(t,e,n,s,a="NHWC",r=[1,1],i){const o=$(t,"x","depthwiseConv2d","float32"),l=$(e,"filter","depthwiseConv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=_(o,[1,o.shape[0],o.shape[1],o.shape[2]])),I(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),I(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=a==="NHWC"?u.shape[3]:u.shape[1];I(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Fn("depthwiseConv2d",s,i);const p={x:u,filter:l},h={strides:n,pad:s,dataFormat:a,dilations:r,dimRoundingMode:i},f=A.runKernel(Op,p,h);return c?_(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const fc=O({depthwiseConv2d_:EU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RU(t){const n={x:$(t,"x","diag")};return A.runKernel(Jg,n)}const BR=O({diag_:RU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AU(t,e,n,s,a=[1,1],r="NHWC"){const i=$(t,"x","dilation2d"),o=$(e,"filter","dilation2d");I(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),I(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),I(r==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${r}`);let l=i,u=!1;i.rank===3&&(l=_(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),I(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const c={x:l,filter:o},d={strides:n,pad:s,dilations:a},p=A.runKernel(Dp,c,d);return u?_(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const F1=O({dilation2d_:AU});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oo(t,e){const n=t.length,s=[];for(let a=0;a<n;a++){const r=n-1-a,i=t[r]||1;(e[e.length-1-a]||1)>1&&i===1&&s.unshift(r)}return s}function zt(t,e){const n=[];for(let s=0;s<e.length;s++){const a=t[t.length-s-1],r=e.length-s-1,i=e[r];(a==null||a===1&&i>1)&&n.unshift(r)}return n}function Te(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let a=0;a<n;a++){let r=t[t.length-a-1];r==null&&(r=1);let i=e[e.length-a-1];if(i==null&&(i=1),r===1)s[n-a-1]=i;else if(i===1)s[n-a-1]=r;else if(r!==i){const o=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(o)}else s[n-a-1]=r}return s}const OU=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Te,getBroadcastDims:Oo,getReductionAxes:zt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DU(t,e){let n=$(t,"a","equal","string_or_numeric"),s=$(e,"b","equal","string_or_numeric");[n,s]=St(n,s),Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(jp,a)}const Xs=O({equal_:DU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jU(t,e,n){const s=$(e,"a","where"),a=$(n,"b","where"),r=$(t,"condition","where","bool"),i=Te(Te(r.shape,s.shape),a.shape),o=yo(r,i),l=yo(s,i),u=yo(a,i),c={condition:o,t:l,e:u};return A.runKernel(ch,c)}const cn=O({where_:jU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _U(t){const n={x:$(t,"x","zerosLike")};return A.runKernel(wh,n)}const Me=O({zerosLike_:_U});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FU(t,e){let n=$(t,"a","div"),s=$(e,"b","div");[n,s]=St(n,s);const a=xe(n,s),r=Me(a),i=Xs(s,r);return cn(i,r,a)}const P1=O({divNoNan_:FU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PU(t,e){const n=$(t,"t1","dot"),s=$(e,"t2","dot");I((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const a=n.rank===1?n.size:n.shape[1],r=s.rank===1?s.size:s.shape[0];if(I(a===r,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${r}.`),n.rank===1&&s.rank===1){const i=_(n,[1,-1]),o=_(s,[-1,1]),l=je(i,o);return _(l,[])}else if(n.rank===1&&s.rank===2){const i=_(n,[1,-1]),o=_(s,[s.shape[0],s.shape[1]]),l=je(i,o);return _(l,[l.size])}else if(n.rank===2&&s.rank===1){const i=_(s,[-1,1]),o=je(n,i);return _(o,[o.size])}else{const i=_(s,[s.shape[0],s.shape[1]]);return je(n,i)}}const L1=O({dot_:PU});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LU(t,...e){const n=e.map((a,r)=>$(a,`tensors${r}`,"einsum")),s={equation:t};return A.runKernel(Yg,n,s)}const to=O({einsum_:LU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BU(t){const n={x:$(t,"x","elu","float32")};return A.runKernel(Au,n)}const mc=O({elu_:BU});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zU(t,e){const n=$(t,"x","ensureShape","string_or_numeric");if(!UE(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const zR=O({ensureShape_:zU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MU(t){let e=$(t,"x","erf");I(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=oe(e,"float32"));const n={x:e};return A.runKernel(Ou,n)}const Hy=O({erf_:MU});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B1(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function MR(t,e,n){const s=t.length+e.length,a=[];let r=0,i=0;for(let o=0;o<s;o++)n.indexOf(o)===-1?a.push(t[r++]):a.push(e[i++]);return a}function sn(t,e){const n=[],s=t.length;for(let r=0;r<s;r++)e.indexOf(r)===-1&&n.push(t[r]);const a=e.map(r=>t[r]);return[n,a]}function Ot(t,e){const n=e.map(s=>1);return MR(t,n,e)}function fn(t,e,n){I(B1(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Nt(t,e){if(B1(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function Li(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Dt(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(t,e=null,n=!1){const a={x:$(t,"x","max")},r={reductionIndices:e,keepDims:n};return A.runKernel(Hp,a,r)}const Is=O({max_:VU});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WU(t,e=null,n=!1){const a={x:$(t,"x","min")},r={axis:e,keepDims:n};return A.runKernel(Xp,a,r)}const eu=O({min_:WU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UU(t,e){let n=$(t,"base","pow"),s=$(e,"exp","pow");[n,s]=St(n,s);const a={a:n,b:s};return A.runKernel(qu,a)}const Xa=O({pow_:UU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Se(t,e){if((Yt(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Yt(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Fi(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GU(t){const n={x:$(t,"x","sqrt","float32")};return A.runKernel(ic,n)}const tn=O({sqrt_:GU});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HU(t){const e=$(t,"x","square"),n={};return A.runKernel("Square",{x:e},n)}const et=O({square_:HU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KU(t,e=null,n=!1){let s=$(t,"x","sum");s.dtype==="bool"&&(s=oe(s,"int32"));const a={x:s},r={axis:e,keepDims:n};return A.runKernel(ph,a,r)}const me=O({sum_:KU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qU(t,e="euclidean",n=null,s=!1){t=$(t,"x","norm");const a=VR(t,e,n);let r=a.shape;if(s){const i=Fe(n,t.shape);r=Ot(a.shape,i)}return _(a,r)}function VR(t,e,n=null){if(t.rank===0)return Ft(t);if(t.rank!==1&&n===null)return VR(_(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return me(Ft(t),n);if(e===1/0)return Is(Ft(t),n);if(e===-1/0)return eu(Ft(t),n);if(e==="euclidean"||e===2)return tn(me(Xa(Ft(t),Se(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Is(me(Ft(t),n[0]),n[1]-1);if(e===1/0)return Is(me(Ft(t),n[1]),n[0]);if(e===-1/0)return eu(me(Ft(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return tn(me(et(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const gc=O({norm_:qU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JU(t,e=null,n=!1){return gc(t,"euclidean",e,n)}const z1=O({euclideanNorm_:JU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XU(t){const n={x:$(t,"x","exp")};return A.runKernel(Du,n)}const Kn=O({exp_:XU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YU(t,e=0){const n=$(t,"x","expandDims","string_or_numeric");I(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},a={dim:e};return A.runKernel(_p,s,a)}const bn=O({expandDims_:YU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QU(t){const n={x:$(t,"x","expm1")};return A.runKernel(ju,n)}const M1=O({expm1_:QU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZU(t,e){const n=$(t,"x","tile","string_or_numeric");I(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},a={reps:e};return A.runKernel(dc,s,a)}const vs=O({tile_:ZU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e5(t,e,n,s="float32"){e==null&&(e=t);const a=Re([t,e],s),r=t<=e?t:e;for(let o=0;o<r;++o)a.set(1,o,o);const i=_(a.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return vs(bn(i,0),[n[0],1,1]);if(n.length===2)return vs(bn(bn(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return vs(bn(bn(bn(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Ky=O({eye_:e5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t5(t){const n={x:$(t,"x","floor","float32")};return A.runKernel(_u,n)}const yc=O({floor_:t5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n5(t,e,n=0,s=0){const a=$(t,"x","gather"),r=$(e,"indices","gather","int32"),i={x:a,indices:r},o={axis:n,batchDims:s};return A.runKernel(Pp,i,o)}const bc=O({gather_:n5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s5(t,e){let n=$(t,"a","greater","string_or_numeric"),s=$(e,"b","greater","string_or_numeric");[n,s]=St(n,s),Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(Lp,a)}const Qn=O({greater_:s5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a5(t,e){let n=$(t,"a","greaterEqual","string_or_numeric"),s=$(e,"b","greaterEqual","string_or_numeric");[n,s]=St(n,s),Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(Pu,a)}const Or=O({greaterEqual_:a5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r5(t){const n={input:$(t,"input","imag")};return A.runKernel(ay,n)}const Ih=O({imag_:r5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i5(t){const n={x:$(t,"x","isFinite")};return A.runKernel(Bu,n)}const V1=O({isFinite_:i5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o5(t){const n={x:$(t,"x","isInf")};return A.runKernel(zu,n)}const W1=O({isInf_:o5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l5(t){const n={x:$(t,"x","isNaN")};return A.runKernel(Mu,n)}const U1=O({isNaN_:l5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u5(t,e=.2){const s={x:$(t,"x","leakyRelu")},a={alpha:e};return A.runKernel(Bp,s,a)}const Th=O({leakyRelu_:u5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5(t,e){let n=$(t,"a","less","string_or_numeric"),s=$(e,"b","less","string_or_numeric");[n,s]=St(n,s),Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(zp,a)}const tu=O({less_:c5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d5(t,e){let n=$(t,"a","lessEqual","string_or_numeric"),s=$(e,"b","lessEqual","string_or_numeric");[n,s]=St(n,s),Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(Mp,a)}const Bi=O({lessEqual_:d5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WR(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:t,stop:e,num:n};return A.runKernel(ry,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p5(t,e=5,n=1,s=1,a=.5){const r=$(t,"x","localResponseNormalization");I(r.rank===4||r.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${r.rank}.`),I(Io(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=r,o=!1;r.rank===3&&(o=!0,i=_(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={x:i},u={depthRadius:e,bias:n,alpha:s,beta:a},c=A.runKernel(Gp,l,u);return o?_(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const G1=O({localResponseNormalization_:p5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h5(t){const n={x:$(t,"x","log","float32")};return A.runKernel(Vu,n)}const ds=O({log_:h5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f5(t){const n={x:$(t,"x","log1p")};return A.runKernel(Wu,n)}const $h=O({log1p_:f5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5(t){return I(bi(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const s=$(e,"x","tf.grad","string_or_numeric"),a=n!=null?$(n,"dy","tf.grad"):null;return A.tidy(()=>{const{value:r,grads:i}=A.gradients(()=>t(s),[s],a);return a!=null&&pn(r.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),qy(i),i[0]})}}function g5(t){return I(bi(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{I(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=Gd(e,"args","tf.grads","string_or_numeric"),a=n!=null?$(n,"dy","tf.grads"):null;return A.tidy(()=>{const{value:r,grads:i}=A.gradients(()=>t(...s),s,a);return a!=null&&pn(r.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),qy(i),i})}}function y5(t){return I(bi(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{I(e instanceof qe,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),I(n==null||n instanceof qe,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:a}=A.gradients(()=>t(e),[e],n);return qy(s),{grad:s[0],value:a}}}function b5(t){return I(bi(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{I(Array.isArray(e)&&e.every(a=>a instanceof qe),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),I(n==null||n instanceof qe,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=A.gradients(()=>t(...e),e,n);return n!=null&&pn(s.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),qy(s.grads),s}}function UR(t,e){I(bi(t),()=>"The f passed in variableGrads(f) must be a function"),I(e==null||Array.isArray(e)&&e.every(u=>u instanceof Ud),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in A.registeredVariables)e.push(A.registeredVariables[u])}const s=n?e.filter(u=>!u.trainable):null,a=e.length;e=e.filter(u=>u.trainable),I(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);const r=!0,{value:i,grads:o}=A.gradients(t,e,null,r);I(o.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),I(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,c)=>{o[c]!=null&&(l[u.name]=o[c])}),s!=null&&s.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Ya(t){return A.customGrad(t)}function qy(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w5(t){const n={x:$(t,"x","neg")};return A.runKernel(Qp,n)}const ot=O({neg_:w5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k5(t){const n={x:$(t,"x","softplus")};return A.runKernel(rc,n)}const Qo=O({softplus_:k5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5(t){const e=$(t,"x","logSigmoid");return Ya(s=>({value:ot(Qo(ot(s))),gradFunc:i=>D(i,ga(ot(s)))}))(e)}const H1=O({logSigmoid_:x5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v5(t,e){let n=$(t,"a","sub"),s=$(e,"b","sub");[n,s]=St(n,s);const a={a:n,b:s};return A.runKernel(lc,a)}const pe=O({sub_:v5});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S5(t,e=-1){const n=$(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Ya((a,r)=>{const o=Is(a,e,!0),l=pe(a,o),u=pe(oe(l,"float32"),ds(me(Kn(l),e,!0)));return r([u]),{value:u,gradFunc:(d,p)=>{const[h]=p,f=!0,m=Kn(h);return pe(d,D(me(d,e,f),m))}}})(n)}const Jy=O({logSoftmax_:S5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N5(t,e=null,n=!1){const s=$(t,"x","logSumExp"),a=Fe(e,s.shape),r=Is(s,a,!0),i=pe(s,r),o=Kn(i),l=me(o,a),u=ds(l),c=ee(_(r,u.shape),u);if(n){const d=Ot(c.shape,a);return _(c,d)}return c}const Eh=O({logSumExp_:N5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C5(t,e){const n=$(t,"a","logicalAnd","bool"),s=$(e,"b","logicalAnd","bool");Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(Vp,a)}const wa=O({logicalAnd_:C5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I5(t){const n={x:$(t,"x","logicalNot","bool")};return A.runKernel(Wp,n)}const Rh=O({logicalNot_:I5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T5(t,e){const n=$(t,"a","logicalOr","bool"),s=$(e,"b","logicalOr","bool");Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(Up,a)}const Xy=O({logicalOr_:T5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $5(t,e){const n=$(t,"a","logicalXor","bool"),s=$(e,"b","logicalXor","bool");return Te(n.shape,s.shape),wa(Xy(t,e),Rh(wa(t,e)))}const K1=O({logicalXor_:$5});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nf=2147483648;function E5(t,e,n="left"){const s=$(t,"sortedSequence","searchSorted"),a=$(e,"values","searchSorted"),r=s.shape[s.shape.length-1],i=a.shape[a.shape.length-1],o=_(s,[-1,r]),l=_(a,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(K(l.shape)>=Nf)throw new Error(`values tensor size must less than ${Nf}`);if(o.shape[1]>=Nf)throw new Error(`trailing dim_size must less than ${Nf} for int32 output type, was ${o.shape[1]}`);const u={sortedSequence:o,values:l},c={side:n};return A.runKernel(Sy,u,c)}const Yy=O({searchSorted_:E5});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GR(t,e){return Yy(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R5(t,e,n,s,a){const r=$(t,"x","maxPool"),i=1;let o=r,l=!1;r.rank===3&&(l=!0,o=_(r,[1,r.shape[0],r.shape[1],r.shape[2]])),I(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),I(hn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Fn("maxPool",s,a);const u={x:o},c={filterSize:e,strides:n,pad:s,dimRoundingMode:a},d=A.runKernel(Kp,u,c);return l?_(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Ah=O({maxPool_:R5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A5(t,e=[1,1,1],n,s,a,r="NDHWC"){const i=$(t,"x","maxPool3d");let o=i,l=!1;i.rank===4&&(l=!0,o=_(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),I(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),I(r==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),Fn("maxPool3d",s,a);const u={x:o},c={filterSize:e,strides:n,pad:s,dimRoundingMode:a,dataFormat:r},d=A.runKernel(qp,u,c);return l?_(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const q1=O({maxPool3d_:A5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O5(t,e,n,s,a=!1){const i={x:$(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:s,includeBatchInIndex:a},l=A.runKernel(uy,i,o);return{result:l[0],indexes:l[1]}}const HR=O({maxPoolWithArgmax_:O5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D5(t,e){let n=$(t,"a","maximum"),s=$(e,"b","maximum");[n,s]=St(n,s),n.dtype==="bool"&&(n=oe(n,"int32"),s=oe(s,"int32")),Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(Uu,a)}const er=O({maximum_:D5});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j5(t,e=null,n=!1){const a={x:$(t,"x","mean")},r={axis:e,keepDims:n};return A.runKernel(Jp,a,r)}const xt=O({mean_:j5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lt(t,e="float32"){if(ms(t),e==="complex64"){const s=Lt(t,"float32"),a=Lt(t,"float32");return vr(s,a)}const n=dn(K(t),e);return A.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mn(t,e="float32"){if(ms(t),e==="complex64"){const s=Mn(t,"float32"),a=Lt(t,"float32");return vr(s,a)}const n=Og(K(t),e);return A.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KR(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let s=$(t,"x","meshgrid",t instanceof qe?t.dtype:"float32");if(e===void 0)return[s];let a=$(e,"y","meshgrid",e instanceof qe?e.dtype:"float32");const r=K(s.shape),i=K(a.shape);return n==="xy"?(s=_(s,[1,-1]),a=_(a,[-1,1]),[je(Mn([i,1],s.dtype),s),je(a,Mn([1,r],a.dtype))]):(s=_(s,[-1,1]),a=_(a,[1,-1]),[je(s,Mn([1,i],s.dtype)),je(Mn([r,1],a.dtype),a)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _5(t,e){let n=$(t,"a","minimum"),s=$(e,"b","minimum");[n,s]=St(n,s),n.dtype==="bool"&&(n=oe(n,"int32"),s=oe(s,"int32")),Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(Gu,a)}const Si=O({minimum_:_5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F5(t,e,n){I(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=$(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");I(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const a=n==="reflect"?1:0;for(let o=0;o<s.rank;o++)I(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),I(e[o][0]>=0&&e[o][0]<=s.shape[o]-a&&e[o][1]>=0&&e[o][1]<=s.shape[o]-a,()=>`Padding in dimension ${o} cannot be greater than or equal to ${s.shape[o]-a} or less than 0 for input of shape ${s.shape}`);const r={paddings:e,mode:n},i={x:s};return A.runKernel(Yp,i,r)}const J1=O({mirrorPad_:F5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P5(t,e){let n=$(t,"a","mod"),s=$(e,"b","mod");[n,s]=St(n,s);const a={a:n,b:s};return A.runKernel(Hu,a)}const X1=O({mod_:P5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L5(t,e=null,n=!1){t=$(t,"x","moments");const s=Fe(e,t.shape),a=xt(t,s,n);let r=a.shape;n||(r=Ot(a.shape,s));const i=et(pe(oe(t,"float32"),_(a,r))),o=xt(i,s,n);return{mean:a,variance:o}}const Oh=O({moments_:L5});function B5(t,e,n,s){const a=$(e,"data","multiRNNCell"),r=Gd(n,"c","multiRNNCell"),i=Gd(s,"h","multiRNNCell");let o=a;const l=[];for(let d=0;d<t.length;d++){const p=t[d](o,r[d],i[d]);l.push(p[0]),l.push(p[1]),o=p[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const qR=O({multiRNNCell_:B5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z5(t,e,n,s=!1){const a=$(t,"logits","multinomial"),r=a.size,i=a.rank;if(r<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${r}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();const l={logits:i===1?_(a,[1,-1]):a},u={numSamples:e,seed:n,normalized:s},c=A.runKernel(cy,l,u);return i===1?_(c,[c.size]):c}const JR=O({multinomial_:z5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M5(t,e){let n=$(t,"a","notEqual","string_or_numeric"),s=$(e,"b","notEqual","string_or_numeric");[n,s]=St(n,s),Te(n.shape,s.shape);const a={a:n,b:s};return A.runKernel(Zp,a)}const Do=O({notEqual_:M5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V5(t,e,n=1,s=0,a="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:$(t,"indices","oneHot","int32")},o={dtype:a,depth:e,onValue:n,offValue:s};return A.runKernel(th,i,o)}const nu=O({oneHot_:V5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W5(t){const n={x:$(t,"x","onesLike")};return A.runKernel(eh,n)}const ps=O({onesLike_:W5});function U5(t,e){const n=$(t,"v1","outerProduct"),s=$(e,"v2","outerProduct");I(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const a=_(n,[-1,1]),r=_(s,[1,-1]);return je(a,r)}const XR=O({outerProduct_:U5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G5(t,e,n=0){const s=$(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:n},r={x:s};return A.runKernel(sh,r,a)}const Dr=O({pad_:G5});function H5(t,e,n=0){return I(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Dr(t,[e],n)}const YR=O({pad1d_:H5});function K5(t,e,n=0){return I(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Dr(t,e,n)}const QR=O({pad2d_:K5});function q5(t,e,n=0){return I(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Dr(t,e,n)}const ZR=O({pad3d_:q5});function J5(t,e,n=0){return I(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Dr(t,e,n)}const eA=O({pad4d_:J5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X5(t,e,n){const s=$(t,"x","spaceToBatchND");I(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),I(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),I(s.shape.reduce((i,o,l)=>l>0&&l<=e.length?i&&(o+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const a={x:s},r={blockShape:e,paddings:n};return A.runKernel(hh,a,r)}const Dh=O({spaceToBatchND_:X5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y5(t,e,n,s,a,r,i){a==null&&(a=[1,1]),r==null&&(r=1),s===0&&(s="valid");const o=$(t,"x","maxPool");let l=o,u=!1;o.rank===3&&(u=!0,l=_(o,[1,o.shape[0],o.shape[1],o.shape[2]])),I(hn(r,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${r} and dilations '${a}'`);const c=Ys(l.shape,e,r,a,s),d=[c.dilationHeight,c.dilationWidth];let p;s==="same"?p=Z5([c.filterHeight,c.filterWidth],d):p=[[0,0],[0,0]];const h=d[0]===1&&d[1]===1,[f,m]=Q5([c.inHeight,c.inWidth],d,p),y=h?s:"valid",g=h?l:Dh(l,d,f),w=(n==="avg"?()=>Sh(g,e,r,y,i):()=>Ah(g,e,r,y,i))(),k=h?w:Nh(w,d,m);return u?_(k,[k.shape[1],k.shape[2],k.shape[3]]):k}function Q5(t,e,n){const s=n.map(c=>c[0]),a=n.map(c=>c[1]),r=t.concat(s,a),i=e.map((c,d)=>(c-r[d]%c)%c),o=a.map((c,d)=>c+i[d]),l=e.map((c,d)=>[s[d],o[d]]),u=e.map((c,d)=>[0,i[d]]);return[l,u]}function Z5(t,e){const s=t.map((i,o)=>i+(i-1)*(e[o]-1)).map(i=>i-1),a=s.map(i=>Math.floor(i/2)),r=s.map((i,o)=>i-a[o]);return s.map((i,o)=>[a[o],r[o]])}const Y1=O({pool_:Y5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e6(t,e){const n=$(t,"x","prelu"),s=$(e,"alpha","prelu"),a={x:n,alpha:s};return A.runKernel(ah,a)}const jh=O({prelu_:e6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t6(t,e=null,n=!1){let s=$(t,"x","prod");s.dtype==="bool"&&(s=oe(s,"int32"));const a={x:s},r={axis:e,keepDims:n};return A.runKernel(rh,a,r)}const Q1=O({prod_:t6});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n6(t,e,n,s){const a=t.map((c,d)=>$(c,`tensors${d}`,"raggedGather","int32")),r=$(e,"paramsDenseValues","raggedGather"),i=$(n,"indices","raggedGather","int32"),o={paramsNestedSplits:a,paramsDenseValues:r,indices:i},l={outputRaggedRank:s},u=A.runKernel(fy,o,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const tA=O({raggedGather_:n6});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6(t,e,n){const s=$(t,"starts","raggedRange"),a=$(e,"limits","raggedRange",s.dtype),r=$(n,"deltas","raggedRange",s.dtype),i={starts:s,limits:a,deltas:r},o=A.runKernel(my,i);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}const nA=O({raggedRange_:s6});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a6(t,e,n,s,a){const r=$(t,"shape","raggedTensorToTensor","int32"),i=$(e,"values","raggedTensorToTensor"),o=$(n,"defaultValue","raggedTensorToTensor",i.dtype),l=s.map((d,p)=>$(d,`tensors${p}`,"raggedTensorToTensor","int32")),u={shape:r,values:i,defaultValue:o,rowPartitionTensors:l},c={rowPartitionTypes:a};return A.runKernel(gy,u,c)}const sA=O({raggedTensorToTensor_:a6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r6(t,e,n){ms(t);const s=K(t);let a=null;if(n==null||n==="float32")a=new Float32Array(s);else if(n==="int32")a=new Int32Array(s);else if(n==="bool")a=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let r=0;r<s;r++)a[r]=e();return A.makeTensor(a,t,n)}const aA=O({rand_:r6});var Z1={exports:{}};Z1.exports;(function(t){(function(e,n,s){function a(l){var u=this,c=o();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function r(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var c=new a(l),d=u&&u.state,p=c.next;return p.int32=function(){return c.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&r(d,c),p.state=function(){return r(c,{})}),p}function o(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(Ir,t)})(Z1);var i6=Z1.exports,ev={exports:{}};ev.exports;(function(t){(function(e,n,s){function a(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function r(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function i(o,l){var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(Ir,t)})(ev);var o6=ev.exports,tv={exports:{}};tv.exports;(function(t){(function(e,n,s){function a(o){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function r(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function i(o,l){var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(Ir,t)})(tv);var l6=tv.exports,nv={exports:{}};nv.exports;(function(t){(function(e,n,s){function a(o){var l=this;l.next=function(){var c=l.x,d=l.i,p,h;return p=c[d],p^=p>>>7,h=p^p<<24,p=c[d+1&7],h^=p^p>>>10,p=c[d+3&7],h^=p^p>>>3,p=c[d+4&7],h^=p^p<<7,p=c[d+7&7],p=p^p<<13,h^=p^p<<9,c[d]=h,l.i=d+1&7,h};function u(c,d){var p,h=[];if(d===(d|0))h[0]=d;else for(d=""+d,p=0;p<d.length;++p)h[p&7]=h[p&7]<<15^d.charCodeAt(p)+h[p+1&7]<<13;for(;h.length<8;)h.push(0);for(p=0;p<8&&h[p]===0;++p);for(p==8?h[7]=-1:h[p],c.x=h,c.i=0,p=256;p>0;--p)c.next()}u(l,o)}function r(o,l){return l.x=o.x.slice(),l.i=o.i,l}function i(o,l){o==null&&(o=+new Date);var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.x&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(Ir,t)})(nv);var u6=nv.exports,sv={exports:{}};sv.exports;(function(t){(function(e,n,s){function a(o){var l=this;l.next=function(){var c=l.w,d=l.X,p=l.i,h,f;return l.w=c=c+1640531527|0,f=d[p+34&127],h=d[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,f=d[p]=f^h,l.i=p,f+(c^c>>>16)|0};function u(c,d){var p,h,f,m,y,g=[],b=128;for(d===(d|0)?(h=d,d=null):(d=d+"\0",h=0,b=Math.max(b,d.length)),f=0,m=-32;m<b;++m)d&&(h^=d.charCodeAt((m+32)%d.length)),m===0&&(y=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,m>=0&&(y=y+1640531527|0,p=g[m&127]^=h+y,f=p==0?f+1:0);for(f>=128&&(g[(d&&d.length||0)&127]=-1),f=127,m=4*128;m>0;--m)h=g[f+34&127],p=g[f=f+1&127],h^=h<<13,p^=p<<17,h^=h>>>15,p^=p>>>12,g[f]=h^p;c.w=y,c.X=g,c.i=f}u(l,o)}function r(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function i(o,l){o==null&&(o=+new Date);var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.X&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(Ir,t)})(sv);var c6=sv.exports,av={exports:{}};av.exports;(function(t){(function(e,n,s){function a(o){var l=this,u="";l.next=function(){var d=l.b,p=l.c,h=l.d,f=l.a;return d=d<<25^d>>>7^p,p=p-h|0,h=h<<24^h>>>8^f,f=f-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-h|0,l.d=h<<16^p>>>16^f,l.a=f-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function r(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function i(o,l){var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(Ir,t)})(av);var d6=av.exports,rA={exports:{}};const p6={},h6=Object.freeze(Object.defineProperty({__proto__:null,default:p6},Symbol.toStringTag,{value:"Module"})),f6=Mk(h6);(function(t){(function(e,n,s){var a=256,r=6,i=52,o="random",l=s.pow(a,r),u=s.pow(2,i),c=u*2,d=a-1,p;function h(k,x,S){var C=[];x=x==!0?{entropy:!0}:x||{};var T=g(y(x.entropy?[k,w(n)]:k??b(),3),C),E=new f(C),R=function(){for(var L=E.g(r),U=l,G=0;L<u;)L=(L+G)*a,U*=a,G=E.g(1);for(;L>=c;)L/=2,U/=2,G>>>=1;return(L+G)/U};return R.int32=function(){return E.g(4)|0},R.quick=function(){return E.g(4)/4294967296},R.double=R,g(w(E.S),n),(x.pass||S||function(L,U,G,F){return F&&(F.S&&m(F,E),L.state=function(){return m(E,{})}),G?(s[o]=L,U):L})(R,T,"global"in x?x.global:this==s,x.state)}function f(k){var x,S=k.length,C=this,T=0,E=C.i=C.j=0,R=C.S=[];for(S||(k=[S++]);T<a;)R[T]=T++;for(T=0;T<a;T++)R[T]=R[E=d&E+k[T%S]+(x=R[T])],R[E]=x;(C.g=function(L){for(var U,G=0,F=C.i,z=C.j,H=C.S;L--;)U=H[F=d&F+1],G=G*a+H[d&(H[F]=H[z=d&z+U])+(H[z]=U)];return C.i=F,C.j=z,G})(a)}function m(k,x){return x.i=k.i,x.j=k.j,x.S=k.S.slice(),x}function y(k,x){var S=[],C=typeof k,T;if(x&&C=="object")for(T in k)try{S.push(y(k[T],x-1))}catch{}return S.length?S:C=="string"?k:k+"\0"}function g(k,x){for(var S=k+"",C,T=0;T<S.length;)x[d&T]=d&(C^=x[d&T]*19)+S.charCodeAt(T++);return w(x)}function b(){try{var k;return p&&(k=p.randomBytes)?k=k(a):(k=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(k)),w(k)}catch{var x=e.navigator,S=x&&x.plugins;return[+new Date,e,S,e.screen,w(n)]}}function w(k){return String.fromCharCode.apply(0,k)}if(g(s.random(),n),t.exports){t.exports=h;try{p=f6}catch{}}else s["seed"+o]=h})(typeof self<"u"?self:Ir,[],Math)})(rA);var m6=rA.exports,g6=i6,y6=o6,b6=l6,w6=u6,k6=c6,x6=d6,Zo=m6;Zo.alea=g6;Zo.xor128=y6;Zo.xorwow=b6;Zo.xorshift7=w6;Zo.xor4096=k6;Zo.tychei=x6;var Qy=Zo;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v6=.001,iA=.1;function S6(t,e,n){return n==null&&(n=rv()),ok(t,e,(s,a)=>iv(s,a,n))}function rv(){return A.backend.floatPrecision()===32?v6:iA}function ok(t,e,n){let s=!0;if((Yt(t)||Yt(e))&&(s=!1),Yt(t)&&Yt(e)&&(s=!0),s){const i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${o}`)}if(Array.isArray(t)&&Array.isArray(e)){const i=Ja(t),o=Ja(e);if(!Le(i,o))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${o}]`)}const a=Yt(t)?t:qa(t),r=Yt(e)?e:qa(e);if(a.length!==r.length)throw new Error(`Arrays have different lengths actual: ${a.length} vs expected: ${r.length}.
Actual:   ${a}.
Expected: ${r}.`);for(let i=0;i<r.length;++i){const o=a[i],l=r[i];if(!n(o,l))throw new Error(`Arrays differ: actual[${i}] = ${o}, expected[${i}] = ${l}.
Actual:   ${a}.
Expected: ${r}.`)}typeof expect<"u"&&expect().nothing()}function N6(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function C6(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Ba(t)||Ba(t[0])||Ba(e)||Ba(e[0])?ok(t,n,(s,a)=>s==a):ok(t,e,(s,a)=>iv(s,a,0))}function I6(t,e,n){if(n==null&&(n=rv()),!iv(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function iv(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function T6(t,e,n){for(let s=0;s<t.length;s++)if(t[s]<e||t[s]>n)throw new Error(`Value out of range:${t[s]} low: ${e}, high: ${n}`)}function $6(t,e){const n=new Float32Array(t),s=new Float32Array(e);if(n.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${n.length}`);for(let a=0;a<s.length;a++)if(n[a]!==s[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${s[a]} but got ${n[a]} instead`)}function oA(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?oA(n):t[e]=Wa(n)}return t}function E6(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",s=>n(e)),e.load()})}async function R6(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const A6=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:iA,createVideoElement:E6,encodeStrings:oA,expectArrayBuffersEqual:$6,expectArraysClose:S6,expectArraysEqual:C6,expectNumbersClose:I6,expectPromiseToFail:N6,expectValuesInRange:T6,play:R6,testEpsilon:rv},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ov{constructor(e,n,s,a,r){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=r||Math.random();this.random=Qy.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const a=this.nextVal;return this.nextVal=NaN,a}let e,n,s=!1;for(;!s;){let a,r,i;do a=2*this.random()-1,r=2*this.random()-1,i=a*a+r*r;while(i>=1||i===0);const o=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*a*o,n=this.mean+this.stdDev*r*o,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class O6{constructor(e,n,s,a){this.alpha=e,this.beta=1/n,this.dtype=s;const r=a||Math.random();this.randu=Qy.alea(r.toString()),this.randn=new ov(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,s,a,r,i;for(;;){do a=this.randn.nextValue(),i=1+this.c*a;while(i<=0);if(i*=i*i,e=a*a,n=1-.331*e*e,s=.5*e+this.d*(1-i+Math.log(i)),r=this.randu(),r<n||Math.log(r)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class D6{constructor(e=0,n=1,s,a){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=Qy.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(t,e,n=1,s="float32",a){if(ms(t),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const r=new O6(e,n,s,a),i=Re(t,s);for(let o=0;o<i.values.length;o++)i.values[o]=r.nextValue();return i.toTensor()}const lA=O({randomGamma_:j6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _6(t,e=0,n=1,s,a){if(ms(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const r=new ov(e,n,s,!1,a),i=Re(t,s);for(let o=0;o<i.values.length;o++)i.values[o]=r.nextValue();return i.toTensor()}const Zy=O({randomNormal_:_6});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return Zy(t,0,1,e,n)}const uA=O({randomStandardNormal_:F6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6(t,e=0,n=1,s="float32",a){ms(t);const r=Re(t,s),i=new D6(e,n,null,a);for(let o=0;o<r.values.length;o++)r.values[o]=i.nextValue();return r.toTensor()}const zi=O({randomUniform_:P6});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(t,e,n,s){return zi(t,e,n,"int32",s)}const cA=O({randomUniformInt_:L6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jo(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const a={start:t,stop:e,step:n,dtype:s};return A.runKernel(yy,{},a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6(t){const n={input:$(t,"input","real")};return A.runKernel(by,n)}const su=O({real_:B6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z6(t){const n={x:$(t,"x","reciprocal")};return A.runKernel(Ju,n)}const lv=O({reciprocal_:z6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M6(t){const n={x:$(t,"x","relu")};return A.runKernel(Xu,n)}const Ta=O({relu_:M6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V6(t){const n={x:$(t,"x","relu6")};return A.runKernel(Yu,n)}const e0=O({relu6_:V6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(t,e){const s={x:$(t,"x","reverse")},a={dims:e};return A.runKernel(uh,s,a)}const $s=O({reverse_:W6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(t){const e=$(t,"x","reverse");return I(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),$s(e,0)}const dA=O({reverse1d_:U6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(t,e){const n=$(t,"x","reverse");return I(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),$s(n,e)}const pA=O({reverse2d_:G6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(t,e){const n=$(t,"x","reverse");return I(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),$s(n,e)}const hA=O({reverse3d_:H6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K6(t,e){const n=$(t,"x","reverse");return I(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),$s(n,e)}const fA=O({reverse4d_:K6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q6(t){const n={x:$(t,"x","round")};return A.runKernel(Qu,n)}const t0=O({round_:q6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J6(t){const n={x:$(t,"x","rsqrt","float32")};return A.runKernel(Zu,n)}const n0=O({rsqrt_:J6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(t){const n={x:$(t,"x","selu")};return A.runKernel(ec,n)}const s0=O({selu_:X6});function Y6(t,e,n,s,a,r=[1,1],i="NHWC"){const o=$(t,"x","separableConv2d"),l=$(e,"depthwiseFilter","separableConv2d"),u=$(n,"pointwiseFilter","separableConv2d");let c=o,d=!1;if(o.rank===3&&(d=!0,c=_(o,[1,o.shape[0],o.shape[1],o.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");I(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),I(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),I(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),I(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),I(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const p=l.shape[2],h=l.shape[3];I(u.shape[2]===p*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*h}, but got ${u.shape[2]}.`);const f=fc(c,l,s,a,i,r),y=Sr(f,u,1,"valid",i);return d?_(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const a0=O({separableConv2d_:Y6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Q6(t,e){const n=$(t,"x","setdiff1d"),s=$(e,"y","setdiff1d");I(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),I(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),I(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const a=await n.data(),r=await s.data(),i=new Set(r);let o=0;for(let c=0;c<a.length;c++)i.has(a[c])||o++;const l=new Bt([o],n.dtype),u=new Bt([o],"int32");for(let c=0,d=0;c<a.length;c++)i.has(a[c])||(l.values[d]=a[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const mA=Q6;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6(t){const n={x:$(t,"x","sign")};return A.runKernel(sc,n)}const uv=O({sign_:Z6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eG(t){const n={x:$(t,"x","sin","float32")};return A.runKernel(tc,n)}const r0=O({sin_:eG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tG(t){const n={x:$(t,"x","sinh")};return A.runKernel(nc,n)}const i0=O({sinh_:tG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(t,e,n){const s=$(t,"x","slice1d");return I(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),ze(s,[e],[n])}const _h=O({slice1d_:nG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sG(t,e,n){const s=$(t,"x","slice2d");return I(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),ze(s,e,n)}const o0=O({slice2d_:sG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aG(t,e,n){const s=$(t,"x","slice3d");return I(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),ze(s,e,n)}const Fh=O({slice3d_:aG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rG(t,e,n){const s=$(t,"x","slice4d");return I(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),ze(s,e,n)}const au=O({slice4d_:rG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iG(t,e=-1){const n=$(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},a={dim:e};return A.runKernel(mh,s,a)}const Ph=O({softmax_:iG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(t){I(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return A.runKernel(Zg,e)}const Lh=O({fft_:oG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(t){I(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return A.runKernel(sy,e)}const ru=O({ifft_:lG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uG(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const a=_(t,[n,e]);s=ru(a)}else{const a=[n,2*(e-1)],r=_(su(t),[n,e]),i=_(Ih(t),[n,e]),o=$s(ze(r,[0,1],[n,e-2]),1),l=D($s(ze(i,[0,1],[n,e-2]),1),Se(-1)),u=At([r,o],1),c=At([i,l],1),d=_(vr(u,c),[a[0],a[1]]);s=ru(d)}if(s=su(s),t.rank===3&&t.shape[0]!==0){const a=s,r=t.shape[0];s=_(s,[r,s.shape[0]/r,s.shape[1]]),a.dispose()}return s}const l0=O({irfft_:uG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cG(t,e,n=0){const a={x:$(t,"x","split")},r={numOrSizeSplits:e,axis:n};return A.runKernel(fh,a,r)}const Wn=O({split_:cG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(t,e){I(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let a;if(e!=null&&e<n){const f=t.shape.map(y=>0),m=t.shape.map(y=>y);m[t.shape.length-1]=e,a=ze(t,f,m),n=e}else if(e!=null&&e>n){const f=t.shape.map(m=>m);f[t.shape.length-1]=e-n,a=At([t,Lt(f)],t.shape.length-1),n=e}else a=t;const r=Me(a),i=_(vr(a,r),[s,n]),o=Lh(i),l=Math.floor(n/2)+1,u=su(o),c=Ih(o),d=Wn(u,[l,n-l],u.shape.length-1),p=Wn(c,[l,n-l],c.shape.length-1),h=a.shape.slice();return h[a.shape.length-1]=l,_(vr(d[0],p[0]),h)}const Bh=O({rfft_:dG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(t,e){let n=$(t,"a","squaredDifference"),s=$(e,"b","squaredDifference");[n,s]=St(n,s),Te(n.shape,s.shape);const a={a:n,b:s},r={};return A.runKernel(oc,a,r)}const u0=O({squaredDifference_:pG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hG(t,e){const n=$(t,"x","squeeze","string_or_numeric");return _(n,$r(n.shape,e).newShape)}const Mi=O({squeeze_:hG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(t,e=0){const n=Gd(t,"tensors","stack","string_or_numeric");I(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&I(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,a={axis:e};return A.runKernel(nh,s,a)}const qn=O({stack_:fG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mG(t,e=0){const s={x:$(t,"x","step")},a={alpha:e};return A.runKernel(pc,s,a)}const el=O({step_:mG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gG(t,e,n,s,a=0,r=0,i=0,o=0,l=0){const c={x:$(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:a,endMask:r,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};return A.runKernel(Ry,c,d)}const cv=O({stridedSlice_:gG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(t){const n={x:$(t,"x","tan","float32")};return A.runKernel(uc,n)}const dv=O({tan_:yG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wn(t,e){Ho(t);const n=Ja(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Fi(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fl(t,e,n){if(Ho(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Ja(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Fi(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pv(t,e,n){if(Ho(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Ja(t,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Fi(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gA(t,e,n){if(Ho(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Ja(t,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Fi(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yA(t,e,n){if(Ho(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Ja(t,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Fi(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bA(t,e,n){if(Ho(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Ja(t,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,Fi(t,e,s,n)}function hv(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,r=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(r+` update.rank < ${a}. `);if(t.length<s+(n.rank-a))throw new Error(r+` Output shape length < ${s+(n.rank-a)}`);if(n.rank!==a+t.length-s)throw new Error(r+` update.rank != ${a+t.length-s}`);for(let i=0;i<a;++i)if(n.shape[i]!==e.shape[i])throw new Error(r+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-a;++i)if(n.shape[i+a]!==t[i+s])throw new Error(r+` updates.shape[${i+a}] (${n.shape[i+a]}) != shape[${i+a}] (${t[i+a]})`)}function c0(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}hv(n,e,t)}function Vi(t,e,n){const s=e.shape.length,a=s>1?e.shape[s-1]:1,r=n.length;let i=1;for(let d=a;d<r;++d)i*=n[d];const o=a<1?1:a,l=K(e.shape)/o,u=[...ve(n.slice(0,a)),1],c=K(n);return{sliceRank:a,numUpdates:l,sliceSize:i,strides:u,outputSize:c}}const bG=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:Vi,validateInput:c0,validateUpdateShape:hv},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(t,e,n){const s=$(t,"tensor","tensorScatterupdate"),a=$(e,"indices","tensorScatterupdate","int32"),r=$(n,"updates","tensorScatterupdate");if(c0(r,a,s.shape),s.dtype!==r.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${r.dtype}.`);const i={tensor:s,indices:a,updates:r},o={};return A.runKernel(vy,i,o)}const wA=O({tensorScatterUpdate_:wG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kG(t,e=1,n=!0){const s=$(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const a=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${e}`);const r={x:s},i={k:e,sorted:n},[o,l]=A.runKernel(jy,r,i);return{values:o,indices:l}}const fv=O({topk_:kG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(t,e=0,n=1,s,a){if(ms(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const r=new ov(e,n,s,!0,a),i=Re(t,s);for(let o=0;o<i.values.length;o++)i.values[o]=r.nextValue();return i.toTensor()}const d0=O({truncatedNormal_:xG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(t,e=0){const n=$(t,"x","unique","string_or_numeric");I(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},a={axis:e},[r,i]=A.runKernel(Fy,s,a);return{values:r,indices:i}}const mv=O({unique_:vG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SG(t,e,n){const s=$(t,"x","unsortedSegmentSum"),a=$(e,"segmentIds","unsortedSegmentSum","int32");I(Io(n),()=>"numSegments must be of dtype int");const r={x:s,segmentIds:a},i={numSegments:n};return A.runKernel(bh,r,i)}const p0=O({unsortedSegmentSum_:SG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(t,e=0){const n=$(t,"x","unstack","string_or_numeric");I(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},a={axis:e};return A.runKernel(yh,s,a)}const Es=O({unstack_:NG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kA(t,e){return Yy(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gv(t,e=!0,n,s){return A.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h0(t,e){const n=[];for(let r=0;r<e.length;r++)e[r]&&n.push(r);const s=Re(t,"int32"),a=Re([n.length,t.length],"int32");for(let r=0;r<n.length;r++){const i=s.indexToLoc(n[r]),o=r*t.length;a.values.set(i,o)}return a.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function CG(t){const e=$(t,"condition","whereAsync","bool"),n=await e.data(),s=h0(e.shape,n);return t!==e&&e.dispose(),s}const yv=CG;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function IG(t,e,n){const s=$(t,"tensor","boolMask"),a=$(e,"mask","boolMask","bool"),r=n??0,i=a.rank,o=s.shape;I(i>0,()=>"mask cannot be scalar"),pn(o.slice(r,r+i),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=r;m<r+i;m++)l*=o[m];const u=o.slice(0,r).concat([l],o.slice(r+i)),c=_(s,u),d=_(a,[-1]),p=await yv(d),h=Mi(p,[1]),f=bc(c,h,r);return t!==s&&s.dispose(),e!==a&&a.dispose(),h.dispose(),c.dispose(),d.dispose(),p.dispose(),f}const xA=IG;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TG(t,e,n){const s=$(t,"x","transpose");if(e==null&&(e=s.shape.map((i,o)=>o).reverse()),I(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{I(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const a={x:s},r={perm:e};return s.dtype==="complex64"?M(()=>{let i=su(s),o=Ih(s);return i=A.runKernel(go,{x:i},r),o=A.runKernel(go,{x:o},r),n&&(o=ot(o)),vr(i,o)}):A.runKernel(go,a,r)}const Be=O({transpose_:TG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(t,e,n,s,a=!0){const r=$(t,"v","movingAverage"),i=$(e,"x","movingAverage"),o=$(n,"decay","movingAverage");mR(r,i),I(Le(r.shape,i.shape),()=>"Shape mismatch in v and x");const l=Se(1),u=pe(l,o);let c=D(pe(i,r),u);if(a){I(s!=null,()=>"When using zeroDebias: true, step is required.");const d=$(s,"step","movingAverage");c=xe(c,pe(l,Xa(o,d)))}return ee(r,c)}const vA=O({movingAverage_:$G});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EG(t,e,n){ms(n);const s=$(t,"indices","scatterND","int32"),a=$(e,"updates","scatterND");c0(a,s,n);const r={indices:s,updates:a},i={shape:n};return A.runKernel(xy,r,i)}const SA=O({scatterND_:EG});function RG(t,e,n,s){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const a=t.rank>0?t.shape[0]:1,r=t.rank>1?t.shape[1]:1;if(n.length!==r)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${r}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===a))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${a}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(t,e,n,s=0){ms(n);const a=$(t,"sparseIndices","sparseToDense","int32"),r=$(e,"sparseValues","sparseToDense","string_or_numeric"),i=$(s,"defaultValue","sparseToDense",r.dtype);RG(a,r,n,i);const o={sparseIndices:a,sparseValues:r,defaultValue:i},l={outputShape:n};return A.runKernel($y,o,l)}const NA=O({sparseToDense_:AG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(t,e){const n=$(e,"indices","gatherND","int32"),a={params:$(t,"x","gatherND","string_or_numeric"),indices:n};return A.runKernel(ny,a)}const CA=O({gatherND_:OG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(t,e){if(e==null)return t.shape.slice();if(Le(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(t,e,n,s){const a=$(t,"x","dropout");if(I(a.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),I(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof qe?a.clone():a;const r=DG(a,n),i=1-e,o=xe(yc(ee(zi(r,0,1,"float32",s),i)),i);return D(a,o)}const bv=O({dropout_:jG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wv(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function f0(t,e,n){const s=1-t%2,a=new Float32Array(t);for(let r=0;r<t;++r){const i=2*Math.PI*r/(t+s-1);a[r]=e-n*Math.cos(i)}return wn(a,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _G(t,e,n=1){const s=$(t,"predictions","inTopK"),a=$(e,"targets","inTopK");I(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),I(s.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${a.rank}`),pn(s.shape.slice(0,s.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const r=s.shape[s.shape.length-1];I(n>0&&n<=r,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${r}), but got ${n}`);const i=await s.data(),o=await a.data(),[l,u]=[i.length/r,r],c=en("bool",l);for(let d=0;d<l;d++){const p=d*u,h=i.subarray(p,p+u),f=[];for(let m=0;m<h.length;m++)f.push({value:h[m],index:m});f.sort((m,y)=>y.value-m.value),c[d]=0;for(let m=0;m<n;m++)if(f[m].index===o[d]){c[d]=1;break}}return t!==s&&s.dispose(),e!==a&&a.dispose(),Ks(c,a.shape,"bool")}const IA=_G;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FG(t,e,n,s,a,r="NHWC",i){let o=t;t.rank===3&&(o=_(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=_(e,[1,e.shape[0],e.shape[1],e.shape[2]])),I(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),I(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),I(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=r==="NHWC"?o.shape[3]:o.shape[1],c=r==="NHWC"?l.shape[3]:l.shape[1];I(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),I(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Fn("conv2dDerFilter",a,i);const d={x:o,dy:l},p={strides:s,pad:a,dataFormat:r,dimRoundingMode:i,filterShape:n};return A.runKernel(zg,d,p)}const kv=O({conv2DBackpropFilter_:FG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m0(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return D(t,el(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function g0(t,e){let n=e;const s=zt(t.shape,e.shape);return s.length>0&&(n=me(n,s)),_(n,t.shape)}function y0(t,e,n,s){if(e==="linear")return t;if(e==="relu")return Ta(t);if(e==="elu")return mc(t);if(e==="relu6")return e0(t);if(e==="prelu")return jh(t,n);if(e==="leakyrelu")return Th(t,s);if(e==="sigmoid")return ga(t);throw new Error(`Unknown fused activation ${e}.`)}const b0=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG({x:t,filter:e,strides:n,pad:s,dataFormat:a="NHWC",dilations:r=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",b0(A.state.gradientDepth,l)===!1){I(a==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=Sr(t,e,n,s,a,r,i);return o!=null&&(S=ee(S,o)),y0(S,l,u,c)}const d=$(t,"x","conv2d","float32"),p=$(e,"filter","conv2d","float32");let h=d,f=!1;d.rank===3&&(f=!0,h=_(d,[1,d.shape[0],d.shape[1],d.shape[2]])),I(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),I(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Fn("fused conv2d",s,i);const m=a==="NHWC"?h.shape[3]:h.shape[1];I(p.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${p.shape[2]}.`),I(hn(n,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`);const y=nn(h.shape,p.shape,n,r,s,i);let g;o!=null&&(g=$(o,"bias","fused conv2d"),[g]=St(g,d),a==="NHWC"?Te(y.outShape,g.shape):(I(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),I(g.shape.length===0||g.shape[0]===y.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let b;if(u!=null){const S=u.shape;if(I(S.length<=1||S.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),S.length===1)I(S[0]===1||S[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${y.outChannels}).`);else if(S.length===3)try{Te(S,y.outShape)}catch{const T=`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(T)}b=$(u,"prelu weights","fused conv2d")}const w=(S,C)=>{I(a==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);const[T,E,R,L]=C,U=m0(S,R,l);I(xi(r),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const G=O1(E.shape,U,T,n,s),F=kv(E,U,T.shape,n,s),z=[G,F];if(L!=null){const H=g0(L,U);z.push(H)}return z},k={x:h,filter:p,bias:g,preluActivationWeights:b},x={strides:n,pad:s,dataFormat:a,dilations:r,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return o==null?Ya((C,T,E)=>{let R=A.runKernel(zd,k,x);return E([T,C,R]),f&&(R=_(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:w}})(h,p):Ya((C,T,E,R)=>{let L=A.runKernel(zd,k,x);return R([T,C,L,E]),f&&(L=_(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:w}})(h,p,g)}const TA=O({fusedConv2d_:PG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LG(t,e,n,s,a,r=[1,1],i){let o=t;t.rank===3&&(o=_(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=_(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:o,dy:l},c={strides:s,pad:a,dimRoundingMode:i,dilations:r,filterShape:n};return A.runKernel(Kg,u,c)}const $A=O({depthwiseConv2dNativeBackpropFilter_:LG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BG(t,e,n,s,a,r=[1,1],i){let o=e,l=!1;e.rank===3&&(l=!0,o=_(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:o,filter:n},c={strides:s,pad:a,dimRoundingMode:i,dilations:r,inputShape:t},d=A.runKernel(qg,u,c);return l?_(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const EA=O({depthwiseConv2dNativeBackpropInput_:BG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zG({x:t,filter:e,strides:n,pad:s,dataFormat:a="NHWC",dilations:r=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(b0(A.state.gradientDepth,l)===!1){let x=fc(t,e,n,s,a,r,i);return o!=null&&(x=ee(x,o)),y0(x,l,u,c)}const d=$(t,"x","depthwiseConv2d","float32"),p=$(e,"filter","depthwiseConv2d","float32");let h=d,f=!1;d.rank===3&&(f=!0,h=_(d,[1,d.shape[0],d.shape[1],d.shape[2]])),I(h.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),I(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),I(h.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),r==null&&(r=[1,1]),I(hn(n,r),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`),Fn("fused depthwiseConv2d",s,i);const m=nn(h.shape,p.shape,n,r,s,i,!0);let y;o!=null&&(y=$(o,"bias","fused conv2d"),[y]=St(y,d),Te(m.outShape,y.shape));let g;u!=null&&(g=$(u,"prelu weights","fused depthwiseConv2d"));const b=(x,S)=>{I(xi(r),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${r}'`);const[C,T,E,R]=S,L=m0(x,E,l),U=EA(T.shape,L,C,n,s,r,i),G=$A(T,L,C.shape,n,s,r,i);if(R!=null){const F=g0(y,L);return[U,G,F]}return[U,G]},w={x:h,filter:p,bias:y,preluActivationWeights:g},k={strides:n,pad:s,dataFormat:a,dilations:r,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return o==null?Ya((S,C,T)=>{let E=A.runKernel(Md,w,k);return T([C,S,E]),f&&(E=_(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(h,p):Ya((S,C,T,E)=>{let R=A.runKernel(Md,w,k);return E([C,S,R,T]),f&&(R=_(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:b}})(h,p,y)}const MG=O({fusedDepthwiseConv2d_:zG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VG({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:a,activation:r="linear",preluActivationWeights:i,leakyreluAlpha:o=.2}){if(b0(A.state.gradientDepth,r)===!1){let L=je(t,e,n,s);return a!=null&&(L=ee(L,a)),y0(L,r,i,o)}let l=$(t,"a","fused matMul"),u=$(e,"b","fused matMul");[l,u]=St(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?u.shape[u.rank-1]:u.shape[u.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=s?u.shape[u.rank-2]:u.shape[u.rank-1],f=l.shape.slice(0,-2),m=u.shape.slice(0,-2),y=K(f),g=K(m);I(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=Te(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,h]),k=n?_(l,[y,c,p]):_(l,[y,p,c]),x=s?_(u,[g,h,d]):_(u,[g,d,h]);let S;a!=null&&(S=$(a,"bias","fused matMul"),[S]=St(S,l),Te(w,S.shape));let C;i!=null&&(C=$(i,"prelu weights","fused matMul"));const T=(L,U)=>{const[G,F,z,H]=U,X=m0(_(L,z.shape),z,r);let j,V;if(!n&&!s?(j=je(X,F,!1,!0),V=je(G,X,!0,!1)):!n&&s?(j=je(X,F,!1,!1),V=je(X,G,!0,!1)):n&&!s?(j=je(F,X,!1,!0),V=je(G,X,!1,!1)):(j=je(F,X,!0,!0),V=je(X,G,!0,!0)),a!=null){const q=g0(H,X);return[j,V,q]}else return[j,V]},E={a:k,b:x,bias:S,preluActivationWeights:C},R={transposeA:n,transposeB:s,activation:r,leakyreluAlpha:o};return a==null?Ya((U,G,F)=>{const z=A.runKernel(Bd,E,R);return F([U,G,z]),{value:_(z,w),gradFunc:T}})(k,x):Ya((U,G,F,z)=>{const H=A.runKernel(Bd,E,R);return z([U,G,H,F]),{value:_(H,w),gradFunc:T}})(k,x,S)}const lk=O({fusedMatMul_:VG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RA=Object.freeze(Object.defineProperty({__proto__:null,conv2d:TA,depthwiseConv2d:MG,matMul:lk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WG(t){return f0(t,.54,.46)}const UG=O({hammingWindow_:WG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(t){return f0(t,.5,.5)}const AA=O({hannWindow_:GG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG(t,e,n,s=!1,a=0){let r=0;const i=[];for(;r+e<=t.size;)i.push(ze(t,r,e)),r+=n;if(s)for(;r<t.size;){const o=r+e-t.size,l=At([ze(t,r,e-o),Yo([o],a)]);i.push(l),r+=n}return i.length===0?Fl([],[0,e]):_(At(i),[i.length,e])}const OA=O({frame_:HG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(t,e,n,s,a=AA){s==null&&(s=wv(e));const r=OA(t,e,n),i=D(r,a(e));return Bh(i,s)}const qG=O({stft_:KG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JG(t,e,n,s,a="bilinear",r=0){const i=$(t,"image","cropAndResize"),o=$(e,"boxes","cropAndResize","float32"),l=$(n,"boxInd","cropAndResize","int32"),u=o.shape[0];I(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),I(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),I(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),I(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),I(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),I(a==="bilinear"||a==="nearest",()=>`method must be bilinear or nearest, but was ${a}`);const c={image:i,boxes:o,boxInd:l},d={method:a,extrapolationValue:r,cropSize:s};return A.runKernel(Ug,c,d)}const XG=O({cropAndResize_:JG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YG(t){const e=$(t,"image","flipLeftRight","float32");I(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return A.runKernel(ty,n,{})}const QG=O({flipLeftRight_:YG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZG(t){const e=$(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];I(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),I(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const a=new Array(e.rank);return a.fill(1,0,n),a[n]=3,vs(e,a)}const eH=O({grayscaleToRGB_:ZG});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tH(t){const e=$(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];I(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),I(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const a=e.dtype,r=oe(e,"float32"),i=wn([.2989,.587,.114]);let o;switch(e.rank){case 2:o=to("ij,j->i",r,i);break;case 3:o=to("ijk,k->ij",r,i);break;case 4:o=to("ijkl,l->ijk",r,i);break;case 5:o=to("ijklm,m->ijkl",r,i);break;case 6:o=to("ijklmn,n->ijklm",r,i);break;default:throw new Error("Not a valid tensor rank.")}return o=bn(o,-1),oe(o,a)}const nH=O({rgbToGrayscale_:tH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sH(t,e,n=0,s=.5){const a=$(t,"image","rotateWithOffset","float32");I(a.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);const r={image:a},i={radians:e,fillValue:n,center:s};return A.runKernel(Py,r,i)}const aH=O({rotateWithOffset_:sH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wc(t,e,n,s,a,r){s==null&&(s=.5),a==null&&(a=Number.NEGATIVE_INFINITY),r==null&&(r=0);const i=t.shape[0];return n=Math.min(n,i),I(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),I(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),I(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),I(e.rank===1,()=>"scores must be a 1D tensor"),I(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),I(0<=r&&r<=1,()=>`softNmsSigma must be in [0, 1], but was '${r}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:a,softNmsSigma:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rH(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY){const r=$(t,"boxes","nonMaxSuppression","float32"),i=$(e,"scores","nonMaxSuppression","float32"),o=wc(r,i,n,s,a);n=o.maxOutputSize,s=o.iouThreshold,a=o.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:a};return A.runKernel(dy,{boxes:r,scores:i},l)}const iH=O({nonMaxSuppression_:rH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oH(t,e,n){const s=lH(t,e,n),a=s<0?-(s+1):s;t.splice(a,0,e)}function lH(t,e,n){return cH(t,e,n||uH)}function uH(t,e){return t>e?1:t<e?-1:0}function cH(t,e,n){let s=0,a=t.length,r=0,i=!1;for(;s<a;){r=s+(a-s>>>1);const o=n(e,t[r]);o>0?s=r+1:(a=r,i=!o)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w0(t,e,n,s,a){return xv(t,e,n,s,a,0)}function k0(t,e,n,s,a,r){return xv(t,e,n,s,a,0,!1,r,!0)}function x0(t,e,n,s,a,r){return xv(t,e,n,s,a,r,!0)}function xv(t,e,n,s,a,r,i=!1,o=!1,l=!1){const u=[];for(let y=0;y<e.length;y++)e[y]>a&&u.push({score:e[y],boxIndex:y,suppressBeginIndex:0});u.sort(aC);const c=r>0?-.5/r:0,d=[],p=[];for(;d.length<n&&u.length>0;){const y=u.pop(),{score:g,boxIndex:b,suppressBeginIndex:w}=y;if(g<a)break;let k=!1;for(let x=d.length-1;x>=w;--x){const S=dH(t,b,d[x]);if(S>=s){k=!0;break}if(y.score=y.score*pH(s,c,S),y.score<=a)break}y.suppressBeginIndex=d.length,k||(y.score===g?(d.push(b),p.push(y.score)):y.score>a&&oH(u,y,aC))}const h=d.length,f=n-h;o&&f>0&&(d.push(...new Array(f).fill(0)),p.push(...new Array(f).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=p),l&&(m.validOutputs=h),m}function dH(t,e,n){const s=t.subarray(e*4,e*4+4),a=t.subarray(n*4,n*4+4),r=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),o=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),u=Math.min(a[0],a[2]),c=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),h=(o-r)*(l-i),f=(d-u)*(p-c);if(h<=0||f<=0)return 0;const m=Math.max(r,u),y=Math.max(i,c),g=Math.min(o,d),b=Math.min(l,p),w=Math.max(g-m,0)*Math.max(b-y,0);return w/(h+f-w)}function pH(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function aC(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hH(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY){const r=$(t,"boxes","nonMaxSuppressionAsync"),i=$(e,"scores","nonMaxSuppressionAsync"),o=wc(r,i,n,s,a);n=o.maxOutputSize,s=o.iouThreshold,a=o.scoreThreshold;const l=await Promise.all([r.data(),i.data()]),u=l[0],c=l[1],{selectedIndices:d}=w0(u,c,n,s,a);return r!==t&&r.dispose(),i!==e&&i.dispose(),wn(d,"int32")}const fH=hH;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mH(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY,r=0){const i=$(t,"boxes","nonMaxSuppression"),o=$(e,"scores","nonMaxSuppression"),l=wc(i,o,n,s,a,r);n=l.maxOutputSize,s=l.iouThreshold,a=l.scoreThreshold,r=l.softNmsSigma;const u={boxes:i,scores:o},c={maxOutputSize:n,iouThreshold:s,scoreThreshold:a,softNmsSigma:r},d=A.runKernel(hy,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const gH=O({nonMaxSuppressionWithScore_:mH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function yH(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY,r=0){const i=$(t,"boxes","nonMaxSuppressionAsync"),o=$(e,"scores","nonMaxSuppressionAsync"),l=wc(i,o,n,s,a,r);n=l.maxOutputSize,s=l.iouThreshold,a=l.scoreThreshold,r=l.softNmsSigma;const u=await Promise.all([i.data(),o.data()]),c=u[0],d=u[1],{selectedIndices:p,selectedScores:h}=x0(c,d,n,s,a,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),{selectedIndices:wn(p,"int32"),selectedScores:wn(h)}}const bH=yH;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wH(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY,r=!1){const i=$(t,"boxes","nonMaxSuppression"),o=$(e,"scores","nonMaxSuppression"),l=wc(i,o,n,s,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,p={boxes:i,scores:o},h={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:r},f=A.runKernel(py,p,h);return{selectedIndices:f[0],validOutputs:f[1]}}const kH=O({nonMaxSuppressionPadded_:wH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function xH(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY,r=!1){const i=$(t,"boxes","nonMaxSuppressionAsync"),o=$(e,"scores","nonMaxSuppressionAsync"),l=wc(i,o,n,s,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[p,h]=await Promise.all([i.data(),o.data()]),{selectedIndices:f,validOutputs:m}=k0(p,h,u,c,d,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),{selectedIndices:wn(f,"int32"),validOutputs:Se(m,"int32")}}const vH=xH;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SH(t,e,n=!1,s=!1){const a=$(t,"images","resizeBilinear");I(a.rank===3||a.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),I(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),I(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let r=a,i=!1;a.rank===3&&(i=!0,r=_(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const o={images:r},l={alignCorners:n,halfPixelCenters:s,size:e},u=A.runKernel(lh,o,l);return i?_(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const DA=O({resizeBilinear_:SH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NH(t,e,n=!1,s=!1){const a=$(t,"images","resizeNearestNeighbor");I(a.rank===3||a.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),I(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),I(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),I(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let r=a,i=!1;a.rank===3&&(i=!0,r=_(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const o={images:r},l={alignCorners:n,halfPixelCenters:s,size:e},u=A.runKernel(oh,o,l);return i?_(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const jA=O({resizeNearestNeighbor_:NH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CH(t,e="binary",n=!1,s=.5){const a=$(t,"image","threshold"),r=.2989,i=.587,o=.114,l=a.shape[0]*a.shape[1];let u=D(wn([s]),255),c,d,p,h;if(I(a.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),I(a.shape[2]===3||a.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),I(a.dtype==="int32"||a.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),I(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),a.shape[2]===3){[c,d,p]=Wn(a,[1,1,1],-1);const y=D(c,r),g=D(d,i),b=D(p,o);h=ee(ee(y,g),b)}else h=t;if(e==="otsu"){const y=I1(oe(t0(h),"int32"),Ks([]),256);u=IH(y,l)}const f=n?Bi(h,u):Qn(h,u);return oe(D(f,255),"int32")}function IH(t,e){let n=wn([-1]),s=wn([0]),a=wn([0]),r,i,o,l,u,c;for(let d=0;d<t.size-1;d++){r=ze(t,0,d+1),i=ze(t,d+1),u=xe(me(r),e),c=xe(me(i),e);const p=me(D(r,jo(0,r.size)));o=xe(p,me(r));const h=Yo(i.shape,r.size),f=ee(jo(0,i.size),h),m=D(i,f);l=xe(me(m),me(i));const y=pe(o,l),g=pe(o,l),b=D(u,c);a=D(D(b,y),g);const w=Qn(a,s);s=cn(w,a,s),n=cn(w,wn([d]),n)}return n}const TH=O({threshold_:CH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $H(t,e,n="nearest",s="constant",a=0,r){const i=$(t,"image","transform","float32"),o=$(e,"transforms","transform","float32");I(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),I(o.rank===2&&(o.shape[0]===i.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),I(r==null||r.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${r}.`);const l={image:i,transforms:o},u={interpolation:n,fillMode:s,fillValue:a,outputShape:r};return A.runKernel(_y,l,u)}const EH=O({transform_:$H});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(t,e,n){const s=$(t,"a","bandPart");I(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const a=s.shape,[r,i]=s.shape.slice(-2);let o,l;typeof e=="number"?(I(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),I(e<=r,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${r}).`),o=$(e<0?r:e,"numLower","bandPart")):(I(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=cn(tu(e,0),r,Si(e,r))),typeof n=="number"?(I(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),I(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=$(n<0?i:n,"numUpper","bandPart")):(I(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=cn(tu(n,0),i,Si(n,i)));const u=_(jo(0,r,1,"int32"),[-1,1]),c=jo(0,i,1,"int32"),d=pe(u,c),p=wa(Bi(d,o),Or(d,ot(l))),h=Lt([r,i],s.dtype);return _(qn(Es(_(s,[-1,r,i])).map(f=>cn(p,f,h))),a)}const AH=O({bandPart_:RH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OH(t){let e;if(Array.isArray(t)){e=!1,I(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const a=t[0].shape[0];for(let r=1;r<t.length;++r)I(t[r].shape[0]===a,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[r].shape[0]} vs. ${a})`)}else e=!0,t=Wn(t,t.shape[0],0).map(a=>Mi(a,[0]));I(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let a=0;a<t.length;++a)n.push(A.tidy(()=>{let r=s[a];if(a>0)for(let i=0;i<a;++i){const o=D(me(D(n[i],r)),n[i]);r=pe(r,o)}return xe(r,gc(r,"euclidean"))}));return e?qn(n,0):n}const DH=O({gramSchmidt_:OH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(t,e=!1){if(I(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return rC(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),s=Es(_(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],r=[];s.forEach(l=>{const[u,c]=rC(l,e);a.push(u),r.push(c)});const i=_(qn(a,0),t.shape),o=_(qn(r,0),t.shape);return[i,o]}}function rC(t,e=!1){return A.tidy(()=>{I(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let a=Ky(n),r=Ua(t);const i=Fl([[1]],[1,1]);let o=Ua(i);const l=n>=s?s:n;for(let u=0;u<l;++u){const c=r,d=o,p=a;[o,r,a]=A.tidy(()=>{const h=ze(r,[u,u],[n-u,1]),f=gc(h),m=ze(r,[u,u],[1,1]),y=cn(Qn(m,0),Fl([[-1]]),Fl([[1]])),g=pe(m,D(y,f)),b=xe(h,g);b.shape[0]===1?o=Ua(i):o=At([i,ze(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const w=ot(xe(je(y,g),f)),k=ze(r,[u,0],[n-u,s]),x=D(w,o),S=Be(o);if(u===0)r=pe(k,je(x,je(S,k)));else{const E=pe(k,je(x,je(S,k)));r=At([ze(r,[0,0],[u,s]),E],0)}const C=Be(x),T=ze(a,[0,u],[n,a.shape[1]-u]);if(u===0)a=pe(T,je(je(T,o),C));else{const E=pe(T,je(je(T,o),C));a=At([ze(a,[0,0],[n,u]),E],1)}return[o,r,a]}),_e([c,d,p])}return!e&&n>s&&(a=ze(a,[0,0],[n,s]),r=ze(r,[0,0],[s,s])),[a,r]})}const _H=O({qr_:jH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var On;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(On||(On={}));function FH(t,e,n=On.SUM_BY_NONZERO_WEIGHTS){const s=$(t,"losses","computeWeightedLoss");let a=null;e!=null&&(a=$(e,"weights","computeWeightedLoss"));const r=a==null?s:D(s,a);if(n===On.NONE)return r;if(n===On.SUM)return me(r);if(n===On.MEAN){if(a==null)return xt(r);{const i=s.size/a.size,o=xe(me(r),me(a));return i>1?xe(o,Se(i)):o}}if(n===On.SUM_BY_NONZERO_WEIGHTS){if(a==null)return xe(me(r),Se(s.size));{const i=D(a,Mn(s.shape)),o=oe(me(Do(i,Se(0))),"float32");return xe(me(r),o)}}throw Error(`Unknown reduction: ${n}`)}const jr=O({computeWeightedLoss_:FH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PH(t,e,n,s=On.SUM_BY_NONZERO_WEIGHTS){const a=$(t,"labels","absoluteDifference"),r=$(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=$(n,"weights","absoluteDifference")),pn(a.shape,r.shape,"Error in absoluteDifference: ");const o=Ft(pe(a,r));return jr(o,i,s)}const LH=O({absoluteDifference_:PH});function BH(t,e,n,s,a=On.SUM_BY_NONZERO_WEIGHTS){const r=$(t,"labels","cosineDistance"),i=$(e,"predictions","cosineDistance");let o=null;s!=null&&(o=$(s,"weights","cosineDistance")),pn(r.shape,i.shape,"Error in cosineDistance: ");const l=Se(1),u=pe(l,me(D(r,i),n,!0));return jr(u,o,a)}const zH=O({cosineDistance_:BH});function MH(t,e,n,s=On.SUM_BY_NONZERO_WEIGHTS){let a=$(t,"labels","hingeLoss");const r=$(e,"predictions","hingeLoss");let i=null;n!=null&&(i=$(n,"weights","hingeLoss")),pn(a.shape,r.shape,"Error in hingeLoss: ");const o=Se(1);a=pe(D(Se(2),a),o);const l=Ta(pe(o,D(a,r)));return jr(l,i,s)}const VH=O({hingeLoss_:MH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(t,e,n,s=1,a=On.SUM_BY_NONZERO_WEIGHTS){const r=$(t,"labels","huberLoss"),i=$(e,"predictions","huberLoss");let o=null;n!=null&&(o=$(n,"weights","huberLoss")),pn(r.shape,i.shape,"Error in huberLoss: ");const l=Se(s),u=Ft(pe(i,r)),c=Si(u,l),d=pe(u,c),p=ee(D(Se(.5),et(c)),D(l,d));return jr(p,o,a)}const UH=O({huberLoss_:WH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH(t,e,n,s=1e-7,a=On.SUM_BY_NONZERO_WEIGHTS){const r=$(t,"labels","logLoss"),i=$(e,"predictions","logLoss");let o=null;n!=null&&(o=$(n,"weights","logLoss")),pn(r.shape,i.shape,"Error in logLoss: ");const l=Se(1),u=Se(s),c=ot(D(r,ds(ee(i,u)))),d=D(pe(l,r),ds(ee(pe(l,i),u))),p=pe(c,d);return jr(p,o,a)}const HH=O({logLoss_:GH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KH(t,e,n,s=On.SUM_BY_NONZERO_WEIGHTS){const a=$(t,"labels","meanSquaredError"),r=$(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=$(n,"weights","meanSquaredError")),pn(a.shape,r.shape,"Error in meanSquaredError: ");const o=u0(a,r);return jr(o,i,s)}const qH=O({meanSquaredError_:KH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(t,e){const n=$(t,"labels","sigmoidCrossEntropyWithLogits"),s=$(e,"logits","sigmoidCrossEntropyWithLogits");pn(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=Ta(s),r=D(s,n),i=$h(Kn(ot(Ft(s))));return ee(pe(a,r),i)}function XH(t,e,n,s=0,a=On.SUM_BY_NONZERO_WEIGHTS){let r=$(t,"multiClassLabels","sigmoidCrossEntropy");const i=$(e,"logits","sigmoidCrossEntropy");let o=null;if(n!=null&&(o=$(n,"weights","sigmoidCrossEntropy")),pn(r.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const u=Se(s),c=Se(1),d=Se(.5);r=ee(D(r,pe(c,u)),D(d,u))}const l=JH(r,i);return jr(l,o,a)}const YH=O({sigmoidCrossEntropy_:XH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Ya((a,r,i)=>{const l=Eh(r,[n],!0),u=pe(oe(r,"float32"),l);i([a,u]);const c=ot(D(u,a));return{value:me(c,[n]),gradFunc:(h,f)=>{const[m,y]=f,g=Ot(h.shape,[n]);return[D(_(h,g),pe(oe(m,"float32"),Kn(y))),D(_(h,g),pe(Kn(y),oe(m,"float32")))]}}})(t,e)}function ZH(t,e,n,s=0,a=On.SUM_BY_NONZERO_WEIGHTS){let r=$(t,"onehotLabels","softmaxCrossEntropy");const i=$(e,"logits","softmaxCrossEntropy");let o=null;if(n!=null&&(o=$(n,"weights","softmaxCrossEntropy")),pn(r.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const u=Se(s),c=Se(1),d=Se(r.shape[1]);r=ee(D(r,pe(c,u)),xe(u,d))}const l=QH(r,i);return jr(l,o,a)}const e8=O({softmaxCrossEntropy_:ZH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t8(t,e,n,s){const a=$(t,"indices","sparseFillEmptyRows","int32"),r=$(e,"values","sparseFillEmptyRows"),i=$(n,"denseShape","sparseFillEmptyRows","int32"),o=$(s,"defaultValue","sparseFillEmptyRows",r.dtype);if(a.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(r.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:a,values:r,denseShape:i,defaultValue:o},u=A.runKernel(Ny,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const n8=O({sparseFillEmptyRows_:t8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s8(t,e,n){const s=$(t,"inputIndices","sparseReshape","int32"),a=$(e,"inputShape","sparseReshape","int32"),r=$(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(a.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(r.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${r.shape}`);const i={inputIndices:s,inputShape:a,newShape:r},o=A.runKernel(Cy,i);return{outputIndices:o[0],outputShape:o[1]}}const a8=O({sparseReshape_:s8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8(t,e,n){const s=$(t,"data","sparseSegmentMean"),a=$(e,"indices","sparseSegmentMean","int32"),r=$(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(r.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${r.shape}`);const i={data:s,indices:a,segmentIds:r};return A.runKernel(Iy,i)}const i8=O({sparseSegmentMean_:r8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(t,e,n){const s=$(t,"data","sparseSegmentSum"),a=$(e,"indices","sparseSegmentSum","int32"),r=$(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(r.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${r.shape}`);const i={data:s,indices:a,segmentIds:r};return A.runKernel(Ty,i)}const l8=O({sparseSegmentSum_:o8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u8(t,e,n,s,a,r,i,o){const l=$(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=$(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:s,leftPad:a,rightPad:r,padWidth:i,preserveShortSequences:o},d={data:l,dataSplits:u},p=A.runKernel(Ay,d,c);return{nGrams:p[0],nGramsSplits:p[1]}}const c8=O({stringNGrams_:u8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(t,e,n=!0){const s=$(t,"input","stringSplit","string"),a=$(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(a.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);const r={skipEmpty:n},i={input:s,delimiter:a},o=A.runKernel(Oy,i,r);return{indices:o[0],values:o[1],shape:o[2]}}const p8=O({stringSplit_:d8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h8(t,e){const n=$(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return A.runKernel(Dy,a,s)}const f8=O({stringToHashBucketFast_:h8});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(t,e,n,s=!0){const a=$(t,"input","staticRegexReplace","string"),r={pattern:e,rewrite:n,replaceGlobal:s};return A.runKernel(gh,{x:a},r)}const g8=O({staticRegexReplace_:m8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _A={fft:Lh,ifft:ru,rfft:Bh,irfft:l0},FA={hammingWindow:UG,hannWindow:AA,frame:OA,stft:qG},pa={flipLeftRight:QG,grayscaleToRGB:eH,resizeNearestNeighbor:jA,resizeBilinear:DA,rgbToGrayscale:nH,rotateWithOffset:aH,cropAndResize:XG,nonMaxSuppression:iH,nonMaxSuppressionAsync:fH,nonMaxSuppressionWithScore:gH,nonMaxSuppressionWithScoreAsync:bH,nonMaxSuppressionPadded:kH,nonMaxSuppressionPaddedAsync:vH,threshold:TH,transform:EH},vv={bandPart:AH,gramSchmidt:DH,qr:_H},PA={absoluteDifference:LH,computeWeightedLoss:jr,cosineDistance:zH,hingeLoss:VH,huberLoss:UH,logLoss:HH,meanSquaredError:qH,sigmoidCrossEntropy:YH,softmaxCrossEntropy:e8},LA={sparseFillEmptyRows:n8,sparseReshape:a8,sparseSegmentMean:i8,sparseSegmentSum:l8},BA={stringNGrams:c8,stringSplit:p8,stringToHashBucketFast:f8,staticRegexReplace:g8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y8=new Map,uk=new Map;class tl{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class ks{constructor(){this.classNameMap={}}static getMap(){return ks.instance==null&&(ks.instance=new ks),ks.instance}static register(e){ks.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function te(t,e,n){I(t.className!=null,()=>"Class being registered does not have the static className property defined."),I(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),I(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,a=e+">"+s;return ks.register(t),y8.set(a,t),uk.set(t,a),t}function b8(t){return uk.has(t)?uk.get(t):t.className}const w8=Object.freeze(Object.defineProperty({__proto__:null,Serializable:tl,SerializationMap:ks,getRegisteredName:b8,registerClass:te},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _r extends tl{minimize(e,n=!1,s){const{value:a,grads:r}=this.computeGradients(e,s);if(s!=null){const i=s.map(o=>({name:o.name,tensor:r[o.name]}));this.applyGradients(i)}else this.applyGradients(r);return _e(r),n?a:(a.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return UR(e,n)}dispose(){this.iterations_!=null&&_e(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Se(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(_r,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sv extends _r{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=A.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=A.registeredVariables[s],i=!1;this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:`${s}/accum_grad`,variable:M(()=>Me(r).variable(i))}),this.accumulatedUpdates[a]==null&&(this.accumulatedUpdates[a]={originalName:`${s}/accum_var`,variable:M(()=>Me(r).variable(i))});const o=Array.isArray(e)?e[a].tensor:e[s];if(o==null)return;const l=this.accumulatedGrads[a].variable,u=this.accumulatedUpdates[a].variable;M(()=>{const c=ee(D(l,this.rho),D(et(o),1-this.rho)),d=D(xe(tn(ee(u,this.epsilon)),tn(ee(l,this.epsilon))),o),p=ee(D(u,this.rho),D(et(d),1-this.rho));l.assign(c),u.assign(p);const h=ee(D(d,-this.learningRate),r);r.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(_e(this.accumulatedGrads.map(e=>e.variable)),_e(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nv extends _r{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=A.registeredVariables[s];this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:`${s}/accumulator`,variable:M(()=>Yo(r.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[a].tensor:e[s];if(i==null)return;const o=this.accumulatedGrads[a].variable;M(()=>{const l=ee(o,et(i));o.assign(l);const u=ee(D(xe(i,tn(ee(l,A.backend.epsilon()))),-this.learningRate),r);r.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&_e(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cv extends _r{static get className(){return"Adam"}constructor(e,n,s,a=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],M(()=>{this.accBeta1=Se(n).variable(),this.accBeta2=Se(s).variable()}),a==null&&(this.epsilon=A.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);M(()=>{const s=pe(1,this.accBeta1),a=pe(1,this.accBeta2);n.forEach((r,i)=>{const o=A.registeredVariables[r],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${r}/m`,variable:M(()=>Me(o).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${r}/v`,variable:M(()=>Me(o).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[r];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,p=ee(D(c,this.beta1),D(u,1-this.beta1)),h=ee(D(d,this.beta2),D(et(u),1-this.beta2)),f=xe(p,s),m=xe(h,a);c.assign(p),d.assign(h);const y=ee(D(xe(f,ee(tn(m),this.epsilon)),-this.learningRate),o);o.assign(y)}),this.accBeta1.assign(D(this.accBeta1,this.beta1)),this.accBeta2.assign(D(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&_e(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&_e(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),M(()=>{this.accBeta1.assign(Xa(this.beta1,this.iterations_+1)),this.accBeta2.assign(Xa(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Iv extends _r{static get className(){return"Adamax"}constructor(e,n,s,a=null,r=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=a,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],M(()=>{this.iteration=Se(0).variable(),this.accBeta1=Se(n).variable()}),a==null&&(this.epsilon=A.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);M(()=>{const s=pe(1,this.accBeta1),a=xe(-this.learningRate,ee(D(this.iteration,this.decay),1));n.forEach((r,i)=>{const o=A.registeredVariables[r],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${r}/m`,variable:Me(o).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${r}/v`,variable:Me(o).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[r];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,p=ee(D(c,this.beta1),D(u,1-this.beta1)),h=D(d,this.beta2),f=Ft(u),m=er(h,f);c.assign(p),d.assign(m);const y=ee(D(xe(a,s),xe(p,ee(m,this.epsilon))),o);o.assign(y)}),this.iteration.assign(ee(this.iteration,1)),this.accBeta1.assign(D(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&_e(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&_e(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v0 extends _r{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=Array.isArray(e)?e[a].tensor:e[s];if(r==null)return;const i=A.registeredVariables[s];M(()=>{const o=ee(D(this.c,r),i);i.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Vt(Se(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tv extends v0{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Se(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=A.registeredVariables[s];this.accumulations[a]==null&&(this.accumulations[a]={originalName:`${s}/momentum`,variable:M(()=>Me(r).variable(!1))});const i=this.accumulations[a].variable,o=Array.isArray(e)?e[a].tensor:e[s];o!=null&&M(()=>{let l;const u=ee(D(this.m,i),o);this.useNesterov?l=ee(D(this.c,ee(o,D(u,this.m))),r):l=ee(D(this.c,u),r),i.assign(u),r.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&_e(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $v extends _r{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,a=null,r=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,a==null&&(this.epsilon=A.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=A.registeredVariables[s],i=!1;this.accumulatedMeanSquares[a]==null&&(this.accumulatedMeanSquares[a]={originalName:`${s}/rms`,variable:M(()=>Me(r).variable(i))}),this.accumulatedMoments[a]==null&&(this.accumulatedMoments[a]={originalName:`${s}/momentum`,variable:M(()=>Me(r).variable(i))}),this.accumulatedMeanGrads[a]==null&&this.centered&&(this.accumulatedMeanGrads[a]={originalName:`${s}/mg`,variable:M(()=>Me(r).variable(i))});const o=Array.isArray(e)?e[a].tensor:e[s];if(o==null)return;const l=this.accumulatedMeanSquares[a].variable,u=this.accumulatedMoments[a].variable;M(()=>{const c=ee(D(l,this.decay),D(et(o),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[a].variable,p=ee(D(d,this.decay),D(o,1-this.decay)),h=xe(D(o,this.learningRate),tn(pe(c,ee(et(p),this.epsilon)))),f=ee(D(u,this.momentum),h);l.assign(c),d.assign(p),u.assign(f);const m=pe(r,f);r.assign(m)}else{const d=ee(D(l,this.decay),D(et(o),1-this.decay)),p=ee(D(u,this.momentum),xe(D(o,this.learningRate),tn(ee(d,this.epsilon))));l.assign(d),u.assign(p);const h=pe(r,p);r.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&_e(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&_e(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&_e(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k8=[Sv,Nv,Cv,Iv,Tv,$v,v0];function x8(){for(const t of k8)te(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v8="model",S8=".json",N8=".weights.bin";function iC(t){return new Promise(e=>setTimeout(e)).then(t)}class _o{constructor(e){if(!W().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(_o.URL_SCHEME)&&(e=e.slice(_o.URL_SCHEME.length)),(e==null||e.length===0)&&(e=v8),this.modelJsonFileName=e+S8,this.weightDataFileName=e+N8}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=Ia.join(e.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const a=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r=CR(e,a),i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await iC(()=>o.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await iC(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:xh(e)}}}}_o.URL_SCHEME="downloads://";class C8{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const s=new FileReader;s.onload=a=>{const r=JSON.parse(a.target.result),i=r.modelTopology;if(i==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(r.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=d1(r,u=>this.loadWeights(u));e(l)},s.onerror=a=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const n=[],s=[];for(const i of e)n.push(...i.weights),s.push(...i.paths);const a=this.checkManifestAndWeightFiles(e),r=s.map(i=>this.loadWeightsFile(i,a[i]));return Promise.all(r).then(i=>[n,i])}loadWeightsFile(e,n){return new Promise((s,a)=>{const r=new FileReader;r.onload=i=>{const o=i.target.result;s(o)},r.onerror=i=>a(`Failed to weights data from file of path '${e}'.`),r.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],s=this.weightsFiles.map(r=>sC(r.name)),a={};for(const r of e)r.paths.forEach(i=>{const o=sC(i);if(n.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(n.push(o),s.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);a[i]=this.weightsFiles[s.indexOf(o)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return a}}const I8=t=>W().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(_o.URL_SCHEME)?T8(t.slice(_o.URL_SCHEME.length)):null;wt.registerSaveRouter(I8);function T8(t="model"){return new _o(t)}function $8(t){return new C8(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oC(t,e,n,s){i(t),n=n??0,s=s??1,o(n,s);let a=0;const r=l=>(l.then(u=>{const c=n+ ++a/t.length*(s-n);return e(c),u}),l);function i(l){I(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,u){I(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),I(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),I(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function zA(t,e){e==null&&(e={});const n=e.fetchFunc==null?W().platform.fetch:e.fetchFunc,s=t.map(d=>n(d,e.requestInit,{isBinary:!0})),o=(e.onProgress==null?await Promise.all(s):await oC(s,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(o):await oC(o,e.onProgress,.5,1)}function E8(t,e){var n;const s=e.fetchFunc==null?W().platform.fetch:e.fetchFunc;let a=0,r;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async i=>{for(var o;a<t.length;){r||(r=(await s(t[a],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await r.read();if(l){a++,r=void 0,(o=e.onProgress)===null||o===void 0||o.call(e,a/t.length);continue}i.enqueue(u);return}i.close()}})}async function R8(t,e="",n,s){return MA(i=>zA(i,{requestInit:s}))(t,e,n)}function MA(t){return async(e,n="",s)=>{const a=e.map(()=>!1),r={},i=s!=null?s.map(()=>!1):[],o=[];if(e.forEach((h,f)=>{let m=0;h.weights.forEach(y=>{const g="quantization"in y?y.quantization.dtype:y.dtype,b=To[g]*K(y.shape),w=()=>{a[f]=!0,r[f]==null&&(r[f]=[]),r[f].push({manifestEntry:y,groupOffset:m,sizeBytes:b})};s!=null?s.forEach((k,x)=>{k===y.name&&(w(),i[x]=!0)}):w(),o.push(y.name),m+=b})}),!i.every(h=>h)){const h=s.filter((f,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${h.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=a.reduce((h,f,m)=>(f&&h.push(m),h),[]),u=[];l.forEach(h=>{e[h].paths.forEach(f=>{const m=n+(n.endsWith("/")?"":"/")+f;u.push(m)})});const c=await t(u),d={};let p=0;return l.forEach(h=>{const f=e[h].paths.length,m=new Ia(c.slice(p,p+f));r[h].forEach(g=>{const b=m.slice(g.groupOffset,g.groupOffset+g.sizeBytes),w=xR(b,[g.manifestEntry]);for(const k in w)d[k]=w[k]}),p+=f}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A8="application/octet-stream",O8="application/json";class Ev{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(I(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=W().platform.fetch,I(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&I(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=CR(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(a)],{type:O8}),"model.json"),e.weightData!=null){const i=Ia.join(e.weightData);n.body.append("model.weights.bin",new Blob([i],{type:A8}),"model.weights.bin")}const r=await this.fetch(this.path,n);if(r.ok)return{modelArtifactsInfo:xh(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=n.modelTopology,a=n.weightsManifest;if(s==null&&a==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return d1(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=zm(e.weightsManifest),a=()=>E8(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:a})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,a]=D8(n),r=this.weightPathPrefix||s,i=[],o=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?o.push(this.weightUrlConverter(u)):i.push(r+u+a);return this.weightUrlConverter&&i.push(...await Promise.all(o)),i}async loadWeights(e){const n=await this.getWeightUrls(e),s=zm(e),a=await zA(n,this.loadOptions);return[s,a]}}Ev.URL_SCHEME_REGEX=/^https?:\/\//;function D8(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),a=n>e?t.substring(n):"";return[s+"/",a]}function ck(t){return t.match(Ev.URL_SCHEME_REGEX)!=null}const VA=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>ck(s)):n=ck(t),n)return Rv(t,e)}return null};wt.registerSaveRouter(VA);wt.registerLoadRouter(VA);function Rv(t,e){return new Ev(t,e)}function j8(t,e){return Rv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tb{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class WA{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class _8{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function F8(t,e,n,s){const a=arguments;return new _8(Vm(...a))}function Vm(t,e,n,s){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new Tb(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Tb({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Tb({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:s}))}function P8(t){return new WA(t)}function L8(t){return new WA(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Av=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Ia,browserFiles:$8,browserHTTPRequest:j8,concatenateArrayBuffers:NR,copyModel:gW,decodeWeights:xR,decodeWeightsStream:SR,encodeWeights:nk,fromMemory:F8,fromMemorySync:Vm,getLoadHandlers:nW,getModelArtifactsForJSON:d1,getModelArtifactsForJSONSync:c1,getModelArtifactsInfoForJSON:xh,getSaveHandlers:IR,getWeightSpecs:zm,http:Rv,isHTTPScheme:ck,listModels:fW,loadWeights:R8,moveModel:yW,registerLoadRouter:tW,registerSaveRouter:eW,removeModel:mW,weightsLoaderFactory:MA,withSaveHandler:P8,withSaveHandlerSync:L8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8(t,e,n){const s=$(t,"labels","confusionMatrix"),a=$(e,"predictions","confusionMatrix");I(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),I(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),I(a.rank===1,()=>`Expected the rank of predictions to be 1, but got ${a.rank}`),I(s.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),I(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const r=nu(oe(s,"int32"),n),i=nu(oe(a,"int32"),n),o=Be(r),l=je(o,i);return oe(l,"int32")}const z8=O({confusionMatrix_:B8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M8=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:z8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ki,lC=!1;function UA(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,a=!1,r=!1,i=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)r=!0;else if(t.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(Wd(Pm,A.backendName)!=null){const f={pixels:t},m={numChannels:e};return A.runKernel(Pm,f,m)}const[u,c]=a?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(i)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(s||n)d=t.data;else if(r||a||o){if(Ki==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Ki=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Ki=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Ki.canvas.width=u,Ki.canvas.height=c,Ki.drawImage(t,0,0,u,c),d=Ki.getImageData(0,0,u,c).data}let p;if(e===4)p=new Int32Array(d);else{const f=u*c;p=new Int32Array(f*e);for(let m=0;m<f;m++)for(let y=0;y<e;++y)p[m*e+y]=d[m*4+y]}return pv(p,[c,u,e],"int32")}function V8(t){return t!=null&&t.data instanceof Uint8Array}function W8(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function U8(t){return t!=null&&t.width!==0&&t.height!==0}function G8(t){return W8()&&!(t instanceof ImageBitmap)&&U8(t)&&!V8(t)}async function H8(t,e=3){let n=null;if(W().getBool("WRAP_TO_IMAGEBITMAP")&&G8(t)){let s;try{s=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===t.width&&s.height===t.height?n=s:n=t}else n=t;return UA(n,e)}function GA(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function K8(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function q8(t,e){let n=$(t,"img","toPixels");if(!(t instanceof qe)){const u=n;n=oe(u,"int32"),u.dispose()}GA(n);const[s,a]=n.shape.slice(0,2),r=n.rank===2?1:n.shape[2],i=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(a*s*4);for(let u=0;u<s*a;++u){const c=[0,0,0,255];for(let p=0;p<r;p++){const h=i[u*r+p];if(n.dtype==="float32"){if(h<0||h>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${h}.`)}else if(n.dtype==="int32"&&(h<0||h>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${h}.`);r===1?(c[0]=h*o,c[1]=h*o,c[2]=h*o):c[p]=h*o}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){lC||Wd(Xg,A.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),lC=!0),e.width=a,e.height=s;const u=e.getContext("2d"),c=new ImageData(l,a,s);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}function J8(t,e,n){let s=$(t,"img","draw");if(!(t instanceof qe)){const i=s;s=oe(i,"int32"),i.dispose()}GA(s),K8(n==null?void 0:n.imageOptions);const a={image:s},r={canvas:e,options:n};A.runKernel(Xg,a,r)}const X8=O({fromPixels_:UA}),Y8=Object.freeze(Object.defineProperty({__proto__:null,draw:J8,fromPixels:X8,fromPixelsAsync:H8,toPixels:q8},Symbol.toStringTag,{value:"Module"}));function S0(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(K(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const a=e.shape,r=a[a.length-1];let i=1;for(let d=0;d<a.length-1;++d)i*=a[d];const o=t.shape,l=a.slice();l.pop();let u=1;for(let d=r;d<n;++d)u*=o[d],l.push(o[d]);const c=[...ve(t.shape).map(d=>d/u),1].slice(0,r);return[l,i,u,c]}const Q8=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:S0},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dk=-2,Z8=-1;function Ov(t,e,n){const s=t.shape.length;I(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),I(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let a=0;a<s;++a)I(e[a]+n[a]<=t.shape[a],()=>`Error in slice${s}D: begin[${a}] + size[${a}] (${e[a]+n[a]}) would overflow input.shape[${a}] (${t.shape[a]})`)}function eK(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function Dv(t,e,n){const s=[];for(let a=0;a<t.length;a++)s[a]=Math.ceil((e[a]-t[a])/n[a]);return s}function HA(t,e,n,s){const a=[...t];for(let r=a.length;r<s.length;r++)a.push(1);for(let r=0;r<n;r++)r===0?a[e]=1:(a.splice(e,0,1),a.pop());return a}function KA(t,e,n){return n<=t?n:n-(e-1)}function qA(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function tK(t,e,n,s,a,r,i,o,l){const u=t.length;let c=new Array(u),d=new Array(u),p=new Array(u);if(e.length&&n>0){const h=e[0],f=n+1;c=JA(i,h,f,s,t),d=XA(o,h,f,a,t),p=HA(r,h,f,t)}else for(let h=0;h<u;h++)c[h]=QA(i,s,r,t,h,l),d[h]=ZA(o,a,r,t,h,l),p[h]=YA(r,h,l);return{begin:c,end:d,strides:p}}function JA(t,e,n,s,a){const r=[...a],i=qA(n,e);for(let o=0;o<r.length;o++)if(i.indexOf(o)>-1)r[o]=0;else{const l=KA(e,n,o);let u=s[l];t&1<<l&&(u=0),r[o]=u}return r}function XA(t,e,n,s,a){const r=[...a],i=qA(n,e);for(let o=0;o<r.length;o++)if(i.indexOf(o)>-1)r[o]=Number.MAX_SAFE_INTEGER;else{const l=KA(e,n,o);let u=s[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),r[o]=u}for(let o=0;o<r.length;o++){const l=a[o];r[o]<0&&(r[o]+=l),r[o]=yi(0,r[o],a[o])}return r}function YA(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function QA(t,e,n,s,a,r){let i=e[a];const o=n[a]||1;(t&1<<a||r&1<<a||i==null)&&(o>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[a];return i<0&&(i+=l),i=yi(0,i,l-1),i}function ZA(t,e,n,s,a,r){let i=e[a];const o=n[a]||1;(t&1<<a||r&1<<a||i==null)&&(o>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[a];return i<0&&(i+=l),o>0?i=yi(0,i,l):i=yi(-1,i,l-1),i}function jv(t,e,n){let s=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){s=a;break}for(let a=s+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function _v(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function N0(t,e,n){let s;const a=t.shape.length;typeof e=="number"?s=[e,...new Array(a-1).fill(0)]:e.length<a?s=e.concat(new Array(a-e.length).fill(0)):s=e.slice(),s.forEach(i=>{I(i!==-1,()=>"slice() does not support negative begin indexing.")});let r;return n==null?r=new Array(a).fill(-1):typeof n=="number"?r=[n,...new Array(a-1).fill(-1)]:n.length<a?r=n.concat(new Array(a-n.length).fill(-1)):r=n,r=r.map((i,o)=>i>=0?i:(I(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${o}.`),t.shape[o]-s[o])),[s,r]}function Fv(t,e,n,s,a,r,i,o,l){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:a,endMask:r,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};for(let w=0;w<d.dims;w++)c&&1<<w&o&&d.numAddAxisAfterEllipsis++,1<<w&i&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};nK(d,p);let h=!0,f=!0,m=!0;const y=[],g=[];for(let w=0;w<t.length;++w){if(p.strides[w]===0)throw Error(`strides[${w}] must be non-zero`);const k=!!(p.shrinkAxisMask&1<<w),x=t[w];if(x===-1){y.push(k?1:-1);continue}const S=[p.beginMask&1<<w,p.endMask&1<<w],C=[p.strides[w]>0?0:-1,p.strides[w]>0?x:x-1];if(k&&p.strides[w]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&p.strides[w]===1;const T=!!(p.beginMask&1<<w&&p.endMask&1<<w);if(p.beginValid&&p.endValid){if(k){const U=p.begin[w]<0?x+p.begin[w]:p.begin[w];if(p.begin[w]=U,p.end[w]=p.begin[w]+1,U<0||U>=x)throw Error(`slice index ${p.begin[w]} of dimension ${w} out of bounds.`)}else p.begin[w]=uC(p.begin[w],0,p.strides[w],x,S,C),p.end[w]=uC(p.end[w],1,p.strides[w],x,S,C);const L=p.strides[w]===1&&p.begin[w]===0&&p.end[w]===x;h=h&&L,f=f&&(w===0&&p.strides[w]===1||L)}else h=h&&p.strides[w]===1&&T,f=f&&(w===0&&p.strides[w]===1||T);let E,R=!1;if(p.beginValid&&p.endValid?(E=p.end[w]-p.begin[w],R=!0):k?(E=1,R=!0):T&&x>=0&&(p.strides[w]<0?E=-x:E=x,R=!0),R){let L;E===0||E<0!=p.strides[w]<0?L=0:L=Math.trunc(E/p.strides[w])+(E%p.strides[w]!==0?1:0),y.push(L)}else y.push(-1)}for(let w=0;w<p.finalShapeGatherIndices.length;++w){const k=p.finalShapeGatherIndices[w];k>=0?g.push(y[k]):k===dk&&g.push(1)}return{finalShapeSparse:g.filter((w,k)=>p.finalShapeGatherIndices[k]!==dk),finalShape:g,isIdentity:h,sliceDim0:f,isSimpleSlice:m,begin:p.begin,end:p.end,strides:p.strides}}function nK(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const a=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<a;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(dk),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(Z8),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function uC(t,e,n,s,a,r){if(a[e])return n>0?r[e]:r[e+1&1];{const i=t<0?s+t:t;return i<r[0]?r[0]:i>r[1]?r[1]:i}}const eO=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:Ov,computeFlatOffset:_v,computeOutShape:Dv,getNormalizedAxes:tK,isSliceContinous:jv,maskToAxes:eK,parseSliceParams:N0,sliceInfo:Fv,startForAxis:QA,startIndicesWithElidedDims:JA,stopForAxis:ZA,stopIndicesWithElidedDims:XA,stridesForAxis:YA,stridesWithElidedDims:HA},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const sK="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tO{static sgd(e){return new v0(e)}static momentum(e,n,s=!1){return new Tv(e,n,s)}static rmsprop(e,n=.9,s=0,a=null,r=!1){return new $v(e,n,s,a,r)}static adam(e=.001,n=.9,s=.999,a=null){return new Cv(e,n,s,a)}static adadelta(e=.001,n=.95,s=null){return new Sv(e,n,s)}static adamax(e=.002,n=.9,s=.999,a=null,r=0){return new Iv(e,n,s,a,r)}static adagrad(e,n=.1){return new Nv(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zi=tO;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aK=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function Pv(){return new Promise(t=>aK(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lv(t,e){const n=t[0].length;t.forEach((a,r)=>{I(a.length===n,()=>`Error in concat${n}D: rank of tensors[${r}] must be the same as the rank of the rest (${n})`)}),I(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((a,r)=>{for(let i=0;i<n;i++)I(i===e||a[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${r}] (${a}) does not match the shape of the rest (${s}) along the non-concatenated axis ${r}.`)})}function Ga(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ca;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(ca||(ca={}));function nO(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let a=1;a<n.length;++a){const r=n[a],i=s[s.length-n.length+a],o=s[i];if(r>=0)if(o>=0){if(o!==r)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${a+t}] = ${r} but shape[${a+t}] = ${o}`)}else s[i]=r}return s}function sO(t){const e={FIRST_DIM_SIZE:ca.FIRST_DIM_SIZE,VALUE_ROWIDS:ca.VALUE_ROWIDS,ROW_LENGTHS:ca.ROW_LENGTHS,ROW_SPLITS:ca.ROW_SPLITS,ROW_LIMITS:ca.ROW_LIMITS,ROW_STARTS:ca.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function aO(t){return t.length===0?0:t[0]===ca.FIRST_DIM_SIZE?t.length-1:t.length}function rO(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let a=0;a<Math.min(n,s-1);++a){const r=t[a],i=e[a+1];if(r>=0&&i>=0&&r!==1&&r!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${a-t.length}] = ${r} but ragged tensor input.flatValues.shape[${a-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bv=30;function C0(t){return t<=Bv?t:jm(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zv(t,e,n){const s=n*(typeof t=="number"?t:t[0]),a=e*(typeof t=="number"?t:t[1]);return[s,a]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zh(t,e,n,s=!0){let a=[];if(s)a=a.concat(e.slice(0)),a.push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);const r=e.length;for(let i=0;i<r;++i)a=a.concat([t[i+1]/e[i],e[i]]);a=a.concat(t.slice(r+1))}return a}function Mh(t,e,n=!0){const s=[];if(n){s.push(e);for(let a=e+1;a<t;++a)a<=2*e?(s.push(a),s.push(a-(e+1))):s.push(a)}else{const a=[],r=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?r.push(i):a.push(i);s.push(...a),s.push(0),s.push(...r)}return s}function Vh(t,e,n,s=!0){const a=[];s?a.push(t[0]/n):a.push(t[0]*n);for(let r=1;r<t.length;++r)r<=e.length?s?a.push(e[r-1]*t[r]):a.push(t[r]/e[r-1]):a.push(t[r]);return a}function Mv(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function Vv(t,e,n){const s=t.slice(0,1);for(let a=0;a<n;++a)s.push(t[a+1]-e[a][0]-e[a][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I0=1.7580993408473768,T0=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wv=.3275911,Uv=.254829592,Gv=-.284496736,Hv=1.421413741,Kv=-1.453152027,qv=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nr(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function iO(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function oO(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],s[Math.floor(a/4)]=t[a+1];return{real:n,imag:s}}function lO(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],s[Math.floor(a/4)]=t[a+1];return{real:n,imag:s}}function Jv(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function uO(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function cO(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let a=0;a<Math.ceil(t/2);a++){const r=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(r),s[a]=Math.sin(r)}return{real:n,imag:s}}function dO(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),a=Math.cos(s),r=Math.sin(s);return{real:a,imag:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $b="->",rK=/->/g,cC=",",dC="...";function Xv(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(rK,"").length)/$b.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${$b}").`);const[s,a]=t.split($b);I(s.indexOf(dC)===-1,()=>`The ellipsis notation ("${dC}") is not supported yet.`);const r=s.split(cC),i=r.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let p=0;p<a.length;++p){const h=a[p];if(!r.some(f=>f.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);o.indexOf(h)===-1&&o.push(h)}for(let p=0;p<s.length;++p){const h=s[p];o.indexOf(h)===-1&&h!==cC&&o.push(h)}const l=new Array(r.length);for(let p=0;p<i;++p){if(new Set(r[p].split("")).size!==r[p].length)throw new Error(`Found duplicate axes in input component ${r[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let h=0;h<r[p].length;++h)l[p].push(o.indexOf(r[p][h]))}const u=o.length,c=a.length,d=[];for(let p=c;p<u;++p)d.push(p);return{allDims:o,summedDims:d,idDims:l}}function Yv(t,e){let n=new Array(t);n.fill(-1);for(let a=0;a<e.length;++a)n[e[a]]=a;const s=[];for(let a=0;a<t;++a)n[a]===-1&&s.push(a);return n=n.filter(a=>a!==-1),{permutationIndices:n,expandDims:s}}function Qv(t,e,n){const s=new Array(t);for(let a=0;a<n.length;++a){const r=n[a].shape;for(let i=0;i<e[a].length;++i)s[e[a][i]]===void 0?s[e[a][i]]=r[i]:I(s[e[a][i]]===r[i],()=>`Expected dimension ${s[e[a][i]]} at axis ${i} of input shaped ${JSON.stringify(r)}, but got dimension ${r[i]}`)}}function Zv(t,e){const n=t,s=[];let a=0;t.length===0&&n.push(-1),a=t.length+1;for(let i=0;i<a;++i)s.push([]);const r=[];for(let i=0;i<n.length;++i){const o=n[i],l=iK(e,o);for(const u of l)r.indexOf(u)===-1&&(s[i].push(u),r.push(u))}return{path:n,steps:s}}function e2(t){return t.every((e,n)=>e===n)}function iK(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function t2(t,e,n=0){let s=[];if(typeof e=="number")I(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const a=e.reduce((i,o)=>(o===-1&&(i+=1),i),0);I(a<=1,()=>"There should be only one negative value in split array.");const r=e.indexOf(-1);if(r!==-1){const i=e.reduce((o,l)=>l>0?o+l:o);e[r]=t.shape[n]-i}I(t.shape[n]===e.reduce((i,o)=>i+o),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pO(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function hO(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function fO(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mO(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function gO(t,e){return`size ${t} must be non-negative, not ${e}`}function yO(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function bO(t,e){const n=K(t),s=K(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function wO(t,e){const n=K(t),s=K(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pk(){return"segment ids must be >= 0"}function kO(){return"segment ids are not increasing"}function xO(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function vO(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SO(t,e){let n=!1,s;for(t<=Bv?(s=t,n=!0):s=jm(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=jm(t,s+1);return s}function NO(t,e,n){const s=[],a=t.length;for(let r=0;r<a;r++)r!==e?s.push(t[r]):s.push(n);return s}function n2(t,e,n,s){const a=e.shape.length,r=t.shape.length;if(s!==0&&(s<-a||s>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${s}`);if(s<0&&(s+=a),s>r)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${r}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],o=[];let l=1,u=1,c=1;for(let d=0;d<s;++d)o.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)o.push(t.shape[d]),u*=t.shape[d];for(let d=s;d<a;d++)o.push(e.shape[d]);for(let d=n+1;d<r;d++)o.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:i,outputShape:o}}const oK=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:n2,computeOutShape:NO,segOpComputeOptimalWindowSize:SO},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cr(t){try{return t.map(e=>xr(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function CO(t){return t.map(e=>Wa(e))}const IO=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:Uv,ERF_A2:Gv,ERF_A3:Hv,ERF_A4:Kv,ERF_A5:qv,ERF_P:Wv,PARALLELIZE_THRESHOLD:Bv,get RowPartitionType(){return ca},SELU_SCALE:T0,SELU_SCALEALPHA:I0,applyActivation:y0,assertAndGetBroadcastShape:Te,assertAxesAreInnerMostDims:fn,assertParamsConsistent:Lv,assignToTypedArray:uO,axesAreInnerMostDims:B1,calculateShapes:Vi,checkEinsumDimSizes:Qv,checkPadOnDimRoundingMode:Fn,combineLocations:MR,combineRaggedTensorToTensorShapes:nO,complexWithEvenIndex:oO,complexWithOddIndex:lO,computeConv2DInfo:nn,computeConv3DInfo:Pi,computeDefaultPad:x1,computeDilation2DInfo:vh,computeOptimalWindowSize:C0,computeOutAndReduceShapes:sn,computeOutShape:Ga,computePool2DInfo:Ys,computePool3DInfo:Rr,convertConv2DDataFormat:Ar,decodeEinsumEquation:Xv,eitherStridesOrDilationsAreOne:hn,expandShapeToKeepDim:Ot,exponent:dO,exponents:cO,fromStringArrayToUint8:CO,fromUint8ToStringArray:Cr,getAxesPermutation:Nt,getBroadcastDims:Oo,getComplexWithIndex:Jv,getEinsumComputePath:Zv,getEinsumPermutation:Yv,getFusedBiasGradient:g0,getFusedDyActivation:m0,getImageCenter:zv,getInnerMostAxes:Dt,getPermuted:Mh,getRaggedRank:aO,getReductionAxes:zt,getReshaped:zh,getReshapedPermuted:Vh,getRowPartitionTypesHelper:sO,getSliceBeginCoords:Mv,getSliceSize:Vv,getSparseFillEmptyRowsIndicesDenseShapeMismatch:pO,getSparseFillEmptyRowsNegativeIndexErrorMessage:hO,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:fO,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:yO,getSparseReshapeInputOutputMismatchErrorMessage:wO,getSparseReshapeInputOutputMultipleErrorMessage:bO,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:mO,getSparseReshapeNegativeOutputDimErrorMessage:gO,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:vO,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:pk,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:kO,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:xO,getUndoAxesPermutation:Li,isIdentityPermutation:e2,log:eV,mergeRealAndImagArrays:Nr,prepareAndValidate:S0,prepareSplitSize:t2,segment_util:oK,shouldFuse:b0,slice_util:eO,splitRealAndImagArrays:iO,stridesOrDilationsArePositive:Ao,tupleValuesAreOne:xi,upcastType:Un,validateDefaultValueShape:rO,validateInput:c0,validateUpdateShape:hv,warn:ws},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lK=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:w0,nonMaxSuppressionV4Impl:k0,nonMaxSuppressionV5Impl:x0,whereImpl:h0},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */x8();const uK=Object.freeze(Object.defineProperty({__proto__:null,Abs:yp,Acos:bu,Acosh:wu,AdadeltaOptimizer:Sv,AdagradOptimizer:Nv,AdamOptimizer:Cv,AdamaxOptimizer:Iv,Add:Jo,AddN:bp,All:Dg,Any:jg,ArgMax:wp,ArgMin:kp,Asin:ku,Asinh:xu,Atan:vu,Atan2:Nu,Atanh:Su,AvgPool:xp,AvgPool3D:vp,AvgPool3DGrad:Fg,AvgPoolGrad:_g,BatchMatMul:Sp,BatchToSpaceND:Np,Bincount:Pg,BitwiseAnd:Cp,BroadcastArgs:Lg,BroadcastTo:ZE,Cast:Cu,Ceil:Iu,ClipByValue:Tu,Complex:Bg,ComplexAbs:Ip,Concat:Tp,Conv2D:$p,Conv2DBackpropFilter:zg,Conv2DBackpropInput:Ep,Conv3D:Rp,Conv3DBackpropFilterV2:Mg,Conv3DBackpropInputV2:Vg,Cos:$u,Cosh:Eu,CropAndResize:Ug,Cumprod:Wg,Cumsum:Ap,DataStorage:qx,DenseBincount:Gg,DepthToSpace:Hg,DepthwiseConv2dNative:Op,DepthwiseConv2dNativeBackpropFilter:Kg,DepthwiseConv2dNativeBackpropInput:qg,Diag:Jg,Dilation2D:Dp,Dilation2DBackpropFilter:Fm,Dilation2DBackpropInput:_m,Draw:Xg,get ENV(){return Zx},Einsum:Yg,Elu:Au,EluGrad:Qg,Environment:YE,Equal:jp,Erf:Ou,Exp:Du,ExpandDims:_p,Expm1:ju,FFT:Zg,Fill:ey,FlipLeftRight:ty,Floor:_u,FloorDiv:Fu,FromPixels:Pm,FusedBatchNorm:Fp,FusedConv2D:zd,FusedDepthwiseConv2D:Md,GatherNd:ny,GatherV2:Pp,Greater:Lp,GreaterEqual:Pu,IFFT:sy,Identity:Lu,Imag:ay,IsFinite:Bu,IsInf:zu,IsNan:Mu,KernelBackend:Rg,LRN:Gp,LRNGrad:iy,LeakyRelu:Bp,Less:zp,LessEqual:Mp,LinSpace:ry,Log:Vu,Log1p:Wu,LogSoftmax:eR,LogicalAnd:Vp,LogicalNot:Wp,LogicalOr:Up,LogicalXor:J4,LowerBound:X4,MatrixBandPart:Y4,Max:Hp,MaxPool:Kp,MaxPool3D:qp,MaxPool3DGrad:ly,MaxPoolGrad:oy,MaxPoolWithArgmax:uy,Maximum:Uu,Mean:Jp,Min:Xp,Minimum:Gu,MirrorPad:Yp,Mod:Hu,MomentumOptimizer:Tv,Multinomial:cy,Multiply:Ku,Neg:Qp,NonMaxSuppressionV3:dy,NonMaxSuppressionV4:py,NonMaxSuppressionV5:hy,NotEqual:Zp,OP_SCOPE_SUFFIX:i1,OneHot:th,OnesLike:eh,Optimizer:_r,OptimizerConstructors:tO,Pack:nh,PadV2:sh,Pool:Q4,Pow:qu,Prelu:ah,Prod:rh,RMSPropOptimizer:$v,RaggedGather:fy,RaggedRange:my,RaggedTensorToTensor:gy,Range:yy,get Rank(){return Jw},Real:by,RealDiv:Ru,Reciprocal:Ju,get Reduction(){return On},Relu:Xu,Relu6:Yu,Reshape:ih,ResizeBilinear:lh,ResizeBilinearGrad:ky,ResizeNearestNeighbor:oh,ResizeNearestNeighborGrad:wy,Reverse:uh,RotateWithOffset:Py,Round:Qu,Rsqrt:Zu,SGDOptimizer:v0,ScatterNd:xy,SearchSorted:Sy,Select:ch,Selu:ec,Sigmoid:ac,Sign:sc,Sin:tc,Sinh:nc,Slice:dh,Softmax:mh,Softplus:rc,SpaceToBatchND:hh,SparseFillEmptyRows:Ny,SparseReshape:Cy,SparseSegmentMean:Iy,SparseSegmentSum:Ty,SparseToDense:$y,SplitV:fh,Sqrt:ic,Square:Ey,SquaredDifference:oc,StaticRegexReplace:gh,Step:pc,StridedSlice:Ry,StringNGrams:Ay,StringSplit:Oy,StringToHashBucketFast:Dy,Sub:lc,Sum:ph,Tan:uc,Tanh:cc,Tensor:qe,TensorBuffer:Bt,TensorScatterUpdate:vy,Tile:dc,TopK:jy,Transform:_y,Transpose:go,Unique:Fy,Unpack:yh,UnsortedSegmentSum:bh,UpperBound:Z4,Variable:Ud,ZerosLike:wh,_FusedMatMul:Bd,abs:Ft,acos:h1,acosh:f1,add:ee,addN:jR,all:My,any:Hd,argMax:Ro,argMin:m1,asin:g1,asinh:y1,atan:b1,atan2:w1,atanh:k1,avgPool:Sh,avgPool3d:v1,backend:l1,backend_util:IO,basicLSTMCell:_R,batchNorm:hc,batchNorm2d:S1,batchNorm3d:N1,batchNorm4d:C1,batchToSpaceND:Nh,bincount:I1,bitwiseAnd:FR,booleanMaskAsync:xA,broadcastArgs:PR,broadcastTo:yo,broadcast_util:OU,browser:Y8,buffer:Re,cast:oe,ceil:T1,clipByValue:Hn,clone:Ua,complex:vr,concat:At,concat1d:$1,concat2d:E1,concat3d:R1,concat4d:A1,conv1d:Vy,conv2d:Sr,conv2dTranspose:Wy,conv3d:D1,conv3dTranspose:j1,copyRegisteredKernels:sV,cos:Ch,cosh:Uy,cosineWindow:f0,cumprod:Jd,cumsum:Gy,customGrad:Ya,denseBincount:Mm,deprecationWarn:FV,depthToSpace:_1,depthwiseConv2d:fc,device_util:RV,diag:BR,dilation2d:F1,disableDeprecationWarnings:_V,dispose:_e,disposeVariables:PV,div:xe,divNoNan:P1,dot:L1,dropout:bv,einsum:to,elu:mc,enableDebugMode:jV,enableProdMode:DV,enclosingPowerOfTwo:wv,engine:ra,ensureShape:zR,env:W,equal:Xs,erf:Hy,euclideanNorm:z1,exp:Kn,expandDims:bn,expm1:M1,eye:Ky,fft:Lh,fill:Yo,findBackend:VV,findBackendFactory:WV,floor:yc,floorDiv:zy,fused:RA,gather:bc,gatherND:CA,gather_util:Q8,getBackend:kR,getGradient:Hw,getKernel:Wd,getKernelsForBackend:Lm,grad:m5,grads:g5,greater:Qn,greaterEqual:Or,ifft:ru,imag:Ih,image:pa,inTopKAsync:IA,io:Av,irfft:l0,isFinite:V1,isInf:W1,isNaN:U1,keep:Vt,kernel_impls:lK,leakyRelu:Th,less:tu,lessEqual:Bi,linalg:vv,linspace:WR,localResponseNormalization:G1,log:ds,log1p:$h,logSigmoid:H1,logSoftmax:Jy,logSumExp:Eh,logicalAnd:wa,logicalNot:Rh,logicalOr:Xy,logicalXor:K1,losses:PA,lowerBound:GR,matMul:je,math:M8,max:Is,maxPool:Ah,maxPool3d:q1,maxPoolWithArgmax:HR,maximum:er,mean:xt,memory:tk,meshgrid:KR,min:eu,minimum:Si,mirrorPad:J1,mod:X1,moments:Oh,movingAverage:vA,mul:D,multiRNNCell:qR,multinomial:JR,neg:ot,nextFrame:Pv,norm:gc,notEqual:Do,oneHot:nu,ones:Mn,onesLike:ps,op:O,outerProduct:XR,pad:Dr,pad1d:YR,pad2d:QR,pad3d:ZR,pad4d:eA,pool:Y1,pow:Xa,prelu:jh,print:p1,prod:Q1,profile:LV,raggedGather:tA,raggedRange:nA,raggedTensorToTensor:sA,rand:aA,randomGamma:lA,randomNormal:Zy,randomStandardNormal:uA,randomUniform:zi,randomUniformInt:cA,range:jo,ready:wR,real:su,reciprocal:lv,registerBackend:o1,registerGradient:tR,registerKernel:Ly,relu:Ta,relu6:e0,removeBackend:MV,reshape:_,reverse:$s,reverse1d:dA,reverse2d:pA,reverse3d:hA,reverse4d:fA,rfft:Bh,round:t0,rsqrt:n0,scalar:Se,scatterND:SA,scatter_util:bG,searchSorted:Yy,selu:s0,separableConv2d:a0,serialization:w8,setBackend:zV,setPlatform:UV,setdiff1dAsync:mA,sigmoid:ga,sign:uv,signal:FA,sin:r0,sinh:i0,slice:ze,slice1d:_h,slice2d:o0,slice3d:Fh,slice4d:au,slice_util:eO,softmax:Ph,softplus:Qo,spaceToBatchND:Dh,sparse:LA,sparseToDense:NA,spectral:_A,split:Wn,sqrt:tn,square:et,squaredDifference:u0,squeeze:Mi,stack:qn,step:el,stridedSlice:cv,string:BA,sub:pe,sum:me,sumOutType:By,tan:dv,tanh:vi,tensor:Ks,tensor1d:wn,tensor2d:Fl,tensor3d:pv,tensor4d:gA,tensor5d:yA,tensor6d:bA,tensorScatterUpdate:wA,tensor_util:CV,test_util:A6,tidy:M,tile:vs,time:BV,topk:fv,train:Zi,transpose:Be,truncatedNormal:d0,unique:mv,unregisterGradient:nV,unregisterKernel:tV,unsortedSegmentSum:p0,unstack:Es,upcastType:Un,upperBound:kA,util:pV,valueAndGrad:y5,valueAndGrads:b5,variable:gv,variableGrads:UR,version_core:sK,where:cn,whereAsync:yv,zeros:Lt,zerosLike:Me},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TO={kernelName:yp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(t,el(oe(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cK={kernelName:bu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=et(oe(n,"float32")),a=tn(pe(Se(1),s));return ot(xe(t,a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dK={kernelName:wu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=tn(pe(et(oe(n,"float32")),1));return xe(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pK={kernelName:Jo,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=Te(n.shape,s.shape);return{a:()=>{let o=t;const l=zt(n.shape,a);return l.length>0&&(o=me(o,l)),_(o,n.shape)},b:()=>{let o=t;const l=zt(s.shape,a);return l.length>0&&(o=me(o,l)),_(o,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hK={kernelName:bp,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,a)=>{n[a]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fK={kernelName:wp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mK={kernelName:kp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Me(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gK={kernelName:ku,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,tn(pe(Se(1),et(oe(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yK={kernelName:xu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=tn(ee(Se(1),et(oe(n,"float32"))));return xe(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bK={kernelName:Nu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=Te(n.shape,s.shape);return{a:()=>{const o=ee(et(n),et(s));let l=D(t,xe(s,o));const u=zt(n.shape,a);return u.length>0&&(l=me(l,u)),_(l,n.shape)},b:()=>{const o=ee(et(n),et(s));let l=ot(D(t,xe(n,o)));const u=zt(s.shape,a);return u.length>0&&(l=me(l,u)),_(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wK={kernelName:vu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,ee(et(oe(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kK={kernelName:Su,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,pe(Se(1),et(oe(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xK(t,e,n,s,a,r){const i=$(t,"dy","avgPool3dGrad"),o=$(e,"input","avgPool3dGrad");let l=i,u=o,c=!1;o.rank===4&&(c=!0,l=_(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),u=_(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),I(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),I(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Fn("avgPool3dGrad",a,r);const d={dy:l,input:u},p={filterSize:n,strides:s,pad:a,dimRoundingMode:r},h=A.runKernel(Fg,d,p);return c?_(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const vK=O({avgPool3dGrad_:xK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SK={kernelName:vp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:a,strides:r,pad:i,dimRoundingMode:o}=n;return{x:()=>vK(t,s,a,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NK(t,e,n,s,a){const r=$(t,"dy","avgPoolGrad"),i=$(e,"input","avgPoolGrad");I(i.rank===r.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${r.rank})`);let o=i,l=r,u=!1;i.rank===3&&(u=!0,o=_(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=_(r,[1,r.shape[0],r.shape[1],r.shape[2]])),I(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),I(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const c={dy:l,input:o},d={filterSize:n,strides:s,pad:a},p=A.runKernel(_g,c,d);return u?_(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const CK=O({avgPoolGrad_:NK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IK={kernelName:xp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:a,strides:r,pad:i}=n;return{x:()=>CK(t,s,a,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TK={kernelName:Sp,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,a]=e,{transposeA:r,transposeB:i}=n;return!r&&!i?{a:()=>je(t,a,!1,!0),b:()=>je(s,t,!0,!1)}:!r&&i?{a:()=>je(t,a,!1,!1),b:()=>je(t,s,!0,!1)}:r&&!i?{a:()=>je(a,t,!1,!0),b:()=>je(s,t,!1,!1)}:{a:()=>je(a,t,!0,!0),b:()=>je(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $K={kernelName:Np,gradFunc:(t,e,n)=>{const{blockShape:s,crops:a}=n;return{x:()=>Dh(t,s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EK={kernelName:ZE,gradFunc:(t,e,n)=>{const s=n,a=s.inputShape,r=s.shape,i=Array.from(r);for(let l=a.length-1;l>=0;l--)if(a[l]===r[l])i[l]=1;else if(a[l]!==1)throw new Error(`broadcastTo(): [${a}] cannot be broadcast to [${r}].`);const o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>me(t,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RK={kernelName:Cu,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AK={kernelName:Iu,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OK={kernelName:Tu,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:a,clipValueMax:r}=n;return{x:()=>cn(wa(Or(s,a),Bi(s,r)),t,Me(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DK={kernelName:Ip,inputsToSave:["x"],gradFunc:TO.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jK={kernelName:Tp,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:a}=n,r=Fe(a,e[0].shape)[0],i=s.map(l=>l[r]);return Wn(t,i,r).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _K={kernelName:$p,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,a]=e,{dilations:r,strides:i,pad:o,dataFormat:l}=n;return I(xi(r),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`),{x:()=>O1(s.shape,t,a,i,o,l),filter:()=>kv(s,t,a.shape,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FK={kernelName:Ep,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,a]=e,{strides:r,pad:i,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>Sr(t,a,r,i,o,1,l),filter:()=>kv(t,s,a.shape,r,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PK(t,e,n,s,a){let r=t;t.rank===4&&(r=_(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=_(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),I(r.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${r.shape}.`),I(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),I(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),I(r.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${r.shape[4]}) must match input depth in filter (${n[3]}.`),I(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const o={x:r,dy:i},l={strides:s,pad:a,filterShape:n};return A.runKernel(Mg,o,l)}const LK=O({conv3DBackpropFilter_:PK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BK={kernelName:Rp,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:a,pad:r}=n;I(xi(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,o]=e;return{x:()=>LR(i.shape,t,o,a,r),filter:()=>LK(i,t,o.shape,a,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zK={kernelName:$u,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(ot(r0(oe(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MK={kernelName:Eu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(i0(oe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VK={kernelName:Ap,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:a,exclusive:r,reverse:i}=n;return{x:()=>{const o=Nt([a],s.rank);let l=Gy(t,a,r,!i);return o!=null&&(l=Be(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WK={kernelName:Op,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:a,pad:r,dimRoundingMode:i}=n,o=s??[1,1];I(xi(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,u]=e;return I(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),I(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),I(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),I(hn(a,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${a} and dilations '${o}'.`),Fn("depthwiseConv2d",r,i),{x:()=>EA(l.shape,t,u,a,r,o,i),filter:()=>$A(l,t,u.shape,a,r,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UK={kernelName:Dp,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,a]=e,r={x:s,filter:a,dy:t},i={x:s,filter:a,dy:t};return{x:()=>A.runKernel(_m,r,n),filter:()=>A.runKernel(Fm,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GK={kernelName:Au,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>A.runKernel(Qg,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HK={kernelName:Ou,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=D(Kn(ot(et(n))),2/Math.sqrt(Math.PI));return{x:()=>D(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KK={kernelName:Du,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qK={kernelName:_p,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>_(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JK={kernelName:ju,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(t,Kn(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XK={kernelName:_u,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YK={kernelName:Fu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=Te(n.shape,s.shape);return{a:()=>{const o=xe(t,oe(s,"float32")),l=zt(n.shape,a);return l.length>0?_(me(o,l),n.shape):o},b:()=>{let o=D(t,oe(n,"float32"));const l=zt(s.shape,a);l.length>0&&(o=_(me(o,l),s.shape));const u=et(s);return ot(xe(o,oe(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QK={kernelName:Fp,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[a,r,i,o]=e,l=o??Se(1),u=zt(r.shape,a.shape),c=[];if(r.rank===1){for(let k=0;k<a.shape.length-1;++k)c.push(a.shape[k]);c.push(1)}const d=pe(a,r),p=D(t,l),h=n0(ee(i,Se(s))),f=D(D(D(h,h),h),Se(-.5));return{x:()=>r.rank===1?_(D(D(t,vs(_(h,[1,1,1,r.shape[0]]),c)),l),a.shape):_(D(D(t,h),l),a.shape),mean:()=>{let k=D(D(h,Se(-1)),p);return r.rank===1&&(k=me(k,u)),_(k,r.shape)},variance:()=>{let k=D(D(f,d),p);return r.rank===1&&(k=me(k,u)),_(k,r.shape)},scale:()=>{const k=D(d,h);let x=D(t,k);return r.rank===1&&(x=me(x,u)),_(x,r.shape)},offset:()=>{let k=t;return r.rank===1&&(k=me(k,u)),_(k,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZK={kernelName:Pp,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,a]=e,{axis:r,batchDims:i}=n,o=Fe(r,s.shape)[0],l=(u,c,d)=>()=>{const p=u.shape,h=c.size,f=p.slice(0,o),m=f.length,y=p.slice(r,p.length).slice(1),g=y.length,b=pC(0,m),w=pC(m+1,m+1+g),k=hC([f,[h],y]),x=_(d,k),S=_(c,[h]),C=hC([[m],b,w]),T=Be(x,C);let E=p0(T,S,u.shape[o]);const R=Li(C);return E=Be(E,R),E};if(i===1){const u=s.shape[0],c=s.split(u,0);return{x:()=>qn(c.map((h,f)=>l(h,a.slice(f,1),t.slice(f,1))())).reshape(s.shape),indices:()=>a}}else return{x:l(s,a,t),indices:()=>a}}};function pC(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function hC(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7={kernelName:Pu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Me(n),b:()=>Me(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t7={kernelName:Lu,gradFunc:t=>({x:()=>oe(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n7={kernelName:Bu,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s7={kernelName:zu,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a7={kernelName:Mu,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r7={kernelName:Bp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:a}=n,r=Qn(s,0);return{x:()=>cn(r,t,D(t,a))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7={kernelName:Wu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,ee(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7={kernelName:Vu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,oe(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l7={kernelName:eR,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:a}=n;return{logits:()=>{const i=Kn(s);return pe(t,D(me(t,a,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u7(t,e,n,s=5,a=1,r=1,i=.5){const o={x:t,y:e,dy:n},l={depthRadius:s,bias:a,alpha:r,beta:i};return A.runKernel(iy,o,l)}const c7=O({localResponseNormalizationBackprop_:u7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d7={kernelName:Gp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,a]=e,{depthRadius:r,bias:i,alpha:o,beta:l}=n;return{x:()=>c7(s,a,t,r,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $O(t,e,n,s){return e.rank<n.rank&&(e=_(e,Ot(e.shape,s))),t.rank<n.rank&&(t=_(t,Ot(t.shape,s))),{x:()=>D(t,oe(Xs(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fC={kernelName:Hp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:a}=s,r=e[0],i=e[1],o=Fe(a,r.shape),l=$O(t,i,r,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p7={kernelName:Uu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>D(t,oe(Or(n,s),"float32")),b:()=>D(t,oe(tu(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h7(t,e,n,s,a,r,i){const o=$(t,"dy","maxPool3dGrad"),l=$(e,"input","maxPool3dGrad"),u=$(n,"output","maxPool3dGrad");let c=o,d=l,p=u,h=!1;l.rank===4&&(h=!0,c=_(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=_(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=_(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),I(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),I(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),I(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),Fn("maxPool3dGrad",r,i);const f={dy:c,input:d,output:p},m={filterSize:s,strides:a,pad:r,dimRoundingMode:i},y=A.runKernel(ly,f,m);return h?_(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const f7=O({maxPool3dGrad_:h7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m7={kernelName:qp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,a]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=n;return{x:()=>f7(t,s,a,r,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g7(t,e,n,s,a,r,i){const o=$(t,"dy","maxPoolGrad"),l=$(e,"input","maxPoolGrad"),u=$(n,"output","maxPoolGrad");I(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),I(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),I(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Fn("maxPoolGrad",r,i);const c={dy:o,input:l,output:u},d={filterSize:s,strides:a,pad:r,dimRoundingMode:i};return A.runKernel(oy,c,d)}const y7=O({maxPoolGrad_:g7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b7={kernelName:Kp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,a]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>y7(t,s,a,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w7={kernelName:Jp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:a}=n,r=Fe(a,s.shape),o=sn(s.shape,r)[1],l=K(o);return{x:()=>{const c=s.shape.slice();r.forEach(h=>{c[h]=1});const d=_(t,c);return xe(D(d,Mn(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k7={kernelName:Xp,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:a}=s,[r,i]=e,o=Fe(a,r.shape),l=$O(t,i,r,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x7={kernelName:Gu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>D(t,oe(Bi(n,s),"float32")),b:()=>D(t,oe(Qn(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v7={kernelName:Yp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:a}=n,r=a.map(i=>i[0]);return{x:()=>ze(t,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S7={kernelName:Hu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=Te(n.shape,s.shape);return{a:()=>{const o=zt(n.shape,a);return o.length>0?_(me(t,o),n.shape):t},b:()=>{const o=D(t,ot(yc(xe(n,s)))),l=zt(s.shape,a);return l.length>0?_(me(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N7={kernelName:Ku,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=Te(n.shape,s.shape);return{a:()=>{const o=D(t,oe(s,"float32")),l=zt(n.shape,a);return l.length>0?_(me(o,l),n.shape):o},b:()=>{const o=D(t,oe(n,"float32")),l=zt(s.shape,a);return l.length>0?_(me(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C7={kernelName:Qp,gradFunc:t=>({x:()=>ot(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I7={kernelName:th,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Lt(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T7={kernelName:eh,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $7={kernelName:nh,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return Es(t,s).map(r=>()=>r)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mC={kernelName:sh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:a}=n,r=a.map(i=>i[0]);return{x:()=>ze(t,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7={kernelName:qu,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,a]=e,r=n,i=s,o=Te(r.shape,i.shape);return{a:()=>{const c=oe(i,"float32");let d=D(t,D(c,Xa(r,pe(c,Se(1)))));const p=zt(r.shape,o);return p.length>0&&(d=me(d,p)),_(d,r.shape)},b:()=>{const c=Qn(r,0),d=cn(c,ds(r),Me(r));let p=D(t,D(a,d));const h=zt(i.shape,o);return h.length>0&&(p=me(p,h)),_(p,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R7={kernelName:ah,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,a=Qn(n,0);return{x:()=>cn(a,t,D(t,s)),alpha:()=>{let r=cn(a,Me(t),D(t,n));const i=zt(s.shape,t.shape);return i.length>0&&(r=me(r,i)),_(r,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A7(t,e,n){const s=t.shape.slice();s[n]=1;const a=_(e,s),r=Jd(t,n,!0,!1),i=Jd(t,n,!0,!0),o=D(r,i);return D(a,o)}function O7(t,e,n){const s=t.shape.length,a=s-n.length,r=Nt(n,s);let i=t;r!=null&&(i=Be(t,r));const o=i.shape.slice(),u=o.splice(s-n.length,n.length).reduce((p,h)=>p*h,1);o.push(u);const c=i.reshape(o);let d=A7(c,e,a);if(d=d.reshape(i.shape),r!=null){const p=Li(r);d=Be(d,p)}return d}const D7={kernelName:rh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:a}=n;let r=[];return a==null?r=s.shape.map((i,o)=>o):typeof a=="number"?r=[a]:r=a,{x:()=>O7(s,t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j7={kernelName:Ru,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=Te(n.shape,s.shape);return{a:()=>{const o=xe(t,oe(s,"float32")),l=zt(n.shape,a);return l.length>0?_(me(o,l),n.shape):o},b:()=>{let o=D(t,oe(n,"float32"));const l=zt(s.shape,a);l.length>0&&(o=_(me(o,l),s.shape));const u=et(s);return ot(xe(o,oe(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _7={kernelName:Ju,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,ot(et(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F7={kernelName:Yu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=D(Bi(n,6),el(n));return{x:()=>D(t,oe(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P7={kernelName:Xu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(t,oe(el(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L7={kernelName:ih,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B7={kernelName:lh,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,a={dy:t,images:s};return{images:()=>A.runKernel(ky,a,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z7={kernelName:oh,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,a={dy:t,images:s};return{images:()=>A.runKernel(wy,a,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M7={kernelName:uh,gradFunc:(t,e,n)=>{const{dims:s}=n,a=Fe(s,t.shape);return{x:()=>$s(t,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V7={kernelName:Qu,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7={kernelName:Zu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ot(xe(t,D(Xa(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U7={kernelName:ch,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>oe(Me(n),"float32"),t:()=>D(t,oe(n,t.dtype)),e:()=>D(t,oe(Rh(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G7={kernelName:ec,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Qn(n,Se(0)),a=Se(I0),r=Se(T0),i=D(t,r),o=D(D(t,a),Kn(oe(n,"float32")));return cn(s,i,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H7={kernelName:ac,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(t,D(n,pe(Se(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K7={kernelName:sc,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q7={kernelName:tc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(Ch(oe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J7={kernelName:nc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(Uy(oe(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X7={kernelName:dh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:a,size:r}=n,i=s.shape,[o,l]=N0(s,a,r),u=[];for(let c=0;c<t.rank;c++)u.push([o[c],i[c]-o[c]-l[c]]);return{x:()=>Dr(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y7={kernelName:mh,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:a}=n,r=!0,i=D(t,s);return{logits:()=>pe(i,D(me(i,[a],r),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q7={kernelName:rc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(t,ga(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gC={kernelName:hh,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:a}=n;return{x:()=>Nh(t,s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yC={kernelName:fh,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>At(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z7={kernelName:ic,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,D(tn(oe(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e9={kernelName:Ey,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(t,D(oe(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t9={kernelName:oc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=Se(2);return{a:()=>D(t,D(a,pe(n,s))),b:()=>D(t,D(a,pe(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n9={kernelName:pc,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s9={kernelName:lc,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=Te(n.shape,s.shape);return{a:()=>{let o=t;const l=zt(n.shape,a);return l.length>0&&(o=me(o,l)),_(o,n.shape)},b:()=>{let o=t;const l=zt(s.shape,a);return l.length>0&&(o=me(o,l)),_(ot(o),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a9={kernelName:ph,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,a=s.shape.slice(),{axis:r}=n;Fe(r,s.shape).forEach(u=>{a[u]=1});const o=_(t,a),l=D(o,Mn(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r9={kernelName:uc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>xe(t,et(Ch(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i9={kernelName:cc,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>D(pe(Se(1),et(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o9={kernelName:dc,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:a}=n;return{x:()=>{let i=Me(s);if(s.rank===1)for(let o=0;o<a[0];++o)i=ee(i,ze(t,[o*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let o=0;o<a[0];++o)for(let l=0;l<a[1];++l)i=ee(i,ze(t,[o*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let o=0;o<a[0];++o)for(let l=0;l<a[1];++l)for(let u=0;u<a[2];++u)i=ee(i,ze(t,[o*s.shape[0],l*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let o=0;o<a[0];++o)for(let l=0;l<a[1];++l)for(let u=0;u<a[2];++u)for(let c=0;c<a[3];++c)i=ee(i,ze(t,[o*s.shape[0],l*s.shape[1],u*s.shape[2],c*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l9={kernelName:go,gradFunc:(t,e,n)=>{const s=n,{perm:a}=s,r=Li(a);return{x:()=>Be(t,r)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9={kernelName:yh,gradFunc:(t,e,n)=>{const s=n,{axis:a}=s;return{value:()=>qn(t,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c9={kernelName:bh,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>d9(t,n)}}};function d9(t,e){const n=er(e,Me(e)),s=bc(t,n);let a=Or(e,Se(0,"int32"));const r=s.rank-a.rank;for(let o=0;o<r;++o)a=bn(a,o+1);a=wa(a,Mn(s.shape,"bool"));const i=Me(s);return cn(a,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p9={kernelName:wh,gradFunc:t=>({x:()=>Me(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h9=[TO,cK,dK,pK,hK,fK,mK,gK,yK,bK,wK,kK,SK,IK,TK,$K,EK,RK,AK,OK,DK,jK,FK,_K,BK,zK,MK,VK,WK,UK,j7,GK,HK,KK,qK,JK,YK,XK,QK,ZK,e7,t7,n7,s7,a7,r7,i7,o7,l7,d7,fC,fC,p7,m7,b7,w7,k7,x7,v7,S7,N7,C7,I7,T7,$7,mC,mC,E7,R7,D7,_7,F7,P7,L7,B7,z7,M7,V7,W7,U7,G7,H7,K7,q7,J7,X7,Y7,Q7,gC,gC,yC,yC,Z7,t9,e9,n9,s9,a9,r9,i9,o9,l9,u9,c9,p9];for(const t of h9)tR(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.abs=function(){return this.throwIfDisposed(),Ft(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.acos=function(){return this.throwIfDisposed(),h1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.acosh=function(){return this.throwIfDisposed(),f1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.add=function(t){return this.throwIfDisposed(),ee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.all=function(t,e){return this.throwIfDisposed(),My(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.any=function(t,e){return this.throwIfDisposed(),Hd(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.argMax=function(t){return this.throwIfDisposed(),Ro(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.argMin=function(t){return this.throwIfDisposed(),m1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.asScalar=function(){return this.throwIfDisposed(),I(this.size===1,()=>"The array must have only 1 element."),_(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.asType=function(t){return this.throwIfDisposed(),oe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as1D=function(){return this.throwIfDisposed(),_(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as2D=function(t,e){return this.throwIfDisposed(),_(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),_(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),_(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.as5D=function(t,e,n,s,a){return this.throwIfDisposed(),_(this,[t,e,n,s,a])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.asin=function(){return this.throwIfDisposed(),g1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.asinh=function(){return this.throwIfDisposed(),y1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.atan=function(){return this.throwIfDisposed(),b1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.atan2=function(t){return this.throwIfDisposed(),w1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.atanh=function(){return this.throwIfDisposed(),k1(this)};J().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),Sh(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Nh(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.batchNorm=function(t,e,n,s,a){return this.throwIfDisposed(),hc(this,t,e,n,s,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.broadcastTo=function(t){return this.throwIfDisposed(),yo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cast=function(t){return this.throwIfDisposed(),oe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.ceil=function(){return this.throwIfDisposed(),T1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Hn(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof qe&&(t=[t]),At([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.conv1d=function(t,e,n,s,a,r){return this.throwIfDisposed(),Vy(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.conv2dTranspose=function(t,e,n,s,a){return this.throwIfDisposed(),Wy(this,t,e,n,s,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.conv2d=function(t,e,n,s,a,r){return this.throwIfDisposed(),Sr(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cos=function(){return this.throwIfDisposed(),Ch(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cosh=function(){return this.throwIfDisposed(),Uy(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Jd(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Gy(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),_1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.depthwiseConv2d=function(t,e,n,s,a,r){return this.throwIfDisposed(),fc(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.dilation2d=function(t,e,n,s,a){return this.throwIfDisposed(),F1(this,t,e,n,s,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.divNoNan=function(t){return this.throwIfDisposed(),P1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.div=function(t){return this.throwIfDisposed(),xe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.dot=function(t){return this.throwIfDisposed(),L1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.elu=function(){return this.throwIfDisposed(),mc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.equal=function(t){return this.throwIfDisposed(),Xs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.erf=function(){return this.throwIfDisposed(),Hy(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),z1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.exp=function(){return this.throwIfDisposed(),Kn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.expandDims=function(t){return this.throwIfDisposed(),bn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.expm1=function(){return this.throwIfDisposed(),M1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.fft=function(){return this.throwIfDisposed(),Lh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.flatten=function(){return this.throwIfDisposed(),_(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.floor=function(){return this.throwIfDisposed(),yc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.floorDiv=function(t){return this.throwIfDisposed(),zy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.gather=function(t,e,n){return this.throwIfDisposed(),bc(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Or(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.greater=function(t){return this.throwIfDisposed(),Qn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.ifft=function(){return this.throwIfDisposed(),ru(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.irfft=function(){return this.throwIfDisposed(),l0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.isFinite=function(){return this.throwIfDisposed(),V1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.isInf=function(){return this.throwIfDisposed(),W1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.isNaN=function(){return this.throwIfDisposed(),U1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Th(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.lessEqual=function(t){return this.throwIfDisposed(),Bi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.less=function(t){return this.throwIfDisposed(),tu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),G1(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logSigmoid=function(){return this.throwIfDisposed(),H1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logSoftmax=function(t){return this.throwIfDisposed(),Jy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Eh(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.log=function(){return this.throwIfDisposed(),ds(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.log1p=function(){return this.throwIfDisposed(),$h(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logicalAnd=function(t){return this.throwIfDisposed(),wa(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logicalNot=function(){return this.throwIfDisposed(),Rh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logicalOr=function(t){return this.throwIfDisposed(),Xy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.logicalXor=function(t){return this.throwIfDisposed(),K1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),je(this,t,e,n)};J().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),Ah(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.max=function(t,e){return this.throwIfDisposed(),Is(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.maximum=function(t){return this.throwIfDisposed(),er(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.mean=function(t,e){return this.throwIfDisposed(),xt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.min=function(t,e){return this.throwIfDisposed(),eu(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.minimum=function(t){return this.throwIfDisposed(),Si(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),J1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.mod=function(t){return this.throwIfDisposed(),X1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.mul=function(t){return this.throwIfDisposed(),D(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.neg=function(){return this.throwIfDisposed(),ot(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.norm=function(t,e,n){return this.throwIfDisposed(),gc(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.notEqual=function(t){return this.throwIfDisposed(),Do(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),nu(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.onesLike=function(){return this.throwIfDisposed(),ps(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.pad=function(t,e){return this.throwIfDisposed(),Dr(this,t,e)};J().prototype.pool=function(t,e,n,s,a,r){return this.throwIfDisposed(),Y1(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.pow=function(t){return this.throwIfDisposed(),Xa(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.prelu=function(t){return this.throwIfDisposed(),jh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.prod=function(t,e){return this.throwIfDisposed(),Q1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.reciprocal=function(){return this.throwIfDisposed(),lv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.relu=function(){return this.throwIfDisposed(),Ta(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.relu6=function(){return this.throwIfDisposed(),e0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.reshapeAs=function(t){return this.throwIfDisposed(),_(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.reshape=function(t){return this.throwIfDisposed(),_(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),DA(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),jA(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.reverse=function(t){return this.throwIfDisposed(),$s(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.rfft=function(){return this.throwIfDisposed(),Bh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.round=function(){return this.throwIfDisposed(),t0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.rsqrt=function(){return this.throwIfDisposed(),n0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.selu=function(){return this.throwIfDisposed(),s0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.separableConv2d=function(t,e,n,s,a,r){return this.throwIfDisposed(),a0(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sigmoid=function(){return this.throwIfDisposed(),ga(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sign=function(){return this.throwIfDisposed(),uv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sin=function(){return this.throwIfDisposed(),r0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sinh=function(){return this.throwIfDisposed(),i0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.slice=function(t,e){return this.throwIfDisposed(),ze(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.softmax=function(t){return this.throwIfDisposed(),Ph(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.softplus=function(){return this.throwIfDisposed(),Qo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Dh(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.split=function(t,e){return this.throwIfDisposed(),Wn(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sqrt=function(){return this.throwIfDisposed(),tn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.square=function(){return this.throwIfDisposed(),et(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.squaredDifference=function(t){return this.throwIfDisposed(),u0(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.squeeze=function(t){return this.throwIfDisposed(),Mi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof qe?[this,t]:[this,...t];return qn(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.step=function(t){return this.throwIfDisposed(),el(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.stridedSlice=function(t,e,n,s,a,r,i,o){return this.throwIfDisposed(),cv(this,t,e,n,s,a,r,i,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sub=function(t){return this.throwIfDisposed(),pe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.sum=function(t,e){return this.throwIfDisposed(),me(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.tan=function(){return this.throwIfDisposed(),dv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.tanh=function(){return this.throwIfDisposed(),vi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.tile=function(t){return this.throwIfDisposed(),vs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.toBool=function(){return this.throwIfDisposed(),oe(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.toFloat=function(){return this.throwIfDisposed(),oe(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.toInt=function(){return this.throwIfDisposed(),oe(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.topk=function(t,e){return this.throwIfDisposed(),fv(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.transpose=function(t){return this.throwIfDisposed(),Be(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.unique=function(t){return this.throwIfDisposed(),mv(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),p0(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.unstack=function(t){return this.throwIfDisposed(),Es(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.where=function(t,e){return this.throwIfDisposed(),cn(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J().prototype.zerosLike=function(){return this.throwIfDisposed(),Me(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Da extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Da.prototype)}}class Us extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Us.prototype)}}class P extends Error{constructor(e){super(e),Object.setPrototypeOf(this,P.prototype)}}class Oe extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Oe.prototype)}}class s2 extends Error{constructor(e){super(e),Object.setPrototypeOf(this,s2.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class EO{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Fo(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function ja(t,e){if(!t)throw new s2(e)}function bC(t,e){let n=0;for(const s of t)s===e&&n++;return n}function Bn(t){return t.length===1?t[0]:t}function Xe(t){return Array.isArray(t)?t:[t]}function or(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function no(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Ds={};function a2(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function hk(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>hk(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:hk(s))}}}function Wh(t,e={},n={},s="object",a=!1){if(typeof t=="string"){const r=t;let i;if(r in n)i=n[r];else if(r in Ds)i=Ds[r];else if(i=e[r],i==null)throw new P(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const r=t;if(r.className==null||r.config==null)throw new P(`${s}: Improper config format: ${JSON.stringify(r)}.
'className' and 'config' must set.`);const i=r.className;let o,l;if(i in n?[o,l]=n[i]:i in Ds?[o,l]=Ds.className:i in e&&([o,l]=e[i]),o==null)throw new P(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const h of Object.keys(Ds))u[h]=Ds[h];for(const h of Object.keys(n))u[h]=n[h];const c=r.config;c.customObjects=u;const d=Object.assign({},Ds);for(const h of Object.keys(n))Ds[h]=n[h];hk(r.config);const p=l(o,r.config,n,a);return Ds=Object.assign({},d),p}else{const u=Object.assign({},Ds);for(const d of Object.keys(n))Ds[d]=n[d];const c=new o(r.config);return Ds=Object.assign({},u),c}}}function f9(t,e){return t<e?-1:t>e?1:0}function Cf(t,e){return-1*f9(t,e)}function di(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function m9(t){if(t==null)throw new P(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function nl(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new P(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function r2(t,e,n=0,s=1/0){return ja(n>=0),ja(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(a=>typeof a===e)}function Zt(t,e){Array.isArray(t)?(I(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>Zt(n,`element ${s+1} of ${e}`))):I(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${RO(t)}.`)}function RO(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>RO(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function g9(t,e,n){let s=n!=null?n():$n(),a;return(...i)=>{const o=n!=null?n():$n();return o-s<e||(s=o,a=t(...i)),a}}function AO(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let y9=0;function OO(){return y9++}const If={};function $0(t=""){return t in If||(If[t]=0),If[t]+=1,t+If[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const b9=["channelsFirst","channelsLast"],w9=["nearest","bilinear"],k9=["valid","same","causal"],x9=["max","avg"],v9=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const cl=new Map;function jt(t){nl(b9,"DataFormat",t)}function S9(t){nl(w9,"InterpolationFormat",t)}function Os(t){nl(k9,"PaddingMode",t)}function DO(t){nl(x9,"PoolMode",t)}const fd=[],wC="/";function bo(t,e){fd.push(t);try{const n=e();return fd.pop(),n}catch(n){throw fd.pop(),n}}function N9(){return fd.length===0?"":fd.join(wC)+wC}function jO(t){if(!FO(t))throw new Error("Not a valid tensor name: '"+t+"'");return N9()+t}function _O(t){if(!FO(t))throw new Error("Not a valid tensor name: '"+t+"'");cl.has(t)||cl.set(t,0);const e=cl.get(t);if(cl.set(t,cl.get(t)+1),e>0){const n=`${t}_${e}`;return cl.set(n,1),n}else return t}const C9=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function FO(t){return!!t.match(C9)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function I9(t){return t===parseInt(t.toString(),10)}function pi(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let a=e;a<n;++a)s*=t[a];return s}function iu(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function Ni(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function ka(t,e){if(e<t)throw new P(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Eb;function Wt(){return Eb==null&&(Eb=l1().epsilon()),Eb}function xa(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ha(t,e){return oe(t,e)}function Uh(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),_(t,n)}function T9(t,e){return M(()=>{if(t.shape.length!==2)throw new P(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Uh(t,1);return fk(n,[1,e,1])})}function $9(t){const e=[pi(t.shape)];return _(t,e)}function E9(t){if(t.rank<=1)throw new P(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],pi(t.shape,1)];return _(t,e)}function wo(t,e,n){return M(()=>{switch(t.rank){case 1:return _h(t,e,n);case 2:return o0(t,[e,0],[n,t.shape[1]]);case 3:return Fh(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return au(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return ze(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return ze(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new P(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Rb(t,e,n){return M(()=>{switch(t.rank){case 1:return _h(t,e,n);case 2:return o0(t,[0,e],[t.shape[0],n]);case 3:return Fh(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return au(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new P(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Tf(t,e,n,s){return M(()=>{switch(t.rank){case 1:return _h(t,e,n);case 2:switch(s){case 1:return wo(t,e,n);case 2:return Rb(t,e,n);default:throw new P(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return wo(t,e,n);case 2:return Fh(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Rb(t,e,n);default:throw new P(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return wo(t,e,n);case 2:return au(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return au(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Rb(t,e,n);default:throw new P(`The axis is not within the rank of the tensor ${s}`)}default:throw new P(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function i2(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),At(t,e)}function kC(t,e){switch(t.rank){case 1:return $1([t,e]);case 2:return E1([t,e],0);case 3:return R1([t,e],0);case 4:return A1([t,e],0);default:throw new P(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function fk(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new P(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return vs(t,e)}function E0(t,e=0,n=1,s,a){return Zy(t,e,n,s,a)}function Ka(t,e,n,s){if(t.rank<2||e.rank<2)throw new Oe(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const a=t.shape.slice(-1)[0],r=e.shape.slice(-2)[0];if(a!==r)throw new Oe(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return lk({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?mk(t.rank,s,xa()):null,activation:n});{const a=t.shape.slice(),r=a.pop();t=_(t,[-1,r]);const i=e.shape.slice(),o=i.pop(),l=i.pop(),u=[...i,o],c=Array.from({length:e.rank},(f,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=_(Be(e,c),[l,-1]);const d=[...a,...u];return _(lk({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?mk(t.rank,s,xa()):null,activation:n}),d)}}function PO(t,e,n){return M(()=>(Array.isArray(e)?e=wn(e,"int32"):e=oe(e,"int32"),bc(t,e,n)))}function Gh(t){return D(t,t)}function mk(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new P(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?_(e,[1,s[0],1,1,1]):_(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?_(e,[1,1,1,1,s[0]]):_(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?_(e,[1,s[0],1,1]):_(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?_(e,[1,1,1,s[0]]):_(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?_(e,[1,s[0],1]):_(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?_(e,[1,1,s[0]]):_(e,[1].concat(s))}else if(t<3)return e;throw new P(`Unsupported input rank by biasAdd: ${e.rank}`)}function $a(t,e,n){return M(()=>(n==null&&(n=xa()),jt(n),ee(t,mk(t.rank,e,n))))}function R9(t,e=1){if(e!==1)throw new Oe(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return mc(t)}function A9(t){return M(()=>xe(t,ee(Ft(t),1)))}function LO(t,e,n,s){return M(()=>bv(t,e,n,s))}function O9(t){return M(()=>{const e=ee(.5,D(.2,t));return Hn(e,0,1)})}function Hh(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const D9=["fanIn","fanOut","fanAvg"],j9=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _9(t){nl(D9,"FanMode",t)}function F9(t){nl(j9,"Distribution",t)}class Qs extends tl{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class BO extends Qs{apply(e,n){return Lt(e,n)}}BO.className="Zeros";te(BO);class o2 extends Qs{apply(e,n){return Mn(e,n)}}o2.className="Ones";te(o2);class zO extends Qs{constructor(e){if(super(),typeof e!="object")throw new P(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new P(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return M(()=>D(Se(this.value),Mn(e,n)))}getConfig(){return{value:this.value}}}zO.className="Constant";te(zO);class MO extends Qs{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return zi(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}MO.className="RandomUniform";te(MO);class VO extends Qs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Oe(`randomNormal does not support dType ${n}.`);return E0(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}VO.className="RandomNormal";te(VO);class WO extends Qs{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Oe(`truncatedNormal does not support dType ${n}.`);return d0(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}WO.className="TruncatedNormal";te(WO);class UO extends Qs{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return M(()=>{if(e.length!==2||e[0]!==e[1])throw new P("Identity matrix initializer can only be used for 2D square matrices.");return D(this.gain,Ky(e[0]))})}getConfig(){return{gain:this.gain}}}UO.className="Identity";te(UO);function P9(t,e="channelsLast"){let n,s;if(jt(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const a=pi(t,2);n=t[1]*a,s=t[0]*a}else if(e==="channelsLast"){const a=pi(t,0,t.length-2);n=t[t.length-2]*a,s=t[t.length-1]*a}}else{const a=pi(t);n=Math.sqrt(a),s=Math.sqrt(a)}return[n,s]}class hs extends Qs{constructor(e){if(super(),e.scale<0)throw new P(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,_9(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,F9(this.distribution),this.seed=e.seed}apply(e,n){const s=P9(e),a=s[0],r=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,a):this.mode==="fanOut"?i/=Math.max(1,r):i/=Math.max(1,(a+r)/2),this.distribution==="normal"){const o=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Oe(`${this.getClassName()} does not support dType ${n}.`);return d0(e,0,o,n,this.seed)}else{const o=Math.sqrt(3*i);return zi(e,-o,o,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}hs.className="VarianceScaling";te(hs);class l2 extends hs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return hs.className}}l2.className="GlorotUniform";te(l2);class u2 extends hs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return hs.className}}u2.className="GlorotNormal";te(u2);class c2 extends hs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return hs.className}}c2.className="HeNormal";te(c2);class d2 extends hs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return hs.className}}d2.className="HeUniform";te(d2);class p2 extends hs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return hs.className}}p2.className="LeCunNormal";te(p2);class h2 extends hs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return hs.className}}h2.className="LeCunUniform";te(h2);class GO extends Qs{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return M(()=>{if(e.length<2)throw new Oe("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=K(e.slice(0,-1)),a=e[e.length-1],r=s*a;r>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${r}) elements: Slowness may result.`);const i=[Math.max(a,s),Math.min(a,s)],o=E0(i,0,1,n,this.seed),l=vv.qr(o,!1);let u=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(a,s)*Math.min(a,s)],[Math.min(a,s)+1]);return u=D(u,d.sign()),s<a&&(u=u.transpose()),D(Se(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}GO.className="Orthogonal";te(GO);const xC={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function vC(t,e={}){return Wh(t,ks.getMap().classNameMap,e,"initializer")}function vt(t){return a2(t)}function mt(t){if(typeof t=="string"){const e=t in xC?xC[t]:t;if(e==="GlorotNormal")return new u2;if(e==="GlorotUniform")return new l2;if(e==="HeNormal")return new c2;if(e==="HeUniform")return new d2;if(e==="LeCunNormal")return new p2;if(e==="LeCunUniform")return new h2;{const n={};return n.className=e,n.config={},vC(n)}}else return t instanceof Qs?t:vC(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gk(t){return Array.isArray(t)&&Array.isArray(t[0])}function Wm(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function Ie(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new P(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function He(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new P(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Um(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,a)=>s*a);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const SC="Variable";class L9{constructor(e,n="float32",s=SC,a=!0,r=null){this.dtype=n??"float32",this.shape=e.shape,this.id=OO(),s=s??SC,this.originalName=jO(s),this.name=_O(this.originalName),this.trainable_=a,this.constraint=r,this.val=gv(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),B9(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function B9(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function yk(t){return t.map(e=>e.read())}function f2(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Ut{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Qa{constructor(e,n,s,a,r,i,o){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=a,this.callArgs=r,this.outputTensorIndex=o,this.id=OO(),i!=null&&(this.originalName=jO(i),this.name=_O(this.originalName)),this.rank=n.length}}let z9=0,R0=class{constructor(e,n){this.callArgs=n,this.id=z9++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},M9=0;class Pe extends tl{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=M9++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=or(s)+"_"+$0(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let r=null;e.batchSize!=null&&(r=e.batchSize),s=[r].concat(e.inputShape)}this.batchInputShape=s;let a=e.dtype;a==null&&(a=e.inputDType),a==null&&(a="float32"),this.dtype=a}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Us(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new P(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Bn(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Bn(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Da(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Da(`Layer ${this.name} is not connected, no input to return.`);return Bn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Da(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Da(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Bn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Xe(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Xe(this.inputSpec);if(n.length!==s.length)throw new P(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let a=0;a<n.length;a++){const r=n[a],i=s[a];if(i==null)continue;const o=r.rank;if(i.ndim!=null&&o!==i.ndim)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(i.maxNDim!=null&&o>i.maxNDim)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(i.minNDim!=null&&o<i.minNDim)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(i.dtype!=null&&r.dtype!==i.dtype)throw new P(`Input ${a} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${r.dtype}.`);if(i.axes){const l=r.shape;for(const u in i.axes){const c=Number(u),d=i.axes[u],p=c>=0?l[c]:l[l.length+c];if(d!=null&&[d,null].indexOf(p)===-1)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const u=i.shape[l],c=r.shape[l];if(u!=null&&c!=null&&u!==c)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${r.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Xe(e),a=U9(e),r=G9(e);if(a===r)throw new P("Arguments to apply() must be all SymbolicTensors or all Tensors");return bo(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const o of Xe(e))i.push(o.shape);this.build(Bn(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&r&&(this._refCount=1)}if(this.assertInputCompatibility(e),r){let i=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,i);const o=Xe(i),l=[];for(let u of o)s.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(i=Bn(l),this.activityRegularizer!=null)throw new Oe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=V9(e),o=this.computeOutputShape(i);let l;const u=W9(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((c,d)=>new Qa(u,c,this,Xe(e),n,this.name,d)):l=new Qa(u,o,this,Xe(e),n,this.name),this.addInboundNode(e,l,null,null,i,o,n),this._refCount++,this.activityRegularizer!=null)throw new Oe("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,a)=>{s!=null&&e[a]!=null&&e[a]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Da(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new Da(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Us(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Um(this.weights)}build(e){this.built=!0}getWeights(e=!1){return yk(e?this.trainableWeights:this.weights)}setWeights(e){M(()=>{const n=this.weights;if(n.length!==e.length)throw new P(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],a=yk(n);for(let r=0;r<a.length;++r){const i=a[r],o=n[r],l=e[r];if(!Le(i.shape,l.shape))throw new P(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([o,l])}f2(s)})}addWeight(e,n,s,a,r,i,o,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new P(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(a=l!=null?l():mt("zeros"));const u=a.apply(n,s),c=new L9(u,s,e,i,o);return u.dispose(),r!=null&&this.addLoss(()=>r.apply(c.read())),i==null&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Xe(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const a=this.computeMask(e,s),r=Xe(n),i=Xe(a);if(r.length!==i.length)throw new Error(`${this.name} outputs ${r.length} tensors but ${r.length} masks for those tensors`);for(let o=0;o<r.length;o++)r[o].kerasMask=i[o]}addInboundNode(e,n,s,a,r,i,o=null){const l=Xe(e);n=Xe(n),s=Xe(s),a=Xe(a),r=Wm(r),i=Wm(i);const u=[],c=[],d=[];for(const p of l)u.push(p.sourceLayer),c.push(p.nodeIndex),d.push(p.tensorIndex);new R0({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:a,inputShapes:r,outputShapes:i},o);for(let p=0;p<n.length;p++)n[p].sourceLayer=this,n[p].nodeIndex=this.inboundNodes.length-1,n[p].tensorIndex=p}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function V9(t){t=Xe(t);const e=[];for(const n of t)e.push(n.shape);return Bn(e)}function W9(t){return"float32"}function HO(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const a=[];for(let r=0;r<s.inboundLayers.length;r++){const i=s.inputTensors[r],o=s.inboundLayers[r],l=s.nodeIndices[r],u=HO(i,o,l);for(const c of u)a.indexOf(c)===-1&&a.push(c)}return a}}}function U9(t){let e=!0;for(const n of Xe(t))if(!(n instanceof Qa)){e=!1;break}return e}function G9(t){let e=!0;for(const n of Xe(t))if(n instanceof Qa){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Kh extends Pe{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:$0("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new P("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new P("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new P("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const a=new Qa(this.dtype,this.batchInputShape,this,[],{},this.name);a.nodeIndex=0,a.tensorIndex=0,new R0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new P(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Kh.className="InputLayer";te(Kh);function H9(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new P("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Kh({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function K9(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return oe(e,t.dtype)}catch{throw new P(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Zr{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Zr)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=K9(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new P(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Qa){if(this.id2Value[e.id]==null)throw new P(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new P(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Qa){if(this.id2Value[e.id]==null)throw new P(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new P(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&_e(this.id2Mask)}}const Gm=new EO,Hm=new EO;function q9(t){Gm!=null&&Gm.setMaxEntries(t),Hm!=null&&Hm.setMaxEntries(t)}function Zc(t,e,n,s){const a=n==null?!1:n.training,r=Array.isArray(t),i=r?t:[t],o=i.map(f=>f.name),l=[],u=e.names();for(const f of o)u.indexOf(f)!==-1?l.push(e.getValue(f)):l.push(null);const c=o.join(",")+"|"+e.names().sort().join(",");let d=Gm.get(c),p;if(d==null){const f=J9(i,e);d=f.sorted,p=f.recipientCounts,Gm.put(c,d),Hm.put(c,p)}p={},a||Object.assign(p,Hm.get(c));const h=new Zr(e);for(let f=0;f<d.length;++f){const m=d[f],y=m.sourceLayer;if(y instanceof Kh)continue;const g=[],b=[],w=[];let k=!1;for(const E of m.inputs){const R=h.getValue(E),L=h.getMask(E);g.push(R),b.push(L),L!=null&&(k=!0),a||(p[E.name]--,p[E.name]===0&&!e.hasKey(E)&&o.indexOf(E.name)===-1&&!R.isDisposed&&E.sourceLayer.stateful!==!0&&w.push(R))}k&&(n=n||{},n.mask=b[0]);const x=Xe(y.apply(g,n));let S=null;y.supportsMasking&&(S=y.computeMask(g,b));const C=Y9(m),T=Array.isArray(C)?C:[C];for(let E=0;E<T.length;++E){h.hasKey(T[E])||h.add(T[E],x[E],Array.isArray(S)?S[0]:S);const R=o.indexOf(T[E].name);R!==-1&&(l[R]=x[E])}a||_e(w)}return h.disposeMasks(),r?l:l[0]}function J9(t,e){I(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const a=NC(t[0],e);n=a.sorted,s=a.recipientMap}else{const a=new Set;for(const r of t){const{sorted:i,recipientMap:o}=NC(r,e);for(const l of i)a.has(l.name)||(n.push(l),a.add(l.name));for(const l in o)s[l]==null&&(s[l]=new Set),o[l].forEach(u=>s[l].add(u))}}return{sorted:n,recipientCounts:X9(s)}}function X9(t){const e={};for(const n in t)e[n]=t[n].size;return e}function NC(t,e){const n=new Set,s=[],a={};for(const o of e.names())n.add(o);const r=[],i=[];for(r.push(t);r.length>0;){const o=r[r.length-1];if(n.has(o.name)){r.pop();continue}const l=i[i.length-1]===r.length-1;if(o.inputs.length===0||l)r.pop(),s.push(o),n.add(o.name),l&&i.pop();else{i.push(r.length-1);for(const u of o.inputs)a[u.name]==null&&(a[u.name]=new Set),a[u.name].add(o.name),!n.has(u.name)&&r.push(u)}}return{sorted:s,recipientMap:a}}function Y9(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const a of t.sourceLayer.inboundNodes[s].outputTensors)if(a.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q9=W();Q9.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,q9);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function m2(t,e){return M(()=>tn(me(D(t,t),e,!0)))}class qh extends tl{getConfig(){return{}}}class KO extends qh{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return M(()=>{const n=m2(e,this.axis),s=Hn(n,0,this.maxValue);return D(e,xe(s,ee(Wt(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}KO.className="MaxNorm";te(KO);class qO extends qh{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return M(()=>xe(e,ee(Wt(),m2(e,this.axis))))}getConfig(){return{axis:this.axis}}}qO.className="UnitNorm";te(qO);class JO extends qh{apply(e){return Ta(e)}}JO.className="NonNeg";te(JO);class XO extends qh{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return M(()=>{const n=m2(e,this.axis),s=ee(D(this.rate,Hn(n,this.minValue,this.maxValue)),D(1-this.rate,n));return D(e,xe(s,ee(Wt(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}XO.className="MinMaxNorm";te(XO);const CC={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Ht(t){return a2(t)}function IC(t,e={}){return Wh(t,ks.getMap().classNameMap,e,"constraint")}function Kt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in CC?CC[t]:t,config:{}};return IC(n)}else return t instanceof qh?t:IC(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function qi(t){if(t==null)return;const e=[],n=[],s=[];for(const a in t){const r=t[a];if(typeof r!="number"){const i=r;e.push(i.data()),n.push(a),s.push(i)}}if(e.length>0){const a=await Promise.all(e);for(let r=0;r<a.length;++r)t[n[r]]=a[r][0];_e(s)}}function YO(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var TC;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(TC||(TC={}));const Z9=125;class Xd{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class eq{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class tq extends Xd{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const a in n){const r=n[a];if(typeof r=="number")this.totals.hasOwnProperty(a)||(this.totals[a]=0),this.totals[a]=this.totals[a]+r*s;else{let i;a in this.totals?i=this.totals[a]:this.totals[a]=0;const o=M(()=>ee(this.totals[a],D(r,s)));this.totals[a]=o,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:M(()=>{const a=D(xe(1,this.seen),this.totals[s]);n[s]=a,this.totals[s].dispose(),Vt(n[s])}))}}class nq extends Xd{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const r in this.history){const i=this.history[r];for(let o=0;o<i.length;++o)if(typeof i[o]!="number"){const l=i[o];e.push(l.data()),n.push(r),s.push(o)}}const a=await Promise.all(e);for(let r=0;r<a.length;++r)this.history[n[r]][s[r]].dispose(),this.history[n[r]][s[r]]=a[r][0]}}class sq extends Xd{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||Pv,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Z9),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Dm(this.yieldEvery)&&(this.maybeWait=g9(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const a=[];this.yield!=null&&(await qi(s),a.push(this.yield(e,n,s))),a.push(this.nextFrameFunc()),await Promise.all(a)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await qi(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await qi(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await qi(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await qi(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Dm(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await qi(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await qi(e),await this.trainEnd(e))}}function QO(t,e){return t==null&&(t={}),t instanceof Xd?[t]:Array.isArray(t)&&t[0]instanceof Xd?t:Xe(t).map(s=>new sq(s,e))}class _s{constructor(){}static registerCallbackConstructor(e,n){I(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),_s.checkForDuplicate(n),_s.constructors[e]==null&&(_s.constructors[e]=[]),_s.constructors[e].push(n)}static checkForDuplicate(e){for(const n in _s.constructors)_s.constructors[+n].forEach(a=>{if(a===e)throw new P("Duplicate callback constructor.")})}static clear(){_s.constructors={}}static createCallbacks(e){const n=[];for(const s in _s.constructors){const a=+s;e>=a&&n.push(..._s.constructors[a])}return n.map(s=>new s)}}_s.constructors={};function ZO(t,e,n,s,a,r,i,o,l){const u=new nq,c=[new tq,..._s.createCallbacks(e)];t!=null&&c.push(...t),c.push(u);const d=new eq(c);return d.setParams({epochs:n,initialEpoch:s,samples:a,steps:r,batchSize:i,verbose:e,doValidation:o,metrics:l}),{callbackList:d,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gr(t,e={},n=!1){return Wh(t,ks.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Km(t,e){return M(()=>{t.dtype!=="float32"&&(t=oe(t,"float32"));const n=me(Gh(t),e,!0),s=Yo(n.shape,Wt()),a=tn(er(n,s));return xe(t,a)})}function A0(t,e){return M(()=>xt(Gh(pe(e,t)),-1))}function g2(t,e){return M(()=>xt(Ft(pe(e,t)),-1))}function y2(t,e){return M(()=>{const n=pe(t,e),s=Hn(Ft(t),Wt(),Number.MAX_VALUE),a=Ft(xe(n,s));return D(100,xt(a,-1))})}function aq(t,e){return M(()=>{const n=Hn(e,Wt(),Number.MAX_VALUE),s=ds(ee(1,n)),a=Hn(t,Wt(),Number.MAX_VALUE),r=ds(ee(1,a));return xt(Gh(pe(s,r)),-1)})}function rq(t,e){return M(()=>{const n=er(0,pe(1,D(t,e)));return xt(Gh(n),-1)})}function iq(t,e){return M(()=>{const n=er(0,pe(1,D(t,e)));return xt(n,-1)})}function oq(t,e){return M(()=>{const n=me(D(t,e),-1),s=Is(D(pe(1,t),e),-1);return er(0,ee(1,pe(s,n)))})}function lq(t,e){return M(()=>{const n=Math.log(2),s=pe(e,t),a=pe(ee(s,Qo(D(-2,s))),n);return xt(a,-1)})}function Yd(t,e,n=!1){return M(()=>{if(n)e=Ph(e);else{const s=me(e,e.shape.length-1,!0);e=xe(e,s)}return e=Hn(e,Wt(),1-Wt()),ot(me(D(oe(t,"float32"),ds(e)),e.shape.length-1))})}function qm(t,e,n=!1){return M(()=>{const s=oe(yc($9(t)),"int32");e=Hn(e,Wt(),1-Wt());const a=e.shape,r=_(nu(s,a[a.length-1]),a);return Yd(r,e,n)})}function uq(t,e){if(!Le(t.shape,e.shape))throw new P(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return M(()=>{const n=Ta(e),s=ot(Ft(e));return ee(pe(n,D(e,t)),$h(Kn(s)))})}function O0(t,e){return M(()=>{let n;return n=Hn(e,Wt(),1-Wt()),n=ds(xe(n,pe(1,n))),xt(uq(t,n),-1)})}function cq(t,e){return M(()=>{const n=Hn(t,Wt(),1),s=Hn(e,Wt(),1);return me(D(t,ds(xe(n,s))),-1)})}function dq(t,e){return M(()=>{const n=ds(ee(Wt(),e));return xt(pe(e,D(t,n)),-1)})}function eD(t,e){return M(()=>{const n=Km(t,-1),s=Km(e,-1),a=D(n,s);return ot(me(a,-1))})}const Jm={meanSquaredError:A0,meanAbsoluteError:g2,meanAbsolutePercentageError:y2,meanSquaredLogarithmicError:aq,squaredHinge:rq,hinge:iq,categoricalHinge:oq,logcosh:lq,categoricalCrossentropy:Yd,sparseCategoricalCrossentropy:qm,binaryCrossentropy:O0,kullbackLeiblerDivergence:cq,poisson:dq,cosineProximity:eD};function Ab(t){if(typeof t=="string"){if(t in Jm)return Jm[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new P(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tD(t,e){return M(()=>{const n=D(.5,ps(e)),s=Ha(Qn(e,n),t.dtype);return xt(Xs(t,s),-1)})}function nD(t,e){return M(()=>Ha(Xs(Ro(t,-1),Ro(e,-1)),"float32"))}function pq(t,e){return M(()=>oe(me(wa(Xs(t,1),Xs(e,1))),"float32"))}function hq(t,e){return M(()=>oe(me(wa(Xs(t,0),Xs(e,1))),"float32"))}function fq(t,e){return M(()=>{const n=pq(t,e),s=hq(t,e),a=ee(n,s);return oe(cn(Qn(a,0),xe(n,a),0),"float32")})}function mq(t,e){return O0(t,e)}function gq(t,e){return t.rank===e.rank&&(t=Mi(t,[t.rank-1])),e=Ro(e,-1),e.dtype!==t.dtype&&(e=oe(e,t.dtype)),oe(Xs(t,e),"float32")}const yq=A0,bq=A0,wq=g2,kq=g2,xq=y2,vq=y2,sD=Yd,Sq=eD,aD=qm,Xm={binaryAccuracy:tD,categoricalAccuracy:nD,precision:fq,categoricalCrossentropy:sD,sparseCategoricalCrossentropy:aD,mse:yq,MSE:bq,mae:wq,MAE:kq,mape:xq,MAPE:vq,cosine:Sq};function Nq(t){if(typeof t=="string"&&t in Xm)return Xm[t];if(typeof t!="string"&&t!=null)return t;throw new P(`Unknown metric ${t}`)}function $f(t){if(ja(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Jm))if(Jm[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Xm))if(Xm[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Cq(t){const e={Adagrad:()=>Zi.adagrad(.01),Adadelta:()=>Zi.adadelta(1,.95,Wt()),Adam:()=>Zi.adam(.001,.9,.999,Wt()),Adamax:()=>Zi.adamax(.002,.9,.999,Wt(),0),RMSProp:()=>Zi.rmsprop(.001,.9,0,Wt()),SGD:()=>Zi.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new P(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const $C=1*1024*1024;function EC(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!bk(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>$C&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${$C}.`)}}function bk(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!bk(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!bk(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Iq(t,e,n,s=console.log){const a=$q(t),r=["Layer (type)","Input Shape","Output shape","Param #"];a?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(e*c)));let i;if(!a){r.push("Receives inputs"),i=[];for(const c in t.nodesByDepth)i.push(...t.nodesByDepth[c])}s("_".repeat(e)),Ym(r,n,s),s("=".repeat(e));const o=t.layers;for(let c=0;c<o.length;++c)a?Eq(o[c],n,s):Rq(o[c],n,i,s),s((c===o.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=Tq(t),u=Um(t.nonTrainableWeights);s(`Total params: ${l+u}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function Tq(t){let e;return t.collectedTrainableWeights!=null?e=Um(t.collectedTrainableWeights):e=Um(t.trainableWeights),e}function $q(t){let e=!0;const n=[],s=[];for(const a in t.nodesByDepth)n.push(t.nodesByDepth[a]);for(const a of n){if(a.length>1||a.length===1&&a[0].inboundLayers.length>1){e=!1;break}s.push(...a)}if(e)for(const a of t.layers){let r=!1;for(const i of a.inboundNodes)if(s.indexOf(i)!==-1)if(r){e=!1;break}else r=!0;if(!e)break}return e}function Ym(t,e,n=console.log){let s="";for(let a=0;a<t.length;++a)a>0&&(s=s.slice(0,s.length-1)+" "),s+=t[a],s=s.slice(0,e[a]),s+=" ".repeat(e[a]-s.length);n(s)}function Eq(t,e,n){let s,a;try{a=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{a="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const r=t.name,i=t.getClassName(),o=[`${r} (${i})`,a,s,t.countParams().toString()];Ym(o,e,n)}function Rq(t,e,n,s){let a,r;try{r=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{r="multiple"}try{a=JSON.stringify(t.outputShape)}catch{a="multiple"}const i=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let p=0;p<d.inboundLayers.length;++p){const h=d.inboundLayers[p].name,f=d.nodeIndices[p],m=d.tensorIndices[p];i.push(`${h}[${f}][${m}]`)}const o=t.name,l=t.getClassName(),u=i.length===0?"":i[0],c=[`${o} (${l})`,r,a,t.countParams().toString(),u];Ym(c,e,s);for(let d=1;d<i.length;++d)Ym(["","","","",i[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rD(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function wk(t,e){if(t===null)return null;if(typeof t=="string")return no(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let a=0;a<s;++a){const r=t[a];rD(e,a,r)?n.push(r):n.push(wk(r,e))}return n}else{const n={};for(const s of Object.keys(t)){const a=t[s];if(s==="name"&&typeof a=="string")n[s]=a;else{const r=no(s);n[r]=wk(a,r)}}return n}}function kk(t,e){if(t==null)return null;if(typeof t=="string")return or(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let a=0;a<s;++a){const r=t[a];rD(e,a,r)?n.push(r):n.push(kk(r,e))}return n}else{const n={};for(const s of Object.keys(t)){const a=t[s],r=or(s);(s==="name"||s==="className")&&typeof a=="string"?n[r]=a:n[r]=kk(a,s)}return n}}/** @license See the LICENSE file. */const iD="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Aq=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class sa extends Pe{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const b=this.getClassName().toLowerCase();this.name=$0(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],di(this.inputs).length!==this.inputs.length)throw new P(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);di(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const b of this.outputs){const w=b.sourceLayer,k=b.nodeIndex,x=b.tensorIndex;this.outputLayers.push(w),this.outputLayersNodeIndices.push(k),this.outputLayersTensorIndices.push(x)}for(const b of this.inputs){const w=b.sourceLayer,k=b.nodeIndex,x=b.tensorIndex;ja(k===0,"input layer has >1 nodes"),ja(x===0,"input layer has >1 tensors"),this.inputLayers.push(w),this.inputLayersNodeIndices.push(k),this.inputLayersTensorIndices.push(x)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){const w=this.inputLayers[b];if(!(w instanceof Kh))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${b} (0-based) originates from layer type ${w.getClassName()}.`);this.inputNames.push(w.name),this.feedInputShapes.push(w.batchInputShape),this.feedInputNames.push(w.name)}for(const b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);const n={},s={},a={},r={},i={},o=[],l=(b,w,k,x,S,C)=>{(x==null||S==null||C==null)&&(x=b.sourceLayer,S=b.nodeIndex,C=b.tensorIndex);const T=x.inboundNodes[S];if(k.indexOf(T)!==-1)throw new Us(`The tensor ${b.name} at layer "${x.name}" is part of a cycle.`);if(w.indexOf(T)!==-1)return;this.containerNodes.add(sa.nodeKey(x,S)),x.id in i||(i[x.id]=Object.keys(i).length),k.indexOf(T)===-1&&k.push(T);const E=T.inboundLayers.length;for(let R=0;R<E;R++){const L=T.inputTensors[R],U=T.inboundLayers[R],G=T.nodeIndices[R],F=T.tensorIndices[R];l(L,w,k,U,G,F)}for(w.push(T);k.indexOf(T)>=0;)k.splice(k.indexOf(T),1);o.push(T)},u=[],c=[];for(const b of this.outputs)l(b,u,c);const d=o.slice().reverse();for(const b of d){s[b.id]=b,b.id in n||(n[b.id]=0);let w=n[b.id];const k=a[b.outboundLayer.id]==null?0:a[b.outboundLayer.id];w=Math.max(w,k),a[b.outboundLayer.id]=w,r[b.outboundLayer.id]=b.outboundLayer,n[b.id]=w;for(let x=0;x<b.inboundLayers.length;x++){const S=b.inboundLayers[x],C=b.nodeIndices[x],T=S.inboundNodes[C],E=n[T.id]==null?0:n[T.id];n[T.id]=Math.max(w+1,E),s[T.id]=T}}const p={};for(const b in n){const w=n[b];w in p||(p[w]=[]),p[w].push(s[b])}const h={};for(const b in a){const w=a[b];w in h||(h[w]=[]),h[w].push(r[b])}let f=Object.keys(h).map(b=>parseInt(b,10)).sort(Cf);this.layers=[];for(const b of f){const w=h[b];w.sort((k,x)=>{const S=i[k.id],C=i[x.id];return S<C?-1:S>C?1:0});for(const k of w)k instanceof sa&&this.internalContainerRefs.push(k),this.layers.push(k)}this.layersByDepth=h,f=Object.keys(p).map(b=>parseInt(b,10)).sort(Cf);const m=this.inputs.slice(),y=[];for(const b of f)for(const w of p[b]){const k=w.outboundLayer;if(k!=null){for(const x of w.inputTensors)if(m.indexOf(x)===-1)throw new Us(`Graph disconnected: cannot obtain value for tensor ${x} at layer "${k.name}". The following previous layers were accessed without issue: ${y}`);for(const x of w.outputTensors)m.push(x);y.push(k.name)}}this.nodesByDepth=p;const g=this.layers.map(b=>b.name);for(const b of g){const w=g.filter(k=>k===b).length;if(w!==1)throw new Us(`The name "${b}" is used ${w} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new R0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new P("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let a=0;const r=Aq(e);r&&this.parseWeights(e);for(const o of this.layers)for(const[l,u]of o.weights.entries()){const c=r?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(s[c]!=null)throw new P(`Duplicate weight name: ${c}`);s[c]=u,a++}const i=[];for(const o in e){let l=o;if(s[o]==null){const u=o.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],e[o]]);else if(n)throw new P(`Provided weight data has no target variable: ${o}`);delete s[l]}if(n){const o=[];for(const l in s)o.push(l);if(o.length>0)throw new P(`${o.length} of ${a} weights are not set: ${o}`)}f2(i)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),a=["vars","layer_checkpoint_dependencies"],r=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!a.includes(i)).join("/");r!==n&&(e[r]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${iD}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=kk(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return M(()=>{e=Xe(e);const s=new Zr;for(let a=0;a<this.inputs.length;++a)s.add(this.inputs[a],e[a]);return Zc(this.outputs,s,n)})}computeMask(e,n){return M(()=>{e=Xe(e);let s;return n==null?s=Fo(null,e.length):s=Xe(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=Wm(e);if(n.length!==this.inputLayers.length)throw new P(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let o=0;o<n.length;o++){const l=this.inputLayers[o],u=n[o],c=l.name+"_0_0";s[c]=u}const a=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(Cf);if(a.length>1)for(const o of a){const l=this.nodesByDepth[o];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(c.id)!==-1)continue;const d=[];for(let m=0;m<u.inboundLayers.length;m++){const y=u.inboundLayers[m],g=u.nodeIndices[m],b=u.tensorIndices[m],w=`${y.name}_${g}_${b}`,k=s[w];d.push(k)}const p=c.computeOutputShape(Bn(d)),h=Wm(p),f=c.inboundNodes.indexOf(u);for(let m=0;m<h.length;m++){const y=`${c.name}_${f}_${m}`;s[y]=h[m]}}}const r=[],i=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],u=this.outputLayersNodeIndices[o],c=this.outputLayersTensorIndices[o],d=`${l.name}_${u}_${c}`;i.push(d)}for(let o=0;o<i.length;o++){const l=i[o];ja(l in s),r.push(s[l])}return Bn(r)}runInternalGraph(e,n){n==null&&(n=Fo(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],d=n[l];s[u.id]=[c,d]}const a=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Cf);for(const l of a){const u=this.nodesByDepth[l];for(const c of u){const d=c.outboundLayer,p=c.inputTensors,h=c.outputTensors,f=new Array;for(const m of p)m.id in s&&f.push(s[m.id]);if(f.length===p.length){let m={},y,g,b,w;if(c.callArgs!=null&&(m=c.callArgs),f.length===1){const[k,x]=f[0];m.mask==null&&(m.mask=x),b=Xe(d.call(k,m)),w=Xe(d.computeMask(k,x)),y=[k],g=[x]}else y=f.map(k=>k[0]),g=f.map(k=>k[1]),m.mask==null&&(m.mask=g),b=Xe(d.call(y,m)),w=Xe(d.computeMask(y,g));if(d.activityRegularizer)throw new Oe("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let k=0;k<h.length;++k){const x=h[k],S=b[k],C=w[k];s[x.id]=[S,C]}}}}const r=[],i=[],o=[];for(const l of this.outputs){ja(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=s[l.id];o.push(u.shape),r.push(u),i.push(c)}return[r,i,o]}buildNodeConversionMap(e){const n={};let s;for(const a of this.layers){s=a instanceof sa?1:0;for(let r=0;r<a.inboundNodes.length;r++){const i=sa.nodeKey(a,r);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new P("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new P(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new P(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return M(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const a=sa.nodeKey(n,s);this.containerNodes.has(a)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const o=i.getClassName(),l=i.getConfig(),u=[];for(let d=0;d<i.inboundNodes.length;d++){const p=i.inboundNodes[d],h=sa.nodeKey(i,d);let f={};if(this.containerNodes.has(h)){if(p.callArgs)try{JSON.stringify(p.callArgs),f=p.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),f={}}if(p.inboundLayers.length>0){const m=[];for(let y=0;y<p.inboundLayers.length;y++){const g=p.inboundLayers[y],b=p.nodeIndices[y],w=p.tensorIndices[y],k=sa.nodeKey(g,b);let x=n[k];x==null&&(x=0),m.push([g.name,x,w,f])}u.push(m)}}}const c={};c.name=i.name,c.className=o,c.config=l,c.inboundNodes=u,s.push(c)}e.layers=s;const a=[];for(let i=0;i<this.inputLayers.length;i++){const o=this.inputLayers[i],l=this.inputLayersNodeIndices[i],u=sa.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.inputLayersTensorIndices[i];a.push([o.name,c,d])}e.inputLayers=a;const r=[];for(let i=0;i<this.outputLayers.length;i++){const o=this.outputLayers[i],l=this.outputLayersNodeIndices[i],u=sa.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.outputLayersTensorIndices[i];r.push([o.name,c,d])}return e.outputLayers=r,e}static fromConfig(e,n,s={},a=!1){const r={},i={};function o(y,g){y.name in i?i[y.name].push(g):i[y.name]=[g]}function l(y,g){const b=[];let w;for(const k of g){const x=k[0],S=k[1],C=k[2];if(w=k[3]==null?{}:k[3],!(x in r)){o(y,g);return}const T=r[x];if(T.inboundNodes.length<=S){o(y,g);return}const E=T.inboundNodes[S];b.push(E.outputTensors[C])}b.length>0&&y.apply(Bn(b),w)}function u(y){const g=y.name,b=gr(y,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(a),r[g]=b,y.inboundNodes.forEach(k=>{if(!(k instanceof Array))throw new P(`Corrupted configuration, expected array for nodeData: ${k}`);o(b,k)})}const c=n.name,d=n.layers;for(const y of d)u(y);for(;!m9(i);)for(const y of d){const g=r[y.name];if(g.name in i){const b=i[g.name];delete i[g.name];for(const w of b)l(g,w)}}const p=[],h=[],f=n.inputLayers;for(const y of f){const g=y[0],b=y[1],w=y[2];ja(g in r);const x=r[g].inboundNodes[b].outputTensors;p.push(x[w])}const m=n.outputLayers;for(const y of m){const g=y[0],b=y[1],w=y[2];ja(g in r);const x=r[g].inboundNodes[b].outputTensors;h.push(x[w])}return new e({inputs:p,outputs:h,name:c})}get stateful(){if(this._stateful)throw new P("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){M(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oq(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(a=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const a=[];return e.forEach(r=>{r in t?a.push(t[r]):a.push(null)}),a}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function oD(t,e){return Oq(t,e,"classWeight")}async function lD(t,e,n,s){if(n!=null){const a=M(()=>{if(t.shape.length===1)return Ua(t);if(t.shape.length===2){if(t.shape[1]>1)return Ro(t,1);if(t.shape[1]===1)return _(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(await a.data());_e(a);const i=[];return r.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);i.push(n[o])}),wn(i,"float32")}else return null}function Dq(t,e){return D(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const jq=32;function uD(t,e){let n,s;const a=e;n=a.xs,s=a.ys,I(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const r=RC("input",t.inputNames,n),i=RC("output",t.outputNames,s),o=r[0].shape[0];I(r.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${r.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),I(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<r.length;l++)I(r[l].shape[0]===o,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${r[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)I(i[l].shape[0]===o,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);return{xs:r,ys:i}}function RC(t,e,n){if(n instanceof qe)return[n];if(Array.isArray(n))return I(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const a of e){if(n[a]==null)throw new P(`The feature data generated by the dataset lacks the required ${t} key '${a}'.`);s.push(n[a])}return s}}function _q(t){if(t.length===3)throw new Oe("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function Fq(t,e,n){const s=n.batchesPerEpoch!=null;if(I(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),I(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),I(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),I(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),I(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const a=n.validationData!=null;let r,i;if(a)if(AC(n.validationData))I(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const y=_q(n.validationData);r=y.xs,i=y.ys}const o=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;a?u=l.slice().concat(l.map(y=>"val_"+y)):u=l.slice();const c=QO(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:p,history:h}=ZO(c,d,n.epochs,null,null,Pq(e,n),null,a,u);p.setModel(t),t.history=h,await p.onTrainBegin(),t.stopTraining_=!1;let f=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;f<n.epochs;){const y={};await p.onEpochBegin(f);let g=0,b=0;for(s||(m=await e.iterator());!s||g<n.batchesPerEpoch;){const w=await m.next();if(s&&w.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${g} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(w.value!=null){const{xs:k,ys:x}=uD(t,w.value),S={};S.batch=b,S.size=k[0].shape[0],await p.onBatchBegin(b,S);const C=[];if(n.classWeight!=null){const R=oD(n.classWeight,t.outputNames);for(let L=0;L<R.length;++L)C.push(await lD(x[L],null,R[L]))}const T=k.concat(x).concat(C),E=o(T);_e(T);for(let R=0;R<l.length;++R){const L=l[R],U=E[R];S[L]=U,Vt(U)}await p.onBatchEnd(b,S),YO(S),b++,g++}if(s?g>=n.batchesPerEpoch:w.done){if(a){let k;AC(n.validationData)?k=Xe(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):k=Xe(t.evaluate(r,i,{batchSize:n.validationBatchSize==null?jq:n.validationBatchSize,verbose:0}));for(let x=0;x<t.metricsNames.length;++x)y[`val_${t.metricsNames[x]}`]=k[x]}break}if(t.stopTraining_)break}if(await p.onEpochEnd(f,y),f++,t.stopTraining_)break}return await p.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Pq(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function AC(t){return typeof t.iterator=="function"}function Lq(t){return typeof t.next=="function"}async function Bq(t,e,n){n=n||{};const s=n.batches!=null,a=t.testFunction;let r=[];if(n.verbose>0)throw new Oe("Verbose mode is not implemented yet.");I(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=Lq(e)?e:await e.iterator();let o=0,l=0;for(;!s||l<n.batches;){const u=await i.next();if(r=M(()=>{if(u.value){const{xs:c,ys:d}=uD(t,u.value),p=c.concat(d),h=M(()=>a(p));if(_e(p),l===0)for(let m=0;m<h.length;++m)r.push(Se(0));const f=p[0].shape[0];for(let m=0;m<h.length;++m){const y=h[m],g=r[m];r[m]=M(()=>ee(r[m],D(f,y))),l>0&&_e(g)}_e(h),o+=f,++l}return r}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<r.length;++u){const c=r[u];r[u]=xe(r[u],o),_e(c)}return Bn(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ob(t){I(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Uc(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>wo(s,e,n-e)):wo(t,e,n-e)}function xk(t,e){return M(()=>t==null?null:Array.isArray(t)?t.map(n=>xk(n,e)):PO(t,e.dtype==="int32"?e:oe(e,"int32")))}function Db(t,e){const n=[];let s=0,a=null;for(;s<t;)a=s+e,a>=t&&(a=t),n.push([s,a]),s=a;return n}function cD(t){const e=[];t instanceof qe&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(Uh(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function na(t,e){if(t==null)return;const n=[];if(e instanceof qe)n.push(e.id);else if(Array.isArray(e))e.forEach(a=>n.push(a.id));else if(e!=null)for(const a in e){const r=e[a];n.push(r.id)}const s=[];if(t instanceof qe)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(a=>{n.indexOf(a.id)===-1&&s.push(a)});else if(t!=null)for(const a in t){const r=t[a];n.indexOf(r.id)===-1&&s.push(r)}s.forEach(a=>{a.isDisposed||a.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zq(t){return t instanceof qe}function vk(t){return Array.isArray(t)}function OC(t){return!zq(t)&&!vk(t)}function DC(t,e,n,s=!0,a=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(vk(t)&&t.length>0)i=!0;else if(OC(t)){for(const o in t)if(t.hasOwnProperty(o)){i=!0;break}}else i=!0;if(i)throw new P(`Error when checking model ${a} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let r;if(OC(t)){t=t,r=[];for(const i of e){if(t[i]==null)throw new P(`No data provided for "${i}". Need data for each key in: ${e}`);r.push(t[i])}}else if(vk(t)){if(t=t,t.length!==e.length)throw new P(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);r=t}else{if(t=t,e.length>1)throw new P(`The model ${a} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);r=[t]}if(r=cD(r),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const o=r[i];if(o.shape.length!==n[i].length)throw new P(`Error when checking ${a}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const u=o.shape[l],c=n[i][l];if(c!=null&&c>=0&&u!==c)throw new P(`${a} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${a} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return r}function Mq(t,e,n){const s=di(t.map(r=>r.shape[0]));s.sort();const a=di(e.map(r=>r.shape[0]));if(a.sort(),s.length>1)throw new P(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(r=>r.shape))}`);if(a.length>1)throw new P(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(r=>r.shape))}`);if(s.length>0&&a.length>0&&!Le(s,a))throw new P(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${a[0]} target sample(s).`)}function Vq(t,e,n){const s=[A0,O0,Yd];for(let a=0;a<t.length;++a){const r=t[a],i=e[a],o=n[a];if(i!=null){if(i===Yd&&r.shape[r.shape.length-1]===1)throw new P(`You are passing a target array of shape ${r.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=r.shape.slice(1),u=o.slice(1);for(let c=0;c<l.length;++c){const d=l[c],p=u[c];if(p!=null&&d!==p)throw new P(`A target Tensor with shape ${r.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function jC(t,e,n,s=!0,a=""){let r;if(Array.isArray(t)){if(t.length!==e.length)throw new P(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);r=t}else{if(e.length>1)throw new P(`The model expects ${e.length} ${a} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);r=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const o=r[i];if(o.shape.length!==n[i].length)throw new P(`Error when checking ${a}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const u=o.shape[l],c=n[i][l];if(c!=null&&c!==u)throw new P(`Error when checking ${a}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function Wq(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const a of e){let r=n.hasOwnProperty(a)?n[a]:[];Array.isArray(r)||(r=[r]),s.push(r)}return s}}const Uq="layers-model";class Pl extends sa{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new P("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Iq(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Cq(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof _r))throw new P("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new P(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(Ab(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new P(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(o=>Ab(o))}else{const i=Ab(e.loss);this.outputs.forEach(o=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const o=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],bo("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([o,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const a=Wq(e.metrics,this.outputNames),r=(i,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[i]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,i])};bo("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=a[i];(u=>{const c="";let d,p,h;for(const f of u){if(typeof f=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(f)!==-1){const y=this.internalOutputShapes[i];y[y.length-1]===1||this.lossFunctions[i]===O0?["accuracy","acc"].indexOf(f)!==-1?p=tD:["crossentropy","ce"].indexOf(f)!==-1&&(p=mq):this.lossFunctions[i]===qm?["accuracy","acc"].indexOf(f)!==-1?p=gq:["crossentropy","ce"].indexOf(f)!==-1&&(p=aD):["accuracy","acc"].indexOf(f)!==-1?p=nD:["crossentropy","ce"].indexOf(f)!==-1&&(p=sD);let g;["accuracy","acc"].indexOf(f)!==-1?g="acc":["crossentropy","ce"].indexOf(f)!==-1&&(g="ce"),h=p,d=c+g}else h=Nq(f),d=c+$f(f);let m;bo(d,()=>{m=h}),r(i,d,m)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const a=s.batchSize==null?32:s.batchSize;Ob(a);const i=this.standardizeUserDataXY(e,n,!0,a);try{const o=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,o,a,s.verbose,s.steps);return Bn(u)}finally{na(i[0],e),na(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),Bq(this,e,n)}checkNumSamples(e,n,s,a="steps"){let r;if(s!=null){if(r=null,n!=null)throw new P(`If ${a} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?r=e[0].shape[0]:r=e.shape[0];else throw new P(`Either the input data should have a defined shape, or ${a} shoud be specified.`);return r}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new P("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),a=s?n:[n],r=this.retrieveSymbolicTensors(a),i=new Zr;if(e instanceof qe&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new P(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new P(`No value is provided for the model's input ${l.name}`);i.add(l,u)}const o=Zc(r,i);return s?o:o[0]}retrieveSymbolicTensors(e){const n=Fo(null,e.length);let s=e.length;for(const a of this.layers){const r=Array.isArray(a.output)?a.output:[a.output],i=r.map(o=>o.name);for(let o=0;o<e.length;++o){const l=i.indexOf(e[o]);if(l!==-1&&(n[o]=r[l],s--),s===0)break}if(s===0)break}if(s>0){const a=[];throw n.forEach((r,i)=>{r==null&&a.push(e[i])}),new P(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(a)}`)}return n}predictLoop(e,n=32,s=!1){return M(()=>{const a=this.checkNumSamples(e);if(s)throw new Oe("Verbose predictLoop() is not implemented yet.");const r=Db(a,n),i=this.outputs.map(o=>[]);for(let o=0;o<r.length;++o)M(()=>{const u=r[o][0],c=r[o][1],d=Uc(e,u,c),p=[];if(Array.isArray(d))for(let f=0;f<d.length;++f)p.push({key:this.inputs[f],value:d[f]});else p.push({key:this.inputs[0],value:d});const h=new Zr(p);return Zc(this.outputs,h)}).forEach((u,c)=>i[c].push(u));return Bn(i.map(o=>At(o,0)))})}predict(e,n={}){const s=cD(e);jC(s,this.inputNames,this.feedInputShapes,!1);try{const a=n.batchSize==null?32:n.batchSize;return Ob(a),this.predictLoop(s,a)}finally{na(s,e)}}predictOnBatch(e){jC(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,a){if(this.optimizer_==null)throw new Us("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let i=0;i<this.feedOutputShapes.length;++i){const o=this.feedOutputShapes[i];this.feedLossFns[i]===qm?r.push(o.slice(0,o.length-1).concat([1])):r.push(o)}if(e=DC(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=DC(n,this.feedOutputNames,r,!1,"target"),Mq(e,n),Vq(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&a!=null&&a>0&&e[0].shape[0]%a!==0)throw new P(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${a}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,a,r=!0,i){const[o,l]=this.standardizeUserDataXY(e,n,r,i);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(a!=null){const c=oD(a,this.outputNames);u=[];for(let d=0;d<c.length;++d)u.push(await lD(l[d],null,c[d]))}return[o,l,u]}testLoop(e,n,s,a=0,r){return M(()=>{const i=this.checkNumSamples(n,s,r,"steps"),o=[];if(a>0)throw new Oe("Verbose mode is not implemented yet.");if(r!=null)throw new Oe("steps mode in testLoop() is not implemented yet");{const l=Db(i,s),u=wn(ka(0,i));for(let c=0;c<l.length;++c){const d=l[c][0],p=l[c][1],h=wo(u,d,p-d),f=xk(n,h),m=e(f);if(c===0)for(let y=0;y<m.length;++y)o.push(Se(0));for(let y=0;y<m.length;++y){const g=m[y];o[y]=ee(o[y],D(p-d,g))}}for(let c=0;c<o.length;++c)o[c]=xe(o[c],i)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const a=e[s];let r=a;if(bC(e,a)>1){const i=bC(e.slice(0,s),a);r+=`_${i}`}n.push(r)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],o=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:s[m]});const p=new Zr(d),h=Zc(this.outputs,p,{training:!0});let f;for(let m=0;m<this.lossFunctions.length;++m){const y=this.lossFunctions[m];let g=y(a[m],h[m]);r[m]!=null&&(g=Dq(g,r[m]));const b=xt(g);n.push(b),m===0?f=g:f=ee(f,g)}for(let m=0;m<this.metricsTensors.length;++m){let y;if(this.outputs.length>1&&m<this.outputs.length)y=n[m];else{const g=this.metricsTensors[m][0],b=this.metricsTensors[m][1];y=xt(g(a[b],h[b]))}Vt(y),i.push(y)}return f=xt(f),this.calculateLosses().forEach(m=>{f=ee(f,m)}),f},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(o,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>M(()=>{const n=[];let s;const a=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let u=0;u<this.inputs.length;++u)i.push({key:this.inputs[u],value:a[u]});const o=new Zr(i),l=Zc(this.outputs,o);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],d=xt(c(r[u],l[u]));u===0?s=d:s=ee(s,d),n.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],d=this.metricsTensors[u][1],p=xt(c(r[d],l[d]));n.push(p)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let a,r,i,o,l,u,c,d,p;try{const h=s.batchSize==null?32:s.batchSize;Ob(h);const m=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,h);a=m[0],r=m[1],p=m[2];let y=!1,g;if(s.validationData!=null&&s.validationData.length>0){if(y=!0,s.validationData.length===2)l=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new Oe("validationData including sample weights is not supported yet."):new P(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const R=await this.standardizeUserData(l,u,null,null,!0,h);c=R[0],d=R[1],g=c.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){y=!0;const E=Math.floor(a[0].shape[0]*(1-s.validationSplit)),R=a[0].shape[0];c=Uc(a,E,R),i=a,a=Uc(a,0,E),d=Uc(r,E,R),o=r,r=Uc(r,0,E),g=c.concat(d)}else s.validationSteps!=null&&(y=!0);const b=a.concat(r).concat(p);this.checkTrainableWeightsConsistency();const w=this.makeTrainFunction(),k=this.getDedupedMetricsNames();let x,S;y?(this.makeTestFunction(),x=this.testFunction,S=k.slice().concat(k.map(E=>"val_"+E))):(x=null,g=[],S=k.slice());const C=QO(s.callbacks,s.yieldEvery);return await this.fitLoop(w,b,k,h,s.epochs,s.verbose,C,x,g,s.shuffle,S,s.initialEpoch,null,null)}finally{this.isTraining=!1,na(a,e),na(r,n),na(i,e),na(o,n),na(c,l),na(d,u),p!=null&&_e(p)}}async fitLoop(e,n,s,a,r,i,o,l,u,c,d,p,h,f){a==null&&(a=32),r==null&&(r=1),c==null&&(c=!0),p==null&&(p=0);let m=!1;if(l!=null&&u!=null&&(m=!0),f!=null&&(m=!0,h==null))throw new P("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const y=this.checkNumSamples(n,a,h,"steps_per_epoch");let g;y!=null&&(g=ka(0,y)),i==null&&(i=1);const{callbackList:b,history:w}=ZO(o,i,r,p,y,h,a,m,d);b.setModel(this),this.history=w,await b.onTrainBegin(),this.stopTraining_=!1;for(let k=p;k<r;++k){await b.onEpochBegin(k);const x={};if(h!=null)throw new Oe("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Oe("batch shuffling is not implemneted yet");c&&Jx(g);const S=wn(g),C=Db(y,a);for(let T=0;T<C.length;++T){const E={};if(await b.onBatchBegin(T,E),M(()=>{const R=C[T][0],L=C[T][1],U=wo(S,R,L-R);E.batch=T,E.size=L-R;const G=xk(n,U),F=e(G);for(let z=0;z<s.length;++z){const H=s[z],X=F[z];E[H]=X,Vt(X)}if(T===C.length-1&&m){const z=this.testLoop(l,u,a);for(let H=0;H<s.length;++H){const X=s[H],j=z[H];Vt(j),x["val_"+X]=j}}}),await b.onBatchEnd(T,E),YO(E),this.stopTraining_)break}S.dispose()}if(await b.onEpochEnd(k,x),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return Fq(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),a=s[0],r=s[1],o=this.makeTrainFunction()(a.concat(r)),l=[];for(const u of o){const c=await u.data();l.push(c[0])}return _e(o),na(s[0],e),na(s[1],n),Bn(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,a=s?this.trainableWeights:this.weights,r=this.getWeights(s);for(let i=0;i<a.length;++i)s&&!a[i].trainable||n.push({name:a[i].originalName,tensor:r[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=tk().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-tk().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=or(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>or(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const a of n)if(typeof s[a]=="string")e[a]=or(s[a]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[or($f(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>or($f(e)));{const e={};for(const n in this.metrics)e[n]=or($f(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=wk(e.optimizer_config),s=gr(n);let a;if(typeof e.loss=="string")a=no(e.loss);else if(Array.isArray(e.loss))a=e.loss.map(i=>no(i));else if(e.loss!=null){a={};for(const i in e.loss)a[i]=no(e.loss[i])}let r;if(Array.isArray(e.metrics))r=e.metrics.map(i=>no(i));else if(e.metrics!=null){r={};for(const i in e.metrics)r[i]=no(e.metrics[i])}this.compile({loss:a,metrics:r,optimizer:s})}async save(e,n){if(typeof e=="string"){const u=IR(e);if(u.length===0)throw new P(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new P(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new P("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await nk(this.getNamedWeights(n)),o={modelTopology:this.toJSON(null,!1),format:Uq,generatedBy:`TensorFlow.js tfjs-layers v${iD}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:d}=await nk(await this.optimizer.getWeights(),u);s.specs.push(...d),s.data=NR([s.data,c])}return this.userDefinedMetadata!=null&&(EC(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=s.data,o.weightSpecs=s.specs,e.save(o)}setUserDefinedMetadata(e){EC(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Pl.className="Model";te(Pl);class dD extends Pl{}dD.className="Functional";te(dD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Qd extends Pl{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:$0("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new P(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Qd||e instanceof Pl;let s;if(n){if(s=e,s.outputs.length!==1)throw new P("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new P("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new P("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const a=H9({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new P(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new P("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=HO(this.outputs[0])}this.inboundNodes=[],new R0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Fo(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(a=>a.shape),outputShapes:this.outputs[0].shape})}else{const a=e.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(He(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Pl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Us("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},a=!1){let r,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new P("Legacy serialization format not supported yet.");r=n}else I(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),r=n.layers,delete n.layers,i=n;const o=new e(i);if(!(o instanceof Qd))throw new Oe(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of r){const c=gr(l,void 0,a);a&&c.setFastWeightInitDuringBuild(!0),o.add(c)}return o}set stopTraining(e){if(this.model==null)throw new P("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new P("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Qd.className="Sequential";te(Qd);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Sn=class extends tl{getConfig(){return{}}};class pD extends Sn{apply(e,n=1){return R9(e,n)}}pD.className="elu";te(pD);class hD extends Sn{apply(e){return s0(e)}}hD.className="selu";te(hD);class fD extends Sn{apply(e){return Ta(e)}}fD.className="relu";te(fD);class mD extends Sn{apply(e){return M(()=>Si(6,Ta(e)))}}mD.className="relu6";te(mD);class gD extends Sn{apply(e){return e}}gD.className="linear";te(gD);class yD extends Sn{apply(e){return ga(e)}}yD.className="sigmoid";te(yD);class bD extends Sn{apply(e){return O9(e)}}bD.className="hardSigmoid";te(bD);class wD extends Sn{apply(e){return Qo(e)}}wD.className="softplus";te(wD);class kD extends Sn{apply(e){return A9(e)}}kD.className="softsign";te(kD);class xD extends Sn{apply(e){return vi(e)}}xD.className="tanh";te(xD);let b2=class extends Sn{apply(e,n=-1){return Ph(e,n)}};b2.className="softmax";te(b2);class vD extends Sn{apply(e,n=-1){return Jy(e,n)}}vD.className="logSoftmax";te(vD);class SD extends Sn{apply(e){return M(()=>M(()=>{const n=Math.sqrt(2),s=D(.5,ee(1,Hy(xe(e,n))));return D(e,s)}))}}SD.className="gelu";te(SD);class ND extends Sn{apply(e){return M(()=>D(.5,D(e,ee(1,vi(D(tn(xe(2,Math.PI)),ee(e,D(.044715,Xa(e,3)))))))))}}ND.className="gelu_new";te(ND);class CD extends Sn{apply(e){return M(()=>D(e,vi(Qo(e))))}}CD.className="mish";te(CD);class ID extends Sn{apply(e,n=1){return M(()=>D(ga(D(e,n)),e))}}ID.className="swish";te(ID);function Ci(t){return t.getClassName()}function jb(t,e={}){return Wh(t,ks.getMap().classNameMap,e,"activation")}function Ii(t){if(t==null){const e={};return e.className="linear",e.config={},jb(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},jb(e)}else return t instanceof Sn?t:jb(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Gq(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class TD extends tl{}class $D extends TD{constructor(e){super(),Gq(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return M(()=>{let n=Lt([1]);return this.hasL1&&(n=ee(n,me(D(this.l1,Ft(e))))),this.hasL2&&(n=ee(n,me(D(this.l2,Gh(e))))),_(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}$D.className="L1L2";te($D);const _C={l1l2:"L1L2"};function st(t){return a2(t)}function FC(t,e={}){return Wh(t,ks.getMap().classNameMap,e,"regularizer")}function gt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in _C?_C[t]:t,config:{}};return FC(n)}else return t instanceof TD?t:FC(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ED extends Pe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=Ie(e);let s=Ta(e);return this.maxValue!=null&&(s=Hn(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}ED.className="ReLU";te(ED);class RD extends Pe{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Ie(e);return Th(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}RD.className="LeakyReLU";te(RD);class AD extends Pe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=mt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=gt(e.alphaRegularizer),this.alphaConstraint=Kt(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new P(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=He(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const a of this.sharedAxes)n[a-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let a=1;a<e.length;++a)s[a]=e[a];this.inputSpec=[new Ut({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=Ie(e),jh(e,this.alpha.read())}getConfig(){const e={alphaInitializer:vt(this.alphaInitializer),alphaRegularizer:st(this.alphaRegularizer),alphaConstraint:Ht(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}AD.className="PReLU";te(AD);let OD=class extends Pe{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Oe(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Ie(e);return mc(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};OD.className="ELU";te(OD);class DD extends Pe{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=Ie(e);return D(s,oe(Qn(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}DD.className="ThresholdedReLU";te(DD);class jD extends Pe{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new b2().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return M(()=>{let s=Ie(e);const a=n.mask;if(a!=null){const r=D(pe(Mn(s.shape),oe(a,s.dtype)),Se(-1e9));s=ee(s,r)}return this.axis instanceof Array?this.axis.length>1?Kn(pe(s,Eh(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}jD.className="Softmax";te(jD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ll(t,e,n){if(typeof t=="number")return Fo(t,e);if(t.length!==e)throw new P(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const a=t[s];if(!I9(a))throw new P(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${a}`)}return t}function ya(t,e,n,s,a=1){if(t==null)return t;const r=e+(e-1)*(a-1);let i;return n==="same"?i=t:i=t-r+1,Math.floor((i+s-1)/s)}function _a(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+Ni([n-e,0]);else if(s==="same")t=t*e;else throw new P(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function w2(t,e){return M(()=>(jt(e),e==="channelsFirst"?Be(t,[0,2,3,1]):t))}function _D(t,e){return M(()=>(jt(e),e==="channelsFirst"?Be(t,[0,2,3,4,1]):t))}function Hq(t,e,n,s=1,a="valid",r,i=1){return M(()=>{if(r==null&&(r=xa()),jt(r),t.shape.length!==3)throw new P(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new P(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new P(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(r==="channelsFirst"&&(t=Be(t,[0,2,1])),a==="causal")throw new Oe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=Vy(t,e,s,a==="same"?"same":"valid","NWC",i);return n!=null&&(o=$a(o,n)),o})}function PC(t,e,n,s=[1,1],a="valid",r,i,o=null){return M(()=>{if(r==null&&(r=xa()),jt(r),t.rank!==3&&t.rank!==4)throw new P(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new P(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=w2(t,r);if(a==="causal")throw new Oe("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=TA({x:l,filter:e,strides:s,pad:a==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:o}),r==="channelsFirst"&&(l=Be(l,[0,3,1,2])),l})}function Kq(t,e,n,s=[1,1,1],a="valid",r,i){return M(()=>{if(r==null&&(r=xa()),jt(r),t.rank!==4&&t.rank!==5)throw new P(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new P(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let o=_D(t,r);if(a==="causal")throw new Oe("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=D1(o,e,s,a==="same"?"same":"valid","NDHWC",i),n!=null&&(o=$a(o,n)),r==="channelsFirst"&&(o=Be(o,[0,4,1,2,3])),o})}class D0 extends Pe{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",D0.verifyArgs(n),this.rank=e,Zt(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Oe(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Ll(n.kernelSize,e,"kernelSize"),this.strides=Ll(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Os(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,jt(this.dataFormat),this.activation=Ii(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=mt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Kt(n.biasConstraint),this.biasRegularizer=gt(n.biasRegularizer),this.activityRegularizer=gt(n.activityRegularizer),this.dilationRate=Ll(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new P(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new P(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new P(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(ja("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!r2(e.kernelSize,"number",1,3))throw new P(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ci(this.activation),useBias:this.useBias,biasInitializer:vt(this.biasInitializer),biasRegularizer:st(this.biasRegularizer),activityRegularizer:st(this.activityRegularizer),biasConstraint:Ht(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class kc extends D0{constructor(e,n){super(e,n),this.kernel=null,kc.verifyArgs(n),this.filters=n.filters,Zt(this.filters,"filters"),this.kernelInitializer=mt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Kt(n.kernelConstraint),this.kernelRegularizer=gt(n.kernelRegularizer)}build(e){e=He(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new P(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],a=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return M(()=>{e=Ie(e);let s;const a=this.bias==null?null:this.bias.read(),r=AO(this.activation.getClassName());if(r!=null&&this.rank===2)s=PC(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(this.rank===1)s=Hq(e,this.kernel.read(),a,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=PC(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Kq(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Oe("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=He(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let r=0;r<s.length;++r){const i=ya(s[r],this.kernelSize[r],this.padding,this.strides[r],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[r]);n.push(i)}let a=[e[0]];return this.dataFormat==="channelsLast"?(a=a.concat(n),a.push(this.filters)):(a.push(this.filters),a=a.concat(n)),a}getConfig(){const e={filters:this.filters,kernelInitializer:vt(this.kernelInitializer),kernelRegularizer:st(this.kernelRegularizer),kernelConstraint:Ht(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new P(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Jh extends kc{constructor(e){super(2,e),Jh.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!r2(e.kernelSize,"number",1,2))throw new P(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Jh.className="Conv2D";te(Jh);class Xh extends kc{constructor(e){super(3,e),Xh.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new P(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Xh.className="Conv3D";te(Xh);class FD extends Jh{constructor(e){if(super(e),this.inputSpec=[new Ut({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new P(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=He(e),e.length!==4)throw new P("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new P("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],a=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ut({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return M(()=>{let s=Ie(e);if(s.shape.length!==4)throw new P(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const a=s.shape,r=a[0];let i,o;this.dataFormat==="channelsFirst"?(i=2,o=3):(i=1,o=2);const l=a[i],u=a[o],c=this.kernelSize[0],d=this.kernelSize[1],p=this.strides[0],h=this.strides[1],f=_a(l,p,c,this.padding),m=_a(u,h,d,this.padding),y=[r,f,m,this.filters];this.dataFormat!=="channelsLast"&&(s=Be(s,[0,2,3,1]));let g=Wy(s,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(g=Be(g,[0,3,1,2])),this.bias!=null&&(g=$a(g,this.bias.read(),this.dataFormat)),this.activation!=null&&(g=this.activation.apply(g)),g})}computeOutputShape(e){e=He(e);const n=e.slice();let s,a,r;this.dataFormat==="channelsFirst"?(s=1,a=2,r=3):(s=3,a=1,r=2);const i=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[s]=this.filters,n[a]=_a(n[a],l,i,this.padding),n[r]=_a(n[r],u,o,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}FD.className="Conv2DTranspose";te(FD);class PD extends Xh{constructor(e){if(super(e),this.inputSpec=[new Ut({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new P(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=He(e),e.length!==5)throw new P("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new P("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],a=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Ut({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return M(()=>{let s=Ie(e);if(s.shape.length!==5)throw new P(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const a=s.shape,r=a[0];let i,o,l;this.dataFormat==="channelsFirst"?(l=2,i=3,o=4):(l=1,i=2,o=3);const u=a[l],c=a[i],d=a[o],p=this.kernelSize[0],h=this.kernelSize[1],f=this.kernelSize[2],m=this.strides[0],y=this.strides[1],g=this.strides[2],b=_a(u,m,p,this.padding),w=_a(c,y,h,this.padding),k=_a(d,g,f,this.padding),x=[r,b,w,k,this.filters];this.dataFormat!=="channelsLast"&&(s=Be(s,[0,2,3,4,1]));let S=j1(s,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=Be(S,[0,4,1,2,3])),this.bias!==null&&(S=$a(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=He(e);const n=e.slice();let s,a,r,i;this.dataFormat==="channelsFirst"?(s=1,a=2,r=3,i=4):(s=4,a=1,r=2,i=3);const o=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],d=this.strides[1],p=this.strides[2];return n[s]=this.filters,n[a]=_a(n[a],c,o,this.padding),n[r]=_a(n[r],d,l,this.padding),n[i]=_a(n[i],p,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}PD.className="Conv3DTranspose";te(PD);class LD extends kc{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new P("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new P("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new P(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=mt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=gt(n.depthwiseRegularizer),this.depthwiseConstraint=Kt(n.depthwiseConstraint),this.pointwiseInitializer=mt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=gt(n.pointwiseRegularizer),this.pointwiseConstraint=Kt(n.pointwiseConstraint)}build(e){if(e=He(e),e.length<this.rank+2)throw new P(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new P(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],a=this.kernelSize.concat([s,this.depthMultiplier]),r=[];for(let o=0;o<this.rank;++o)r.push(1);r.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Ut({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return M(()=>{e=Ie(e);let s;if(this.rank===1)throw new Oe("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Be(e,[0,2,3,1])),s=a0(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=$a(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=Be(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=vt(this.depthwiseInitializer),e.pointwiseInitializer=vt(this.pointwiseInitializer),e.depthwiseRegularizer=st(this.depthwiseRegularizer),e.pointwiseRegularizer=st(this.pointwiseRegularizer),e.depthwiseConstraint=Ht(this.depthwiseConstraint),e.pointwiseConstraint=Ht(this.pointwiseConstraint),e}}LD.className="SeparableConv";class BD extends LD{constructor(e){super(2,e)}}BD.className="SeparableConv2D";te(BD);class j0 extends kc{constructor(e){super(1,e),j0.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!r2(e.kernelSize,"number",1,1))throw new P(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}j0.className="Conv1D";te(j0);class zD extends Pe{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return M(()=>{if(e=Ie(e),this.dataFormat==="channelsLast"){const s=Tf(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Tf(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Tf(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Tf(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}zD.className="Cropping2D";te(zD);class MD extends Pe{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,jt(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,S9(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return M(()=>{let s=Ie(e);const a=s.shape;if(this.dataFormat==="channelsFirst"){s=Be(s,[0,2,3,1]);const r=this.size[0]*a[2],i=this.size[1]*a[3],o=this.interpolation==="nearest"?pa.resizeNearestNeighbor(s,[r,i]):pa.resizeBilinear(s,[r,i]);return Be(o,[0,3,1,2])}else{const r=this.size[0]*a[1],i=this.size[1]*a[2];return this.interpolation==="nearest"?pa.resizeNearestNeighbor(s,[r,i]):pa.resizeBilinear(s,[r,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}MD.className="UpSampling2D";te(MD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qq(t,e,n=[1,1],s="valid",a,r){return M(()=>{a==null&&(a=xa()),jt(a);let i=w2(t,a);if(t.rank!==4)throw new P(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new P(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=fc(i,e,n,s==="same"?"same":"valid","NHWC",r),a==="channelsFirst"&&(i=Be(i,[0,3,1,2])),i})}class VD extends D0{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=mt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Kt(e.depthwiseConstraint),this.depthwiseRegularizer=gt(e.depthwiseRegularizer)}build(e){if(e=He(e),e.length<4)throw new P(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new P(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],a=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return M(()=>{e=Ie(e);let s=qq(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=$a(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=He(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],a=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=ya(n,this.kernelSize[0],this.padding,this.strides[0]),i=ya(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],a,r,i]:[e[0],r,i,a]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=vt(this.depthwiseInitializer),e.depthwiseRegularizer=st(this.depthwiseRegularizer),e.depthwiseConstraint=Ht(this.depthwiseRegularizer),e}}VD.className="DepthwiseConv2D";te(VD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function WD(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new P("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function a(r){return r==null||Array.isArray(r)?r:[r]}return e=a(e),n=a(n),{inputs:t,initialState:e,constants:n}}function UD(t,e,n,s=!1,a,r,i=!1,o=!1){return M(()=>{const l=e.shape.length;if(l<3)throw new P(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(ka(2,l));e=Be(e,u),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&(a=oe(oe(a,"bool"),"float32"),a.rank===l-1&&(a=bn(a,-1)),a=Be(a,u)),s&&(e=$s(e,0),a!=null&&(a=$s(a,0)));const c=[];let d,p=n;const h=e.shape[0],f=Es(e);let m;a!=null&&(m=Es(a));for(let g=0;g<h;++g){const b=f[g],w=M(()=>t(b,p));if(a==null)d=w[0],p=w[1];else{const k=M(()=>{const x=m[g],S=pe(ps(x),x),C=ee(D(w[0],x),D(p[0],S)),T=p.map((E,R)=>ee(D(w[1][R],x),D(E,S)));return{output:C,newStates:T}});d=k.output,p=k.newStates}o&&c.push(d)}let y;return o&&(y=qn(c,1)),[d,y,p]})}class Wi extends Pe{constructor(e){super(e);let n;if(e.cell==null)throw new P("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new v2({cells:e.cell}):n=e.cell,n.stateSize==null)throw new P("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Ut({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ka(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){gk(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let a;if(this.returnSequences?a=[e[0],e[1],s]:a=[e[0],s],this.returnState){const r=[];for(const i of n)r.push([e[0],i]);return[a].concat(r)}else return a}computeMask(e,n){return M(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const a=this.states.map(r=>null);return[s].concat(a)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Oe("Constants support is not implemented in RNN yet.");gk(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Ut({shape:[n,null,...s]});const a=[e[0]].concat(e.slice(2));this.cell.build(a);let r;if(Array.isArray(this.cell.stateSize)?r=this.cell.stateSize:r=[this.cell.stateSize],this.stateSpec!=null){if(!Le(this.stateSpec.map(i=>i.shape[i.shape.length-1]),r))throw new P(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=r.map(i=>new Ut({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){M(()=>{if(!this.stateful)throw new Da("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new P("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>Lt([s,a])):this.states_=[Lt([s,this.cell.stateSize])];else if(e==null)_e(this.states_),this.keptStates!=null&&(_e(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>Lt([s,a])):this.states_[0]=Lt([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new P(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):_e(this.states_);for(let a=0;a<this.states_.length;++a){const r=e[a],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[a]:this.cell.stateSize,o=[s,i];if(!Le(r.shape,o))throw new P(`State ${a} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${r.shape}`);this.states_[a]=r}}this.states_=this.states_.map(a=>Vt(a.clone()))})}apply(e,n){let s=n==null?null:n.initialState,a=n==null?null:n.constants;n==null&&(n={});const r=WD(e,s,a,this.numConstants);e=r.inputs,s=r.initialState,a=r.constants;let i=[],o=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new Ut({shape:u.shape}));o=o.concat(this.stateSpec)}if(a!=null&&(n.constants=a,i=i.concat(a),this.numConstants=a.length),i[0]instanceof Qa){const u=[e].concat(i),c=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=c;const p=super.apply(u,n);return this.inputSpec=d,p}else return super.apply(e,n)}call(e,n){return M(()=>{const s=n==null?null:n.mask,a=n==null?null:n.training;let r=n==null?null:n.initialState;e=Ie(e),r==null&&(this.stateful?r=this.states_:r=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==i)throw new P(`RNN Layer has ${i} state(s) but was passed ${r.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:a},u=UD((f,m)=>{const y=this.cell.call([f].concat(m),o);return[y[0],y.slice(1)]},e,r,this.goBackwards,s,null,this.unroll,this.returnSequences),c=u[0],d=u[1],p=u[2];this.stateful&&this.resetStates(p,a);const h=this.returnSequences?d:c;return this.returnState?[h].concat(p):h})}getInitialState(e){return M(()=>{let n=Lt(e.shape);return n=me(n,[1,2]),n=Uh(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?fk(n,[1,s]):n):this.cell.stateSize>1?[fk(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Wi.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const a=n.cell,r=gr(a,s);return new e(Object.assign(n,{cell:r}))}}Wi.className="RNN";te(Wi);class _0 extends Pe{}class k2 extends _0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Zt(this.units,"units"),this.activation=Ii(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=mt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=mt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=mt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gt(e.kernelRegularizer),this.recurrentRegularizer=gt(e.recurrentRegularizer),this.biasRegularizer=gt(e.biasRegularizer),this.kernelConstraint=Kt(e.kernelConstraint),this.recurrentConstraint=Kt(e.recurrentConstraint),this.biasConstraint=Kt(e.biasConstraint),this.dropout=iu([1,Ni([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=iu([1,Ni([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=He(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return M(()=>{if(e=e,e.length!==2)throw new P(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const a=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ti({ones:()=>ps(e),rate:this.dropout,training:a,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ti({ones:()=>ps(s),rate:this.recurrentDropout,training:a,dropoutFunc:this.dropoutFunc}));let r;const i=this.dropoutMask,o=this.recurrentDropoutMask;i!=null?r=Ka(D(e,i),this.kernel.read()):r=Ka(e,this.kernel.read()),this.bias!=null&&(r=$a(r,this.bias.read())),o!=null&&(s=D(s,o));let l=ee(r,Ka(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Ci(this.activation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),recurrentInitializer:vt(this.recurrentInitializer),biasInitializer:vt(this.biasInitializer),kernelRegularizer:st(this.kernelRegularizer),recurrentRegularizer:st(this.recurrentRegularizer),biasRegularizer:st(this.biasRegularizer),activityRegularizer:st(this.activityRegularizer),kernelConstraint:Ht(this.kernelConstraint),recurrentConstraint:Ht(this.recurrentConstraint),biasConstraint:Ht(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}k2.className="SimpleRNNCell";te(k2);class GD extends Wi{constructor(e){e.cell=new k2(e),super(e)}call(e,n){return M(()=>{this.cell.dropoutMask!=null&&(_e(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(_e(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,a=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:a,initialState:r})})}static fromConfig(e,n){return new e(n)}}GD.className="SimpleRNN";te(GD);class x2 extends _0{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new P("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Zt(this.units,"units"),this.activation=Ii(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ii(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=mt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=mt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=mt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=gt(e.kernelRegularizer),this.recurrentRegularizer=gt(e.recurrentRegularizer),this.biasRegularizer=gt(e.biasRegularizer),this.kernelConstraint=Kt(e.kernelConstraint),this.recurrentConstraint=Kt(e.recurrentConstraint),this.biasConstraint=Kt(e.biasConstraint),this.dropout=iu([1,Ni([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=iu([1,Ni([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=He(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return M(()=>{if(e=e,e.length!==2)throw new P(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let a=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ti({ones:()=>ps(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ti({ones:()=>ps(a),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const r=this.dropoutMask,i=this.recurrentDropoutMask;let o,l,u;0<this.dropout&&this.dropout<1&&(e=D(e,r[0]));let c=Ka(e,this.kernel.read());this.useBias&&(c=$a(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(a=D(a,i[0]));const d=this.recurrentKernel.read(),[p,h]=Wn(d,[2*this.units,this.units],d.rank-1),f=Ka(a,p),[m,y,g]=Wn(c,3,c.rank-1),[b,w]=Wn(f,2,f.rank-1);o=this.recurrentActivation.apply(ee(m,b)),l=this.recurrentActivation.apply(ee(y,w));const k=Ka(D(l,a),h);u=this.activation.apply(ee(g,k));const x=ee(D(o,a),D(ee(1,ot(o)),u));return[x,x]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Ci(this.activation),recurrentActivation:Ci(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),recurrentInitializer:vt(this.recurrentInitializer),biasInitializer:vt(this.biasInitializer),kernelRegularizer:st(this.kernelRegularizer),recurrentRegularizer:st(this.recurrentRegularizer),biasRegularizer:st(this.biasRegularizer),activityRegularizer:st(this.activityRegularizer),kernelConstraint:Ht(this.kernelConstraint),recurrentConstraint:Ht(this.recurrentConstraint),biasConstraint:Ht(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}x2.className="GRUCell";te(x2);class HD extends Wi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new x2(e),super(e)}call(e,n){return M(()=>{this.cell.dropoutMask!=null&&(_e(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(_e(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,a=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:a,initialState:r})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}HD.className="GRU";te(HD);class F0 extends _0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Zt(this.units,"units"),this.activation=Ii(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ii(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=mt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=mt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=mt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=gt(e.kernelRegularizer),this.recurrentRegularizer=gt(e.recurrentRegularizer),this.biasRegularizer=gt(e.biasRegularizer),this.kernelConstraint=Kt(e.kernelConstraint),this.recurrentConstraint=Kt(e.recurrentConstraint),this.biasConstraint=Kt(e.biasConstraint),this.dropout=iu([1,Ni([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=iu([1,Ni([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=He(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let a;if(this.useBias){if(this.unitForgetBias){const r=this.biasInitializer,i=this.units;a=new(n=class extends Qs{apply(l,u){const c=r.apply([i]),d=new o2().apply([i]),p=r.apply([i*2]);return kC(kC(c,d),p)}},n.className="CustomInit",n)}else a=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,a,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return M(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new P(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let a=e[1];const r=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ti({ones:()=>ps(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ti({ones:()=>ps(a),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let l,u,c,d;0<this.dropout&&this.dropout<1&&(e=D(e,i[0]));let p=Ka(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(a=D(a,o[0])),p=ee(p,Ka(a,this.recurrentKernel.read())),this.useBias&&(p=$a(p,this.bias.read()));const[h,f,m,y]=Wn(p,4,p.rank-1);l=this.recurrentActivation.apply(h),u=this.recurrentActivation.apply(f),c=ee(D(u,r),D(l,this.activation.apply(m))),d=this.recurrentActivation.apply(y);const g=D(d,this.activation.apply(c));return[g,g,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Ci(this.activation),recurrentActivation:Ci(this.recurrentActivation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),recurrentInitializer:vt(this.recurrentInitializer),biasInitializer:vt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:st(this.kernelRegularizer),recurrentRegularizer:st(this.recurrentRegularizer),biasRegularizer:st(this.biasRegularizer),activityRegularizer:st(this.activityRegularizer),kernelConstraint:Ht(this.kernelConstraint),recurrentConstraint:Ht(this.recurrentConstraint),biasConstraint:Ht(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}F0.className="LSTMCell";te(F0);class KD extends Wi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new F0(e),super(e)}call(e,n){return M(()=>{this.cell.dropoutMask!=null&&(_e(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(_e(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,a=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:a,initialState:r})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}KD.className="LSTM";te(KD);class v2 extends _0{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return M(()=>{e=e;let s=e.slice(1);const a=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?a.push(s.splice(0,o.stateSize.length)):a.push(s.splice(0,1));a.reverse();const r=[];let i;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];s=a[o],o===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,n),r.push(i.slice(1))}s=[];for(const o of r.slice().reverse())s.push(...o);return[i[0]].concat(s)})}build(e){gk(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,a)=>{bo(`RNNCell_${a}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=r=>({className:r.getClassName(),config:r.getConfig()}),a={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),a)}static fromConfig(e,n,s={}){const a=[];for(const r of n.cells)a.push(gr(r,s));return new e({cells:a})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return yk(e)}setWeights(e){const n=[];for(const s of this.cells){const a=s.weights.length,r=e.splice(a);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],r[i]])}f2(n)}}v2.className="StackedRNNCells";te(v2);function Ti(t){const{ones:e,rate:n,training:s=!1,count:a=1,dropoutFunc:r}=t,i=()=>r!=null?r(e(),n):LO(e(),n),o=()=>Hh(i,e,s);return!a||a<=1?Vt(o().clone()):Array(a).fill(void 0).map(o).map(u=>Vt(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Jq=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n};class qD extends Wi{constructor(e){if(e.unroll)throw new Oe("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Oe("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Ut({ndim:5})]}call(e,n){return M(()=>{if(this.cell.dropoutMask!=null&&(_e(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(_e(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new P("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,a=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:a,initialState:r})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return M(()=>{const{stateSize:n}=this.cell,s=e.shape,a=this.computeSingleOutputShape(s),r=[a[0],...a.slice(2)],i=Lt(r);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){M(()=>{if(!this.stateful)throw new Da("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,a=this.computeSingleOutputShape(s),r=[a[0],...a.slice(2)];if(s[0]==null)throw new P("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Lt(r)):this.states_=[Lt(r)];else if(e==null)_e(this.states_),this.keptStates!=null&&(_e(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Lt(r)):this.states_[0]=Lt(r);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new P(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):_e(this.states_);for(let o=0;o<this.states_.length;++o){const l=e[o],u=r;if(!Le(l.shape,u))throw new P(`State ${o} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>Vt(o.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:a,padding:r,strides:i,dilationRate:o}=this.cell,l=n==="channelsFirst",u=e[l?3:2],c=e[l?4:3],d=ya(u,a[0],r,i[0],o[0]),p=ya(c,a[1],r,i[1],o[1]);return[...e.slice(0,2),...l?[s,d,p]:[d,p,s]]}}qD.className="ConvRNN2D";class S2 extends F0{constructor(e){const{filters:n,kernelSize:s,strides:a,padding:r,dataFormat:i,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Zt(this.filters,"filters"),this.kernelSize=Ll(s,2,"kernelSize"),this.kernelSize.forEach(l=>Zt(l,"kernelSize")),this.strides=Ll(a||1,2,"strides"),this.strides.forEach(l=>Zt(l,"strides")),this.padding=r||"valid",Os(this.padding),this.dataFormat=i||"channelsLast",jt(this.dataFormat),this.dilationRate=Ll(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>Zt(l,"dilationRate"))}build(e){var n;e=He(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new P(`The channel dimension of the input should be defined. Found ${e[s]}`);const a=e[s],r=4,i=this.kernelSize.concat([a,this.filters*r]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*r]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends Qs{apply(p,h){const f=u.apply([c]),m=Mn([c]),y=u.apply([c*2]);return i2([f,m,y])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*r],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return M(()=>{if(e.length!==3)throw new P(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,a=e[0],r=e[1],i=e[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ti({ones:()=>ps(a),rate:this.dropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(q,Y,Z)=>!Y||!Y[Z]?q:D(Y[Z],q);let c=u(a,l,0),d=u(a,l,1),p=u(a,l,2),h=u(a,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ti({ones:()=>ps(r),rate:this.recurrentDropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const f=this.recurrentDropoutMask;let m=u(r,f,0),y=u(r,f,1),g=u(r,f,2),b=u(r,f,3);const w=3,[k,x,S,C]=Wn(this.kernel.read(),o,w),[T,E,R,L]=this.useBias?Wn(this.bias.read(),o):[null,null,null,null];c=this.inputConv(c,k,T,this.padding),d=this.inputConv(d,x,E,this.padding),p=this.inputConv(p,S,R,this.padding),h=this.inputConv(h,C,L,this.padding);const[U,G,F,z]=Wn(this.recurrentKernel.read(),o,w);m=this.recurrentConv(m,U),y=this.recurrentConv(y,G),g=this.recurrentConv(g,F),b=this.recurrentConv(b,z);const H=this.recurrentActivation.apply(ee(c,m)),X=this.recurrentActivation.apply(ee(d,y)),j=ee(D(X,i),D(H,this.activation.apply(ee(p,g)))),V=D(this.recurrentActivation.apply(ee(h,b)),this.activation.apply(j));return[V,V,j]})}getConfig(){const e=super.getConfig(),n=Jq(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,a){const r=Sr(e,n,this.strides,a||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?$a(r,s,this.dataFormat):r}recurrentConv(e,n){return Sr(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}S2.className="ConvLSTM2DCell";te(S2);class JD extends qD{constructor(e){const n=new S2(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}JD.className="ConvLSTM2D";te(JD);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class N2 extends Pe{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let a=0;a<this.noiseShape.length;++a)s.push(this.noiseShape[a]==null?n[a]:this.noiseShape[a]);return s}call(e,n){return M(()=>{this.invokeCallHook(e,n);const s=Ie(e);if(0<this.rate&&this.rate<1){const a=n.training==null?!1:n.training,r=this.getNoiseShape(s);return Hh(()=>LO(s,this.rate,r,this.seed),()=>s,a)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}N2.className="Dropout";te(N2);class XD extends N2{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}XD.className="SpatialDropout1D";te(XD);class YD extends Pe{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Zt(this.units,"units"),this.activation=Ii(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=mt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=mt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Kt(e.kernelConstraint),this.biasConstraint=Kt(e.biasConstraint),this.kernelRegularizer=gt(e.kernelRegularizer),this.biasRegularizer=gt(e.biasRegularizer),this.activityRegularizer=gt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=He(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=He(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return M(()=>{this.invokeCallHook(e,n);const s=Ie(e),a=AO(this.activation.getClassName());let r;return a!=null?r=Ka(s,this.kernel.read(),a,this.bias?this.bias.read():null):(r=Ka(s,this.kernel.read()),this.bias!=null&&(r=$a(r,this.bias.read())),this.activation!=null&&(r=this.activation.apply(r))),r})}getConfig(){const e={units:this.units,activation:Ci(this.activation),useBias:this.useBias,kernelInitializer:vt(this.kernelInitializer),biasInitializer:vt(this.biasInitializer),kernelRegularizer:st(this.kernelRegularizer),biasRegularizer:st(this.biasRegularizer),activityRegularizer:st(this.activityRegularizer),kernelConstraint:Ht(this.kernelConstraint),biasConstraint:Ht(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}YD.className="Dense";te(YD);class QD extends Pe{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=He(e);for(const n of e.slice(1))if(n==null)throw new P(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],pi(e,1)]}call(e,n){return M(()=>{this.invokeCallHook(e,n);let s=Ie(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const a=[0];for(let r=2;r<s.rank;++r)a.push(r);a.push(1),s=Be(s,a)}return E9(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}QD.className="Flatten";te(QD);class ZD extends Pe{constructor(e){super(e),this.supportsMasking=!0,this.activation=Ii(e.activation)}call(e,n){return M(()=>{this.invokeCallHook(e,n);const s=Ie(e);return this.activation.apply(s)})}getConfig(){const e={activation:Ci(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}ZD.className="Activation";te(ZD);class ej extends Pe{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return M(()=>(e=Ie(e),T9(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}ej.className="RepeatVector";te(ej);class tj extends Pe{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",a=n.slice();let r=1,i=null;for(let l=0;l<a.length;++l){const u=a[l];if(this.isUnknown(u))if(i===null)i=l;else throw new P("Can only specifiy one unknown dimension.");else r*=u}const o=pi(e);if(i!==null){if(r===0||o%r!==0)throw new P(s);a[i]=o/r}else if(o!==r)throw new P(s);return a}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return M(()=>{this.invokeCallHook(e,n);const s=Ie(e),a=s.shape,r=a.slice(0,1).concat(this.fixUnknownDimension(a.slice(1),this.targetShape));return _(s,r)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}tj.className="Reshape";te(tj);class nj extends Pe{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=ka(1,e.dims.length+1);if(!Le(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Ut({ndim:this.dims.length+1})]}computeOutputShape(e){e=He(e);const n=e.slice();return this.dims.forEach((s,a)=>{n[a+1]=e[s]}),n}call(e,n){return Be(Ie(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}nj.className="Permute";te(nj);class sj extends Pe{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=Ie(e);return Hd(Do(s,this.maskValue),-1)}call(e,n){return M(()=>{this.invokeCallHook(e,n);const s=Ie(e),i=Hd(Do(s,this.maskValue),-1,!0);return D(s,oe(i,s.dtype))})}}sj.className="Masking";te(sj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aj extends Pe{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Xe(e.inputLength))}this.inputDim=e.inputDim,Zt(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Zt(this.outputDim,"outputDim"),this.embeddingsInitializer=mt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=gt(e.embeddingsRegularizer),this.activityRegularizer=gt(e.activityRegularizer),this.embeddingsConstraint=Kt(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return M(()=>this.maskZero?(e=Ie(e),Do(e,Me(e))):null)}computeOutputShape(e){if(e=He(e),this.inputLength==null)return[...e,this.outputDim];const n=Xe(this.inputLength);if(n.length!==e.length-1)throw new P(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let a=0;a<n.length;++a){const r=n[a],i=e[a+1];if(r!=null&&i!=null&&r!==i)throw new P(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);r==null&&(n[s]=i),s++}}return[e[0],...n,this.outputDim]}call(e,n){return M(()=>{this.invokeCallHook(e,n);let s=Ie(e);s.dtype!=="int32"&&(s=Ha(s,"int32"));const a=PO(this.embeddings.read(),_(s,[s.size]));return _(a,He(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:vt(this.embeddingsInitializer),embeddingsRegularizer:st(this.embeddingsRegularizer),activityRegularizer:st(this.activityRegularizer),embeddingsConstraint:Ht(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}aj.className="Embedding";te(aj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sl extends Pe{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Oe}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let a=0;a<n.length;++a){const r=e[e.length-n.length+a],i=n[a];if(r==null||i==null||r<0||i<0)s.push(null);else if(r===1)s.push(i);else if(i===1)s.push(r);else{if(r!==i)throw new P("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(r)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[He(e)]),e=e,e.length<2)throw new P(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const r of e)r!=null&&r[0]!==null&&n.push(r[0]);if(n=di(n),n.length>1)throw new P(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const a=e.map(r=>r.length);e.indexOf(null)===-1&&di(a).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return M(()=>{if(e=e,this.reshapeRequired){const s=[],a=e.map(r=>r.rank);if(a.indexOf(null)===-1){const r=Ni(a);for(let i of e){const o=i.rank;for(let l=0;l<r-o;++l)i=Uh(i,1);s.push(i)}return this.mergeFunction(s)}else{let r=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,d=c[0],p=c.slice(1).concat([d]);let h=_(l,[d].concat(pi(c.slice(1))));h=Be(h,[1,0]),h=_(h,p),s.push(h),r=!0}else if(u>1){const c=ka(1,u).concat([0]);s.push(Be(l,c)),r=!0}else s.push(l)}let i=this.mergeFunction(s);const o=i.rank;if(r){if(o==null){const l=i.shape,u=l.length,c=l[u-1],d=[c].concat(l.slice(0,l.length-1));i=_(Be(_(i,[-1,c]),[1,0]),d)}else if(o>1){const l=[o-1].concat(ka(0,o-1));i=Be(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let a=1;a<e.length;++a){const r=e[a]==null?null:e[a].slice(1);n=this.computeElementwiseOpOutputShape(n,r)}let s=[];for(const a of e)a!=null&&a[0]!==null&&s.push(a[0]);return s=di(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return M(()=>{if(n==null)return null;if(!Array.isArray(n))throw new P("`mask` should be an Array");if(!Array.isArray(e))throw new P("`inputs` should be an Array");if(n.length!==e.length)throw new P(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(a=>a==null))return null;n=n.map(a=>a==null?a:bn(a,0));let s=n[0];for(let a=1;a<n.length-1;++a)s=wa(s,n[a]);return s})}}class rj extends sl{constructor(e){super(e)}mergeFunction(e){return M(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ee(n,e[s]);return n})}}rj.className="Add";te(rj);class ij extends sl{constructor(e){super(e)}mergeFunction(e){return M(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=D(n,e[s]);return n})}}ij.className="Multiply";te(ij);class oj extends sl{constructor(e){super(e)}mergeFunction(e){return M(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ee(n,e[s]);return D(1/e.length,n)})}}oj.className="Average";te(oj);class lj extends sl{constructor(e){super(e)}mergeFunction(e){return M(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=er(n,e[s]);return n})}}lj.className="Maximum";te(lj);class uj extends sl{constructor(e){super(e)}mergeFunction(e){return M(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Si(n,e[s]);return n})}}uj.className="Minimum";te(uj);class cj extends sl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new P("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const a of e)if(a!=null){n=!1;break}if(n)return;const s=[];for(let a=0;a<e.length;++a){const r=e[a].slice();r.splice(this.axis,1);let i=!1;for(const o of s)if(Le(o,r)){i=!0;break}i||s.push(r)}if(s.length>1)throw new P("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return M(()=>i2(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new P("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),a=this.axis<0?s.length+this.axis:this.axis;for(const r of n.slice(1)){if(s[a]==null||r[a]==null){s[a]=null;break}s[a]+=r[a]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new P("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new P("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new P(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return M(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const a=[];for(let i=0;i<e.length;++i)n[i]==null?a.push(oe(ps(e[i]),"bool")):n[i].rank<e[i].rank?a.push(bn(n[i],-1)):a.push(n[i]);const r=At(a,this.axis);return My(r,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}cj.className="Concatenate";te(cj);function Gc(t,e){for(;t<0;)t+=e;return t}function Xq(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Oe("batchDot is not implemented for tensors of 4D or higher rank yet");if(I(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),I(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Oe("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,a=e.shape.length;n==null&&(n=[s-1,a-2]);const r=n;return M(()=>{let i;if(s>a){i=s-a;const l=[];for(let u=0;u<i;++u)l.push(1);e=_(e,e.shape.concat(l))}else if(a>s){i=a-s;const l=[];for(let u=0;u<i;++u)l.push(1);t=_(t,t.shape.concat(l))}else i=0;let o;if(t.shape.length===2&&e.shape.length===2)r[0]===r[1]?o=me(D(t,e),r[0]):o=me(D(Be(t,[1,0]),e),r[1]);else{const l=r[0]!==t.shape.length-1,u=r[1]===e.shape.length-1;o=je(t,e,l,u)}if(i>0){let l;s>a?l=s+a-3:l=s-1;const u=[];for(let c=l;c<l+i;++c)u.push(c);o=Mi(o,u)}return o.shape.length===1&&(o=bn(o,1)),o})}class dj extends sl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){I(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Oe("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(n,s);if(n[a[0]]!==s[a[1]])throw new P(`Dimension incompatibility: ${n[a[0]]} !== ${s[a[1]]}`)}mergeFunction(e){if(e.length!==2)throw new P(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],a;return Array.isArray(this.axes)?a=this.axes.map((r,i)=>Gc(r,e[i].shape.length)):a=[Gc(this.axes,n.shape.length),Gc(this.axes,s.shape.length)],this.normalize&&(n=Km(n,a[0]),s=Km(s,a[1])),Xq(n,s,a)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Gc(this.axes,e.length),Gc(this.axes,n.length)],s}computeOutputShape(e){I(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Oe("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(n,s);n.splice(a[0],1),s.splice(a[1],1),s.splice(0,1);const r=n.concat(s);return r.length===1&&r.push(1),r}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}dj.className="Dot";te(dj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class pj extends Pe{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return M(()=>{this.invokeCallHook(e,n);const s=Ie(e);return Hh(()=>ee(E0(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}pj.className="GaussianNoise";te(pj);class hj extends Pe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return M(()=>{this.invokeCallHook(e,n);const s=Ie(e);return this.rate>0&&this.rate<1?Hh(()=>{const r=Math.sqrt(this.rate/(1-this.rate));return D(s,E0(s.shape,1,r))},()=>s,n.training||!1):s})}}hj.className="GaussianDropout";te(hj);class fj extends Pe{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Ie(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return M(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return Hh(()=>{const r=Ie(e),l=-1.6732632423543772*1.0507009873554805;let u=Or(zi(s),this.rate);u=Ha(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-c*l*this.rate,p=ee(D(r,u),D(ee(u,-1),l));return ee(D(p,c),d)},()=>Ie(e),n.training||!1)}return e})}}fj.className="AlphaDropout";te(fj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zd(t,e,n,s,a,r=.001){let i;if(t.rank===2)i=S1(t,e,n,s,a,r);else if(t.rank===3)i=N1(t,e,n,s,a,r);else if(t.rank===4)i=C1(t,e,n,s,a,r);else throw new Oe(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function Yq(t,e,n,s,a=.001){return M(()=>{const r=Oh(t,s),i=r.mean,o=r.variance;return[Zd(t,i,o,n,e,a),i,o]})}function Qq(t,e,n,s,a=.001){return M(()=>{const r=Oh(t,s),i=r.mean,o=r.variance,l=[];for(const f of ka(0,t.rank))s.indexOf(f)!==-1?l.push(1):l.push(t.shape[f]);const u=_(i,l),c=_(o,l),d=e==null?null:_(e,l),p=n==null?null:_(n,l);return[Zd(t,u,c,p,d,a),i,o]})}function Zq(t,e,n,s,a=.001){return Le(s.slice().sort(),ka(0,t.rank-1))?Yq(t,e,n,s,a):Qq(t,e,n,s,a)}class mj extends Pe{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=mt(e.betaInitializer||"zeros"),this.gammaInitializer=mt(e.gammaInitializer||"ones"),this.movingMeanInitializer=mt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=mt(e.movingVarianceInitializer||"ones"),this.betaConstraint=Kt(e.betaConstraint),this.gammaConstraint=Kt(e.gammaConstraint),this.betaRegularizer=gt(e.betaRegularizer),this.gammaRegularizer=gt(e.gammaRegularizer)}build(e){e=He(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new P(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Ut({ndim:e.length,axes:{[n]:s}})];const a=[s];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return M(()=>{const s=n.training==null?!1:n.training,a=Ie(e),r=a.shape,i=r.length,o=ka(0,i),l=this.axis>=0?this.axis:this.axis+i;o.splice(l,1);const u=Fo(1,i);u[l]=r[l];const c=o.slice();c.sort();const d=!Le(c,ka(0,i).slice(0,i-1)),p=()=>{if(d){const b=_(this.movingMean.read(),u),w=_(this.movingVariance.read(),u),k=this.center?_(this.beta.read(),u):null,x=this.scale?_(this.gamma.read(),u):null;return Zd(a,b,w,k,x,this.epsilon)}else return Zd(a,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return p();const[h,f,m]=Zq(a,this.gamma.read(),this.beta.read(),o,this.epsilon),y=(b,w,k)=>{M(()=>{const x=1-k,S=b.read(),C=D(pe(S,w),x);b.write(pe(S,C))})};return(()=>{y(this.movingMean,f,this.momentum),y(this.movingVariance,m,this.momentum)})(),h})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vt(this.betaInitializer),gammaInitializer:vt(this.gammaInitializer),movingMeanInitializer:vt(this.movingMeanInitializer),movingVarianceInitializer:vt(this.movingVarianceInitializer),betaRegularizer:st(this.betaRegularizer),gammaRegularizer:st(this.gammaRegularizer),betaConstraint:Ht(this.betaConstraint),gammaConstraint:Ht(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}mj.className="BatchNormalization";te(mj);class gj extends Pe{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=mt(e.betaInitializer||"zeros"),this.gammaInitializer=mt(e.gammaInitializer||"ones"),this.betaRegularizer=gt(e.betaRegularizer),this.gammaRegularizer=gt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=He(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=n);for(const r of this.axis)if(r<0||r>=n)throw new Error(`Invalid axis: ${r}`);if(this.axis.length!==di(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(r=>e[r]),a=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,a):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,a):this.beta=null,this.built=!0}call(e,n){const s=Ie(e),a=s.shape,r=a.length;return M(()=>{let{mean:o,variance:l}=Oh(s,this.axis,!0);const u=Fo(1,r);for(const m of this.axis)u[m]=a[m];const c=m=>m!=null&&m.shape.length!==r?_(m,u):m;let d=this.scale?c(this.gamma.read()):null,p=this.center?c(this.beta.read()):null;const h=[],f=[];for(let m=0;m<r;++m)this.axis.indexOf(m)!==-1?(h.push(a[m]),f.push(1)):(h.push(1),f.push(a[m]));return o=vs(o,h),l=vs(l,h),d!=null&&(d=vs(d,f)),p!=null&&(p=vs(p,f)),Zd(s,o,l,p,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:vt(this.betaInitializer),gammaInitializer:vt(this.gammaInitializer),betaRegularizer:st(this.betaRegularizer),gammaRegularizer:st(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}gj.className="LayerNormalization";te(gj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function eJ(t,e,n){return M(()=>{if(t.rank!==4)throw new P(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new P("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=xa()),n!=="channelsLast"&&n!=="channelsFirst")throw new P(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],Dr(t,s)})}class yj extends Pe{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?xa():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new P(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new P(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new P(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new Ut({ndim:4})]}computeOutputShape(e){e=He(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return M(()=>eJ(Ie(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}yj.className="ZeroPadding2D";te(yj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function P0(t,e,n,s,a,r){return M(()=>{jt(a),DO(r),Os(s),n==null&&(n=[1,1]),s==null&&(s="valid"),a==null&&(a=xa()),r==null&&(r="max"),t=w2(t,a);let i;const o=s==="same"?"same":"valid";return r==="max"?i=Ah(t,e,n,o):i=Sh(t,e,n,o),a==="channelsFirst"&&(i=Be(i,[0,3,1,2])),i})}function bj(t,e,n,s,a,r){return M(()=>{jt(a),DO(r),Os(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),a==null&&(a=xa()),r==null&&(r="max"),t=_D(t,a);let i;const o=s==="same"?"same":"valid";return r==="max"?i=q1(t,e,n,o):i=v1(t,e,n,o),a==="channelsFirst"&&(i=Be(i,[0,4,1,2,3])),i})}class wj extends Pe{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new P(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Zt(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new P(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Zt(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Os(this.padding),this.inputSpec=[new Ut({ndim:3})]}computeOutputShape(e){e=He(e);const n=ya(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return M(()=>{this.invokeCallHook(e,n),e=Uh(Ie(e),2);const s=this.poolingFunction(Ie(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Mi(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class kj extends wj{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return jt(r),Os(a),P0(e,n,s,a,r,"max")}}kj.className="MaxPooling1D";te(kj);class xj extends wj{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return jt(r),Os(a),P0(e,n,s,a,r,"avg")}}xj.className="AveragePooling1D";te(xj);class vj extends Pe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new P(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Zt(this.poolSize,"poolSize"),Zt(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,jt(this.dataFormat),Os(this.padding),this.inputSpec=[new Ut({ndim:4})]}computeOutputShape(e){e=He(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=ya(n,this.poolSize[0],this.padding,this.strides[0]),s=ya(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return M(()=>(this.invokeCallHook(e,n),this.poolingFunction(Ie(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class Sj extends vj{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return jt(r),Os(a),P0(e,n,s,a,r,"max")}}Sj.className="MaxPooling2D";te(Sj);class Nj extends vj{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return jt(r),Os(a),P0(e,n,s,a,r,"avg")}}Nj.className="AveragePooling2D";te(Nj);class Cj extends Pe{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new P(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Zt(this.poolSize,"poolSize"),Zt(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,jt(this.dataFormat),Os(this.padding),this.inputSpec=[new Ut({ndim:5})]}computeOutputShape(e){e=He(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],a=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=ya(n,this.poolSize[0],this.padding,this.strides[0]),s=ya(s,this.poolSize[1],this.padding,this.strides[1]),a=ya(a,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,a]:[e[0],n,s,a,e[4]]}call(e,n){return M(()=>(this.invokeCallHook(e,n),this.poolingFunction(Ie(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class Ij extends Cj{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return jt(r),Os(a),bj(e,n,s,a,r,"max")}}Ij.className="MaxPooling3D";te(Ij);class Tj extends Cj{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return jt(r),Os(a),bj(e,n,s,a,r,"avg")}}Tj.className="AveragePooling3D";te(Tj);class $j extends Pe{constructor(e){super(e),this.inputSpec=[new Ut({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Oe}}class Ej extends $j{constructor(e){super(e||{})}call(e,n){return M(()=>{const s=Ie(e);return xt(s,1)})}}Ej.className="GlobalAveragePooling1D";te(Ej);class Rj extends $j{constructor(e){super(e||{})}call(e,n){return M(()=>{const s=Ie(e);return Is(s,1)})}}Rj.className="GlobalMaxPooling1D";te(Rj);class Aj extends Pe{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,jt(this.dataFormat),this.inputSpec=[new Ut({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Oe}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class Oj extends Aj{call(e,n){return M(()=>{const s=Ie(e);return this.dataFormat==="channelsLast"?xt(s,[1,2]):xt(s,[2,3])})}}Oj.className="GlobalAveragePooling2D";te(Oj);class Dj extends Aj{call(e,n){return M(()=>{const s=Ie(e);return this.dataFormat==="channelsLast"?Is(s,[1,2]):Is(s,[2,3])})}}Dj.className="GlobalMaxPooling2D";te(Dj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jj extends Pe{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const a=n.layer,r=gr(a,s);delete n.layer;const i={layer:r};return Object.assign(i,n),new e(i)}}class _j extends jj{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=He(e),e.length<3)throw new P(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=He(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),a=e[1];return[s[0],a].concat(s.slice(1))}call(e,n){return M(()=>(e=Ie(e),UD((i,o)=>[Ie(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}_j.className="TimeDistributed";te(_j);function tJ(t){nl(v9,"BidirectionalMergeMode",t)}const nJ="concat";class Fj extends jj{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=gr(s),n.goBackwards=n.goBackwards!==!0;const a={};if(a.className=e.layer.getClassName(),a.config=n,this.backwardLayer=gr(a),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?nJ:e.mergeMode,tJ(this.mergeMode),e.weights)throw new Oe("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,a,r;return this.returnState&&(r=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,a=[s]):this.mergeMode==null?a=[s,s.slice()]:a=[s],this.returnState?this.mergeMode==null?a.concat(r).concat(r.slice()):[s].concat(r).concat(r.slice()):Bn(a)}apply(e,n){let s=n==null?null:n.initialState,a=n==null?null:n.constants;n==null&&(n={});const r=WD(e,s,a,this.numConstants);if(e=r.inputs,s=r.initialState,a=r.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&a==null)return super.apply(e,n);const i=[],o=[];if(s!=null){const u=s.length;if(u%2>0)throw new P("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const c=s.map(d=>new Ut({shape:d.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),o.push(...c)}if(a!=null)throw new Oe("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof Qa;for(const u of i)if(u instanceof Qa!==l)throw new P("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(i),c=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=c;const p=super.apply(u,n);return this.inputSpec=d,p}else return super.apply(e,n)}call(e,n){return M(()=>{const s=n.initialState;let a,r;if(s==null)a=this.forwardLayer.call(e,n),r=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),u=s.slice(s.length/2);a=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),r=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let i;this.returnState&&(Array.isArray(a)&&(i=a.slice(1).concat(r.slice(1))),a=a[0],r=r[0]),this.returnSequences&&(r=$s(r,1));let o;return this.mergeMode==="concat"?o=i2([a,r]):this.mergeMode==="sum"?o=ee(a,r):this.mergeMode==="ave"?o=D(.5,ee(a,r)):this.mergeMode==="mul"?o=D(a,r):this.mergeMode==null&&(o=[a,r]),this.returnState?this.mergeMode==null?o.concat(i):[o].concat(i):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){bo(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),bo(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const r=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(r).concat(r):[s].concat(r).concat(r)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=gr(n.layer);if(delete n.layer,n.numConstants!=null)throw new Oe("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const a=n;return a.layer=s,new e(a)}}Fj.className="Bidirectional";te(Fj);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Pj extends Pe{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return M(()=>(e=Ie(e),e.dtype!=="float32"&&(e=Ha(e,"float32")),ee(D(e,this.scale),this.offset)))}}Pj.className="Rescaling";te(Pj);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:sJ,cropAndResize:aJ}=pa;class Lj extends Pe{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,a,r,i,o,l){return M(()=>{let u,c=!1;const d=n/i,p=s/o,h=(a+n)/i,f=(r+s)/o,m=[d,p,h,f],y=[];e.rank===3?(c=!0,u=qn([e])):u=e;for(let x=0;x<u.shape[0];x++)y.push(m);const g=Ks(y,[y.length,4]),b=jo(0,y.length,1,"int32"),k=aJ(u,g,b,[a,r],"nearest");return Ha(c?Ie(Es(k)):k,l)})}upsize(e,n,s,a){return M(()=>{const r=sJ(e,[n,s]);return Ha(r,a)})}call(e,n){return M(()=>{const s=Ie(e),a=s.dtype,r=s.shape,i=r[r.length-3],o=r[r.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let u=0;return o!==this.width&&(u=Math.floor((o-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(s,l,u,this.height,this.width,i,o,a):this.upsize(e,this.height,this.width,a)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=He(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}Lj.className="CenterCrop";te(Lj);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rJ(t,e,n,s){let a=Ie(t);if(a.dtype!=="int32"&&(a=Ha(a,"int32")),e==="int")return a;const r=a.shape;if(a.rank===0&&(a=bn(a,-1)),e==="oneHot"&&a.shape[a.shape.length-1]!==1&&(a=bn(a,-1)),a.rank>2)throw new P(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${r} which would result in output rank ${a.rank}.`);const i=["multiHot","oneHot"].includes(e),o=a;let l;if(typeof s<"u"&&e==="count"?l=Mm(o,s,n,i):l=Mm(o,[],n,i),e!=="tfIdf")return l;if(s)return D(l,s);throw new P("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Bj extends Pe{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=He(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return M(()=>{e=Ie(e),e.dtype!=="int32"&&(e=Ha(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new P(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=Ie(n.countWeights)}const a=Is(e),r=eu(e),i=Qn(this.numTokens,a).bufferSync().get(0),o=Or(r,0).bufferSync().get(0);if(!(i&&o))throw new P(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return rJ(e,this.outputMode,this.numTokens,s)})}}Bj.className="CategoryEncoding";te(Bj);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const iJ=["bilinear","nearest"],LC=new Set(iJ);class zj extends Pe{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(LC.has(e.interpolation))this.interpolation=e.interpolation;else throw new P(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=He(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return M(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return pa.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return pa.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...LC]} are supported`)})}}zj.className="Resizing";te(zj);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Mj{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}Mj.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Vj extends Pe{constructor(e){super(e),this.randomGenerator=new Mj(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}Vj.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const oJ=["bilinear","nearest"],BC=new Set(oJ);class Wj extends Vj{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new P(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new P(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new P(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(BC.has(s))this.interpolation=s;else throw new P(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=He(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return M(()=>{const s=Ie(e);this.imgHeight=s.shape[s.shape.length-3];const a=s.shape[s.shape.length-2];this.widthFactor=zi([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*a;r=Math.round(r);const i=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return pa.resizeBilinear(e,i);case"nearest":return pa.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...BC]} are supported`)}})}}Wj.className="RandomWidth";te(Wj);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lJ=W();lJ.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var es;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(es||(es={}));var zC;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(zC||(zC={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C2={};function uJ(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};C2[t]=n}function Uj(t){return C2[t]}function cJ(t){delete C2[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v(t,e,n,s,a){const r=e.inputParams[t];if(r&&r.inputIndexStart!==void 0){const o=r.inputIndexStart,l=r.inputIndexEnd===0?void 0:r.inputIndexEnd===void 0?o+1:r.inputIndexEnd,u=o<0?e.inputNames.length+o:o;if(r.type==="tensor")return on(e.inputNames[u],n,s,a);if(r.type==="tensors"){const p=e.inputs.slice(o,l);return e.inputNames.slice(o,l).filter((f,m)=>{var y;return((y=p[m])===null||y===void 0?void 0:y.op)!=="NoOp"}).map(f=>on(f,n,s,a))}const c=on(e.inputNames[u],n,s,a),d=c.dataSync();return r.type==="number"?d[0]:Cs(c.shape,d)}const i=e.attrParams[t];return i&&i.value}function on(t,e,n,s){const[a,r]=ts(t,n);if(s!=null){const o=s.getHashTableHandleByName(a);if(o!=null)return o}const i=n.currentContextIds.find(o=>!!e[Qm(a,o)]);return i!==void 0?e[Qm(a,i)][r]:void 0}function MC(t,e,n){return e[Qm(t,n.currentContextId)]}function lr(t,e){const[n,s,a]=ts(t,e);return[Qm(n,e&&e.currentContextId),s,a]}function Qm(t,e){return e?`${t}-${e}`:t}function ts(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const r=e.parseNodeNameCache.get(t);if(r!=null)return r}const s=t.split(":");let a;if(s.length===1)a=[t,0,void 0];else{const r=s[0],i=s.length===3?s[1]:void 0,o=Number(s[s.length-1]);a=[r,o,i]}return n&&e.parseNodeNameCache.set(t,a),a}function em(t,e,n){let s=v("pad",t,e,n);if(s==="explicit"){s=v("explicitPaddings",t,e,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let r=0;r<4;r++)a[r][0]=s[r*2],a[r][1]=s[r*2+1];return a}return s}function ur(t){return t.kept?t:Ua(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dJ=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],pJ=Object.freeze(Object.defineProperty({__proto__:null,json:dJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hJ=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],fJ=Object.freeze(Object.defineProperty({__proto__:null,json:hJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mJ=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],gJ=Object.freeze(Object.defineProperty({__proto__:null,json:mJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yJ=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],bJ=Object.freeze(Object.defineProperty({__proto__:null,json:yJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wJ=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],kJ=Object.freeze(Object.defineProperty({__proto__:null,json:wJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xJ=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],vJ=Object.freeze(Object.defineProperty({__proto__:null,json:xJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SJ=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],NJ=Object.freeze(Object.defineProperty({__proto__:null,json:SJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CJ=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],IJ=Object.freeze(Object.defineProperty({__proto__:null,json:CJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],$J=Object.freeze(Object.defineProperty({__proto__:null,json:TJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJ=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],RJ=Object.freeze(Object.defineProperty({__proto__:null,json:EJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AJ=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],OJ=Object.freeze(Object.defineProperty({__proto__:null,json:AJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DJ=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],jJ=Object.freeze(Object.defineProperty({__proto__:null,json:DJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _J=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],FJ=Object.freeze(Object.defineProperty({__proto__:null,json:_J},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PJ=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],LJ=Object.freeze(Object.defineProperty({__proto__:null,json:PJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BJ=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],zJ=Object.freeze(Object.defineProperty({__proto__:null,json:BJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MJ=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],VJ=Object.freeze(Object.defineProperty({__proto__:null,json:MJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WJ=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],UJ=Object.freeze(Object.defineProperty({__proto__:null,json:WJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GJ=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],HJ=Object.freeze(Object.defineProperty({__proto__:null,json:GJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KJ=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],qJ=Object.freeze(Object.defineProperty({__proto__:null,json:KJ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VC{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[pJ,fJ,gJ,bJ,kJ,vJ,NJ,IJ,$J,RJ,OJ,jJ,FJ,LJ,zJ,VJ,UJ,HJ,qJ],n=[].concat(...e.map(s=>s.json));this.opMappers=n.reduce((s,a)=>(s[a.tfOpName]=a,s),{})}transformGraph(e,n={}){const s=e.node,a=[],r=[],i=[],o=s.reduce((m,y)=>(m[y.name]=this.mapNode(y),y.op.startsWith("Placeholder")?a.push(m[y.name]):y.op==="Const"?r.push(m[y.name]):(y.input==null||y.input.length===0)&&i.push(m[y.name]),m),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const p=Object.keys(o);p.forEach(m=>{const y=o[m];y.inputNames.forEach((g,b)=>{const[w,,k]=lr(g),x=o[w];if(x.outputs!=null){const S=x.outputs.indexOf(k);if(S!==-1){const C=`${w}:${S}`;y.inputNames[b]=C}}y.inputs.push(x),x.children.push(y)})}),Object.keys(d).length===0?p.forEach(m=>{const y=o[m];y.children.length===0&&u.push(y)}):Object.keys(d).forEach(m=>{const[y]=lr(m),g=o[y];g!=null&&(g.signatureKey=d[m],u.push(g))}),Object.keys(c).length>0?Object.keys(c).forEach(m=>{const[y]=lr(m),g=o[y];g&&(g.signatureKey=c[m],l.push(g))}):l=a;let h={};e.library!=null&&e.library.function!=null&&(h=e.library.function.reduce((m,y)=>(m[y.signature.name]=this.mapFunction(y),m),{}));const f={nodes:o,inputs:l,outputs:u,weights:r,placeholders:a,signature:n,functions:h};return i.length>0&&(f.initNodes=i),f}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,s)=>(n[e[s].name]=s,n),{})}mapNode(e){const n=Uj(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(a=>a.startsWith("^")?a.slice(1):a),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((a,r)=>(a[r.name]={type:r.type,inputIndexStart:r.start,inputIndexEnd:r.end},a),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((a,r)=>{const i=r.type;let o;switch(r.type){case"string":o=Sk(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=Sk(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"string[]":o=Rk(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=Rk(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"number":o=Ck(e.attr,r.tfName,r.defaultValue||0),o===void 0&&r.tfDeprecatedName&&(o=Ck(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"number[]":o=Ek(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=Ek(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool":o=Nk(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=Nk(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool[]":o=Ok(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=Ok(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape":o=$k(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=$k(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape[]":o=Ak(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=Ak(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype":o=Ik(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=Ik(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype[]":o=Tk(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=Tk(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"func":o=WC(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=WC(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${r.type} for op: ${e.op}`)}return a[r.name]={value:o,type:i},a},{})),s}mapFunction(e){const n=e.nodeDef,s=[],a=[];let r={};n!=null&&(r=n.reduce((d,p)=>(d[p.name]=this.mapNode(p),p.op==="Const"&&a.push(d[p.name]),d),{}));const i=[],o=[];e.signature.inputArg.forEach(d=>{const[p]=lr(d.name),h={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:I2(d.type),type:"dtype"}},children:[]};h.signatureKey=d.name,i.push(h),r[p]=h}),Object.keys(r).forEach(d=>{const p=r[d];p.inputNames.forEach((h,f)=>{const[m,,y]=lr(h),g=r[m];if(g.outputs!=null){const b=g.outputs.indexOf(y);if(b!==-1){const w=`${m}:${b}`;p.inputNames[f]=w}}p.inputs.push(g),g.children.push(p)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[p,h]=lr(u[d.name]),f=r[p];f!=null&&(f.defaultOutput=h,o.push(f))});const c=this.mapArgsToSignature(e);return{nodes:r,inputs:i,outputs:o,weights:a,placeholders:s,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:e.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,e.ret),n),{})}}mapArgToTensorInfo(e,n){let s=e.name;return n!=null&&(s=n[s]),{name:s,dtype:e.type}}}function JJ(t){const e=W().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Gj(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):JJ(t);return e?n:n.toLowerCase()}function Sk(t,e,n,s=!1){const a=t[e];return a!=null?Gj(a.s,s):n}function Nk(t,e,n){const s=t[e];return s?s.b:n}function Ck(t,e,n){const s=t[e]||{},a=s.i!=null?s.i:s.f!=null?s.f:n;return typeof a=="number"?a:parseInt(a,10)}function I2(t){switch(typeof t=="string"&&(t=es[t]),t){case es.DT_FLOAT:case es.DT_HALF:return"float32";case es.DT_INT32:case es.DT_INT64:case es.DT_INT8:case es.DT_UINT8:return"int32";case es.DT_BOOL:return"bool";case es.DT_DOUBLE:return"float32";case es.DT_STRING:return"string";case es.DT_COMPLEX64:case es.DT_COMPLEX128:return"complex64";default:return null}}function WC(t,e,n){const s=t[e];return s&&s.func?s.func.name:n}function Ik(t,e,n){const s=t[e];return s&&s.type?I2(s.type):n}function Tk(t,e,n){const s=t[e];return s&&s.list&&s.list.type?s.list.type.map(a=>I2(a)):n}function Hj(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function $k(t,e,n){const s=t[e];return s&&s.shape?Hj(s.shape):n}function Ek(t,e,n){const s=t[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):n}function Rk(t,e,n,s=!1){const a=t[e];return a&&a.list&&a.list.s?a.list.s.map(r=>Gj(r,s)):n}function Ak(t,e,n){const s=t[e];return s&&s.list&&s.list.shape?s.list.shape.map(a=>Hj(a)):n}function Ok(t,e,n){const s=t[e];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XJ{constructor(e,n,s){this.node=e,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(a=>this.getInput(a)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((a,r)=>(a[r]=this.getAttr(r),a),{}))}getInput(e){return on(e,this.tensorMap,this.context)}getAttr(e,n){const s=this.node.rawAttrs[e];if(s.tensor!=null)return on(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return Ck(this.node.rawAttrs,e,n);if(s.s!=null)return Sk(this.node.rawAttrs,e,n);if(s.b!=null)return Nk(this.node.rawAttrs,e,n);if(s.shape!=null)return $k(this.node.rawAttrs,e,n);if(s.type!=null)return Ik(this.node.rawAttrs,e,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return Ek(this.node.rawAttrs,e,n);if(s.list.s!=null)return Rk(this.node.rawAttrs,e,n);if(s.list.shape!=null)return Ak(this.node.rawAttrs,e,n);if(s.list.b!=null)return Ok(this.node.rawAttrs,e,n);if(s.list.type!=null)return Tk(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:i1,abs:Ft,acos:h1,acosh:f1,add:ee,addN:jR,all:My,any:Hd,argMax:Ro,argMin:m1,asin:g1,asinh:y1,atan:b1,atan2:w1,atanh:k1,avgPool:Sh,avgPool3d:v1,basicLSTMCell:_R,batchNorm:hc,batchNorm2d:S1,batchNorm3d:N1,batchNorm4d:C1,batchToSpaceND:Nh,bincount:I1,bitwiseAnd:FR,booleanMaskAsync:xA,broadcastArgs:PR,broadcastTo:yo,buffer:Re,cast:oe,ceil:T1,clipByValue:Hn,clone:Ua,complex:vr,concat:At,concat1d:$1,concat2d:E1,concat3d:R1,concat4d:A1,conv1d:Vy,conv2d:Sr,conv2dTranspose:Wy,conv3d:D1,conv3dTranspose:j1,cos:Ch,cosh:Uy,cosineWindow:f0,cumprod:Jd,cumsum:Gy,denseBincount:Mm,depthToSpace:_1,depthwiseConv2d:fc,diag:BR,dilation2d:F1,div:xe,divNoNan:P1,dot:L1,dropout:bv,einsum:to,elu:mc,enclosingPowerOfTwo:wv,ensureShape:zR,equal:Xs,erf:Hy,euclideanNorm:z1,exp:Kn,expandDims:bn,expm1:M1,eye:Ky,fft:Lh,fill:Yo,floor:yc,floorDiv:zy,fused:RA,gather:bc,gatherND:CA,greater:Qn,greaterEqual:Or,ifft:ru,imag:Ih,image:pa,inTopKAsync:IA,irfft:l0,isFinite:V1,isInf:W1,isNaN:U1,leakyRelu:Th,less:tu,lessEqual:Bi,linalg:vv,linspace:WR,localResponseNormalization:G1,log:ds,log1p:$h,logSigmoid:H1,logSoftmax:Jy,logSumExp:Eh,logicalAnd:wa,logicalNot:Rh,logicalOr:Xy,logicalXor:K1,losses:PA,lowerBound:GR,matMul:je,max:Is,maxPool:Ah,maxPool3d:q1,maxPoolWithArgmax:HR,maximum:er,mean:xt,meshgrid:KR,min:eu,minimum:Si,mirrorPad:J1,mod:X1,moments:Oh,movingAverage:vA,mul:D,multiRNNCell:qR,multinomial:JR,neg:ot,norm:gc,notEqual:Do,oneHot:nu,ones:Mn,onesLike:ps,op:O,outerProduct:XR,pad:Dr,pad1d:YR,pad2d:QR,pad3d:ZR,pad4d:eA,pool:Y1,pow:Xa,prelu:jh,print:p1,prod:Q1,raggedGather:tA,raggedRange:nA,raggedTensorToTensor:sA,rand:aA,randomGamma:lA,randomNormal:Zy,randomStandardNormal:uA,randomUniform:zi,randomUniformInt:cA,range:jo,real:su,reciprocal:lv,relu:Ta,relu6:e0,reshape:_,reverse:$s,reverse1d:dA,reverse2d:pA,reverse3d:hA,reverse4d:fA,rfft:Bh,round:t0,rsqrt:n0,scalar:Se,scatterND:SA,searchSorted:Yy,selu:s0,separableConv2d:a0,setdiff1dAsync:mA,sigmoid:ga,sign:uv,signal:FA,sin:r0,sinh:i0,slice:ze,slice1d:_h,slice2d:o0,slice3d:Fh,slice4d:au,softmax:Ph,softplus:Qo,spaceToBatchND:Dh,sparse:LA,sparseToDense:NA,spectral:_A,split:Wn,sqrt:tn,square:et,squaredDifference:u0,squeeze:Mi,stack:qn,step:el,stridedSlice:cv,string:BA,sub:pe,sum:me,tan:dv,tanh:vi,tensor:Ks,tensor1d:wn,tensor2d:Fl,tensor3d:pv,tensor4d:gA,tensor5d:yA,tensor6d:bA,tensorScatterUpdate:wA,tile:vs,topk:fv,transpose:Be,truncatedNormal:d0,unique:mv,unsortedSegmentSum:p0,unstack:Es,upperBound:kA,variable:gv,where:cn,whereAsync:yv,zeros:Lt,zerosLike:Me},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YJ=(t,e,n,s=mn)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(v("a",t,e,n),v("b",t,e,n))];case"AddN":return[s.addN(v("tensors",t,e,n))];case"FloorMod":case"Mod":return[s.mod(v("a",t,e,n),v("b",t,e,n))];case"Mul":return[s.mul(v("a",t,e,n),v("b",t,e,n))];case"RealDiv":case"Div":return[s.div(v("a",t,e,n),v("b",t,e,n))];case"DivNoNan":return[s.divNoNan(v("a",t,e,n),v("b",t,e,n))];case"FloorDiv":return[s.floorDiv(v("a",t,e,n),v("b",t,e,n))];case"Sub":return[s.sub(v("a",t,e,n),v("b",t,e,n))];case"Minimum":return[s.minimum(v("a",t,e,n),v("b",t,e,n))];case"Maximum":return[s.maximum(v("a",t,e,n),v("b",t,e,n))];case"Pow":return[s.pow(v("a",t,e,n),v("b",t,e,n))];case"SquaredDifference":return[s.squaredDifference(v("a",t,e,n),v("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QJ=(t,e,n,s=mn)=>{switch(t.op){case"Abs":case"ComplexAbs":return[s.abs(v("x",t,e,n))];case"Acos":return[s.acos(v("x",t,e,n))];case"Acosh":return[s.acosh(v("x",t,e,n))];case"Asin":return[s.asin(v("x",t,e,n))];case"Asinh":return[s.asinh(v("x",t,e,n))];case"Atan":return[s.atan(v("x",t,e,n))];case"Atan2":return[s.atan2(v("x",t,e,n),v("y",t,e,n))];case"Atanh":return[s.atanh(v("x",t,e,n))];case"Ceil":return[s.ceil(v("x",t,e,n))];case"Complex":return[s.complex(v("real",t,e,n),v("imag",t,e,n))];case"Cos":return[s.cos(v("x",t,e,n))];case"Cosh":return[s.cosh(v("x",t,e,n))];case"Elu":return[s.elu(v("x",t,e,n))];case"Erf":return[s.erf(v("x",t,e,n))];case"Exp":return[s.exp(v("x",t,e,n))];case"Expm1":return[s.expm1(v("x",t,e,n))];case"Floor":return[s.floor(v("x",t,e,n))];case"Log":return[s.log(v("x",t,e,n))];case"Log1p":return[s.log1p(v("x",t,e,n))];case"Imag":return[s.imag(v("x",t,e,n))];case"Neg":return[s.neg(v("x",t,e,n))];case"Reciprocal":return[s.reciprocal(v("x",t,e,n))];case"Real":return[s.real(v("x",t,e,n))];case"Relu":return[s.relu(v("x",t,e,n))];case"Round":return[s.round(v("x",t,e,n))];case"Selu":return[s.selu(v("x",t,e,n))];case"Sigmoid":return[s.sigmoid(v("x",t,e,n))];case"Sin":return[s.sin(v("x",t,e,n))];case"Sign":return[s.sign(v("x",t,e,n))];case"Sinh":return[s.sinh(v("x",t,e,n))];case"Softplus":return[s.softplus(v("x",t,e,n))];case"Sqrt":return[s.sqrt(v("x",t,e,n))];case"Square":return[s.square(v("x",t,e,n))];case"Tanh":return[s.tanh(v("x",t,e,n))];case"Tan":return[s.tan(v("x",t,e,n))];case"ClipByValue":return[s.clipByValue(v("x",t,e,n),v("clipValueMin",t,e,n),v("clipValueMax",t,e,n))];case"Relu6":return[s.relu6(v("x",t,e,n))];case"Rsqrt":return[s.rsqrt(on(t.inputNames[0],e,n))];case"LeakyRelu":return[s.leakyRelu(v("x",t,e,n),v("alpha",t,e,n))];case"Prelu":return[s.prelu(v("x",t,e,n),v("alpha",t,e,n))];case"IsNan":return[s.isNaN(on(t.inputNames[0],e,n))];case"IsInf":return[s.isInf(on(t.inputNames[0],e,n))];case"IsFinite":return[s.isFinite(on(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fs(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){I(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let s=0;s<t.length;s++){const a=t[s],r=e[s];I(a<0||r<0||a===r,()=>n+` Shapes ${t} and ${e} must match`)}}}function UC(t){return!(typeof t=="number"||t.some(e=>e<0))}function Hc(t,e,n){let s=Dk(t,n);const a=!UC(s);if(a&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(a&&e.forEach(r=>{s=Dk(r.shape,s)}),!UC(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function Dk(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let s=0;s<t.length;++s){const a=t[s],r=e[s];if(a>=0&&r>=0&&a!==r)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[s]=a>=0?a:r}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZJ{constructor(e,n,s,a,r,i,o){this.name=e,this.dtype=n,this.maxSize=s,this.elementShape=a,this.identicalElementShapes=r,this.dynamicSize=i,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=Se(0),Vt(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Fs(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=n,Vt(n),s.written=!0,this.tensors[e]=s}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((s,a)=>this.write(s,n[a]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let a=0;a<this.size();a++)e.push(a)}if(e.length===0)return Ks([],[0].concat(this.elementShape));const s=this.readMany(e);return Fs(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),qn(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Ks([],[0].concat(this.elementShape));const n=[];for(let a=0;a<this.size();a++)n.push(a);const s=this.readMany(n);return Fs(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),At(s,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,Es(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const a=e.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const r=s===0?0:n.size/s,i=[];M(()=>{n=_(n,[1,s,r]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:a[l-1],0],d=[1,e[l],r];i[l]=_(ze(n,c,d),this.elementShape)}return i});const o=[];for(let l=0;l<e.length;l++)o[l]=l;this.writeMany(o,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Po{get id(){return this.idTensor.id}constructor(e,n,s,a=-1){this.tensors=e,this.elementShape=n,this.elementDtype=s,e!=null&&e.forEach(r=>{if(s!==r.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${r.dtype}`);Fs(n,r.shape,"TensorList shape mismatch: "),Vt(r)}),this.idTensor=Se(0),this.maxNumElements=a,Vt(this.idTensor)}copy(){return new Po([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);Fs(e,this.elementShape,"TensorList shape mismatch: ");const a=Hc(this.elementShape,this.tensors,e);return M(()=>{const r=this.tensors.map(i=>_(i,a));return qn(r,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Hc(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,Fs(a.shape,e,"TensorList shape mismatch: "),_(a,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Fs(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Vt(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new Po([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)n.tensors[s]=this.tensors[s];return n}getItem(e,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Fs(this.tensors[e].shape,n,"TensorList shape mismatch: ");const a=Hc(this.elementShape,this.tensors,n);return _(this.tensors[e],a)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Fs(this.elementShape,n.shape,"TensorList shape mismatch: "),Vt(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Fs(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const a=Hc(this.elementShape,this.tensors,s);return e.length===0?Ks([],[0].concat(a)):M(()=>{const r=e.map(i=>_(this.tensors[i],a));return qn(r,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Fs(this.elementShape,n,"TensorList shape mismatch: ");const s=Hc(this.elementShape,this.tensors,n);return this.size()===0?Ks([],[0].concat(s)):M(()=>{const a=this.tensors.map(r=>_(r,s));return At(a,0)})}}function eX(t,e,n){const s=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const a=t.shape.slice(1);Fs(a,e,"TensorList shape mismatch: ");const r=Es(t);return new Po(r,e,s)}function tX(t,e,n,s){return new Po([],t,e,s)}function nX(t,e,n,s){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const a=Math.max(...e);if(s!=null&&s!==-1&&a>=s)throw new Error(`Max index must be < array size (${a}  vs. ${s})`);const r=new Po([],n,t.dtype,s),i=Es(t,0);return e.forEach((o,l)=>{r.setItem(o,i[l])}),r}function sX(t,e,n){let s=0;const a=e.map(c=>(s+=c,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);const r=t.shape.slice(1),i=Dk(r,n),o=s===0?0:t.size/s,l=M(()=>{const c=[];t=_(t,[1,s,o]);for(let d=0;d<e.length;++d){const h=[0,d===0?0:a[d-1],0],f=[1,e[d],o];c[d]=_(ze(t,h,f),i)}return t.dispose(),c}),u=new Po([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const s=v("thenBranch",t,e,n),a=v("elseBranch",t,e,n),r=v("cond",t,e,n),i=v("args",t,e,n);return(await r.data())[0]?n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=v("body",t,e,n),a=v("cond",t,e,n),r=v("args",t,e,n),i=await n.functionMap[a].executeFunctionAsync(r,n.tensorArrayMap,n.tensorListMap),o=r.map(c=>c.id);let l=await i[0].data();i.forEach(c=>{!c.kept&&o.indexOf(c.id)===-1&&c.dispose()});let u=r;for(;l[0];){const c=u;u=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(h=>h.id);c.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()});const p=await n.functionMap[a].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()})}return u}case"LoopCond":{const s=v("pred",t,e,n);return[ur(s)]}case"Switch":{const s=v("pred",t,e,n);let a=v("data",t,e,n);return a.kept||(a=ur(a)),(await s.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const s=t.inputNames.find(a=>on(a,e,n)!==void 0);if(s){const a=on(s,e,n);return[ur(a)]}return}case"Enter":{const s=v("frameName",t,e,n),a=v("tensor",t,e,n);return n.enterFrame(s),[ur(a)]}case"Exit":{const s=v("tensor",t,e,n);return n.exitFrame(),[ur(s)]}case"NextIteration":{const s=v("tensor",t,e,n);return n.nextIteration(),[ur(s)]}case"TensorArrayV3":{const s=v("size",t,e,n),a=v("dtype",t,e,n),r=v("elementShape",t,e,n),i=v("dynamicSize",t,e,n),o=v("clearAfterRead",t,e,n),l=v("identicalElementShapes",t,e,n),u=v("name",t,e,n),c=new ZJ(u,a,s,r,l,i,o);return n.addTensorArray(c),[c.idTensor,Se(1)]}case"TensorArrayWriteV3":{const s=v("tensorArrayId",t,e,n),a=v("index",t,e,n),r=v("tensor",t,e,n),i=n.getTensorArray(s.id);return i.write(a,r),[i.idTensor]}case"TensorArrayReadV3":{const s=v("tensorArrayId",t,e,n),a=v("index",t,e,n);return[n.getTensorArray(s.id).read(a)]}case"TensorArrayGatherV3":{const s=v("tensorArrayId",t,e,n),a=v("indices",t,e,n),r=v("dtype",t,e,n);return[n.getTensorArray(s.id).gather(a,r)]}case"TensorArrayScatterV3":{const s=v("tensorArrayId",t,e,n),a=v("indices",t,e,n),r=v("tensor",t,e,n),i=n.getTensorArray(s.id);return i.scatter(a,r),[i.idTensor]}case"TensorArrayConcatV3":{const s=v("tensorArrayId",t,e,n),a=n.getTensorArray(s.id),r=v("dtype",t,e,n);return[a.concat(r)]}case"TensorArraySplitV3":{const s=v("tensorArrayId",t,e,n),a=v("tensor",t,e,n),r=v("lengths",t,e,n),i=n.getTensorArray(s.id);return i.split(r,a),[i.idTensor]}case"TensorArraySizeV3":{const s=v("tensorArrayId",t,e,n),a=n.getTensorArray(s.id);return[Se(a.size(),"int32")]}case"TensorArrayCloseV3":{const s=v("tensorArrayId",t,e,n),a=n.getTensorArray(s.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const s=v("tensorListId",t,e,n),a=v("index",t,e,n),r=v("tensor",t,e,n),i=n.getTensorList(s.id);return i.setItem(a,r),[i.idTensor]}case"TensorListGetItem":{const s=v("tensorListId",t,e,n),a=v("index",t,e,n),r=v("elementShape",t,e,n),i=v("elementDType",t,e,n);return[n.getTensorList(s.id).getItem(a,r,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=v("indices",t,e,n),a=v("tensor",t,e,n),r=v("elementShape",t,e,n),i=v("numElements",t,e,n),o=nX(a,s,r,i);return n.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=v("elementShape",t,e,n),a=v("elementDType",t,e,n);let r;t.op==="TensorListReserve"?r="numElements":r="maxNumElements";const i=v(r,t,e,n),o=t.op==="TensorListReserve"?-1:i,l=tX(s,a,i,o);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=v("tensorListId",t,e,n),a=v("indices",t,e,n),r=v("elementShape",t,e,n),i=v("elementDType",t,e,n);return[n.getTensorList(s.id).gather(a,i,r)]}case"TensorListStack":{const s=v("tensorListId",t,e,n),a=v("elementShape",t,e,n),r=v("elementDType",t,e,n),i=v("numElements",t,e,n);return[n.getTensorList(s.id).stack(a,r,i)]}case"TensorListFromTensor":{const s=v("tensor",t,e,n),a=v("elementShape",t,e,n),r=v("elementDType",t,e,n),i=eX(s,a,r);return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=v("tensorListId",t,e,n),a=n.getTensorList(s.id),r=v("dtype",t,e,n),i=v("elementShape",t,e,n);return[a.concat(r,i)]}case"TensorListPushBack":{const s=v("tensorListId",t,e,n),a=v("tensor",t,e,n),r=n.getTensorList(s.id);return r.pushBack(a),[r.idTensor]}case"TensorListPopBack":{const s=v("tensorListId",t,e,n),a=v("elementShape",t,e,n),r=v("elementDType",t,e,n);return[n.getTensorList(s.id).popBack(a,r)]}case"TensorListSplit":{const s=v("tensor",t,e,n),a=v("elementShape",t,e,n),r=v("lengths",t,e,n),i=sX(s,r,a);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=v("tensorListId",t,e,n),a=n.getTensorList(s.id);return[Se(a.size(),"int32")]}case"TensorListResize":{const s=v("tensorListId",t,e,n),a=v("size",t,e,n),i=n.getTensorList(s.id).resize(a);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GC(t,e,n){const[s,a]=v("fusedOps",t,e,n),r=s==="biasadd",i=!r,o=a==="prelu",l=s==="fusedbatchnorm",u=v("numArgs",t,e,n);if(r){if(o&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&r&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=v("strides",t,e,n),d=em(t,e,n),p=v("dataFormat",t,e,n).toUpperCase(),h=v("dilations",t,e,n);let[f,m]=v("args",t,e,n);i&&(m=f,f=void 0);const y=v("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:p,dilations:h,biasArg:f,preluArg:m,activationFunc:a,leakyreluAlpha:y}}const rX=(t,e,n,s=mn)=>{switch(t.op){case"Conv1D":{const a=v("stride",t,e,n),r=v("pad",t,e,n),i=v("dataFormat",t,e,n).toUpperCase(),o=v("dilation",t,e,n);return[s.conv1d(v("x",t,e,n),v("filter",t,e,n),a,r,i,o)]}case"Conv2D":{const a=v("strides",t,e,n),r=em(t,e,n),i=v("dataFormat",t,e,n).toUpperCase(),o=v("dilations",t,e,n);return[s.conv2d(v("x",t,e,n),v("filter",t,e,n),[a[1],a[2]],r,i,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:a,pad:r,dataFormat:i,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=GC(t,e,n);return[s.fused.conv2d({x:v("x",t,e,n),filter:v("filter",t,e,n),strides:[a[1],a[2]],pad:r,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:r,dataFormat:i,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=GC(t,e,n);return[s.fused.depthwiseConv2d({x:v("x",t,e,n),filter:v("filter",t,e,n),strides:[a[1],a[2]],pad:r,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=v("outputShape",t,e,n),r=v("strides",t,e,n),i=em(t,e,n);return[s.conv2dTranspose(v("x",t,e,n),v("filter",t,e,n),a,[r[1],r[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=v("strides",t,e,n),r=em(t,e,n),i=v("dilations",t,e,n),o=v("dataFormat",t,e,n).toUpperCase();return[s.depthwiseConv2d(v("input",t,e,n),v("filter",t,e,n),[a[1],a[2]],r,o,[i[1],i[2]])]}case"Conv3D":{const a=v("strides",t,e,n),r=v("pad",t,e,n),i=v("dataFormat",t,e,n).toUpperCase(),o=v("dilations",t,e,n);return[s.conv3d(v("x",t,e,n),v("filter",t,e,n),[a[1],a[2],a[3]],r,i,[o[1],o[2],o[3]])]}case"AvgPool":{const a=v("strides",t,e,n),r=v("pad",t,e,n),i=v("kernelSize",t,e,n);return[s.avgPool(v("x",t,e,n),[i[1],i[2]],[a[1],a[2]],r)]}case"MaxPool":{const a=v("strides",t,e,n),r=v("pad",t,e,n),i=v("kernelSize",t,e,n);return[s.maxPool(v("x",t,e,n),[i[1],i[2]],[a[1],a[2]],r)]}case"MaxPoolWithArgmax":{const a=v("strides",t,e,n),r=v("pad",t,e,n),i=v("kernelSize",t,e,n),o=v("includeBatchInIndex",t,e,n),{result:l,indexes:u}=s.maxPoolWithArgmax(v("x",t,e,n),[i[1],i[2]],[a[1],a[2]],r,o);return[l,u]}case"AvgPool3D":{const a=v("strides",t,e,n),r=v("pad",t,e,n),i=v("kernelSize",t,e,n);return[s.avgPool3d(v("x",t,e,n),[i[1],i[2],i[3]],[a[1],a[2],a[3]],r)]}case"MaxPool3D":{const a=v("strides",t,e,n),r=v("pad",t,e,n),i=v("kernelSize",t,e,n);return[s.maxPool3d(v("x",t,e,n),[i[1],i[2],i[3]],[a[1],a[2],a[3]],r)]}case"Dilation2D":{const a=v("strides",t,e,n),r=v("pad",t,e,n),i=v("dilations",t,e,n),o=a[1],l=a[2],u=i[1],c=i[2];return[s.dilation2d(v("x",t,e,n),v("filter",t,e,n),[o,l],r,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iX=(t,e,n,s=mn)=>{switch(t.op){case"Fill":{const a=v("shape",t,e,n),r=v("dtype",t,e,n),i=v("value",t,e,n);return[s.fill(a,i,r)]}case"LinSpace":{const a=v("start",t,e,n),r=v("stop",t,e,n),i=v("num",t,e,n);return[s.linspace(a,r,i)]}case"Multinomial":{const a=v("logits",t,e,n),r=v("numSamples",t,e,n),i=v("seed",t,e,n);return[s.multinomial(a,r,i)]}case"OneHot":{const a=v("indices",t,e,n),r=v("depth",t,e,n),i=v("onValue",t,e,n),o=v("offValue",t,e,n),l=v("dtype",t,e,n);return[s.oneHot(a,r,i,o,l)]}case"Ones":return[s.ones(v("shape",t,e,n),v("dtype",t,e,n))];case"OnesLike":return[s.onesLike(v("x",t,e,n))];case"RandomStandardNormal":return[s.randomStandardNormal(v("shape",t,e,n),v("dtype",t,e,n),v("seed",t,e,n))];case"RandomUniform":return[s.randomUniform(v("shape",t,e,n),v("minval",t,e,n),v("maxval",t,e,n),v("dtype",t,e,n))];case"RandomUniformInt":return[s.randomUniformInt(v("shape",t,e,n),v("minval",t,e,n),v("maxval",t,e,n),v("seed",t,e,n))];case"Range":{const a=v("start",t,e,n),r=v("stop",t,e,n),i=v("step",t,e,n);return[s.range(a,r,i,v("dtype",t,e,n))]}case"TruncatedNormal":{const a=v("shape",t,e,n),r=v("mean",t,e,n),i=v("stdDev",t,e,n),o=v("seed",t,e,n);return[s.truncatedNormal(a,r,i,v("dtype",t,e,n),o)]}case"Zeros":return[s.zeros(v("shape",t,e,n),v("dtype",t,e,n))];case"ZerosLike":return[s.zerosLike(v("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _b(t,e,n){const s=v("boxes",t,e,n),a=v("scores",t,e,n),r=v("maxOutputSize",t,e,n),i=v("iouThreshold",t,e,n),o=v("scoreThreshold",t,e,n),l=v("softNmsSigma",t,e,n);return{boxes:s,scores:a,maxOutputSize:r,iouThreshold:i,scoreThreshold:o,softNmsSigma:l}}const oX=async(t,e,n,s,a=mn)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=_b(t,e,n),d=await a.image.nonMaxSuppressionWithScoreAsync(r,i,o,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=_b(t,e,n),c=v("padToMaxOutputSize",t,e,n),d=await a.image.nonMaxSuppressionPaddedAsync(r,i,o,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=_b(t,e,n);return[await a.image.nonMaxSuppressionAsync(r,i,o,l,u)]}case"Where":{const r=a.cast(v("condition",t,e,n),"bool"),i=[await a.whereAsync(r)];return r.dispose(),i}case"ListDiff":return a.setdiff1dAsync(v("x",t,e,n),v("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lX=(t,e,n,s=mn)=>{switch(t.op){case"LowerBound":{const a=v("sortedSequence",t,e,n),r=v("values",t,e,n);return[s.lowerBound(a,r)]}case"TopKV2":{const a=v("x",t,e,n),r=v("k",t,e,n),i=v("sorted",t,e,n),o=s.topk(a,r,i);return[o.values,o.indices]}case"UpperBound":{const a=v("sortedSequence",t,e,n),r=v("values",t,e,n);return[s.upperBound(a,r)]}case"Unique":{const a=v("x",t,e,n),r=s.unique(a);return[r.values,r.indices]}case"UniqueV2":{const a=v("x",t,e,n),r=v("axis",t,e,n),i=s.unique(a,r);return[i.values,i.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uX=(t,e,n,s=mn)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const a=v("default",t,e,n);return[on(t.name,e,n)||a];case"Placeholder":return[on(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=v("x",t,e,n);return[ur(c)]}case"IdentityN":return v("x",t,e,n).map(c=>ur(c));case"Snapshot":const r=v("x",t,e,n);return[ur(r)];case"Shape":return[s.tensor1d(v("x",t,e,n).shape,"int32")];case"ShapeN":return v("x",t,e,n).map(c=>s.tensor1d(c.shape));case"Size":return[s.scalar(v("x",t,e,n).size,"int32")];case"Rank":return[s.scalar(v("x",t,e,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=v("x",t,e,n),o=v("data",t,e,n),l=v("message",t,e,n),u=v("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,u));return[i];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cX{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Se(0),this.tensorMap=new Map,Vt(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Se(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return this.tensorMap.forEach(a=>a.dispose()),this.tensorMap.clear(),M(()=>{const a=Es(n),r=s.length,i=a.length;I(r===i,()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${i} elements.`);for(let o=0;o<r;o++){const l=s[o],u=a[o];Vt(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return M(()=>{const a=[];for(let r=0;r<s.length;r++){const i=s[r],o=this.findWithDefault(i,n);a.push(o)}return qn(a)})}findWithDefault(e,n){const s=this.tensorMap.get(e);return s??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dX=async(t,e,n,s)=>{switch(t.op){case"HashTable":case"HashTableV2":{const a=s.getHashTableHandleByName(t.name);if(a!=null)return[a];{const r=v("keyDType",t,e,n),i=v("valueDType",t,e,n),o=new cX(r,i);return s.addHashTable(t.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const a=v("tableHandle",t,e,n,s),r=v("keys",t,e,n),i=v("values",t,e,n);return[await s.getHashTableById(a.id).import(r,i)]}case"LookupTableFind":case"LookupTableFindV2":{const a=v("tableHandle",t,e,n,s),r=v("keys",t,e,n),i=v("defaultValue",t,e,n);return[await s.getHashTableById(a.id).find(r,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=v("tableHandle",t,e,n,s);return[s.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX=(t,e,n,s=mn)=>{switch(t.op){case"ResizeBilinear":{const a=v("images",t,e,n),r=v("size",t,e,n),i=v("alignCorners",t,e,n),o=v("halfPixelCenters",t,e,n);return[s.image.resizeBilinear(a,[r[0],r[1]],i,o)]}case"ResizeNearestNeighbor":{const a=v("images",t,e,n),r=v("size",t,e,n),i=v("alignCorners",t,e,n),o=v("halfPixelCenters",t,e,n);return[s.image.resizeNearestNeighbor(a,[r[0],r[1]],i,o)]}case"CropAndResize":{const a=v("image",t,e,n),r=v("boxes",t,e,n),i=v("boxInd",t,e,n),o=v("cropSize",t,e,n),l=v("method",t,e,n),u=v("extrapolationValue",t,e,n);return[s.image.cropAndResize(a,r,i,o,l,u)]}case"ImageProjectiveTransformV3":{const a=v("images",t,e,n),r=v("transforms",t,e,n),i=v("outputShape",t,e,n),o=v("fillValue",t,e,n),l=v("interpolation",t,e,n),u=v("fillMode",t,e,n);return[s.image.transform(a,r,l.toLowerCase(),u.toLowerCase(),o,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hX=(t,e,n,s=mn)=>{switch(t.op){case"Equal":return[s.equal(v("a",t,e,n),v("b",t,e,n))];case"NotEqual":return[s.notEqual(v("a",t,e,n),v("b",t,e,n))];case"Greater":return[s.greater(v("a",t,e,n),v("b",t,e,n))];case"GreaterEqual":return[s.greaterEqual(v("a",t,e,n),v("b",t,e,n))];case"Less":return[s.less(v("a",t,e,n),v("b",t,e,n))];case"LessEqual":return[s.lessEqual(v("a",t,e,n),v("b",t,e,n))];case"LogicalAnd":return[s.logicalAnd(v("a",t,e,n),v("b",t,e,n))];case"LogicalNot":return[s.logicalNot(v("a",t,e,n))];case"LogicalOr":return[s.logicalOr(v("a",t,e,n),v("b",t,e,n))];case"Select":case"SelectV2":return[s.where(v("condition",t,e,n),v("a",t,e,n),v("b",t,e,n))];case"BitwiseAnd":return[s.bitwiseAnd(v("a",t,e,n),v("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fX=(t,e,n,s=mn)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(v("a",t,e,n),v("b",t,e,n),v("transposeA",t,e,n),v("transposeB",t,e,n))];case"Einsum":return[s.einsum(v("equation",t,e,n),...v("tensors",t,e,n))];case"Transpose":return[s.transpose(v("x",t,e,n),v("perm",t,e,n))];case"_FusedMatMul":const[a,r]=v("fusedOps",t,e,n),i=a==="biasadd",o=r==="prelu",l=v("numArgs",t,e,n),u=v("leakyreluAlpha",t,e,n);if(i){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=v("args",t,e,n);return[s.fused.matMul({a:v("a",t,e,n),b:v("b",t,e,n),transposeA:v("transposeA",t,e,n),transposeB:v("transposeB",t,e,n),bias:c,activation:r,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[s.linalg.bandPart(v("a",t,e,n),v("numLower",t,e,n),v("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mX=(t,e,n,s=mn)=>{switch(t.op){case"EuclideanNorm":return[s.euclideanNorm(v("x",t,e,n),v("axis",t,e,n),v("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(v("x",t,e,n),v("mean",t,e,n),v("variance",t,e,n),v("offset",t,e,n),v("scale",t,e,n),v("epsilon",t,e,n))];case"FusedBatchNormV3":return[s.batchNorm(v("x",t,e,n),v("mean",t,e,n),v("variance",t,e,n),v("offset",t,e,n),v("scale",t,e,n),v("epsilon",t,e,n))];case"LRN":return[s.localResponseNormalization(v("x",t,e,n),v("radius",t,e,n),v("bias",t,e,n),v("alpha",t,e,n),v("beta",t,e,n))];case"Softmax":return[s.softmax(v("x",t,e,n))];case"LogSoftmax":return[s.logSoftmax(v("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gX=(t,e,n,s=mn)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:a,outputDenseValues:r}=s.raggedGather(v("paramsNestedSplits",t,e,n),v("paramsDenseValues",t,e,n),v("indices",t,e,n),v("outputRaggedRank",t,e,n));return a.concat(r)}case"RaggedRange":{const{rtNestedSplits:a,rtDenseValues:r}=s.raggedRange(v("starts",t,e,n),v("limits",t,e,n),v("splits",t,e,n));return[a,r]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(v("shape",t,e,n),v("values",t,e,n),v("defaultValue",t,e,n),v("rowPartitionTensors",t,e,n),v("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yX=(t,e,n,s=mn)=>{switch(t.op){case"Max":{const o=v("axis",t,e,n),l=v("keepDims",t,e,n);return[s.max(v("x",t,e,n),o,l)]}case"Mean":{const o=v("axis",t,e,n),l=v("keepDims",t,e,n);return[s.mean(v("x",t,e,n),o,l)]}case"Min":{const o=v("axis",t,e,n),l=v("keepDims",t,e,n);return[s.min(v("x",t,e,n),o,l)]}case"Sum":{const o=v("axis",t,e,n),l=v("keepDims",t,e,n);return[s.sum(v("x",t,e,n),o,l)]}case"All":{const o=v("axis",t,e,n),l=v("keepDims",t,e,n);return[s.all(v("x",t,e,n),o,l)]}case"Any":{const o=v("axis",t,e,n),l=v("keepDims",t,e,n);return[s.any(v("x",t,e,n),o,l)]}case"ArgMax":{const o=v("axis",t,e,n);return[s.argMax(v("x",t,e,n),o)]}case"ArgMin":{const o=v("axis",t,e,n);return[s.argMin(v("x",t,e,n),o)]}case"Prod":{const o=v("axis",t,e,n),l=v("keepDims",t,e,n);return[s.prod(v("x",t,e,n),o,l)]}case"Cumprod":{const o=v("axis",t,e,n),l=v("exclusive",t,e,n),u=v("reverse",t,e,n);return[s.cumprod(v("x",t,e,n),o,l,u)]}case"Cumsum":{const o=v("axis",t,e,n),l=v("exclusive",t,e,n),u=v("reverse",t,e,n);return[s.cumsum(v("x",t,e,n),o,l,u)]}case"Bincount":const a=v("x",t,e,n),r=v("weights",t,e,n),i=v("size",t,e,n);return[s.bincount(a,r,i)];case"DenseBincount":{const o=v("x",t,e,n),l=v("weights",t,e,n),u=v("size",t,e,n),c=v("binaryOutput",t,e,n);return[s.denseBincount(o,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bX=(t,e,n,s=mn)=>{switch(t.op){case"ConcatV2":case"Concat":{const a=v("n",t,e,n),r=v("axis",t,e,n);let i=v("tensors",t,e,n);return i=i.slice(0,a),[s.concat(i,r)]}case"Gather":{const a=v("x",t,e,n),r=v("indices",t,e,n);return[s.gather(a,s.cast(r,"int32"),0)]}case"GatherV2":{const a=v("axis",t,e,n),r=v("batchDims",t,e,n),i=v("x",t,e,n),o=v("indices",t,e,n);return[s.gather(i,s.cast(o,"int32"),a,r)]}case"Reverse":{const a=v("dims",t,e,n),r=[];for(let o=0;o<a.length;o++)a[o]&&r.push(o);const i=v("x",t,e,n);return[s.reverse(i,r)]}case"ReverseV2":{const a=v("axis",t,e,n),r=v("x",t,e,n);return[s.reverse(r,a)]}case"Slice":{const a=v("begin",t,e,n),r=v("size",t,e,n);return[s.slice(v("x",t,e,n),a,r)]}case"StridedSlice":{const a=v("begin",t,e,n),r=v("end",t,e,n),i=v("strides",t,e,n),o=v("beginMask",t,e,n),l=v("endMask",t,e,n),u=v("ellipsisMask",t,e,n),c=v("newAxisMask",t,e,n),d=v("shrinkAxisMask",t,e,n),p=v("x",t,e,n);return[s.stridedSlice(p,a,r,i,o,l,u,c,d)]}case"Pack":return M(()=>{const a=v("axis",t,e,n),r=v("tensors",t,e,n),i=r[0].shape,o=s.squeeze(r[0]).shape,l=r.map(u=>{const c=Le(u.shape,i);if(!c&&!Le(s.squeeze(u).shape,o))throw new Error("the input tensors shape does not match");return c?u:s.reshape(u,i)});return[s.stack(l,a)]});case"Unpack":{const a=v("axis",t,e,n),r=v("tensor",t,e,n);return s.unstack(r,a)}case"Tile":{const a=v("reps",t,e,n);return[s.tile(v("x",t,e,n),a)]}case"Split":case"SplitV":{const a=v("axis",t,e,n),r=v("numOrSizeSplits",t,e,n),i=v("x",t,e,n);return s.split(i,r,a)}case"ScatterNd":{const a=v("indices",t,e,n),r=v("values",t,e,n),i=v("shape",t,e,n);return[s.scatterND(a,r,i)]}case"GatherNd":{const a=v("x",t,e,n),r=v("indices",t,e,n);return[s.gatherND(a,r)]}case"SparseToDense":{const a=v("sparseIndices",t,e,n),r=v("outputShape",t,e,n),i=v("sparseValues",t,e,n),o=v("defaultValue",t,e,n);return[s.sparseToDense(a,i,r,i.dtype===o.dtype?o:s.cast(o,i.dtype))]}case"TensorScatterUpdate":{const a=v("indices",t,e,n),r=v("values",t,e,n),i=v("tensor",t,e,n);return[s.tensorScatterUpdate(i,a,r)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wX=(t,e,n,s=mn)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:r,emptyRowIndicator:i,reverseIndexMap:o}=s.sparse.sparseFillEmptyRows(v("indices",t,e,n),v("values",t,e,n),v("denseShape",t,e,n),v("defaultValue",t,e,n));return[a,r,i,o]}case"SparseReshape":{const{outputIndices:a,outputShape:r}=s.sparse.sparseReshape(v("inputIndices",t,e,n),v("inputShape",t,e,n),v("newShape",t,e,n));return[a,r]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(v("data",t,e,n),v("indices",t,e,n),v("segmentIds",t,e,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(v("data",t,e,n),v("indices",t,e,n),v("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kX=(t,e,n,s=mn)=>{switch(t.op){case"FFT":return[s.fft(v("x",t,e,n))];case"IFFT":return[s.ifft(v("x",t,e,n))];case"RFFT":return[s.rfft(v("x",t,e,n))];case"IRFFT":return[s.irfft(v("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX=(t,e,n,s=mn)=>{switch(t.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(v("input",t,e,n),v("pattern",t,e,n),v("rewrite",t,e,n),v("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:a,nGramsSplits:r}=s.string.stringNGrams(v("data",t,e,n),v("dataSplits",t,e,n),v("separator",t,e,n),v("nGramWidths",t,e,n),v("leftPad",t,e,n),v("rightPad",t,e,n),v("padWidth",t,e,n),v("preserveShortSequences",t,e,n));return[a,r]}case"StringSplit":{const{indices:a,values:r,shape:i}=s.string.stringSplit(v("input",t,e,n),v("delimiter",t,e,n),v("skipEmpty",t,e,n));return[a,r,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(v("input",t,e,n),v("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vX=(t,e,n,s=mn)=>{switch(t.op){case"Cast":return[s.cast(v("x",t,e,n),v("dtype",t,e,n))];case"ExpandDims":{const a=v("axis",t,e,n);return[s.expandDims(v("x",t,e,n),a)]}case"Squeeze":{const a=v("axis",t,e,n);return[s.squeeze(v("x",t,e,n),a)]}case"Reshape":return[s.reshape(v("x",t,e,n),v("shape",t,e,n))];case"EnsureShape":return[s.ensureShape(v("x",t,e,n),v("shape",t,e,n))];case"MirrorPad":return[s.mirrorPad(v("x",t,e,n),v("padding",t,e,n),v("mode",t,e,n))];case"PadV2":case"Pad":return[s.pad(v("x",t,e,n),v("padding",t,e,n),v("constantValue",t,e,n))];case"SpaceToBatchND":{const a=v("blockShape",t,e,n),r=v("paddings",t,e,n);return[s.spaceToBatchND(v("x",t,e,n),a,r)]}case"BatchToSpaceND":{const a=v("blockShape",t,e,n),r=v("crops",t,e,n);return[s.batchToSpaceND(v("x",t,e,n),a,r)]}case"DepthToSpace":{const a=v("blockSize",t,e,n),r=v("dataFormat",t,e,n).toUpperCase();return[s.depthToSpace(v("x",t,e,n),a,r)]}case"BroadcastTo":return[s.broadcastTo(v("x",t,e,n),v("shape",t,e,n))];case"BroadcastArgs":return[s.broadcastArgs(v("s0",t,e,n),v("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HC(t,e,n,s,a=M){const r=((i,o,l)=>{switch(i.category){case"arithmetic":return a(()=>YJ(i,o,l));case"basic_math":return a(()=>QJ(i,o,l));case"control":return aX(i,o,l);case"convolution":return a(()=>rX(i,o,l));case"creation":return a(()=>iX(i,o,l));case"dynamic":return oX(i,o,l);case"evaluation":return a(()=>lX(i,o,l));case"image":return a(()=>pX(i,o,l));case"graph":return a(()=>uX(i,o,l));case"logical":return a(()=>hX(i,o,l));case"matrices":return a(()=>fX(i,o,l));case"normalization":return a(()=>mX(i,o,l));case"ragged":return a(()=>gX(i,o,l));case"reduction":return a(()=>yX(i,o,l));case"slice_join":return a(()=>bX(i,o,l));case"sparse":return a(()=>wX(i,o,l));case"spectral":return a(()=>kX(i,o,l));case"string":return a(()=>xX(i,o,l));case"transformation":return a(()=>vX(i,o,l));case"hash_table":return dX(i,o,l,s);case"custom":const u=Uj(i.op);if(u&&u.customExecutor)return u.customExecutor(new XJ(i,o,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return wi(r)?r.then(i=>[].concat(i)):[].concat(r)}class KC{constructor(e={},n={},s={},a={},r){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=a,this.parseNodeNameCache=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qC(t,e,n,s){const a=new Set,r=[];let i=null,o=null;const l=new Set,u=new Set(Object.keys(t).map(p=>ts(p)[0]));s=s||[];const c=new Set(s.map(p=>ts(p.name)[0])),d=[...e];for(;d.length>0;){const p=d.pop();if((so(p)||RX(p)||AX(p))&&i==null&&(i=p,o=i.children.map(h=>h.name).filter(h=>a.has(h))),a.add(p.name),n[p.name]==null&&!u.has(p.name)&&!c.has(p.name)){if(p.inputs.length===0){r.push(p.name);continue}p.inputs.forEach(h=>{l.has(h.name)||(l.add(h.name),d.push(h))})}}return{inputs:t,outputs:e,usedNodes:a,missingInputs:r,dynamicNode:i,syncInputs:o}}function SX(t,e){const{usedNodes:n,inputs:s}=e,a=Object.keys(s).map(y=>ts(y)[0]).map(y=>t.nodes[y]),r=t.initNodes||[],i=y=>n.has(typeof y=="string"?y:y.name);function o(y){return[...new Map(y.map(g=>[g.name,g])).values()]}const l=o([...a,...t.weights,...r]).filter(i),u=o([...l,...Object.values(t.nodes)]).filter(i),c=new Map(u.map(y=>[y.name,y])),d={};for(const y of u){d[y.name]=d[y.name]||0;for(const g of y.children)i(g)||(d[g.name]=Number.POSITIVE_INFINITY),d[g.name]=(d[g.name]||0)+1}const p=Object.entries(d).filter(([,y])=>y===0).map(([y])=>y),h=[...p];for(;p.length>0;){const y=p.pop(),g=c.get(y);for(const b of g.children.filter(i))--d[b.name]===0&&(h.push(b.name),p.push(b.name))}const f=h.map(y=>c.get(y)),m=NX(f,l);return CX(m,l),m}function NX(t,e){const n=new Map(t.map(i=>[i.name,i])),s=e.map(i=>i.name),a=new Set(s);for(;s.length>0;){const i=s.pop(),o=n.get(i);for(const l of o.children)!n.has(l.name)||a.has(l.name)||(a.add(l.name),s.push(l.name))}return t.filter(i=>a.has(i.name))}class Ef extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function CX(t,e){const n=new Map(t.map((o,l)=>[o.name,l])),s=new Set(e.map(o=>o.name)),a=o=>s.has(typeof o=="string"?o:o.name),r=new Set(t.map(o=>o.name)),i=o=>r.has(typeof o=="string"?o:o.name);for(const o of t){for(const l of o.children.filter(i)){if(!n.has(l.name))throw new Ef(`Child ${l.name} of node ${o.name} is unreachable.`);if(n.get(o.name)>n.get(l.name))throw new Ef(`Node ${o.name} is scheduled to run after its child ${l.name}.`)}if(!a(o))for(const l of o.inputs){if(!n.has(l.name))throw new Ef(`Input ${l.name} of node ${o.name} is unreachable.`);if(n.get(l.name)>n.get(o.name))throw new Ef(`Node ${o.name} is scheduled to run before its input ${l.name}.`)}}}function IX(t){const e=new Map(t.map((o,l)=>[o.name,l])),n=Number.MAX_SAFE_INTEGER,s=t.map((o,l)=>so(o)?n:l),a=o=>{const l=s[e.get(o.name)];return l??-1},r=t.map((o,l)=>o.children.map(a).reduce((u,c)=>Math.max(u,c),s[l])),i=new Map;for(let o=0;o<t.length;++o){const l=r[o];if(l===n)continue;const u=t[o],c=t[l];i.has(c.name)||i.set(c.name,[]),i.get(c.name).push(u)}return i}const TX=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),$X=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),EX=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function so(t){return TX.has(t.op)}function RX(t){return $X.has(t.op)}function AX(t){return EX.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zm{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(s=>e[s].map(a=>a.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new Zm(e.functions[s],this)})}getCompilationKey(e,n){const s=e.map(r=>r.name).sort(),a=n.map(r=>r.name).sort();return s.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(e,n){const s=qC(e,n,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:r,syncInputs:i}=s;if(r!=null)throw new Error(`This execution contains the node '${r.name}', which has the dynamic op '${r.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(a.length>0){const u=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${a}]`)}const o=SX(this.graph,s),l=IX(o);return{orderedNodes:o,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return Vt(n),n}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const a=s.map(p=>this.graph.nodes[ts(p)[0]]),r=n.map(p=>ts(p)[0]),i=new Set(r);let o=r.map(p=>this.graph.nodes[p]);o.length===0&&(o=this._outputs);const l=this.getCompilationKey(a,o);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,o),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=W().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const c={},d={};return M(()=>{const p=new KC(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),h=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(g=>{const[b,w]=ts(g,p),k=[];k[w]=e[g],h[b]=k,this.keepIntermediateTensors&&(this.clonedTensorsMap[b]=this.cloneTensorList(k))});const f=this.getFrozenTensorIds(h),{orderedNodes:m,nodeLiveUntilMap:y}=u;for(const g of m){if(h[g.name])continue;const b=HC(g,h,p,this._resourceManager);if(wi(b))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);h[g.name]=b,this.keepIntermediateTensors&&(this.clonedTensorsMap[g.name]=this.cloneTensorList(b)),this.checkTensorForDisposalWithNodeLiveUntilInfo(g,h,p,f,i,y.get(g.name))}return this.parent==null&&p.dispose(f),n.map(g=>on(g,h,p))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(a=>a.id)));return new Set(n)}checkTensorForDisposal(e,n,s,a,r,i,o){if(!(so(n)||i.has(e))){for(const l of s[e])l!=null&&(o[l.id]=(o[l.id]||0)+n.children.length);for(const l of n.inputs){if(so(l))continue;const u=MC(l.name,s,a);if(u!=null)for(const c of u){if(!c||c.kept||r.has(c.id))continue;const d=o[c.id];d===1?(c.dispose(),delete o[c.id]):d!=null&&o[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,s,a,r,i){function o(l){return so(l)||r.has(l.name)}if(!(so(e)||i==null))for(const l of i){if(o(l))continue;const u=MC(l.name,n,s);for(const c of u)!c||c.kept||a.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,s=!1,a={},r={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=W().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const i=new KC(this.weightMap,a,r,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const o=await this.executeWithControlFlow(e,i,n,s),l=n.map(p=>on(p,o,i)),u=l.map(p=>p.id),c=Object.keys(e).map(p=>e[p].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(o).forEach(p=>{p.forEach(h=>{h&&!h.isDisposed&&!d.has(h.id)&&h.dispose()})}),this.parent==null&&i.dispose(d),l}async executeFunctionAsync(e,n,s){const a=e.reduce((r,i,o)=>(r[this.inputs[o].name]=i,r),{});return this._executeAsync(a,this.outputNodes,!0,n,s)}async executeWithControlFlow(e,n,s,a){const r=Object.keys(e),i=r.map(k=>this.graph.nodes[ts(k)[0]]),o=s.map(k=>ts(k)[0]),l=new Set(o);let u=o.map(k=>this.graph.nodes[k]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:p,syncInputs:h}=qC(e,u,this.weightMap,this._initNodes),f=[...i,...this.graph.weights,...this._initNodes||[]].map(k=>({node:k,contexts:n.currentContext})),m=Object.assign({},this.weightMap);Object.keys(e).forEach(k=>{const[x,S]=ts(k),C=[];C[S]=e[k],m[x]=C});const y={},g=this.getFrozenTensorIds(m),b={};for(;f.length>0;){const k=this.processStack(i,f,n,m,b,g,l,y,c);await Promise.all(k)}p==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const w=u.filter(k=>!so(k)&&!on(k.name,m,n)).map(k=>k.name);if(w.length>0){let k="";throw p!=null&&(k=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${w}] from the provided inputs [${r}]. Consider providing the following inputs: [${d}]. ${k}`)}return m}processStack(e,n,s,a,r,i,o,l,u){const c=[];for(;n.length>0;){const d=n.pop();s.currentContext=d.contexts;let p="";if(d.node.op==="Enter"&&v("isConstant",d.node,a,s)&&([p]=lr(d.node.name,s)),a[d.node.name]==null){const h=HC(d.node,a,s,this._resourceManager);p||([p]=lr(d.node.name,s));const f=s.currentContext;wi(h)?c.push(h.then(m=>(a[p]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(m)),s.currentContext=f,this.checkTensorForDisposal(p,d.node,a,s,i,o,l),this.processChildNodes(d.node,n,s,a,r,u),m))):(a[p]=h,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(h)),this.checkTensorForDisposal(p,d.node,a,s,i,o,l),this.processChildNodes(d.node,n,s,a,r,u))}else this.processChildNodes(d.node,n,s,a,r,u)}return c}processChildNodes(e,n,s,a,r,i){e.children.forEach(o=>{const[l]=lr(o.name,s);r[l]||!i.has(o.name)||(o.op==="Merge"?o.inputNames.some(u=>!!on(u,a,s))&&(r[l]=!0,n.push({contexts:s.currentContext,node:o})):o.inputNames.every(u=>!!on(u,a,s))&&(r[l]=!0,n.push({contexts:s.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const s=e[n],[a]=ts(n),r=this.graph.nodes[a];if(r.attrParams.shape&&r.attrParams.shape.value){const i=r.attrParams.shape.value,o=i.length===s.shape.length&&s.shape.every((l,u)=>i[u]===-1||i[u]===l);I(o,()=>`The shape of dict['${r.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}r.attrParams.dtype&&r.attrParams.dtype.value&&I(s.dtype===r.attrParams.dtype.value,()=>`The dtype of dict['${r.name}'] provided in model.execute(dict) must be ${r.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var n,s;const a={};for(const r in e){const i=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[r];i!=null?a[i.name]=e[r]:a[r]=e[r]}return a}checkInputs(e){const n=Object.keys(e).filter(s=>{const[a]=ts(s);return this.graph.nodes[a]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var s,a;const r=(a=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||a===void 0?void 0:a[n];return r!=null?r.name:n},{})}checkOutputs(e){e.forEach(n=>{const[s]=ts(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class OX{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DX="?tfjs-format=file",jX="model.json";class T2{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},s=Av){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new OX}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return wi(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await SR(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const s=this.artifacts.modelTopology;let a=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const r=this.artifacts.userDefinedMetadata;r.signature!=null&&(a=r.signature),r.structuredOutputKeys!=null&&(this.structuredOutputKeys=r.structuredOutputKeys)}if(this.signature=a,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new Zm(VC.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const r=VC.Instance.transformGraph(e.modelInitializer);this.initializer=new Zm(r),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof qe?[e]:e,s={};return n.forEach((a,r)=>s[this.structuredOutputKeys[r]]=a),s}return e}predict(e,n){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,n){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var n;if(!(e instanceof qe)&&!Array.isArray(e)){const r=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(r!=null)for(const i in r){const o=r[i];o.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[o.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let a=0;return this.inputNodes.reduce((r,i)=>{var o,l,u;const c=(u=(l=(o=this.signature)===null||o===void 0?void 0:o.inputs)===null||l===void 0?void 0:l[i])===null||u===void 0?void 0:u.resourceId;return c!=null?r[i]=this.resourceIdToCapturedInput[c]:r[i]=e[a++],r},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let a=0;a<s.length;a++){const r=s[a],i=n[r];this.resourceIdToCapturedInput[i.resourceId]=e[a]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=this.executor.execute(e,n);return s.length>1?s:s[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(e,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,s)=>(n[s]=[e[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&_e(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function _X(t,e={},n=Av){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=PX(t));const s=new T2(t,e,n);return await s.load(),s}function FX(t){if(t==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(t instanceof Array){const[s,a]=t;if(!s)throw new Error("modelJSON must be the first element of the array");if(!a||!(a instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const r=zm(s.weightsManifest),i=c1(s,r,a);e=Vm(i)}else if("load"in t)e=t;else if("modelTopology"in t&&"weightSpecs"in t&&"weightData"in t)e=Vm(t);else throw new Error("Unknown model format");const n=new T2(e);return n.load(),n}function PX(t){return t.endsWith("/")||(t=t+"/"),`${t}${jX}${DX}`}/** @license See the LICENSE file. */const LX="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BX=Object.freeze(Object.defineProperty({__proto__:null,GraphModel:T2,deregisterOp:cJ,loadGraphModel:_X,loadGraphModelSync:FX,registerOp:uJ,version_converter:LX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var JC;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(JC||(JC={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ge(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&I(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zX=h0;class L0 extends Rg{nextDataId(){return L0.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new qx(this,ra())}write(e,n,s){this.firstUse&&(this.firstUse=!1,W().get("IS_NODE")&&ws(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:s,refCount:1}),a}makeTensorInfo(e,n,s){let a;if(n==="string"&&s!=null&&s.length>0&&Ba(s[0])){const r=s.map(i=>Wa(i));a=this.write(r,e,n)}else a=this.write(s,e,n);return{dataId:a,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,a,r){this.data.set(e,{values:n,dtype:a,refCount:r})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const a=this.readSync(s.real.dataId),r=this.readSync(s.imag.dataId);return Nr(a,r)}return XE(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(a=>xr(a));return Re(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Re(e.shape,e.dtype,n)}makeOutput(e,n,s){return ra().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=$n();return e(),{kernelMs:$n()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){ge([e],"where");const n=this.readSync(e.dataId);return zX(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}L0.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kj(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const MX=t=>{const{x:e}=t.inputs,n=t.backend;ge(e,"abs");let s=new Float32Array(K(e.shape));const a=n.data.get(e.dataId).values;return s=Kj(a),n.makeOutput(s,e.shape,e.dtype)},VX={kernelName:yp,backendName:"cpu",kernelFunc:MX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _t(t){return(e,n,s,a,r)=>{const i=Te(e,n),o=i.length,l=ve(i),u=K(i),c=en(r,u),d=e.length,p=n.length,h=ve(e),f=ve(n),m=Oo(e,i),y=Oo(n,i);if(m.length+y.length===0)for(let g=0;g<c.length;++g)c[g]=t(s[g%s.length],a[g%a.length]);else for(let g=0;g<c.length;++g){const b=qo(g,o,l),w=b.slice(-d);m.forEach(C=>w[C]=0);const k=ma(w,d,h),x=b.slice(-p);y.forEach(C=>x[C]=0);const S=ma(x,p,f);c[g]=t(s[k],a[S])}return[c,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function as(t){const{inputs:e,backend:n}=t,{real:s,imag:a}=e,r=n.data.get(s.dataId).values,i=n.data.get(a.dataId).values,o=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",r),imag:n.makeTensorInfo(a.shape,"float32",i)},o}const WX={kernelName:Bg,backendName:"cpu",kernelFunc:as};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eg(t,e,n="float32"){if(n==="complex64"){const a=eg(t,e,"float32"),r=eg(t,e,"float32");return as({inputs:{real:a,imag:r},backend:t})}const s=dn(K(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Za(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const UX={kernelName:Lu,backendName:"cpu",kernelFunc:Za};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lo(t){const{inputs:e,backend:n}=t,{input:s}=e,a=n.data.get(s.dataId).complexTensorInfos.real,r=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,r)}const GX={kernelName:by,backendName:"cpu",kernelFunc:Lo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qj(t,e,n,s){if(s==="int32"){const a=Int32Array.from(t);return[e,"int32",a]}if(s==="bool"){const a=_i([0],n),[r,i]=_t((o,l)=>o!==l?1:0)(e,[],t,a,"bool");return[i,"bool",r]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function $i(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{dtype:r}=s;if(r==="complex64"){if(a.dtype==="complex64")return Za({inputs:{x:a},backend:n});const c=eg(n,a.shape,a.dtype),d=$i({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),p=as({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),p}if(a.dtype==="complex64"){const c=Lo({inputs:{input:a},backend:n}),d=$i({inputs:{x:c},backend:n,attrs:{dtype:r}});return n.disposeIntermediateTensorInfo(c),d}if(!Yx(a.dtype,r)){const c=Za({inputs:{x:a},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:r}}const i=n.data.get(a.dataId).values,[o,l,u]=qj(i,a.shape,a.dtype,r);return n.makeTensorInfo(o,l,u)}const HX={kernelName:Cu,backendName:"cpu",kernelFunc:$i};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qt(t,e,n,s){return n==null?({inputs:a,backend:r})=>{const{a:i,b:o}=a,l=r;ge([i,o],t);const u=l.data.get(i.dataId).values,c=l.data.get(o.dataId).values,d=i.dtype==="string"?Cr(u):u,p=i.dtype==="string"?Cr(c):c,h=s||i.dtype,[f,m]=e(i.shape,o.shape,d,p,h);return l.makeTensorInfo(m,h,f)}:({inputs:a,backend:r})=>{const{a:i,b:o}=a,l=r;if(i.dtype==="complex64"||o.dtype==="complex64"){const u=$i({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,p=c.complexTensorInfos.imag,h=l.data.get(d.dataId).values,f=l.data.get(p.dataId).values,m=$i({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),y=l.data.get(m.dataId),g=y.complexTensorInfos.real,b=y.complexTensorInfos.imag,w=l.data.get(g.dataId).values,k=l.data.get(b.dataId).values,[x,S,C]=n(i.shape,o.shape,h,f,w,k),T=l.makeTensorInfo(C,"float32",x),E=l.makeTensorInfo(C,"float32",S),R=as({inputs:{real:T,imag:E},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(T),l.disposeIntermediateTensorInfo(E),R}else{const u=l.data.get(i.dataId).values,c=l.data.get(o.dataId).values,d=s||i.dtype,[p,h]=e(i.shape,o.shape,u,c,d);return l.makeTensorInfo(h,d,p)}}}function $2(t){return(e,n,s,a,r,i)=>{const o=Te(e,n),l=K(o),u=o.length,c=ve(o),d=en("float32",l),p=en("float32",l),h=Oo(e,o),f=Oo(n,o),m=Nr(s,a),y=Nr(r,i),g=e.length,b=ve(e),w=n.length,k=ve(n);if(h.length+f.length===0)for(let x=0;x<d.length;x++){const S=x%m.length,C=x%y.length,T=t(m[S*2],m[S*2+1],y[C*2],y[C*2+1]);d[x]=T.real,p[x]=T.imag}else for(let x=0;x<d.length;x++){const S=qo(x,u,c),C=S.slice(-g);h.forEach(U=>C[U]=0);const T=ma(C,g,b),E=S.slice(-w);f.forEach(U=>E[U]=0);const R=ma(E,w,k),L=t(m[T*2],m[T*2+1],y[R*2],y[R*2+1]);d[x]=L.real,p[x]=L.imag}return[d,p,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jj=_t((t,e)=>t+e),KX=$2((t,e,n,s)=>({real:t+n,imag:e+s})),ou=qt(Jo,Jj,KX),qX={kernelName:Jo,backendName:"cpu",kernelFunc:ou};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2(t,e,n,s,a){const r=K(s),i=dn(a,n);for(let o=0;o<t.length;o++){const l=t[o];if(l<0)throw new Error("Input x must be non-negative!");l>=a||(r>0?i[l]+=e[o]:i[l]+=1)}return i}function Xj(t,e,n,s=!1){const a=t.shape[0],r=t.shape[1],i=Re([a,n],e.dtype);for(let o=0;o<a;o++)for(let l=0;l<r;l++){const u=t.get(o,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(s?i.set(1,o,u):e.size>0?i.set(i.get(o,u)+e.get(o,l),o,u):i.set(i.get(o,u)+1,o,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yj=_t((t,e)=>t&e),JX=qt(Cp,Yj),XX={kernelName:Cp,backendName:"cpu",kernelFunc:JX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tr(t){return(e,n,s)=>{const a=Tt(n,e.length);for(let r=0;r<e.length;++r)a[r]=t(e[r],s);return a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qe(t,e,n){const s=tr(e);return Ui(t,s,n)}function Ui(t,e,n){return({inputs:s,attrs:a,backend:r})=>{const{x:i}=s;ge(i,t);const o=r,l=o.data.get(i.dataId).values;let u;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=Cr(l)}else u=l;const c=n||i.dtype,d=e(u,c,a);return o.makeTensorInfo(i.shape,c,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qj=tr(t=>Math.ceil(t)),YX=Ui(Iu,Qj),QX={kernelName:Iu,backendName:"cpu",kernelFunc:YX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zj(t,e,n,s){const a=Tt(n,K(e));if(s&&n!=="string"){let r=0;t.forEach(i=>{const o=K(i.shape);a.set(i.vals,r),r+=o})}else{let r=0;t.forEach(i=>{const o=n==="string"?Cr(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const c=u*e[1]+r;for(let d=0;d<i.shape[1];++d)a[c+d]=o[l++]}r+=i.shape[1]})}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e_=_t((t,e)=>t===e?1:0),t_=qt(jp,e_,null,"bool"),ZX={kernelName:jp,backendName:"cpu",kernelFunc:t_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n_=tr(t=>Math.exp(t)),s_=Ui(Du,n_,"float32"),eY={kernelName:Du,backendName:"cpu",kernelFunc:s_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a_=tr(t=>Math.expm1(t)),tY=Ui(ju,a_),nY={kernelName:ju,backendName:"cpu",kernelFunc:tY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r_=tr(t=>Math.floor(t)),sY=Ui(_u,r_),aY={kernelName:_u,backendName:"cpu",kernelFunc:sY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i_=_t((t,e)=>Math.floor(t/e)),rY=qt(Fu,i_,null,"int32"),iY={kernelName:Fu,backendName:"cpu",kernelFunc:rY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_(t,e,n,s,a,r,i,o,l){const u=Re([s,r],n);for(let c=0;c<s;c++){const d=[];let p=0;for(let h=0;h<a;h++){const f=t[c*a+h];p+=f*i[h],d.push(f)}if(p<0||p>=l/r)throw new Error(`Invalid indices: ${d} does not index into ${o}`);for(let h=0;h<r;h++)u.values[c*r+h]=e.get(...e.indexToLoc(p*r+h))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l_(t,e,n){const s=Re(n,t.dtype);for(let a=0;a<s.size;++a){const i=s.indexToLoc(a).slice(),o=i[0],l=i[2],u=e.locToIndex([o,l]);i[2]=e.values[u];const c=t.locToIndex(i);0<=c&&c<t.values.length&&(s.values[a]=t.values[c])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u_=_t((t,e)=>t>e?1:0),oY=qt(Lp,u_,null,"bool"),lY={kernelName:Lp,backendName:"cpu",kernelFunc:oY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c_=_t((t,e)=>t>=e?1:0),uY=qt(Pu,c_,null,"bool"),cY={kernelName:Pu,backendName:"cpu",kernelFunc:uY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d_=_t((t,e)=>t<e?1:0),dY=qt(zp,d_,null,"bool"),pY={kernelName:zp,backendName:"cpu",kernelFunc:dY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p_=_t((t,e)=>t<=e?1:0),hY=qt(Mp,p_,null,"bool"),fY={kernelName:Mp,backendName:"cpu",kernelFunc:hY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h_(t,e,n){const s=(e-t)/(n-1),a=dn(n,"float32");a[0]=t;for(let r=1;r<a.length;r++)a[r]=a[r-1]+s;return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f_=tr(t=>Math.log(t)),mY=Ui(Vu,f_),gY={kernelName:Vu,backendName:"cpu",kernelFunc:mY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m_(t,e,n,s){const a=en(s,K(n));for(let r=0;r<a.length;++r){const i=r*e;let o=t[i];for(let l=0;l<e;++l){const u=t[i+l];(Number.isNaN(u)||u>o)&&(o=u)}a[r]=o}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_=_t((t,e)=>Math.max(t,e)),yY=qt(Uu,g_),bY={kernelName:Uu,backendName:"cpu",kernelFunc:yY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y_=_t((t,e)=>Math.min(t,e)),wY=qt(Gu,y_),kY={kernelName:Gu,backendName:"cpu",kernelFunc:wY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R2=_t((t,e)=>t*e),xY=$2((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),B0=qt(Ku,R2,xY),vY={kernelName:Ku,backendName:"cpu",kernelFunc:B0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b_(t,e,n){const s=Er(-1,n);return R2([],e,s,t,n)}function SY(t){const{inputs:e,backend:n}=t,{x:s}=e;ge(s,"neg");const a=n.data.get(s.dataId).values,[r,i]=b_(a,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,r)}const NY={kernelName:Qp,backendName:"cpu",kernelFunc:SY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w_=_t((t,e)=>t!==e?1:0),CY=qt(Zp,w_,null,"bool"),IY={kernelName:Zp,backendName:"cpu",kernelFunc:CY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A2(t,e,n,s,a){const r=e.length,i=K(e),o=ve(e),l=ve(a),u=en(n,K(a));for(let c=0;c<i;++c){const d=qo(c,r,o),p=new Array(d.length);for(let f=0;f<p.length;f++)p[f]=d[s[f]];const h=ma(p,r,l);u[h]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jn(t){const{inputs:e,attrs:n,backend:s}=t,{x:a}=e,{perm:r}=n;ge(a,"transpose");const i=a.shape.length,o=new Array(i);for(let d=0;d<o.length;d++)o[d]=a.shape[r[d]];const l=s.data.get(a.dataId).values,u=A2(l,a.shape,a.dtype,r,o);return{dataId:s.write(u,o,a.dtype),shape:o,dtype:a.dtype}}const TY={kernelName:go,backendName:"cpu",kernelFunc:Jn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k_(t,e,n,s){const[a,r]=sn(t,s),i=Un(e,"int32"),o=dn(K(a),i),l=K(r);for(let u=0;u<o.length;++u){const c=u*l;let d=1;for(let p=0;p<l;++p)d*=n[c+p];o[u]=d}return{outVals:o,outShape:a,outDtype:i}}function $Y(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;ge(a,"prod");const o=a.shape.length,l=Fe(r,a.shape),u=Nt(l,o);let c=l,d=a;const p=[];u!=null&&(d=Jn({inputs:{x:a},backend:n,attrs:{perm:u}}),p.push(d),c=Dt(c.length,o));const h=n.data.get(d.dataId).values,{outVals:f,outShape:m,outDtype:y}=k_(d.shape,d.dtype,h,c);let g=m;return i&&(g=Ot(m,l)),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(g,y,f)}const EY={kernelName:rh,backendName:"cpu",kernelFunc:$Y};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RY(t,e,n){t.forEach((s,a)=>{if(s<0||s>=n){const r=qo(a,e.length,ve(e)).join(",");throw new Error(`indices[${r}] = ${s} is not in [0, ${n})`)}})}function AY(t,e){for(let n=0;n<t.length;++n){const s=t[n],a=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>a)throw new Error("Ragged splits must not point past values");for(let r=1;r<s.length;++r)if(s[r-1]>s[r])throw new Error("Ragged splits must be sorted in ascending order")}}function OY(t,e,n,s){const a=[];let r=0;const i=e.length-1+n.length,o=new Array(i).fill(null).map(()=>[0]);AY(n,s);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)o[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let p=0;p<n.length;++p){const h=n[p],f=p+e.length-1;if(f>=0){const m=o[f],y=m[m.length-1]-h[c];for(let g=c;g<d;++g)o[f].push(h[g+1]+y)}c=h[c],d=h[d]}d!==c&&(a.push([c,d]),r+=d-c)}return{outSplits:o,valueSlices:a,numValues:r}}function DY(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,a=Tt("int32",s);e.push(a),t[n].forEach((r,i)=>a[i]=r)}return e}function XC(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function jY(t,e,n,s,a,r){const i=XC(e,2)[1],o=XC(r,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<s;++d)a[l*o+d]=t[c*i+d];++l}}function _Y(t,e,n,s,a){const r=e.slice();r[0]=a;const i=Tt(n,K(r)),o=t.length,l=o===0?0:o/e[0];return jY(t,e,s,l,i,r),[i,r]}function x_(t,e,n,s,a,r,i,o){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(RY(r,i,l),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:c,valueSlices:d,numValues:p}=OY(r,i,t,u),h=DY(c),f=_Y(n,s,a,d,p);return[h,f[0],f[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YC=2147483647;function v_(t,e,n,s,a,r,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const o=e.length===0,l=a.length===0,u=i.length===0,c=[];o||c.push(e[0]),l||c.push(a[0]),u||c.push(i[0]);for(let y=1;y<c.length;++y)if(c[y]!==c[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],p=Tt("int32",d+1);p[0]=0;for(let y=0;y<d;++y){const g=o?t[0]:t[y],b=l?s[0]:s[y],w=u?r[0]:r[y];if(w===0)throw new Error("Requires delta != 0");let k;if(w>0&&b<g||w<0&&b>g)k=0;else if(k=Math.ceil(Math.abs((b-g)/w)),k>YC)throw new Error(`Requires ((limit - start) / delta) <= ${YC}`);p[y+1]=p[y]+k}const h=p[d],f=Tt(n,h);let m=0;for(let y=0;y<d;++y){const g=p[y+1]-p[y];let b=o?t[0]:t[y];const w=u?r[0]:r[y];for(let k=0;k<g;++k)f[m++]=b,b+=w}return[p,f]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var js=ca;class tg{constructor(e,n,s,a,r,i,o,l,u,c){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=a,this.valuesDType=r,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=sO(c),this.raggedRank=aO(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===js.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===js.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case js.VALUE_ROWIDS:return tg.getMaxWidthValueRowID(n);case js.ROW_SPLITS:return tg.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${js[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let a=0;a<n-1;++a){const r=e[a+1]-e[a];r>s&&(s=r)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,a=e[0],r=0;for(let i=1;i<n;++i){const o=e[i];o!==a&&(a=o,r=Math.max(i-s,r),s=i)}return Math.max(n-s,r)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return ZC(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;rO(s,n);const a=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=nO(this.raggedRank,a,n);i[0]<0&&(i[0]=e);for(let o=1;o<=this.raggedRank;++o)i[o]<0&&(i[o]=this.getMaxWidth(o));return i}calculateFirstParentOutputIndex(e,n,s){const a=Math.min(e,s),r=[];let i=0;for(let o=0;o<a;++o,i+=n)r.push(i);for(let o=a;o<e;++o)r.push(-1);return I(r.length===e,()=>"Final length of result must be equal to firstDimension."),r}calculateOutputIndexRowSplit(e,n,s,a){const r=e.length,i=[];for(let o=0;o<r-1;++o){const l=e[o+1]-e[o];let u=Math.min(a,l),c=n[o];c===-1&&(u=0);for(let d=0;d<u;++d)i.push(c),c+=s;for(let d=0;d<l-u;++d)i.push(-1)}if(r>0&&i.length!==e[r-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,s,a){const r=e.length,i=[];if(r===0)return[];let o=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];i.push(u);for(let c=1;c<r;++c){const d=e[c];if(d===l)u>=0&&(++o,o<a?u+=s:u=-1);else{if(o=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,s,a){const r=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case js.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(r,n,s,a);case js.ROW_SPLITS:if(r.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${r.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(r,n,s,a);default:throw new Error(`Unsupported partition type: ${js[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case js.FIRST_DIM_SIZE:return e[0];case js.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case js.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${js[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),a=new Array(this.raggedRank+1);a[a.length-1]=1;for(let l=a.length-2;l>=0;--l)a[l]=a[l+1]*s[l+1];const r=ZC(s,!1),i=Tt(this.valuesDType,K(r));if(a[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,a[0],s[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,a[u],s[u]);this.setOutput(this.raggedRank,l,i,r)}return[r,i]}setOutput(e,n,s,a){if(s.length===0)return;const r=this.values,i=s;let o=a.slice();o=o.slice(e+1);const l=K(o),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const f=this.defaultValueShape;M(()=>{const m=_(c,f);c=yo(m,o).dataSync()})}let d=0,p=0,h=0;for(let f=0;f<=u;++f){let m=f<u?n[f]:-1;if(m===h){++h;continue}if(p<h){const y=r.subarray(d*l),g=i.subarray(p*l),b=(h-p)*l;QC(g,y,b)}if(f>=u){const y=s.length;m=Math.floor(y/l)}if(m>h)if(this.defaultValue.length===1)i.subarray(h*l,m*l).fill(this.defaultValue[0]),h=m;else for(;m>h;){const y=i.slice(h*l);QC(y,c,l),++h}m<0?(d=f+1,p=h):(d=f,p=h,h=p+1)}}}function QC(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function ZC(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function S_(t,e,n,s,a,r,i,o,l,u){return new tg(t,e,n,s,a,r,i,o,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N_(t,e,n,s){const a=t===e,r=t<e&&n<0,i=e<t&&n>1;if(a||r||i)return dn(0,s);const o=Math.abs(Math.ceil((e-t)/n)),l=dn(o,s);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C_=tr(t=>1/Math.sqrt(t)),FY=Ui(Zu,C_),PY={kernelName:Zu,backendName:"cpu",kernelFunc:FY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function po(t,e,n,s,a,r,i,o,l,u){const c=[s/a,a],d=t.values,p=e.values;if(s===0)return Re(n,e.dtype);const h=l instanceof Bt?l:Re(c,e.dtype);typeof l=="string"||typeof l=="number"?h.values.fill(l):typeof l=="boolean"&&h.values.fill(+l);for(let f=0;f<r;f++){const m=[];let y=0;for(let g=0;g<i;g++){const b=d[f*i+g];m.push(b),y+=b*o[g]}if(y<0||y>=s/a)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let g=0;g<a;g++)u?h.values[y*a+g]+=p[f*a+g]:h.values[y*a+g]=e.rank===0?p[0]:p[f*a+g]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LY=tr(t=>1/(1+Math.exp(-t))),I_=Qe(ac,t=>1/(1+Math.exp(-t))),BY={kernelName:ac,backendName:"cpu",kernelFunc:I_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T_(t,e,n,s,a){const r=jv(s,e,n),i=K(n),o=ve(s);if(r){const d=_v(e,o);return a==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=a==="string"?Cr(t):t,u=Re(s,a,l),c=Re(n,a);for(let d=0;d<c.size;++d){const p=c.indexToLoc(d),h=p.map((f,m)=>f+e[m]);c.set(u.get(...h),...p)}return a==="string"?CO(c.values):c.values}function Bo(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{begin:r,size:i}=s;ge(a,"slice");const[o,l]=N0(a,r,i);Ov(a,o,l);const u=n.data.get(a.dataId).values,c=T_(u,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,c)}const zY={kernelName:dh,backendName:"cpu",kernelFunc:Bo};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $_(t,e,n,s,a,r,i){const o=e[0],l=r[0],u=new Array(l),c=new Array(o),d=e[1];if(l===0){if(o!==0)throw new Error(pO(o));const y=Tt(n,0),g=Tt(a,0);return[y,[0,d],g,u,c]}let p=!0,h=0;const f=new Array(l).fill(0);for(let y=0;y<o;++y){const g=t[y*d];if(g<0)throw new Error(hO(y,g));if(g>=l)throw new Error(fO(y,g,l));++f[g],p=p&&g>=h,h=g}let m=!0;for(let y=0;y<l;++y){const g=f[y]===0;u[y]=g,m=m&&!g,f[y]=Math.max(f[y],1),y>0&&(f[y]+=f[y-1])}if(m&&p){const y=t,g=s;for(let b=0;b<o;++b)c[b]=b;return[y,[o,d],g,u,c]}else{const y=f[l-1],g=Tt(n,y*d),b=Tt(a,y),w=new Array(l).fill(0);for(let k=0;k<o;++k){const x=t[k*d],S=w[x],C=(x===0?0:f[x-1])+S;w[x]++;for(let T=0;T<d;++T)g[C*d+T]=t[k*d+T];b[C]=s[k],c[k]=C}for(let k=0;k<l;++k)if(w[k]===0){const S=k===0?0:f[k-1];g[S*d+0]=k;for(let C=1;C<d;++C)g[S*d+C]=0;b[S]=i}return[g,[y,d],b,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_(t,e,n,s,a){const r=K(s),i=e[0],o=a.length,l=[];let u=1,c=-1;for(let y=0;y<o;++y){const g=a[y];if(g===-1){if(c!==-1)throw new Error(mO(c,y));c=y,l.push(1)}else{if(g<0)throw new Error(gO(y,g));u*=g,l.push(g)}}if(c!==-1){if(u<=0)throw new Error(yO());const y=Math.trunc(r/u);if(u*y!==r)throw new Error(bO(s,l));l[c]=y}if(K(l)!==r)throw new Error(wO(s,l));const p=s.length,h=[];if(p>0){h[p-1]=1;for(let y=p-2;y>=0;--y)h[y]=h[y+1]*s[y+1]}const f=[];if(o>0){f[o-1]=1;for(let y=o-2;y>=0;--y)f[y]=f[y+1]*l[y+1]}const m=Tt(n,i*o);for(let y=0;y<i;++y){let g=0;for(let b=0;b<p;++b)g+=t[y*p+b]*h[b];for(let b=0;b<o;++b)m[y*o+b]=Math.trunc(g/f[b]),g%=f[b]}return[m,[i,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O2(t,e,n,s,a,r=!1,i=0){const o=s.length,l=[e[0],t.length/e[0]],u=l[1],d=o>0?a[o-1]+1:0;if(d<0)throw new Error(pk());const p=e.slice();p[0]=d;const h=p.reduce((w,k)=>w*k,1),f=Tt(n,h);if(o===0)return d>0&&f.fill(i),[f,p];if(d<=0)throw new Error(pk());let m=0,y=1,g=0,b=a[m];for(;;){let w=0;if(y<o){if(w=a[y],b===w){++y;continue}if(b>=w)throw new Error(kO())}if(b<0||b>=d)throw new Error(xO(b,d));b>g&&f.fill(i,g*u,b*u);for(let k=m;k<y;++k){const x=s[k];if(x<0||x>=l[0])throw new Error(vO(k,s[k],l[0]));for(let S=0;S<u;S++)f[b*u+S]+=t[x*u+S]}if(r)for(let k=0;k<u;k++)f[b*u+k]/=y-m;if(m=y,++y,g=b+1,b=w,y>o)break}return g<d&&f.fill(i,g*u,d*u),[f,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MY=tr(t=>Math.sqrt(t)),VY=Qe(ic,t=>Math.sqrt(t)),WY={kernelName:ic,backendName:"cpu",kernelFunc:VY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R_=_t((t,e)=>{const n=t-e;return n*n}),UY=qt(oc,R_),GY={kernelName:oc,backendName:"cpu",kernelFunc:UY};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A_=tr((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:a}=e;return t.replace(new RegExp(n,s?"g":""),a)}),HY=Ui(gh,A_),KY={kernelName:gh,backendName:"cpu",kernelFunc:HY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O_(t,e,n,s){const a=Re(t,e.dtype);for(let r=0;r<a.size;r++){const i=a.indexToLoc(r),o=new Array(i.length);for(let l=0;l<o.length;l++)o[l]=i[l]*n[l]+s[l];a.set(e.get(...o),...i)}return a}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qY{constructor(e,n,s,a,r,i){this.separator=Wa(e),this.nGramWidths=n,this.leftPad=Wa(s),this.rightPad=Wa(a),this.padWidth=r,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,a,r,i){for(let o=0;o<r;++o){const l=this.getPadWidth(i),u=Math.max(0,l-o),c=Math.max(0,l-(r-(o+1))),d=i-(u+c),p=n+(u>0?0:o-l);let h=0;h+=u*this.leftPad.length;for(let b=0;b<d;++b)h+=e[p+b].length;h+=c*this.rightPad.length;const f=u+c+d-1;h+=f*this.separator.length,s[a+o]=new Uint8Array(h);const m=s[a+o];let y=0;const g=b=>b.forEach(w=>m[y++]=w);for(let b=0;b<u;++b)g(this.leftPad),g(this.separator);for(let b=0;b<d-1;++b)g(e[p+b]),g(this.separator);if(d>0){g(e[p+d-1]);for(let b=0;b<c;++b)g(this.separator),g(this.rightPad)}else{for(let b=0;b<c-1;++b)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const s=e.length,a=n.length;if(a>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<a;++u){let c=n[u]>=l;if(c=c&&n[u]<=s,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${s}]`);l=n[u]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const r=a-1,i=Tt("int32",a);if(s===0||a===0){const l=new Array(s);for(let u=0;u<=r;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=r;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),i[l]=i[l-1]+c}const o=new Array(i[r]);for(let l=0;l<r;++l){const u=n[l];let c=i[l];if(this.nGramWidths.forEach(d=>{const p=n[l+1]-n[l],h=this.getNumNGrams(p,d);this.createNGrams(e,u,o,c,h,d),c+=h}),this.preserveShort&&c===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const p=d+2*this.padWidth;this.createNGrams(e,u,o,c,1,p)}}return[o,i]}}function D_(t,e,n,s,a,r,i,o){return new qY(n,s,a,r,i,o).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JY(t,e,n,s){if(!t.length)return;if(e.length===0){for(let r=0;r<t.length;++r)s.push(t.subarray(r,r+1));return}if(e.length===1){const r=e[0];let i=t.indexOf(r);for(;i!==-1;){const o=t.subarray(0,i);(!n||o.length!==0)&&s.push(o),t=t.subarray(i+1),i=t.indexOf(r)}(!n||t.length!==0)&&s.push(t);return}let a=0;for(let r=0;r<t.length+1;r++)if(r===t.length||e.indexOf(t[r])!==-1){const i=t.subarray(a,r);(!n||i.length!==0)&&s.push(i),a=r+1}}function j_(t,e,n){const s=t.length,a=[];let r=0,i=0;const o=new Array(s);for(let p=0;p<s;++p){const h=a.length;JY(t[p],e,n,a);const f=a.length-h;o[p]=f,r+=f,i=Math.max(i,f)}const l=Tt("int32",r*2),u=new Array(r),c=[s,i];let d=0;for(let p=0;p<s;++p)for(let h=0;h<o[p];++h)l[d*2]=p,l[d*2+1]=h,u[d]=a[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function __(t,e){const n=Tt("int32",t.length);for(let s=0;s<t.length;++s)n[s]=dR(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F_=_t((t,e)=>t-e),XY=$2((t,e,n,s)=>({real:t-n,imag:e-s})),D2=qt(lc,F_,XY),YY={kernelName:lc,backendName:"cpu",kernelFunc:D2};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_(t,e){const n=new Array(t.rank);for(let a=0;a<n.length;a++)n[a]=t.shape[a]*e[a];const s=Re(n,t.dtype);for(let a=0;a<s.values.length;++a){const r=s.indexToLoc(a),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=r[l]%t.shape[l];const o=t.locToIndex(i);s.values[a]=t.values[o]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ed=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function L_(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const o=s-n+1,l=e-n+1,u=Math.log(o),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(o-c)/o)*Math.sign(l-o/2),p=Math.max(n,Math.floor(e-l*c/o+d)),h=Math.min(s,Math.floor(e+(o-l)*c/o+d));L_(t,e,p,h)}const a=t[e];let r=n,i=s;for(cr(t,n,e),ed(t[s],a)>0&&cr(t,n,s);r<i;){for(cr(t,r,i),r++,i--;ed(t[r],a)<0;)r=r+1;for(;ed(t[i],a)>0;)i=i-1}ed(t[n],a)===0?cr(t,n,i):(i=i+1,cr(t,i,s)),i<=e&&(n=i+1),e<=i&&(s=i-1)}}function B_(t,e,n,s,a){const r=e[e.length-1],[i,o]=[t.length/r,r],l=en(n,i*s),u=en("int32",i*s);for(let d=0;d<i;d++){const p=d*o,h=t.subarray(p,p+o);let f=new Array(h.length);h.forEach((b,w)=>f[w]={value:b,index:w}),s<f.length&&(L_(f,s),f=f.slice(0,s)),a&&f.sort(ed);const m=d*s,y=l.subarray(m,m+s),g=u.subarray(m,m+s);for(let b=0;b<s;b++)y[b]=f[b].value,g[b]=f[b].index}const c=e.slice();return c[c.length-1]=s,[Re(c,n,l),Re(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z_(t,e,n,s){const a=Fe(e,n)[0],r=[1,n[0],1];for(let f=0;f<a;f++)r[0]*=n[f];r[1]=n[a];for(let f=a+1;f<n.length;f++)r[2]*=n[f];const i=new Map,o=new Int32Array(n[a]),l=new Bt(r,s,t),u=[],c=r[0]===1&&r[2]===1;for(let f=0;f<n[a];f++){let m;if(c)m=t[f].toString();else{const g=[];for(let b=0;b<r[0];b++)for(let w=0;w<r[2];w++)g.push(l.get(b,f,w));m=g.join(",")}const y=i.get(m);if(y!=null)o[f]=y;else{const g=i.size;i.set(m,g),o[f]=g,u.push(f)}}const d=r.slice();d[1]=i.size;const p=new Bt(d,s);u.forEach((f,m)=>{for(let y=0;y<r[0];y++)for(let g=0;g<r[2];g++)p.set(l.get(y,f,g),y,m,g)});const h=n.slice();return h[a]=d[1],{outputValues:p.values,outputShape:h,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QY=Object.freeze(Object.defineProperty({__proto__:null,addImpl:Jj,bincountImpl:E2,bincountReduceImpl:Xj,bitwiseAndImpl:Yj,castImpl:qj,ceilImpl:Qj,concatImpl:Zj,equalImpl:e_,expImpl:n_,expm1Impl:a_,floorDivImpl:i_,floorImpl:r_,gatherNdImpl:o_,gatherV2Impl:l_,greaterEqualImpl:c_,greaterImpl:u_,lessEqualImpl:p_,lessImpl:d_,linSpaceImpl:h_,logImpl:f_,maxImpl:m_,maximumImpl:g_,minimumImpl:y_,multiplyImpl:R2,negImpl:b_,notEqualImpl:w_,prodImpl:k_,raggedGatherImpl:x_,raggedRangeImpl:v_,raggedTensorToTensorImpl:S_,rangeImpl:N_,rsqrtImpl:C_,scatterImpl:po,sigmoidImpl:LY,simpleAbsImpl:Kj,sliceImpl:T_,sparseFillEmptyRowsImpl:$_,sparseReshapeImpl:E_,sparseSegmentReductionImpl:O2,sqrtImpl:MY,squaredDifferenceImpl:R_,staticRegexReplaceImpl:A_,stridedSliceImpl:O_,stringNGramsImpl:D_,stringSplitImpl:j_,stringToHashBucketFastImpl:__,subImpl:F_,tileImpl:P_,topKImpl:B_,transposeImpl:A2,uniqueImpl:z_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */o1("cpu",()=>new L0,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M_=Qe(Au,t=>t>=0?t:Math.exp(t)-1),ZY={kernelName:Au,backendName:"cpu",kernelFunc:M_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{alpha:r}=s;ge([a],"leakyRelu");const i=K(a.shape),o=n.data.get(a.dataId).values,l=en("float32",i);for(let u=0;u<o.length;u++)l[u]=o[u]<0?r*o[u]:o[u];return n.makeTensorInfo(a.shape,"float32",l)}const eQ={kernelName:Bp,backendName:"cpu",kernelFunc:V_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tQ=_t((t,e)=>t<0?e*t:t);function W_(t){const{inputs:e,backend:n}=t,{x:s,alpha:a}=e;ge([s,a],"prelu");const r=n.data.get(s.dataId).values,i=n.data.get(a.dataId).values,[o,l]=tQ(s.shape,a.shape,r,i,"float32");return n.makeTensorInfo(l,"float32",o)}const nQ={kernelName:ah,backendName:"cpu",kernelFunc:W_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_=Qe(Xu,t=>Math.max(0,t)),sQ={kernelName:Xu,backendName:"cpu",kernelFunc:U_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G_=Qe(Yu,t=>Math.min(Math.max(0,t),6)),aQ={kernelName:Yu,backendName:"cpu",kernelFunc:G_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ng(t,e,n,s,a){if(n==="linear")return Za({inputs:{x:e},backend:t});if(n==="relu")return U_({inputs:{x:e},backend:t});if(n==="elu")return M_({inputs:{x:e},backend:t});if(n==="relu6")return G_({inputs:{x:e},backend:t});if(n==="prelu")return W_({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return V_({inputs:{x:e},backend:t,attrs:{alpha:a}});if(n==="sigmoid")return I_({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lt(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{shape:r}=s,i=K(a.shape),o=Xx(r,i),l=K(o);I(i===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${a.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(a.dataId);const u=n.data.get(a.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=o,d.shape=o}return{dataId:a.dataId,shape:o,dtype:a.dtype}}const rQ={kernelName:ih,backendName:"cpu",kernelFunc:lt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_(t){const{inputs:e,backend:n,attrs:s}=t,{a,b:r}=e,{transposeA:i,transposeB:o}=s;ge([a,r],"matMul");const l=a.shape.length,u=r.shape.length,c=i?a.shape[l-2]:a.shape[l-1],d=o?r.shape[u-1]:r.shape[u-2],p=i?a.shape[l-1]:a.shape[l-2],h=o?r.shape[u-2]:r.shape[u-1],f=a.shape.slice(0,-2),m=r.shape.slice(0,-2),y=K(f),g=K(m),w=Te(a.shape.slice(0,-2),r.shape.slice(0,-2)).concat([p,h]);I(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${a.shape} and ${r.shape} and transposeA=${i} and transposeB=${o} must match.`);const k=i?[y,c,p]:[y,p,c],x=o?[g,h,d]:[g,d,h],S=lt({inputs:{x:a},backend:n,attrs:{shape:k}}),C=lt({inputs:{x:r},backend:n,attrs:{shape:x}}),T=i?S.shape[1]:S.shape[2],E=i?S.shape[2]:S.shape[1],R=o?C.shape[1]:C.shape[2],L=Math.max(y,g),U=n.data.get(S.dataId).values,G=n.data.get(C.dataId).values,F=ve(S.shape),z=ve(C.shape),[H,X,j]=i?[F[0],1,F[1]]:[F[0],F[1],1],[V,q,Y]=o?[1,z[1],z[0]]:[z[1],1,z[0]],Z=E*R,ne=Re([L,E,R],S.dtype),re=ne.values,ae=n.blockSize;for(let ce=0;ce<L;ce++){const we=ce%y,Ce=ce%g;for(let Ne=0;Ne<E;Ne+=ae){const Ae=Math.min(Ne+ae,E);for(let De=0;De<R;De+=ae){const Je=Math.min(De+ae,R);for(let at=0;at<T;at+=ae){const Ct=Math.min(at+ae,T);for(let rt=Ne;rt<Ae;rt++)for(let Ze=De;Ze<Je;Ze++){let yt=0;for(let pt=at;pt<Ct;pt++){const nr=U[we*H+rt*X+pt*j],an=G[pt*V+Ze*q+Ce*Y];yt+=nr*an}re[ce*Z+(rt*R+Ze)]+=yt}}}}}return n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(C),n.makeTensorInfo(w,ne.dtype,ne.values)}const iQ={kernelName:Sp,backendName:"cpu",kernelFunc:H_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oQ(t){const{inputs:e,backend:n,attrs:s}=t,{a,b:r,bias:i,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=s;let p,h,f;const m=[];p=H_({inputs:{a,b:r},attrs:{transposeA:l,transposeB:u},backend:n}),i&&(h=ou({inputs:{a:p,b:i},backend:n}),m.push(p),p=h),c&&(f=ng(n,p,c,o,d),m.push(p),p=f);for(const g of m)n.disposeIntermediateTensorInfo(g);return p}const lQ={kernelName:Bd,backendName:"cpu",kernelFunc:oQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uQ=Qe(bu,t=>Math.acos(t)),cQ={kernelName:bu,backendName:"cpu",kernelFunc:uQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dQ=Qe(wu,t=>Math.acosh(t)),pQ={kernelName:wu,backendName:"cpu",kernelFunc:dQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hQ(t){const{inputs:e,backend:n}=t,s=e;ge(e,"addN");const a=s.map(o=>n.data.get(o.dataId).values),r=Re(s[0].shape,s[0].dtype),i=r.values;for(let o=0;o<s.length;o++){const l=a[o];for(let u=0;u<i.length;u++)i[u]+=l[u]}return n.makeTensorInfo(r.shape,r.dtype,r.values)}const fQ={kernelName:bp,backendName:"cpu",kernelFunc:hQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;ge(a,"all");const o=Fe(r,a.shape);let l=o;const u=Nt(l,a.shape.length);let c=a;u!=null&&(c=Jn({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Dt(l.length,a.shape.length)),fn("all",l,c.shape.length);const[d,p]=sn(c.shape,l),h=K(p),f=dn(K(d),c.dtype),m=n.data.get(c.dataId).values;for(let g=0;g<f.length;++g){const b=g*h;let w=m[b];for(let k=0;k<h;++k){const x=m[b+k];w=w&&x}f[g]=w}u!=null&&n.disposeIntermediateTensorInfo(c);const y=n.makeTensorInfo(d,c.dtype,f);if(i){const g=Ot(d,o),b=lt({inputs:{x:y},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(y),b}return y}const gQ={kernelName:Dg,backendName:"cpu",kernelFunc:mQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;ge(a,"any");const o=Fe(r,a.shape);let l=o;const u=Nt(l,a.shape.length);let c=a;u!=null&&(c=Jn({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Dt(l.length,a.shape.length)),fn("any",l,c.shape.length);const[d,p]=sn(c.shape,l),h=K(p),f=dn(K(d),c.dtype),m=n.data.get(c.dataId).values;for(let g=0;g<f.length;++g){const b=g*h;let w=m[b];for(let k=0;k<h;++k){const x=m[b+k];w=w||x}f[g]=w}u!=null&&n.disposeIntermediateTensorInfo(c);const y=n.makeTensorInfo(d,c.dtype,f);if(i){const g=Ot(d,o),b=lt({inputs:{x:y},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(y),b}return y}const bQ={kernelName:jg,backendName:"cpu",kernelFunc:yQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r}=s;ge(a,"argMax");let i=Fe(r,a.shape);const o=Nt(i,a.shape.length);let l=a;const u=[];o!=null&&(l=Jn({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),i=Dt(i.length,l.shape.length)),i=[i[0]],fn("argMax",i,l.shape.length);const[c,d]=sn(l.shape,i),p=K(c),h=dn(p,"int32"),f=K(d),m=n.data.get(l.dataId).values;for(let y=0;y<h.length;++y){const g=y*f;let b=m[g],w=0;for(let k=0;k<f;++k){const x=m[g+k];x>b&&(b=x,w=k)}h[y]=w}return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(c,"int32",h)}const kQ={kernelName:wp,backendName:"cpu",kernelFunc:wQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r}=s;ge(a,"argMin");let i=Fe(r,a.shape);const o=Nt(i,a.shape.length);let l=a;const u=[];o!=null&&(l=Jn({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),i=Dt(i.length,l.shape.length)),i=[i[0]],fn("argMin",i,l.shape.length);const[c,d]=sn(l.shape,i),p=K(c),h=dn(p,"int32"),f=K(d),m=n.data.get(l.dataId).values;for(let y=0;y<h.length;++y){const g=y*f;let b=m[g],w=0;for(let k=0;k<f;++k){const x=m[g+k];x<b&&(b=x,w=k)}h[y]=w}return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(c,"int32",h)}const vQ={kernelName:kp,backendName:"cpu",kernelFunc:xQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SQ=Qe(ku,t=>Math.asin(t)),NQ={kernelName:ku,backendName:"cpu",kernelFunc:SQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CQ=Qe(xu,t=>Math.asinh(t)),IQ={kernelName:xu,backendName:"cpu",kernelFunc:CQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TQ=Qe(vu,t=>Math.atan(t)),$Q={kernelName:vu,backendName:"cpu",kernelFunc:TQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EQ=_t((t,e)=>Math.atan2(t,e)),RQ=qt(Nu,EQ),AQ={kernelName:Nu,backendName:"cpu",kernelFunc:RQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OQ=Qe(Su,t=>Math.atanh(t)),DQ={kernelName:Su,backendName:"cpu",kernelFunc:OQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j2(t,e,n,s,a,r){const i=a.strideHeight,o=a.strideWidth,l=a.dilationHeight,u=a.dilationWidth,c=a.effectiveFilterHeight,d=a.effectiveFilterWidth,p=a.padInfo.top,h=a.padInfo.left,f=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Re(a.outShape,n),y=m.values,g=a.outShape[1]*a.outShape[2]*a.outShape[3],b=a.outShape[2]*a.outShape[3],w=a.outShape[3];for(let k=0;k<a.batchSize;++k){const x=k*g,S=k*s[0];for(let C=0;C<a.inChannels;++C)for(let T=0;T<a.outHeight;++T){const E=T*i-p,R=Math.max(0,E),L=Math.min(a.inHeight,c+E),U=x+T*b;for(let G=0;G<a.outWidth;++G){const F=G*o-h,z=Math.max(0,F),H=Math.min(a.inWidth,d+F);let X=f,j=0,V=0;for(let Y=R;Y<L;Y+=l){const Z=S+Y*s[1];for(let ne=z;ne<H;ne+=u){const re=Z+ne*s[2],ae=t[re+C];r==="max"&&ae>X?X=ae:r==="avg"&&(j+=ae,V++)}if(isNaN(X))break}const q=U+G*w+C;y[q]=r==="avg"?j/V:X}}}return m}function K_(t,e,n,s,a=!1,r=!1){const i=Re(s.outShape,"int32"),o=s.strideHeight,l=s.strideWidth,u=s.dilationHeight,c=s.dilationWidth,d=s.effectiveFilterHeight,p=s.effectiveFilterWidth,h=s.padInfo.top,f=s.padInfo.left,m=Re(e,n,t);for(let y=0;y<s.batchSize;++y)for(let g=0;g<s.inChannels;++g)for(let b=0;b<s.outHeight;++b){const w=b*o-h;let k=w;for(;k<0;)k+=u;const x=Math.min(s.inHeight,d+w);for(let S=0;S<s.outWidth;++S){const C=S*l-f;let T=C;for(;T<0;)T+=c;const E=Math.min(s.inWidth,p+C);let R=Number.NEGATIVE_INFINITY,L=-1;for(let U=k;U<x;U+=u){const G=U-w;for(let F=T;F<E;F+=c){const z=F-C,H=m.get(y,U,F,g);H>R&&(R=H,a?L=r?((y*s.inHeight+U)*s.inWidth+F)*s.inChannels+g:(U*s.inWidth+F)*s.inChannels+g:L=G*p+z)}}i.set(L,y,b,S,g)}}return i}function q_(t,e,n,s,a,r){const i=a.strideDepth,o=a.strideHeight,l=a.strideWidth,u=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,p=a.effectiveFilterDepth,h=a.effectiveFilterHeight,f=a.effectiveFilterWidth,m=a.padInfo.front,y=a.padInfo.top,g=a.padInfo.left,b=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=Re(a.outShape,n),k=w.values,x=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],S=a.outShape[2]*a.outShape[3]*a.outShape[4],C=a.outShape[3]*a.outShape[4],T=a.outShape[4];for(let E=0;E<a.batchSize;++E){const R=E*x,L=E*s[0];for(let U=0;U<a.inChannels;++U)for(let G=0;G<a.outDepth;++G){const F=G*i-m;let z=F;for(;z<0;)z+=u;const H=Math.min(a.inDepth,p+F),X=R+G*S;for(let j=0;j<a.outHeight;++j){const V=j*o-y;let q=V;for(;q<0;)q+=c;const Y=Math.min(a.inHeight,h+V),Z=X+j*C;for(let ne=0;ne<a.outWidth;++ne){const re=ne*l-g;let ae=re;for(;ae<0;)ae+=d;const ce=Math.min(a.inWidth,f+re),we=Z+ne*T;let Ce=b,Ne=0,Ae=0;for(let Je=z;Je<H;Je+=u){const at=L+Je*s[1];for(let Ct=q;Ct<Y;Ct+=c){const rt=at+Ct*s[2];for(let Ze=ae;Ze<ce;Ze+=d){const yt=rt+Ze*s[3],pt=t[yt+U];if(r==="max"&&pt>Ce?Ce=pt:r==="avg"&&(Ne+=pt,Ae++),isNaN(Ce))break}if(isNaN(Ce))break}if(isNaN(Ce))break}const De=we+U;k[De]=r==="avg"?Ne/Math.max(Ae,1):Ce}}}}return w}function jQ(t,e){const n=Re(e.outShape,"int32"),s=e.strideDepth,a=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.front,h=e.padInfo.top,f=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let y=0;y<e.inChannels;++y)for(let g=0;g<e.outDepth;++g){const b=g*s-p;let w=b;for(;w<0;)w+=i;const k=Math.min(e.inDepth,u+b);for(let x=0;x<e.outHeight;++x){const S=x*a-h;let C=S;for(;C<0;)C+=o;const T=Math.min(e.inHeight,c+S);for(let E=0;E<e.outWidth;++E){const R=E*r-f;let L=R;for(;L<0;)L+=l;const U=Math.min(e.inWidth,d+R);let G=Number.NEGATIVE_INFINITY,F=-1;for(let z=w;z<k;z+=i){const H=z-b;for(let X=C;X<T;X+=o){const j=X-S;for(let V=L;V<U;V+=l){const q=V-R,Y=t.get(m,z,X,V,y);Y>=G&&(G=Y,F=H*c*d+j*c+q)}}}n.set(F,m,g,x,E,y)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;ge(a,"avgPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=s,u=1;I(hn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Ys(a.shape,r,i,u,o,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&Le(c.inShape,c.outShape))d=Za({inputs:{x:a},backend:n});else{const p=n.data.get(a.dataId).values,h=ve(a.shape),f=j2(p,a.shape,a.dtype,h,c,"avg");d=n.makeTensorInfo(c.outShape,a.dtype,f.values)}return d}const FQ={kernelName:xp,backendName:"cpu",kernelFunc:_Q};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:l,dataFormat:u}=s;ge(a,"avgPool3d");const c=Rr(a.shape,r,i,1,o,l,u),d=n.data.get(a.dataId).values,p=q_(d,a.shape,a.dtype,ve(a.shape),c,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}const LQ={kernelName:vp,backendName:"cpu",kernelFunc:PQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,{filterSize:i,strides:o,pad:l,dimRoundingMode:u}=s;ge([a,r],"avgPool3DGrad");const c=Rr(r.shape,i,o,1,l,u),d=c.strideDepth,p=c.strideHeight,h=c.strideWidth,f=c.filterDepth,m=c.filterHeight,y=c.filterWidth,g=c.dilationDepth,b=c.dilationHeight,w=c.dilationWidth,k=c.effectiveFilterDepth,x=c.effectiveFilterHeight,S=c.effectiveFilterWidth,C=k-1-c.padInfo.front,T=S-1-c.padInfo.left,E=x-1-c.padInfo.top,R=Re(r.shape,"float32"),L=1/(f*m*y),U=n.bufferSync(a);for(let G=0;G<c.batchSize;++G)for(let F=0;F<c.inChannels;++F)for(let z=0;z<c.inDepth;++z)for(let H=0;H<c.inHeight;++H)for(let X=0;X<c.inWidth;++X){const j=z-C,V=H-E,q=X-T;let Y=0;for(let Z=0;Z<k;Z+=g){const ne=(j+Z)/d;if(!(ne<0||ne>=c.outDepth||Math.floor(ne)!==ne))for(let re=0;re<x;re+=b){const ae=(V+re)/p;if(!(ae<0||ae>=c.outHeight||Math.floor(ae)!==ae))for(let ce=0;ce<S;ce+=w){const we=(q+ce)/h;if(we<0||we>=c.outWidth||Math.floor(we)!==we)continue;const Ce=U.get(G,ne,ae,we,F);Y+=Ce}}}R.set(Y*L,G,z,H,X,F)}return n.makeTensorInfo(R.shape,R.dtype,R.values)}const zQ={kernelName:Fg,backendName:"cpu",kernelFunc:BQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MQ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,i=r;ge([a,r],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=s,c=Ys(i.shape,o,l,1,u),d=c.strideHeight,p=c.strideWidth,h=c.filterHeight,f=c.filterWidth,m=c.dilationHeight,y=c.dilationWidth,g=c.effectiveFilterHeight,b=c.effectiveFilterWidth,w=b-1-c.padInfo.left,k=g-1-c.padInfo.top,x=Re(i.shape,"float32"),S=1/(h*f),C=n.data.get(a.dataId).values,T=Re(a.shape,"float32",C);for(let E=0;E<c.batchSize;++E)for(let R=0;R<c.inChannels;++R)for(let L=0;L<c.inHeight;++L)for(let U=0;U<c.inWidth;++U){const G=L-k,F=U-w;let z=0;for(let H=0;H<g;H+=m){const X=(G+H)/d;if(!(X<0||X>=c.outHeight||Math.floor(X)!==X))for(let j=0;j<b;j+=y){const V=(F+j)/p;if(V<0||V>=c.outWidth||Math.floor(V)!==V)continue;const q=T.get(E,X,V,R);z+=q}}x.set(z*S,E,L,U,R)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const VQ={kernelName:_g,backendName:"cpu",kernelFunc:MQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,scale:r,offset:i,mean:o,variance:l}=e;I(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),I(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),I(r==null||o.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),ge([a,o,l,r,i],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const c=n.data.get(a.dataId).values,d=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,h=r?n.data.get(r.dataId).values:new Float32Array([1]),f=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(c.length),y=f.length,g=h.length,b=p.length,w=d.length;let k=0,x=0,S=0,C=0;for(let T=0;T<c.length;++T)m[T]=f[k++]+(c[T]-d[x++])*h[S++]/Math.sqrt(p[C++]+u),k>=y&&(k=0),x>=w&&(x=0),S>=g&&(S=0),C>=b&&(C=0);return n.makeTensorInfo(a.shape,a.dtype,m)}const UQ={kernelName:Fp,backendName:"cpu",kernelFunc:WQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockShape:r,crops:i}=s;ge([a],"batchToSpaceND");const o=r.reduce((g,b)=>g*b),l=zh(a.shape,r,o),u=Mh(l.length,r.length),c=Vh(a.shape,r,o),d=Mv(i,r.length),p=Vv(c,i,r.length),h=lt({inputs:{x:a},backend:n,attrs:{shape:l}}),f=Jn({inputs:{x:h},backend:n,attrs:{perm:u}}),m=lt({inputs:{x:f},backend:n,attrs:{shape:c}}),y=Bo({inputs:{x:m},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),y}const HQ={kernelName:Np,backendName:"cpu",kernelFunc:GQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,weights:r}=e,{size:i}=s,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,u=E2(o,l,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,u)}const qQ={kernelName:Pg,backendName:"cpu",kernelFunc:KQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JQ(t){const{inputs:e,backend:n}=t,{s0:s,s1:a}=e,r=n.data.get(s.dataId).values,i=n.data.get(a.dataId).values,o=Te(Array.from(r),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const XQ={kernelName:Lg,backendName:"cpu",kernelFunc:JQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YQ=Qe(Tu,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),QQ={kernelName:Tu,backendName:"cpu",kernelFunc:YQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZQ=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(K(e.shape)),a=n.data.get(e.dataId),r=a.complexTensorInfos.real,i=a.complexTensorInfos.imag,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values;for(let u=0;u<o.length;u++){const c=o[u],d=l[u];s[u]=Math.hypot(c,d)}return n.makeOutput(s,e.shape,"float32")},eZ={kernelName:Ip,backendName:"cpu",kernelFunc:ZQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lu(t){const{inputs:e,backend:n}=t,{input:s}=e,a=n.data.get(s.dataId).complexTensorInfos.imag,r=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,r)}const tZ={kernelName:ay,backendName:"cpu",kernelFunc:lu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uu(t){const{inputs:e,backend:n,attrs:s}=t,{axis:a}=s,r=Fe(a,e[0].shape)[0],i=e.map(m=>m.shape);Lv(i,r);let o=Ga(e.map(m=>m.shape),r);if(K(o)===0)return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(m=>K(m.shape)>0);if(l.length===1)return Za({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(k=>Lo({inputs:{input:k},backend:n})),y=l.map(k=>lu({inputs:{input:k},backend:n})),g=uu({inputs:m,backend:n,attrs:{axis:r}}),b=uu({inputs:y,backend:n,attrs:{axis:r}}),w=as({inputs:{real:g,imag:b},backend:n});return m.forEach(k=>n.disposeIntermediateTensorInfo(k)),y.forEach(k=>n.disposeIntermediateTensorInfo(k)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),w}const u=l.map(m=>{const g=[-1,K(m.shape.slice(r))];return lt({inputs:{x:m},backend:n,attrs:{shape:g}})}),c=u.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));o=Ga(u.map(m=>m.shape),1);const d=u[0].shape[0]===1,p=Zj(c,o,e[0].dtype,d),h=Ga(l.map(m=>m.shape),r),f=n.makeTensorInfo(h,e[0].dtype,p);return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const nZ={kernelName:Tp,backendName:"cpu",kernelFunc:uu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=s;ge([a,r],"conv2d");const d=Ar(l),p=nn(a.shape,r.shape,i,u,o,c,!1,d),h=p.filterHeight,f=p.filterWidth,m=p.dilationHeight,y=p.dilationWidth,g=p.padInfo.left,b=p.padInfo.top,w=p.dataFormat==="channelsLast",k=new Bt(p.outShape,a.dtype),x=ve(a.shape),S=ve(r.shape),C=x[0],T=w?x[1]:x[2],E=w?x[2]:1,R=w?1:x[1],L=k.strides[0],U=w?k.strides[1]:k.strides[2],G=w?k.strides[2]:1,F=w?1:k.strides[1],z=n.data.get(a.dataId).values,H=n.data.get(r.dataId).values,X=k.values;for(let j=0;j<p.batchSize;++j){const V=j*C,q=j*L;for(let Y=0;Y<p.outHeight;++Y){const Z=q+Y*U,ne=Y*p.strideHeight-b;for(let re=0;re<h;++re){const ae=ne+re*m;if(ae<0||ae>=p.inHeight)continue;const ce=re*S[0],we=V+ae*T;for(let Ce=0;Ce<p.outWidth;++Ce){const Ne=Z+Ce*G,Ae=Ce*p.strideWidth-g;for(let De=0;De<f;++De){const Je=Ae+De*y;if(Je<0||Je>=p.inWidth)continue;const at=ce+De*S[1],Ct=we+Je*E;let rt=at;for(let Ze=0;Ze<p.inChannels;++Ze){const yt=z[Ct+Ze*R];for(let pt=0;pt<p.outChannels;++pt)X[Ne+pt*F]+=yt*H[rt+pt];rt+=p.outChannels}}}}}}return n.makeTensorInfo(k.shape,k.dtype,X)}const sZ={kernelName:$p,backendName:"cpu",kernelFunc:J_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=s;ge([a,r],"conv2dBackpropFilter");const d=Ar(l),p=nn(a.shape,c,i,1,o,u,!1,d),{strideHeight:h,strideWidth:f,filterHeight:m,filterWidth:y}=p,g=p.dataFormat==="channelsLast",b=new Bt(p.filterShape,"float32"),w=p.padInfo.left,k=p.padInfo.top,x=n.data.get(a.dataId).values,S=n.data.get(r.dataId).values,C=new Bt(a.shape,a.dtype,x),T=new Bt(r.shape,r.dtype,S);for(let E=0;E<m;++E){const R=Math.max(0,Math.ceil((k-E)/h)),L=Math.min(p.outHeight,(p.inHeight+k-E)/h);for(let U=0;U<y;++U){const G=Math.max(0,Math.ceil((w-U)/f)),F=Math.min(p.outWidth,(p.inWidth+w-U)/f);for(let z=0;z<p.inChannels;++z)for(let H=0;H<p.outChannels;++H){let X=0;for(let j=0;j<p.batchSize;++j)for(let V=R;V<L;++V){const q=E+V*h-k;for(let Y=G;Y<F;++Y){const Z=U+Y*f-w;g?X+=C.get(j,q,Z,z)*T.get(j,V,Y,H):X+=C.get(j,z,q,Z)*T.get(j,H,V,Y)}}b.set(X,E,U,z,H)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const rZ={kernelName:zg,backendName:"cpu",kernelFunc:aZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iZ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{inputShape:i,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=s;ge([a,r],"conv2dBackpropInput");const d=ve(r.shape),p=ve(a.shape);let h=Ar(u);const f=nn(i,r.shape,o,1,l,c,!1,h),m=new Bt(f.inShape,"float32"),y=m.values,g=n.data.get(a.dataId).values,b=n.data.get(r.dataId).values,[w,k,x]=d,{batchSize:S,filterHeight:C,filterWidth:T,inChannels:E,inHeight:R,inWidth:L,outChannels:U,outHeight:G,outWidth:F,strideHeight:z,strideWidth:H}=f;h=f.dataFormat;const X=C-1-f.padInfo.top,j=T-1-f.padInfo.left,V=h==="channelsLast",q=m.strides[0],Y=V?m.strides[1]:m.strides[2],Z=V?m.strides[2]:1,ne=V?1:m.strides[1],re=p[0],ae=V?p[1]:p[2],ce=V?p[2]:1,we=V?1:p[1];for(let Ce=0;Ce<S;++Ce)for(let Ne=0;Ne<E;++Ne)for(let Ae=0;Ae<R;++Ae){const De=Ae-X,Je=Math.max(0,Math.ceil(De/z)),at=Math.min(G,(C+De)/z);for(let Ct=0;Ct<L;++Ct){const rt=Ct-j,Ze=Math.max(0,Math.ceil(rt/H)),yt=Math.min(F,(T+rt)/H);let pt=0;for(let an=Je;an<at;++an){const Pr=an*z-De;for(let ys=Ze;ys<yt;++ys){const Hi=ys*H-rt,ea=re*Ce+ae*an+ce*ys,sr=w*(C-1-Pr)+k*(T-1-Hi)+x*Ne;for(let Lr=0;Lr<U;++Lr){const Br=g[ea+we*Lr],zr=b[sr+Lr];pt+=Br*zr}}}const nr=q*Ce+Y*Ae+Z*Ct+ne*Ne;y[nr]=pt}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const oZ={kernelName:Ep,backendName:"cpu",kernelFunc:iZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l}=s;ge([a,r],"conv3d");const u=Pi(a.shape,r.shape,i,l,o),{filterDepth:c,filterHeight:d,filterWidth:p,dilationDepth:h,dilationHeight:f,dilationWidth:m,padInfo:y}=u,g=y.front,b=y.left,w=y.top,k=new Bt(u.outShape,a.dtype),x=n.data.get(a.dataId).values,S=n.data.get(r.dataId).values,C=k.values,T=ve(a.shape),E=ve(r.shape);for(let R=0;R<u.batchSize;++R){const L=R*T[0],U=R*k.strides[0];for(let G=0;G<u.outDepth;++G){const F=U+G*k.strides[1],z=G*u.strideDepth-g;for(let H=0;H<c;++H){const X=z+H*h;if(X<0||X>=u.inDepth)continue;const j=H*E[0],V=L+X*T[1];for(let q=0;q<u.outHeight;++q){const Y=F+q*k.strides[2],Z=q*u.strideHeight-w;for(let ne=0;ne<d;++ne){const re=Z+ne*f;if(re<0||re>=u.inHeight)continue;const ae=j+ne*E[1],ce=V+re*T[2];for(let we=0;we<u.outWidth;++we){const Ce=Y+we*u.outChannels,Ne=we*u.strideWidth-b;for(let Ae=0;Ae<p;++Ae){const De=Ne+Ae*m;if(De<0||De>=u.inWidth)continue;const Je=ae+Ae*E[2],at=ce+De*u.inChannels;let Ct=Je;for(let rt=0;rt<u.inChannels;++rt){const Ze=x[at+rt];for(let yt=0;yt<u.outChannels;++yt)C[Ce+yt]+=Ze*S[Ct+yt];Ct+=u.outChannels}}}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const uZ={kernelName:Rp,backendName:"cpu",kernelFunc:lZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,pad:o,filterShape:l}=s;ge([a,r],"conv3dBackpropFilterV2");const u=ve(a.shape),c=ve(r.shape),d=Pi(a.shape,l,i,1,o),p=d.strideDepth,h=d.strideHeight,f=d.strideWidth,m=d.filterDepth,y=d.filterHeight,g=d.filterWidth,b=new Bt(d.filterShape,"float32"),w=b.values,[k,x,S,C]=b.strides,T=n.data.get(r.dataId).values,[E,R,L,U]=c,G=n.data.get(a.dataId).values,[F,z,H,X]=u,j=d.padInfo.front,V=d.padInfo.left,q=d.padInfo.top;for(let Y=0;Y<m;++Y){const Z=Math.max(0,Math.ceil((j-Y)/p)),ne=Math.min(d.outDepth,(d.inDepth+j-Y)/p),re=Y*k;for(let ae=0;ae<y;++ae){const ce=Math.max(0,Math.ceil((q-ae)/h)),we=Math.min(d.outHeight,(d.inHeight+q-ae)/h),Ce=ae*x+re;for(let Ne=0;Ne<g;++Ne){const Ae=Math.max(0,Math.ceil((V-Ne)/f)),De=Math.min(d.outWidth,(d.inWidth+V-Ne)/f),Je=Ne*S+Ce;for(let at=0;at<d.inChannels;++at){const Ct=at*C+Je;for(let rt=0;rt<d.outChannels;++rt){let Ze=0;for(let yt=0;yt<d.batchSize;++yt){const pt=yt*F,nr=yt*E;for(let an=Z;an<ne;++an){const ys=(Y+an*p-j)*z+pt,Hi=an*R+nr;for(let ea=ce;ea<we;++ea){const Lr=(ae+ea*h-q)*H+ys,Br=ea*L+Hi;for(let zr=Ae;zr<De;++zr){const G0=(Ne+zr*f-V)*X+Lr,H0=zr*U+Br;Ze+=G[G0+at]*T[H0+rt]}}}}w[Ct+rt]=Ze}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const dZ={kernelName:Mg,backendName:"cpu",kernelFunc:cZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pZ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{pad:i,strides:o,inputShape:l}=s;ge([a],"conv3dBackpropInputV2");const u=ve(a.shape),c=ve(r.shape),d=Pi(l,r.shape,o,1,i),p=new Bt(d.inShape,"float32"),h=p.values,[f,m,y,g]=p.strides,b=n.data.get(a.dataId).values,[w,k,x,S]=u,C=n.data.get(r.dataId).values,[T,E,R,L]=c,{batchSize:U,filterDepth:G,filterHeight:F,filterWidth:z,inChannels:H,inDepth:X,inHeight:j,inWidth:V,outChannels:q,outDepth:Y,outHeight:Z,outWidth:ne,strideDepth:re,strideHeight:ae,strideWidth:ce}=d,we=G-1-d.padInfo.front,Ce=F-1-d.padInfo.top,Ne=z-1-d.padInfo.left;for(let Ae=0;Ae<U;++Ae)for(let De=0;De<H;++De)for(let Je=0;Je<X;++Je){const at=Je-we,Ct=Math.max(0,Math.ceil(at/re)),rt=Math.min(Y,(G+at)/re);for(let Ze=0;Ze<j;++Ze){const yt=Ze-Ce,pt=Math.max(0,Math.ceil(yt/ae)),nr=Math.min(Z,(F+yt)/ae);for(let an=0;an<V;++an){const Pr=an-Ne,ys=Math.max(0,Math.ceil(Pr/ce)),Hi=Math.min(ne,(z+Pr)/ce);let ea=0;for(let sr=Ct;sr<rt;++sr){const Lr=sr*re-at;for(let Br=pt;Br<nr;++Br){const zr=Br*ae-yt;for(let Ec=ys;Ec<Hi;++Ec){const G0=Ec*ce-Pr,H0=w*Ae+k*sr+x*Br+S*Ec,Y3=T*(G-1-Lr)+E*(F-1-zr)+R*(z-1-G0)+L*De;for(let sf=0;sf<q;++sf){const Q3=b[H0+sf],Z3=C[Y3+sf];ea+=Q3*Z3}}}}h[f*Ae+m*Je+y*Ze+g*an+De]=ea}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const hZ={kernelName:Vg,backendName:"cpu",kernelFunc:pZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fZ=Qe($u,t=>Math.cos(t)),mZ={kernelName:$u,backendName:"cpu",kernelFunc:fZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gZ=Qe(Eu,t=>Math.cosh(t)),yZ={kernelName:Eu,backendName:"cpu",kernelFunc:gZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bZ(t){const{inputs:e,backend:n,attrs:s}=t,{image:a,boxes:r,boxInd:i}=e,{cropSize:o,method:l,extrapolationValue:u}=s,[c,d,p,h]=a.shape,f=r.shape[0],[m,y]=o,g=Re([f,m,y,h],"float32"),b=n.data.get(r.dataId).values,w=n.data.get(i.dataId).values,k=n.data.get(a.dataId).values,x=ve(a.shape),S=ve(g.shape);for(let C=0;C<f;C++){const T=C*4,E=b[T],R=b[T+1],L=b[T+2],U=b[T+3],G=w[C];if(G>=c)continue;const F=m>1?(L-E)*(d-1)/(m-1):0,z=y>1?(U-R)*(p-1)/(y-1):0;for(let H=0;H<m;H++){const X=m>1?E*(d-1)+H*F:.5*(E+L)*(d-1);if(X<0||X>d-1){for(let j=0;j<y;j++)for(let V=0;V<h;V++){const q=V+j*S[2]+H*S[1]+C*S[0];g.values[q]=u}continue}if(l==="bilinear"){const j=Math.floor(X),V=Math.ceil(X),q=X-j;for(let Y=0;Y<y;Y++){const Z=y>1?R*(p-1)+Y*z:.5*(R+U)*(p-1);if(Z<0||Z>p-1){for(let ce=0;ce<h;ce++){const we=ce+Y*S[2]+H*S[1]+C*S[0];g.values[we]=u}continue}const ne=Math.floor(Z),re=Math.ceil(Z),ae=Z-ne;for(let ce=0;ce<h;ce++){let we=ce+ne*x[2]+j*x[1]+G*x[0];const Ce=k[we];we=ce+re*x[2]+j*x[1]+G*x[0];const Ne=k[we];we=ce+ne*x[2]+V*x[1]+G*x[0];const Ae=k[we];we=ce+re*x[2]+V*x[1]+G*x[0];const De=k[we],Je=Ce+(Ne-Ce)*ae,at=Ae+(De-Ae)*ae;we=ce+Y*S[2]+H*S[1]+C*S[0],g.values[we]=Je+(at-Je)*q}}}else for(let j=0;j<y;++j){const V=y>1?R*(p-1)+j*z:.5*(R+U)*(p-1);if(V<0||V>p-1){for(let Z=0;Z<h;Z++){const ne=Z+j*S[2]+H*S[1]+C*S[0];g.values[ne]=u}continue}const q=Math.round(V),Y=Math.round(X);for(let Z=0;Z<h;Z++){const ne=Z+q*x[2]+Y*x[1]+G*x[0],re=Z+j*S[2]+H*S[1]+C*S[0];g.values[re]=k[ne]}}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const wZ={kernelName:Ug,backendName:"cpu",kernelFunc:bZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,exclusive:i,reverse:o}=s;ge(a,"cumprod");const l=Nt([r],a.shape.length);let u=a;l!=null&&(u=Jn({inputs:{x:a},backend:n,attrs:{perm:l}}));const c=Dt(1,a.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=Un(u.dtype,"int32"),p=Og(K(u.shape),d),h=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(g,b)=>g+f-b-1:(g,b)=>g+b;for(let g=0;g<h.length;g+=f)for(let b=0;b<f;b++){const w=m(g,b);if(b===0)p[w]=i?1:h[w];else{const k=m(g,b-1);p[w]=i?h[k]*p[k]:h[w]*p[k]}}const y=n.makeTensorInfo(u.shape,d,p);if(l!=null){const g=Li(l),b=Jn({inputs:{x:y},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(u),b}return y}const xZ={kernelName:Wg,backendName:"cpu",kernelFunc:kZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,exclusive:i,reverse:o}=s;ge(a,"cumsum");const l=Nt([r],a.shape.length);let u=a;l!=null&&(u=Jn({inputs:{x:a},backend:n,attrs:{perm:l}}));const c=Dt(1,a.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=Un(u.dtype,"int32"),p=dn(K(u.shape),d),h=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],m=o?(g,b)=>g+f-b-1:(g,b)=>g+b;for(let g=0;g<h.length;g+=f)for(let b=0;b<f;b++){const w=m(g,b);if(b===0)p[w]=i?0:h[w];else{const k=m(g,b-1);p[w]=i?h[k]+p[k]:h[w]+p[k]}}const y=n.makeTensorInfo(u.shape,d,p);if(l!=null){const g=Li(l),b=Jn({inputs:{x:y},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(u),b}return y}const SZ={kernelName:Ap,backendName:"cpu",kernelFunc:vZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,weights:r}=e,{size:i,binaryOutput:o}=s;if(a.shape.length===1){const l=n.data.get(a.dataId).values,u=n.data.get(r.dataId).values,c=E2(l,u,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,c)}else if(a.shape.length===2){const l=n.bufferSync(a),u=n.bufferSync(r),c=Xj(l,u,i,o);return n.makeTensorInfo(c.shape,r.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const CZ={kernelName:Gg,backendName:"cpu",kernelFunc:NZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockSize:r,dataFormat:i}=s;I(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const o=a.shape[0],l=a.shape[1],u=a.shape[2],c=a.shape[3],d=l*r,p=u*r,h=c/(r*r),f=n.data.get(a.dataId).values,m=new Float32Array(o*d*p*h);let y=0;for(let g=0;g<o;++g)for(let b=0;b<d;++b){const w=Math.floor(b/r),k=b%r;for(let x=0;x<p;++x){const S=Math.floor(x/r),C=x%r,T=(k*r+C)*h;for(let E=0;E<h;++E){const L=E+T+c*(S+u*(w+l*g));m[y++]=f[L]}}}return n.makeTensorInfo([o,d,p,h],a.dtype,m)}const TZ={kernelName:Hg,backendName:"cpu",kernelFunc:IZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l,dimRoundingMode:u}=s;ge([a,r],"depthwiseConv2DNative");const c=ve(a.shape),d=ve(r.shape);let p=l;p==null&&(p=[1,1]),I(hn(i,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${p}'`);const h=nn(a.shape,r.shape,i,p,o,u,!0),{filterHeight:f,filterWidth:m,dilationHeight:y,dilationWidth:g,padInfo:b}=h,w=b.left,k=b.top,x=h.outChannels/h.inChannels,S=new Bt(h.outShape,a.dtype),C=n.data.get(a.dataId).values,T=n.data.get(r.dataId).values,E=S.values;for(let R=0;R<h.batchSize;++R){const L=R*c[0],U=R*S.strides[0];for(let G=0;G<h.outHeight;++G){const F=U+G*S.strides[1],z=G*h.strideHeight-k;for(let H=0;H<f;++H){const X=z+H*y;if(X<0||X>=h.inHeight)continue;const j=H*d[0],V=L+X*c[1];for(let q=0;q<h.outWidth;++q){const Y=F+q*S.strides[2],Z=q*h.strideWidth-w;for(let ne=0;ne<m;++ne){const re=Z+ne*g;if(re<0||re>=h.inWidth)continue;const ae=j+ne*d[1],ce=V+re*h.inChannels;let we=Y,Ce=ae;for(let Ne=0;Ne<h.inChannels;++Ne){const Ae=C[ce+Ne];for(let De=0;De<x;++De)E[we+De]+=Ae*T[Ce+De];we+=x,Ce+=x}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const $Z={kernelName:Op,backendName:"cpu",kernelFunc:X_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=s;ge([a,r],"depthwiseConv2dNativeBackpropFilter");const d=nn(a.shape,c,i,o,l,u,!0),{strideHeight:p,strideWidth:h,filterHeight:f,filterWidth:m}=d,y=new Bt(d.filterShape,"float32"),g=d.padInfo.left,b=d.padInfo.top,w=d.outChannels/d.inChannels,k=n.data.get(a.dataId).values,x=new Bt(a.shape,a.dtype,k),S=n.data.get(r.dataId).values,C=new Bt(r.shape,r.dtype,S);for(let T=0;T<f;++T){const E=Math.max(0,Math.ceil((b-T)/p)),R=Math.min(d.outHeight,(d.inHeight+b-T)/p);for(let L=0;L<m;++L){const U=Math.max(0,Math.ceil((g-L)/h)),G=Math.min(d.outWidth,(d.inWidth+g-L)/h);for(let F=0;F<d.outChannels;++F){const z=Math.trunc(F/w),H=F%w;let X=0;for(let j=0;j<d.batchSize;++j)for(let V=E;V<R;++V){const q=T+V*p-b;for(let Y=U;Y<G;++Y){const Z=L+Y*h-g;X+=x.get(j,q,Z,z)*C.get(j,V,Y,F)}}y.set(X,T,L,z,H)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const RZ={kernelName:Kg,backendName:"cpu",kernelFunc:EZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AZ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=s;ge([a,r],"depthwiseConv2DNativeBackpropInput");const d=ve(a.shape),p=ve(r.shape),h=nn(c,r.shape,i,o,l,u,!0),f=new Bt(h.inShape,"float32"),m=f.values,[y,g,b]=f.strides,w=n.data.get(a.dataId).values,[k,x,S]=d,C=n.data.get(r.dataId).values,[T,E,R]=p,{batchSize:L,filterHeight:U,filterWidth:G,inChannels:F,inHeight:z,inWidth:H,outChannels:X,outHeight:j,outWidth:V,strideHeight:q,strideWidth:Y}=h,Z=U-1-h.padInfo.top,ne=G-1-h.padInfo.left,re=X/F;for(let ae=0;ae<L;++ae)for(let ce=0;ce<F;++ce)for(let we=0;we<z;++we){const Ce=we-Z,Ne=Math.max(0,Math.ceil(Ce/q)),Ae=Math.min(j,(U+Ce)/q);for(let De=0;De<H;++De){const Je=De-ne,at=Math.max(0,Math.ceil(Je/Y)),Ct=Math.min(V,(G+Je)/Y);let rt=0;for(let Ze=Ne;Ze<Ae;++Ze){const yt=Ze*q-Ce;for(let pt=at;pt<Ct;++pt){const nr=pt*Y-Je,an=k*ae+x*Ze+S*pt,Pr=T*(U-1-yt)+E*(G-1-nr)+R*ce;for(let ys=0;ys<re;++ys){const Hi=ce*re+ys,ea=w[an+Hi],sr=C[Pr+ys];rt+=ea*sr}}}m[y*ae+g*we+b*De+ce]=rt}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const OZ={kernelName:qg,backendName:"cpu",kernelFunc:AZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DZ(t){const{inputs:e,backend:n}=t,{x:s}=e,a=K(s.shape),r=n.data.get(s.dataId).values,i=Re([a,a],s.dtype),o=i.values;for(let u=0;u<r.length;u++)o[u*a+u]=r[u];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const jZ={kernelName:Jg,backendName:"cpu",kernelFunc:DZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Z={kernelName:Dp,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:a}=t,{strides:r,pad:i,dilations:o}=n,l=e,u=l.data.get(s.dataId).values,c=s.shape.length,d=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:h,inHeight:f,inWidth:m,inChannels:y,outHeight:g,outWidth:b,padInfo:w,strideHeight:k,strideWidth:x,filterHeight:S,filterWidth:C,dilationHeight:T,dilationWidth:E,outShape:R}=vh(s.shape,a.shape,r,i,"NHWC",o),L=K(R),U=R.length,G=Tt(s.dtype,L);for(let z=0;z<h;++z)for(let H=0;H<g;++H){const X=H*k-w.top;for(let j=0;j<b;++j){const V=j*x-w.left;for(let q=0;q<y;++q){let Y=Number.MIN_SAFE_INTEGER;for(let ne=0;ne<S;++ne){const re=X+ne*T;if(re>=0&&re<f)for(let ae=0;ae<C;++ae){const ce=V+ae*E;if(ce>=0&&ce<m){const we=ma([z,re,ce,q],c,ve(s.shape)),Ce=ma([ne,ae,q],p,ve(a.shape)),Ne=u[we]+d[Ce];Ne>Y&&(Y=Ne)}}}const Z=ma([z,H,j,q],U,ve(R));G[Z]=Y}}}return{dataId:l.write(_i(G,s.dtype),R,s.dtype),shape:R,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FZ={kernelName:Fm,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:a,dy:r}=t,{strides:i,pad:o,dilations:l}=n,u=e,c=Cs(s.shape,u.data.get(s.dataId).values),d=Cs(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:m,outHeight:y,outWidth:g,padInfo:b,strideHeight:w,strideWidth:k,filterHeight:x,filterWidth:S,dilationHeight:C,dilationWidth:T,outShape:E}=vh(s.shape,a.shape,i,o,"NHWC",l);I(r.rank===E.length,()=>`Error in ${Fm}, dy must have the same rank as output ${E.length}, but got ${r.rank}`);const R=Cs(E,u.data.get(r.dataId).values),L=Qx(a.shape,a.dtype);for(let G=0;G<p;++G)for(let F=0;F<y;++F){const z=F*w-b.top;for(let H=0;H<g;++H){const X=H*k-b.left;for(let j=0;j<m;++j){let V=Number.MIN_SAFE_INTEGER,q=0,Y=0;for(let Z=0;Z<x;++Z){const ne=z+Z*C;if(ne>=0&&ne<h)for(let re=0;re<S;++re){const ae=X+re*T;if(ae>=0&&ae<f){const ce=c[G][ne][ae][j]+d[Z][re][j];ce>V&&(V=ce,q=Z,Y=re)}}}L[q][Y][j]+=R[G][F][H][j]}}}return{dataId:u.write(_i(L,s.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PZ={kernelName:_m,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:a,dy:r}=t,{strides:i,pad:o,dilations:l}=n,u=e,c=Cs(s.shape,u.data.get(s.dataId).values),d=Cs(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:m,outHeight:y,outWidth:g,padInfo:b,strideHeight:w,strideWidth:k,filterHeight:x,filterWidth:S,dilationHeight:C,dilationWidth:T,outShape:E}=vh(s.shape,a.shape,i,o,"NHWC",l);I(r.rank===E.length,()=>`Error in ${_m}, dy must have the same rank as output ${E.length}, but got ${r.rank}`);const R=Cs(E,u.data.get(r.dataId).values),L=Qx(s.shape,s.dtype);for(let G=0;G<p;++G)for(let F=0;F<y;++F){const z=F*w-b.top;for(let H=0;H<g;++H){const X=H*k-b.left;for(let j=0;j<m;++j){let V=Number.MIN_SAFE_INTEGER,q=z<0?0:z,Y=X<0?0:X;for(let Z=0;Z<x;++Z){const ne=z+Z*C;if(ne>=0&&ne<h)for(let re=0;re<S;++re){const ae=X+re*T;if(ae>=0&&ae<f){const ce=c[G][ne][ae][j]+d[Z][re][j];ce>V&&(V=ce,q=ne,Y=ae)}}}L[G][q][Y][j]+=R[G][F][H][j]}}}return{dataId:u.write(_i(L,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LZ(t){const{inputs:e,backend:n,attrs:s}=t,{image:a}=e,{canvas:r,options:i}=s,{contextOptions:o,imageOptions:l}=i||{},u=(l==null?void 0:l.alpha)||1,c=(o==null?void 0:o.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const d=r.getContext(c,(o==null?void 0:o.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${c} type.`);const[p,h]=a.shape.slice(0,2),f=a.shape.length===2?1:a.shape[2],m=n.data.get(a.dataId).values,y=a.dtype==="float32"?255:1,g=new Uint8ClampedArray(h*p*4);for(let w=0;w<p*h;++w){const k=[0,0,0,255*u];for(let S=0;S<f;S++){const C=m[w*f+S];if(a.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(a.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);f===1?(k[0]=C*y,k[1]=C*y,k[2]=C*y):k[S]=C*y}const x=w*4;g[x+0]=Math.round(k[0]),g[x+1]=Math.round(k[1]),g[x+2]=Math.round(k[2]),g[x+3]=Math.round(k[3])}r.width=h,r.height=p;const b=new ImageData(g,h,p);return d.putImageData(b,0,0),a}const BZ={kernelName:Xg,backendName:"cpu",kernelFunc:LZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yh(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;ge(a,"sum");let o;a.dtype==="bool"?o=$i({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):o=Za({inputs:{x:a},backend:n});const l=o.shape.length,u=Fe(r,o.shape),c=Nt(u,l);let d=u,p=o;c!=null&&(p=Jn({inputs:{x:o},backend:n,attrs:{perm:c}}),d=Dt(d.length,l)),fn("sum",d,p.shape.length);const[h,f]=sn(p.shape,d),m=Un(p.dtype,"int32");let y=eg(n,h,m);const g=K(f),b=n.data.get(y.dataId).values,w=n.data.get(p.dataId).values;for(let k=0;k<b.length;++k){const x=k*g;let S=0;for(let C=0;C<g;++C)S+=w[x+C];b[k]=S}if(i){const k=Ot(y.shape,u),x=y;y=lt({inputs:{x:y},backend:n,attrs:{shape:k}}),n.disposeIntermediateTensorInfo(x)}return n.disposeIntermediateTensorInfo(o),c!=null&&n.disposeIntermediateTensorInfo(p),y}const zZ={kernelName:ph,backendName:"cpu",kernelFunc:Yh};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MZ(t){const{inputs:e,backend:n,attrs:s}=t,{equation:a}=s,r=e,{allDims:i,summedDims:o,idDims:l}=Xv(a,r.length);Qv(i.length,l,r);const{path:u,steps:c}=Zv(o,l),d=c.length;let p=null,h=i.length;const f=[];for(let m=0;m<d;++m){for(const y of c[m]){const{permutationIndices:g,expandDims:b}=Yv(h,l[y]);let w;e2(g)?w=r[y]:(w=Jn({inputs:{x:r[y]},backend:n,attrs:{perm:g}}),f.push(w));const k=w.shape.slice();for(let x=0;x<b.length;++x)k.splice(b[x],0,1);Le(w.shape,k)||(w=lt({inputs:{x:w},backend:n,attrs:{shape:k}}),f.push(w)),p===null?p=w:(p=B0({inputs:{a:w,b:p},backend:n}),f.push(p))}m<d-1&&(u[m]>=0&&(p=Yh({inputs:{x:p},backend:n,attrs:{axis:u[m]-(i.length-h),keepDims:!1}}),f.push(p)),h--)}for(const m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}const VZ={kernelName:Yg,backendName:"cpu",kernelFunc:MZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WZ(t){const{inputs:e,backend:n}=t,{dy:s,y:a}=e;ge([s,a],"eluGrad");const r=new Float32Array(K(a.shape)),i=n.data.get(a.dataId).values,o=n.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const u=i[l];u>=0?r[l]=o[l]:r[l]=o[l]*(u+1)}return n.makeTensorInfo(a.shape,"float32",r)}const UZ={kernelName:Qg,backendName:"cpu",kernelFunc:WZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GZ=Wv,HZ=Uv,KZ=Gv,qZ=Hv,JZ=Kv,XZ=qv,YZ=Qe(Ou,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+GZ*n);return e*(1-((((XZ*s+JZ)*s+qZ)*s+KZ)*s+HZ)*s*Math.exp(-n*n))}),QZ={kernelName:Ou,backendName:"cpu",kernelFunc:YZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sg(t){const{inputs:e,backend:n,attrs:s}=t,{input:a}=e,{dim:r}=s,i=a.shape.length,o=a.shape.slice();let l=r;return r<0&&(I(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),o.splice(l,0,1),lt({inputs:{x:a},backend:n,attrs:{shape:o}})}const ZZ={kernelName:_p,backendName:"cpu",kernelFunc:sg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eee=_t((t,e)=>t/e),_2=qt(Ru,eee),jk={kernelName:Ru,backendName:"cpu",kernelFunc:_2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y_(t,e,n){const s=t.shape,a=s[0],r=s[1],i=n.data.get(t.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,u=[a,r],c=K(u),d=en("float32",c),p=en("float32",c);for(let y=0;y<a;y++){const g=Bo({inputs:{x:o},backend:n,attrs:{begin:[y,0],size:[1,r]}}),b=Bo({inputs:{x:l},backend:n,attrs:{begin:[y,0],size:[1,r]}}),w=as({inputs:{real:g,imag:b},backend:n}),{real:k,imag:x}=tee(w,e,n),S=Nr(k,x);for(let C=0;C<r;C++){const T=Jv(S,C);d[y*r+C]=T.real,p[y*r+C]=T.imag}n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(w)}const h=n.makeTensorInfo(u,"float32",d),f=n.makeTensorInfo(u,"float32",p),m=as({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),m}function tee(t,e,n){const s=K(t.shape),a=n.data.get(t.dataId),r=n.data.get(a.complexTensorInfos.real.dataId).values,i=n.data.get(a.complexTensorInfos.imag.dataId).values;if(nee(s)){const o=_k(r,i,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",o.real),c=n.makeTensorInfo(l,"float32",o.imag),d=n.makeTensorInfo([],"float32",Er(s,"float32")),p=Za({inputs:{x:d},backend:n}),h=jk.kernelFunc({inputs:{a:u,b:d},backend:n}),f=jk.kernelFunc({inputs:{a:c,b:p},backend:n}),m=n.data.get(h.dataId).values,y=n.data.get(f.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),{real:m,imag:y}}return o}else{const o=Nr(r,i),l=see(o,s,e);return iO(l)}}function nee(t){return(t&t-1)===0}function _k(t,e,n,s,a){if(n===1)return{real:t,imag:e};const r=Nr(t,e),i=n/2,o=oO(r),l=o.real,u=o.imag,c=[l.length],d=a.makeTensorInfo(c,"float32",l),p=a.makeTensorInfo(c,"float32",u),h=as({inputs:{real:d,imag:p},backend:a}),f=lO(r),m=f.real,y=f.imag,g=[m.length],b=a.makeTensorInfo(g,"float32",m),w=a.makeTensorInfo(g,"float32",y),k=as({inputs:{real:b,imag:w},backend:a}),x=_k(l,u,i,s,a),S=x.real,C=x.imag,T=[S.length],E=a.makeTensorInfo(T,"float32",S),R=a.makeTensorInfo(T,"float32",C),L=as({inputs:{real:E,imag:R},backend:a}),U=_k(m,y,i,s,a),G=U.real,F=U.imag,z=[G.length],H=a.makeTensorInfo(z,"float32",G),X=a.makeTensorInfo(z,"float32",F),j=as({inputs:{real:H,imag:X},backend:a}),V=cO(n,s),q=[V.real.length],Y=a.makeTensorInfo(q,"float32",V.real),Z=a.makeTensorInfo(q,"float32",V.imag),ne=as({inputs:{real:Y,imag:Z},backend:a}),re=B0({inputs:{a:ne,b:j},backend:a}),ae=ou({inputs:{a:L,b:re},backend:a}),ce=D2({inputs:{a:L,b:re},backend:a}),we=Lo({inputs:{input:ae},backend:a}),Ce=Lo({inputs:{input:ce},backend:a}),Ne=lu({inputs:{input:ae},backend:a}),Ae=lu({inputs:{input:ce},backend:a}),De=uu({inputs:[we,Ce],backend:a,attrs:{axis:0}}),Je=uu({inputs:[Ne,Ae],backend:a,attrs:{axis:0}}),at=a.data.get(De.dataId).values,Ct=a.data.get(Je.dataId).values;return a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(w),a.disposeIntermediateTensorInfo(k),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(R),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(X),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(Y),a.disposeIntermediateTensorInfo(Z),a.disposeIntermediateTensorInfo(ne),a.disposeIntermediateTensorInfo(re),a.disposeIntermediateTensorInfo(ae),a.disposeIntermediateTensorInfo(ce),a.disposeIntermediateTensorInfo(we),a.disposeIntermediateTensorInfo(Ne),a.disposeIntermediateTensorInfo(Ce),a.disposeIntermediateTensorInfo(Ae),a.disposeIntermediateTensorInfo(De),a.disposeIntermediateTensorInfo(Je),{real:at,imag:Ct}}function see(t,e,n){const s=new Float32Array(e*2);for(let a=0;a<e;a++){let r=0,i=0;for(let o=0;o<e;o++){const l=dO(a*o,e,n),u=Jv(t,o);r+=u.real*l.real-u.imag*l.imag,i+=u.real*l.imag+u.imag*l.real}n&&(r/=e,i/=e),uO(s,r,i,a)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aee(t){const{inputs:e,backend:n}=t,{input:s}=e,a=K(s.shape),r=s.shape[s.shape.length-1],i=a/r,o=lt({inputs:{x:s},backend:n,attrs:{shape:[i,r]}}),l=Y_(o,!1,n),u=lt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const ree={kernelName:Zg,backendName:"cpu",kernelFunc:aee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F2(t){const{backend:e,attrs:n}=t,{shape:s,value:a,dtype:r}=n,i=r||Ko(a),o=Tt(i,K(s));return oee(o,a,i),e.makeTensorInfo(s,i,o)}const iee={kernelName:ey,backendName:"cpu",kernelFunc:F2};function oee(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lee={kernelName:ty,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,a=n,r=en(s.dtype,K(s.shape)),[i,o,l,u]=s.shape,c=a.data.get(s.dataId).values;for(let p=0;p<i;p++){const h=p*l*o*u;for(let f=0;f<o;f++){const m=f*(l*u);for(let y=0;y<l;y++){const g=y*u;for(let b=0;b<u;b++){const w=Math.round(l-y-1),k=h+m+g+b;let x=c[k];if(w>=0&&w<l){const S=w*u,C=h+m+S+b;x=c[C]}r[k]=x}}}}return{dataId:a.write(r,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uee(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r,bias:i,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=s;let m=J_({inputs:{x:a,filter:r},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(i){const y=m;if(c==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const g=lt({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=ou({inputs:{a:m,b:g},backend:n}),n.disposeIntermediateTensorInfo(g)}else m=ou({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(y)}if(h){const y=m;if(c==="NCHW"&&h==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const g=lt({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=ng(n,m,h,g,f),n.disposeIntermediateTensorInfo(g)}else m=ng(n,m,h,o,f);n.disposeIntermediateTensorInfo(y)}return m}const cee={kernelName:zd,backendName:"cpu",kernelFunc:uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dee(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r,bias:i,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=s;let m=X_({inputs:{x:a,filter:r},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(i){const y=m;m=ou({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(y)}if(h){const y=m;m=ng(n,m,h,o,f),n.disposeIntermediateTensorInfo(y)}return m}const pee={kernelName:Md,backendName:"cpu",kernelFunc:dee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hee(t){const{inputs:e,backend:n}=t,{params:s,indices:a}=e,r=K(s.shape),i=a.shape,o=i[i.length-1],[l,u,c,d]=S0(s,a);if(u===0)return n.makeTensorInfo(l,s.dtype,[]);const p=n.data.get(a.dataId).values,h=n.bufferSync(s),f=o_(p,h,s.dtype,u,o,c,d,s.shape,r);return n.makeTensorInfo(l,s.dtype,f.values)}const fee={kernelName:ny,backendName:"cpu",kernelFunc:hee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mee(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,indices:r}=e,{axis:i,batchDims:o}=s;ge([a,r],"gatherV2");const l=Fe(i,a.shape)[0],u=n.data.get(r.dataId).values,c=a.shape[l];for(let k=0;k<u.length;++k){const x=u[k];I(x<=c-1&&x>=0,()=>`GatherV2: the index value ${x} is not in [0, ${c-1}]`)}let d=o;o==null&&(d=0);const p=K(r.shape),h=n2(a,r,l,d),f=lt({inputs:{x:a},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),m=lt({inputs:{x:r},backend:n,attrs:{shape:[h.batchSize,p/h.batchSize]}}),y=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize],g=n.bufferSync(m),b=n.bufferSync(f),w=l_(b,g,y);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(h.outputShape,w.dtype,w.values)}const gee={kernelName:Pp,backendName:"cpu",kernelFunc:mee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(t){const{inputs:e,backend:n}=t,{input:s}=e,a=K(s.shape),r=s.shape[s.shape.length-1],i=a/r,o=lt({inputs:{x:s},backend:n,attrs:{shape:[i,r]}}),l=Y_(o,!0,n),u=lt({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const bee={kernelName:sy,backendName:"cpu",kernelFunc:yee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wee=Qe(Bu,t=>Number.isFinite(t)?1:0,"bool"),kee={kernelName:Bu,backendName:"cpu",kernelFunc:wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xee=Qe(zu,t=>Math.abs(t)===1/0?1:0,"bool"),vee={kernelName:zu,backendName:"cpu",kernelFunc:xee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const See=Qe(Mu,t=>Number.isNaN(t)?1:0,"bool"),Nee={kernelName:Mu,backendName:"cpu",kernelFunc:See};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(t){const{backend:e,attrs:n}=t,{start:s,stop:a,num:r}=n,i=h_(s,a,r);return e.makeTensorInfo([i.length],"float32",i)}const Iee={kernelName:ry,backendName:"cpu",kernelFunc:Cee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tee=Qe(Wu,t=>Math.log1p(t)),$ee={kernelName:Wu,backendName:"cpu",kernelFunc:Tee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eee=_t((t,e)=>t&&e),Ree=qt(Vp,Eee,null,"bool"),Aee={kernelName:Vp,backendName:"cpu",kernelFunc:Ree};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oee=Qe(Wp,t=>t?0:1,"bool"),Dee={kernelName:Wp,backendName:"cpu",kernelFunc:Oee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jee=_t((t,e)=>t||e),_ee=qt(Up,jee,null,"bool"),Fee={kernelName:Up,backendName:"cpu",kernelFunc:_ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{depthRadius:r,bias:i,alpha:o,beta:l}=s;ge(a,"LRN");const u=a.shape[3],c=u-1,d=n.data.get(a.dataId).values,p=K(a.shape),h=new Float32Array(p);function f(m){const y=m%u;let g=m-y+Math.max(0,y-r);const b=m-y+Math.min(y+r,c);let w=0;for(;g<=b;g++){const k=d[g];w+=k*k}return w}for(let m=0;m<p;m++){const y=f(m),g=d[m]*Math.pow(i+o*y,-l);h[m]=g}return n.makeTensorInfo(a.shape,a.dtype,h)}const Lee={kernelName:Gp,backendName:"cpu",kernelFunc:Pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bee(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,y:r,dy:i}=e,{depthRadius:o,bias:l,alpha:u,beta:c}=s;ge(i,"LRNGrad");const d=K(i.shape),p=i.shape[3],h=n.data.get(i.dataId).values,f=n.data.get(a.dataId).values,m=n.data.get(r.dataId).values,y=new Float32Array(d),g=d;for(let b=0;b<g;b++){const w=b%p,k=b-w+Math.max(0,w-o),x=b-w+Math.min(p,w+o+1);let S=0;for(let C=k;C<x;C++)S+=Math.pow(f[C],2);S=u*S+l;for(let C=k;C<x;C++){let T=-2*u*c*f[C]*m[b]/S;b===C&&(T+=Math.pow(S,-c)),T*=h[b],y[C]+=T}}return n.makeTensorInfo(i.shape,a.dtype,y)}const zee={kernelName:iy,backendName:"cpu",kernelFunc:Bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{reductionIndices:r,keepDims:i}=s,o=n;let l=a.shape;const u=l.length,c=Fe(r,l);let d=c;const p=Nt(d,u);let h=o.data.get(a.dataId).values;if(p!=null){const k=new Array(u);for(let x=0;x<k.length;x++)k[x]=l[p[x]];h=A2(h,l,a.dtype,p,k),d=Dt(d.length,u),l=k}ge(a,"max"),fn("max",d,u);const[f,m]=sn(l,d),y=K(m),g=m_(h,y,f,a.dtype),b=o.write(g,f,a.dtype);let w=f;return i&&(w=Ot(f,c)),{dataId:b,shape:w,dtype:a.dtype}}const Mee={kernelName:Hp,backendName:"cpu",kernelFunc:Q_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vee(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;ge(a,"maxPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=s,u=1;I(hn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Ys(a.shape,r,i,u,o,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&Le(c.inShape,c.outShape))d=Za({inputs:{x:a},backend:n});else{const p=n.data.get(a.dataId).values,h=ve(a.shape),f=j2(p,a.shape,a.dtype,h,c,"max");d=n.makeTensorInfo(c.outShape,a.dtype,f.values)}return d}const Wee={kernelName:Kp,backendName:"cpu",kernelFunc:Vee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uee(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:l,dataFormat:u}=s;ge(a,"maxPool3d");const c=Rr(a.shape,r,i,1,o,l,u),d=n.data.get(a.dataId).values,p=q_(d,a.shape,a.dtype,ve(a.shape),c,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}const Gee={kernelName:qp,backendName:"cpu",kernelFunc:Uee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hee(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,{filterSize:i,strides:o,pad:l,dimRoundingMode:u}=s;ge([a,r],"maxPool3DGrad");const c=Rr(r.shape,i,o,1,l,u),d=n.bufferSync(r),p=jQ(d,c),h=c.strideDepth,f=c.strideHeight,m=c.strideWidth,y=c.dilationDepth,g=c.dilationHeight,b=c.dilationWidth,w=c.effectiveFilterDepth,k=c.effectiveFilterHeight,x=c.effectiveFilterWidth,S=w-1-c.padInfo.front,C=x-1-c.padInfo.left,T=k-1-c.padInfo.top,E=Re(r.shape,"float32"),R=n.bufferSync(a);for(let L=0;L<c.batchSize;++L)for(let U=0;U<c.inChannels;++U)for(let G=0;G<c.inDepth;++G)for(let F=0;F<c.inHeight;++F)for(let z=0;z<c.inWidth;++z){const H=G-S,X=F-T,j=z-C;let V=0;for(let q=0;q<w;q+=y){const Y=(H+q)/h;if(!(Y<0||Y>=c.outDepth||Math.floor(Y)!==Y))for(let Z=0;Z<k;Z+=g){const ne=(X+Z)/f;if(!(ne<0||ne>=c.outHeight||Math.floor(ne)!==ne))for(let re=0;re<x;re+=b){const ae=(j+re)/m;if(ae<0||ae>=c.outWidth||Math.floor(ae)!==ae)continue;const ce=w*k*x-1-p.get(L,Y,ne,ae,U),we=q*k*x+Z*x+re,Ce=ce===we?1:0;if(Ce===0)continue;const Ne=R.get(L,Y,ne,ae,U);V+=Ne*Ce}}}E.set(V,L,G,F,z,U)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const Kee={kernelName:ly,backendName:"cpu",kernelFunc:Hee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r,output:i}=e,o=r;ge([r,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=s,p=Ys(o.shape,l,u,1,c,d),h=n.data.get(o.dataId).values,f=Re(p.outShape,o.dtype,K_(h,o.shape,o.dtype,p).values),m=p.strideHeight,y=p.strideWidth,g=p.dilationHeight,b=p.dilationWidth,w=p.effectiveFilterHeight,k=p.effectiveFilterWidth,x=k-1-p.padInfo.left,S=w-1-p.padInfo.top,C=Re(o.shape,"float32"),T=n.data.get(a.dataId).values,E=Re(a.shape,"float32",T);for(let R=0;R<p.batchSize;++R)for(let L=0;L<p.inChannels;++L)for(let U=0;U<p.inHeight;++U)for(let G=0;G<p.inWidth;++G){const F=U-S,z=G-x;let H=0;for(let X=0;X<w;X+=g){const j=(F+X)/m;if(!(j<0||j>=p.outHeight||Math.floor(j)!==j))for(let V=0;V<k;V+=b){const q=(z+V)/y;if(q<0||q>=p.outWidth||Math.floor(q)!==q)continue;const Y=w*k-1-f.get(R,j,q,L),Z=X*k+V,ne=Y===Z?1:0;if(ne===0)continue;const re=E.get(R,j,q,L);H+=re*ne}}C.set(H,R,U,G,L)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Jee={kernelName:oy,backendName:"cpu",kernelFunc:qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(t,e,n,s,a){const r=ve(e),i=j2(t,e,n,r,a,"max"),o=K_(t,e,n,a,!0,s);return[i.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yee={kernelName:uy,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:a,strides:r,pad:i,includeBatchInIndex:o}=e,l=n;ge(s,"MaxPoolWithArgmax");const u=l.data.get(s.dataId).values,c=Ys(s.shape,a,r,[1,1],i),[d,p]=Xee(u,s.shape,s.dtype,o,c),h=l.write(d,c.outShape,s.dtype),f=l.write(p,c.outShape,s.dtype);return[{dataId:h,shape:c.outShape,dtype:s.dtype},{dataId:f,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=Fe(r,a.shape),u=sn(a.shape,o)[1],c=K(u),d=[],p=n.makeTensorInfo([],"float32",new Float32Array([c]));d.push(p);const h=$i({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});d.push(h);const f=_2({inputs:{a:h,b:p},backend:n});d.push(f);const m=Yh({inputs:{x:f},backend:n,attrs:{axis:r,keepDims:i}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),m}const Zee={kernelName:Jp,backendName:"cpu",kernelFunc:Qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ete(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;ge(a,"min");const o=Fe(r,a.shape);let l=o;const u=Nt(l,a.shape.length);let c=a;u!=null&&(c=Jn({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Dt(l.length,a.shape.length)),fn("min",l,c.shape.length);const[d,p]=sn(c.shape,l),h=K(p),f=dn(K(d),c.dtype),m=n.data.get(c.dataId).values;for(let g=0;g<f.length;++g){const b=g*h;let w=m[b];for(let k=0;k<h;++k){const x=m[b+k];(Number.isNaN(x)||x<w)&&(w=x)}f[g]=w}u!=null&&n.disposeIntermediateTensorInfo(c);const y=n.makeTensorInfo(d,c.dtype,f);if(i){const g=Ot(d,o),b=lt({inputs:{x:y},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(y),b}return y}const tte={kernelName:Xp,backendName:"cpu",kernelFunc:ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nte(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{paddings:r,mode:i}=s;ge(a,"mirrorPad");const o=r.map((w,k)=>w[0]+a.shape[k]+w[1]),l=r.map(w=>w[0]),u=r.map((w,k)=>w[0]+a.shape[k]),c=i==="reflect"?0:1,d=n.data.get(a.dataId).values,p=a.shape.length,h=ve(a.shape),f=K(o),m=o.length,y=ve(o),g=en(a.dtype,f);for(let w=0;w<f;w++){let k=qo(w,m,y);for(let S=0;S<m;S++)k[S]<l[S]?k[S]=l[S]*2-k[S]-c:k[S]>=u[S]&&(k[S]=(u[S]-1)*2-k[S]+c);k=k.map((S,C)=>S-l[C]);const x=ma(k,p,h);g[w]=d[x]}return{dataId:n.write(g,o,a.dtype),shape:o,dtype:a.dtype}}const ste={kernelName:Yp,backendName:"cpu",kernelFunc:nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ate=_t((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),rte=qt(Hu,ate),ite={kernelName:Hu,backendName:"cpu",kernelFunc:rte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_(t){const{inputs:e,backend:n,attrs:s}=t,{logits:a}=e,{dim:r}=s,i=a.shape.length;let o=r;if(o===-1&&(o=i-1),o!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${o}`);const l=Fe([o],a.shape),u=Q_({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=Ot(u.shape,l),d=lt({inputs:{x:u},backend:n,attrs:{shape:c}}),p=D2({inputs:{a,b:d},backend:n}),h=s_({inputs:{x:p},backend:n}),f=Yh({inputs:{x:h},backend:n,attrs:{axis:l,keepDims:!1}}),m=lt({inputs:{x:f},backend:n,attrs:{shape:c}}),y=_2({inputs:{a:h,b:m},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),y}const ote={kernelName:mh,backendName:"cpu",kernelFunc:Z_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lte(t){const{inputs:e,backend:n,attrs:s}=t,{logits:a}=e,{numSamples:r,seed:i,normalized:o}=s;ge(a,"multinomial");const l=o?a:Z_({inputs:{logits:a},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,p=[u,r],h=dn(K(p),"int32");for(let f=0;f<u;++f){const m=f*c,y=new Float32Array(c-1);y[0]=d[m];for(let w=1;w<y.length;++w)y[w]=y[w-1]+d[m+w];const g=Qy.alea(i.toString()),b=f*r;for(let w=0;w<r;++w){const k=g();h[b+w]=y.length;for(let x=0;x<y.length;x++)if(k<y[x]){h[b+w]=x;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",h)}const ute={kernelName:cy,backendName:"cpu",kernelFunc:lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cte=w0;function dte(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s;ge(a,"NonMaxSuppression");const u=n.data.get(a.dataId).values,c=n.data.get(r.dataId).values,{selectedIndices:d}=cte(u,c,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const pte={kernelName:dy,backendName:"cpu",kernelFunc:dte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hte=k0;function fte(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=s;ge(a,"NonMaxSuppressionPadded");const c=n.data.get(a.dataId).values,d=n.data.get(r.dataId).values,{selectedIndices:p,validOutputs:h}=hte(c,d,i,o,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const mte={kernelName:py,backendName:"cpu",kernelFunc:fte};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gte=x0;function yte(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=s;ge(a,"NonMaxSuppressionWithScore");const c=n.data.get(a.dataId).values,d=n.data.get(r.dataId).values,p=i,h=o,f=l,m=u,{selectedIndices:y,selectedScores:g}=gte(c,d,p,h,f,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const bte={kernelName:hy,backendName:"cpu",kernelFunc:yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(t){const{inputs:e,backend:n,attrs:s}=t,{indices:a}=e,{dtype:r,depth:i,onValue:o,offValue:l}=s;ge(a,"oneHot");const u=K(a.shape),c=new Float32Array(u*i);c.fill(l);const d=n.data.get(a.dataId).values;for(let p=0;p<u;++p)d[p]>=0&&d[p]<i&&(c[p*i+d[p]]=o);return n.makeTensorInfo([...a.shape,i],r,c)}const kte={kernelName:th,backendName:"cpu",kernelFunc:wte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ag(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const a=Lo({inputs:{input:s},backend:n}),r=ag({inputs:{x:a},backend:n}),i=lu({inputs:{input:s},backend:n}),o=ag({inputs:{x:i},backend:n}),l=as({inputs:{real:r,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return F2({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const xte={kernelName:wh,backendName:"cpu",kernelFunc:ag};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const a=Lo({inputs:{input:s},backend:n}),r=e3({inputs:{x:a},backend:n}),i=lu({inputs:{input:s},backend:n}),o=ag({inputs:{x:i},backend:n}),l=as({inputs:{real:r,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return F2({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const vte={kernelName:eh,backendName:"cpu",kernelFunc:e3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t3(t){const{inputs:e,backend:n,attrs:s}=t,{axis:a}=s;if(e.length===1)return sg({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const r=e[0].shape,i=e[0].dtype;e.forEach(c=>{pn(r,c.shape,"All tensors passed to stack must have matching shapes"),I(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(c=>{const d=sg({inputs:{input:c},backend:n,attrs:{dim:a}});return o.push(d),d}),u=uu({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const Ste={kernelName:nh,backendName:"cpu",kernelFunc:t3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{paddings:r,constantValue:i}=s;ge(a,"pad");const o=r.map((b,w)=>b[0]+a.shape[w]+b[1]),l=r.map(b=>b[0]),u=n.data.get(a.dataId).values,c=K(a.shape),d=a.shape.length,p=ve(a.shape),h=K(o),f=o.length,m=ve(o),y=en(a.dtype,h);i!==0&&y.fill(i);for(let b=0;b<c;b++){const k=qo(b,d,p).map((S,C)=>S+l[C]),x=ma(k,f,m);y[x]=u[b]}return{dataId:n.write(y,o,a.dtype),shape:o,dtype:a.dtype}}const n3={kernelName:sh,backendName:"cpu",kernelFunc:Nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cte=_t((t,e)=>Math.pow(t,e)),Ite=qt(qu,Cte),Tte={kernelName:qu,backendName:"cpu",kernelFunc:Ite};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $te(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:a,paramsDenseValues:r,indices:i}=e,o=a.map(y=>n.data.get(y.dataId).values),l=a.map(y=>y.shape),u=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,[d,p,h]=x_(o,l,u,r.shape,r.dtype,c,i.shape),f=d.map(y=>n.makeTensorInfo([y.length],"int32",y)),m=n.makeTensorInfo(h,r.dtype,p);return f.concat([m])}const Ete={kernelName:fy,backendName:"cpu",kernelFunc:$te};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rte(t){const{inputs:e,backend:n}=t,{starts:s,limits:a,deltas:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,[u,c]=v_(i,s.shape,s.dtype,o,a.shape,l,r.shape),d=n.makeTensorInfo([u.length],"int32",u),p=n.makeTensorInfo([c.length],s.dtype,c);return[d,p]}const Ate={kernelName:my,backendName:"cpu",kernelFunc:Rte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(t){const{inputs:e,backend:n,attrs:s}=t,{shape:a,values:r,defaultValue:i,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,u=n.data.get(a.dataId).values,c=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,p=o.map(y=>n.data.get(y.dataId).values),h=o.map(y=>y.shape),[f,m]=S_(u,a.shape,c,r.shape,r.dtype,d,i.shape,p,h,l);return n.makeTensorInfo(f,r.dtype,m)}const Dte={kernelName:gy,backendName:"cpu",kernelFunc:Ote};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jte(t){const{backend:e,attrs:n}=t,{start:s,stop:a,dtype:r,step:i}=n,o=N_(s,a,i,r);return e.makeTensorInfo([o.length],r,o)}const _te={kernelName:yy,backendName:"cpu",kernelFunc:jte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fte=Qe(Ju,t=>1/t),Pte={kernelName:Ju,backendName:"cpu",kernelFunc:Fte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(t){const{inputs:e,backend:n,attrs:s}=t,{images:a}=e,{alignCorners:r,halfPixelCenters:i,size:o}=s;ge(a,"resizeBilinear");const l=ve(a.shape),[u,c]=o,[d,p,h,f]=a.shape,m=n.data.get(a.dataId).values,y=new Float32Array(K([d,u,c,f])),g=[r&&u>1?p-1:p,r&&c>1?h-1:h],b=[r&&u>1?u-1:u,r&&c>1?c-1:c];let w=0;const k=g[0]/b[0],x=g[1]/b[1];for(let S=0;S<d;S++)for(let C=0;C<u;C++){let T;i?T=k*(C+.5)-.5:T=k*C;const E=Math.max(0,Math.floor(T)),R=T-E,L=Math.min(p-1,Math.ceil(T)),U=S*l[0]+E*l[1],G=S*l[0]+L*l[1];for(let F=0;F<c;F++){let z;i?z=x*(F+.5)-.5:z=x*F;const H=Math.max(0,Math.floor(z)),X=z-H,j=Math.min(h-1,Math.ceil(z)),V=U+H*l[2],q=G+H*l[2],Y=U+j*l[2],Z=G+j*l[2];for(let ne=0;ne<f;ne++){const re=m[V+ne],ae=m[q+ne],ce=m[Y+ne],we=m[Z+ne],Ce=re+(ce-re)*X,Ne=ae+(we-ae)*X,Ae=Ce+(Ne-Ce)*R;y[w++]=Ae}}}return n.makeTensorInfo([d,u,c,f],"float32",y)}const Bte={kernelName:lh,backendName:"cpu",kernelFunc:Lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(t){const{inputs:e,backend:n,attrs:s}=t,{images:a,dy:r}=e,{alignCorners:i}=s;ge([r,a],"resizeBilinearGrad");const o=ve(a.shape),[l,u,c,d]=a.shape,[,p,h]=r.shape,f=new Float32Array(l*u*c*d),m=[i&&p>1?u-1:u,i&&h>1?c-1:c],y=[i&&p>1?p-1:p,i&&h>1?h-1:h],g=m[0]/y[0],b=m[1]/y[1],w=n.data.get(r.dataId).values;let k=0;for(let x=0;x<l;x++){const S=x*o[0];for(let C=0;C<p;C++){const T=C*g,E=Math.floor(T),R=Math.min(Math.ceil(T),u-1),L=S+E*o[1],U=S+R*o[1],G=T-E,F=1-G;for(let z=0;z<h;z++){const H=z*b,X=Math.floor(H),j=Math.min(Math.ceil(H),c-1),V=H-X,q=1-V,Y=L+X*o[2],Z=L+j*o[2],ne=U+X*o[2],re=U+j*o[2],ae=F*q,ce=F*V,we=G*q,Ce=G*V;for(let Ne=0;Ne<d;Ne++){const Ae=w[k++];f[Y+Ne]+=Ae*ae,f[Z+Ne]+=Ae*ce,f[ne+Ne]+=Ae*we,f[re+Ne]+=Ae*Ce}}}}return n.makeTensorInfo([l,c,u,d],"float32",f)}const Mte={kernelName:ky,backendName:"cpu",kernelFunc:zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t){const{inputs:e,backend:n,attrs:s}=t,{images:a}=e,{alignCorners:r,halfPixelCenters:i,size:o}=s;ge(a,"resizeNearestNeighbor");const l=ve(a.shape),[u,c]=o,[d,p,h,f]=a.shape,m=n.data.get(a.dataId).values,y=new Float32Array(d*u*c*f),g=[r&&u>1?p-1:p,r&&c>1?h-1:h],b=[r&&u>1?u-1:u,r&&c>1?c-1:c],w=g[0]/b[0],k=g[1]/b[1];let x=0;for(let S=0;S<d;S++){const C=S*l[0];for(let T=0;T<u;T++){const E=i?w*(T+.5):w*T;let R=Math.min(p-1,r?Math.round(E):Math.floor(E));i&&(R=Math.max(0,R));const L=C+R*l[1];for(let U=0;U<c;U++){const G=i?k*(U+.5):k*U;let F=Math.min(h-1,r?Math.round(G):Math.floor(G));i&&(F=Math.max(0,F));const z=L+F*l[2];for(let H=0;H<f;H++){const X=m[z+H];y[x++]=X}}}}return n.makeTensorInfo([d,u,c,f],a.dtype,y)}const Wte={kernelName:oh,backendName:"cpu",kernelFunc:Vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ute(t){const{inputs:e,backend:n,attrs:s}=t,{images:a,dy:r}=e,{alignCorners:i}=s;ge([r,a],"resizeNearestNeighborGrad");const o=ve(a.shape),l=ve(r.shape),[u,c,d,p]=a.shape,[,h,f]=r.shape,m=new Float32Array(u*c*d*p),y=n.data.get(r.dataId).values,g=[i&&h>1?c-1:c,i&&f>1?d-1:d],b=[i&&h>1?h-1:h,i&&f>1?f-1:f],w=g[0]/b[0],k=g[1]/b[1],x=1/w,S=1/k,C=Math.ceil(x)*2+2,T=Math.ceil(S)*2+2;for(let E=0;E<u;E++){const R=E*o[0];for(let L=0;L<c;L++){const U=R+L*o[1],G=Math.floor(L*x),F=Math.floor(G-C/2);for(let z=0;z<d;z++){const H=U+z*o[2],X=Math.floor(z*S),j=Math.floor(X-T/2);for(let V=0;V<p;V++){let q=0;for(let Y=0;Y<C;Y++){const Z=Y+F;if(Z<0||Z>=h)continue;const ne=R+Z*l[1],re=Z*w,ae=Math.min(c-1,i?Math.round(re):Math.floor(re));if(L===ae)for(let ce=0;ce<T;ce++){const we=ce+j;if(we<0||we>=f)continue;const Ce=ne+we*l[2],Ne=we*k,Ae=Math.min(d-1,i?Math.round(Ne):Math.floor(Ne));z===Ae&&(q+=y[Ce+V])}}m[H+V]=q}}}}return n.makeTensorInfo(a.shape,a.dtype,m)}const Gte={kernelName:wy,backendName:"cpu",kernelFunc:Ute};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{dims:r}=s;ge(a,"reverse");const i=a.shape.length,o=Fe(r,a.shape);if(i===0)return Za({inputs:{x:a},backend:n});const l=new Bt(a.shape,a.dtype),u=n.bufferSync(a);for(let c=0;c<l.size;c++){const d=l.indexToLoc(c),p=d.slice();o.forEach(h=>p[h]=a.shape[h]-1-p[h]),l.set(u.get(...p),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const Kte={kernelName:uh,backendName:"cpu",kernelFunc:Hte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qte={kernelName:Py,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:a,fillValue:r,center:i}=e,o=n,l=en(s.dtype,K(s.shape)),[u,c,d,p]=s.shape,[h,f]=zv(i,c,d),m=255,y=Math.sin(a),g=Math.cos(a),b=o.data.get(s.dataId).values;for(let k=0;k<u;k++){const x=k*d*c*p;for(let S=0;S<c;S++){const C=S*(d*p);for(let T=0;T<d;T++){const E=T*p;for(let R=0;R<p;R++){const L=[u,S,T,R],U=L[2],G=L[1];let F=(U-h)*g-(G-f)*y,z=(U-h)*y+(G-f)*g;F=Math.round(F+h),z=Math.round(z+f);let H=r;if(typeof r!="number"&&(R===3?H=m:H=r[R]),F>=0&&F<d&&z>=0&&z<c){const j=z*(d*p),V=F*p,q=x+j+V+R;H=b[q]}const X=x+C+E+R;l[X]=H}}}}return{dataId:o.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jte=Qe(Qu,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),Xte={kernelName:Qu,backendName:"cpu",kernelFunc:Jte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(t){const{inputs:e,backend:n,attrs:s}=t,{indices:a,updates:r}=e,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Vi(r,a,i),p=!0,h=n.bufferSync(a),f=n.bufferSync(r),m=po(h,f,i,d,u,l,o,c,0,p);return n.makeTensorInfo(i,m.dtype,m.values)}const Qte={kernelName:xy,backendName:"cpu",kernelFunc:Yte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(t,e){let n=0,s=t.length,a=0;for(;n<s;)a=Math.floor((n+s)/2),t[a]<e?n=a+1:s=a;return s}function ene(t,e){let n=0,s=t.length,a=0;for(;n<s;)a=Math.floor((n+s)/2),t[a]<=e?n=a+1:s=a;return s}function tne(t,e,n,s,a,r){const i=Tt("int32",n*a);for(let o=0;o<n;++o){const l=t.slice(o*s,(o+1)*s),u=o*a;for(let c=0;c<a;++c)i[u+c]=r==="left"?Zte(l,e[c+u]):ene(l,e[c+u])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:a,values:r}=e,{side:i}=s,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,u=tne(o,l,a.shape[0],a.shape[1],r.shape[1],i);return n.makeTensorInfo(r.shape,"int32",u)}const sne={kernelName:Sy,backendName:"cpu",kernelFunc:nne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ane(t){const{inputs:e,backend:n}=t,{condition:s,t:a,e:r}=e;ge([s,a,r],"select");const i=s.shape.length,o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(r.dataId).values,c=Un(a.dtype,r.dtype),d=dn(K(a.shape),c);let p=0;const h=i===0||i>1||a.shape.length===1?1:K(a.shape.slice(1));for(let f=0;f<o.length;f++)for(let m=0;m<h;m++)o[f]===1?d[p++]=l[f]:d[p++]=u[f];return n.makeTensorInfo(a.shape,c,d)}const rne={kernelName:ch,backendName:"cpu",kernelFunc:ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ine=I0,one=T0,lne=Qe(ec,t=>t>=0?one*t:ine*(Math.exp(t)-1)),une={kernelName:ec,backendName:"cpu",kernelFunc:lne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cne=Qe(sc,t=>t<0?-1:t>0?1:0),dne={kernelName:sc,backendName:"cpu",kernelFunc:cne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pne=Qe(tc,t=>Math.sin(t)),hne={kernelName:tc,backendName:"cpu",kernelFunc:pne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fne=Qe(nc,t=>Math.sinh(t)),mne={kernelName:nc,backendName:"cpu",kernelFunc:fne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gne=11920928955078125e-23,eI=Math.log(gne)+2,yne=Qe(rc,t=>{const e=t>-eI,n=t<eI,s=Math.exp(t);let a;return n?a=s:e?a=t:a=Math.log(1+s),a}),bne={kernelName:rc,backendName:"cpu",kernelFunc:yne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockShape:r,paddings:i}=s;ge([a],"spaceToBatchND");const o=K(r),l=[[0,0]];l.push(...i);for(let S=1+r.length;S<a.shape.length;++S)l.push([0,0]);const u=n3.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),c=zh(u.shape,r,o,!1),d=Mh(c.length,r.length,!1),p=Vh(u.shape,r,o,!1),m=lt({inputs:{x:u},backend:n,attrs:{shape:c}}),b=Jn({inputs:{x:m},backend:n,attrs:{perm:d}}),x=lt({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),x}const kne={kernelName:hh,backendName:"cpu",kernelFunc:wne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(t){const{inputs:e,backend:n}=t,{indices:s,values:a,denseShape:r,defaultValue:i}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${a.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values[0],[d,p,h,f,m]=$_(o,s.shape,s.dtype,l,a.dtype,u,c);return[n.makeTensorInfo(p,s.dtype,d),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(y=>Number(y)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const vne={kernelName:Ny,backendName:"cpu",kernelFunc:xne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sne(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:a,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const i=Array.from(n.data.get(a.dataId).values),o=n.data.get(s.dataId).values,l=Array.from(n.data.get(r.dataId).values),[u,c,d]=E_(o,s.shape,s.dtype,i,l);return[n.makeTensorInfo(c,s.dtype,u),n.makeTensorInfo([d.length],r.dtype,new Int32Array(d))]}const Nne={kernelName:Cy,backendName:"cpu",kernelFunc:Sne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cne(t){const{inputs:e,backend:n}=t,{data:s,indices:a,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${a.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${r.shape}`);if(a.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,[u,c]=O2(i,s.shape,s.dtype,o,l,!0);return n.makeTensorInfo(c,s.dtype,u)}const Ine={kernelName:Iy,backendName:"cpu",kernelFunc:Cne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t){const{inputs:e,backend:n}=t,{data:s,indices:a,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${a.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${r.shape}`);if(a.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,[u,c]=O2(i,s.shape,s.dtype,o,l);return n.makeTensorInfo(c,s.dtype,u)}const $ne={kernelName:Ty,backendName:"cpu",kernelFunc:Tne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:a,sparseValues:r,defaultValue:i}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=Vi(r,a,o),h=!1,f=n.bufferSync(a);let m;switch(r.dtype){case"bool":{const y=n.bufferSync(r),g=!!n.data.get(i.dataId).values[0];m=po(f,y,o,p,c,u,l,d,g,h);break}case"float32":{const y=n.bufferSync(r),g=n.data.get(i.dataId).values[0];m=po(f,y,o,p,c,u,l,d,g,h);break}case"int32":{const y=n.bufferSync(r),g=n.data.get(i.dataId).values[0];m=po(f,y,o,p,c,u,l,d,g,h);break}case"string":{const y=n.bufferSync(r),g=xr(n.data.get(i.dataId).values[0]);m=po(f,y,o,p,c,u,l,d,g,h);break}default:throw new Error(`Unsupported type ${r.dtype}`)}return n.makeTensorInfo(o,m.dtype,m.values)}const Rne={kernelName:$y,backendName:"cpu",kernelFunc:Ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{numOrSizeSplits:r,axis:i}=s,o=Fe(i,a.shape)[0],l=t2(a,r,o),u=new Array(a.shape.length).fill(0),c=a.shape.slice();return l.map(d=>{const p=[...c];p[o]=d;const h=Bo({inputs:{x:a},backend:n,attrs:{begin:u,size:p}});return u[o]+=d,h})}const One={kernelName:fh,backendName:"cpu",kernelFunc:Ane};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dne={kernelName:Ey,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;ge(n,"square");const a=s.data.get(n.dataId).values,r=new Float32Array(a.length);for(let o=0;o<a.length;++o){const l=a[o];r[o]=l*l}return{dataId:s.write(r,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jne=Qe(pc,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),_ne={kernelName:pc,backendName:"cpu",kernelFunc:jne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fne(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{begin:r,end:i,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=s;ge(a,"stridedSlice");const{finalShapeSparse:h,finalShape:f,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:b,end:w,strides:k}=Fv(a.shape,r,i,o,l,u,c,d,p);let x;if(m)x=lt({inputs:{x:a},backend:n,attrs:{shape:f}});else if(y||g){I(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const S=Dv(b,w,k),C=Bo({inputs:{x:a},backend:n,attrs:{begin:b,size:S}});x=lt({inputs:{x:C},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(C)}else{const S=n.bufferSync(a),C=O_(h,S,k,b);x=n.makeTensorInfo(f,C.dtype,C.values)}return x}const Pne={kernelName:Ry,backendName:"cpu",kernelFunc:Fne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(t){const{inputs:e,backend:n,attrs:s}=t,{separator:a,nGramWidths:r,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:u}=s,{data:c,dataSplits:d}=e,p=n.data.get(c.dataId).values,h=n.data.get(d.dataId).values,[f,m]=D_(p,h,a,r,i,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}const Bne={kernelName:Ay,backendName:"cpu",kernelFunc:Lne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zne(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:a}=s,{input:r,delimiter:i}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values[0],[u,c,d]=j_(o,l,a),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Mne={kernelName:Oy,backendName:"cpu",kernelFunc:zne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:a}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(r.dataId).values,o=__(i,a);return n.makeTensorInfo(r.shape,"int32",o)}const Wne={kernelName:Dy,backendName:"cpu",kernelFunc:Vne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Une=Qe(uc,t=>Math.tan(t)),Gne={kernelName:uc,backendName:"cpu",kernelFunc:Une};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hne=Qe(cc,t=>Math.tanh(t)),Kne={kernelName:cc,backendName:"cpu",kernelFunc:Hne};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qne(t){const{inputs:e,backend:n}=t,{tensor:s,indices:a,updates:r}=e,{sliceRank:i,numUpdates:o,sliceSize:l,strides:u,outputSize:c}=Vi(r,a,s.shape),d=!1,p=n.bufferSync(a),h=n.bufferSync(r),f=n.bufferSync(s),m=po(p,h,s.shape,c,l,o,i,u,f,d);return n.makeTensorInfo(s.shape,m.dtype,m.values)}const Jne={kernelName:vy,backendName:"cpu",kernelFunc:qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xne(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{reps:r}=s;ge(a,"tile");const i=P_(n.bufferSync(a),r);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Yne={kernelName:dc,backendName:"cpu",kernelFunc:Xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{k:r,sorted:i}=s;ge(a,"topk");const o=n.data.get(a.dataId).values,[l,u]=B_(o,a.shape,a.dtype,r,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const Zne={kernelName:jy,backendName:"cpu",kernelFunc:Qne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t){const{inputs:e,attrs:n,backend:s}=t,{image:a,transforms:r}=e,{interpolation:i,fillMode:o,fillValue:l,outputShape:u}=n,[c,d,p,h]=a.shape,[f,m]=u??[d,p],y=[c,f,m,h],g=ve(a.shape),b=g[0],w=g[1],k=g[2],x=ve(y),S=x[0],C=x[1],T=x[2],E=en(a.dtype,K(y));E.fill(l);const R=s.data.get(a.dataId).values,L=s.data.get(r.dataId).values;for(let G=0;G<c;++G){const F=r.shape[0]===1?L:L.subarray(G*8,G*8+8);for(let z=0;z<f;++z)for(let H=0;H<m;++H)for(let X=0;X<h;++X){let j;const V=F[6]*H+F[7]*z+1;if(V===0)continue;const q=(F[0]*H+F[1]*z+F[2])/V,Y=(F[3]*H+F[4]*z+F[5])/V,Z=tI(q,p,o),ne=tI(Y,d,o);switch(i){case"nearest":j=ise(R,d,p,b,w,k,G,ne,Z,X,l);break;case"bilinear":j=ose(R,d,p,b,w,k,G,ne,Z,X,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const re=G*S+z*C+H*T+X;E[re]=j}return s.makeTensorInfo(y,a.dtype,E)}return{dataId:s.write(E,y,a.dtype),shape:a.shape,dtype:a.dtype}}const tse={kernelName:_y,backendName:"cpu",kernelFunc:ese};function tI(t,e,n){switch(n){case"reflect":return nse(t,e);case"wrap":return sse(t,e);case"nearest":return rse(t,e);case"constant":default:return ase(t)}}function nse(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return yi(0,n,e-1)}function sse(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return yi(0,n,e-1)}function ase(t,e){return t}function rse(t,e){return yi(0,t,e-1)}function td(t,e,n,s,a,r,i,o,l,u,c){const d=i*s+o*a+l*r+u;return 0<=o&&o<e&&0<=l&&l<n?t[d]:c}function ise(t,e,n,s,a,r,i,o,l,u,c){const d=Math.round(o),p=Math.round(l);return td(t,e,n,s,a,r,i,d,p,u,c)}function ose(t,e,n,s,a,r,i,o,l,u,c){const d=Math.floor(o),p=Math.floor(l),h=d+1,f=p+1,m=(f-l)*td(t,e,n,s,a,r,i,d,p,u,c)+(l-p)*td(t,e,n,s,a,r,i,d,f,u,c),y=(f-l)*td(t,e,n,s,a,r,i,h,p,u,c)+(l-p)*td(t,e,n,s,a,r,i,h,f,u,c);return(h-o)*m+(o-d)*y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lse(t){const{inputs:e,attrs:n,backend:s}=t,{axis:a}=n,{x:r}=e;ge(r,"unique");const i=s.data.get(r.dataId).values,{outputValues:o,outputShape:l,indices:u}=z_(i,a,r.shape,r.dtype);return[s.makeTensorInfo(l,r.dtype,o),s.makeTensorInfo([u.length],"int32",u)]}const use={kernelName:Fy,backendName:"cpu",kernelFunc:lse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cse(t){const{inputs:e,backend:n,attrs:s}=t,{value:a}=e;let{axis:r}=s;r<0&&(r+=a.shape.length);const i=a.shape.length,o=a.shape[r],l=new Array(i-1);let u=0;for(let h=0;h<i;h++)h!==r&&(l[u++]=a.shape[h]);const c=new Array(i).fill(0),d=a.shape.slice();d[r]=1;const p=new Array(o);for(let h=0;h<p.length;h++){c[r]=h;const f=Bo({inputs:{x:a},backend:n,attrs:{begin:c,size:d}});p[h]=lt({inputs:{x:f},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(f)}return p}const dse={kernelName:yh,backendName:"cpu",kernelFunc:cse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pse(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,segmentIds:r}=e,{numSegments:i}=s;ge(a,"unsortedSegmentSum");const o=a.shape.length,l=r.shape.length,u=[],c=[],d=o-l;let p=r;for(let f=0;f<d;++f){const m=sg({inputs:{input:p},backend:n,attrs:{dim:f+1}});p=m,c.push(m)}for(let f=0;f<i;++f){const m=Er(f,"int32"),y=n.makeTensorInfo([],"int32",m),g=t_({inputs:{a:y,b:p},backend:n}),b=$i({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),w=B0({inputs:{a:b,b:a},backend:n}),k=Yh({inputs:{x:w},backend:n,attrs:{axis:0,keepDims:!1}});u.push(k),c.push(y),c.push(g),c.push(b),c.push(w),c.push(k)}const h=t3({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}const hse={kernelName:bh,backendName:"cpu",kernelFunc:pse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fse=[lQ,VX,cQ,pQ,qX,fQ,gQ,bQ,kQ,vQ,NQ,IQ,$Q,AQ,DQ,FQ,LQ,zQ,VQ,iQ,UQ,HQ,qQ,XX,XQ,HX,QX,QQ,WX,eZ,nZ,sZ,rZ,oZ,uZ,dZ,hZ,mZ,yZ,wZ,xZ,SZ,CZ,TZ,$Z,RZ,OZ,jZ,_Z,FZ,PZ,BZ,VZ,ZY,UZ,ZX,QZ,eY,ZZ,nY,ree,iee,lee,aY,iY,cee,pee,fee,gee,lY,cY,UX,bee,tZ,kee,vee,Nee,eQ,pY,fY,Iee,gY,$ee,Aee,Dee,Fee,Lee,zee,Mee,bY,Wee,Gee,Kee,Jee,Yee,Zee,tte,kY,ste,ite,ute,vY,NY,pte,mte,bte,IY,kte,vte,Ste,n3,Tte,nQ,EY,Ete,Ate,Dte,_te,GX,jk,Pte,sQ,aQ,rQ,Bte,Mte,Wte,Gte,Kte,qte,Xte,PY,Qte,sne,rne,une,BY,dne,hne,mne,zY,ote,bne,kne,vne,Nne,Ine,$ne,Rne,One,WY,Dne,GY,KY,_ne,Pne,Bne,Mne,Wne,YY,zZ,Gne,Kne,Jne,Yne,Zne,tse,TY,use,dse,hse,xte];for(const t of fse)Ly(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ao={},Rf={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function mse(t,e){ao[t]=e}function va(t,e){if(!(t in ao)||e!=null){const s=yse(t,e);if(s!==null)ao[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=ao[t];return n==null||n.isContextLost()?(delete ao[t],va(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),ao[t])}function gse(t){if(!W().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function yse(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??gse(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete ao[t]},!1),W().getBool("SOFTWARE_WEBGL_ENABLED")&&(Rf.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Rf)||n.getContext("experimental-webgl",Rf):n.getContext("webgl2",Rf)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ep;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(ep||(ep={}));var Ss;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Ss||(Ss={}));var ln;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(ln||(ln={}));function Qh(t,e){return[e,t]}function bse(t,e){return t*e}function Af(t){const e=K(t),n=Math.ceil(e/4);return Om(n)}function xc(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function wse(t,e){const[n,s]=xc(t,e);return n*s*4}function P2(t,e){const n=t;let s,a,r,i,o,l,u,c,d,p;return W().getNumber("WEBGL_VERSION")===2?(s=n.R32F,a=n.R16F,r=n.RGBA16F,i=n.RGBA32F,o=n.RED,u=4,c=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(s=t.RGBA,a=t.RGBA,r=t.RGBA,i=n.RGBA,o=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,p=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function de(t,e){const n=e();return W().getBool("DEBUG")&&kse(t),n}function kse(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+Nse(t,e))}const xse=596e-10,vse=65504;function Sse(t){return!!(W().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||xse<Math.abs(t)&&Math.abs(t)<vse)}function Nse(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Of(t,e){return Fr(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Cse(t,e){const n=Fr(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(de(t,()=>t.shaderSource(n,e)),de(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Ise(t,e){const n=Fr(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(de(t,()=>t.shaderSource(n,e)),de(t,()=>t.compileShader(n)),W().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw s3(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Tse=/ERROR: [0-9]+:([0-9]+):/g;function s3(t,e){const n=Tse.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],a=t.split(`
`),r=a.length.toString().length+2,i=a.map((d,p)=>mo((p+1).toString(),r)+d);let o=0;for(let d=0;d<i.length;d++)o=Math.max(i[d].length,o);const l=i.slice(0,s-1),u=i.slice(s-1,s),c=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${mo(u[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function $se(t){return Fr(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function Ese(t,e){if(de(t,()=>t.linkProgram(e)),!W().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Fb(t,e){if(de(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Rse(t,e){const n=Fr(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return de(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),de(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Ase(t,e){const n=Fr(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return de(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),de(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Ose(t){return Fr(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function Dse(t,e){const n=W().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,a=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+a+".")}}function jse(t){return Fr(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function nI(t,e,n,s,a,r,i){const o=t.getAttribLocation(e,n);return o===-1?!1:(de(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),de(t,()=>t.vertexAttribPointer(o,a,t.FLOAT,!1,r,i)),de(t,()=>t.enableVertexAttribArray(o)),!0)}function _se(t,e,n){zse(t,n),de(t,()=>t.activeTexture(t.TEXTURE0+n)),de(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Fse(t,e,n){return Fr(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Pse(t,e,n){return t.getUniformLocation(e,n)}function Lse(t,e,n,s){de(t,()=>_se(t,e,s)),de(t,()=>t.uniform1i(n,s))}function Pb(t,e,n){de(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),de(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function sI(t,e){de(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),de(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Df(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Bse(t,e))}function Bse(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Fr(t,e,n){const s=de(t,()=>e());if(s==null)throw new Error(n);return s}function zse(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const a=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${a}.`)}}function cu(t,e=2){return K(t.slice(0,t.length-e))}function du(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function jf(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[cu(t),...du(t)]),e}function Mse(t,e=!1){let n=W().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=W().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&W().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((o,l)=>l>=t.length-2?Ag(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=$r(t).newShape);let a=K(t),r=null;t.length<=1&&a<=n?r=[1,a]:t.length===2&&t[0]<=n&&t[1]<=n?r=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?r=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?r=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?r=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(r=[t[0],t[1]*t[2]*t[3]]);const i=r!=null&&Math.max(...r)>s&&Math.min(...r)<=(e?2:1)&&Math.min(...r)>0;if(r==null||i)if(e){const o=cu(t);let l=2,u=2;t.length&&([l,u]=du(t)),a=o*(l/2)*(u/2),r=Om(a).map(c=>c*2)}else r=Om(a);return r}function _f(t){return t%2===0}function rg(t,e){if(t=t.slice(-2),e=e.slice(-2),Le(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||_f(n)&&_f(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&_f(t[0])&&_f(e[0])}let Lb,Bb;function Vse(t){if(Lb==null){const e=va(t);Lb=e.getParameter(e.MAX_TEXTURE_SIZE)}return Lb}function Wse(t){if(Bb==null){const e=va(t);Bb=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Bb)}function Use(t){if(t===0)return 0;let e;const n=va(t);return Gs(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Gs(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Gs(t,e){return t.getExtension(e)!=null}function aI(t){try{if(va(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Gse(t){if(t===0)return!1;const e=va(t);if(t===1){if(!Gs(e,"OES_texture_float"))return!1}else if(!Gs(e,"EXT_color_buffer_float"))return!1;return Fk(e)}function Hse(t){if(t===0)return!1;const e=va(t);if(t===1){if(!Gs(e,"OES_texture_float")||!Gs(e,"WEBGL_color_buffer_float"))return!1}else{if(Gs(e,"EXT_color_buffer_float"))return Fk(e);const s="EXT_color_buffer_half_float";if(Gs(e,s)){const a=e.getExtension(s);return Kse(e,a)}return!1}return Fk(e)}function Fk(t){const e=P2(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function Kse(t,e){const n=P2(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(i),o}function qse(t){return t!==2?!1:va(t).fenceSync!=null}function Zh(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&I(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const be=W();be.registerFlag("HAS_WEBGL",()=>be.getNumber("WEBGL_VERSION")>0);be.registerFlag("WEBGL_VERSION",()=>aI(2)?2:aI(1)?1:0);be.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);be.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>be.get("WEBGL_VERSION")===2);be.registerFlag("WEBGL_CPU_FORWARD",()=>!0);be.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);be.registerFlag("WEBGL_PACK",()=>be.getBool("HAS_WEBGL"));be.registerFlag("WEBGL_PACK_NORMALIZATION",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_PACK_CLIP",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_PACK_REDUCE",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_LAZILY_UNPACK",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_CONV_IM2COL",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>be.getBool("WEBGL_PACK"));be.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Vse(be.getNumber("WEBGL_VERSION")));be.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Wse(be.getNumber("WEBGL_VERSION")));be.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=be.getNumber("WEBGL_VERSION");return t===0?0:Use(t)});be.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>be.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!a1());be.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Gse(be.getNumber("WEBGL_VERSION")));be.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>be.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:be.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));be.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Hse(be.getNumber("WEBGL_VERSION")));be.registerFlag("WEBGL_FENCE_API_ENABLED",()=>qse(be.getNumber("WEBGL_VERSION")));be.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>be.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);be.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});be.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>a1()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});be.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);be.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);be.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);be.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);be.registerFlag("WEBGL_EXP_CONV",()=>!1);be.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>be.getBool("IS_TEST"));be.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);be.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);be.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);be.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pn(){let t,e,n,s,a,r,i,o,l,u;return W().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",a="texture",r="outputColor",i="out vec4 outputColor;",o=W().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",a="texture2D",r="gl_FragColor",i="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:a,output:r,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function al(t,e,n="index"){const s=ve(e);return s.map((a,r)=>{const i=`int ${t[r]} = ${n} / ${a}`,o=r===s.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * ${a}`:`index -= ${t[r]} * ${a}`;return`${i}; ${o};`}).join("")}function z0(t,e,n="index"){const s=ve(e);return s.map((a,r)=>{const i=`int ${t[r]} = ${n} / outShapeStrides[${r}]`,o=r===s.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * outShapeStrides[${r}]`:`index -= ${t[r]} * outShapeStrides[${r}]`;return`${i}; ${o};`}).join("")}function Jse(t,e){const n=t.length,s=t.map(r=>`${e}[${r}]`),a=new Array(n-1);a[n-2]=s[n-1];for(let r=n-3;r>=0;--r)a[r]=`(${a[r+1]} * ${s[r+1]})`;return a}function Xse(t,e,n="index"){const s=t.map((r,i)=>i),a=Jse(s,e);return a.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${a[i]}`,l=i===a.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${a[i]}`:`index -= ${t[i]} * ${a[i]}`;return`${o}; ${l};`}).join("")}function L2(t){const e=ve(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function B2(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const a3=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:r3}=IO;function Yse(t,e,n){const s=[];if(t.forEach(h=>{const f=K(h.shapeInfo.logicalShape);if(h.shapeInfo.isUniform?s.push(`uniform float ${h.name}${f>1?`[${f}]`:""};`):(s.push(`uniform sampler2D ${h.name};`),s.push(`uniform int offset${h.name};`)),n.enableShapeUniforms){const{uniformShape:m}=z2(n.packedInputs,h.shapeInfo.logicalShape,h.shapeInfo.texShape);switch(m.length){case 1:s.push(`uniform int ${h.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${h.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${h.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${h.name}Shape;`);break}s.push(`uniform ivec2 ${h.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(h=>{s.push(`uniform ${h.type} ${h.name}${h.arrayIndex?`[${h.arrayIndex}]`:""};`)});const a=s.join(`
`),r=t.map(h=>Qse(h,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,o=Pn(),l=tae(o);let u,c,d=aae(o);return e.isPacked?(u=Zse(e.logicalShape,i,n.enableShapeUniforms),c=sae(o)):(u=eae(e.logicalShape,i,n.enableShapeUniforms),c=nae(o)),n.packedInputs&&(d+=lae),[d,l,c,a,u,r,n.userCode].join(`
`)}function vc(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return kae(t,e);case 1:return vae(t,e);case 2:return Nae(t,e);case 3:return Iae(t,e);case 4:return $ae(t,e);case 5:return Eae(t);case 6:return Rae(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function i3(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return wae(t);case 1:return xae(t,e);case 2:return Sae(t,e);case 3:return Cae(t,e);default:return Tae(t,e)}}function Qse(t,e,n=!1,s){let a="";n?a+=i3(t,s):a+=vc(t,s);const r=t.shapeInfo.logicalShape,i=e.logicalShape;return r.length<=i.length&&(n?a+=Aae(t,e):a+=Oae(t,e)),a}function Zse(t,e,n){switch(t.length){case 0:return o3();case 1:return uae(t,e,n);case 2:return yae(t,e,n);case 3:return dae(t,e,n);default:return hae(t,e,n)}}function eae(t,e,n){switch(t.length){case 0:return o3();case 1:return cae(t,e,n);case 2:return bae(t,e,n);case 3:return pae(t,e,n);case 4:return fae(t,e,n);case 5:return mae(t,e);case 6:return gae(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function tae(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function nae(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function sae(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function aae(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${rae}
    ${iae}
    ${oae}
  `}const rae=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,iae=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,oae=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,lae=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function o3(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function uae(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function cae(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function dae(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[2]/2),r=a*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec3(b, r, c);
    }
  `}function pae(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${z0(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=al(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function hae(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[t.length-1]/2),r=a*Math.ceil(t[t.length-2]/2);let i=r,o="",l="b, r, c";for(let u=2;u<t.length-1;u++)i*=t[t.length-u-1],o=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+o,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${o}

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec${t.length}(${l});
    }
  `}function fae(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${z0(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=al(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function mae(t,e){const n=al(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function gae(t,e){const n=al(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function yae(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Le(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const a=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec2(r, c);
    }
  `}function bae(t,e,n){return Le(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function rl(t){return`offset${t}`}function wae(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=Pn();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function kae(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[a,r]=t.shapeInfo.texShape;if(a===1&&r===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=rl(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[o,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function xae(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,r=Pn();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${r.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${r.texture2D}(${n}, uv);
    }
  `}function vae(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Sc(t)}
      }
    `;const a=t.shapeInfo.texShape,r=a[0],i=a[1];if(i===1&&r===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=rl(n);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${r}.0);
        return sampleTexture(${n}, uv);
      }
    `:r===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${r}, ${i}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function Sae(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t.shapeInfo.texShape,i=r[0],o=r[1],l=Pn();if(r!=null&&Le(n,r))return e?`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${a}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${a}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function Nae(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t.shapeInfo.texShape;if(r!=null&&Le(n,r)){if(e)return`
      float ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const p=r[0],h=r[1];return`
    float ${a}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:o}=$r(n),l=i;if(l.length<n.length){const p=Nc(t,l),h=["row","col"];return`
      ${vc(p,e)}
      float ${a}(int row, int col) {
        return ${a}(${Cc(h,o)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Sc(t)}
      }
    `;const u=r[0],c=r[1],d=rl(s);return c===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${a}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${a}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${s}, uv);
  }
`}function Cae(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(n[0]===1){const p=n.slice(1),h=[1,2],f=Nc(t,p),m=["b","row","col"];return`
        ${i3(f,e)}
        vec4 ${a}(int b, int row, int col) {
          return ${a}(${Cc(m,h)});
        }
      `}const o=Pn();if(e)return`
    vec4 ${a}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `;const l=i[0],u=i[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${a}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `}function Iae(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n[1]*n[2],i=n[2],{newShape:o,keptDims:l}=$r(n),u=o;if(u.length<n.length){const m=Nc(t,u),y=["row","col","depth"];return`
        ${vc(m,e)}
        float ${a}(int row, int col, int depth) {
          return ${a}(${Cc(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${r}, ${i}, 1)));
        ${Sc(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],p=c[1],h=t.shapeInfo.flatOffset;if(p===r&&h==null)return e?`
      float ${a}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${a}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(p===i&&h==null)return e?`
      float ${a}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${a}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const f=rl(s);return e?`
    float ${a}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${f};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${a}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r} + col * ${i} + depth + ${f};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${s}, uv);
      }
  `}function Tae(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),a=Pn();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${n}, uv);
    }
  `;const r=t.shapeInfo.logicalShape,i=r.length,o=t.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],c=l[1],d=Math.ceil(r[i-1]/2);let p=d*Math.ceil(r[i-2]/2),h="int b, int row, int col",f=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<i-1;m++)h=`int b${m}, `+h,p*=r[i-m-1],f=`b${m} * ${p} + `+f;return`
    vec4 ${s}(${h}) {
      int index = ${f};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${a.texture2D}(${n}, uv);
    }
  `}function $ae(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n[3],i=n[2]*r,o=n[1]*i,{newShape:l,keptDims:u}=$r(n);if(l.length<n.length){const b=Nc(t,l),w=["row","col","depth","depth2"];return`
      ${vc(b,e)}
      float ${a}(int row, int col, int depth, int depth2) {
        return ${a}(${Cc(w,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${i}, ${r}, 1)));
        ${Sc(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],h=d[1],f=`int stride2 = ${s}Shape[3];`,m=`int stride1 = ${s}Shape[2] * stride2;`,y=`int stride0 = ${s}Shape[1] * stride1;`;if(h===o&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        ${f}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(h===r&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;const g=rl(s);return e?`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${f}
      ${m}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${g});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} +
          depth * ${r} + depth2;
      vec2 uv = uvFromFlat(${p}, ${h}, index + ${g});
      return sampleTexture(${s}, uv);
    }
  `}function Eae(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],r=e[3]*a,i=e[2]*r,o=e[1]*i,{newShape:l,keptDims:u}=$r(e);if(l.length<e.length){const m=Nc(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${vc(m)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Cc(y,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${i}, ${r}, ${a})) +
          depth3;
        ${Sc(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],h=d[1];if(h===o&&c==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${r}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===a&&c==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const f=rl(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} + depth * ${r} +
          depth2 * ${a} + depth3 + ${f};
      vec2 uv = uvFromFlat(${p}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Rae(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:r}=$r(e);if(a.length<e.length){const y=Nc(t,a),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${vc(y)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Cc(g,r)});
      }
    `}const i=e[5],o=e[4]*i,l=e[3]*o,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Sc(t)}
      }
    `;const d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,h=p[0],f=p[1];if(f===c&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${o}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===i&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=rl(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${o} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Sc(t){const e=t.name,n=K(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Aae(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),a="get"+s+"AtOutCoords",r=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,o=r3(t.shapeInfo.logicalShape,e.logicalShape),l=nt(i),u=i-r;let c;const d=["x","y","z","w","u","v"];r===0?c="":i<2&&o.length>=1?c="coords = 0;":c=o.map(b=>`coords.${d[b+u]} = 0;`).join(`
`);let p="";i<2&&r>0?p="coords":p=t.shapeInfo.logicalShape.map((b,w)=>`coords.${d[w+u]}`).join(", ");let h="return outputValue;";const m=K(t.shapeInfo.logicalShape)===1,g=K(e.logicalShape)===1;if(r===1&&!m&&!g)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)i===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(o.length){const b=r-2,w=r-1;o.indexOf(b)>-1&&o.indexOf(w)>-1?h="return vec4(outputValue.x);":o.indexOf(b)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(w)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${a}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${s}(${p});
      ${h}
    }
  `}function Oae(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),a="get"+s+"AtOutCoords",r=e.texShape,i=t.shapeInfo.texShape,o=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===l&&t.shapeInfo.flatOffset==null&&Le(i,r))return`
      float ${a}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=nt(l),c=r3(t.shapeInfo.logicalShape,e.logicalShape),d=l-o;let p;const h=["x","y","z","w","u","v"];o===0?p="":l<2&&c.length>=1?p="coords = 0;":p=c.map(m=>`coords.${h[m+d]} = 0;`).join(`
`);let f="";return l<2&&o>0?f="coords":f=t.shapeInfo.logicalShape.map((m,y)=>`coords.${h[y+d]}`).join(", "),`
    float ${a}() {
      ${u} coords = getOutputCoords();
      ${p}
      return get${s}(${f});
    }
  `}function nt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function z2(t,e,n){const{newShape:s,keptDims:a}=$r(e),r=e.length,i=t&&r===3&&e[0]===1,o=i?e.slice(1):s,l=!t&&r>1&&!Le(e,n)&&s.length<r||i;return{useSqueezeShape:l,uniformShape:l?o:e,keptDims:a}}function Nc(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Cc(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dae(t,e,n,s){const a=n.map((c,d)=>{const p={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(p.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:p}}),r=a.map(c=>c.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},o=Yse(a,i,e),l=Ise(t.gl,o),u=t.createProgram(l);return W().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:r,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:r,outShapeInfo:i},l3(t,e,u)))}function l3(t,e,n){const s=[],a=[];let r,i,o,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),W().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const p={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(p.shape=t.getUniformLocation(n,`${d}Shape`,c),p.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),s.push(p)}if(e.enableShapeUniforms&&(r=t.getUniformLocation(n,"outShape",c),o=t.getUniformLocation(n,"outShapeStrides",c),i=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)a.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:s,customUniformLocations:a,infLoc:l,nanLoc:u,outShapeLocation:r,outShapeStridesLocation:o,outTexShapeLocation:i}}function rI(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const a=n.logicalShape,r=e[s],i=r.shape;if(!Le(a,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${a} and ${i} must match`);if(n.isUniform&&r.isUniform)return;const o=n.texShape,l=r.isUniform?null:r.texData.texShape;if(!Le(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function jae(t,e,n,s,a){e.program.enableShapeUniforms||(rI(e.inShapeInfos,n),rI([e.outShapeInfo],[s]));const r=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(r.texture,i[0],i[1]):t.setOutputMatrixTexture(r.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),W().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:p,texShape:h}=e.variablesLocations[l];if(p){const{uniformShape:f}=z2(e.program.packedInputs,u.shape,u.texData.texShape);switch(f.length){case 1:t.gl.uniform1iv(p,new Int32Array(f));break;case 2:t.gl.uniform2iv(p,new Int32Array(f));break;case 3:t.gl.uniform3iv(p,new Int32Array(f));break;case 4:t.gl.uniform4iv(p,new Int32Array(f));break}}if(h&&t.gl.uniform2i(h,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(K(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let f=u.uniformValues;f instanceof Float32Array||(f=new Float32Array(f)),t.gl.uniform1fv(c,f)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const o=e.outShapeLocation;if(o)switch(s.shape.length){case 1:t.gl.uniform1iv(o,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(o,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(o,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(o,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=ve(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&a)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=a[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function _ae(t,e,n){let s="";e.concat(n).forEach(i=>{const o=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=z2(t.packedInputs,i.shape,l);let p="",h="",f="";if(c.length===1&&t.packedInputs){const x=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${x[0]>1}_${x[1]>1}`}else if(c.length===2&&!t.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const x=ve(c);f=`${x[0]===l[1]}_${x[x.length-1]===l[1]}`}const m=i.shape.length,y=c.length===2&&Le(i.shape,l),g=K(i.shape)===1,b=Oo(i.shape,n.shape),w=!t.packedInputs&&m===n.shape.length&&Le(l,n.texData.texShape),k=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${m}_${w}_${u?d:""}_${c.length}_${g}_${b}_${y}_${p}_${h}_${f}_${k}_${o}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${o}`}});const a=t.userCode;let r=t.constructor.name;return r+="_"+s+"_"+a+`${W().getNumber("WEBGL_VERSION")}`,r}function Nn(t){return W().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fae{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ep.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Pn();this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?z0(["r","c","d"],e):al(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ep.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Pn();this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?z0(["r","c","d"],e):al(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lae{constructor(e){this.variableNames=["A"],this.outTexUsage=Ss.DOWNLOAD;const n=Pn();this.outputShape=e,this.userCode=`
      ${a3}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bae{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ss.DOWNLOAD;const n=Pn();this.outputShape=e,this.userCode=`
      ${a3}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zae={R:0,G:1,B:2,A:3};class iI{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const a=Pn();this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);let r="result";n&&(r="floor(result * 255. + 0.5)");let i="";for(let o=0;o<s.length;o++){const l=s[o];i+=`
          if(offset == ${o}) {
            result = values[${zae[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?B2():L2(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${a.texture2D}(A, uv);
          ${i}
        }
        ${a.output} = vec4(${r}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mae{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Pn();this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);let a="",r="result";n&&(r="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let o=0;o<=1;o++){const l=i*2+o;a+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?B2():L2(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${a}

          ${s.output} = ${r};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vae(t){const e=Pn(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Cse(t,n)}function Wae(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Rse(t,e)}function Uae(t){const e=new Uint16Array([0,1,2,2,1,3]);return Ase(t,e)}function ef(t,e,n,s,a,r){Dse(e,n);const i=Ose(t),o=t.TEXTURE_2D;return de(t,()=>t.bindTexture(o,i)),de(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),de(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),de(t,()=>t.texParameteri(o,t.TEXTURE_MIN_FILTER,t.NEAREST)),de(t,()=>t.texParameteri(o,t.TEXTURE_MAG_FILTER,t.NEAREST)),W().getNumber("WEBGL_VERSION")===1?de(t,()=>t.texImage2D(o,0,s,e,n,0,a,r,null)):de(t,()=>t.texStorage2D(o,1,s,e,n)),de(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function u3(t){return t.internalFormatFloat}function Gae(t,e,n,s){const[a,r]=Qh(e,n);return ef(t,a,r,u3(s),s.textureFormatFloat,t.FLOAT)}function c3(t){return t.internalFormatHalfFloat}function Hae(t,e,n,s){const[a,r]=Qh(e,n);return ef(t,a,r,c3(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function d3(t){return t.downloadTextureFormat}function Kae(t,e,n,s){const[a,r]=Qh(e,n);return ef(t,a,r,d3(s),t.RGBA,t.UNSIGNED_BYTE)}function p3(t){return t.internalFormatPackedFloat}function qae(t,e,n,s){const[a,r]=xc(e,n);return ef(t,a,r,p3(s),t.RGBA,t.FLOAT)}function h3(t){return t.internalFormatPackedHalfFloat}function Jae(t,e,n,s){const[a,r]=xc(e,n);return ef(t,a,r,h3(s),t.RGBA,s.textureTypeHalfFloat)}function Xae(t,e,n){return de(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),nI(t,e,"clipSpacePos",n,3,20,0)&&nI(t,e,"uv",n,2,20,12)}function Yae(t,e,n,s,a,r){de(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,o,l;a instanceof Uint8Array?(i=new Uint8Array(n*s*4),o=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*s*4),o=t.FLOAT,l=r.internalFormatPackedFloat),i.set(a),W().getNumber("WEBGL_VERSION")===2?de(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,o,i)):de(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,o,i)),de(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Qae(t,e,n){de(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?W().getNumber("WEBGL_VERSION")===2?de(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):de(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):W().getNumber("WEBGL_VERSION")===2?de(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):de(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),de(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Zae(t,e,n,s){const a=t.createBuffer();de(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,a));const o=4*4*e*n;return de(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)),de(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),de(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),a}function ere(t,e,n){const s=t,a=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,a),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),a}function tre(t,e,n,s){const[a,r]=Qh(e,n),i=4,o=new Uint8Array(bse(e*n,i));return de(t,()=>t.readPixels(0,0,a,r,s.downloadTextureFormat,t.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function nre(t,e,n,s,a,r,i,o){const l=t,u=new Float32Array(wse(r,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function sre(t,e,n){const s=new Float32Array(e*n*4);return de(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zb{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=W().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,mse(n,e)):this.gl=va(n),e=this.gl,W().getNumber("WEBGL_VERSION")===2){const r=e;this.createVertexArray=()=>de(r,()=>r.createVertexArray()),this.bindVertexArray=i=>de(r,()=>r.bindVertexArray(i)),this.deleteVertexArray=i=>de(r,()=>r.deleteVertexArray(i)),this.getVertexArray=()=>de(r,()=>r.getParameter(r.VERTEX_ARRAY_BINDING))}else if(e!=null){const r=e.getExtension("OES_vertex_array_object");if(r==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>de(e,()=>r.createVertexArrayOES()),this.bindVertexArray=i=>de(e,()=>r.bindVertexArrayOES(i)),this.deleteVertexArray=i=>de(e,()=>r.deleteVertexArrayOES(i)),this.getVertexArray=()=>de(e,()=>e.getParameter(r.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),W().getNumber("WEBGL_VERSION")===1){const r="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Of(this.gl,r),Gs(this.gl,i))this.textureHalfFloatExtension=Of(this.gl,i);else if(W().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Gs(this.gl,a))this.colorBufferHalfFloatExtension=Of(this.gl,a);else if(W().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Gs(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Gs(this.gl,a))this.colorBufferHalfFloatExtension=this.gl.getExtension(a);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Wae(this.gl),this.indexBuffer=Uae(this.gl),this.framebuffer=jse(this.gl),this.textureConfig=P2(this.gl,this.textureHalfFloatExtension)}get debug(){return W().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;de(e,()=>e.finish()),de(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),de(e,()=>e.deleteFramebuffer(this.framebuffer)),de(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),de(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),de(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Gae(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Hae(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Kae(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Qae(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,a){this.throwIfDisposed(),Yae(this.gl,e,n,s,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Jae(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),qae(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(sI(this.gl,this.framebuffer),this.outputTexture=null),de(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>tre(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,a,r,i){return nre(this.gl,e,n,s,a,r,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return ere(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const a=Zae(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(W().getBool("WEBGL_FENCE_API_ENABLED")){const a=e,r=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=a.clientWaitSync(r,0,0);return i===a.ALREADY_SIGNALED||i===a.CONDITION_SATISFIED},n=r}else W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>sre(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Vae(n));const s=$se(n);de(n,()=>n.attachShader(s,this.vertexShader)),de(n,()=>n.attachShader(s,e)),Ese(n,s);const a=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&Fb(n,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;de(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Xae(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(de(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Fb(this.gl,this.program),de(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?Fse(this.gl,e,n):Pse(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),de(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),Lse(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[a,r]=xc(n,s);this.setOutputMatrixTextureDriver(e,a,r)}setOutputMatrixWriteRegion(e,n,s,a){this.setOutputMatrixWriteRegionDriver(s,e,a,n)}setOutputPackedMatrixWriteRegion(e,n,s,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Fb(this.gl,this.program),Df(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}de(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),de(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Of(this.gl,W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,a=this.getQueryTimerExtensionWebGL2(),r=s.createQuery();return s.beginQuery(a.TIME_ELAPSED_EXT,r),r}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await Gw(()=>this.disposed||this.isQueryAvailable(e,W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,a=this.getQueryTimerExtensionWebGL2(),r=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),r&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),a=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),a&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=are(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in W().platform&&(s=W().platform.setTimeoutCustom.bind(W().platform)),Gw(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Pb(this.gl,e,this.framebuffer),this.debug&&Df(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Pb(this.gl,this.outputTexture,this.framebuffer),this.debug&&Df(this.gl)):sI(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const a=this.gl;Pb(a,e,this.framebuffer),this.debug&&Df(a),this.outputTexture=e,de(a,()=>a.viewport(0,0,n,s)),de(a,()=>a.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,a){this.throwIfDisposed(),de(this.gl,()=>this.gl.scissor(e,n,s,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function are(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:rre,bincountImpl:f3,bincountReduceImpl:ire,bitwiseAndImpl:ore,castImpl:lre,ceilImpl:ure,concatImpl:cre,equalImpl:dre,expImpl:pre,expm1Impl:hre,floorImpl:fre,gatherNdImpl:mre,gatherV2Impl:gre,greaterImpl:yre,greaterEqualImpl:bre,lessImpl:wre,lessEqualImpl:kre,linSpaceImpl:xre,logImpl:vre,maxImpl:Sre,maximumImpl:Nre,minimumImpl:Cre,multiplyImpl:Ire,negImpl:Tre,notEqualImpl:$re,prodImpl:Ere,raggedGatherImpl:Rre,raggedRangeImpl:Are,raggedTensorToTensorImpl:Ore,rangeImpl:Dre,rsqrtImpl:jre,scatterImpl:_re,sigmoidImpl:Fre,simpleAbsImpl:m3,sliceImpl:Pre,sparseFillEmptyRowsImpl:Lre,sparseReshapeImpl:Bre,sparseSegmentReductionImpl:g3,sqrtImpl:zre,staticRegexReplaceImpl:Mre,stridedSliceImpl:Vre,stringNGramsImpl:Wre,stringSplitImpl:Ure,stringToHashBucketFastImpl:Gre,subImpl:Hre,tileImpl:Kre,topKImpl:qre,transposeImpl:M2,uniqueImpl:Jre}=QY;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y3(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Dn(t,e){return e===1?[t]:y3(t,e)}function Xre(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yre{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Nn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Dn("rc",this.rank),s=nt(this.rank),a=this.getOutOfBoundsCondition(n),r=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${a}) {
            setOutput(vec4(0));
          } else {
            ${r}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let a=0;a<=1;a++){let r=`${s===0?"r":"rp1"}, ${a===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)r=`${e[e.length-1-i]},`+r;n.push(r)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],a=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${a};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b3{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);let s="";for(let a=0;a<4;a++){let r="thisRC = rc;";a%2===1&&(r+="thisRC.z += 1;"),a>1&&(r+="thisRC.y += 1;"),s+=`
        ${r}
        ${a>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${a}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${a>0?"}":""}
      `}this.userCode=`
      ${Qre(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?B2():L2(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Qre(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Xse(["r","c","d"],"inputShape"):al(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zre{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const a=lI(n,s),r=uI(e,a,s);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);const i=oI(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[r].pop();return this.usedTextures[r].push(l),l}let o;return a===ln.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===ln.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===ln.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===ln.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===ln.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[r].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}releaseTexture(e,n,s,a){if(this.freeTextures==null)return;const r=lI(s,a),i=uI(n,r,a);i in this.freeTextures||(this.freeTextures[i]=[]);const o=oI(n,r,this.gpgpu.gl,this.gpgpu.textureConfig,a),l=W().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const u=this.usedTextures[i],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function eie(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function oI(t,e,n,s,a){const r=tie(e,s);let i;if(a){const[l,u]=xc(t[0],t[1]);i=l*u}else{const[l,u]=Qh(t[0],t[1]);i=l*u}const o=eie(n,r);return i*o}function tie(t,e){switch(t){case ln.PACKED_2X2_FLOAT32:return p3(e);case ln.PACKED_2X2_FLOAT16:return h3(e);case ln.UNPACKED_FLOAT32:return u3(e);case ln.UNPACKED_FLOAT16:return c3(e);case ln.PACKED_4X1_UNSIGNED_BYTE:return d3(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function nie(t){return W().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?ln.PACKED_2X2_FLOAT32:ln.UNPACKED_FLOAT32:t?ln.PACKED_2X2_FLOAT16:ln.UNPACKED_FLOAT16}function lI(t,e){if(t===Ss.UPLOAD)return ln.PACKED_2X2_FLOAT32;if(t===Ss.RENDER||t==null)return nie(e);if(t===Ss.DOWNLOAD||t===Ss.PIXELS)return ln.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function uI(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class za{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Zs="if (isnan(x)) return x;",sie="return x;",cI="return abs(x);",aie="return (x >= 0.0) ? x : (exp(x) - 1.0);",rie=Zs+`
  return (x < 0.0) ? 0.0 : x;
`,iie=Zs+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Gr="return x;",oie="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lie="return x;",uie=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,cie=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,die=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,pie="return 1.0 / (1.0 + exp(-1.0 * x));";class ei{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hie{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);const n=e.length,s=Dn("rc",n),a=nt(n),r=Xre(n,s),i=s.slice(-2),o=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${a} rc = getOutputCoords();
        vec4 packedInput = getA(${r});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fie=h0,mie=1e-7,gie=1e-4,Ff={};function yie(t){return t in Ff||(Ff[t]={}),Ff[t]}const bie=W().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),wie=600;function kie(){return W().global.screen==null?1024:W().global.screen.height*W().global.screen.width*window.devicePixelRatio*wie/1024/1024}class M0 extends Rg{nextDataId(){return M0.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!W().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof zb)n=e;else{const s=va(W().getNumber("WEBGL_VERSION"),e);n=new zb(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=va(W().getNumber("WEBGL_VERSION"));n=new zb(s),this.binaryCache=yie(W().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Zre(this.gpgpu),this.numMBBeforeWarning=kie(),this.texData=new qx(this,ra())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,a,r,i){const o=this.makeTensorInfo(n,s),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[a,r]},l.texShape=[a,r];const u=jf(n),c=new iI(u,!1,i),d=this.runWebGLProgram(c,[o],s,[[a,r]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(o),d.dataId}write(e,n,s){if((W().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||W().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.texData.set(a,{shape:n,dtype:s,values:e,usage:Ss.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,a,r){if(W().getBool("DEBUG")&&this.checkNumericalProblems(n),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:a,values:n,usage:Ss.UPLOAD,refCount:r})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:a,complexTensorInfos:r,slice:i,shape:o,isPacked:l}=n;if(i!=null){let p;l?p=new ei(o,Gr):p=new za(o,Gr);const h=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:a}],a),f=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),f}if(s!=null)return this.convertAndCacheOnCPU(e);if(a==="string")return s;const u=this.activeTimers!=null;let c;u&&(c=$n());let d;if(a==="complex64"){const p=this.readSync(r.real.dataId),h=this.readSync(r.imag.dataId);d=Nr(p,h)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=$n()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const f=this.pendingRead.get(e);return new Promise(m=>f.push(m))}const n=this.texData.get(e),{values:s,shape:a,slice:r,dtype:i,complexTensorInfos:o,isPacked:l}=n;if(r!=null){let f;l?f=new ei(a,Gr):f=new za(a,Gr);const m=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:i}],i),y=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(W().getBool("DEBUG")&&!W().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&W().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(i!=="complex64"&&W().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const f=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(f.texture.texture,...Af(a))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const f=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),m=f[0],y=f[1];d=Nr(m,y)}else if(u==null)d=this.getValuesFromTexture(e);else{const f=K(a);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,f)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const f=this.gpgpu.gl;de(f,()=>f.deleteBuffer(u))}const p=this.convertAndCacheOnCPU(e,d),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(f=>f(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ra().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,n={}){const s=this.texData.get(e),{values:a,shape:r,slice:i,dtype:o,isPacked:l,texture:u}=s;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let h;l?h=new ei(r,Gr):h=new za(r,Gr);const f=this.runWebGLProgram(h,[{dataId:e,shape:r,dtype:o}],o),m=this.readToGPU(f,n);return this.disposeIntermediateTensorInfo(f),m}if(u==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=ra().makeTensorFromTensorInfo(c),p=this.texData.get(c.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(a=>xr(a));return Re(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Re(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!Sse(s))throw W().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:a}=this.texData.get(e),r=K(n);if(W().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),h=this.texData.get(p.dataId),f=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...Af(n)).subarray(0,r);return this.disposeIntermediateTensorInfo(p),f}const i=W().getBool("WEBGL_PACK")&&a===!0,o=i?jf(n):n,l=i?new Bae(o):new Lae(o),u=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,r);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let a=!1;this.programTimersStack==null?(this.programTimersStack=s,a=!0):this.activeTimers.push(s),this.activeTimers=s,e();const r=qa(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=qa(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,a&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(r);o.kernelMs=WE(l),o.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:$n(),endMs:null}}endTimer(e){return W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=$n(),e)}async getQueryTime(e){if(W().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:a,usage:r,isPacked:i,slice:o}=this.texData.get(e),l=o&&o.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(a,s),this.textureManager.releaseTexture(n,a,r,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=bie){return W().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&K(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){ws("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return fie(e.shape,n)}packedUnaryOp(e,n,s){const a=new ei(e.shape,n),r=this.compileAndRun(a,[e],s);return ra().makeTensorFromTensorInfo(r)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const a=m3(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,a)}if(W().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,cI,e.dtype);const n=new za(e.shape,cI),s=this.compileAndRun(n,[e]);return ra().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let a;if(n==="string"&&s!=null&&s.length>0&&Ba(s[0])){const r=s.map(i=>Wa(i));a=this.write(r,e,n)}else a=this.write(s,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}}makeOutput(e,n,s){return ra().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new hie(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Yre(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[cu(e.shape),...du(e.shape)],a={dtype:e.dtype,shape:s,dataId:e.dataId},r=[cu(n),...du(n)],i=new b3(r,s),o=!0,l=[s],u=this.runWebGLProgram(i,[a],e.dtype,l,o);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:a,shape:r,dtype:i}=s;if(n!=null){const p=K(r),h=n[0]*n[1]*4;I(p<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=jf(r);let l;a?l=new Pae(o):l=new Fae(o);const u=!0,c=[n??Af(o)],d=this.runWebGLProgram(l,[{shape:o,dtype:i,dataId:e}],i,c,u,n);return{dtype:i,shape:r,dataId:d.dataId}}runWebGLProgram(e,n,s,a,r=!1,i){const o=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===ep.DENSE){const g=i??Af(e.outputShape);l.texShape=g.map(b=>b*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),K(o.shape)===0)return l.values=en(o.dtype,0),o;const u=[],c=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(g.dataId);if(b.texture==null){if(!e.packedInputs&&K(g.shape)<=W().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:b.values};e.packedInputs&&(b.isPacked=!0,b.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!b.isPacked!=!!e.packedInputs)g=b.isPacked?this.unpackTensor(g):this.packTensor(g),u.push(g),b=this.texData.get(g.dataId);else if(b.isPacked&&!rg(b.shape,g.shape)){const w=g,k=g.shape;g.shape=b.shape,g=this.packedReshape(g,k),u.push(g),b=this.texData.get(g.dataId),w.shape=k}return{shape:g.shape,texData:b,isUniform:!1}});this.uploadToGPU(o.dataId);const d={shape:o.shape,texData:l,isUniform:!1},p=_ae(e,c,d),h=this.getAndSaveBinary(p,()=>Dae(this.gpgpu,e,c,d)),f=this.activeTimers!=null;let m;f&&(m=this.startTimer()),W().get("ENGINE_COMPILE_ONLY")||jae(this.gpgpu,h,c,d,a),u.forEach(g=>this.disposeIntermediateTensorInfo(g)),f&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const y=W().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const g=$n();g-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!W().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&r===!1){const g=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),g}return o}compileAndRun(e,n,s,a,r=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,a,r)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(W().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=M(()=>{if(!W().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=W().getBool("DEBUG");W().set("DEBUG",!1);const n=this.abs(Se(1e-8)).dataSync()[0];if(W().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?mie:gie}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:a,values:r,texture:i,usage:o,isPacked:l}=n;if(i!=null)return;const u=this.activeTimers!=null;let c;u&&(c=$n());let d=n.texShape;if(d==null&&(d=Mse(s,l),n.texShape=d),r!=null){const p=jf(s);let h,f=d[1],m=d[0];const y=r instanceof Uint8Array||r instanceof Uint8ClampedArray;(l||!y)&&([f,m]=xc(d[0],d[1])),l?h=new Mae(p,y):h=new iI(p,y);const g=y?[m,f]:d,b=this.makeTensorInfo(g,a),w=this.texData.get(b.dataId);y?w.usage=Ss.PIXELS:w.usage=Ss.UPLOAD,w.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),f,m,r);const k=[[m,f]],S=this.runWebGLProgram(h,[b],a,k,!0),C=this.texData.get(S.dataId);n.texShape=C.texShape,n.isPacked=C.isPacked,n.usage=C.usage,W().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(n.texture=C.texture,n.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(b),u&&(this.uploadWaitMs+=$n()-c)}else{const p=this.acquireTexture(d,o,a,l);n.texture=p}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:a}=s;return n!=null&&(s.values=xie(n,a)),s.values}acquireTexture(e,n,s,a){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const r=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${r} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,a)}computeBytes(e,n){return e[0]*e[1]*Ld(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(a=>{try{this.checkCompletion_(n),a(!0)}catch(r){throw r}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await Pv(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(s3(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:a,nanLoc:r,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:l}=l3(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=a,e.nanLoc=r,e.outShapeLocation=i,e.outShapeStridesLocation=o,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:a,height:r,width:i,channels:o}=e,l=ra().backend;if(!l.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(a,n,s,r,i,o);return ra().makeTensorFromDataId(u,n,s,l)}}M0.nextDataId=0;function xie(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */r1()&&o1("webgl",()=>new M0,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V2=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class zo{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Te(n,s),this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const il=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Ic{constructor(e,n,s,a=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Te(n,s);const r=this.outputShape.length;this.enableShapeUniforms=Nn(r);let i="";if(a)if(r===0||K(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${nt(r)} coords = getOutputCoords();
        `,r===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Dn("coords",r);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[r-2]} + 1) >= outShape[${r} - 2];
            bool nextColOutOfBounds =
              (${l[r-1]} + 1) >= outShape[${r} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[r-2]} + 1) >= ${this.outputShape[r-2]};
            bool nextColOutOfBounds =
              (${l[r-1]} + 1) >= ${this.outputShape[r-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fs(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const vie={kernelName:Lu,backendName:"webgl",kernelFunc:fs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gi(t){const{inputs:e,backend:n}=t,{real:s,imag:a}=e,r=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(r.dataId),o=fs({inputs:{x:s},backend:n}),l=fs({inputs:{x:a},backend:n});return i.complexTensorInfos={real:o,imag:l},r}const Sie={kernelName:Bg,backendName:"webgl",kernelFunc:Gi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w3="return (a < 0.) ? b * a : a;",k3=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Nie(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{alpha:r}=s,i=n.makeTensorInfo([],"float32",Er(r,"float32")),o=W().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ic(k3,a.shape,i.shape):new zo(w3,a.shape,i.shape),l=n.runWebGLProgram(o,[a,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const Cie={kernelName:Bp,backendName:"webgl",kernelFunc:Nie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3="return (a < 0.) ? b * a : a;",v3=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Iie(t){const{inputs:e,backend:n}=t,{x:s,alpha:a}=e,r=W().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ic(v3,s.shape,a.shape):new zo(x3,s.shape,a.shape);return n.runWebGLProgram(r,[s,a],"float32")}const Tie={kernelName:ah,backendName:"webgl",kernelFunc:Iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tc="if (isnan(x)) return x;";function Ue({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:a,backend:r})=>{const{x:i}=a,o=r,l=s||i.dtype;if(o.shouldExecuteOnCPU([i])&&n!=null){const d=o.texData.get(i.dataId),p=n(d.values,l);return o.makeTensorInfo(i.shape,l,p)}const u=W().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new ei(i.shape,e):c=new za(i.shape,t),o.runWebGLProgram(c,[i],l)}}function gn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:a,dtype:r}){return({inputs:i,backend:o})=>{const{a:l,b:u}=i,c=o;if(s&&l.dtype==="complex64"){const f=c.texData.get(l.dataId),m=c.texData.get(u.dataId),[y,g]=[[f.complexTensorInfos.real,m.complexTensorInfos.real],[f.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(w=>{const[k,x]=w,S={dataId:k.dataId,dtype:k.dtype,shape:l.shape},C={dataId:x.dataId,dtype:x.dtype,shape:u.shape},T=new zo(t,l.shape,u.shape);return c.runWebGLProgram(T,[S,C],Un(k.dtype,x.dtype))}),b=Gi({inputs:{real:y,imag:g},backend:c});return c.disposeIntermediateTensorInfo(y),c.disposeIntermediateTensorInfo(g),b}const d=r||Un(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&a!=null){const f=c.texData.get(l.dataId).values,m=c.texData.get(u.dataId).values,y=l.dtype==="string"?Cr(f):f,g=l.dtype==="string"?Cr(m):m,[b,w]=a(l.shape,u.shape,y,g,d),k=c.makeTensorInfo(w,d),x=c.texData.get(k.dataId);return x.values=b,k}const p=W().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let h;return p?h=new Ic(e,l.shape,u.shape,n):h=new zo(t,l.shape,u.shape),c.runWebGLProgram(h,[l,u],d)}}function tp(t,e=!1){if(t==="linear")return e?lie:sie;if(t==="relu")return e?cie:rie;if(t==="elu")return e?uie:aie;if(t==="relu6")return e?die:iie;if(t==="prelu")return e?v3:x3;if(t==="leakyrelu")return e?k3:w3;if(t==="sigmoid")return e?pie:oie;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S3{constructor(e,n,s,a=!1,r=!1,i=!1,o=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Nn(this.outputShape.length);const c=a?e[1]:e[2],d=Math.ceil(c/2),p=a?"i * 2, rc.y":"rc.y, i * 2",h=r?"rc.z, i * 2":"i * 2, rc.z",f=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",g="";o&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:u?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:y=`vec4 activation(vec4 x) {
          ${o}
        }`,g="result = activation(result);");const b=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let w="rc.x",k="rc.x";e[0]<n[0]?w=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(k=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${w};
        int batchB = ${k};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${h});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${f[0]} * ${m[0]});
          result += (${f[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dI={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class pI{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Te(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hI="return a * b;";function W2(t){const{inputs:e,backend:n}=t,{a:s,b:a}=e,r=Un(s.dtype,a.dtype);if(s.dtype==="complex64"){const o=n.texData.get(s.dataId),l=n.texData.get(a.dataId),u=new pI(dI.REAL,s.shape,a.shape),c=new pI(dI.IMAG,s.shape,a.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:s.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:a.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:a.shape}],p=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),f=Gi({inputs:{real:p,imag:h},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}if(n.shouldExecuteOnCPU([s,a])){const o=n.texData.get(s.dataId),l=n.texData.get(a.dataId),[u,c]=Ire(s.shape,a.shape,o.values,l.values,r),d=n.makeTensorInfo(c,r),p=n.texData.get(d.dataId);return p.values=u,d}let i;return W().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Ic(hI,s.shape,a.shape):i=new zo(hI,s.shape,a.shape),n.runWebGLProgram(i,[s,a],r)}const $ie={kernelName:Ku,backendName:"webgl",kernelFunc:W2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eie(t,e,n){const s=[cu(t.shape),...du(t.shape)],a={dtype:t.dtype,shape:s,dataId:t.dataId},r=[cu(e),...du(e)],i=new b3(r,s),o=!0,l=[s],u=n.runWebGLProgram(i,[a],t.dtype,l,o);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function le(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{shape:r}=s,i=n,o=K(a.shape),l=Xx(r,o),u=K(l);I(o===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${a.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const c=i.texData.get(a.dataId);return c.isPacked&&!rg(a.shape,l)&&!(c.texture!==null&&rg(c.shape,l))?Eie(a,l,i):(i.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype})}const Rie={kernelName:ih,backendName:"webgl",kernelFunc:le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fI{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:a,inSize:r,outSize:i}=e;this.outputShape=[a,i];const o=Math.floor(s/4)*4,l=s%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${Io(d)?d.toPrecision(2):d}, ones);`}let c="";r%s>0&&(c=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aie{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:a,inSize:r,outSize:i}=e;this.outputShape=[a,i];let o="0.0",l="";n==="prod"?o="1.0":n==="min"?(o="1.0 / 1e-20",l="min"):n==="max"&&(o="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(s/4)*4,d=s%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";n==="all"?(o="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):n==="any"&&(o="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let f="";r%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===2}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===3}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oie(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=C0(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function ol(t,e,n,s){const a=Oie(t.shape);let r=t;for(let i=0;i<a.length;i++){const{inSize:o,windowSize:l,outSize:u}=a[i];let c,d;n==="mean"?c=i===0?new fI({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:u},o):new fI({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:u}):c=new Aie({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:u},n),d=r,r=s.runWebGLProgram(c,[r],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Die{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[n[i]];this.outputShape=s,this.rank=s.length;const a=nt(this.rank),r=jie(n);this.userCode=`
    void main() {
      ${a} resRC = getOutputCoords();
      setOutput(getA(${r}));
    }
    `}}function jie(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let a=0;a<t.length;a++)s[t[a]]=n[a];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ie{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let c=0;c<s.length;c++)s[c]=e[n[c]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const a=nt(this.rank),r=y3("rc",this.rank),i=new Array(this.rank);for(let c=0;c<n.length;c++)i[n[c]]=r[c];const o=`vec2(${i.slice(-2).join()})`,l=`++${r[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${o})`;this.userCode=`
    void main() {
      ${a} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${r[this.rank-1]};
      if(++${r[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V0(t,e,n){const s=W().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _ie(t.shape,e):new Die(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fie(t,e,n,s){const a=e,r=t.shape.length,i=Fe(a,t.shape);let o=i;const l=Nt(o,r),u=l!=null;let c=t;u&&(c=V0(t,l,s),o=Dt(o.length,r)),fn("sum",o,r);const[d,p]=sn(c.shape,o);let h=d;n&&(h=Ot(d,i));const f=K(p),y=K(t.shape)/f,g=le({inputs:{x:c},attrs:{shape:[y,f]},backend:s}),b=By(t.dtype),w=ol(g,b,"sum",s),k=le({inputs:{x:w},attrs:{shape:h},backend:s});return s.disposeIntermediateTensorInfo(g),s.disposeIntermediateTensorInfo(w),u&&s.disposeIntermediateTensorInfo(c),k}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W0(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;return Fie(a,r,i,n)}const Pie={kernelName:ph,backendName:"webgl",kernelFunc:W0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _n(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{perm:r}=s,i=n,o=a.shape.length,l=new Array(o);for(let c=0;c<l.length;c++)l[c]=a.shape[r[c]];let u;if(i.shouldExecuteOnCPU([a])){const d=i.texData.get(a.dataId).values,p=M2(d,a.shape,a.dtype,r,l);u=i.makeTensorInfo(l,a.dtype);const h=i.texData.get(u.dataId);h.values=p}else u=V0(a,r,i);return u}const Lie={kernelName:go,backendName:"webgl",kernelFunc:_n};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N3=1e3;function ig({a:t,b:e,transposeA:n,transposeB:s,backend:a,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],p=s?e.shape[c-1]:e.shape[c-2],h=n?t.shape[u-1]:t.shape[u-2],f=s?e.shape[c-2]:e.shape[c-1],m=t.shape.slice(0,-2),y=e.shape.slice(0,-2),g=K(m),b=K(y),k=Te(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([h,f]);I(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const x=n?[g,d,h]:[g,h,d],S=s?[b,f,p]:[b,p,f],C=le({inputs:{x:t},backend:a,attrs:{shape:x}}),T=le({inputs:{x:e},backend:a,attrs:{shape:S}}),E=[C,T],R=Math.max(g,b),L=n?C.shape[1]:C.shape[2],U=r!=null,G=i!=null,F=l==="leakyrelu",z=l!=null?tp(l,!0):null,H=U||G||F||z!=null;let X;if((h===1||f===1)&&L>N3&&H===!1){let V=C,q=T;n&&(V=_n({inputs:{x:C},backend:a,attrs:{perm:[0,2,1]}}),E.push(V)),s&&(q=_n({inputs:{x:T},backend:a,attrs:{perm:[0,2,1]}}),E.push(q));const Y=f!==1,Z=f===1;let ne=V;Y&&(ne=le({inputs:{x:V},backend:a,attrs:{shape:[R,L,1]}}),E.push(ne));const re=f===1?2:1;let ae=q;Z&&(ae=le({inputs:{x:q},backend:a,attrs:{shape:[R,1,L]}}),E.push(ae));const ce=W2({inputs:{a:ne,b:ae},backend:a});X=W0({inputs:{x:ce},backend:a,attrs:{axis:re,keepDims:!0}}),E.push(ce)}else{const V=Un(t.dtype,e.dtype),q=new S3(x,S,[R,h,f],n,s,U,z,G,F),Y=[C,T];if(r!=null&&Y.push(r),G&&Y.push(i),F){const Z=a.makeTensorInfo([],"float32",Er(o,"float32"));Y.push(Z),E.push(Z)}X=a.runWebGLProgram(q,Y,V)}const j=le({inputs:{x:X},backend:a,attrs:{shape:k}});E.push(X);for(const V of E)a.disposeIntermediateTensorInfo(V);return j}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bie(t){const{inputs:e,backend:n,attrs:s}=t,{a,b:r,bias:i,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=s;return ig({a,b:r,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:o,leakyreluAlpha:d,activation:c})}const zie={kernelName:Bd,backendName:"webgl",kernelFunc:Bie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mI="return abs(x);";function Mie(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const r=n.texData.get(s.dataId),i=m3(r.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let a;return W().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new ei(s.shape,mI):a=new za(s.shape,mI),n.runWebGLProgram(a,[s],s.dtype)}const Vie={kernelName:yp,backendName:"webgl",kernelFunc:Mie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wie=Zs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Uie=Ue({opSnippet:Wie}),Gie={kernelName:bu,backendName:"webgl",kernelFunc:Uie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hie=Zs+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Kie=Ue({opSnippet:Hie}),qie={kernelName:wu,backendName:"webgl",kernelFunc:Kie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gI="return a + b;",Jie=gn({opSnippet:gI,packedOpSnippet:gI,supportsComplex:!0,cpuKernelImpl:rre}),Xie={kernelName:Jo,backendName:"webgl",kernelFunc:Jie};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yie{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((r,i)=>`T${i}`);const s=[];this.variableNames.forEach(r=>{s.push(`float v${r} = get${r}AtOutCoords();`)});const a=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${a};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qie{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((r,i)=>`T${i}`);const s=[];this.variableNames.forEach(r=>{s.push(`vec4 v${r} = get${r}AtOutCoords();`)});const a=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${a};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tm(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return fs({inputs:{x:s[0]},backend:n});if(s.length>W().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),u=tm({inputs:s.slice(0,l),backend:n}),c=tm({inputs:s.slice(l),backend:n});return tm({inputs:[u,c],backend:n})}const a=s.map(l=>l.dtype).reduce((l,u)=>Un(l,u)),r=s.map(l=>l.shape),o=W().getBool("WEBGL_PACK")?new Qie(s[0].shape,r):new Yie(s[0].shape,r);return n.runWebGLProgram(o,s,a)}const Zie={kernelName:bp,backendName:"webgl",kernelFunc:tm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eoe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=a.shape.length,l=Fe(r,a.shape);let u=l;const c=Nt(u,o);let d=a;c!=null&&(d=_n({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Dt(u.length,o)),fn("all",u,o);const[p,h]=sn(d.shape,u),f=K(h),m=le({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=ol(m,m.dtype,"all",n);let g;if(i){const b=Ot(p,l);g=le({inputs:{x:y},backend:n,attrs:{shape:b}})}else g=le({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),g}const toe={kernelName:Dg,backendName:"webgl",kernelFunc:eoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function noe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=a.shape.length,l=Fe(r,a.shape);let u=l;const c=Nt(u,o);let d=a;c!=null&&(d=_n({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Dt(u.length,o)),fn("any",u,o);const[p,h]=sn(d.shape,u),f=K(h),m=le({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=ol(m,m.dtype,"any",n);let g;if(i){const b=Ot(p,l);g=le({inputs:{x:y},backend:n,attrs:{shape:b}})}else g=le({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),g}const soe={kernelName:jg,backendName:"webgl",kernelFunc:noe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aoe{constructor(e,n,s){this.variableNames=["A"];const{windowSize:a,batchSize:r,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[r,i];const o=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${a};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${a}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class roe{constructor(e,n,s,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,I(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const r=e[e.length-1],i=Math.ceil(r/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,u=nt(l),c=Dn("coords",l);let d,p;if(i===1){p=l+1;const T=nt(p);d=`
        ${T} sourceLocR = ${T}(${c.join()}, 0);
        ++${c[l-1]};
        ${T} sourceLocG = ${T}(${c.join()}, 0);
        ++${c[l-2]};
        ${T} sourceLocA = ${T}(${c.join()}, 0);
        --${c[l-1]};
        ${T} sourceLocB = ${T}(${c.join()}, 0);
        --${c[l-2]};`}else p=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const h=["x","y","z","w","u","v"].slice(0,p),f="."+h[p-1],m=h.map(T=>"int "+T),y=Dn("sourceLocR",p-1).concat("inIdx.r"),g=Dn("sourceLocG",p-1).concat("inIdx.g"),b=Dn("sourceLocB",p-1).concat("inIdx.b"),w=Dn("sourceLocA",p-1).concat("inIdx.a"),k=s==="max"?"greaterThan":"lessThan",x=a?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${w.join()})));`,S=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,C=a?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${C}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${o[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${x}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${k}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C3(t,e,n,s=null){let a=e.shape[0],r=e.shape[1];s!=null&&(a=s.shape[0],r=s.shape[1]);const i=C0(r),o={windowSize:i,inSize:r,batchSize:a,outSize:Math.ceil(r/i)},l=new aoe(o,n,s==null),u=[e];s!=null&&u.push(s);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=C3(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function I3(t,e,n,s=null){const a=s!=null?s.shape:e.shape,r=a[a.length-1],i=C0(r),o=new roe(a,i,n,s==null),l=s==null?[e]:[e,s],u=t.runWebGLProgram(o,l,"int32");if(u.shape.length===e.shape.length){const c=I3(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function T3(t,e,n,s){const a=[n];if(fn("arg"+s.charAt(0).toUpperCase()+s.slice(1),a,e.shape.length),!W().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const r=[],i=t.texData.get(e.dataId),o=i!==null&&i.isPacked;let l=e;o&&(l=t.unpackTensor(e),r.push(l));const[u,c]=sn(l.shape,a),d=K(c),p=le({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});r.push(p);const h=C3(t,p,s);r.push(h);const f=le({inputs:{x:h},backend:t,attrs:{shape:u}});return r.forEach(m=>t.disposeIntermediateTensorInfo(m)),f}return I3(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r}=s;let i=Fe(r,a.shape);const o=Nt(i,a.shape.length);let l=a;const u=[];o!=null&&(l=_n({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),i=Dt(i.length,l.shape.length)),fn("argMax",[i[0]],l.shape.length);const c=T3(n,l,i[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const ooe={kernelName:wp,backendName:"webgl",kernelFunc:ioe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r}=s;let i=Fe(r,a.shape);const o=Nt(i,a.shape.length);let l=a;const u=[];o!=null&&(l=_n({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),i=Dt(i.length,l.shape.length)),fn("argMin",[i[0]],l.shape.length);const c=T3(n,l,i[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const uoe={kernelName:kp,backendName:"webgl",kernelFunc:loe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const coe=Zs+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,doe=Ue({opSnippet:coe}),poe={kernelName:ku,backendName:"webgl",kernelFunc:doe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hoe=Zs+"return log(x + sqrt(x * x + 1.0));",foe=Ue({opSnippet:hoe}),moe={kernelName:xu,backendName:"webgl",kernelFunc:foe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const goe=Zs+`
  return atan(x);
`,yoe=Ue({opSnippet:goe}),boe={kernelName:vu,backendName:"webgl",kernelFunc:yoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const woe=V2+`
  return atan(a, b);
`,koe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+il+`
  return result;
`,xoe=gn({opSnippet:woe,packedOpSnippet:koe}),voe={kernelName:Nu,backendName:"webgl",kernelFunc:xoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Soe=Zs+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Noe=Ue({opSnippet:Soe}),Coe={kernelName:Su,backendName:"webgl",kernelFunc:Noe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class np{constructor(e,n,s,a=!1,r=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let b="0.0";if(m||(b="-1.0 / 1e-20"),s){const T=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${h}, ${f});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${T} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${a?r?y:g:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / max(count, 1.0)");const x=Math.floor(i/4)*4,S=i%4,C=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${h}, ${f});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${x}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${C}
          }

          int xC = xCCorner + ${x};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${C}
          }
        }
        setOutput(${k});
      }
    `}}class U2{constructor(e,n,s,a=!1,r=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,p=e.dilationWidth,h=e.effectiveFilterDepth,f=e.effectiveFilterHeight,m=e.effectiveFilterWidth,y=e.padInfo.front,g=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let k="0.0";if(w||(k="-1.0 / 1e-20"),s){const R=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${u});
        const ivec3 pads = ivec3(${y}, ${g}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${f};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${R} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${a?r?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${f} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const x="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / max(count, 1.0)");const C=Math.floor(i/4)*4,T=i%4,E=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${x}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${u});
      const ivec3 pads = ivec3(${y}, ${g}, ${b});
      const float initializationValue = ${k};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${k});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${C}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${E}
            }

            int xC = xCCorner + ${C};
            if (${T===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${T===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${T===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${E}
            }
          }
        }
        setOutput(${S});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ioe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;Zh(a,"avgPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=s,u=1;I(hn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Ys(a.shape,r,i,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Le(c.inShape,c.outShape))return fs({inputs:{x:a},backend:n});const d=new np(c,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}const Toe={kernelName:xp,backendName:"webgl",kernelFunc:Ioe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $oe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:l,dataFormat:u}=s,c=[1,1,1],d=Rr(a.shape,r,i,c,o,l,u),p=new U2(d,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}const Eoe={kernelName:vp,backendName:"webgl",kernelFunc:$oe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Roe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,p=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Aoe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=d-1-e.padInfo.front,m=p-1-e.padInfo.top,y=h-1-e.padInfo.left,g=1/(n*s*a);this.userCode=`
      const ivec3 pads = ivec3(${f}, ${m}, ${y});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${r}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ooe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,i=r,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=s,d=[1,1,1],p=Rr(i.shape,o,l,d,u,c),h=new Aoe(p);return n.runWebGLProgram(h,[a],i.dtype)}const Doe={kernelName:Fg,backendName:"webgl",kernelFunc:Ooe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function joe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,i=r;Zh([a,r],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=s,c=Ys(i.shape,o,l,1,u),d=new Roe(c);return n.runWebGLProgram(d,[a],i.dtype)}const _oe={kernelName:_g,backendName:"webgl",kernelFunc:joe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Foe(t){const{inputs:e,backend:n,attrs:s}=t,{a,b:r}=e,{transposeA:i,transposeB:o}=s;return ig({a,b:r,transposeA:i,transposeB:o,backend:n})}const Poe={kernelName:Sp,backendName:"webgl",kernelFunc:Foe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Loe{constructor(e,n,s,a,r,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Te(e,n),Te(e,s);let o="0.0";a!=null&&(Te(e,a),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";r!=null&&(Te(e,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Boe{constructor(e,n,s,a,r,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Te(e,n),Te(e,s);let o="vec4(0.0)";a!=null&&(Te(e,a),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";r!=null&&(Te(e,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zoe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:a,variance:r,offset:i,scale:o}=t;I(a.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),I(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),I(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[s,a,r];let c=null;i!=null&&(c=i.shape,u.push(i));let d=null;o!=null&&(d=o.shape,u.push(o));const p=W().getBool("WEBGL_PACK_NORMALIZATION")?new Boe(s.shape,a.shape,r.shape,c,d,l):new Loe(s.shape,a.shape,r.shape,c,d,l);return e.runWebGLProgram(p,u,u[0].dtype)},Moe={kernelName:Fp,backendName:"webgl",kernelFunc:zoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Voe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=nt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Woe(this.rank);let a;const r=e.map((i,o)=>`sourceLoc.${Pk[o]} = start[${o}] + coords.${Pk[o]};`);a=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${r.join(`
`)}
      `,this.userCode=`
      void main() {
        ${a}
        setOutput(getSource(${s}));
      }
    `}}const Pk=["x","y","z","w","u","v"];function Woe(t){if(t===1)return"sourceLoc";if(t<=6)return Pk.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uoe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=nt(this.rank),s=Dn("coords",this.rank),a=Dn("sourceLoc",this.rank),r=this.rank===1?"sourceLoc":`vec2(${a.slice(-2).join()})`,i=`getChannel(getSource(${a.join()}), ${r})`,o=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${a[this.rank-1]};
        result.y = ${i};
        --${a[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${a[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${a[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${a[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Goe(t,e,n,s){const a=s.texData.get(t.dataId),r=s.makeTensorInfo(n,t.dtype),i=s.texData.get(r.dataId);Object.assign(i,a),i.refCount=1,i.shape=n,i.dtype=t.dtype;let o=_v(e,ve(t.shape));a.slice&&(o+=a.slice.flatOffset),i.slice={flatOffset:o,origDataId:a.slice&&a.slice.origDataId||t.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),r}function $c(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{begin:r,size:i}=s,[o,l]=N0(a,r,i);if(Ov(a,o,l),K(l)===0)return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||a.dtype==="string"){const d=n.texData.get(a.dataId),p=Pre(d.values,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,p)}const{isPacked:u}=n.texData.get(a.dataId),c=jv(a.shape,o,l);if(u||!c){const d=W().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Uoe(l):new Voe(l),p=[o];return n.runWebGLProgram(d,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),Goe(a,o,l,n)}const Hoe={kernelName:dh,backendName:"webgl",kernelFunc:$c};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Koe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockShape:r,crops:i}=s;I(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=r.reduce((b,w)=>b*w),l=zh(a.shape,r,o),u=Mh(l.length,r.length),c=Vh(a.shape,r,o),d=Mv(i,r.length),p=Vv(c,i,r.length),h=[],f=le({inputs:{x:a},backend:n,attrs:{shape:l}}),m=_n({inputs:{x:f},backend:n,attrs:{perm:u}}),y=le({inputs:{x:m},backend:n,attrs:{shape:c}}),g=$c({inputs:{x:y},backend:n,attrs:{begin:d,size:p}});return h.push(f),h.push(m),h.push(y),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),g},qoe={kernelName:Np,backendName:"webgl",kernelFunc:Koe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Joe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,weights:r}=e,{size:i}=s,o=n.readSync(a.dataId),l=n.readSync(r.dataId),u=f3(o,l,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,u)}const Xoe={kernelName:Pg,backendName:"webgl",kernelFunc:Joe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Qoe=`
  return float(int(a.r) & int(b.r));
`;function Zoe(t){const{inputs:e,backend:n}=t,{a:s,b:a}=e,r=W().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=W().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,a])||i===1){const l=n.texData.get(s.dataId).values,u=n.texData.get(a.dataId).values,[c,d]=ore(s.shape,a.shape,l,u,s.dtype),p=n.makeTensorInfo(d,s.dtype),h=n.texData.get(p.dataId);return h.values=c,p}let o;return r?o=new Ic(Yoe,s.shape,a.shape,!1):o=new zo(Qoe,s.shape,a.shape),n.runWebGLProgram(o,[s,a],s.dtype)}const ele={kernelName:Cp,backendName:"webgl",kernelFunc:Zoe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tle(t){const{inputs:e,backend:n}=t,{s0:s,s1:a}=e,r=n.readSync(s.dataId),i=n.readSync(a.dataId),o=Te(Array.from(r),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const nle={kernelName:Lg,backendName:"webgl",kernelFunc:tle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sle="return float(a != b);",$3=gn({opSnippet:sle,cpuKernelImpl:$re,dtype:"bool"}),ale={kernelName:Zp,backendName:"webgl",kernelFunc:$3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tf(t){const{inputs:e,backend:n}=t,{input:s}=e,a=n.texData.get(s.dataId);return fs({inputs:{x:a.complexTensorInfos.real},backend:n})}const rle={kernelName:by,backendName:"webgl",kernelFunc:tf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ile="return float(int(x));";function ole(t,e){const n=new za(t.shape,ile),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lk(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{dtype:r}=s;if(r==="complex64"){if(a.dtype==="complex64")return fs({inputs:{x:a},backend:n});const i=Lt(a.shape),o=Lk({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=Gi({inputs:{real:o,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(o),l}if(a.dtype==="complex64"){const i=tf({inputs:{input:a},backend:n}),o=Lk({inputs:{x:i},backend:n,attrs:{dtype:r}});return n.disposeIntermediateTensorInfo(i),o}if(!Yx(a.dtype,r)){const i=fs({inputs:{x:a},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:r}}if(n.shouldExecuteOnCPU([a])){const i=n.texData.get(a.dataId).values,[o,l,u]=lre(i,a.shape,a.dtype,r);return n.makeTensorInfo(o,l,u)}if(r==="int32")return ole(a,n);if(r==="bool"){const i=n.makeTensorInfo([],"bool",en("bool",1)),l=$3({inputs:{a,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${r}`)}const lle={kernelName:Cu,backendName:"webgl",kernelFunc:Lk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yI="return ceil(x);",ule=Ue({opSnippet:yI,packedOpSnippet:yI,cpuKernelImpl:ure}),cle={kernelName:Iu,backendName:"webgl",kernelFunc:ule};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dle{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ple{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hle(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{clipValueMin:r,clipValueMax:i}=s;let o;W().getBool("WEBGL_PACK_CLIP")?o=new ple(a.shape):o=new dle(a.shape);const l=[[r],[i]];return n.runWebGLProgram(o,[a],a.dtype,l)}const fle={kernelName:Tu,backendName:"webgl",kernelFunc:hle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mle{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bI(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function gle(t){const{inputs:e,backend:n}=t,{x:s}=e,a=n.texData.get(s.dataId),r=new mle(s.shape),i=[bI(s,a.complexTensorInfos.real),bI(s,a.complexTensorInfos.imag)];return n.runWebGLProgram(r,i,i[0].dtype)}const yle={kernelName:Ip,backendName:"webgl",kernelFunc:gle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ble{constructor(e){this.outputShape=[],this.outputShape=Ga(e,1),this.variableNames=e.map((i,o)=>`T${o}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const o=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${o}));`)}const a=n.length,r=n[n.length-1];s.push(`else setOutput(getT${a}(yR, yC-${r}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wle{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ga(e,n);const s=this.outputShape,a=s.length,r=nt(a),i=Dn("coords",a),o=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((m,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const u=o[n],c=o.slice(-2),d=o.join();let p=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let m=1;m<l.length;m++){const y=l[m-1];p+=`
        if (${u} < ${l[m]}  && ${u} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${Pf(o,u,y)}),
            vec2(${Pf(c,u,y)}));
        }`}const h=l.length,f=l[l.length-1];p+=`
        return getChannel(
          getT${h}(${Pf(o,u,f)}),
          vec2(${Pf(c,u,f)}));`,this.userCode=`
      float getValue(${o.map(m=>"int "+m)}) {
        ${p}
      }

      void main() {
        ${r} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[a-1]} = ${i[a-1]} + 1;
        if (${i[a-1]} < ${s[a-1]}) {
          result.g = getValue(${i});
        }

        ${i[a-2]} = ${i[a-2]} + 1;
        if (${i[a-2]} < ${s[a-2]}) {
          result.a = getValue(${i});
        }

        ${i[a-1]} = ${i[a-1]} - 1;
        if (${i[a-2]} < ${s[a-2]} &&
            ${i[a-1]} < ${s[a-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function Pf(t,e,n){const s=t.indexOf(e);return t.map((r,i)=>i===s?`${r} - ${n}`:r).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U0(t){const{inputs:e,backend:n}=t,{input:s}=e,a=n.texData.get(s.dataId);return fs({inputs:{x:a.complexTensorInfos.imag},backend:n})}const kle={kernelName:ay,backendName:"webgl",kernelFunc:U0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nd(t,e,n){const s=t[0].dtype;if(s==="complex64"){const h=t.map(b=>tf({inputs:{input:b},backend:n})),f=t.map(b=>U0({inputs:{input:b},backend:n})),m=nd(h,e,n),y=nd(f,e,n),g=Gi({inputs:{real:m,imag:y},backend:n});return h.forEach(b=>n.disposeIntermediateTensorInfo(b)),f.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),g}let a=n.shouldExecuteOnCPU(t);if(s==="string"&&(a=!0),a){const h=t.map(k=>{const S=[-1,K(k.shape.slice(e))];return le({inputs:{x:k},backend:n,attrs:{shape:S}})}),f=h.map(k=>({vals:n.readSync(k.dataId),shape:k.shape})),m=Ga(h.map(k=>k.shape),1),y=h[0].shape[0]===1,g=cre(f,m,s,y),b=Ga(t.map(k=>k.shape),e),w=n.makeTensorInfo(b,s,g);return h.forEach(k=>n.disposeIntermediateTensorInfo(k)),w}const r=t.filter(h=>K(h.shape)>0),i=W().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1;if(r.length===1){const h=i?new za(t[0].shape,Gr):new ei(t[0].shape,Gr);return n.runWebGLProgram(h,t,s)}const o=W().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(r.length>o){const h=[];for(let m=0;m<r.length;m+=o){const y=r.slice(m,m+o);h.push(nd(y,e,n))}const f=nd(h,e,n);for(const m of h)n.disposeIntermediateTensorInfo(m);return f}if(i){const h=new wle(r.map(f=>f.shape),e);return n.runWebGLProgram(h,r,s)}const{tensors2D:l,outShape:u}=xle(r,e,n),c=new ble(l.map(h=>h.shape)),d=n.runWebGLProgram(c,l,s);l.forEach(h=>n.disposeIntermediateTensorInfo(h));const p=le({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),p}function xle(t,e,n){const s=Ga(t.map(r=>r.shape),e);return{tensors2D:t.map(r=>le({inputs:{x:r},attrs:{shape:[-1,K(r.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E3(t){const{inputs:e,backend:n,attrs:s}=t,{axis:a}=s,r=Fe(a,e[0].shape)[0],i=e.map(u=>u.shape);Lv(i,r);const o=Ga(e.map(u=>u.shape),r);if(K(o)===0)return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(u=>K(u.shape)>0);return l.length===1?fs({inputs:{x:l[0]},backend:n}):nd(l,r,n)}const vle={kernelName:Tp,backendName:"webgl",kernelFunc:E3};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R3{constructor(e,n=!1,s=null,a=!1,r=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,h=e.filterWidth,f=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,y=e.dataFormat==="channelsLast",g=y?1:2,b=y?2:3,w=y?3:1;let k="",x="";s&&(a?k=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?k=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:k=`
          float activation(float x) {
            ${s}
          }
        `,x="result = activation(result);");const S=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${k}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${f}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${f}) *
                    getW(wR, wC, ${f}, d2);
              } else {
                dotProd +=
                    getX(batch, ${f}, xR, xC) *
                    getW(wR, wC, ${f}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2),
                getW(wR, wC, ${f} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1),
                  getX(batch, xR, xC, ${f} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC),
                  getX(batch, ${f} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${x}
        setOutput(result);
      }
    `}}class Sle{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,a=e.padInfo.left,r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,p=e.filterHeight,h=e.filterWidth,f=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${r}, ${i}, ${o});
      const ivec3 pads = ivec3(${n}, ${s}, ${a});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${f}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${f}) *
                  getW(wF, wR, wC, ${f}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1),
                  getX(batch, xF, xR, xC, ${f} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2),
                  getW(wF, wR, wC, ${f} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A3{constructor(e,n=!1,s=null,a=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Nn(this.outputShape.length);const i=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<c;y++)p+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;p+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<c;y++)p+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const g=y*2;if(p+=`
           xC = xCCorner + ${g*l};
           `,o===1){if(g<c&&(i%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,l===1&&g>0?p+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<c)){const b=i%2===0?Ag(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:p+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):b===1?p+=`
                     xC${g+1} = xTexelC${g};
                     `:p+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<c&&(i%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<c&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<c&&(p+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<c&&(p+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<c&&(p+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let h="",f="";s&&(a?h=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:r?h=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:h=`vec4 activation(vec4 x) {
           ${s}
         }`,f="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${f}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nle{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);const{dataFormat:s}=n,a=Pn(),r=s==="channelsLast",i=r?1:2,o=r?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${r}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${a.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function og(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function O3({x:t,filter:e,convInfo:n,backend:s,bias:a=null,preluActivationWeights:r=null,leakyreluAlpha:i=0,activation:o=null}){const l=t.shape,u=s.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,h=n.dataFormat==="channelsLast",f=!1,m=!1;let y;const g=[];if(r!=null){const k=og(r.shape,h);k!=null&&(r=le({inputs:{x:r},backend:s,attrs:{shape:k}}),g.push(r))}if(a!=null){const k=og(a.shape,h);k!=null&&(a=le({inputs:{x:a},backend:s,attrs:{shape:k}}),g.push(a))}if(!((d===1||p===1)&&c>N3)&&u.isPacked&&h&&u.texture!=null&&l[2]%2!==0&&Le(u.shape.slice(-3),l.slice(-3))){const k=l[0]*l[1]*(l[2]+1),x={dataId:t.dataId,shape:[1,k,n.inChannels],dtype:t.dtype},S=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,I(rg(u.shape,x.shape),()=>`packed reshape ${u.shape} to ${x.shape} isn't free`);const C=le({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(C);const T=ig({a:x,b:C,backend:s,transposeA:f,transposeB:m,bias:a,activation:o,preluActivationWeights:r,leakyreluAlpha:i}),E=s.texData.get(T.dataId);I(E.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=S,E.shape=n.outShape,y=fs({inputs:{x:T},backend:s}),y.shape=n.outShape,g.push(T)}else{const k=n.outHeight*n.outWidth,x=le({inputs:{x:t},backend:s,attrs:{shape:h?[n.batchSize,k,n.inChannels]:[n.batchSize,n.inChannels,k]}}),S=le({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=ig({a:h?x:S,b:h?S:x,transposeA:!h,transposeB:m,backend:s,bias:a,activation:o,preluActivationWeights:r,leakyreluAlpha:i});y=le({inputs:{x:C},backend:s,attrs:{shape:n.outShape}}),g.push(x),g.push(S),g.push(C)}for(const k of g)s.disposeIntermediateTensorInfo(k);return y}function D3({x:t,filter:e,convInfo:n,backend:s,bias:a=null,preluActivationWeights:r=null,leakyreluAlpha:i=0,activation:o=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:p,dataFormat:h}=n,f=h==="channelsLast",m=l*u*c,y=p*d,g=[n.batchSize,m,y],b=!0,w=!1,k=[];if(r!=null){const j=og(r.shape,f);j!=null&&(r=le({inputs:{x:r},backend:s,attrs:{shape:j}}),k.push(r))}if(a!=null){const j=og(a.shape,f);j!=null&&(a=le({inputs:{x:a},backend:s,attrs:{shape:j}}),k.push(a))}const x=le({inputs:{x:e},backend:s,attrs:{shape:[1,m,K(e.shape)/m]}});k.push(x);const S=new Nle(g,n),C=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],T=s.runWebGLProgram(S,[t],"float32",C),E=le({inputs:{x:T},backend:s,attrs:{shape:g}});k.push(T),k.push(E);const R=a!=null,L=r!=null,U=o==="leakyrelu",G=o?tp(o,!0):null,F=new S3(f?E.shape:x.shape,f?x.shape:E.shape,f?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],b,w,R,G,L,U),z=f?[E,x]:[x,E];if(a&&z.push(a),L&&z.push(r),U){const j=s.makeTensorInfo([],"float32",Er(i,"float32"));z.push(j),k.push(j)}const H=s.runWebGLProgram(F,z,"float32"),X=le({inputs:{x:H},backend:s,attrs:{shape:n.outShape}});k.push(H);for(const j of k)s.disposeIntermediateTensorInfo(j);return X}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cle(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=s,d=Ar(l),p=nn(a.shape,r.shape,i,u,o,c,!1,d);let h;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))h=O3({x:a,filter:r,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&W().getBool("WEBGL_EXP_CONV")){const m=new A3(p),y=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];h=n.runWebGLProgram(m,[a,r],"float32",y)}else if(W().getBool("WEBGL_CONV_IM2COL"))h=D3({x:a,filter:r,convInfo:p,backend:n});else{const m=new R3(p);h=n.runWebGLProgram(m,[a,r],"float32")}const f=le({inputs:{x:h},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(h),f}const Ile={kernelName:$p,backendName:"webgl",kernelFunc:Cle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tle{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class $le{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dataFormat==="channelsLast",o=n-1-e.padInfo.top,l=s-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Ele{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,a=e.strideWidth,r=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${r};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${a} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Rle{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=n-1-e.padInfo.front,u=s-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${r}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${a}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${a} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ale(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=s,d=Ar(l),p=nn(a.shape,c,i,1,o,u,!1,d),h=new Tle(p);return n.runWebGLProgram(h,[a,r],"float32")}const Ole={kernelName:zg,backendName:"webgl",kernelFunc:Ale};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dle{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Nn(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,a=n-1-e.padInfo.top,r=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${r});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{inputShape:i,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=s,d=Ar(u),p=nn(i,r.shape,o,1,l,c,!1,d);if(W().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const h=[[p.strideHeight,p.strideWidth]],f=new Dle(p);return n.runWebGLProgram(f,[a,r],"float32",h)}else{const h=new $le(p);return n.runWebGLProgram(h,[a,r],"float32")}}const _le={kernelName:Ep,backendName:"webgl",kernelFunc:jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l}=s,u=Pi(a.shape,r.shape,i,l,o),c=new Sle(u);return n.runWebGLProgram(c,[a,r],"float32")}const Ple={kernelName:Rp,backendName:"webgl",kernelFunc:Fle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lle(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,pad:o,filterShape:l}=s,u=Pi(a.shape,l,i,1,o),c=new Ele(u);return n.runWebGLProgram(c,[a,r],"float32")}const Ble={kernelName:Mg,backendName:"webgl",kernelFunc:Lle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zle(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{pad:i,strides:o,inputShape:l}=s,u=Pi(l,r.shape,o,1,i),c=new Rle(u);return n.runWebGLProgram(c,[a,r],"float32")}const Mle={kernelName:Vg,backendName:"webgl",kernelFunc:zle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vle=Tc+`
  return cos(x);
`,Wle=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${il}
  return result;
`,Ule=Ue({opSnippet:Vle,packedOpSnippet:Wle}),Gle={kernelName:$u,backendName:"webgl",kernelFunc:Ule};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hle=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Kle=Ue({opSnippet:Hle}),qle={kernelName:Eu,backendName:"webgl",kernelFunc:Kle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jle{constructor(e,n,s,a,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,o,l,u]=e,[c]=n,[d,p]=s;this.outputShape=[c,d,p,u];const h=a==="bilinear"?1:0,[f,m]=[`${o-1}.0`,`${l-1}.0`],[y,g,b]=d>1?[`${(o-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${f} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${f}`],[w,k,x]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${k};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${f} ) {
          setOutput(float(${r}));
          return;
        }
        float in_x = ${x};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${r}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${h} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xle=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:a,boxes:r,boxInd:i}=e,{cropSize:o,method:l,extrapolationValue:u}=s,c=new Jle(a.shape,r.shape,o,l,u);return n.runWebGLProgram(c,[a,r,i],"float32")},Yle={kernelName:Ug,backendName:"webgl",kernelFunc:Xle};var sp;(function(t){t.Prod="*",t.Sum="+"})(sp||(sp={}));class wI{constructor(e,n,s,a){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const r=this.outputShape.length,i=this.op===sp.Prod?"1.0":"0.0",o=s?i:`getX(${kI(r,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";s?(u=a?`end != ${l-1}`:"end != 0",c=a?"end + 1":"end - 1"):(u=a?`end + pow2 < ${l}`:"end >= pow2",c=a?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${nt(r)} coords = getOutputCoords();
        int end = ${xI(r,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${xI(r,"coords",this.op)} = idx;
          val ${this.op}= getX(${kI(r,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function kI(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function xI(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j3(t,e,n,s,a,r){const i=e.shape.length,o=Nt([s],i);let l=e;o!=null&&(l=_n({inputs:{x:e},backend:n,attrs:{perm:o}}));const u=Dt(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const c=l.shape[u];let d=fs({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(c))-1;p++){const h=new wI(t,l.shape,!1,r),f=[[p]],m=d;d=n.runWebGLProgram(h,[d],d.dtype,f),n.disposeIntermediateTensorInfo(m)}if(a){const p=new wI(t,l.shape,a,r),h=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(o!=null){const p=Li(o),h=_n({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),h}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qle(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,exclusive:i,reverse:o}=s;return j3(sp.Prod,a,n,r,i,o)}const Zle={kernelName:Wg,backendName:"webgl",kernelFunc:Qle};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,exclusive:i,reverse:o}=s;return j3(sp.Sum,a,n,r,i,o)}const tue={kernelName:Ap,backendName:"webgl",kernelFunc:eue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,weights:r}=e,{size:i,binaryOutput:o}=s;if(a.shape.length===1){const l=n.readSync(a.dataId),u=n.readSync(r.dataId),c=f3(l,u,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,c)}else if(a.shape.length===2){const l=n.bufferSync(a),u=n.bufferSync(r),c=ire(l,u,i,o);return n.makeTensorInfo(c.shape,r.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const sue={kernelName:Gg,backendName:"webgl",kernelFunc:nue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aue{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockSize:r,dataFormat:i}=s,o=a.shape[0],l=i==="NHWC"?a.shape[1]:a.shape[2],u=i==="NHWC"?a.shape[2]:a.shape[3],c=i==="NHWC"?a.shape[3]:a.shape[1],d=l*r,p=u*r,h=c/(r*r),f=i==="NHWC"?[o,d,p,h]:[o,h,d,p],m=new aue(f,r,i);return n.runWebGLProgram(m,[a],a.dtype)}const iue={kernelName:Hg,backendName:"webgl",kernelFunc:rue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _3{constructor(e,n=!1,s=null,a=!1,r=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Nn(this.outputShape.length);const i=e.filterHeight,o=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";s&&(a?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F3{constructor(e,n=!1,s=null,a=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Nn(this.outputShape.length);const i=e.outChannels/e.inChannels,o=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,p=d;let h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<d;g++)h+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let g=0;g<d;g++)h+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(p+1)/2;g++){const b=g*2;if(h+=`
          xC = xCCorner + ${b*u};
          `,l===1){if(b<d&&(o%2===1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,u===1&&b>0?h+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<d)){const w=o%2===0?Ag(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,u>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:h+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):w===1?h+=`
                    xC${b+1} = xTexelC${b};
                    `:h+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<d&&(o%2===1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<d&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<d&&(h+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<d&&(h+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<d&&(h+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  `,h+=`
      }
    `;let f="",m="";s&&(a?f=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?f=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:f=`vec4 activation(vec4 x) {
          ${s}
        }`,m="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oue(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l,dimRoundingMode:u}=s;let c=l;c==null&&(c=[1,1]),I(hn(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=nn(a.shape,r.shape,i,c,o,u,!0);let p;W().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new F3(d):p=new _3(d);const h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[a,r],"float32",h)}const lue={kernelName:Op,backendName:"webgl",kernelFunc:oue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uue{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class cue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=n-1-e.padInfo.top,o=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function due(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=s,d=nn(a.shape,c,i,o,l,u,!0),p=new uue(d);return n.runWebGLProgram(p,[a,r],"float32")}const pue={kernelName:Kg,backendName:"webgl",kernelFunc:due};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=s,d=nn(c,r.shape,i,o,l,u,!0),p=new cue(d);return n.runWebGLProgram(p,[a,r],"float32")}const fue={kernelName:qg,backendName:"webgl",kernelFunc:hue};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mue{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gue(t){const{inputs:e,backend:n}=t,{x:s}=e,a=[...s.shape,...s.shape],r=K(s.shape),i=le({inputs:{x:s},backend:n,attrs:{shape:[r]}}),o=new mue(r),l=n.runWebGLProgram(o,[i],i.dtype),u=le({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}const yue={kernelName:Jg,backendName:"webgl",kernelFunc:gue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bue{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:a,strideHeight:r,strideWidth:i,filterHeight:o,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:p}=a;this.userCode=`
      const ivec2 strides = ivec2(${r}, ${i});
      const ivec2 pads = ivec2(${d}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l}=s,u=vh(a.shape,r.shape,i,o,"NHWC",l);let c;const d=new bue(u);c=n.runWebGLProgram(d,[a,r],"float32");const p=le({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),p}const kue={kernelName:Dp,backendName:"webgl",kernelFunc:wue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xue(t){const{inputs:e,backend:n,attrs:s}=t,{equation:a}=s,r=e,{allDims:i,summedDims:o,idDims:l}=Xv(a,r.length);Qv(i.length,l,r);const{path:u,steps:c}=Zv(o,l),d=c.length;let p=null,h=i.length;const f=[];for(let m=0;m<d;++m){for(const y of c[m]){const{permutationIndices:g,expandDims:b}=Yv(h,l[y]);let w;e2(g)?w=r[y]:(w=_n({inputs:{x:r[y]},backend:n,attrs:{perm:g}}),f.push(w));const k=w.shape.slice();for(let x=0;x<b.length;++x)k.splice(b[x],0,1);Le(w.shape,k)||(w=le({inputs:{x:w},backend:n,attrs:{shape:k}}),f.push(w)),p===null?p=w:(p=W2({inputs:{a:w,b:p},backend:n}),f.push(p))}m<d-1&&(u[m]>=0&&(p=W0({inputs:{x:p},backend:n,attrs:{axis:u[m]-(i.length-h),keepDims:!1}}),f.push(p)),h--)}for(const m of f)m!==p&&n.disposeIntermediateTensorInfo(m);return p}const vue={kernelName:Yg,backendName:"webgl",kernelFunc:xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sue="return (x >= 0.0) ? x : (exp(x) - 1.0);",Nue=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Cue=Ue({opSnippet:Sue,packedOpSnippet:Nue}),Iue={kernelName:Au,backendName:"webgl",kernelFunc:Cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tue="return (b >= 0.0) ? a : a * (b + 1.0);",$ue=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Eue=t=>{const{inputs:e,backend:n}=t,{dy:s,y:a}=e,r=W().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ic($ue,s.shape,a.shape):new zo(Tue,s.shape,a.shape);return n.runWebGLProgram(r,[s,a],s.dtype)},Rue={kernelName:Qg,backendName:"webgl",kernelFunc:Eue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aue=`
  return vec4(equal(a, b));
`,Oue="return float(a == b);",Due=gn({opSnippet:Oue,packedOpSnippet:Aue,dtype:"bool",cpuKernelImpl:dre}),jue={kernelName:jp,backendName:"webgl",kernelFunc:Due};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ue=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${Wv};
  float a1 = ${Uv};
  float a2 = ${Gv};
  float a3 = ${Hv};
  float a4 = ${Kv};
  float a5 = ${qv};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Fue=Ue({opSnippet:_ue}),Pue={kernelName:Ou,backendName:"webgl",kernelFunc:Fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lue=Tc+`
  return exp(x);
`,Bue=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,P3=Ue({opSnippet:Lue,packedOpSnippet:Bue,cpuKernelImpl:pre,dtype:"float32"}),zue={kernelName:Du,backendName:"webgl",kernelFunc:P3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bk(t){const{inputs:e,attrs:n,backend:s}=t,{dim:a}=n,{input:r}=e,i=r.shape.length,o=r.shape.slice();let l=a;return a<0&&(I(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+a+1),o.splice(l,0,1),le({inputs:{x:r},backend:s,attrs:{shape:o}})}const Mue={kernelName:_p,backendName:"webgl",kernelFunc:Bk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vI="return exp(x) - 1.0;",Vue=Ue({opSnippet:vI,packedOpSnippet:vI,cpuKernelImpl:hre}),Wue={kernelName:ju,backendName:"webgl",kernelFunc:Vue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SI{constructor(e,n,s){this.variableNames=["real","imag"];const a=n[1];this.outputShape=n;const r=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${a}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${r};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${a});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${a}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L3(t,e,n){const s=n.texData.get(t.dataId),a=K(t.shape),r=t.shape[t.shape.length-1],i=a/r,o=le({inputs:{x:t},backend:n,attrs:{shape:[i,r]}}),l=o.shape,u=new SI("real",l,e),c=new SI("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),f=Gi({inputs:{real:p,imag:h},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h);const m=le({inputs:{x:f},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uue(t){const{inputs:e,backend:n}=t,{input:s}=e;return L3(s,!1,n)}const Gue={kernelName:Zg,backendName:"webgl",kernelFunc:Uue};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hue{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nf(t){const{backend:e,attrs:n}=t,{shape:s,value:a}=n;let{dtype:r}=n;if(r=r||Ko(a),r==="string"){const i=Tt(r,K(s));return i.fill(a),e.makeTensorInfo(s,r,i)}else{const i=new Hue(s,a),o=[[a]];return e.runWebGLProgram(i,[],r,o)}}const Kue={kernelName:ey,backendName:"webgl",kernelFunc:nf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class que{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jue={kernelName:ty,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,a=new que(n.shape);return s.runWebGLProgram(a,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NI="return floor(x);",Xue=Ue({opSnippet:NI,packedOpSnippet:NI,cpuKernelImpl:fre}),Yue={kernelName:_u,backendName:"webgl",kernelFunc:Xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Que=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Zue=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,ece=gn({opSnippet:Que,packedOpSnippet:Zue,dtype:"int32"}),tce={kernelName:Fu,backendName:"webgl",kernelFunc:ece};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nce{constructor(e){this.variableNames=["A"];const n=Pn(),[s,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${a}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sce{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Pn(),[s,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${a}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ace={kernelName:Pm,backendName:"webgl",kernelFunc:rce};let dl,Mb=W().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function rce(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:a}=e;const{numChannels:r}=s,i=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[l,u]=i?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=[u,l],d=[u,l,r];if(o||i){const m=W().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(dl==null||m!==Mb)&&(Mb=m,dl=document.createElement("canvas").getContext("2d",{willReadFrequently:Mb})),dl.canvas.width=l,dl.canvas.height=u,dl.drawImage(a,0,0,l,u),a=dl.canvas}const p=n.makeTensorInfo(c,"int32");n.texData.get(p.dataId).usage=Ss.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);const h=W().getBool("WEBGL_PACK")?new sce(d):new nce(d),f=n.runWebGLProgram(h,[p],"int32");return n.disposeData(p.dataId),f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ice(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r,bias:i,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=s,m=Ar(c),y=nn(a.shape,r.shape,l,d,u,p,!1,m);let g;const b=[],w=i!=null,k=o!=null,x=h==="leakyrelu",S=()=>{const T=[a,r],E=(R,L)=>{if(L==="NCHW"&&R.shape.length===1&&R.shape[0]!==1){const U=le({inputs:{x:R},backend:n,attrs:{shape:[R.shape[0],1,1]}});return b.push(U),U}return R};if(w&&T.push(E(i,c)),k&&T.push(E(o,c)),x){const R=n.makeTensorInfo([],"float32",Er(f,"float32"));T.push(R),b.push(R)}return T};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))g=O3({x:a,filter:r,convInfo:y,backend:n,bias:i,activation:h,preluActivationWeights:o,leakyreluAlpha:f});else if(y.strideWidth<=2&&m==="channelsLast"&&W().getBool("WEBGL_EXP_CONV")){const T=h?tp(h,!0):null,E=new A3(y,w,T,k,x),R=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],L=S();g=n.runWebGLProgram(E,L,"float32",R)}else if(W().getBool("WEBGL_CONV_IM2COL"))g=D3({x:a,filter:r,convInfo:y,backend:n,bias:i,activation:h,preluActivationWeights:o,leakyreluAlpha:f});else{const T=h?tp(h,!1):null,E=new R3(y,w,T,k,x),R=S();g=n.runWebGLProgram(E,R,"float32")}const C=le({inputs:{x:g},backend:n,attrs:{shape:y.outShape}});return b.push(g),b.forEach(T=>n.disposeIntermediateTensorInfo(T)),C}const oce={kernelName:zd,backendName:"webgl",kernelFunc:ice};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r,bias:i,preluActivationWeights:o}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:p,leakyreluAlpha:h}=s,f=[];let m=c;m==null&&(m=[1,1]),I(hn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const y=nn(a.shape,r.shape,l,m,u,d,!0),g=W().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,b=p?tp(p,g):null,w=[a,r],k=i!=null,x=o!=null,S=p==="leakyrelu";if(k&&w.push(i),x&&w.push(o),S){const R=n.makeTensorInfo([],"float32",Er(h,"float32"));w.push(R),f.push(R)}let C;g?C=new F3(y,k,b,x,S):C=new _3(y,k,b,x,S);const T=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],E=n.runWebGLProgram(C,w,"float32",T);return f.forEach(R=>n.disposeIntermediateTensorInfo(R)),E}const uce={kernelName:Md,backendName:"webgl",kernelFunc:lce};class cce{constructor(e,n,s,a){this.sliceDim=e,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=s;const r=nt(s.length);let i=`
    int index;`;for(let o=0;o<this.sliceDim;o++)i+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${r} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(t){const{inputs:e,backend:n}=t,{params:s,indices:a}=e,r=a.shape,i=r[r.length-1],o=K(s.shape),[l,u,c,d]=S0(s,a),p=le({inputs:{x:a},backend:n,attrs:{shape:[u,i]}}),h=le({inputs:{x:s},backend:n,attrs:{shape:[K(s.shape)/c,c]}});if(n.shouldExecuteOnCPU([s,a])||s.dtype==="string"){const g=n.readSync(a.dataId),b=n.bufferSync(s),w=mre(g,b,s.dtype,u,i,c,d,s.shape,o);return n.makeTensorInfo(l,s.dtype,w.values)}const f=new cce(i,d,[u,c],s.shape),m=n.runWebGLProgram(f,[h,p],h.dtype),y=le({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),y}const pce={kernelName:ny,backendName:"webgl",kernelFunc:dce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hce{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=nt(this.rank),a=fce(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${a}));
      }
    `}}function fce(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let a=0;a<t.length;a++)a===2?s.push("index"):s.push(`${n[a]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,indices:r}=e,{axis:i,batchDims:o}=s,l=Fe(i,a.shape)[0];if(W().get("DEBUG")){const b=n.readSync(r.dataId),w=a.shape[l];for(let k=0;k<b.length;++k){const x=b[k];I(x<=w-1&&x>=0,()=>`GatherV2: the index value ${x} is not in [0, ${w-1}]`)}}const u=n2(a,r,l,o),c=K(r.shape),d=[],p=le({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),h=le({inputs:{x:r},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(p),d.push(h);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,r])||a.dtype==="string"){const b=n.bufferSync(h),w=n.bufferSync(p),k=gre(w,b,f);return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(u.outputShape,k.dtype,k.values)}const m=new hce(p.shape,f),y=n.runWebGLProgram(m,[p,h],p.dtype);d.push(y);const g=le({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(b=>n.disposeIntermediateTensorInfo(b)),g}const mce={kernelName:Pp,backendName:"webgl",kernelFunc:B3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gce="return float(a > b);",yce=`
  return vec4(greaterThan(a, b));
`,bce=gn({opSnippet:gce,packedOpSnippet:yce,cpuKernelImpl:yre,dtype:"bool"}),wce={kernelName:Lp,backendName:"webgl",kernelFunc:bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kce="return float(a >= b);",xce=`
  return vec4(greaterThanEqual(a, b));
`,vce=gn({opSnippet:kce,packedOpSnippet:xce,dtype:"bool",cpuKernelImpl:bre}),Sce={kernelName:Pu,backendName:"webgl",kernelFunc:vce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nce(t){const{inputs:e,backend:n}=t,{input:s}=e;return L3(s,!0,n)}const Cce={kernelName:sy,backendName:"webgl",kernelFunc:Nce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ice="return float(!isnan(x) && !isinf(x));",Tce=Ue({opSnippet:Ice,dtype:"bool"}),$ce={kernelName:Bu,backendName:"webgl",kernelFunc:Tce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ece="return float(isinf(x));",Rce=Ue({opSnippet:Ece,dtype:"bool"}),Ace={kernelName:zu,backendName:"webgl",kernelFunc:Rce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oce="return float(isnan(x));",Dce=Ue({opSnippet:Oce,dtype:"bool"}),jce={kernelName:Mu,backendName:"webgl",kernelFunc:Dce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ce="return float(a < b);",Fce=`
  return vec4(lessThan(a, b));
`,Pce=gn({opSnippet:_ce,packedOpSnippet:Fce,cpuKernelImpl:wre,dtype:"bool"}),Lce={kernelName:zp,backendName:"webgl",kernelFunc:Pce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bce="return float(a <= b);",zce=`
  return vec4(lessThanEqual(a, b));
`,Mce=gn({opSnippet:Bce,packedOpSnippet:zce,cpuKernelImpl:kre,dtype:"bool"}),Vce={kernelName:Mp,backendName:"webgl",kernelFunc:Mce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(t){const{backend:e,attrs:n}=t,{start:s,stop:a,num:r}=n,i=xre(s,a,r);return e.makeTensorInfo([i.length],"float32",i)}const Uce={kernelName:ry,backendName:"webgl",kernelFunc:Wce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gce=Tc+`
  return x < 0.0 ? 0./0. : log(x);
`,Hce=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Kce=Ue({opSnippet:Gce,packedOpSnippet:Hce,cpuKernelImpl:vre}),qce={kernelName:Vu,backendName:"webgl",kernelFunc:Kce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jce=Tc+`
  return log(1.0 + x);
`,Xce=Ue({opSnippet:Jce}),Yce={kernelName:Wu,backendName:"webgl",kernelFunc:Xce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qce="return float(a >= 1.0 && b >= 1.0);",Zce=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,ede=gn({opSnippet:Qce,packedOpSnippet:Zce,dtype:"bool"}),tde={kernelName:Vp,backendName:"webgl",kernelFunc:ede};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nde="return float(!(x >= 1.0));",sde=Ue({opSnippet:nde}),ade={kernelName:Wp,backendName:"webgl",kernelFunc:sde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rde="return float(a >= 1.0 || b >= 1.0);",ide=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,ode=gn({opSnippet:rde,packedOpSnippet:ide,dtype:"bool"}),lde={kernelName:Up,backendName:"webgl",kernelFunc:ode};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ude{constructor(e,n,s,a,r){this.variableNames=["x"],this.outputShape=[];const i=n,o=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${a}) * sum`;r===.5?l=`inversesqrt(${u})`:r===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cde{constructor(e,n,s,a,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,o=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${a}) * sum`;r===.5?l=`inversesqrt(${u})`:r===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dde=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{depthRadius:r,bias:i,alpha:o,beta:l}=s,u=W().getBool("WEBGL_PACK_NORMALIZATION")?new cde(a.shape,r,i,o,l):new ude(a.shape,r,i,o,l);return n.runWebGLProgram(u,[a],a.dtype)},pde={kernelName:Gp,backendName:"webgl",kernelFunc:dde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hde{constructor(e,n,s,a,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=a,this.beta=r,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${a}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${a})
                * float(${r})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${r});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fde=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a,y:r,dy:i}=e,{depthRadius:o,bias:l,alpha:u,beta:c}=s,d=new hde(a.shape,o,l,u,c);return n.runWebGLProgram(d,[a,r,i],a.dtype)},mde={kernelName:iy,backendName:"webgl",kernelFunc:fde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gde(t,e,n,s){const a=K(e),i=K(t.shape)/a,o=le({inputs:{x:t},attrs:{shape:[i,a]},backend:s}),l=ol(o,t.dtype,"max",s),u=le({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{reductionIndices:r,keepDims:i}=s,o=a.shape.length,l=Fe(r,a.shape);let u=l;const c=Nt(u,o),d=c!=null,p=n.shouldExecuteOnCPU([a]);let h=a;if(d){if(p){const w=n.texData.get(h.dataId).values,k=new Array(o);for(let C=0;C<k.length;C++)k[C]=a.shape[c[C]];const x=M2(w,a.shape,a.dtype,c,k);h=n.makeTensorInfo(k,a.dtype);const S=n.texData.get(h.dataId);S.values=x}else h=V0(a,c,n);u=Dt(u.length,o)}fn("max",u,o);const[f,m]=sn(h.shape,u);let y=f;i&&(y=Ot(f,l));let g;if(p){const w=n.texData.get(h.dataId).values,k=Sre(w,K(m),y,a.dtype);g=n.makeTensorInfo(y,a.dtype);const x=n.texData.get(g.dataId);x.values=k}else g=gde(h,m,y,n);return d&&n.disposeIntermediateTensorInfo(h),g}const yde={kernelName:Hp,backendName:"webgl",kernelFunc:z3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bde=V2+`
  return max(a, b);
`,wde=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+il+`
  return result;
`,kde=gn({opSnippet:bde,packedOpSnippet:wde,cpuKernelImpl:Nre}),xde={kernelName:Uu,backendName:"webgl",kernelFunc:kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vde(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;Zh(a,"maxPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=s,u=1;I(hn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Ys(a.shape,r,i,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Le(c.inShape,c.outShape))return fs({inputs:{x:a},backend:n});const d=new np(c,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}const Sde={kernelName:Kp,backendName:"webgl",kernelFunc:vde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{filterSize:r,strides:i,pad:o,dataFormat:l,dimRoundingMode:u}=s,c=[1,1,1],d=Rr(a.shape,r,i,c,o,u,l),p=new U2(d,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}const Cde={kernelName:qp,backendName:"webgl",kernelFunc:Nde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ide{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,a=e.dilationHeight,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=r-1-e.padInfo.top,l=i-1-e.padInfo.left,u=r*i-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${r};
          wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class Tde{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,a=e.strideWidth,r=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,p=u-1-e.padInfo.top,h=c-1-e.padInfo.left,f=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${p}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${r}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${f} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $de(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,i=r,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=s,d=[1,1,1],p=Rr(i.shape,o,l,d,u,c),h=new U2(p,"max",!0),f=n.runWebGLProgram(h,[i],i.dtype),m=new Tde(p),y=n.runWebGLProgram(m,[a,f],i.dtype);return n.disposeIntermediateTensorInfo(f),y}const Ede={kernelName:ly,backendName:"webgl",kernelFunc:$de};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rde(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r,output:i}=e,o=r;Zh([r,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=s,p=Ys(o.shape,l,u,1,c,d),h=!0,f=new np(p,"max",h),m=n.runWebGLProgram(f,[o],o.dtype),y=new Ide(p),g=n.runWebGLProgram(y,[a,m],o.dtype);return n.disposeIntermediateTensorInfo(m),g}const Ade={kernelName:oy,backendName:"webgl",kernelFunc:Rde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ode(t,e,n,s){let a=new np(n,"max",!1);const r=s.runWebGLProgram(a,[t],"float32");a=new np(n,"max",!0,!0,e);const i=s.runWebGLProgram(a,[t],"float32");return[r,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dde={kernelName:uy,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:a,strides:r,pad:i,includeBatchInIndex:o}=e,l=n;I(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];I(hn(r,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${r} and dilations '${u}'`);const c=Ys(s.shape,a,r,u,i),[d,p]=Ode(s,o,c,l);return[d,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jde(t,e,n,s){const a=K(e),i=K(t.shape)/a,o=le({inputs:{x:t},attrs:{shape:[i,a]},backend:s}),l=ol(o,"float32","mean",s),u=le({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _de={kernelName:Jp,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:a,axis:r}=e,i=n,o=s.shape.length,l=Fe(r,s.shape);let u=l;const c=Nt(u,o),d=c!=null,p=i.shouldExecuteOnCPU([s]),h=[];let f=s;if(d){if(p){const k=i.texData.get(f.dataId).values,x=new Array(o);for(let T=0;T<x.length;T++)x[T]=s.shape[c[T]];const S=M2(k,s.shape,s.dtype,c,x);f=i.makeTensorInfo(x,s.dtype);const C=i.texData.get(f.dataId);C.values=S}else f=V0(s,c,i);h.push(f),u=Dt(u.length,o)}fn("sum",u,o);const[m,y]=sn(f.shape,u);let g=m;a&&(g=Ot(m,l));const b=jde(f,y,g,i);for(const w of h)i.disposeIntermediateTensorInfo(w);return b}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fde(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=a.shape.length,l=Fe(r,a.shape);let u=l;const c=Nt(u,o);let d=a;c!=null&&(d=_n({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Dt(u.length,a.shape.length)),fn("min",u,o);const[p,h]=sn(d.shape,u),f=K(h),m=le({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=ol(m,m.dtype,"min",n);let g;if(i){const b=Ot(p,l);g=le({inputs:{x:y},backend:n,attrs:{shape:b}})}else g=le({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),g}const Pde={kernelName:Xp,backendName:"webgl",kernelFunc:Fde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lde=V2+`
  return min(a, b);
`,Bde=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+il+`
  return result;
`,zde=gn({opSnippet:Lde,packedOpSnippet:Bde,cpuKernelImpl:Cre}),Mde={kernelName:Gu,backendName:"webgl",kernelFunc:zde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vde{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const a=e.length,r=nt(a),i=n.map(c=>c[0]).join(","),o=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),u=s==="reflect"?0:1;if(a===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${i});
      ${r} end = ${r}(${o});

      void main() {
        ${r} outC = getOutputCoords();
        for (int i = 0; i < ${a}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${r} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wde{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((f,m)=>f[0]+e[m]+f[1]);const a=e.length,r=nt(a),i=n.map(f=>f[0]).join(","),o=n.map((f,m)=>f[0]+e[m]).join(","),l=Dn("rc",a),u=Dn("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,p=s==="reflect"?0:1;let h="";if(a===1){const f=`
        ${r} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;h=`
        ${r} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const f=`
        ${r} source = rc;
        ${r} lt = ${r}(lessThan(source, start));
        ${r} gte = ${r}(greaterThanEqual(source, end));
        ${r} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;h=`
        ${r} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[a-2]} += 1;
        if(${l[a-2]} < ${this.outputShape[a-2]}) {
          ${f}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[a-1]} += 1;
          if(${c}) {
            ${f}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${r} start = ${r}(${i});
      const ${r} end = ${r}(${o});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ude=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:a,mode:r}=n,i=W().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wde(s.shape,a,r):new Vde(s.shape,a,r);return e.runWebGLProgram(i,[s],s.dtype)},Gde={kernelName:Yp,backendName:"webgl",kernelFunc:Ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hde=`if (b == 0.0) return NAN;
  return mod(a, b);`,Kde=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+il+`
  return result;
`,qde=gn({opSnippet:Hde,packedOpSnippet:Kde}),Jde={kernelName:Hu,backendName:"webgl",kernelFunc:qde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xde{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yde=`
if (a == b) {
  return 1.0;
};
return a / b;`,Qde=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,M3=gn({opSnippet:Yde,packedOpSnippet:Qde,checkOutOfBounds:!0}),Zde={kernelName:Ru,backendName:"webgl",kernelFunc:M3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CI="return a - b;",V3=gn({opSnippet:CI,packedOpSnippet:CI,supportsComplex:!0,cpuKernelImpl:Hre}),epe={kernelName:lc,backendName:"webgl",kernelFunc:V3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W3(t){const{inputs:e,backend:n,attrs:s}=t,{logits:a}=e,{dim:r}=s,i=Fe([r],a.shape),o=z3({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=Ot(o.shape,i),u=le({inputs:{x:o},backend:n,attrs:{shape:l}}),c=V3({inputs:{a,b:u},backend:n}),d=P3({inputs:{x:c},backend:n}),p=W0({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),h=le({inputs:{x:p},backend:n,attrs:{shape:l}}),f=M3({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}const tpe={kernelName:mh,backendName:"webgl",kernelFunc:W3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function npe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:a}=e,{numSamples:r,seed:i,normalized:o}=s,l=o?a:W3({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new Xde(u,c,r),p=[[i]],h=n.runWebGLProgram(d,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),h}const spe={kernelName:cy,backendName:"webgl",kernelFunc:npe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ape=Zs+`
  return -x;
`,rpe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function ipe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const r=n.texData.get(s.dataId),[i,o]=Tre(r.values,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}let a;return W().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new ei(s.shape,rpe):a=new za(s.shape,ape),n.runWebGLProgram(a,[s],s.dtype)}const ope={kernelName:Qp,backendName:"webgl",kernelFunc:ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lpe=w0;function upe(t){ws("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s,u=n.readSync(a.dataId),c=n.readSync(r.dataId),{selectedIndices:d}=lpe(u,c,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const cpe={kernelName:dy,backendName:"webgl",kernelFunc:upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dpe=k0;function ppe(t){ws("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=s,c=n.readSync(a.dataId),d=n.readSync(r.dataId),{selectedIndices:p,validOutputs:h}=dpe(c,d,i,o,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const hpe={kernelName:py,backendName:"webgl",kernelFunc:ppe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fpe=x0;function mpe(t){ws("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=s,c=n.readSync(a.dataId),d=n.readSync(r.dataId),p=i,h=o,f=l,m=u,{selectedIndices:y,selectedScores:g}=fpe(c,d,p,h,f,m);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const gpe={kernelName:hy,backendName:"webgl",kernelFunc:mpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ype{constructor(e,n,s,a){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${a}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bpe=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:a}=e,{dtype:r,depth:i,onValue:o,offValue:l}=s,u=K(a.shape),c=new ype(u,i,o,l),d=le({inputs:{x:a},backend:n,attrs:{shape:[u]}}),p=n.runWebGLProgram(c,[d],r);n.disposeIntermediateTensorInfo(d);const h=[...a.shape,i],f=le({inputs:{x:p},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(p),f},wpe={kernelName:th,backendName:"webgl",kernelFunc:bpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lg(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const a=tf({inputs:{input:s},backend:n}),r=lg({inputs:{x:a},backend:n}),i=U0({inputs:{input:s},backend:n}),o=lg({inputs:{x:i},backend:n}),l=Gi({inputs:{real:r,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return nf({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const kpe={kernelName:wh,backendName:"webgl",kernelFunc:lg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const a=tf({inputs:{input:s},backend:n}),r=U3({inputs:{x:a},backend:n}),i=U0({inputs:{input:s},backend:n}),o=lg({inputs:{x:i},backend:n}),l=Gi({inputs:{real:r,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return nf({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const xpe={kernelName:eh,backendName:"webgl",kernelFunc:U3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vpe(t){const{inputs:e,backend:n,attrs:s}=t,{axis:a}=s;if(e.length===1)return Bk({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const r=e[0].shape,i=e[0].dtype;e.forEach(c=>{pn(r,c.shape,"All tensors passed to stack must have matching shapes"),I(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(c=>{const d=Bk({inputs:{input:c},backend:n,attrs:{dim:a}});return o.push(d),d}),u=E3({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const Spe={kernelName:nh,backendName:"webgl",kernelFunc:vpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Npe{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const a=e.length,r=nt(a),i=n.map(u=>u[0]).join(","),o=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);if(a===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${i});
      ${r} end = ${r}(${o});

      void main() {
        ${r} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${r} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cpe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,y)=>m[0]+e[y]+m[1]);const a=e.length,r=nt(a),i=n.map(m=>m[0]).join(","),o=n.map((m,y)=>m[0]+e[y]).join(","),l=Dn("rc",a),u=Dn("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,p=[`${r} rc = outputLoc;`,`${l[a-1]} += 1;
       if(${c}) {
      `,a===1?"":`}
       rc = outputLoc;
       ${l[a-2]} += 1;
       if(${l[a-2]} < ${this.outputShape[a-2]}) {`,a===1?"":`  ${l[a-1]} += 1;
         if(${c}) {`],h=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let m=0,y=a===1?2:4;m<y;m++)f+=`
        ${p[m]}
        if (${h}) {
          result[${m}] = float(value);
        } else {
          ${r} source = rc - start;
          result[${m}] = getChannel(getX(${u.join()}), ${d});
        }
      `;f+=a===1?"} ":"}}",this.userCode=`
      const ${r} start = ${r}(${i});
      const ${r} end = ${r}(${o});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G3=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{paddings:r,constantValue:i}=s;if(K(a.shape)===0){const u=r.map((c,d)=>c[0]+a.shape[d]+c[1]);return nf({backend:n,attrs:{shape:u,value:i,dtype:a.dtype}})}const o=W().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Cpe(a.shape,r,i):new Npe(a.shape,r,i),l=[[i]];return n.runWebGLProgram(o,[a],a.dtype,l)},Ipe={kernelName:sh,backendName:"webgl",kernelFunc:G3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tpe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,$pe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+il+`
  return result;
`,Epe=gn({opSnippet:Tpe,packedOpSnippet:$pe}),Rpe={kernelName:qu,backendName:"webgl",kernelFunc:Epe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ape(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=a.shape.length,l=[],u=Fe(r,a.shape);let c=u;const d=Nt(c,o);let p=a;d!=null&&(p=_n({inputs:{x:a},backend:n,attrs:{perm:d}}),c=Dt(c.length,o),l.push(p)),fn("prod",c,o);let h;if(n.shouldExecuteOnCPU([p])){const f=n.texData.get(p.dataId).values,{outVals:m,outShape:y,outDtype:g}=Ere(p.shape,p.dtype,f,c);h=n.makeTensorInfo(y,g,m)}else{const[f,m]=sn(p.shape,c),y=K(m),g=le({inputs:{x:p},backend:n,attrs:{shape:[-1,y]}}),b=By(a.dtype),w=ol(g,b,"prod",n);h=le({inputs:{x:w},backend:n,attrs:{shape:f}}),l.push(g),l.push(w)}if(i){l.push(h);const f=Ot(h.shape,u);h=le({inputs:{x:h},backend:n,attrs:{shape:f}})}return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}const Ope={kernelName:rh,backendName:"webgl",kernelFunc:Ape};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dpe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:a,paramsDenseValues:r,indices:i}=e,{outputRaggedRank:o}=s,l=a.map(g=>n.readSync(g.dataId)),u=a.map(g=>g.shape),c=n.readSync(r.dataId),d=n.readSync(i.dataId),[p,h,f]=Rre(l,u,c,r.shape,r.dtype,d,i.shape,o),m=p.map(g=>n.makeTensorInfo([g.length],"int32",g)),y=n.makeTensorInfo(f,r.dtype,h);return m.concat([y])}const jpe={kernelName:fy,backendName:"webgl",kernelFunc:Dpe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _pe(t){const{inputs:e,backend:n}=t,{starts:s,limits:a,deltas:r}=e,i=n.readSync(s.dataId),o=n.readSync(a.dataId),l=n.readSync(r.dataId),[u,c]=Are(i,s.shape,s.dtype,o,a.shape,l,r.shape),d=n.makeTensorInfo([u.length],"int32",u),p=n.makeTensorInfo([c.length],s.dtype,c);return[d,p]}const Fpe={kernelName:my,backendName:"webgl",kernelFunc:_pe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ppe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:a,values:r,defaultValue:i,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,u=n.readSync(a.dataId),c=n.readSync(r.dataId),d=n.readSync(i.dataId),p=o.map(y=>n.readSync(y.dataId)),h=o.map(y=>y.shape),[f,m]=Ore(u,a.shape,c,r.shape,r.dtype,d,i.shape,p,h,l);return n.makeTensorInfo(f,r.dtype,m)}const Lpe={kernelName:gy,backendName:"webgl",kernelFunc:Ppe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H3=t=>{const{backend:e,attrs:n}=t,{start:s,stop:a,step:r,dtype:i}=n,o=Dre(s,a,r,i);return e.makeTensorInfo([o.length],i,o)},Bpe={kernelName:yy,backendName:"webgl",kernelFunc:H3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zpe="return 1.0 / x;",Mpe=Ue({opSnippet:zpe}),Vpe={kernelName:Ju,backendName:"webgl",kernelFunc:Mpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wpe=Zs+`
  return (x < 0.0) ? 0.0 : x;
`,Upe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Gpe=Ue({opSnippet:Wpe,packedOpSnippet:Upe}),Hpe={kernelName:Xu,backendName:"webgl",kernelFunc:Gpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kpe=Zs+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,qpe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Jpe=Ue({opSnippet:Kpe,packedOpSnippet:qpe}),Xpe={kernelName:Yu,backendName:"webgl",kernelFunc:Jpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ype{constructor(e,n,s,a,r){this.variableNames=["A"],this.outputShape=[];const[i,o,l,u]=e;this.outputShape=[i,n,s,u];const c=[a&&n>1?o-1:o,a&&s>1?l-1:l],d=[a&&n>1?n-1:n,a&&s>1?s-1:s];let p;r?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qpe{constructor(e,n,s,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,u]=e;this.outputShape=[i,n,s,u];const c=[a&&n>1?o-1:o,a&&s>1?l-1:l],d=[a&&n>1?n-1:n,a&&s>1?s-1:s];let p;r?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zpe(t){const{inputs:e,backend:n,attrs:s}=t,{images:a}=e,{alignCorners:r,halfPixelCenters:i,size:o}=s,[l,u]=o,c=W().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Qpe(a.shape,l,u,r,i):new Ype(a.shape,l,u,r,i);return n.runWebGLProgram(c,[a],"float32")}const ehe={kernelName:lh,backendName:"webgl",kernelFunc:Zpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class the{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,r]=n,[,i,o]=e,l=[s&&i>1?a-1:a,s&&o>1?r-1:r],u=[s&&i>1?i-1:i,s&&o>1?o-1:o],c=l[0]/u[0],d=l[1]/u[1],p=1/c,h=1/d,f=Math.ceil(p)*2+2,m=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${h});

        const int winHeight = int(${f});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${a-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${r-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(t){const{inputs:e,backend:n,attrs:s}=t,{images:a,dy:r}=e,{alignCorners:i}=s,o=new the(r.shape,a.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const she={kernelName:ky,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ahe{constructor(e,n,s,a,r){this.variableNames=["A"],this.outputShape=[];const[i,o,l,u]=e;this.outputShape=[i,n,s,u];const c=[a&&n>1?o-1:o,a&&s>1?l-1:l],d=[a&&n>1?n-1:n,a&&s>1?s-1:s],p=a?"0.5":"0.0";let h;r?h="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rhe{constructor(e,n,s,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,u]=e;this.outputShape=[i,n,s,u];const c=[a&&n>1?o-1:o,a&&s>1?l-1:l],d=[a&&n>1?n-1:n,a&&s>1?s-1:s],p=a?"0.5":"0.0";let h;r?h="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ihe(t){const{inputs:e,backend:n,attrs:s}=t,{images:a}=e,{alignCorners:r,halfPixelCenters:i,size:o}=s,[l,u]=o,c=W().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new rhe(a.shape,l,u,r,i):new ahe(a.shape,l,u,r,i);return n.runWebGLProgram(c,[a],a.dtype)}const ohe={kernelName:oh,backendName:"webgl",kernelFunc:ihe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lhe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,r]=n,[,i,o]=e,l=[s&&i>1?a-1:a,s&&o>1?r-1:r],u=[s&&i>1?i-1:i,s&&o>1?o-1:o],c=l[0]/u[0],d=l[1]/u[1],p=1/c,h=1/d,f=Math.ceil(p)*2+2,m=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${h});

        const int winHeight = int(${f});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uhe(t){const{inputs:e,backend:n,attrs:s}=t,{images:a,dy:r}=e,{alignCorners:i}=s,o=new lhe(r.shape,a.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const che={kernelName:wy,backendName:"webgl",kernelFunc:uhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dhe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const a=o=>n.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,r=e.map((o,l)=>a(l)).join(","),i=nt(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${r}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class phe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const a=Dn("rc",s),r=`${a[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${a[s-2]} + 1 < ${this.outputShape[s-2]}`,o=nt(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${r}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(a.slice())};
          if(${r}){
            result.g = ${u(a.slice())};
          }
          if(${i}) {
            result.b = ${c(a.slice())};
            if(${r}) {
              result.a = ${d(a.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(f){return p(f)}function u(f){return f[s-1]="("+f[s-1]+" + 1)",p(f)}function c(f){return f[s-2]="("+f[s-2]+" + 1)",p(f)}function d(f){return f[s-1]="("+f[s-1]+" + 1)",f[s-2]="("+f[s-2]+" + 1)",p(f)}function p(f){const m=e.map((b,w)=>h(w,f)),y=m.join(","),g=m.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${g}))`}function h(f,m){return n.indexOf(f)!==-1&&e[f]!==1?`${e[f]} - ${m[f]} - 1`:`${m[f]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hhe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{dims:r}=s,i=a.shape.length,o=Fe(r,a.shape);if(i===0)return fs({inputs:{x:a},backend:n});const l=W().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new phe(a.shape,o):new dhe(a.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}const fhe={kernelName:uh,backendName:"webgl",kernelFunc:hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mhe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],a=e[2];this.outputShape=e;let r="";typeof n=="number"?r=`float outputValue = ${n.toFixed(2)};`:r=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${r}
          if(coordX >= 0 && coordX < ${a} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ghe={kernelName:Py,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:a,fillValue:r,center:i}=e,o=n,l=new mhe(s.shape,r),[u,c]=zv(i,s.shape[1],s.shape[2]),d=[[u,c,Math.sin(a),Math.cos(a)]];return o.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yhe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,bhe=Ue({opSnippet:yhe}),whe={kernelName:Qu,backendName:"webgl",kernelFunc:bhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const khe="return inversesqrt(x);",xhe=Ue({opSnippet:khe,cpuKernelImpl:jre}),vhe={kernelName:Zu,backendName:"webgl",kernelFunc:xhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G2{constructor(e,n,s,a,r,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=nt(r.length),c=nt(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const p=`getIndices(${d})`;let h="";a===1?h="i":a===2&&(h="i, coords[1]");const f=`getUpdates(${h})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${r});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class She{constructor(e,n,s,a,r,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=nt(r.length),c=nt(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const p=`getIndices(${d})`;let h="";a===1?h="i":a===2&&(h="i, coords[1]");const f=`getUpdates(${h})`;let m="";l&&(m="coords[0], coords[1]");const y=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides",b=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${r});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${p});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${b};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${f};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nhe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:a,updates:r}=e,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Vi(r,a,i),p=[d/u,u];if(d===0)return n.makeTensorInfo(i,a.dtype);const h=le({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),f=le({inputs:{x:r},backend:n,attrs:{shape:[l,u]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;W().getBool("WEBGL_PACK")?y=new She(l,o,h.shape.length,f.shape.length,c,p):y=new G2(l,o,h.shape.length,f.shape.length,c,p);const g=n.runWebGLProgram(y,[f,h,m],f.dtype),b=le({inputs:{x:g},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),b}const Che={kernelName:xy,backendName:"webgl",kernelFunc:Nhe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ihe{constructor(e,n,s,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const r="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,o=W().getNumber("WEBGL_VERSION")===2?r:i,l=a==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function The(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:a,values:r}=e,{side:i}=s,o=new Ihe(a.shape[0],a.shape[1],r.shape[1],i),l=[[a.shape[1]]];return n.runWebGLProgram(o,[a,r],"int32",l)}const $he={kernelName:Sy,backendName:"webgl",kernelFunc:The};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ehe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let a,r;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)r="resRC",a="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${o[c]}`),c<e&&l.push(`${o[c]}`);a=l.join(),r=u.join()}const i=nt(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${a});
        if (cVal >= 1.0) {
          setOutput(getA(${r}));
        } else {
          setOutput(getB(${r}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rhe(t){const{inputs:e,backend:n}=t,{condition:s,t:a,e:r}=e,i=new Ehe(s.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(i,[s,a,r],Un(a.dtype,r.dtype))}const Ahe={kernelName:ch,backendName:"webgl",kernelFunc:Rhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ohe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${I0};
  float scale = ${T0};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Dhe=Ue({opSnippet:Ohe}),jhe={kernelName:ec,backendName:"webgl",kernelFunc:Dhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _he=Tc+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Fhe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Phe=Ue({opSnippet:_he,packedOpSnippet:Fhe,cpuKernelImpl:Fre}),Lhe={kernelName:ac,backendName:"webgl",kernelFunc:Phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bhe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,zhe=Ue({opSnippet:Bhe}),Mhe={kernelName:sc,backendName:"webgl",kernelFunc:zhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vhe=Tc+`
  return sin(x);
`,Whe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${il}
  return result;
`,Uhe=Ue({opSnippet:Vhe,packedOpSnippet:Whe}),Ghe={kernelName:tc,backendName:"webgl",kernelFunc:Uhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hhe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Khe=Ue({opSnippet:Hhe}),qhe={kernelName:nc,backendName:"webgl",kernelFunc:Khe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jhe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Xhe=Ue({opSnippet:Jhe}),Yhe={kernelName:rc,backendName:"webgl",kernelFunc:Xhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qhe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockShape:r,paddings:i}=s;I(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=r.reduce((g,b)=>g*b),l=[[0,0]];l.push(...i);for(let g=1+r.length;g<a.shape.length;++g)l.push([0,0]);const u=[],c=G3({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=zh(c.shape,r,o,!1),p=Mh(d.length,r.length,!1),h=Vh(c.shape,r,o,!1),f=le({inputs:{x:c},backend:n,attrs:{shape:d}}),m=_n({inputs:{x:f},backend:n,attrs:{perm:p}}),y=le({inputs:{x:m},backend:n,attrs:{shape:h}});return u.push(c),u.push(f),u.push(m),u.forEach(g=>n.disposeIntermediateTensorInfo(g)),y},Zhe={kernelName:hh,backendName:"webgl",kernelFunc:Qhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function efe(t){const{inputs:e,backend:n}=t,{indices:s,values:a,denseShape:r,defaultValue:i}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${a.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=n.readSync(s.dataId),l=n.readSync(a.dataId),u=n.readSync(r.dataId),c=n.readSync(i.dataId)[0],[d,p,h,f,m]=Lre(o,s.shape,s.dtype,l,a.dtype,u,c);return[n.makeTensorInfo(p,s.dtype,d),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(y=>Number(y)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const tfe={kernelName:Ny,backendName:"webgl",kernelFunc:efe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nfe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:a,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const i=Array.from(n.readSync(a.dataId)),o=n.readSync(s.dataId),l=Array.from(n.readSync(r.dataId)),[u,c,d]=Bre(o,s.shape,s.dtype,i,l);return[n.makeTensorInfo(c,s.dtype,u),n.makeTensorInfo([d.length],r.dtype,new Int32Array(d))]}const sfe={kernelName:Cy,backendName:"webgl",kernelFunc:nfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function afe(t){const{inputs:e,backend:n}=t,{data:s,indices:a,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${a.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${r.shape}`);const i=n.readSync(s.dataId),o=n.readSync(a.dataId),l=n.readSync(r.dataId),[u,c]=g3(i,s.shape,s.dtype,o,l,!0);return n.makeTensorInfo(c,s.dtype,u)}const rfe={kernelName:Iy,backendName:"webgl",kernelFunc:afe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(t){const{inputs:e,backend:n}=t,{data:s,indices:a,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${a.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${r.shape}`);const i=n.readSync(s.dataId),o=n.readSync(a.dataId),l=n.readSync(r.dataId),[u,c]=g3(i,s.shape,s.dtype,o,l);return n.makeTensorInfo(c,s.dtype,u)}const ofe={kernelName:Ty,backendName:"webgl",kernelFunc:ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lfe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:a,sparseValues:r,defaultValue:i}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=Vi(r,a,o),h=!1;if(r.dtype==="string"){const g=n.bufferSync(a),b=n.bufferSync(r),w=xr(n.readSync(i.dataId)[0]),k=_re(g,b,o,p,c,u,l,d,w,h);return n.makeTensorInfo(o,k.dtype,k.values)}const f=new G2(u,l,a.shape.length,r.shape.length,d,[p,1],h),m=n.runWebGLProgram(f,[r,a,i],r.dtype),y=le({inputs:{x:m},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(m),y}const ufe={kernelName:$y,backendName:"webgl",kernelFunc:lfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{numOrSizeSplits:r,axis:i}=s,o=Fe(i,a.shape)[0],l=t2(a,r,o),u=a.shape.length,c=new Array(u).fill(0),d=a.shape.slice();return l.map(p=>{const h=[...d];h[o]=p;const f=$c({inputs:{x:a},backend:n,attrs:{begin:c,size:h}});return c[o]+=p,f})}const dfe={kernelName:fh,backendName:"webgl",kernelFunc:cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const II="return sqrt(x);",pfe=Ue({opSnippet:II,packedOpSnippet:II,cpuKernelImpl:zre}),hfe={kernelName:ic,backendName:"webgl",kernelFunc:pfe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ffe="return x * x;",mfe=Ue({opSnippet:ffe}),gfe={kernelName:Ey,backendName:"webgl",kernelFunc:mfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TI="return (a - b) * (a - b);",yfe=gn({opSnippet:TI,packedOpSnippet:TI}),bfe={kernelName:oc,backendName:"webgl",kernelFunc:yfe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");const r=n.readSync(a.dataId),i=Cr(r),o=Mre(i,"string",s);return n.makeTensorInfo(a.shape,"string",o)}const kfe={kernelName:gh,backendName:"webgl",kernelFunc:wfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xfe({inputs:t,attrs:e,backend:n}){const{x:s}=t,a=Zs+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,r=new za(s.shape,a);return n.runWebGLProgram(r,[s],s.dtype)}const vfe={kernelName:pc,backendName:"webgl",kernelFunc:xfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sfe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const a=s.length,r=nt(s.length),i=nt(s.length);let o="";if(a===1)o="coords * strides + begin";else{let l=0;o=s.map((u,c)=>(l++,s.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${r} begin = ${r}(${e});
      ${r} strides = ${r}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{begin:r,end:i,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=s,{finalShapeSparse:h,finalShape:f,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:b,end:w,strides:k}=Fv(a.shape,r,i,o,l,u,c,d,p);let x;if(m)x=le({inputs:{x:a},backend:n,attrs:{shape:f}});else if(y||g){I(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const C=Dv(b,w,k),T=$c({inputs:{x:a},backend:n,attrs:{begin:b,size:C}});x=le({inputs:{x:T},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(T)}else if(n.shouldExecuteOnCPU([a])){const T=n.readSync(a.dataId),E=Re(a.shape,a.dtype,T),R=Vre(h,E,k,b);x=n.makeTensorInfo(f,a.dtype,R.values)}else{const T=new Sfe(b,k,h);x=n.runWebGLProgram(T,[a],a.dtype)}const S=le({inputs:{x},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(x),S}const Cfe={kernelName:Ry,backendName:"webgl",kernelFunc:Nfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(t){const{inputs:e,backend:n,attrs:s}=t,{separator:a,nGramWidths:r,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:u}=s,{data:c,dataSplits:d}=e,p=n.readSync(c.dataId),h=n.readSync(d.dataId),[f,m]=Wre(p,h,a,r,i,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}const Tfe={kernelName:Ay,backendName:"webgl",kernelFunc:Ife};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $fe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:a}=s,{input:r,delimiter:i}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=n.readSync(r.dataId),l=n.readSync(i.dataId)[0],[u,c,d]=Ure(o,l,a),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Efe={kernelName:Oy,backendName:"webgl",kernelFunc:$fe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rfe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:a}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(r.dataId),o=Gre(i,a);return n.makeTensorInfo(r.shape,"int32",o)}const Afe={kernelName:Dy,backendName:"webgl",kernelFunc:Rfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ofe="return tan(x);",Dfe=Ue({opSnippet:Ofe}),jfe={kernelName:uc,backendName:"webgl",kernelFunc:Dfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _fe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Ffe=Ue({opSnippet:_fe}),Pfe={kernelName:cc,backendName:"webgl",kernelFunc:Ffe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lfe(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:a,indices:r,updates:i}=e,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Vi(i,r,a.shape),p=[d/u,u];if(d===0)return n.makeTensorInfo(a.shape,r.dtype);const h=le({inputs:{x:r},backend:n,attrs:{shape:[l,o]}}),f=le({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),m=le({inputs:{x:a},backend:n,attrs:{shape:p}}),y=new G2(l,o,h.shape.length,f.shape.length,c,p,!1,!0),g=n.runWebGLProgram(y,[f,h,m],m.dtype),b=le({inputs:{x:g},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}const Bfe={kernelName:vy,backendName:"webgl",kernelFunc:Lfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zfe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*n[i];this.outputShape=s,this.rank=s.length;const a=nt(this.rank),r=Mfe(e);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        setOutput(getA(${r}));
      }
    `}}function Mfe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let a=0;a<t.length;a++)s.push(`imod(${n[a]}, ${t[a]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K3(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{reps:r}=s;if(a.dtype==="string"||a.shape.length>5){const l=n.readSync(a.dataId),u=a.dtype==="string"?l.map(p=>xr(p)):l,c=Re(a.shape,a.dtype,u),d=Kre(c,r);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new zfe(a.shape,r);return n.runWebGLProgram(i,[a],a.dtype)}const Vfe={kernelName:dc,backendName:"webgl",kernelFunc:K3};class Wfe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Ufe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ji(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function $I(t){let e=1;for(;e<t;)e*=2;return e}function Gfe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{k:r,sorted:i}=s,o=W().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=W().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=a.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([a])||c<o||r>l){const R=n.readSync(a.dataId),[L,U]=qre(R,u,a.dtype,r,i);return[n.makeTensorInfo(L.shape,L.dtype,L.values),n.makeTensorInfo(U.shape,U.dtype,U.values)]}if(r===0)return u[u.length-1]=0,[n.makeTensorInfo(u,a.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[a,nf({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(a.dataId),p=d!==null&&d.isPacked,h=p?n.unpackTensor(a):a,m=K(u)/c,y=le({inputs:{x:h},attrs:{shape:[m,c]},backend:n});p&&Ji(n,h);const g=$I(r),b=$I(c);let w=null;const k=()=>w===null?[y,y]:[y,w],x=(R,L,U)=>{const G=k(),F=new Wfe(U),H=[[c],[w===null?1:0],[Number.NEGATIVE_INFINITY],[R],[L]],X=w;w=n.runWebGLProgram(F,G,"int32",H),Ji(n,X)};for(let R=1;R<g;R*=2){const L=R*2;for(let U=R;U>=1;U/=2)x(L,U,[m,b])}for(let R=b;R>g;R/=2){const L=k(),U=new Ufe([m,R/2]),F=[[c],[w===null?1:0],[g]],z=w;w=n.runWebGLProgram(U,L,"int32",F),Ji(n,z);const H=g/2,X=H*2;for(let j=H;j>=1;j/=2)x(X,j,w.shape)}let S=w;w=$c({inputs:{x:w},backend:n,attrs:{begin:0,size:[m,r]}}),Ji(n,S);let C=B3({inputs:{x:y,indices:w},backend:n,attrs:{axis:1,batchDims:1}});Ji(n,y);const T=u.slice(0,-1);T.push(r),S=w,w=le({inputs:{x:w},attrs:{shape:T},backend:n}),Ji(n,S);const E=C;return C=le({inputs:{x:C},attrs:{shape:T},backend:n}),Ji(n,E),[C,w]}const Hfe={kernelName:jy,backendName:"webgl",kernelFunc:Gfe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kfe{constructor(e,n,s,a,r,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const o=s==="nearest"?1:2;let l;switch(a){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${r});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${r});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qfe(t){const{inputs:e,backend:n,attrs:s}=t,{image:a,transforms:r}=e,{interpolation:i,fillMode:o,fillValue:l,outputShape:u}=s,[c,d,p,h]=a.shape,[f,m]=u??[d,p],y=[c,f,m,h],g=new Kfe(d,p,i,o,l,y);return n.runWebGLProgram(g,[a,r],"float32")}const Jfe={kernelName:_y,backendName:"webgl",kernelFunc:qfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xfe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:a}=n,{x:r}=e;Zh(r,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(r.dataId),{outputValues:o,outputShape:l,indices:u}=Jre(i,a,r.shape,r.dtype);return[s.makeTensorInfo(l,r.dtype,o),s.makeTensorInfo([u.length],"int32",u)]}const Yfe={kernelName:Fy,backendName:"webgl",kernelFunc:Xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qfe(t){const{inputs:e,backend:n,attrs:s}=t,{value:a}=e;let{axis:r}=s;r<0&&(r+=a.shape.length);const i=a,o=i.shape.length,l=a.shape[r],u=new Array(o-1);let c=0;for(let m=0;m<o;m++)m!==r&&(u[c++]=i.shape[m]);const d=[],p=new Array(o).fill(0),h=i.shape.slice();h[r]=1;const f=new Array(l);for(let m=0;m<f.length;m++){p[r]=m;const y=$c({inputs:{x:i},backend:n,attrs:{begin:p,size:h}}),g=le({inputs:{x:y},backend:n,attrs:{shape:u}});f[m]=g,d.push(y)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const Zfe={kernelName:yh,backendName:"webgl",kernelFunc:Qfe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eme{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,a=e.batchSize,r=e.inSize,i=e.numSegments,o=i*Math.ceil(r/s);this.outputShape=[a,o];const l="0.0",u="sumValue",c=Math.floor(s/4)*4,d=s%4,p=`
        sumValue += dot(values, segFilter);
    `;let h="";r%s>0&&(h=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `);let f="";r%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${f}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tme(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,segmentIds:r}=e,{numSegments:i}=s,o=a.shape.length,l=[];let u=0;const c=Nt([u],o);let d=a;c!=null&&(d=_n({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(d),u=Dt(1,o)[0]);const p=NO(d.shape,u,i),h=K([d.shape[u]]),f=le({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(f);const m=By(a.dtype),y=(k,x,S,C,T)=>{const E=k.shape[0],R=k.shape[1],L=SO(R,T),U={windowSize:L,inSize:R,batchSize:E,numSegments:T},G=new eme(U,x),F=n.compileAndRun(G,[k,S],C);if(l.push(F),F.shape[1]===T)return F;const z=H3({backend:n,attrs:{start:0,stop:T,step:1,dtype:"float32"}}),H=K3({inputs:{x:z},backend:n,attrs:{reps:[R/L]}});return l.push(z),l.push(H),y(F,x,H,C,T)},g=y(f,"unsortedSegmentSum",r,m,i),b=le({inputs:{x:g},backend:n,attrs:{shape:p}});let w=b;if(c!=null){l.push(b);const k=Li(c);w=_n({inputs:{x:w},backend:n,attrs:{perm:k}})}return l.forEach(k=>n.disposeIntermediateTensorInfo(k)),w}const nme={kernelName:bh,backendName:"webgl",kernelFunc:tme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sme=[zie,Vie,Gie,qie,Xie,Zie,toe,soe,ooe,uoe,poe,moe,boe,voe,Coe,Toe,Eoe,Doe,_oe,Poe,Moe,qoe,Xoe,ele,nle,lle,cle,fle,Sie,yle,vle,Ile,Ole,_le,Ple,Ble,Mle,Gle,qle,Yle,Zle,tue,sue,iue,lue,pue,fue,yue,kue,vue,Iue,Rue,jue,Pue,zue,Mue,Wue,Gue,Kue,Jue,Yue,tce,ace,oce,uce,pce,mce,wce,Sce,vie,Cce,kle,$ce,Ace,jce,Cie,Lce,Vce,Uce,qce,Yce,tde,ade,lde,pde,mde,yde,xde,Sde,Cde,Ede,Ade,Dde,_de,Pde,Mde,Gde,Jde,spe,$ie,ope,cpe,hpe,gpe,ale,wpe,xpe,Spe,Ipe,Rpe,Tie,Ope,jpe,Fpe,Lpe,Bpe,rle,Zde,Vpe,Hpe,Xpe,Rie,ehe,she,ohe,che,fhe,ghe,whe,vhe,Che,$he,Ahe,jhe,Lhe,Mhe,Ghe,qhe,Hoe,tpe,Yhe,Zhe,tfe,sfe,rfe,ofe,ufe,dfe,hfe,gfe,bfe,kfe,vfe,Cfe,Tfe,Efe,Afe,epe,Pie,jfe,Pfe,Bfe,Vfe,Hfe,Jfe,Lie,Yfe,Zfe,nme,kpe];for(const t of sme)Ly(t);var zk={exports:{}};const ame=Mk(BX),rme=Mk(uK);/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(function(t,e){(function(n,s){s(e,ame,rme)})(Ir,function(n,s,a){const r={1:{name:"/m/01g317",id:1,displayName:"person"},2:{name:"/m/0199g",id:2,displayName:"bicycle"},3:{name:"/m/0k4j",id:3,displayName:"car"},4:{name:"/m/04_sv",id:4,displayName:"motorcycle"},5:{name:"/m/05czz6l",id:5,displayName:"airplane"},6:{name:"/m/01bjv",id:6,displayName:"bus"},7:{name:"/m/07jdr",id:7,displayName:"train"},8:{name:"/m/07r04",id:8,displayName:"truck"},9:{name:"/m/019jd",id:9,displayName:"boat"},10:{name:"/m/015qff",id:10,displayName:"traffic light"},11:{name:"/m/01pns0",id:11,displayName:"fire hydrant"},13:{name:"/m/02pv19",id:13,displayName:"stop sign"},14:{name:"/m/015qbp",id:14,displayName:"parking meter"},15:{name:"/m/0cvnqh",id:15,displayName:"bench"},16:{name:"/m/015p6",id:16,displayName:"bird"},17:{name:"/m/01yrx",id:17,displayName:"cat"},18:{name:"/m/0bt9lr",id:18,displayName:"dog"},19:{name:"/m/03k3r",id:19,displayName:"horse"},20:{name:"/m/07bgp",id:20,displayName:"sheep"},21:{name:"/m/01xq0k1",id:21,displayName:"cow"},22:{name:"/m/0bwd_0j",id:22,displayName:"elephant"},23:{name:"/m/01dws",id:23,displayName:"bear"},24:{name:"/m/0898b",id:24,displayName:"zebra"},25:{name:"/m/03bk1",id:25,displayName:"giraffe"},27:{name:"/m/01940j",id:27,displayName:"backpack"},28:{name:"/m/0hnnb",id:28,displayName:"umbrella"},31:{name:"/m/080hkjn",id:31,displayName:"handbag"},32:{name:"/m/01rkbr",id:32,displayName:"tie"},33:{name:"/m/01s55n",id:33,displayName:"suitcase"},34:{name:"/m/02wmf",id:34,displayName:"frisbee"},35:{name:"/m/071p9",id:35,displayName:"skis"},36:{name:"/m/06__v",id:36,displayName:"snowboard"},37:{name:"/m/018xm",id:37,displayName:"sports ball"},38:{name:"/m/02zt3",id:38,displayName:"kite"},39:{name:"/m/03g8mr",id:39,displayName:"baseball bat"},40:{name:"/m/03grzl",id:40,displayName:"baseball glove"},41:{name:"/m/06_fw",id:41,displayName:"skateboard"},42:{name:"/m/019w40",id:42,displayName:"surfboard"},43:{name:"/m/0dv9c",id:43,displayName:"tennis racket"},44:{name:"/m/04dr76w",id:44,displayName:"bottle"},46:{name:"/m/09tvcd",id:46,displayName:"wine glass"},47:{name:"/m/08gqpm",id:47,displayName:"cup"},48:{name:"/m/0dt3t",id:48,displayName:"fork"},49:{name:"/m/04ctx",id:49,displayName:"knife"},50:{name:"/m/0cmx8",id:50,displayName:"spoon"},51:{name:"/m/04kkgm",id:51,displayName:"bowl"},52:{name:"/m/09qck",id:52,displayName:"banana"},53:{name:"/m/014j1m",id:53,displayName:"apple"},54:{name:"/m/0l515",id:54,displayName:"sandwich"},55:{name:"/m/0cyhj_",id:55,displayName:"orange"},56:{name:"/m/0hkxq",id:56,displayName:"broccoli"},57:{name:"/m/0fj52s",id:57,displayName:"carrot"},58:{name:"/m/01b9xk",id:58,displayName:"hot dog"},59:{name:"/m/0663v",id:59,displayName:"pizza"},60:{name:"/m/0jy4k",id:60,displayName:"donut"},61:{name:"/m/0fszt",id:61,displayName:"cake"},62:{name:"/m/01mzpv",id:62,displayName:"chair"},63:{name:"/m/02crq1",id:63,displayName:"couch"},64:{name:"/m/03fp41",id:64,displayName:"potted plant"},65:{name:"/m/03ssj5",id:65,displayName:"bed"},67:{name:"/m/04bcr3",id:67,displayName:"dining table"},70:{name:"/m/09g1w",id:70,displayName:"toilet"},72:{name:"/m/07c52",id:72,displayName:"tv"},73:{name:"/m/01c648",id:73,displayName:"laptop"},74:{name:"/m/020lf",id:74,displayName:"mouse"},75:{name:"/m/0qjjc",id:75,displayName:"remote"},76:{name:"/m/01m2v",id:76,displayName:"keyboard"},77:{name:"/m/050k8",id:77,displayName:"cell phone"},78:{name:"/m/0fx9l",id:78,displayName:"microwave"},79:{name:"/m/029bxz",id:79,displayName:"oven"},80:{name:"/m/01k6s3",id:80,displayName:"toaster"},81:{name:"/m/0130jx",id:81,displayName:"sink"},82:{name:"/m/040b_t",id:82,displayName:"refrigerator"},84:{name:"/m/0bt_c3",id:84,displayName:"book"},85:{name:"/m/01x3z",id:85,displayName:"clock"},86:{name:"/m/02s195",id:86,displayName:"vase"},87:{name:"/m/01lsmm",id:87,displayName:"scissors"},88:{name:"/m/0kmg4",id:88,displayName:"teddy bear"},89:{name:"/m/03wvsk",id:89,displayName:"hair drier"},90:{name:"/m/012xff",id:90,displayName:"toothbrush"}};class i{constructor(l,u){this.modelPath=u||`https://storage.googleapis.com/tfjs-models/savedmodel/${this.getPrefix(l)}/model.json`}getPrefix(l){return l==="lite_mobilenet_v2"?`ssd${l}`:`ssd_${l}`}async load(){this.model=await s.loadGraphModel(this.modelPath);const l=a.zeros([1,300,300,3],"int32"),u=await this.model.executeAsync(l);await Promise.all(u.map(c=>c.data())),u.map(c=>c.dispose()),l.dispose()}async infer(l,u,c){const d=a.tidy(()=>(l instanceof a.Tensor||(l=a.browser.fromPixels(l)),a.expandDims(l))),p=d.shape[1],h=d.shape[2],f=await this.model.executeAsync(d),m=f[0].dataSync(),y=f[1].dataSync();d.dispose(),a.dispose(f);const[g,b]=this.calculateMaxScores(m,f[0].shape[1],f[0].shape[2]),w=a.getBackend();a.getBackend()==="webgl"&&a.setBackend("cpu");const k=a.tidy(()=>{const S=a.tensor2d(y,[f[1].shape[1],f[1].shape[3]]);return a.image.nonMaxSuppression(S,g,u,c,c)}),x=k.dataSync();return k.dispose(),w!==a.getBackend()&&a.setBackend(w),this.buildDetectedObjects(h,p,y,g,x,b)}buildDetectedObjects(l,u,c,d,p,h){const f=p.length,m=[];for(let y=0;y<f;y++){const g=[];for(let S=0;S<4;S++)g[S]=c[4*p[y]+S];const b=g[0]*u,w=g[1]*l,k=g[2]*u,x=g[3]*l;g[0]=w,g[1]=b,g[2]=x-w,g[3]=k-b,m.push({bbox:g,class:r[h[p[y]]+1].displayName,score:d[p[y]]})}return m}calculateMaxScores(l,u,c){const d=[],p=[];for(let h=0;h<u;h++){let f=Number.MIN_VALUE,m=-1;for(let y=0;y<c;y++)l[h*c+y]>f&&(f=l[h*c+y],m=y);d[h]=f,p[h]=m}return[d,p]}async detect(l,u=20,c=.5){return this.infer(l,u,c)}dispose(){this.model!=null&&this.model.dispose()}}n.ObjectDetection=i,n.load=async function(o={}){if(a==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");const l=o.base||"lite_mobilenet_v2",u=o.modelUrl;if(["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(l)===-1)throw new Error(`ObjectDetection constructed with invalid base model ${l}. Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.`);const c=new i(l,u);return await c.load(),c},n.version="2.2.3",Object.defineProperty(n,"__esModule",{value:!0})})})(zk,zk.exports);var ime=zk.exports;let sd=null;const ome=async()=>sd||(await wR(),sd=await ime.load({base:"mobilenet_v2"}),sd),lme=()=>sd,q3={person:"",bicycle:"",car:"",motorcycle:"",airplane:"",bus:"",train:"",truck:"",boat:"","traffic light":"","fire hydrant":"","stop sign":"","parking meter":"",bench:"",bird:"",cat:"",dog:"",horse:"",sheep:"",cow:"",elephant:"",bear:"",zebra:"",giraffe:"",backpack:"",umbrella:"",handbag:"",tie:"",suitcase:"",frisbee:"",skis:"",snowboard:"","sports ball":"",kite:"","baseball bat":"","baseball glove":"",skateboard:"",surfboard:"","tennis racket":"",bottle:"","wine glass":"",cup:"",fork:"",knife:"",spoon:"",bowl:"",banana:"",apple:"",sandwich:"",orange:"",broccoli:"",carrot:"","hot dog":"",pizza:"",donut:"",cake:"",chair:"",couch:"","potted plant":"",bed:"","dining table":"",toilet:"",tv:"",laptop:"",mouse:"",remote:"",keyboard:"","cell phone":"",microwave:"",oven:"",toaster:"",sink:"",refrigerator:"",book:"",clock:"",vase:"",scissors:"","teddy bear":"","hair drier":"",toothbrush:""},ume=(t,e=q3)=>e[t]||t,J3=async t=>{const e=lme();if(!e)throw new Error("Model not loaded");try{return(await e.detect(t)).map(s=>({bbox:s.bbox,class:ume(s.class),score:s.score}))}catch(n){return console.error("Detection error:",n),[]}},ug=(t,e,n=null)=>{t.clearRect(0,0,t.canvas.width,t.canvas.height),(n?e.filter(a=>a.class===n):e).forEach(a=>{const[r,i,o,l]=a.bbox,u=Math.round(a.score*100);let c="#FF3B30";a.score>.5&&(c="#FFCC00"),a.score>.7&&(c="#34C759"),t.strokeStyle=c,t.lineWidth=2;const d=Math.max(0,Math.min(r,t.canvas.width-2)),p=Math.max(0,Math.min(i,t.canvas.height-2)),h=Math.min(o,t.canvas.width-d-2),f=Math.min(l,t.canvas.height-p-2);t.strokeRect(d,p,h,f),t.fillStyle=`${c}DD`,t.font="14px Arial";const m=t.measureText(`${a.class} ${u}%`),y=20,g=d,b=Math.max(y,p);t.fillRect(g,b-y,m.width+10,y),t.fillStyle="#FFFFFF",t.fillText(`${a.class} ${u}%`,g+5,b-5)})},cme=t=>t>.7?"text-green-500 dark:text-green-400":t>.5?"text-yellow-500 dark:text-yellow-400":"text-red-500 dark:text-red-400",dme=({onResults:t,modelLoaded:e,filteredClass:n,onWebcamStateChange:s})=>{const a=B.useRef(null),r=B.useRef(null),[i,o]=B.useState(!1),[l,u]=B.useState(!1),[c,d]=B.useState(null),[p,h]=B.useState([]),f=B.useRef(null),m=B.useRef(null),[y,g]=B.useState(!1);B.useEffect(()=>{const S=()=>{g(window.innerWidth<=768)};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]);const b=async()=>{var S;if(!((S=navigator.mediaDevices)!=null&&S.getUserMedia)){d("Browser Anda tidak mendukung akses webcam");return}try{d(null);const C={video:{facingMode:"environment",aspectRatio:y?3/4:16/9}},T=await navigator.mediaDevices.getUserMedia(C);a.current&&(a.current.srcObject=T,await a.current.play(),u(!0),s==null||s(!0))}catch(C){console.error("Error accessing webcam:",C),d("Tidak dapat mengakses kamera. Pastikan Anda telah memberikan izin untuk mengakses kamera.")}},w=()=>{a.current&&a.current.srcObject&&(a.current.srcObject.getTracks().forEach(T=>T.stop()),a.current.srcObject=null,u(!1),s==null||s(!1),f.current!==null&&(clearInterval(f.current),f.current=null),o(!1),t([]),h([]))},k=async()=>{if(!a.current||!r.current||!e)return;const S=a.current,C=r.current,T=C.getContext("2d");if(!(!T||S.paused||S.ended))try{(C.width!==S.videoWidth||C.height!==S.videoHeight)&&(C.width=S.videoWidth,C.height=S.videoHeight);const E=await J3(S);h(E),t(E),ug(T,E,n)}catch(E){console.error("Detection error:",E)}},x=()=>{a.current&&r.current&&(r.current.width=a.current.videoWidth,r.current.height=a.current.videoHeight)};return B.useEffect(()=>{if(r.current&&p.length>0){const S=r.current.getContext("2d");S&&ug(S,p,n)}},[n,p]),B.useEffect(()=>()=>{f.current!==null&&clearInterval(f.current),w()},[]),B.useEffect(()=>{l&&e&&!i&&(o(!0),k(),f.current=window.setInterval(k,y?41.67:100))},[l,e,y]),N.jsxs("div",{id:"webcamView",className:"relative flex-1 flex flex-col bg-black rounded-2xl overflow-hidden",children:[!l&&!c&&N.jsxs("div",{className:`absolute inset-0 flex items-center justify-center flex-col p-6 z-10 bg-surface-50 ${y?"aspect-[3/4]":""}`,children:[N.jsx(nE,{size:48,className:"text-surface-400 mb-4"}),N.jsx("h3",{className:"text-lg font-medium mb-2 text-surface-900",children:"Akses Kamera Diperlukan"}),N.jsx("p",{className:"text-surface-600 text-center mb-4",children:"Klik tombol di bawah untuk mengaktifkan kamera Anda untuk deteksi objek secara langsung"}),N.jsx("button",{id:"startCameraBtn",onClick:b,disabled:!e,className:"neu-button text-primary-600 font-medium",children:"Aktifkan Kamera"})]}),c&&N.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col p-6 z-10 bg-surface-50",children:[N.jsx(tE,{size:48,className:"text-accent-500 mb-4"}),N.jsx("h3",{className:"text-lg font-medium text-surface-800 mb-2",children:"Error Kamera"}),N.jsx("p",{className:"text-surface-600 text-center mb-4",children:c}),N.jsx("button",{onClick:()=>window.location.reload(),className:"neu-button text-primary-600 font-medium",children:"Ulangi"})]}),N.jsxs("div",{ref:m,className:`relative flex-1 flex items-center justify-center ${y?"aspect-[3/4]":"aspect-[16/9]"}`,children:[N.jsx("video",{ref:a,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0,onLoadedMetadata:x}),N.jsx("canvas",{ref:r,className:"absolute top-0 left-0 w-full h-full"}),l&&y&&N.jsx("button",{onClick:w,className:"absolute top-4 right-4 p-2 bg-surface-800/70 text-white rounded-full hover:bg-surface-700 transition-colors","aria-label":"Stop camera",children:N.jsx(hd,{size:20})})]}),l&&!y&&N.jsxs("div",{className:"p-4 flex flex-col sm:flex-row sm:justify-between gap-4 bg-surface-50",children:[N.jsx("div",{className:"text-sm flex items-center justify-center sm:justify-start",children:i?N.jsxs("span",{className:"flex items-center text-primary-600",children:[N.jsx("span",{className:"inline-block w-2 h-2 bg-primary-500 rounded-full mr-2 animate-pulse"}),"Deteksi aktif"]}):N.jsx("span",{className:"text-surface-600",children:"Deteksi berhenti"})}),N.jsx("div",{className:"grid grid-cols-2 sm:flex gap-2",children:N.jsx("button",{onClick:w,className:"neu-button flex-1 sm:flex-initial min-w-[120px] text-accent-600",children:"Hentikan Kamera"})})]})]})},pme=({onResults:t,modelLoaded:e,filteredClass:n})=>{const[s,a]=B.useState(null),[r,i]=B.useState(!1),[o,l]=B.useState(!1),[u,c]=B.useState(null),[d,p]=B.useState([]),[h,f]=B.useState(!1),m=B.useRef(null),y=B.useRef(null),g=B.useRef(null),b=B.useRef(null),w=B.useRef(0),[k,x]=B.useState(!1);B.useEffect(()=>{const F=()=>{f(window.innerWidth<=768)};return F(),window.addEventListener("resize",F),()=>window.removeEventListener("resize",F)},[]);const S=F=>{if(!F.type.startsWith("image/")){c("Please upload an image file (JPEG, PNG, etc.)");return}c(null),p([]),t([]),i(!1);const z=new FileReader;z.onload=H=>{var X;(X=H.target)!=null&&X.result&&a(H.target.result)},z.onerror=()=>{c("Failed to read the image file")},z.readAsDataURL(F)},C=F=>{const z=F.target.files;z&&z.length>0&&S(z[0])},T=F=>{F.preventDefault(),F.stopPropagation(),w.current++,F.dataTransfer.items&&F.dataTransfer.items.length>0&&x(!0)},E=F=>{F.preventDefault(),F.stopPropagation(),w.current--,w.current===0&&x(!1)},R=F=>{F.preventDefault(),F.stopPropagation()},L=F=>{F.preventDefault(),F.stopPropagation(),x(!1),w.current=0;const z=F.dataTransfer.files;z&&z.length>0&&(S(z[0]),F.dataTransfer.clearData())},U=()=>{if(a(null),i(!1),p([]),t([]),c(null),m.current&&(m.current.value=""),g.current){const F=g.current.getContext("2d");F==null||F.clearRect(0,0,g.current.width,g.current.height)}},G=async()=>{if(!y.current||!g.current||!e||!s||!r){console.log("processImage: Aborting, conditions not met",{modelLoaded:e,imageUrl:s,isImageLoaded:r,imageRef:!!y.current,canvasRef:!!g.current});return}if(!o){l(!0),console.log("processImage: Starting");try{const F=y.current,z=g.current,H=b.current;if(!H){console.warn("processImage: Referensi kontainer tidak ditemukan."),l(!1);return}if(F.naturalWidth===0||F.naturalHeight===0){console.warn("processImage: Dimensi gambar alami adalah nol. Gambar mungkin tidak dimuat secara penuh atau rusak."),l(!1);return}const X=H.getBoundingClientRect();if(X.width===0||X.height===0){console.warn("processImage: Dimensi kontainer adalah nol. Tidak dapat mengubah ukuran gambar untuk canvas."),l(!1);return}const j=Math.min(X.width/F.naturalWidth,X.height/F.naturalHeight);if(z.width=F.naturalWidth*j,z.height=F.naturalHeight*j,z.width===0||z.height===0){console.warn("processImage: Dimensi canvas yang dihitung adalah nol. Melewati deteksi."),l(!1);return}const V=z.getContext("2d");if(!V){console.warn("processImage: Tidak dapat mendapatkan konteks 2D dari canvas."),l(!1);return}const q=await J3(F);console.log("processImage: Detection results:",q),p(q),t(q);const Y=q.map(Z=>({...Z,bbox:[Z.bbox[0]*j,Z.bbox[1]*j,Z.bbox[2]*j,Z.bbox[3]*j]}));ug(V,Y,n)}catch(F){console.error("Error deteksi dalam processImage:",F),c("Error deteksi objek dalam gambar")}finally{l(!1),console.log("processImage: Selesai")}}};return B.useEffect(()=>{s&&r&&e?(console.log("useEffect [imageUrl, isImageLoaded, modelLoaded]: Semua kondisi terpenuhi, memanggil processImage."),G()):console.log("useEffect [imageUrl, isImageLoaded, modelLoaded]: Kondisi tidak terpenuhi.",{imageUrl:!!s,isImageLoaded:r,modelLoaded:e})},[s,r,e]),B.useEffect(()=>{if(g.current&&d.length>0&&s&&r){console.log("useEffect [filteredClass, detections, imageUrl, isImageLoaded, isMobile]: Menggambar ulang untuk perubahan filter.");const F=y.current,z=g.current,H=z.getContext("2d"),X=b.current;if(H&&F&&X&&F.naturalWidth>0&&F.naturalHeight>0){const j=X.getBoundingClientRect();if(j.width===0||j.height===0)return;const V=Math.min(j.width/F.naturalWidth,j.height/F.naturalHeight);if(z.width=F.naturalWidth*V,z.height=F.naturalHeight*V,z.width===0||z.height===0)return;const q=d.map(Y=>({...Y,bbox:[Y.bbox[0]*V,Y.bbox[1]*V,Y.bbox[2]*V,Y.bbox[3]*V]}));ug(H,q,n)}}},[n,d,s,r,h]),B.useEffect(()=>{const F=()=>{s&&r&&e&&(console.log("handleResize: Kondisi terpenuhi, memanggil processImage setelah delay."),setTimeout(()=>G(),100))};return window.addEventListener("resize",F),()=>window.removeEventListener("resize",F)},[s,r,e]),N.jsxs("div",{className:"relative flex-1 flex flex-col bg-black rounded-2xl overflow-hidden",onDragEnter:T,onDragLeave:E,onDragOver:R,onDrop:L,children:[s?N.jsxs(N.Fragment,{children:[N.jsxs("div",{ref:b,className:`relative flex-1 flex items-center justify-center ${h?"aspect-[3/4]":"aspect-[16/9]"}`,children:[N.jsx("img",{ref:y,src:s,alt:"Unggah",className:"max-w-full max-h-full object-contain",onLoad:()=>{console.log("img.onLoad: Gambar telah dimuat."),i(!0)},onError:()=>{console.error("img.onError: Gagal memuat gambar."),c("Gagal memuat gambar. Gambar mungkin rusak atau format tidak didukung."),i(!1)}}),N.jsx("canvas",{ref:g,className:"absolute top-0 left-0 w-full h-full"}),o&&N.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:N.jsx("div",{className:"inline-block w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})}),h&&N.jsx("button",{onClick:U,className:"absolute top-4 right-4 p-2 bg-surface-800/70 text-white rounded-full hover:bg-surface-700 transition-colors z-10","aria-label":"Clear image",children:N.jsx(hd,{size:20})})]}),N.jsx("div",{className:"p-4 bg-surface-50 flex flex-col sm:flex-row gap-2 justify-center",children:N.jsxs("button",{onClick:U,className:"neu-button text-accent-600 flex-1 sm:flex-initial min-w-[120px] inline-flex items-center justify-center",children:[N.jsx(hd,{size:18,className:"mr-2"}),"Hapus gambar"]})})]}):N.jsxs("div",{className:`relative flex-1 flex flex-col items-center justify-center p-6 bg-surface-50 transition-all duration-300 ${h?"aspect-[3/4]":"aspect-[16/9]"} ${k?"ring-4 ring-primary-500 bg-primary-50 scale-[0.99]":""}`,children:[N.jsx("input",{type:"file",ref:m,onChange:C,accept:"image/*",className:"hidden"}),k?N.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-primary-50/70 backdrop-blur-sm animate-pulse",children:[N.jsx(Pw,{size:64,className:"text-primary-600 mb-4 animate-bounce"}),N.jsx("h3",{className:"text-xl font-medium text-primary-700",children:"Letakkan gambar di sini"})]}):N.jsxs(N.Fragment,{children:[N.jsx(OB,{size:48,className:"text-surface-400 mb-4"}),N.jsx("h3",{className:"text-lg font-medium mb-2 text-surface-900",children:"Unggah gambar"}),N.jsx("p",{className:"text-surface-600 text-center mb-4",children:"Tarik dan lepas gambar di sini, atau klik tombol di bawah untuk memilih satu"}),N.jsxs("button",{onClick:()=>{var F;return(F=m.current)==null?void 0:F.click()},disabled:!e,className:"neu-button text-primary-600 font-medium inline-flex items-center",children:[N.jsx(Pw,{size:18,className:"mr-2"}),"Pilih gambar"]})]})]}),u&&N.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col p-6 z-20 bg-surface-50",children:[N.jsx(hd,{size:32,className:"text-accent-500 mb-4"}),N.jsx("h3",{className:"text-lg font-medium text-surface-800 mb-2",children:"Error"}),N.jsx("p",{className:"text-surface-600 text-center mb-4",children:u}),N.jsx("button",{onClick:U,className:"neu-button text-primary-600 font-medium",children:"Tutup"})]})]})},hme=({results:t,onFilterChange:e,filteredClass:n})=>{const[s,a]=B.useState("confidence"),[r,i]=B.useState("desc"),o=B.useMemo(()=>{const d=new Set(t.map(p=>p.class));return Array.from(d)},[t]),l=d=>{s===d?i(r==="asc"?"desc":"asc"):(a(d),i(d==="confidence"?"desc":"asc"))},u=B.useMemo(()=>[...t].sort((d,p)=>s==="confidence"?r==="asc"?d.score-p.score:p.score-d.score:r==="asc"?d.class.localeCompare(p.class):p.class.localeCompare(d.class)),[t,s,r]),c=B.useMemo(()=>{const d={};return t.forEach(p=>{d[p.class]=(d[p.class]||0)+1}),d},[t]);return N.jsxs("div",{id:"detectedItems",className:"h-full flex flex-col bg-surface-50 rounded-2xl shadow-neu",children:[N.jsxs("div",{className:"p-4 border-b border-surface-200",children:[N.jsx("h2",{className:"text-lg font-semibold mb-1 text-surface-900",children:"Hasil Deteksi"}),N.jsx("p",{className:"text-sm text-surface-600",children:t.length===0?"Tidak ada objek yang terdeteksi":`${t.length} objek${t.length!==1?"s":""} ditemukan`})]}),t.length>0&&N.jsxs(N.Fragment,{children:[N.jsxs("div",{className:"p-4 border-b border-surface-200 bg-surface-100",children:[N.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center text-surface-800",children:[N.jsx(dN,{size:16,className:"mr-1"}),"Filter berdasarkan Kelompok"]}),N.jsxs("div",{className:"flex flex-wrap gap-2",children:[N.jsxs("button",{onClick:()=>e(null),className:`px-2 py-1 text-xs rounded-full transition-colors ${n===null?"bg-primary-500 text-white":"bg-surface-200 hover:bg-surface-300"}`,children:["Semua (",t.length,")"]}),o.map(d=>N.jsxs("button",{onClick:()=>e(d),className:`px-2 py-1 text-xs rounded-full transition-colors ${n===d?"bg-primary-500 text-white":"bg-surface-200 hover:bg-surface-300"}`,children:[d," (",c[d],")"]},d))]})]}),N.jsx("div",{className:"p-2 border-b border-surface-200",children:N.jsxs("div",{className:"flex items-center text-sm font-medium text-surface-600 px-2",children:[N.jsxs("button",{onClick:()=>l("class"),className:"flex items-center flex-1",children:["Kelompok",s==="class"&&N.jsx(cN,{size:14,className:"ml-1"})]}),N.jsxs("button",{onClick:()=>l("confidence"),className:"flex items-center w-24 justify-end",children:["Kemiripan",s==="confidence"&&N.jsx(cN,{size:14,className:"ml-1"})]})]})}),N.jsx("div",{className:"flex-1 overflow-y-auto",children:u.filter(d=>n===null||d.class===n).map((d,p)=>N.jsxs(ss,{to:`/benda/${d.class}`,state:{from:"detection"},className:`group bg-white/50 rounded-xl overflow-hidden transition-all duration-300
                           hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1
                           active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0
                           border border-white/30 p-3`,children:[N.jsxs("div",{className:"flex items-center justify-between",children:[N.jsxs("div",{className:"flex items-center",children:[N.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-500 mr-2"}),N.jsxs("span",{className:"font-medium capitalize text-surface-900",children:[d.class,mi[d.class]&&` (${mi[d.class].indonesian})`]})]}),N.jsxs("div",{className:`font-medium ${cme(d.score)} mr-4`,children:[Math.round(d.score*100),"%"]})]}),N.jsxs("div",{className:"mt-1 text-xs text-surface-600 ml-4",children:["Position: x:",Math.round(d.bbox[0]),", y:",Math.round(d.bbox[1])]})]},p))})]}),t.length===0&&N.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:N.jsxs("div",{className:"text-center",children:[N.jsx(dN,{size:24,className:"mx-auto mb-2 text-surface-400"}),N.jsx("p",{className:"text-surface-600",children:"Tidak ada objek yang terdeteksi. Cobalah arahkan kamera ke objek yang berbeda atau unggah gambar."})]})})]})},fme=({results:t,filteredClass:e})=>{const[n,s]=B.useState(!1);return Bx(),B.useEffect(()=>{console.log("MobileResultsView received results:",t)},[t]),t.length===0?null:N.jsx("div",{id:"detectedItems",className:"fixed bottom-0 left-0 right-0 z-50 p-4",children:N.jsxs("div",{className:`glass-panel overflow-hidden transition-all duration-300 ease-in-out ${n?"max-h-[70vh]":"max-h-[120px]"}`,children:[N.jsxs("button",{onClick:()=>s(!n),className:"w-full p-4 flex items-center justify-between bg-gradient-to-b from-primary-500/10 to-transparent",children:[N.jsxs("div",{className:"flex items-center gap-2",children:[N.jsx("div",{className:"flex -space-x-1",children:t.slice(0,3).map((a,r)=>N.jsx("div",{className:`w-2 h-2 rounded-full ring-2 ring-white ${a.score>.7?"bg-green-500":a.score>.5?"bg-yellow-500":"bg-red-500"}`},r))}),N.jsxs("span",{className:"font-medium text-surface-800",children:[t.length," Detection",t.length!==1?"s":""]})]}),n?N.jsx(TB,{size:20,className:"text-surface-600"}):N.jsx(RB,{size:20,className:"text-surface-600"})]}),N.jsx("div",{className:"divide-y divide-white/10",children:t.filter(a=>e===null||a.class===e).map((a,r)=>N.jsx(ss,{to:`/benda/${a.class}`,state:{from:"detection"},className:`group bg-white/50 rounded-xl overflow-hidden transition-all duration-300\r
                       hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                       active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                       border border-white/30`,children:N.jsxs("div",{className:"flex items-center justify-between ml-4",children:[N.jsxs("div",{className:"flex items-center gap-3",children:[N.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${a.score>.7?"bg-green-500 shadow-lg shadow-green-500/20":a.score>.5?"bg-yellow-500 shadow-lg shadow-yellow-500/20":"bg-red-500 shadow-lg shadow-red-500/20"}`}),N.jsxs("span",{className:"font-medium capitalize text-surface-800",children:[a.class,mi[a.class]&&` (${mi[a.class].indonesian})`]})]}),N.jsxs("div",{className:`px-2 py-1 rounded-full text-sm font-semibold ${a.score>.7?"bg-green-50 text-green-700":a.score>.5?"bg-yellow-50 text-yellow-700":"bg-red-50 text-red-700"} mr-3`,children:[Math.round(a.score*100),"%"]})]})},r))})]})})},mme=()=>{const[t,e]=B.useState("webcam"),[n,s]=B.useState(!1),[a,r]=B.useState(!0),[i,o]=B.useState(null),[l,u]=B.useState([]),[c,d]=B.useState(null),[p,h]=B.useState(!1),[f,m]=B.useState(!1),[y,g]=B.useState(!1),b=[{target:"#startCameraBtn",content:"Klik di sini untuk mengaktifkan kamera.",disableBeacon:!0},{target:"#webcamView",content:"Tunjukkan benda ke kamera agar sistem mendeteksinya."},{target:"#detectedItems",content:"Klik hasil deteksi untuk melihat kosakata dan penjelasan dalam bahasa Jepang."},{target:"#uploadImageBtn",content:"Kalau punya gambar dari galeri, klik di sini untuk deteksi lewat gambar."},{target:"#detectedItems",content:"Klik hasil deteksi gambar untuk melihat detail kosakata, sama seperti saat pakai kamera."}];B.useEffect(()=>{const E=localStorage.getItem("onboardingLastSeen"),R=new Date().toISOString().split("T")[0];(!E||E!==R)&&n&&g(!0)},[n]);const w=E=>{const{status:R}=E;if(["finished","skipped"].includes(R)&&(g(!1),E.lifecycle==="init")){const U=new Date().toISOString().split("T")[0];localStorage.setItem("onboardingLastSeen",U)}},k=()=>{g(!0)};B.useEffect(()=>{e("webcam"),u([]),d(null),m(!1),r(!0),o(null)},[]),B.useEffect(()=>{const E=()=>{h(window.innerWidth<=1024)};return E(),window.addEventListener("resize",E),()=>window.removeEventListener("resize",E)},[]),B.useEffect(()=>{(async()=>{try{r(!0),await ome(),s(!0),o(null)}catch(R){console.error("Failed to load model:",R),o("Gagal memuat model deteksi. Silakan periksa koneksi Anda dan coba lagi.")}finally{r(!1)}})()},[]);const x=E=>{u(E)},S=E=>{e(E),u([]),m(!1)},C=E=>{d(E)},T=E=>{m(E)};return N.jsxs("main",{className:"container mx-auto px-4 py-8 flex flex-col lg:flex-row gap-8",children:[N.jsx(j4,{steps:b,run:y,continuous:!0,showProgress:!0,showSkipButton:!0,callback:w,styles:{options:{arrowColor:"rgba(255, 255, 255, 0.9)",backgroundColor:"rgba(255, 255, 255, 0.9)",primaryColor:"#4F46E5",textColor:"#1F2937",zIndex:1e3},tooltip:{borderRadius:"12px",padding:"1rem 1.5rem"},buttonNext:{backgroundColor:"#4F46E5",borderRadius:"8px"},buttonBack:{color:"#6B7280"},buttonClose:{color:"#9CA3AF"}},locale:{back:"Kembali",close:"Tutup",last:"Selesai",next:"Lanjut",skip:"Lewati"}}),N.jsxs("div",{className:`${p?"w-full":"lg:w-2/3"} flex flex-col gap-6`,children:[N.jsxs("div",{className:"flex justify-between items-center",children:[N.jsx(_4,{mode:t,onModeChange:S,modelLoaded:n}),N.jsx("button",{onClick:k,className:"ml-4 p-2 rounded-full bg-surface-100 text-surface-700 shadow-neu hover:bg-surface-200 transition-all",title:"Mulai Ulang Tutorial",children:N.jsx(AB,{size:20})})]}),i&&N.jsxs("div",{className:"flex items-center gap-2 text-red-600 bg-red-50 p-4 rounded-xl",children:[N.jsx(tE,{size:20}),N.jsx("p",{children:i})]}),a?N.jsxs("div",{className:"flex flex-col items-center justify-center h-64 bg-white/50 rounded-xl gap-4",children:[N.jsx(DB,{className:"w-8 h-8 text-primary-600 animate-spin"}),N.jsx("p",{className:"text-surface-600",children:"Model AI sedang dimuat..."})]}):N.jsx(N.Fragment,{children:t==="webcam"?N.jsx(dme,{onResults:x,modelLoaded:n,filteredClass:c,onWebcamStateChange:T}):N.jsx(pme,{onResults:x,modelLoaded:n,filteredClass:c})})]}),!p&&N.jsx("div",{className:"lg:w-1/3",children:N.jsx(hme,{results:l,onFilterChange:C,filteredClass:c})}),p&&l.length>0&&N.jsx(fme,{results:l,onFilterChange:C,filteredClass:c})]})},gme=()=>{const[t,e]=B.useState(1),n=12,s=Math.ceil(Lw.length/n);B.useEffect(()=>{window.scrollTo(0,0)},[]);const a=Lw.slice((t-1)*n,t*n);return N.jsx("main",{className:"container mx-auto px-4 py-8",children:N.jsxs("div",{className:"backdrop-blur-lg bg-white/30 rounded-2xl p-6 shadow-lg border border-white/20",children:[N.jsxs("div",{className:"flex justify-between items-center mb-6",children:[N.jsxs("div",{className:"flex items-center gap-4",children:[N.jsx("h2",{className:"hidden md:block text-2xl font-bold text-surface-900",children:"Belajar Bersama"}),N.jsx("img",{src:"https://wkwk-japanese.com/wp-content/uploads/2022/12/logo_wkwkjapanese.png",alt:"WKWK Japanese Logo",className:"h-8 w-auto"}),N.jsx("span",{className:"hidden md:block text-lg font-medium text-surface-900",children:"WKWK JAPANESE"})]}),N.jsx(ss,{to:"/",className:`px-4 py-2 bg-white/50 rounded-xl border border-white/30\r
                     hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                     active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                     transition-all duration-300 text-surface-900 font-medium`,children:"Kembali ke Beranda"})]}),N.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map((r,i)=>N.jsxs("a",{href:r.link,target:"_blank",rel:"noopener noreferrer",className:`group bg-white/50 rounded-xl overflow-hidden transition-all duration-300\r
                       hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                       active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                       border border-white/30`,children:[N.jsx("div",{className:"aspect-video overflow-hidden",children:N.jsx("img",{src:r.img,alt:r.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),N.jsxs("div",{className:"p-4",children:[N.jsx("h3",{className:"text-lg font-semibold text-surface-900 mb-2 line-clamp-2",children:r.title}),N.jsx("p",{className:"text-surface-500 text-sm",children:new Date(r.date).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})})]})]},i))}),N.jsxs("div",{className:"mt-8 flex justify-center gap-2",children:[N.jsxs("button",{onClick:()=>e(r=>Math.max(r-1,1)),disabled:t===1,className:`px-4 py-2 bg-white/50 rounded-xl border border-white/30\r
                     hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                     active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                     transition-all duration-300 text-surface-900 font-medium\r
                     disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-none disabled:hover:translate-y-0\r
                     flex items-center gap-2`,children:[N.jsx($B,{className:"w-5 h-5"}),N.jsx("span",{className:"hidden md:inline",children:"Sebelumnya"})]}),N.jsxs("span",{className:"px-4 py-2 bg-white/50 rounded-xl border border-white/30 text-surface-900",children:["Halaman ",t," dari ",s]}),N.jsxs("button",{onClick:()=>e(r=>Math.min(r+1,s)),disabled:t===s,className:`px-4 py-2 bg-white/50 rounded-xl border border-white/30\r
                     hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                     active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                     transition-all duration-300 text-surface-900 font-medium\r
                     disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-none disabled:hover:translate-y-0\r
                     flex items-center gap-2`,children:[N.jsx("span",{className:"hidden md:inline",children:"Selanjutnya"}),N.jsx(EB,{className:"w-5 h-5"})]})]})]})})},yme=Object.entries(q3).reduce((t,[e,n])=>(t[n]=e,t),{}),bme=t=>{const e=mi[t];if(e)return e;const n=yme[t];return n&&mi[n]||null},wme=()=>{var u;const{id:t}=Y$(),e=ji(),n=t?bme(t):null,[s,a]=B.useState(!1),[r,i]=B.useState(null);B.useEffect(()=>{window.scrollTo(0,0)},[t]);const o=((u=e.state)==null?void 0:u.from)==="detection",l=(c,d)=>{if("speechSynthesis"in window){window.speechSynthesis.cancel();const p=new SpeechSynthesisUtterance(c);p.lang="ja-JP",p.onend=()=>{a(!1),i(null)},p.onerror=()=>{a(!1),i(null),console.error("SpeechSynthesisUtterance.onerror")},a(!0),typeof d=="number"&&i(d),window.speechSynthesis.speak(p)}else console.warn("Speech Synthesis not supported in this browser.")};return n?N.jsx("div",{className:"min-h-screen bg-surface-50 p-4 pb-20",children:N.jsxs("div",{className:"container mx-auto max-w-3xl",children:[N.jsxs(ss,{to:o?"/deteksi-benda":"/",className:"inline-flex items-center text-primary-600 hover:text-primary-700 neu-button",children:[N.jsx(uN,{size:20,className:"mr-2"}),o?"Kembali ke Deteksi":"Kembali ke Beranda"]}),N.jsxs("div",{className:"mt-8 neu-card",children:[N.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[N.jsxs("h1",{className:"text-3xl font-bold text-surface-900",children:[n.japanese," (",n.indonesian,")"]}),N.jsx("button",{onClick:()=>l(n.japanese),disabled:s&&r===null,className:`p-2 rounded-full transition-all ${s&&r===null?"bg-primary-100 text-primary-600 shadow-inner":"bg-surface-100 hover:bg-surface-200 text-surface-600 hover:text-primary-600"}`,"aria-label":"Putar pelafalan",children:N.jsx(pN,{size:18,className:s&&r===null?"animate-pulse":""})})]}),N.jsx("p",{className:"text-xl text-primary-600 font-medium mb-8",children:n.romaji}),N.jsx("div",{className:"relative rounded-2xl overflow-hidden mb-8 shadow-lg",children:N.jsx("img",{src:n.imageUrl,alt:n.japanese,className:"w-full aspect-video object-cover"})}),N.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[N.jsxs("section",{children:[N.jsx("h2",{className:"text-xl font-semibold text-surface-900 mb-4",children:"Contoh Kalimat"}),N.jsx("div",{className:"space-y-4",children:n.sentences.map((c,d)=>N.jsx("div",{className:"bg-surface-100 rounded-xl p-4 hover:bg-surface-200/50 transition-colors",children:N.jsxs("div",{className:"flex items-start gap-3",children:[N.jsxs("div",{className:"flex-1",children:[N.jsx("p",{className:"text-lg text-surface-900 mb-2 leading-relaxed",children:c.japanese}),N.jsx("p",{className:"text-primary-600 text-sm mb-1.5",children:c.romaji}),N.jsx("p",{className:"text-surface-600 text-sm",children:c.indonesian})]}),N.jsx("button",{onClick:()=>l(c.japanese,d),disabled:s&&r!==d,className:`p-2 rounded-full transition-all flex-shrink-0 ${r===d?"bg-primary-100 text-primary-600 shadow-inner":"bg-surface-50 hover:bg-surface-200 text-surface-600 hover:text-primary-600"}`,"aria-label":"Putar pelafalan kalimat",children:N.jsx(pN,{size:18,className:r===d?"animate-pulse":""})})]})},d))})]}),N.jsxs("section",{children:[N.jsx("h2",{className:"text-xl font-semibold text-surface-900 mb-4",children:"Informasi Tambahan"}),N.jsx("div",{className:"bg-surface-100 rounded-xl p-6",children:N.jsx("p",{className:"text-surface-600 leading-relaxed",children:n.description})})]})]})]})]})}):N.jsx("div",{className:"min-h-screen bg-surface-50 p-4",children:N.jsxs("div",{className:"container mx-auto",children:[N.jsxs(ss,{to:o?"/deteksi-benda":"/",className:"inline-flex items-center text-primary-600 hover:text-primary-700 neu-button",children:[N.jsx(uN,{size:20,className:"mr-2"}),o?"Kembali ke Deteksi":"Kembali ke Beranda"]}),N.jsx("div",{className:"mt-8 text-center",children:N.jsx("p",{className:"text-surface-600",children:"Detail objek tidak ditemukan."})})]})})},kme=({onSelectKuis:t})=>N.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex flex-col items-center justify-center p-4",children:[N.jsxs("div",{className:"text-center mb-12",children:[N.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-blue-600 mb-4",children:"Pilih Jenis Kuis"}),N.jsx("p",{className:"text-gray-600 text-lg",children:"Pilih jenis kuis yang ingin kamu pelajari"})]}),N.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 w-full max-w-6xl",children:[N.jsxs("button",{onClick:()=>t("hiragana"),className:"group relative bg-gradient-to-br from-blue-500 to-blue-600 p-6 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] overflow-hidden",children:[N.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600 to-blue-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),N.jsxs("div",{className:"relative flex items-center gap-4",children:[N.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-xl flex items-center justify-center shrink-0",children:N.jsx("span",{className:"text-2xl font-bold text-white",children:""})}),N.jsxs("div",{className:"text-left",children:[N.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:"Hiragana"}),N.jsx("p",{className:"text-sm text-white/80",children:"Belajar huruf Hiragana dasar bahasa Jepang"})]})]})]}),N.jsxs("button",{onClick:()=>t("katakana"),className:"group relative bg-gradient-to-br from-green-500 to-green-600 p-6 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] overflow-hidden",children:[N.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-green-600 to-green-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),N.jsxs("div",{className:"relative flex items-center gap-4",children:[N.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-xl flex items-center justify-center shrink-0",children:N.jsx("span",{className:"text-2xl font-bold text-white",children:""})}),N.jsxs("div",{className:"text-left",children:[N.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:"Katakana"}),N.jsx("p",{className:"text-sm text-white/80",children:"Belajar huruf Katakana dasar bahasa Jepang"})]})]})]}),N.jsxs("button",{onClick:()=>t("kosakata"),className:"group relative bg-gradient-to-br from-purple-500 to-purple-600 p-6 rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-[1.02] overflow-hidden",children:[N.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-600 to-purple-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),N.jsxs("div",{className:"relative flex items-center gap-4",children:[N.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-xl flex items-center justify-center shrink-0",children:N.jsx("span",{className:"text-2xl text-white",children:""})}),N.jsxs("div",{className:"text-left",children:[N.jsx("h2",{className:"text-xl font-bold text-white mb-1",children:"Kosakata"}),N.jsx("p",{className:"text-sm text-white/80",children:"Belajar kosakata bahasa Jepang sehari-hari"})]})]})]})]})]}),xme=[{type:"hiragana",japanese:"",romaji:"a"},{type:"hiragana",japanese:"",romaji:"i"},{type:"hiragana",japanese:"",romaji:"u"},{type:"hiragana",japanese:"",romaji:"e"},{type:"hiragana",japanese:"",romaji:"o"},{type:"hiragana",japanese:"",romaji:"ka"},{type:"hiragana",japanese:"",romaji:"ki"},{type:"hiragana",japanese:"",romaji:"ku"},{type:"hiragana",japanese:"",romaji:"ke"},{type:"hiragana",japanese:"",romaji:"ko"},{type:"hiragana",japanese:"",romaji:"sa"},{type:"hiragana",japanese:"",romaji:"shi"},{type:"hiragana",japanese:"",romaji:"su"},{type:"hiragana",japanese:"",romaji:"se"},{type:"hiragana",japanese:"",romaji:"so"},{type:"hiragana",japanese:"",romaji:"ta"},{type:"hiragana",japanese:"",romaji:"chi"},{type:"hiragana",japanese:"",romaji:"tsu"},{type:"hiragana",japanese:"",romaji:"te"},{type:"hiragana",japanese:"",romaji:"to"},{type:"hiragana",japanese:"",romaji:"na"},{type:"hiragana",japanese:"",romaji:"ni"},{type:"hiragana",japanese:"",romaji:"nu"},{type:"hiragana",japanese:"",romaji:"ne"},{type:"hiragana",japanese:"",romaji:"no"},{type:"hiragana",japanese:"",romaji:"ha"},{type:"hiragana",japanese:"",romaji:"hi"},{type:"hiragana",japanese:"",romaji:"fu"},{type:"hiragana",japanese:"",romaji:"he"},{type:"hiragana",japanese:"",romaji:"ho"},{type:"hiragana",japanese:"",romaji:"ma"},{type:"hiragana",japanese:"",romaji:"mi"},{type:"hiragana",japanese:"",romaji:"mu"},{type:"hiragana",japanese:"",romaji:"me"},{type:"hiragana",japanese:"",romaji:"mo"},{type:"hiragana",japanese:"",romaji:"ya"},{type:"hiragana",japanese:"",romaji:"yu"},{type:"hiragana",japanese:"",romaji:"yo"},{type:"hiragana",japanese:"",romaji:"ra"},{type:"hiragana",japanese:"",romaji:"ri"},{type:"hiragana",japanese:"",romaji:"ru"},{type:"hiragana",japanese:"",romaji:"re"},{type:"hiragana",japanese:"",romaji:"ro"},{type:"hiragana",japanese:"",romaji:"wa"},{type:"hiragana",japanese:"",romaji:"wo"},{type:"hiragana",japanese:"",romaji:"n"},{type:"hiragana",japanese:"",romaji:"ga"},{type:"hiragana",japanese:"",romaji:"gi"},{type:"hiragana",japanese:"",romaji:"gu"},{type:"hiragana",japanese:"",romaji:"ge"},{type:"hiragana",japanese:"",romaji:"go"},{type:"hiragana",japanese:"",romaji:"za"},{type:"hiragana",japanese:"",romaji:"ji"},{type:"hiragana",japanese:"",romaji:"zu"},{type:"hiragana",japanese:"",romaji:"ze"},{type:"hiragana",japanese:"",romaji:"zo"},{type:"hiragana",japanese:"",romaji:"da"},{type:"hiragana",japanese:"",romaji:"ji"},{type:"hiragana",japanese:"",romaji:"zu"},{type:"hiragana",japanese:"",romaji:"de"},{type:"hiragana",japanese:"",romaji:"do"},{type:"hiragana",japanese:"",romaji:"ba"},{type:"hiragana",japanese:"",romaji:"bi"},{type:"hiragana",japanese:"",romaji:"bu"},{type:"hiragana",japanese:"",romaji:"be"},{type:"hiragana",japanese:"",romaji:"bo"},{type:"hiragana",japanese:"",romaji:"pa"},{type:"hiragana",japanese:"",romaji:"pi"},{type:"hiragana",japanese:"",romaji:"pu"},{type:"hiragana",japanese:"",romaji:"pe"},{type:"hiragana",japanese:"",romaji:"po"},{type:"hiragana",japanese:"",romaji:"kya"},{type:"hiragana",japanese:"",romaji:"kyu"},{type:"hiragana",japanese:"",romaji:"kyo"},{type:"hiragana",japanese:"",romaji:"sha"},{type:"hiragana",japanese:"",romaji:"shu"},{type:"hiragana",japanese:"",romaji:"sho"},{type:"hiragana",japanese:"",romaji:"cha"},{type:"hiragana",japanese:"",romaji:"chu"},{type:"hiragana",japanese:"",romaji:"cho"},{type:"hiragana",japanese:"",romaji:"nya"},{type:"hiragana",japanese:"",romaji:"nyu"},{type:"hiragana",japanese:"",romaji:"nyo"},{type:"hiragana",japanese:"",romaji:"hya"},{type:"hiragana",japanese:"",romaji:"hyu"},{type:"hiragana",japanese:"",romaji:"hyo"},{type:"hiragana",japanese:"",romaji:"mya"},{type:"hiragana",japanese:"",romaji:"myu"},{type:"hiragana",japanese:"",romaji:"myo"},{type:"hiragana",japanese:"",romaji:"rya"},{type:"hiragana",japanese:"",romaji:"ryu"},{type:"hiragana",japanese:"",romaji:"ryo"},{type:"hiragana",japanese:"",romaji:"gya"},{type:"hiragana",japanese:"",romaji:"gyu"},{type:"hiragana",japanese:"",romaji:"gyo"},{type:"hiragana",japanese:"",romaji:"ja"},{type:"hiragana",japanese:"",romaji:"ju"},{type:"hiragana",japanese:"",romaji:"jo"},{type:"hiragana",japanese:"",romaji:"ja"},{type:"hiragana",japanese:"",romaji:"ju"},{type:"hiragana",japanese:"",romaji:"jo"},{type:"hiragana",japanese:"",romaji:"bya"},{type:"hiragana",japanese:"",romaji:"byu"},{type:"hiragana",japanese:"",romaji:"byo"},{type:"hiragana",japanese:"",romaji:"pya"},{type:"hiragana",japanese:"",romaji:"pyu"},{type:"hiragana",japanese:"",romaji:"pyo"}],vme=[{type:"katakana",japanese:"",romaji:"a"},{type:"katakana",japanese:"",romaji:"i"},{type:"katakana",japanese:"",romaji:"u"},{type:"katakana",japanese:"",romaji:"e"},{type:"katakana",japanese:"",romaji:"o"},{type:"katakana",japanese:"",romaji:"ka"},{type:"katakana",japanese:"",romaji:"ki"},{type:"katakana",japanese:"",romaji:"ku"},{type:"katakana",japanese:"",romaji:"ke"},{type:"katakana",japanese:"",romaji:"ko"},{type:"katakana",japanese:"",romaji:"sa"},{type:"katakana",japanese:"",romaji:"shi"},{type:"katakana",japanese:"",romaji:"su"},{type:"katakana",japanese:"",romaji:"se"},{type:"katakana",japanese:"",romaji:"so"},{type:"katakana",japanese:"",romaji:"ta"},{type:"katakana",japanese:"",romaji:"chi"},{type:"katakana",japanese:"",romaji:"tsu"},{type:"katakana",japanese:"",romaji:"te"},{type:"katakana",japanese:"",romaji:"to"},{type:"katakana",japanese:"",romaji:"na"},{type:"katakana",japanese:"",romaji:"ni"},{type:"katakana",japanese:"",romaji:"nu"},{type:"katakana",japanese:"",romaji:"ne"},{type:"katakana",japanese:"",romaji:"no"},{type:"katakana",japanese:"",romaji:"ha"},{type:"katakana",japanese:"",romaji:"hi"},{type:"katakana",japanese:"",romaji:"fu"},{type:"katakana",japanese:"",romaji:"he"},{type:"katakana",japanese:"",romaji:"ho"},{type:"katakana",japanese:"",romaji:"ma"},{type:"katakana",japanese:"",romaji:"mi"},{type:"katakana",japanese:"",romaji:"mu"},{type:"katakana",japanese:"",romaji:"me"},{type:"katakana",japanese:"",romaji:"mo"},{type:"katakana",japanese:"",romaji:"ya"},{type:"katakana",japanese:"",romaji:"yu"},{type:"katakana",japanese:"",romaji:"yo"},{type:"katakana",japanese:"",romaji:"ra"},{type:"katakana",japanese:"",romaji:"ri"},{type:"katakana",japanese:"",romaji:"ru"},{type:"katakana",japanese:"",romaji:"re"},{type:"katakana",japanese:"",romaji:"ro"},{type:"katakana",japanese:"",romaji:"wa"},{type:"katakana",japanese:"",romaji:"wo"},{type:"katakana",japanese:"",romaji:"n"},{type:"katakana",japanese:"",romaji:"ga"},{type:"katakana",japanese:"",romaji:"gi"},{type:"katakana",japanese:"",romaji:"gu"},{type:"katakana",japanese:"",romaji:"ge"},{type:"katakana",japanese:"",romaji:"go"},{type:"katakana",japanese:"",romaji:"za"},{type:"katakana",japanese:"",romaji:"ji"},{type:"katakana",japanese:"",romaji:"zu"},{type:"katakana",japanese:"",romaji:"ze"},{type:"katakana",japanese:"",romaji:"zo"},{type:"katakana",japanese:"",romaji:"da"},{type:"katakana",japanese:"",romaji:"ji"},{type:"katakana",japanese:"",romaji:"zu"},{type:"katakana",japanese:"",romaji:"de"},{type:"katakana",japanese:"",romaji:"do"},{type:"katakana",japanese:"",romaji:"ba"},{type:"katakana",japanese:"",romaji:"bi"},{type:"katakana",japanese:"",romaji:"bu"},{type:"katakana",japanese:"",romaji:"be"},{type:"katakana",japanese:"",romaji:"bo"},{type:"katakana",japanese:"",romaji:"pa"},{type:"katakana",japanese:"",romaji:"pi"},{type:"katakana",japanese:"",romaji:"pu"},{type:"katakana",japanese:"",romaji:"pe"},{type:"katakana",japanese:"",romaji:"po"},{type:"katakana",japanese:"",romaji:"kya"},{type:"katakana",japanese:"",romaji:"kyu"},{type:"katakana",japanese:"",romaji:"kyo"},{type:"katakana",japanese:"",romaji:"sha"},{type:"katakana",japanese:"",romaji:"shu"},{type:"katakana",japanese:"",romaji:"sho"},{type:"katakana",japanese:"",romaji:"cha"},{type:"katakana",japanese:"",romaji:"chu"},{type:"katakana",japanese:"",romaji:"cho"},{type:"katakana",japanese:"",romaji:"nya"},{type:"katakana",japanese:"",romaji:"nyu"},{type:"katakana",japanese:"",romaji:"nyo"},{type:"katakana",japanese:"",romaji:"hya"},{type:"katakana",japanese:"",romaji:"hyu"},{type:"katakana",japanese:"",romaji:"hyo"},{type:"katakana",japanese:"",romaji:"mya"},{type:"katakana",japanese:"",romaji:"myu"},{type:"katakana",japanese:"",romaji:"myo"},{type:"katakana",japanese:"",romaji:"rya"},{type:"katakana",japanese:"",romaji:"ryu"},{type:"katakana",japanese:"",romaji:"ryo"},{type:"katakana",japanese:"",romaji:"gya"},{type:"katakana",japanese:"",romaji:"gyu"},{type:"katakana",japanese:"",romaji:"gyo"},{type:"katakana",japanese:"",romaji:"ja"},{type:"katakana",japanese:"",romaji:"ju"},{type:"katakana",japanese:"",romaji:"jo"},{type:"katakana",japanese:"",romaji:"ja"},{type:"katakana",japanese:"",romaji:"ju"},{type:"katakana",japanese:"",romaji:"jo"},{type:"katakana",japanese:"",romaji:"bya"},{type:"katakana",japanese:"",romaji:"byu"},{type:"katakana",japanese:"",romaji:"byo"},{type:"katakana",japanese:"",romaji:"pya"},{type:"katakana",japanese:"",romaji:"pyu"},{type:"katakana",japanese:"",romaji:"pyo"}],X3=t=>t.map(e=>{const a=[...t.filter(r=>r.romaji!==e.romaji).sort(()=>.5-Math.random()).slice(0,3).map(r=>r.romaji),e.romaji].sort(()=>.5-Math.random());return{question:`Huruf <span class="inline-block mx-2 text-4xl font-extrabold bg-gradient-to-r from-blue-500 to-purple-500 bg-clip-text text-transparent whitespace-nowrap">${e.japanese}</span> dibaca apa?`,options:a,correctAnswer:e.romaji}}),Sme=X3(xme),Nme=X3(vme),Cme=({score:t,totalQuestions:e,onBack:n})=>{const s=t/e*100;let a="",r="",i="";return s>=90?(a="Luar biasa! Kamu sangat menguasai materi ini!",r="",i="from-green-500 to-emerald-500"):s>=70?(a="Bagus! Kamu sudah memahami materi dengan baik.",r="",i="from-blue-500 to-cyan-500"):s>=50?(a="Cukup baik! Tetap semangat belajar!",r="",i="from-yellow-500 to-orange-500"):(a="Jangan menyerah! Coba lagi dan tingkatkan hasilmu!",r="",i="from-red-500 to-pink-500"),N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center p-4",children:N.jsxs("div",{className:"bg-white p-6 md:p-8 rounded-2xl shadow-xl max-w-md w-full text-center",children:[N.jsx("div",{className:"text-6xl mb-6 animate-bounce",children:r}),N.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-4 bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Hasil Kuis"}),N.jsxs("div",{className:"mb-8",children:[N.jsxs("div",{className:"text-4xl md:text-5xl font-bold mb-2",children:[t,"/",e]}),N.jsxs("div",{className:"text-lg text-gray-600",children:[s.toFixed(1),"%"]})]}),N.jsx("div",{className:`inline-block px-6 py-3 rounded-full bg-gradient-to-r ${i} text-white font-medium mb-8`,children:a}),N.jsxs("button",{onClick:n,className:"w-full py-3 px-4 bg-gray-100 text-gray-600 rounded-xl hover:bg-gray-200 transition-all transform hover:scale-[1.02] flex items-center justify-center space-x-2",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),N.jsx("span",{children:"Kembali ke Pemilihan Kuis"})]})]})})},Ime=({kuisType:t,onFinish:e,onBack:n})=>{const[s,a]=B.useState({currentQuestion:0,score:0,questions:[],showResults:!1}),[r,i]=B.useState(!0),[o,l]=B.useState(null),[u,c]=B.useState(!1);B.useEffect(()=>{let m=[];if(t==="kosakata"){const y=Object.values(mi);m=y.sort(()=>.5-Math.random()).slice(0,10).map(w=>({question:"Apa nama benda ini dalam bahasa Jepang?",options:[...y.filter(C=>C.japanese!==w.japanese).sort(()=>.5-Math.random()).slice(0,3).map(C=>C.japanese),w.japanese].sort(()=>.5-Math.random()),correctAnswer:w.japanese,image:w.imageUrl}))}else t==="hiragana"?m=[...Sme].sort(()=>.5-Math.random()).slice(0,10).map(y=>({...y,options:y.options.slice(0,4)})):m=[...Nme].sort(()=>.5-Math.random()).slice(0,10).map(y=>({...y,options:y.options.slice(0,4)}));a(y=>({...y,questions:m}))},[t]),B.useEffect(()=>{i(!0),l(null),c(!1)},[s.currentQuestion]);const d=m=>{if(u)return;const y=s.questions[s.currentQuestion],g=m===y.correctAnswer;l(m),c(!0),setTimeout(()=>{a(b=>({...b,score:b.score+(g?1:0),currentQuestion:b.currentQuestion+1,showResults:b.currentQuestion+1>=b.questions.length}))},1e3)},p=m=>{if(!o)return"w-full py-4 px-6 bg-white border-2 border-gray-200 text-gray-800 rounded-xl hover:border-blue-500 hover:bg-blue-50 transform transition-all hover:scale-[1.02] hover:shadow-md flex items-center justify-center font-medium";const y=s.questions[s.currentQuestion],g=m===y.correctAnswer;return m===o?g?"w-full py-4 px-6 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl transform transition-all flex items-center justify-center font-medium shadow-lg":"w-full py-4 px-6 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-xl transform transition-all flex items-center justify-center font-medium shadow-lg":g?"w-full py-4 px-6 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl transform transition-all flex items-center justify-center font-medium shadow-lg":"w-full py-4 px-6 bg-white border-2 border-gray-200 text-gray-800 rounded-xl opacity-50 cursor-not-allowed flex items-center justify-center font-medium"};if(s.showResults)return N.jsx(Cme,{score:s.score,totalQuestions:s.questions.length,onBack:n||(()=>{})});if(s.questions.length===0)return N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center p-4",children:N.jsx("div",{className:"text-xl text-gray-600 animate-pulse",children:"Memuat..."})});const h=s.questions[s.currentQuestion],f=(s.currentQuestion+1)/s.questions.length*100;return N.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center p-4",children:N.jsxs("div",{className:"bg-white/80 backdrop-blur-sm p-8 rounded-3xl shadow-2xl max-w-7xl w-full transform transition-all duration-300 hover:shadow-3xl",children:[N.jsx("div",{className:"w-full bg-gray-100 rounded-full h-3 mb-8 overflow-hidden",children:N.jsx("div",{className:"bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 h-3 rounded-full transition-all duration-500 ease-out",style:{width:`${f}%`}})}),N.jsxs("div",{className:"flex justify-between items-center mb-8",children:[N.jsxs("div",{className:"text-sm font-medium text-gray-600 bg-gray-100 px-4 py-2 rounded-full",children:["Soal ",s.currentQuestion+1," dari ",s.questions.length]}),N.jsxs("div",{className:"text-sm font-bold text-blue-600 bg-blue-50 px-4 py-2 rounded-full",children:["Skor: ",s.score]})]}),N.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[N.jsxs("div",{className:"flex-1",children:[h.image&&N.jsxs("div",{className:"mb-8 rounded-2xl overflow-hidden shadow-lg bg-gray-50 aspect-video relative",children:[r&&N.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-50",children:[N.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"}),N.jsx("span",{className:"mt-3 text-gray-500",children:"Memuat gambar..."})]}),N.jsx("img",{src:h.image,alt:"Pertanyaan",className:`w-full h-full object-cover transition-opacity duration-300 ${r?"opacity-0":"opacity-100"}`,onLoad:()=>i(!1),onError:()=>i(!1)})]}),N.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 p-8 rounded-2xl mb-8 lg:mb-0",children:N.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800 text-center",dangerouslySetInnerHTML:{__html:h.question}})})]}),N.jsxs("div",{className:"flex-1 flex flex-col",children:[N.jsx("div",{className:"space-y-4 flex-1",children:h.options.map((m,y)=>N.jsx("button",{onClick:()=>d(m),disabled:u,className:p(m),children:N.jsx("span",{className:"text-lg font-medium",children:m})},y))}),N.jsxs("button",{onClick:n,className:"mt-8 w-full py-4 px-6 bg-gradient-to-r from-gray-50 to-gray-100 text-gray-600 rounded-xl hover:from-gray-100 hover:to-gray-200 transition-all transform hover:scale-[1.02] flex items-center justify-center space-x-2 shadow-sm",children:[N.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:N.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),N.jsx("span",{children:"Kembali ke Pemilihan Kuis"})]})]})]})]})})},EI=()=>{const{type:t}=Y$(),e=Bx(),[n,s]=B.useState(null);B.useEffect(()=>{t&&["hiragana","katakana","kosakata"].includes(t)&&s(t)},[t]);const a=o=>{s(null),e("/kuis")},r=o=>{s(o),e(`/kuis/${o}`)},i=()=>{s(null),e("/kuis")};return n?N.jsx(Ime,{kuisType:n,onFinish:a,onBack:i}):N.jsx(kme,{onSelectKuis:r})},Tme=()=>N.jsx(BB,{children:N.jsxs(fB,{children:[N.jsx(Vr,{path:"/",element:N.jsx(VB,{})}),N.jsx(Vr,{path:"/tentang",element:N.jsx(WB,{})}),N.jsx(Vr,{path:"/deteksi-benda",element:N.jsx(mme,{})}),N.jsx(Vr,{path:"/artikel",element:N.jsx(gme,{})}),N.jsx(Vr,{path:"/benda/:id",element:N.jsx(wme,{})}),N.jsx(Vr,{path:"/kuis",element:N.jsx(EI,{})}),N.jsx(Vr,{path:"/kuis/:type",element:N.jsx(EI,{})})]})});W$(document.getElementById("root")).render(N.jsx(B.StrictMode,{children:N.jsx(xB,{children:N.jsx(Tme,{})})}));
//# sourceMappingURL=index-Bn4N715W.js.map
