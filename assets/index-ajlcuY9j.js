function kN(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const r=Object.getOwnPropertyDescriptor(s,a);r&&Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}})();var Zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function bb(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),n}var SN={exports:{}},em={},NN={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ld=Symbol.for("react.element"),rO=Symbol.for("react.portal"),iO=Symbol.for("react.fragment"),oO=Symbol.for("react.strict_mode"),lO=Symbol.for("react.profiler"),uO=Symbol.for("react.provider"),cO=Symbol.for("react.context"),dO=Symbol.for("react.forward_ref"),pO=Symbol.for("react.suspense"),hO=Symbol.for("react.memo"),fO=Symbol.for("react.lazy"),mv=Symbol.iterator;function mO(t){return t===null||typeof t!="object"?null:(t=mv&&t[mv]||t["@@iterator"],typeof t=="function"?t:null)}var CN={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},IN=Object.assign,$N={};function Tl(t,e,n){this.props=t,this.context=e,this.refs=$N,this.updater=n||CN}Tl.prototype.isReactComponent={};Tl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Tl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function TN(){}TN.prototype=Tl.prototype;function xb(t,e,n){this.props=t,this.context=e,this.refs=$N,this.updater=n||CN}var kb=xb.prototype=new TN;kb.constructor=xb;IN(kb,Tl.prototype);kb.isPureReactComponent=!0;var gv=Array.isArray,EN=Object.prototype.hasOwnProperty,vb={current:null},AN={key:!0,ref:!0,__self:!0,__source:!0};function RN(t,e,n){var s,a={},r=null,i=null;if(e!=null)for(s in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(r=""+e.key),e)EN.call(e,s)&&!AN.hasOwnProperty(s)&&(a[s]=e[s]);var o=arguments.length-2;if(o===1)a.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];a.children=l}if(t&&t.defaultProps)for(s in o=t.defaultProps,o)a[s]===void 0&&(a[s]=o[s]);return{$$typeof:ld,type:t,key:r,ref:i,props:a,_owner:vb.current}}function gO(t,e){return{$$typeof:ld,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Sb(t){return typeof t=="object"&&t!==null&&t.$$typeof===ld}function yO(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var yv=/\/+/g;function O0(t,e){return typeof t=="object"&&t!==null&&t.key!=null?yO(""+t.key):e.toString(36)}function _h(t,e,n,s,a){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(r){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case ld:case rO:i=!0}}if(i)return i=t,a=a(i),t=s===""?"."+O0(i,0):s,gv(a)?(n="",t!=null&&(n=t.replace(yv,"$&/")+"/"),_h(a,e,n,"",function(u){return u})):a!=null&&(Sb(a)&&(a=gO(a,n+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(yv,"$&/")+"/")+t)),e.push(a)),1;if(i=0,s=s===""?".":s+":",gv(t))for(var o=0;o<t.length;o++){r=t[o];var l=s+O0(r,o);i+=_h(r,e,n,l,a)}else if(l=mO(t),typeof l=="function")for(t=l.call(t),o=0;!(r=t.next()).done;)r=r.value,l=s+O0(r,o++),i+=_h(r,e,n,l,a);else if(r==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function th(t,e,n){if(t==null)return t;var s=[],a=0;return _h(t,s,"","",function(r){return e.call(n,r,a++)}),s}function wO(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Pn={current:null},Oh={transition:null},bO={ReactCurrentDispatcher:Pn,ReactCurrentBatchConfig:Oh,ReactCurrentOwner:vb};function DN(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:th,forEach:function(t,e,n){th(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return th(t,function(){e++}),e},toArray:function(t){return th(t,function(e){return e})||[]},only:function(t){if(!Sb(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Fe.Component=Tl;Fe.Fragment=iO;Fe.Profiler=lO;Fe.PureComponent=xb;Fe.StrictMode=oO;Fe.Suspense=pO;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bO;Fe.act=DN;Fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=IN({},t.props),a=t.key,r=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,i=vb.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)EN.call(e,l)&&!AN.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:ld,type:t.type,key:a,ref:r,props:s,_owner:i}};Fe.createContext=function(t){return t={$$typeof:cO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:uO,_context:t},t.Consumer=t};Fe.createElement=RN;Fe.createFactory=function(t){var e=RN.bind(null,t);return e.type=t,e};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(t){return{$$typeof:dO,render:t}};Fe.isValidElement=Sb;Fe.lazy=function(t){return{$$typeof:fO,_payload:{_status:-1,_result:t},_init:wO}};Fe.memo=function(t,e){return{$$typeof:hO,type:t,compare:e===void 0?null:e}};Fe.startTransition=function(t){var e=Oh.transition;Oh.transition={};try{t()}finally{Oh.transition=e}};Fe.unstable_act=DN;Fe.useCallback=function(t,e){return Pn.current.useCallback(t,e)};Fe.useContext=function(t){return Pn.current.useContext(t)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(t){return Pn.current.useDeferredValue(t)};Fe.useEffect=function(t,e){return Pn.current.useEffect(t,e)};Fe.useId=function(){return Pn.current.useId()};Fe.useImperativeHandle=function(t,e,n){return Pn.current.useImperativeHandle(t,e,n)};Fe.useInsertionEffect=function(t,e){return Pn.current.useInsertionEffect(t,e)};Fe.useLayoutEffect=function(t,e){return Pn.current.useLayoutEffect(t,e)};Fe.useMemo=function(t,e){return Pn.current.useMemo(t,e)};Fe.useReducer=function(t,e,n){return Pn.current.useReducer(t,e,n)};Fe.useRef=function(t){return Pn.current.useRef(t)};Fe.useState=function(t){return Pn.current.useState(t)};Fe.useSyncExternalStore=function(t,e,n){return Pn.current.useSyncExternalStore(t,e,n)};Fe.useTransition=function(){return Pn.current.useTransition()};Fe.version="18.3.1";NN.exports=Fe;var X=NN.exports;const xO=vN(X),kO=kN({__proto__:null,default:xO},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vO=X,SO=Symbol.for("react.element"),NO=Symbol.for("react.fragment"),CO=Object.prototype.hasOwnProperty,IO=vO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$O={key:!0,ref:!0,__self:!0,__source:!0};function _N(t,e,n){var s,a={},r=null,i=null;n!==void 0&&(r=""+n),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)CO.call(e,s)&&!$O.hasOwnProperty(s)&&(a[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)a[s]===void 0&&(a[s]=e[s]);return{$$typeof:SO,type:t,key:r,ref:i,props:a,_owner:IO.current}}em.Fragment=NO;em.jsx=_N;em.jsxs=_N;SN.exports=em;var T=SN.exports,ON={exports:{}},ms={},FN={exports:{}},jN={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,M){var K=O.length;O.push(M);e:for(;0<K;){var Y=K-1>>>1,Q=O[Y];if(0<a(Q,M))O[Y]=M,O[K]=Q,K=Y;else break e}}function n(O){return O.length===0?null:O[0]}function s(O){if(O.length===0)return null;var M=O[0],K=O.pop();if(K!==M){O[0]=K;e:for(var Y=0,Q=O.length,te=Q>>>1;Y<te;){var ae=2*(Y+1)-1,se=O[ae],le=ae+1,me=O[le];if(0>a(se,K))le<Q&&0>a(me,se)?(O[Y]=me,O[le]=K,Y=le):(O[Y]=se,O[ae]=K,Y=ae);else if(le<Q&&0>a(me,K))O[Y]=me,O[le]=K,Y=le;else break e}}return M}function a(O,M){var K=O.sortIndex-M.sortIndex;return K!==0?K:O.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],u=[],c=1,d=null,p=3,h=!1,f=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var M=n(u);M!==null;){if(M.callback===null)s(u);else if(M.startTime<=O)s(u),M.sortIndex=M.expirationTime,e(l,M);else break;M=n(u)}}function x(O){if(g=!1,b(O),!f)if(n(l)!==null)f=!0,G(v);else{var M=n(u);M!==null&&J(x,M.startTime-O)}}function v(O,M){f=!1,g&&(g=!1,m($),$=-1),h=!0;var K=p;try{for(b(M),d=n(l);d!==null&&(!(d.expirationTime>M)||O&&!L());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,p=d.priorityLevel;var Q=Y(d.expirationTime<=M);M=t.unstable_now(),typeof Q=="function"?d.callback=Q:d===n(l)&&s(l),b(M)}else s(l);d=n(l)}if(d!==null)var te=!0;else{var ae=n(u);ae!==null&&J(x,ae.startTime-M),te=!1}return te}finally{d=null,p=K,h=!1}}var S=!1,N=null,$=-1,E=5,A=-1;function L(){return!(t.unstable_now()-A<E)}function W(){if(N!==null){var O=t.unstable_now();A=O;var M=!0;try{M=N(!0,O)}finally{M?U():(S=!1,N=null)}}else S=!1}var U;if(typeof w=="function")U=function(){w(W)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,z=j.port2;j.port1.onmessage=W,U=function(){z.postMessage(null)}}else U=function(){y(W,0)};function G(O){N=O,S||(S=!0,U())}function J(O,M){$=y(function(){O(t.unstable_now())},M)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){f||h||(f=!0,G(v))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(p){case 1:case 2:case 3:var M=3;break;default:M=p}var K=p;p=M;try{return O()}finally{p=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,M){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var K=p;p=O;try{return M()}finally{p=K}},t.unstable_scheduleCallback=function(O,M,K){var Y=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?Y+K:Y):K=Y,O){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=K+Q,O={id:c++,callback:M,priorityLevel:O,startTime:K,expirationTime:Q,sortIndex:-1},K>Y?(O.sortIndex=K,e(u,O),n(l)===null&&O===n(u)&&(g?(m($),$=-1):g=!0,J(x,K-Y))):(O.sortIndex=Q,e(l,O),f||h||(f=!0,G(v))),O},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(O){var M=p;return function(){var K=p;p=M;try{return O.apply(this,arguments)}finally{p=K}}}})(jN);FN.exports=jN;var TO=FN.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EO=X,ps=TO;function ne(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var PN=new Set,Sc={};function uo(t,e){il(t,e),il(t+"Capture",e)}function il(t,e){for(Sc[t]=e,t=0;t<e.length;t++)PN.add(e[t])}var Ha=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Iy=Object.prototype.hasOwnProperty,AO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wv={},bv={};function RO(t){return Iy.call(bv,t)?!0:Iy.call(wv,t)?!1:AO.test(t)?bv[t]=!0:(wv[t]=!0,!1)}function DO(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function _O(t,e,n,s){if(e===null||typeof e>"u"||DO(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ln(t,e,n,s,a,r,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=r,this.removeEmptyString=i}var cn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){cn[t]=new Ln(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];cn[e]=new Ln(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){cn[t]=new Ln(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){cn[t]=new Ln(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){cn[t]=new Ln(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){cn[t]=new Ln(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){cn[t]=new Ln(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){cn[t]=new Ln(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){cn[t]=new Ln(t,5,!1,t.toLowerCase(),null,!1,!1)});var Nb=/[\-:]([a-z])/g;function Cb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Nb,Cb);cn[e]=new Ln(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Nb,Cb);cn[e]=new Ln(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Nb,Cb);cn[e]=new Ln(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){cn[t]=new Ln(t,1,!1,t.toLowerCase(),null,!1,!1)});cn.xlinkHref=new Ln("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){cn[t]=new Ln(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ib(t,e,n,s){var a=cn.hasOwnProperty(e)?cn[e]:null;(a!==null?a.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_O(e,n,a,s)&&(n=null),s||a===null?RO(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,s=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var tr=EO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nh=Symbol.for("react.element"),jo=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),$b=Symbol.for("react.strict_mode"),$y=Symbol.for("react.profiler"),LN=Symbol.for("react.provider"),zN=Symbol.for("react.context"),Tb=Symbol.for("react.forward_ref"),Ty=Symbol.for("react.suspense"),Ey=Symbol.for("react.suspense_list"),Eb=Symbol.for("react.memo"),gr=Symbol.for("react.lazy"),BN=Symbol.for("react.offscreen"),xv=Symbol.iterator;function Wu(t){return t===null||typeof t!="object"?null:(t=xv&&t[xv]||t["@@iterator"],typeof t=="function"?t:null)}var wt=Object.assign,F0;function tc(t){if(F0===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);F0=e&&e[1]||""}return`
`+F0+t}var j0=!1;function P0(t,e){if(!t||j0)return"";j0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),r=s.stack.split(`
`),i=a.length-1,o=r.length-1;1<=i&&0<=o&&a[i]!==r[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==r[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==r[o]){var l=`
`+a[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{j0=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?tc(t):""}function OO(t){switch(t.tag){case 5:return tc(t.type);case 16:return tc("Lazy");case 13:return tc("Suspense");case 19:return tc("SuspenseList");case 0:case 2:case 15:return t=P0(t.type,!1),t;case 11:return t=P0(t.type.render,!1),t;case 1:return t=P0(t.type,!0),t;default:return""}}function Ay(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Po:return"Fragment";case jo:return"Portal";case $y:return"Profiler";case $b:return"StrictMode";case Ty:return"Suspense";case Ey:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case zN:return(t.displayName||"Context")+".Consumer";case LN:return(t._context.displayName||"Context")+".Provider";case Tb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Eb:return e=t.displayName||null,e!==null?e:Ay(t.type)||"Memo";case gr:e=t._payload,t=t._init;try{return Ay(t(e))}catch{}}return null}function FO(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ay(e);case 8:return e===$b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function MN(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function jO(t){var e=MN(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,r=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(i){s=""+i,r.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function sh(t){t._valueTracker||(t._valueTracker=jO(t))}function VN(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=MN(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Jh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ry(t,e){var n=e.checked;return wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function kv(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=zr(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function WN(t,e){e=e.checked,e!=null&&Ib(t,"checked",e,!1)}function Dy(t,e){WN(t,e);var n=zr(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_y(t,e.type,n):e.hasOwnProperty("defaultValue")&&_y(t,e.type,zr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function vv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function _y(t,e,n){(e!=="number"||Jh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var nc=Array.isArray;function Jo(t,e,n,s){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&s&&(t[n].defaultSelected=!0)}else{for(n=""+zr(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,s&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function Oy(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ne(91));return wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Sv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ne(92));if(nc(n)){if(1<n.length)throw Error(ne(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:zr(n)}}function UN(t,e){var n=zr(e.value),s=zr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function Nv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function GN(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Fy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?GN(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ah,HN=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ah=ah||document.createElement("div"),ah.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ah.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Nc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var pc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},PO=["Webkit","ms","Moz","O"];Object.keys(pc).forEach(function(t){PO.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),pc[e]=pc[t]})});function KN(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||pc.hasOwnProperty(t)&&pc[t]?(""+e).trim():e+"px"}function qN(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,a=KN(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,a):t[n]=a}}var LO=wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jy(t,e){if(e){if(LO[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ne(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ne(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ne(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ne(62))}}function Py(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ly=null;function Ab(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zy=null,Xo=null,Yo=null;function Cv(t){if(t=dd(t)){if(typeof zy!="function")throw Error(ne(280));var e=t.stateNode;e&&(e=rm(e),zy(t.stateNode,t.type,e))}}function JN(t){Xo?Yo?Yo.push(t):Yo=[t]:Xo=t}function XN(){if(Xo){var t=Xo,e=Yo;if(Yo=Xo=null,Cv(t),e)for(t=0;t<e.length;t++)Cv(e[t])}}function YN(t,e){return t(e)}function QN(){}var L0=!1;function ZN(t,e,n){if(L0)return t(e,n);L0=!0;try{return YN(t,e,n)}finally{L0=!1,(Xo!==null||Yo!==null)&&(QN(),XN())}}function Cc(t,e){var n=t.stateNode;if(n===null)return null;var s=rm(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ne(231,e,typeof n));return n}var By=!1;if(Ha)try{var Uu={};Object.defineProperty(Uu,"passive",{get:function(){By=!0}}),window.addEventListener("test",Uu,Uu),window.removeEventListener("test",Uu,Uu)}catch{By=!1}function zO(t,e,n,s,a,r,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var hc=!1,Xh=null,Yh=!1,My=null,BO={onError:function(t){hc=!0,Xh=t}};function MO(t,e,n,s,a,r,i,o,l){hc=!1,Xh=null,zO.apply(BO,arguments)}function VO(t,e,n,s,a,r,i,o,l){if(MO.apply(this,arguments),hc){if(hc){var u=Xh;hc=!1,Xh=null}else throw Error(ne(198));Yh||(Yh=!0,My=u)}}function co(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function eC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Iv(t){if(co(t)!==t)throw Error(ne(188))}function WO(t){var e=t.alternate;if(!e){if(e=co(t),e===null)throw Error(ne(188));return e!==t?null:t}for(var n=t,s=e;;){var a=n.return;if(a===null)break;var r=a.alternate;if(r===null){if(s=a.return,s!==null){n=s;continue}break}if(a.child===r.child){for(r=a.child;r;){if(r===n)return Iv(a),t;if(r===s)return Iv(a),e;r=r.sibling}throw Error(ne(188))}if(n.return!==s.return)n=a,s=r;else{for(var i=!1,o=a.child;o;){if(o===n){i=!0,n=a,s=r;break}if(o===s){i=!0,s=a,n=r;break}o=o.sibling}if(!i){for(o=r.child;o;){if(o===n){i=!0,n=r,s=a;break}if(o===s){i=!0,s=r,n=a;break}o=o.sibling}if(!i)throw Error(ne(189))}}if(n.alternate!==s)throw Error(ne(190))}if(n.tag!==3)throw Error(ne(188));return n.stateNode.current===n?t:e}function tC(t){return t=WO(t),t!==null?nC(t):null}function nC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=nC(t);if(e!==null)return e;t=t.sibling}return null}var sC=ps.unstable_scheduleCallback,$v=ps.unstable_cancelCallback,UO=ps.unstable_shouldYield,GO=ps.unstable_requestPaint,It=ps.unstable_now,HO=ps.unstable_getCurrentPriorityLevel,Rb=ps.unstable_ImmediatePriority,aC=ps.unstable_UserBlockingPriority,Qh=ps.unstable_NormalPriority,KO=ps.unstable_LowPriority,rC=ps.unstable_IdlePriority,tm=null,wa=null;function qO(t){if(wa&&typeof wa.onCommitFiberRoot=="function")try{wa.onCommitFiberRoot(tm,t,void 0,(t.current.flags&128)===128)}catch{}}var Js=Math.clz32?Math.clz32:YO,JO=Math.log,XO=Math.LN2;function YO(t){return t>>>=0,t===0?32:31-(JO(t)/XO|0)|0}var rh=64,ih=4194304;function sc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Zh(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,a=t.suspendedLanes,r=t.pingedLanes,i=n&268435455;if(i!==0){var o=i&~a;o!==0?s=sc(o):(r&=i,r!==0&&(s=sc(r)))}else i=n&~a,i!==0?s=sc(i):r!==0&&(s=sc(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&a)&&(a=s&-s,r=e&-e,a>=r||a===16&&(r&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Js(e),a=1<<n,s|=t[n],e&=~a;return s}function QO(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ZO(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,a=t.expirationTimes,r=t.pendingLanes;0<r;){var i=31-Js(r),o=1<<i,l=a[i];l===-1?(!(o&n)||o&s)&&(a[i]=QO(o,e)):l<=e&&(t.expiredLanes|=o),r&=~o}}function Vy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function iC(){var t=rh;return rh<<=1,!(rh&4194240)&&(rh=64),t}function z0(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ud(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Js(e),t[e]=n}function e3(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-Js(n),r=1<<a;e[a]=0,s[a]=-1,t[a]=-1,n&=~r}}function Db(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Js(n),a=1<<s;a&e|t[s]&e&&(t[s]|=e),n&=~a}}var Ge=0;function oC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var lC,_b,uC,cC,dC,Wy=!1,oh=[],$r=null,Tr=null,Er=null,Ic=new Map,$c=new Map,br=[],t3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tv(t,e){switch(t){case"focusin":case"focusout":$r=null;break;case"dragenter":case"dragleave":Tr=null;break;case"mouseover":case"mouseout":Er=null;break;case"pointerover":case"pointerout":Ic.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$c.delete(e.pointerId)}}function Gu(t,e,n,s,a,r){return t===null||t.nativeEvent!==r?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:r,targetContainers:[a]},e!==null&&(e=dd(e),e!==null&&_b(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function n3(t,e,n,s,a){switch(e){case"focusin":return $r=Gu($r,t,e,n,s,a),!0;case"dragenter":return Tr=Gu(Tr,t,e,n,s,a),!0;case"mouseover":return Er=Gu(Er,t,e,n,s,a),!0;case"pointerover":var r=a.pointerId;return Ic.set(r,Gu(Ic.get(r)||null,t,e,n,s,a)),!0;case"gotpointercapture":return r=a.pointerId,$c.set(r,Gu($c.get(r)||null,t,e,n,s,a)),!0}return!1}function pC(t){var e=Ei(t.target);if(e!==null){var n=co(e);if(n!==null){if(e=n.tag,e===13){if(e=eC(n),e!==null){t.blockedOn=e,dC(t.priority,function(){uC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Fh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Uy(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Ly=s,n.target.dispatchEvent(s),Ly=null}else return e=dd(n),e!==null&&_b(e),t.blockedOn=n,!1;e.shift()}return!0}function Ev(t,e,n){Fh(t)&&n.delete(e)}function s3(){Wy=!1,$r!==null&&Fh($r)&&($r=null),Tr!==null&&Fh(Tr)&&(Tr=null),Er!==null&&Fh(Er)&&(Er=null),Ic.forEach(Ev),$c.forEach(Ev)}function Hu(t,e){t.blockedOn===e&&(t.blockedOn=null,Wy||(Wy=!0,ps.unstable_scheduleCallback(ps.unstable_NormalPriority,s3)))}function Tc(t){function e(a){return Hu(a,t)}if(0<oh.length){Hu(oh[0],t);for(var n=1;n<oh.length;n++){var s=oh[n];s.blockedOn===t&&(s.blockedOn=null)}}for($r!==null&&Hu($r,t),Tr!==null&&Hu(Tr,t),Er!==null&&Hu(Er,t),Ic.forEach(e),$c.forEach(e),n=0;n<br.length;n++)s=br[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<br.length&&(n=br[0],n.blockedOn===null);)pC(n),n.blockedOn===null&&br.shift()}var Qo=tr.ReactCurrentBatchConfig,ef=!0;function a3(t,e,n,s){var a=Ge,r=Qo.transition;Qo.transition=null;try{Ge=1,Ob(t,e,n,s)}finally{Ge=a,Qo.transition=r}}function r3(t,e,n,s){var a=Ge,r=Qo.transition;Qo.transition=null;try{Ge=4,Ob(t,e,n,s)}finally{Ge=a,Qo.transition=r}}function Ob(t,e,n,s){if(ef){var a=Uy(t,e,n,s);if(a===null)J0(t,e,s,tf,n),Tv(t,s);else if(n3(a,t,e,n,s))s.stopPropagation();else if(Tv(t,s),e&4&&-1<t3.indexOf(t)){for(;a!==null;){var r=dd(a);if(r!==null&&lC(r),r=Uy(t,e,n,s),r===null&&J0(t,e,s,tf,n),r===a)break;a=r}a!==null&&s.stopPropagation()}else J0(t,e,s,null,n)}}var tf=null;function Uy(t,e,n,s){if(tf=null,t=Ab(s),t=Ei(t),t!==null)if(e=co(t),e===null)t=null;else if(n=e.tag,n===13){if(t=eC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return tf=t,null}function hC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(HO()){case Rb:return 1;case aC:return 4;case Qh:case KO:return 16;case rC:return 536870912;default:return 16}default:return 16}}var kr=null,Fb=null,jh=null;function fC(){if(jh)return jh;var t,e=Fb,n=e.length,s,a="value"in kr?kr.value:kr.textContent,r=a.length;for(t=0;t<n&&e[t]===a[t];t++);var i=n-t;for(s=1;s<=i&&e[n-s]===a[r-s];s++);return jh=a.slice(t,1<s?1-s:void 0)}function Ph(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function lh(){return!0}function Av(){return!1}function gs(t){function e(n,s,a,r,i){this._reactName=n,this._targetInst=a,this.type=s,this.nativeEvent=r,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?lh:Av,this.isPropagationStopped=Av,this}return wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=lh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=lh)},persist:function(){},isPersistent:lh}),e}var El={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jb=gs(El),cd=wt({},El,{view:0,detail:0}),i3=gs(cd),B0,M0,Ku,nm=wt({},cd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ku&&(Ku&&t.type==="mousemove"?(B0=t.screenX-Ku.screenX,M0=t.screenY-Ku.screenY):M0=B0=0,Ku=t),B0)},movementY:function(t){return"movementY"in t?t.movementY:M0}}),Rv=gs(nm),o3=wt({},nm,{dataTransfer:0}),l3=gs(o3),u3=wt({},cd,{relatedTarget:0}),V0=gs(u3),c3=wt({},El,{animationName:0,elapsedTime:0,pseudoElement:0}),d3=gs(c3),p3=wt({},El,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),h3=gs(p3),f3=wt({},El,{data:0}),Dv=gs(f3),m3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},g3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},y3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function w3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=y3[t])?!!e[t]:!1}function Pb(){return w3}var b3=wt({},cd,{key:function(t){if(t.key){var e=m3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ph(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?g3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pb,charCode:function(t){return t.type==="keypress"?Ph(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ph(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),x3=gs(b3),k3=wt({},nm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_v=gs(k3),v3=wt({},cd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pb}),S3=gs(v3),N3=wt({},El,{propertyName:0,elapsedTime:0,pseudoElement:0}),C3=gs(N3),I3=wt({},nm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),$3=gs(I3),T3=[9,13,27,32],Lb=Ha&&"CompositionEvent"in window,fc=null;Ha&&"documentMode"in document&&(fc=document.documentMode);var E3=Ha&&"TextEvent"in window&&!fc,mC=Ha&&(!Lb||fc&&8<fc&&11>=fc),Ov=" ",Fv=!1;function gC(t,e){switch(t){case"keyup":return T3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Lo=!1;function A3(t,e){switch(t){case"compositionend":return yC(e);case"keypress":return e.which!==32?null:(Fv=!0,Ov);case"textInput":return t=e.data,t===Ov&&Fv?null:t;default:return null}}function R3(t,e){if(Lo)return t==="compositionend"||!Lb&&gC(t,e)?(t=fC(),jh=Fb=kr=null,Lo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mC&&e.locale!=="ko"?null:e.data;default:return null}}var D3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!D3[t.type]:e==="textarea"}function wC(t,e,n,s){JN(s),e=nf(e,"onChange"),0<e.length&&(n=new jb("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var mc=null,Ec=null;function _3(t){EC(t,0)}function sm(t){var e=Mo(t);if(VN(e))return t}function O3(t,e){if(t==="change")return e}var bC=!1;if(Ha){var W0;if(Ha){var U0="oninput"in document;if(!U0){var Pv=document.createElement("div");Pv.setAttribute("oninput","return;"),U0=typeof Pv.oninput=="function"}W0=U0}else W0=!1;bC=W0&&(!document.documentMode||9<document.documentMode)}function Lv(){mc&&(mc.detachEvent("onpropertychange",xC),Ec=mc=null)}function xC(t){if(t.propertyName==="value"&&sm(Ec)){var e=[];wC(e,Ec,t,Ab(t)),ZN(_3,e)}}function F3(t,e,n){t==="focusin"?(Lv(),mc=e,Ec=n,mc.attachEvent("onpropertychange",xC)):t==="focusout"&&Lv()}function j3(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return sm(Ec)}function P3(t,e){if(t==="click")return sm(e)}function L3(t,e){if(t==="input"||t==="change")return sm(e)}function z3(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ta=typeof Object.is=="function"?Object.is:z3;function Ac(t,e){if(ta(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!Iy.call(e,a)||!ta(t[a],e[a]))return!1}return!0}function zv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Bv(t,e){var n=zv(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=zv(n)}}function kC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?kC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function vC(){for(var t=window,e=Jh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Jh(t.document)}return e}function zb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function B3(t){var e=vC(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&kC(n.ownerDocument.documentElement,n)){if(s!==null&&zb(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,r=Math.min(s.start,a);s=s.end===void 0?r:Math.min(s.end,a),!t.extend&&r>s&&(a=s,s=r,r=a),a=Bv(n,r);var i=Bv(n,s);a&&i&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),r>s?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var M3=Ha&&"documentMode"in document&&11>=document.documentMode,zo=null,Gy=null,gc=null,Hy=!1;function Mv(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Hy||zo==null||zo!==Jh(s)||(s=zo,"selectionStart"in s&&zb(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),gc&&Ac(gc,s)||(gc=s,s=nf(Gy,"onSelect"),0<s.length&&(e=new jb("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=zo)))}function uh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Bo={animationend:uh("Animation","AnimationEnd"),animationiteration:uh("Animation","AnimationIteration"),animationstart:uh("Animation","AnimationStart"),transitionend:uh("Transition","TransitionEnd")},G0={},SC={};Ha&&(SC=document.createElement("div").style,"AnimationEvent"in window||(delete Bo.animationend.animation,delete Bo.animationiteration.animation,delete Bo.animationstart.animation),"TransitionEvent"in window||delete Bo.transitionend.transition);function am(t){if(G0[t])return G0[t];if(!Bo[t])return t;var e=Bo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in SC)return G0[t]=e[n];return t}var NC=am("animationend"),CC=am("animationiteration"),IC=am("animationstart"),$C=am("transitionend"),TC=new Map,Vv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ei(t,e){TC.set(t,e),uo(e,[t])}for(var H0=0;H0<Vv.length;H0++){var K0=Vv[H0],V3=K0.toLowerCase(),W3=K0[0].toUpperCase()+K0.slice(1);ei(V3,"on"+W3)}ei(NC,"onAnimationEnd");ei(CC,"onAnimationIteration");ei(IC,"onAnimationStart");ei("dblclick","onDoubleClick");ei("focusin","onFocus");ei("focusout","onBlur");ei($C,"onTransitionEnd");il("onMouseEnter",["mouseout","mouseover"]);il("onMouseLeave",["mouseout","mouseover"]);il("onPointerEnter",["pointerout","pointerover"]);il("onPointerLeave",["pointerout","pointerover"]);uo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));uo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));uo("onBeforeInput",["compositionend","keypress","textInput","paste"]);uo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));uo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ac="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),U3=new Set("cancel close invalid load scroll toggle".split(" ").concat(ac));function Wv(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,VO(s,e,void 0,t),t.currentTarget=null}function EC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],a=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var i=s.length-1;0<=i;i--){var o=s[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==r&&a.isPropagationStopped())break e;Wv(a,o,u),r=l}else for(i=0;i<s.length;i++){if(o=s[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==r&&a.isPropagationStopped())break e;Wv(a,o,u),r=l}}}if(Yh)throw t=My,Yh=!1,My=null,t}function st(t,e){var n=e[Yy];n===void 0&&(n=e[Yy]=new Set);var s=t+"__bubble";n.has(s)||(AC(e,t,2,!1),n.add(s))}function q0(t,e,n){var s=0;e&&(s|=4),AC(n,t,s,e)}var ch="_reactListening"+Math.random().toString(36).slice(2);function Rc(t){if(!t[ch]){t[ch]=!0,PN.forEach(function(n){n!=="selectionchange"&&(U3.has(n)||q0(n,!1,t),q0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ch]||(e[ch]=!0,q0("selectionchange",!1,e))}}function AC(t,e,n,s){switch(hC(e)){case 1:var a=a3;break;case 4:a=r3;break;default:a=Ob}n=a.bind(null,e,n,t),a=void 0,!By||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),s?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function J0(t,e,n,s,a){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var o=s.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=s.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=Ei(o),i===null)return;if(l=i.tag,l===5||l===6){s=r=i;continue e}o=o.parentNode}}s=s.return}ZN(function(){var u=r,c=Ab(n),d=[];e:{var p=TC.get(t);if(p!==void 0){var h=jb,f=t;switch(t){case"keypress":if(Ph(n)===0)break e;case"keydown":case"keyup":h=x3;break;case"focusin":f="focus",h=V0;break;case"focusout":f="blur",h=V0;break;case"beforeblur":case"afterblur":h=V0;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Rv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=l3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=S3;break;case NC:case CC:case IC:h=d3;break;case $C:h=C3;break;case"scroll":h=i3;break;case"wheel":h=$3;break;case"copy":case"cut":case"paste":h=h3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=_v}var g=(e&4)!==0,y=!g&&t==="scroll",m=g?p!==null?p+"Capture":null:p;g=[];for(var w=u,b;w!==null;){b=w;var x=b.stateNode;if(b.tag===5&&x!==null&&(b=x,m!==null&&(x=Cc(w,m),x!=null&&g.push(Dc(w,x,b)))),y)break;w=w.return}0<g.length&&(p=new h(p,f,null,n,c),d.push({event:p,listeners:g}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",p&&n!==Ly&&(f=n.relatedTarget||n.fromElement)&&(Ei(f)||f[Ka]))break e;if((h||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,h?(f=n.relatedTarget||n.toElement,h=u,f=f?Ei(f):null,f!==null&&(y=co(f),f!==y||f.tag!==5&&f.tag!==6)&&(f=null)):(h=null,f=u),h!==f)){if(g=Rv,x="onMouseLeave",m="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(g=_v,x="onPointerLeave",m="onPointerEnter",w="pointer"),y=h==null?p:Mo(h),b=f==null?p:Mo(f),p=new g(x,w+"leave",h,n,c),p.target=y,p.relatedTarget=b,x=null,Ei(c)===u&&(g=new g(m,w+"enter",f,n,c),g.target=b,g.relatedTarget=y,x=g),y=x,h&&f)t:{for(g=h,m=f,w=0,b=g;b;b=Ao(b))w++;for(b=0,x=m;x;x=Ao(x))b++;for(;0<w-b;)g=Ao(g),w--;for(;0<b-w;)m=Ao(m),b--;for(;w--;){if(g===m||m!==null&&g===m.alternate)break t;g=Ao(g),m=Ao(m)}g=null}else g=null;h!==null&&Uv(d,p,h,g,!1),f!==null&&y!==null&&Uv(d,y,f,g,!0)}}e:{if(p=u?Mo(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var v=O3;else if(jv(p))if(bC)v=L3;else{v=j3;var S=F3}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(v=P3);if(v&&(v=v(t,u))){wC(d,v,n,c);break e}S&&S(t,p,u),t==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&_y(p,"number",p.value)}switch(S=u?Mo(u):window,t){case"focusin":(jv(S)||S.contentEditable==="true")&&(zo=S,Gy=u,gc=null);break;case"focusout":gc=Gy=zo=null;break;case"mousedown":Hy=!0;break;case"contextmenu":case"mouseup":case"dragend":Hy=!1,Mv(d,n,c);break;case"selectionchange":if(M3)break;case"keydown":case"keyup":Mv(d,n,c)}var N;if(Lb)e:{switch(t){case"compositionstart":var $="onCompositionStart";break e;case"compositionend":$="onCompositionEnd";break e;case"compositionupdate":$="onCompositionUpdate";break e}$=void 0}else Lo?gC(t,n)&&($="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&($="onCompositionStart");$&&(mC&&n.locale!=="ko"&&(Lo||$!=="onCompositionStart"?$==="onCompositionEnd"&&Lo&&(N=fC()):(kr=c,Fb="value"in kr?kr.value:kr.textContent,Lo=!0)),S=nf(u,$),0<S.length&&($=new Dv($,t,null,n,c),d.push({event:$,listeners:S}),N?$.data=N:(N=yC(n),N!==null&&($.data=N)))),(N=E3?A3(t,n):R3(t,n))&&(u=nf(u,"onBeforeInput"),0<u.length&&(c=new Dv("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=N))}EC(d,e)})}function Dc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function nf(t,e){for(var n=e+"Capture",s=[];t!==null;){var a=t,r=a.stateNode;a.tag===5&&r!==null&&(a=r,r=Cc(t,n),r!=null&&s.unshift(Dc(t,r,a)),r=Cc(t,e),r!=null&&s.push(Dc(t,r,a))),t=t.return}return s}function Ao(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Uv(t,e,n,s,a){for(var r=e._reactName,i=[];n!==null&&n!==s;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===s)break;o.tag===5&&u!==null&&(o=u,a?(l=Cc(n,r),l!=null&&i.unshift(Dc(n,l,o))):a||(l=Cc(n,r),l!=null&&i.push(Dc(n,l,o)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var G3=/\r\n?/g,H3=/\u0000|\uFFFD/g;function Gv(t){return(typeof t=="string"?t:""+t).replace(G3,`
`).replace(H3,"")}function dh(t,e,n){if(e=Gv(e),Gv(t)!==e&&n)throw Error(ne(425))}function sf(){}var Ky=null,qy=null;function Jy(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Xy=typeof setTimeout=="function"?setTimeout:void 0,K3=typeof clearTimeout=="function"?clearTimeout:void 0,Hv=typeof Promise=="function"?Promise:void 0,q3=typeof queueMicrotask=="function"?queueMicrotask:typeof Hv<"u"?function(t){return Hv.resolve(null).then(t).catch(J3)}:Xy;function J3(t){setTimeout(function(){throw t})}function X0(t,e){var n=e,s=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(s===0){t.removeChild(a),Tc(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=a}while(n);Tc(e)}function Ar(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Kv(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Al=Math.random().toString(36).slice(2),ma="__reactFiber$"+Al,_c="__reactProps$"+Al,Ka="__reactContainer$"+Al,Yy="__reactEvents$"+Al,X3="__reactListeners$"+Al,Y3="__reactHandles$"+Al;function Ei(t){var e=t[ma];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ka]||n[ma]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Kv(t);t!==null;){if(n=t[ma])return n;t=Kv(t)}return e}t=n,n=t.parentNode}return null}function dd(t){return t=t[ma]||t[Ka],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Mo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ne(33))}function rm(t){return t[_c]||null}var Qy=[],Vo=-1;function ti(t){return{current:t}}function at(t){0>Vo||(t.current=Qy[Vo],Qy[Vo]=null,Vo--)}function Ze(t,e){Vo++,Qy[Vo]=t.current,t.current=e}var Br={},kn=ti(Br),Kn=ti(!1),Vi=Br;function ol(t,e){var n=t.type.contextTypes;if(!n)return Br;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var a={},r;for(r in n)a[r]=e[r];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function qn(t){return t=t.childContextTypes,t!=null}function af(){at(Kn),at(kn)}function qv(t,e,n){if(kn.current!==Br)throw Error(ne(168));Ze(kn,e),Ze(Kn,n)}function RC(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var a in s)if(!(a in e))throw Error(ne(108,FO(t)||"Unknown",a));return wt({},n,s)}function rf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Br,Vi=kn.current,Ze(kn,t),Ze(Kn,Kn.current),!0}function Jv(t,e,n){var s=t.stateNode;if(!s)throw Error(ne(169));n?(t=RC(t,e,Vi),s.__reactInternalMemoizedMergedChildContext=t,at(Kn),at(kn),Ze(kn,t)):at(Kn),Ze(Kn,n)}var ja=null,im=!1,Y0=!1;function DC(t){ja===null?ja=[t]:ja.push(t)}function Q3(t){im=!0,DC(t)}function ni(){if(!Y0&&ja!==null){Y0=!0;var t=0,e=Ge;try{var n=ja;for(Ge=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}ja=null,im=!1}catch(a){throw ja!==null&&(ja=ja.slice(t+1)),sC(Rb,ni),a}finally{Ge=e,Y0=!1}}return null}var Wo=[],Uo=0,of=null,lf=0,vs=[],Ss=0,Wi=null,Va=1,Wa="";function xi(t,e){Wo[Uo++]=lf,Wo[Uo++]=of,of=t,lf=e}function _C(t,e,n){vs[Ss++]=Va,vs[Ss++]=Wa,vs[Ss++]=Wi,Wi=t;var s=Va;t=Wa;var a=32-Js(s)-1;s&=~(1<<a),n+=1;var r=32-Js(e)+a;if(30<r){var i=a-a%5;r=(s&(1<<i)-1).toString(32),s>>=i,a-=i,Va=1<<32-Js(e)+a|n<<a|s,Wa=r+t}else Va=1<<r|n<<a|s,Wa=t}function Bb(t){t.return!==null&&(xi(t,1),_C(t,1,0))}function Mb(t){for(;t===of;)of=Wo[--Uo],Wo[Uo]=null,lf=Wo[--Uo],Wo[Uo]=null;for(;t===Wi;)Wi=vs[--Ss],vs[Ss]=null,Wa=vs[--Ss],vs[Ss]=null,Va=vs[--Ss],vs[Ss]=null}var us=null,is=null,ut=!1,Gs=null;function OC(t,e){var n=Ns(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Xv(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,us=t,is=Ar(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,us=t,is=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Wi!==null?{id:Va,overflow:Wa}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ns(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,us=t,is=null,!0):!1;default:return!1}}function Zy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ew(t){if(ut){var e=is;if(e){var n=e;if(!Xv(t,e)){if(Zy(t))throw Error(ne(418));e=Ar(n.nextSibling);var s=us;e&&Xv(t,e)?OC(s,n):(t.flags=t.flags&-4097|2,ut=!1,us=t)}}else{if(Zy(t))throw Error(ne(418));t.flags=t.flags&-4097|2,ut=!1,us=t}}}function Yv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;us=t}function ph(t){if(t!==us)return!1;if(!ut)return Yv(t),ut=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Jy(t.type,t.memoizedProps)),e&&(e=is)){if(Zy(t))throw FC(),Error(ne(418));for(;e;)OC(t,e),e=Ar(e.nextSibling)}if(Yv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ne(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){is=Ar(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}is=null}}else is=us?Ar(t.stateNode.nextSibling):null;return!0}function FC(){for(var t=is;t;)t=Ar(t.nextSibling)}function ll(){is=us=null,ut=!1}function Vb(t){Gs===null?Gs=[t]:Gs.push(t)}var Z3=tr.ReactCurrentBatchConfig;function qu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ne(309));var s=n.stateNode}if(!s)throw Error(ne(147,t));var a=s,r=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(i){var o=a.refs;i===null?delete o[r]:o[r]=i},e._stringRef=r,e)}if(typeof t!="string")throw Error(ne(284));if(!n._owner)throw Error(ne(290,t))}return t}function hh(t,e){throw t=Object.prototype.toString.call(e),Error(ne(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Qv(t){var e=t._init;return e(t._payload)}function jC(t){function e(m,w){if(t){var b=m.deletions;b===null?(m.deletions=[w],m.flags|=16):b.push(w)}}function n(m,w){if(!t)return null;for(;w!==null;)e(m,w),w=w.sibling;return null}function s(m,w){for(m=new Map;w!==null;)w.key!==null?m.set(w.key,w):m.set(w.index,w),w=w.sibling;return m}function a(m,w){return m=Or(m,w),m.index=0,m.sibling=null,m}function r(m,w,b){return m.index=b,t?(b=m.alternate,b!==null?(b=b.index,b<w?(m.flags|=2,w):b):(m.flags|=2,w)):(m.flags|=1048576,w)}function i(m){return t&&m.alternate===null&&(m.flags|=2),m}function o(m,w,b,x){return w===null||w.tag!==6?(w=ay(b,m.mode,x),w.return=m,w):(w=a(w,b),w.return=m,w)}function l(m,w,b,x){var v=b.type;return v===Po?c(m,w,b.props.children,x,b.key):w!==null&&(w.elementType===v||typeof v=="object"&&v!==null&&v.$$typeof===gr&&Qv(v)===w.type)?(x=a(w,b.props),x.ref=qu(m,w,b),x.return=m,x):(x=Uh(b.type,b.key,b.props,null,m.mode,x),x.ref=qu(m,w,b),x.return=m,x)}function u(m,w,b,x){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=ry(b,m.mode,x),w.return=m,w):(w=a(w,b.children||[]),w.return=m,w)}function c(m,w,b,x,v){return w===null||w.tag!==7?(w=ji(b,m.mode,x,v),w.return=m,w):(w=a(w,b),w.return=m,w)}function d(m,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=ay(""+w,m.mode,b),w.return=m,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case nh:return b=Uh(w.type,w.key,w.props,null,m.mode,b),b.ref=qu(m,null,w),b.return=m,b;case jo:return w=ry(w,m.mode,b),w.return=m,w;case gr:var x=w._init;return d(m,x(w._payload),b)}if(nc(w)||Wu(w))return w=ji(w,m.mode,b,null),w.return=m,w;hh(m,w)}return null}function p(m,w,b,x){var v=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return v!==null?null:o(m,w,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case nh:return b.key===v?l(m,w,b,x):null;case jo:return b.key===v?u(m,w,b,x):null;case gr:return v=b._init,p(m,w,v(b._payload),x)}if(nc(b)||Wu(b))return v!==null?null:c(m,w,b,x,null);hh(m,b)}return null}function h(m,w,b,x,v){if(typeof x=="string"&&x!==""||typeof x=="number")return m=m.get(b)||null,o(w,m,""+x,v);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case nh:return m=m.get(x.key===null?b:x.key)||null,l(w,m,x,v);case jo:return m=m.get(x.key===null?b:x.key)||null,u(w,m,x,v);case gr:var S=x._init;return h(m,w,b,S(x._payload),v)}if(nc(x)||Wu(x))return m=m.get(b)||null,c(w,m,x,v,null);hh(w,x)}return null}function f(m,w,b,x){for(var v=null,S=null,N=w,$=w=0,E=null;N!==null&&$<b.length;$++){N.index>$?(E=N,N=null):E=N.sibling;var A=p(m,N,b[$],x);if(A===null){N===null&&(N=E);break}t&&N&&A.alternate===null&&e(m,N),w=r(A,w,$),S===null?v=A:S.sibling=A,S=A,N=E}if($===b.length)return n(m,N),ut&&xi(m,$),v;if(N===null){for(;$<b.length;$++)N=d(m,b[$],x),N!==null&&(w=r(N,w,$),S===null?v=N:S.sibling=N,S=N);return ut&&xi(m,$),v}for(N=s(m,N);$<b.length;$++)E=h(N,m,$,b[$],x),E!==null&&(t&&E.alternate!==null&&N.delete(E.key===null?$:E.key),w=r(E,w,$),S===null?v=E:S.sibling=E,S=E);return t&&N.forEach(function(L){return e(m,L)}),ut&&xi(m,$),v}function g(m,w,b,x){var v=Wu(b);if(typeof v!="function")throw Error(ne(150));if(b=v.call(b),b==null)throw Error(ne(151));for(var S=v=null,N=w,$=w=0,E=null,A=b.next();N!==null&&!A.done;$++,A=b.next()){N.index>$?(E=N,N=null):E=N.sibling;var L=p(m,N,A.value,x);if(L===null){N===null&&(N=E);break}t&&N&&L.alternate===null&&e(m,N),w=r(L,w,$),S===null?v=L:S.sibling=L,S=L,N=E}if(A.done)return n(m,N),ut&&xi(m,$),v;if(N===null){for(;!A.done;$++,A=b.next())A=d(m,A.value,x),A!==null&&(w=r(A,w,$),S===null?v=A:S.sibling=A,S=A);return ut&&xi(m,$),v}for(N=s(m,N);!A.done;$++,A=b.next())A=h(N,m,$,A.value,x),A!==null&&(t&&A.alternate!==null&&N.delete(A.key===null?$:A.key),w=r(A,w,$),S===null?v=A:S.sibling=A,S=A);return t&&N.forEach(function(W){return e(m,W)}),ut&&xi(m,$),v}function y(m,w,b,x){if(typeof b=="object"&&b!==null&&b.type===Po&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case nh:e:{for(var v=b.key,S=w;S!==null;){if(S.key===v){if(v=b.type,v===Po){if(S.tag===7){n(m,S.sibling),w=a(S,b.props.children),w.return=m,m=w;break e}}else if(S.elementType===v||typeof v=="object"&&v!==null&&v.$$typeof===gr&&Qv(v)===S.type){n(m,S.sibling),w=a(S,b.props),w.ref=qu(m,S,b),w.return=m,m=w;break e}n(m,S);break}else e(m,S);S=S.sibling}b.type===Po?(w=ji(b.props.children,m.mode,x,b.key),w.return=m,m=w):(x=Uh(b.type,b.key,b.props,null,m.mode,x),x.ref=qu(m,w,b),x.return=m,m=x)}return i(m);case jo:e:{for(S=b.key;w!==null;){if(w.key===S)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){n(m,w.sibling),w=a(w,b.children||[]),w.return=m,m=w;break e}else{n(m,w);break}else e(m,w);w=w.sibling}w=ry(b,m.mode,x),w.return=m,m=w}return i(m);case gr:return S=b._init,y(m,w,S(b._payload),x)}if(nc(b))return f(m,w,b,x);if(Wu(b))return g(m,w,b,x);hh(m,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(n(m,w.sibling),w=a(w,b),w.return=m,m=w):(n(m,w),w=ay(b,m.mode,x),w.return=m,m=w),i(m)):n(m,w)}return y}var ul=jC(!0),PC=jC(!1),uf=ti(null),cf=null,Go=null,Wb=null;function Ub(){Wb=Go=cf=null}function Gb(t){var e=uf.current;at(uf),t._currentValue=e}function tw(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Zo(t,e){cf=t,Wb=Go=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Gn=!0),t.firstContext=null)}function Ds(t){var e=t._currentValue;if(Wb!==t)if(t={context:t,memoizedValue:e,next:null},Go===null){if(cf===null)throw Error(ne(308));Go=t,cf.dependencies={lanes:0,firstContext:t}}else Go=Go.next=t;return e}var Ai=null;function Hb(t){Ai===null?Ai=[t]:Ai.push(t)}function LC(t,e,n,s){var a=e.interleaved;return a===null?(n.next=n,Hb(e)):(n.next=a.next,a.next=n),e.interleaved=n,qa(t,s)}function qa(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var yr=!1;function Kb(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ua(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Rr(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Le&2){var a=s.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),s.pending=e,qa(t,n)}return a=s.interleaved,a===null?(e.next=e,Hb(s)):(e.next=a.next,a.next=e),s.interleaved=e,qa(t,n)}function Lh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Db(t,n)}}function Zv(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var a=null,r=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};r===null?a=r=i:r=r.next=i,n=n.next}while(n!==null);r===null?a=r=e:r=r.next=e}else a=r=e;n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:r,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function df(t,e,n,s){var a=t.updateQueue;yr=!1;var r=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?r=u:i.next=u,i=l;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==i&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(r!==null){var d=a.baseState;i=0,c=u=l=null,o=r;do{var p=o.lane,h=o.eventTime;if((s&p)===p){c!==null&&(c=c.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=t,g=o;switch(p=e,h=n,g.tag){case 1:if(f=g.payload,typeof f=="function"){d=f.call(h,d,p);break e}d=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=g.payload,p=typeof f=="function"?f.call(h,d,p):f,p==null)break e;d=wt({},d,p);break e;case 2:yr=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=h,l=d):c=c.next=h,i|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(c===null&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=c,e=a.shared.interleaved,e!==null){a=e;do i|=a.lane,a=a.next;while(a!==e)}else r===null&&(a.shared.lanes=0);Gi|=i,t.lanes=i,t.memoizedState=d}}function e2(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],a=s.callback;if(a!==null){if(s.callback=null,s=n,typeof a!="function")throw Error(ne(191,a));a.call(s)}}}var pd={},ba=ti(pd),Oc=ti(pd),Fc=ti(pd);function Ri(t){if(t===pd)throw Error(ne(174));return t}function qb(t,e){switch(Ze(Fc,e),Ze(Oc,t),Ze(ba,pd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Fy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Fy(e,t)}at(ba),Ze(ba,e)}function cl(){at(ba),at(Oc),at(Fc)}function BC(t){Ri(Fc.current);var e=Ri(ba.current),n=Fy(e,t.type);e!==n&&(Ze(Oc,t),Ze(ba,n))}function Jb(t){Oc.current===t&&(at(ba),at(Oc))}var mt=ti(0);function pf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Q0=[];function Xb(){for(var t=0;t<Q0.length;t++)Q0[t]._workInProgressVersionPrimary=null;Q0.length=0}var zh=tr.ReactCurrentDispatcher,Z0=tr.ReactCurrentBatchConfig,Ui=0,yt=null,Lt=null,qt=null,hf=!1,yc=!1,jc=0,eF=0;function hn(){throw Error(ne(321))}function Yb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ta(t[n],e[n]))return!1;return!0}function Qb(t,e,n,s,a,r){if(Ui=r,yt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zh.current=t===null||t.memoizedState===null?aF:rF,t=n(s,a),yc){r=0;do{if(yc=!1,jc=0,25<=r)throw Error(ne(301));r+=1,qt=Lt=null,e.updateQueue=null,zh.current=iF,t=n(s,a)}while(yc)}if(zh.current=ff,e=Lt!==null&&Lt.next!==null,Ui=0,qt=Lt=yt=null,hf=!1,e)throw Error(ne(300));return t}function Zb(){var t=jc!==0;return jc=0,t}function da(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?yt.memoizedState=qt=t:qt=qt.next=t,qt}function _s(){if(Lt===null){var t=yt.alternate;t=t!==null?t.memoizedState:null}else t=Lt.next;var e=qt===null?yt.memoizedState:qt.next;if(e!==null)qt=e,Lt=t;else{if(t===null)throw Error(ne(310));Lt=t,t={memoizedState:Lt.memoizedState,baseState:Lt.baseState,baseQueue:Lt.baseQueue,queue:Lt.queue,next:null},qt===null?yt.memoizedState=qt=t:qt=qt.next=t}return qt}function Pc(t,e){return typeof e=="function"?e(t):e}function ey(t){var e=_s(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var s=Lt,a=s.baseQueue,r=n.pending;if(r!==null){if(a!==null){var i=a.next;a.next=r.next,r.next=i}s.baseQueue=a=r,n.pending=null}if(a!==null){r=a.next,s=s.baseState;var o=i=null,l=null,u=r;do{var c=u.lane;if((Ui&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,i=s):l=l.next=d,yt.lanes|=c,Gi|=c}u=u.next}while(u!==null&&u!==r);l===null?i=s:l.next=o,ta(s,e.memoizedState)||(Gn=!0),e.memoizedState=s,e.baseState=i,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){a=t;do r=a.lane,yt.lanes|=r,Gi|=r,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ty(t){var e=_s(),n=e.queue;if(n===null)throw Error(ne(311));n.lastRenderedReducer=t;var s=n.dispatch,a=n.pending,r=e.memoizedState;if(a!==null){n.pending=null;var i=a=a.next;do r=t(r,i.action),i=i.next;while(i!==a);ta(r,e.memoizedState)||(Gn=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),n.lastRenderedState=r}return[r,s]}function MC(){}function VC(t,e){var n=yt,s=_s(),a=e(),r=!ta(s.memoizedState,a);if(r&&(s.memoizedState=a,Gn=!0),s=s.queue,ex(GC.bind(null,n,s,t),[t]),s.getSnapshot!==e||r||qt!==null&&qt.memoizedState.tag&1){if(n.flags|=2048,Lc(9,UC.bind(null,n,s,a,e),void 0,null),Yt===null)throw Error(ne(349));Ui&30||WC(n,e,a)}return a}function WC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function UC(t,e,n,s){e.value=n,e.getSnapshot=s,HC(e)&&KC(t)}function GC(t,e,n){return n(function(){HC(e)&&KC(t)})}function HC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ta(t,n)}catch{return!0}}function KC(t){var e=qa(t,1);e!==null&&Xs(e,t,1,-1)}function t2(t){var e=da();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pc,lastRenderedState:t},e.queue=t,t=t.dispatch=sF.bind(null,yt,t),[e.memoizedState,t]}function Lc(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=yt.updateQueue,e===null?(e={lastEffect:null,stores:null},yt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function qC(){return _s().memoizedState}function Bh(t,e,n,s){var a=da();yt.flags|=t,a.memoizedState=Lc(1|e,n,void 0,s===void 0?null:s)}function om(t,e,n,s){var a=_s();s=s===void 0?null:s;var r=void 0;if(Lt!==null){var i=Lt.memoizedState;if(r=i.destroy,s!==null&&Yb(s,i.deps)){a.memoizedState=Lc(e,n,r,s);return}}yt.flags|=t,a.memoizedState=Lc(1|e,n,r,s)}function n2(t,e){return Bh(8390656,8,t,e)}function ex(t,e){return om(2048,8,t,e)}function JC(t,e){return om(4,2,t,e)}function XC(t,e){return om(4,4,t,e)}function YC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function QC(t,e,n){return n=n!=null?n.concat([t]):null,om(4,4,YC.bind(null,e,t),n)}function tx(){}function ZC(t,e){var n=_s();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Yb(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function eI(t,e){var n=_s();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Yb(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function tI(t,e,n){return Ui&21?(ta(n,e)||(n=iC(),yt.lanes|=n,Gi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Gn=!0),t.memoizedState=n)}function tF(t,e){var n=Ge;Ge=n!==0&&4>n?n:4,t(!0);var s=Z0.transition;Z0.transition={};try{t(!1),e()}finally{Ge=n,Z0.transition=s}}function nI(){return _s().memoizedState}function nF(t,e,n){var s=_r(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},sI(t))aI(e,n);else if(n=LC(t,e,n,s),n!==null){var a=En();Xs(n,t,s,a),rI(n,e,s)}}function sF(t,e,n){var s=_r(t),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(sI(t))aI(e,a);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var i=e.lastRenderedState,o=r(i,n);if(a.hasEagerState=!0,a.eagerState=o,ta(o,i)){var l=e.interleaved;l===null?(a.next=a,Hb(e)):(a.next=l.next,l.next=a),e.interleaved=a;return}}catch{}finally{}n=LC(t,e,a,s),n!==null&&(a=En(),Xs(n,t,s,a),rI(n,e,s))}}function sI(t){var e=t.alternate;return t===yt||e!==null&&e===yt}function aI(t,e){yc=hf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function rI(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Db(t,n)}}var ff={readContext:Ds,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useInsertionEffect:hn,useLayoutEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useMutableSource:hn,useSyncExternalStore:hn,useId:hn,unstable_isNewReconciler:!1},aF={readContext:Ds,useCallback:function(t,e){return da().memoizedState=[t,e===void 0?null:e],t},useContext:Ds,useEffect:n2,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Bh(4194308,4,YC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Bh(4194308,4,t,e)},useInsertionEffect:function(t,e){return Bh(4,2,t,e)},useMemo:function(t,e){var n=da();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=da();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=nF.bind(null,yt,t),[s.memoizedState,t]},useRef:function(t){var e=da();return t={current:t},e.memoizedState=t},useState:t2,useDebugValue:tx,useDeferredValue:function(t){return da().memoizedState=t},useTransition:function(){var t=t2(!1),e=t[0];return t=tF.bind(null,t[1]),da().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=yt,a=da();if(ut){if(n===void 0)throw Error(ne(407));n=n()}else{if(n=e(),Yt===null)throw Error(ne(349));Ui&30||WC(s,e,n)}a.memoizedState=n;var r={value:n,getSnapshot:e};return a.queue=r,n2(GC.bind(null,s,r,t),[t]),s.flags|=2048,Lc(9,UC.bind(null,s,r,n,e),void 0,null),n},useId:function(){var t=da(),e=Yt.identifierPrefix;if(ut){var n=Wa,s=Va;n=(s&~(1<<32-Js(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=jc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=eF++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},rF={readContext:Ds,useCallback:ZC,useContext:Ds,useEffect:ex,useImperativeHandle:QC,useInsertionEffect:JC,useLayoutEffect:XC,useMemo:eI,useReducer:ey,useRef:qC,useState:function(){return ey(Pc)},useDebugValue:tx,useDeferredValue:function(t){var e=_s();return tI(e,Lt.memoizedState,t)},useTransition:function(){var t=ey(Pc)[0],e=_s().memoizedState;return[t,e]},useMutableSource:MC,useSyncExternalStore:VC,useId:nI,unstable_isNewReconciler:!1},iF={readContext:Ds,useCallback:ZC,useContext:Ds,useEffect:ex,useImperativeHandle:QC,useInsertionEffect:JC,useLayoutEffect:XC,useMemo:eI,useReducer:ty,useRef:qC,useState:function(){return ty(Pc)},useDebugValue:tx,useDeferredValue:function(t){var e=_s();return Lt===null?e.memoizedState=t:tI(e,Lt.memoizedState,t)},useTransition:function(){var t=ty(Pc)[0],e=_s().memoizedState;return[t,e]},useMutableSource:MC,useSyncExternalStore:VC,useId:nI,unstable_isNewReconciler:!1};function Vs(t,e){if(t&&t.defaultProps){e=wt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function nw(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:wt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var lm={isMounted:function(t){return(t=t._reactInternals)?co(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=En(),a=_r(t),r=Ua(s,a);r.payload=e,n!=null&&(r.callback=n),e=Rr(t,r,a),e!==null&&(Xs(e,t,a,s),Lh(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=En(),a=_r(t),r=Ua(s,a);r.tag=1,r.payload=e,n!=null&&(r.callback=n),e=Rr(t,r,a),e!==null&&(Xs(e,t,a,s),Lh(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=En(),s=_r(t),a=Ua(n,s);a.tag=2,e!=null&&(a.callback=e),e=Rr(t,a,s),e!==null&&(Xs(e,t,s,n),Lh(e,t,s))}};function s2(t,e,n,s,a,r,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,r,i):e.prototype&&e.prototype.isPureReactComponent?!Ac(n,s)||!Ac(a,r):!0}function iI(t,e,n){var s=!1,a=Br,r=e.contextType;return typeof r=="object"&&r!==null?r=Ds(r):(a=qn(e)?Vi:kn.current,s=e.contextTypes,r=(s=s!=null)?ol(t,a):Br),e=new e(n,r),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=lm,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=r),e}function a2(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&lm.enqueueReplaceState(e,e.state,null)}function sw(t,e,n,s){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},Kb(t);var r=e.contextType;typeof r=="object"&&r!==null?a.context=Ds(r):(r=qn(e)?Vi:kn.current,a.context=ol(t,r)),a.state=t.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(nw(t,e,r,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&lm.enqueueReplaceState(a,a.state,null),df(t,n,a,s),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function dl(t,e){try{var n="",s=e;do n+=OO(s),s=s.return;while(s);var a=n}catch(r){a=`
Error generating stack: `+r.message+`
`+r.stack}return{value:t,source:e,stack:a,digest:null}}function ny(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function aw(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var oF=typeof WeakMap=="function"?WeakMap:Map;function oI(t,e,n){n=Ua(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){gf||(gf=!0,fw=s),aw(t,e)},n}function lI(t,e,n){n=Ua(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var a=e.value;n.payload=function(){return s(a)},n.callback=function(){aw(t,e)}}var r=t.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(n.callback=function(){aw(t,e),typeof s!="function"&&(Dr===null?Dr=new Set([this]):Dr.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function r2(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new oF;var a=new Set;s.set(e,a)}else a=s.get(e),a===void 0&&(a=new Set,s.set(e,a));a.has(n)||(a.add(n),t=kF.bind(null,t,e,n),e.then(t,t))}function i2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function o2(t,e,n,s,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ua(-1,1),e.tag=2,Rr(n,e,1))),n.lanes|=1),t)}var lF=tr.ReactCurrentOwner,Gn=!1;function In(t,e,n,s){e.child=t===null?PC(e,null,n,s):ul(e,t.child,n,s)}function l2(t,e,n,s,a){n=n.render;var r=e.ref;return Zo(e,a),s=Qb(t,e,n,s,r,a),n=Zb(),t!==null&&!Gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Ja(t,e,a)):(ut&&n&&Bb(e),e.flags|=1,In(t,e,s,a),e.child)}function u2(t,e,n,s,a){if(t===null){var r=n.type;return typeof r=="function"&&!ux(r)&&r.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=r,uI(t,e,r,s,a)):(t=Uh(n.type,null,s,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(r=t.child,!(t.lanes&a)){var i=r.memoizedProps;if(n=n.compare,n=n!==null?n:Ac,n(i,s)&&t.ref===e.ref)return Ja(t,e,a)}return e.flags|=1,t=Or(r,s),t.ref=e.ref,t.return=e,e.child=t}function uI(t,e,n,s,a){if(t!==null){var r=t.memoizedProps;if(Ac(r,s)&&t.ref===e.ref)if(Gn=!1,e.pendingProps=s=r,(t.lanes&a)!==0)t.flags&131072&&(Gn=!0);else return e.lanes=t.lanes,Ja(t,e,a)}return rw(t,e,n,s,a)}function cI(t,e,n){var s=e.pendingProps,a=s.children,r=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(Ko,ss),ss|=n;else{if(!(n&1073741824))return t=r!==null?r.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ze(Ko,ss),ss|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:n,Ze(Ko,ss),ss|=s}else r!==null?(s=r.baseLanes|n,e.memoizedState=null):s=n,Ze(Ko,ss),ss|=s;return In(t,e,a,n),e.child}function dI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function rw(t,e,n,s,a){var r=qn(n)?Vi:kn.current;return r=ol(e,r),Zo(e,a),n=Qb(t,e,n,s,r,a),s=Zb(),t!==null&&!Gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Ja(t,e,a)):(ut&&s&&Bb(e),e.flags|=1,In(t,e,n,a),e.child)}function c2(t,e,n,s,a){if(qn(n)){var r=!0;rf(e)}else r=!1;if(Zo(e,a),e.stateNode===null)Mh(t,e),iI(e,n,s),sw(e,n,s,a),s=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ds(u):(u=qn(n)?Vi:kn.current,u=ol(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==s||l!==u)&&a2(e,i,s,u),yr=!1;var p=e.memoizedState;i.state=p,df(e,s,i,a),l=e.memoizedState,o!==s||p!==l||Kn.current||yr?(typeof c=="function"&&(nw(e,n,c,s),l=e.memoizedState),(o=yr||s2(e,n,o,s,p,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),i.props=s,i.state=l,i.context=u,s=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{i=e.stateNode,zC(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Vs(e.type,o),i.props=u,d=e.pendingProps,p=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ds(l):(l=qn(n)?Vi:kn.current,l=ol(e,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||p!==l)&&a2(e,i,s,l),yr=!1,p=e.memoizedState,i.state=p,df(e,s,i,a);var f=e.memoizedState;o!==d||p!==f||Kn.current||yr?(typeof h=="function"&&(nw(e,n,h,s),f=e.memoizedState),(u=yr||s2(e,n,u,s,p,f,l)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,f,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,f,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=f),i.props=s,i.state=f,i.context=l,s=u):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),s=!1)}return iw(t,e,n,s,r,a)}function iw(t,e,n,s,a,r){dI(t,e);var i=(e.flags&128)!==0;if(!s&&!i)return a&&Jv(e,n,!1),Ja(t,e,r);s=e.stateNode,lF.current=e;var o=i&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&i?(e.child=ul(e,t.child,null,r),e.child=ul(e,null,o,r)):In(t,e,o,r),e.memoizedState=s.state,a&&Jv(e,n,!0),e.child}function pI(t){var e=t.stateNode;e.pendingContext?qv(t,e.pendingContext,e.pendingContext!==e.context):e.context&&qv(t,e.context,!1),qb(t,e.containerInfo)}function d2(t,e,n,s,a){return ll(),Vb(a),e.flags|=256,In(t,e,n,s),e.child}var ow={dehydrated:null,treeContext:null,retryLane:0};function lw(t){return{baseLanes:t,cachePool:null,transitions:null}}function hI(t,e,n){var s=e.pendingProps,a=mt.current,r=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(a&2)!==0),o?(r=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Ze(mt,a&1),t===null)return ew(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=s.children,t=s.fallback,r?(s=e.mode,r=e.child,i={mode:"hidden",children:i},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=i):r=dm(i,s,0,null),t=ji(t,s,n,null),r.return=e,t.return=e,r.sibling=t,e.child=r,e.child.memoizedState=lw(n),e.memoizedState=ow,t):nx(e,i));if(a=t.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return uF(t,e,i,s,o,a,n);if(r){r=s.fallback,i=e.mode,a=t.child,o=a.sibling;var l={mode:"hidden",children:s.children};return!(i&1)&&e.child!==a?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=Or(a,l),s.subtreeFlags=a.subtreeFlags&14680064),o!==null?r=Or(o,r):(r=ji(r,i,n,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,i=t.child.memoizedState,i=i===null?lw(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},r.memoizedState=i,r.childLanes=t.childLanes&~n,e.memoizedState=ow,s}return r=t.child,t=r.sibling,s=Or(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function nx(t,e){return e=dm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fh(t,e,n,s){return s!==null&&Vb(s),ul(e,t.child,null,n),t=nx(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function uF(t,e,n,s,a,r,i){if(n)return e.flags&256?(e.flags&=-257,s=ny(Error(ne(422))),fh(t,e,i,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(r=s.fallback,a=e.mode,s=dm({mode:"visible",children:s.children},a,0,null),r=ji(r,a,i,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&ul(e,t.child,null,i),e.child.memoizedState=lw(i),e.memoizedState=ow,r);if(!(e.mode&1))return fh(t,e,i,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var o=s.dgst;return s=o,r=Error(ne(419)),s=ny(r,s,void 0),fh(t,e,i,s)}if(o=(i&t.childLanes)!==0,Gn||o){if(s=Yt,s!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|i)?0:a,a!==0&&a!==r.retryLane&&(r.retryLane=a,qa(t,a),Xs(s,t,a,-1))}return lx(),s=ny(Error(ne(421))),fh(t,e,i,s)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=vF.bind(null,t),a._reactRetry=e,null):(t=r.treeContext,is=Ar(a.nextSibling),us=e,ut=!0,Gs=null,t!==null&&(vs[Ss++]=Va,vs[Ss++]=Wa,vs[Ss++]=Wi,Va=t.id,Wa=t.overflow,Wi=e),e=nx(e,s.children),e.flags|=4096,e)}function p2(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),tw(t.return,e,n)}function sy(t,e,n,s,a){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=n,r.tailMode=a)}function fI(t,e,n){var s=e.pendingProps,a=s.revealOrder,r=s.tail;if(In(t,e,s.children,n),s=mt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&p2(t,n,e);else if(t.tag===19)p2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Ze(mt,s),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&pf(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),sy(e,!1,a,n,r);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&pf(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}sy(e,!0,n,null,r);break;case"together":sy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Mh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ja(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Gi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ne(153));if(e.child!==null){for(t=e.child,n=Or(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Or(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function cF(t,e,n){switch(e.tag){case 3:pI(e),ll();break;case 5:BC(e);break;case 1:qn(e.type)&&rf(e);break;case 4:qb(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,a=e.memoizedProps.value;Ze(uf,s._currentValue),s._currentValue=a;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Ze(mt,mt.current&1),e.flags|=128,null):n&e.child.childLanes?hI(t,e,n):(Ze(mt,mt.current&1),t=Ja(t,e,n),t!==null?t.sibling:null);Ze(mt,mt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return fI(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ze(mt,mt.current),s)break;return null;case 22:case 23:return e.lanes=0,cI(t,e,n)}return Ja(t,e,n)}var mI,uw,gI,yI;mI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};uw=function(){};gI=function(t,e,n,s){var a=t.memoizedProps;if(a!==s){t=e.stateNode,Ri(ba.current);var r=null;switch(n){case"input":a=Ry(t,a),s=Ry(t,s),r=[];break;case"select":a=wt({},a,{value:void 0}),s=wt({},s,{value:void 0}),r=[];break;case"textarea":a=Oy(t,a),s=Oy(t,s),r=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=sf)}jy(n,s);var i;n=null;for(u in a)if(!s.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(i in o)o.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Sc.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var l=s[u];if(o=a!=null?a[u]:void 0,s.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(r||(r=[]),r.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(r=r||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(r=r||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Sc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&st("scroll",t),r||o===l||(r=[])):(r=r||[]).push(u,l))}n&&(r=r||[]).push("style",n);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};yI=function(t,e,n,s){n!==s&&(e.flags|=4)};function Ju(t,e){if(!ut)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function fn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function dF(t,e,n){var s=e.pendingProps;switch(Mb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fn(e),null;case 1:return qn(e.type)&&af(),fn(e),null;case 3:return s=e.stateNode,cl(),at(Kn),at(kn),Xb(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(ph(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gs!==null&&(yw(Gs),Gs=null))),uw(t,e),fn(e),null;case 5:Jb(e);var a=Ri(Fc.current);if(n=e.type,t!==null&&e.stateNode!=null)gI(t,e,n,s,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(ne(166));return fn(e),null}if(t=Ri(ba.current),ph(e)){s=e.stateNode,n=e.type;var r=e.memoizedProps;switch(s[ma]=e,s[_c]=r,t=(e.mode&1)!==0,n){case"dialog":st("cancel",s),st("close",s);break;case"iframe":case"object":case"embed":st("load",s);break;case"video":case"audio":for(a=0;a<ac.length;a++)st(ac[a],s);break;case"source":st("error",s);break;case"img":case"image":case"link":st("error",s),st("load",s);break;case"details":st("toggle",s);break;case"input":kv(s,r),st("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},st("invalid",s);break;case"textarea":Sv(s,r),st("invalid",s)}jy(n,r),a=null;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];i==="children"?typeof o=="string"?s.textContent!==o&&(r.suppressHydrationWarning!==!0&&dh(s.textContent,o,t),a=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&dh(s.textContent,o,t),a=["children",""+o]):Sc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&st("scroll",s)}switch(n){case"input":sh(s),vv(s,r,!0);break;case"textarea":sh(s),Nv(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=sf)}s=a,e.updateQueue=s,s!==null&&(e.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=GN(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=i.createElement(n,{is:s.is}):(t=i.createElement(n),n==="select"&&(i=t,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):t=i.createElementNS(t,n),t[ma]=e,t[_c]=s,mI(t,e,!1,!1),e.stateNode=t;e:{switch(i=Py(n,s),n){case"dialog":st("cancel",t),st("close",t),a=s;break;case"iframe":case"object":case"embed":st("load",t),a=s;break;case"video":case"audio":for(a=0;a<ac.length;a++)st(ac[a],t);a=s;break;case"source":st("error",t),a=s;break;case"img":case"image":case"link":st("error",t),st("load",t),a=s;break;case"details":st("toggle",t),a=s;break;case"input":kv(t,s),a=Ry(t,s),st("invalid",t);break;case"option":a=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},a=wt({},s,{value:void 0}),st("invalid",t);break;case"textarea":Sv(t,s),a=Oy(t,s),st("invalid",t);break;default:a=s}jy(n,a),o=a;for(r in o)if(o.hasOwnProperty(r)){var l=o[r];r==="style"?qN(t,l):r==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&HN(t,l)):r==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Nc(t,l):typeof l=="number"&&Nc(t,""+l):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Sc.hasOwnProperty(r)?l!=null&&r==="onScroll"&&st("scroll",t):l!=null&&Ib(t,r,l,i))}switch(n){case"input":sh(t),vv(t,s,!1);break;case"textarea":sh(t),Nv(t);break;case"option":s.value!=null&&t.setAttribute("value",""+zr(s.value));break;case"select":t.multiple=!!s.multiple,r=s.value,r!=null?Jo(t,!!s.multiple,r,!1):s.defaultValue!=null&&Jo(t,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=sf)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return fn(e),null;case 6:if(t&&e.stateNode!=null)yI(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(ne(166));if(n=Ri(Fc.current),Ri(ba.current),ph(e)){if(s=e.stateNode,n=e.memoizedProps,s[ma]=e,(r=s.nodeValue!==n)&&(t=us,t!==null))switch(t.tag){case 3:dh(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&dh(s.nodeValue,n,(t.mode&1)!==0)}r&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[ma]=e,e.stateNode=s}return fn(e),null;case 13:if(at(mt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ut&&is!==null&&e.mode&1&&!(e.flags&128))FC(),ll(),e.flags|=98560,r=!1;else if(r=ph(e),s!==null&&s.dehydrated!==null){if(t===null){if(!r)throw Error(ne(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(ne(317));r[ma]=e}else ll(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;fn(e),r=!1}else Gs!==null&&(yw(Gs),Gs=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||mt.current&1?Mt===0&&(Mt=3):lx())),e.updateQueue!==null&&(e.flags|=4),fn(e),null);case 4:return cl(),uw(t,e),t===null&&Rc(e.stateNode.containerInfo),fn(e),null;case 10:return Gb(e.type._context),fn(e),null;case 17:return qn(e.type)&&af(),fn(e),null;case 19:if(at(mt),r=e.memoizedState,r===null)return fn(e),null;if(s=(e.flags&128)!==0,i=r.rendering,i===null)if(s)Ju(r,!1);else{if(Mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=pf(t),i!==null){for(e.flags|=128,Ju(r,!1),s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)r=n,t=s,r.flags&=14680066,i=r.alternate,i===null?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=i.childLanes,r.lanes=i.lanes,r.child=i.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=i.memoizedProps,r.memoizedState=i.memoizedState,r.updateQueue=i.updateQueue,r.type=i.type,t=i.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ze(mt,mt.current&1|2),e.child}t=t.sibling}r.tail!==null&&It()>pl&&(e.flags|=128,s=!0,Ju(r,!1),e.lanes=4194304)}else{if(!s)if(t=pf(i),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ju(r,!0),r.tail===null&&r.tailMode==="hidden"&&!i.alternate&&!ut)return fn(e),null}else 2*It()-r.renderingStartTime>pl&&n!==1073741824&&(e.flags|=128,s=!0,Ju(r,!1),e.lanes=4194304);r.isBackwards?(i.sibling=e.child,e.child=i):(n=r.last,n!==null?n.sibling=i:e.child=i,r.last=i)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=It(),e.sibling=null,n=mt.current,Ze(mt,s?n&1|2:n&1),e):(fn(e),null);case 22:case 23:return ox(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?ss&1073741824&&(fn(e),e.subtreeFlags&6&&(e.flags|=8192)):fn(e),null;case 24:return null;case 25:return null}throw Error(ne(156,e.tag))}function pF(t,e){switch(Mb(e),e.tag){case 1:return qn(e.type)&&af(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return cl(),at(Kn),at(kn),Xb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Jb(e),null;case 13:if(at(mt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ne(340));ll()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return at(mt),null;case 4:return cl(),null;case 10:return Gb(e.type._context),null;case 22:case 23:return ox(),null;case 24:return null;default:return null}}var mh=!1,yn=!1,hF=typeof WeakSet=="function"?WeakSet:Set,de=null;function Ho(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){bt(t,e,s)}else n.current=null}function cw(t,e,n){try{n()}catch(s){bt(t,e,s)}}var h2=!1;function fF(t,e){if(Ky=ef,t=vC(),zb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var a=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{n.nodeType,r.nodeType}catch{n=null;break e}var i=0,o=-1,l=-1,u=0,c=0,d=t,p=null;t:for(;;){for(var h;d!==n||a!==0&&d.nodeType!==3||(o=i+a),d!==r||s!==0&&d.nodeType!==3||(l=i+s),d.nodeType===3&&(i+=d.nodeValue.length),(h=d.firstChild)!==null;)p=d,d=h;for(;;){if(d===t)break t;if(p===n&&++u===a&&(o=i),p===r&&++c===s&&(l=i),(h=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=h}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(qy={focusedElem:t,selectionRange:n},ef=!1,de=e;de!==null;)if(e=de,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,de=t;else for(;de!==null;){e=de;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,y=f.memoizedState,m=e.stateNode,w=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:Vs(e.type,g),y);m.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(x){bt(e,e.return,x)}if(t=e.sibling,t!==null){t.return=e.return,de=t;break}de=e.return}return f=h2,h2=!1,f}function wc(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var r=a.destroy;a.destroy=void 0,r!==void 0&&cw(e,n,r)}a=a.next}while(a!==s)}}function um(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function dw(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function wI(t){var e=t.alternate;e!==null&&(t.alternate=null,wI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ma],delete e[_c],delete e[Yy],delete e[X3],delete e[Y3])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function bI(t){return t.tag===5||t.tag===3||t.tag===4}function f2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||bI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function pw(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=sf));else if(s!==4&&(t=t.child,t!==null))for(pw(t,e,n),t=t.sibling;t!==null;)pw(t,e,n),t=t.sibling}function hw(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(hw(t,e,n),t=t.sibling;t!==null;)hw(t,e,n),t=t.sibling}var rn=null,Us=!1;function mr(t,e,n){for(n=n.child;n!==null;)xI(t,e,n),n=n.sibling}function xI(t,e,n){if(wa&&typeof wa.onCommitFiberUnmount=="function")try{wa.onCommitFiberUnmount(tm,n)}catch{}switch(n.tag){case 5:yn||Ho(n,e);case 6:var s=rn,a=Us;rn=null,mr(t,e,n),rn=s,Us=a,rn!==null&&(Us?(t=rn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):rn.removeChild(n.stateNode));break;case 18:rn!==null&&(Us?(t=rn,n=n.stateNode,t.nodeType===8?X0(t.parentNode,n):t.nodeType===1&&X0(t,n),Tc(t)):X0(rn,n.stateNode));break;case 4:s=rn,a=Us,rn=n.stateNode.containerInfo,Us=!0,mr(t,e,n),rn=s,Us=a;break;case 0:case 11:case 14:case 15:if(!yn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var r=a,i=r.destroy;r=r.tag,i!==void 0&&(r&2||r&4)&&cw(n,e,i),a=a.next}while(a!==s)}mr(t,e,n);break;case 1:if(!yn&&(Ho(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(o){bt(n,e,o)}mr(t,e,n);break;case 21:mr(t,e,n);break;case 22:n.mode&1?(yn=(s=yn)||n.memoizedState!==null,mr(t,e,n),yn=s):mr(t,e,n);break;default:mr(t,e,n)}}function m2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new hF),e.forEach(function(s){var a=SF.bind(null,t,s);n.has(s)||(n.add(s),s.then(a,a))})}}function zs(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var a=n[s];try{var r=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:rn=o.stateNode,Us=!1;break e;case 3:rn=o.stateNode.containerInfo,Us=!0;break e;case 4:rn=o.stateNode.containerInfo,Us=!0;break e}o=o.return}if(rn===null)throw Error(ne(160));xI(r,i,a),rn=null,Us=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){bt(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)kI(e,t),e=e.sibling}function kI(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(zs(e,t),ca(t),s&4){try{wc(3,t,t.return),um(3,t)}catch(g){bt(t,t.return,g)}try{wc(5,t,t.return)}catch(g){bt(t,t.return,g)}}break;case 1:zs(e,t),ca(t),s&512&&n!==null&&Ho(n,n.return);break;case 5:if(zs(e,t),ca(t),s&512&&n!==null&&Ho(n,n.return),t.flags&32){var a=t.stateNode;try{Nc(a,"")}catch(g){bt(t,t.return,g)}}if(s&4&&(a=t.stateNode,a!=null)){var r=t.memoizedProps,i=n!==null?n.memoizedProps:r,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&WN(a,r),Py(o,i);var u=Py(o,r);for(i=0;i<l.length;i+=2){var c=l[i],d=l[i+1];c==="style"?qN(a,d):c==="dangerouslySetInnerHTML"?HN(a,d):c==="children"?Nc(a,d):Ib(a,c,d,u)}switch(o){case"input":Dy(a,r);break;case"textarea":UN(a,r);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!r.multiple;var h=r.value;h!=null?Jo(a,!!r.multiple,h,!1):p!==!!r.multiple&&(r.defaultValue!=null?Jo(a,!!r.multiple,r.defaultValue,!0):Jo(a,!!r.multiple,r.multiple?[]:"",!1))}a[_c]=r}catch(g){bt(t,t.return,g)}}break;case 6:if(zs(e,t),ca(t),s&4){if(t.stateNode===null)throw Error(ne(162));a=t.stateNode,r=t.memoizedProps;try{a.nodeValue=r}catch(g){bt(t,t.return,g)}}break;case 3:if(zs(e,t),ca(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Tc(e.containerInfo)}catch(g){bt(t,t.return,g)}break;case 4:zs(e,t),ca(t);break;case 13:zs(e,t),ca(t),a=t.child,a.flags&8192&&(r=a.memoizedState!==null,a.stateNode.isHidden=r,!r||a.alternate!==null&&a.alternate.memoizedState!==null||(rx=It())),s&4&&m2(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(yn=(u=yn)||c,zs(e,t),yn=u):zs(e,t),ca(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(de=t,c=t.child;c!==null;){for(d=de=c;de!==null;){switch(p=de,h=p.child,p.tag){case 0:case 11:case 14:case 15:wc(4,p,p.return);break;case 1:Ho(p,p.return);var f=p.stateNode;if(typeof f.componentWillUnmount=="function"){s=p,n=p.return;try{e=s,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(g){bt(s,n,g)}}break;case 5:Ho(p,p.return);break;case 22:if(p.memoizedState!==null){y2(d);continue}}h!==null?(h.return=p,de=h):y2(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{a=d.stateNode,u?(r=a.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=KN("display",i))}catch(g){bt(t,t.return,g)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){bt(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:zs(e,t),ca(t),s&4&&m2(t);break;case 21:break;default:zs(e,t),ca(t)}}function ca(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(bI(n)){var s=n;break e}n=n.return}throw Error(ne(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(Nc(a,""),s.flags&=-33);var r=f2(t);hw(t,r,a);break;case 3:case 4:var i=s.stateNode.containerInfo,o=f2(t);pw(t,o,i);break;default:throw Error(ne(161))}}catch(l){bt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function mF(t,e,n){de=t,vI(t)}function vI(t,e,n){for(var s=(t.mode&1)!==0;de!==null;){var a=de,r=a.child;if(a.tag===22&&s){var i=a.memoizedState!==null||mh;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||yn;o=mh;var u=yn;if(mh=i,(yn=l)&&!u)for(de=a;de!==null;)i=de,l=i.child,i.tag===22&&i.memoizedState!==null?w2(a):l!==null?(l.return=i,de=l):w2(a);for(;r!==null;)de=r,vI(r),r=r.sibling;de=a,mh=o,yn=u}g2(t)}else a.subtreeFlags&8772&&r!==null?(r.return=a,de=r):g2(t)}}function g2(t){for(;de!==null;){var e=de;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:yn||um(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!yn)if(n===null)s.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:Vs(e.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&e2(e,r,s);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}e2(e,i,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Tc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}yn||e.flags&512&&dw(e)}catch(p){bt(e,e.return,p)}}if(e===t){de=null;break}if(n=e.sibling,n!==null){n.return=e.return,de=n;break}de=e.return}}function y2(t){for(;de!==null;){var e=de;if(e===t){de=null;break}var n=e.sibling;if(n!==null){n.return=e.return,de=n;break}de=e.return}}function w2(t){for(;de!==null;){var e=de;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{um(4,e)}catch(l){bt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var a=e.return;try{s.componentDidMount()}catch(l){bt(e,a,l)}}var r=e.return;try{dw(e)}catch(l){bt(e,r,l)}break;case 5:var i=e.return;try{dw(e)}catch(l){bt(e,i,l)}}}catch(l){bt(e,e.return,l)}if(e===t){de=null;break}var o=e.sibling;if(o!==null){o.return=e.return,de=o;break}de=e.return}}var gF=Math.ceil,mf=tr.ReactCurrentDispatcher,sx=tr.ReactCurrentOwner,As=tr.ReactCurrentBatchConfig,Le=0,Yt=null,At=null,un=0,ss=0,Ko=ti(0),Mt=0,zc=null,Gi=0,cm=0,ax=0,bc=null,Wn=null,rx=0,pl=1/0,Fa=null,gf=!1,fw=null,Dr=null,gh=!1,vr=null,yf=0,xc=0,mw=null,Vh=-1,Wh=0;function En(){return Le&6?It():Vh!==-1?Vh:Vh=It()}function _r(t){return t.mode&1?Le&2&&un!==0?un&-un:Z3.transition!==null?(Wh===0&&(Wh=iC()),Wh):(t=Ge,t!==0||(t=window.event,t=t===void 0?16:hC(t.type)),t):1}function Xs(t,e,n,s){if(50<xc)throw xc=0,mw=null,Error(ne(185));ud(t,n,s),(!(Le&2)||t!==Yt)&&(t===Yt&&(!(Le&2)&&(cm|=n),Mt===4&&xr(t,un)),Jn(t,s),n===1&&Le===0&&!(e.mode&1)&&(pl=It()+500,im&&ni()))}function Jn(t,e){var n=t.callbackNode;ZO(t,e);var s=Zh(t,t===Yt?un:0);if(s===0)n!==null&&$v(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&$v(n),e===1)t.tag===0?Q3(b2.bind(null,t)):DC(b2.bind(null,t)),q3(function(){!(Le&6)&&ni()}),n=null;else{switch(oC(s)){case 1:n=Rb;break;case 4:n=aC;break;case 16:n=Qh;break;case 536870912:n=rC;break;default:n=Qh}n=AI(n,SI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function SI(t,e){if(Vh=-1,Wh=0,Le&6)throw Error(ne(327));var n=t.callbackNode;if(el()&&t.callbackNode!==n)return null;var s=Zh(t,t===Yt?un:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=wf(t,s);else{e=s;var a=Le;Le|=2;var r=CI();(Yt!==t||un!==e)&&(Fa=null,pl=It()+500,Fi(t,e));do try{bF();break}catch(o){NI(t,o)}while(!0);Ub(),mf.current=r,Le=a,At!==null?e=0:(Yt=null,un=0,e=Mt)}if(e!==0){if(e===2&&(a=Vy(t),a!==0&&(s=a,e=gw(t,a))),e===1)throw n=zc,Fi(t,0),xr(t,s),Jn(t,It()),n;if(e===6)xr(t,s);else{if(a=t.current.alternate,!(s&30)&&!yF(a)&&(e=wf(t,s),e===2&&(r=Vy(t),r!==0&&(s=r,e=gw(t,r))),e===1))throw n=zc,Fi(t,0),xr(t,s),Jn(t,It()),n;switch(t.finishedWork=a,t.finishedLanes=s,e){case 0:case 1:throw Error(ne(345));case 2:ki(t,Wn,Fa);break;case 3:if(xr(t,s),(s&130023424)===s&&(e=rx+500-It(),10<e)){if(Zh(t,0)!==0)break;if(a=t.suspendedLanes,(a&s)!==s){En(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=Xy(ki.bind(null,t,Wn,Fa),e);break}ki(t,Wn,Fa);break;case 4:if(xr(t,s),(s&4194240)===s)break;for(e=t.eventTimes,a=-1;0<s;){var i=31-Js(s);r=1<<i,i=e[i],i>a&&(a=i),s&=~r}if(s=a,s=It()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*gF(s/1960))-s,10<s){t.timeoutHandle=Xy(ki.bind(null,t,Wn,Fa),s);break}ki(t,Wn,Fa);break;case 5:ki(t,Wn,Fa);break;default:throw Error(ne(329))}}}return Jn(t,It()),t.callbackNode===n?SI.bind(null,t):null}function gw(t,e){var n=bc;return t.current.memoizedState.isDehydrated&&(Fi(t,e).flags|=256),t=wf(t,e),t!==2&&(e=Wn,Wn=n,e!==null&&yw(e)),t}function yw(t){Wn===null?Wn=t:Wn.push.apply(Wn,t)}function yF(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var a=n[s],r=a.getSnapshot;a=a.value;try{if(!ta(r(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xr(t,e){for(e&=~ax,e&=~cm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Js(e),s=1<<n;t[n]=-1,e&=~s}}function b2(t){if(Le&6)throw Error(ne(327));el();var e=Zh(t,0);if(!(e&1))return Jn(t,It()),null;var n=wf(t,e);if(t.tag!==0&&n===2){var s=Vy(t);s!==0&&(e=s,n=gw(t,s))}if(n===1)throw n=zc,Fi(t,0),xr(t,e),Jn(t,It()),n;if(n===6)throw Error(ne(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ki(t,Wn,Fa),Jn(t,It()),null}function ix(t,e){var n=Le;Le|=1;try{return t(e)}finally{Le=n,Le===0&&(pl=It()+500,im&&ni())}}function Hi(t){vr!==null&&vr.tag===0&&!(Le&6)&&el();var e=Le;Le|=1;var n=As.transition,s=Ge;try{if(As.transition=null,Ge=1,t)return t()}finally{Ge=s,As.transition=n,Le=e,!(Le&6)&&ni()}}function ox(){ss=Ko.current,at(Ko)}function Fi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,K3(n)),At!==null)for(n=At.return;n!==null;){var s=n;switch(Mb(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&af();break;case 3:cl(),at(Kn),at(kn),Xb();break;case 5:Jb(s);break;case 4:cl();break;case 13:at(mt);break;case 19:at(mt);break;case 10:Gb(s.type._context);break;case 22:case 23:ox()}n=n.return}if(Yt=t,At=t=Or(t.current,null),un=ss=e,Mt=0,zc=null,ax=cm=Gi=0,Wn=bc=null,Ai!==null){for(e=0;e<Ai.length;e++)if(n=Ai[e],s=n.interleaved,s!==null){n.interleaved=null;var a=s.next,r=n.pending;if(r!==null){var i=r.next;r.next=a,s.next=i}n.pending=s}Ai=null}return t}function NI(t,e){do{var n=At;try{if(Ub(),zh.current=ff,hf){for(var s=yt.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}hf=!1}if(Ui=0,qt=Lt=yt=null,yc=!1,jc=0,sx.current=null,n===null||n.return===null){Mt=1,zc=e,At=null;break}e:{var r=t,i=n.return,o=n,l=e;if(e=un,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=i2(i);if(h!==null){h.flags&=-257,o2(h,i,o,r,e),h.mode&1&&r2(r,u,e),e=h,l=u;var f=e.updateQueue;if(f===null){var g=new Set;g.add(l),e.updateQueue=g}else f.add(l);break e}else{if(!(e&1)){r2(r,u,e),lx();break e}l=Error(ne(426))}}else if(ut&&o.mode&1){var y=i2(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),o2(y,i,o,r,e),Vb(dl(l,o));break e}}r=l=dl(l,o),Mt!==4&&(Mt=2),bc===null?bc=[r]:bc.push(r),r=i;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var m=oI(r,l,e);Zv(r,m);break e;case 1:o=l;var w=r.type,b=r.stateNode;if(!(r.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Dr===null||!Dr.has(b)))){r.flags|=65536,e&=-e,r.lanes|=e;var x=lI(r,o,e);Zv(r,x);break e}}r=r.return}while(r!==null)}$I(n)}catch(v){e=v,At===n&&n!==null&&(At=n=n.return);continue}break}while(!0)}function CI(){var t=mf.current;return mf.current=ff,t===null?ff:t}function lx(){(Mt===0||Mt===3||Mt===2)&&(Mt=4),Yt===null||!(Gi&268435455)&&!(cm&268435455)||xr(Yt,un)}function wf(t,e){var n=Le;Le|=2;var s=CI();(Yt!==t||un!==e)&&(Fa=null,Fi(t,e));do try{wF();break}catch(a){NI(t,a)}while(!0);if(Ub(),Le=n,mf.current=s,At!==null)throw Error(ne(261));return Yt=null,un=0,Mt}function wF(){for(;At!==null;)II(At)}function bF(){for(;At!==null&&!UO();)II(At)}function II(t){var e=EI(t.alternate,t,ss);t.memoizedProps=t.pendingProps,e===null?$I(t):At=e,sx.current=null}function $I(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pF(n,e),n!==null){n.flags&=32767,At=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Mt=6,At=null;return}}else if(n=dF(n,e,ss),n!==null){At=n;return}if(e=e.sibling,e!==null){At=e;return}At=e=t}while(e!==null);Mt===0&&(Mt=5)}function ki(t,e,n){var s=Ge,a=As.transition;try{As.transition=null,Ge=1,xF(t,e,n,s)}finally{As.transition=a,Ge=s}return null}function xF(t,e,n,s){do el();while(vr!==null);if(Le&6)throw Error(ne(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ne(177));t.callbackNode=null,t.callbackPriority=0;var r=n.lanes|n.childLanes;if(e3(t,r),t===Yt&&(At=Yt=null,un=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||gh||(gh=!0,AI(Qh,function(){return el(),null})),r=(n.flags&15990)!==0,n.subtreeFlags&15990||r){r=As.transition,As.transition=null;var i=Ge;Ge=1;var o=Le;Le|=4,sx.current=null,fF(t,n),kI(n,t),B3(qy),ef=!!Ky,qy=Ky=null,t.current=n,mF(n),GO(),Le=o,Ge=i,As.transition=r}else t.current=n;if(gh&&(gh=!1,vr=t,yf=a),r=t.pendingLanes,r===0&&(Dr=null),qO(n.stateNode),Jn(t,It()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],s(a.value,{componentStack:a.stack,digest:a.digest});if(gf)throw gf=!1,t=fw,fw=null,t;return yf&1&&t.tag!==0&&el(),r=t.pendingLanes,r&1?t===mw?xc++:(xc=0,mw=t):xc=0,ni(),null}function el(){if(vr!==null){var t=oC(yf),e=As.transition,n=Ge;try{if(As.transition=null,Ge=16>t?16:t,vr===null)var s=!1;else{if(t=vr,vr=null,yf=0,Le&6)throw Error(ne(331));var a=Le;for(Le|=4,de=t.current;de!==null;){var r=de,i=r.child;if(de.flags&16){var o=r.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(de=u;de!==null;){var c=de;switch(c.tag){case 0:case 11:case 15:wc(8,c,r)}var d=c.child;if(d!==null)d.return=c,de=d;else for(;de!==null;){c=de;var p=c.sibling,h=c.return;if(wI(c),c===u){de=null;break}if(p!==null){p.return=h,de=p;break}de=h}}}var f=r.alternate;if(f!==null){var g=f.child;if(g!==null){f.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}de=r}}if(r.subtreeFlags&2064&&i!==null)i.return=r,de=i;else e:for(;de!==null;){if(r=de,r.flags&2048)switch(r.tag){case 0:case 11:case 15:wc(9,r,r.return)}var m=r.sibling;if(m!==null){m.return=r.return,de=m;break e}de=r.return}}var w=t.current;for(de=w;de!==null;){i=de;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,de=b;else e:for(i=w;de!==null;){if(o=de,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:um(9,o)}}catch(v){bt(o,o.return,v)}if(o===i){de=null;break e}var x=o.sibling;if(x!==null){x.return=o.return,de=x;break e}de=o.return}}if(Le=a,ni(),wa&&typeof wa.onPostCommitFiberRoot=="function")try{wa.onPostCommitFiberRoot(tm,t)}catch{}s=!0}return s}finally{Ge=n,As.transition=e}}return!1}function x2(t,e,n){e=dl(n,e),e=oI(t,e,1),t=Rr(t,e,1),e=En(),t!==null&&(ud(t,1,e),Jn(t,e))}function bt(t,e,n){if(t.tag===3)x2(t,t,n);else for(;e!==null;){if(e.tag===3){x2(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Dr===null||!Dr.has(s))){t=dl(n,t),t=lI(e,t,1),e=Rr(e,t,1),t=En(),e!==null&&(ud(e,1,t),Jn(e,t));break}}e=e.return}}function kF(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=En(),t.pingedLanes|=t.suspendedLanes&n,Yt===t&&(un&n)===n&&(Mt===4||Mt===3&&(un&130023424)===un&&500>It()-rx?Fi(t,0):ax|=n),Jn(t,e)}function TI(t,e){e===0&&(t.mode&1?(e=ih,ih<<=1,!(ih&130023424)&&(ih=4194304)):e=1);var n=En();t=qa(t,e),t!==null&&(ud(t,e,n),Jn(t,n))}function vF(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),TI(t,n)}function SF(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(ne(314))}s!==null&&s.delete(e),TI(t,n)}var EI;EI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Kn.current)Gn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Gn=!1,cF(t,e,n);Gn=!!(t.flags&131072)}else Gn=!1,ut&&e.flags&1048576&&_C(e,lf,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Mh(t,e),t=e.pendingProps;var a=ol(e,kn.current);Zo(e,n),a=Qb(null,e,s,t,a,n);var r=Zb();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qn(s)?(r=!0,rf(e)):r=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Kb(e),a.updater=lm,e.stateNode=a,a._reactInternals=e,sw(e,s,t,n),e=iw(null,e,s,!0,r,n)):(e.tag=0,ut&&r&&Bb(e),In(null,e,a,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Mh(t,e),t=e.pendingProps,a=s._init,s=a(s._payload),e.type=s,a=e.tag=CF(s),t=Vs(s,t),a){case 0:e=rw(null,e,s,t,n);break e;case 1:e=c2(null,e,s,t,n);break e;case 11:e=l2(null,e,s,t,n);break e;case 14:e=u2(null,e,s,Vs(s.type,t),n);break e}throw Error(ne(306,s,""))}return e;case 0:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Vs(s,a),rw(t,e,s,a,n);case 1:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Vs(s,a),c2(t,e,s,a,n);case 3:e:{if(pI(e),t===null)throw Error(ne(387));s=e.pendingProps,r=e.memoizedState,a=r.element,zC(t,e),df(e,s,null,n);var i=e.memoizedState;if(s=i.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){a=dl(Error(ne(423)),e),e=d2(t,e,s,n,a);break e}else if(s!==a){a=dl(Error(ne(424)),e),e=d2(t,e,s,n,a);break e}else for(is=Ar(e.stateNode.containerInfo.firstChild),us=e,ut=!0,Gs=null,n=PC(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ll(),s===a){e=Ja(t,e,n);break e}In(t,e,s,n)}e=e.child}return e;case 5:return BC(e),t===null&&ew(e),s=e.type,a=e.pendingProps,r=t!==null?t.memoizedProps:null,i=a.children,Jy(s,a)?i=null:r!==null&&Jy(s,r)&&(e.flags|=32),dI(t,e),In(t,e,i,n),e.child;case 6:return t===null&&ew(e),null;case 13:return hI(t,e,n);case 4:return qb(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=ul(e,null,s,n):In(t,e,s,n),e.child;case 11:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Vs(s,a),l2(t,e,s,a,n);case 7:return In(t,e,e.pendingProps,n),e.child;case 8:return In(t,e,e.pendingProps.children,n),e.child;case 12:return In(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,a=e.pendingProps,r=e.memoizedProps,i=a.value,Ze(uf,s._currentValue),s._currentValue=i,r!==null)if(ta(r.value,i)){if(r.children===a.children&&!Kn.current){e=Ja(t,e,n);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var o=r.dependencies;if(o!==null){i=r.child;for(var l=o.firstContext;l!==null;){if(l.context===s){if(r.tag===1){l=Ua(-1,n&-n),l.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}r.lanes|=n,l=r.alternate,l!==null&&(l.lanes|=n),tw(r.return,n,e),o.lanes|=n;break}l=l.next}}else if(r.tag===10)i=r.type===e.type?null:r.child;else if(r.tag===18){if(i=r.return,i===null)throw Error(ne(341));i.lanes|=n,o=i.alternate,o!==null&&(o.lanes|=n),tw(i,n,e),i=r.sibling}else i=r.child;if(i!==null)i.return=r;else for(i=r;i!==null;){if(i===e){i=null;break}if(r=i.sibling,r!==null){r.return=i.return,i=r;break}i=i.return}r=i}In(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,s=e.pendingProps.children,Zo(e,n),a=Ds(a),s=s(a),e.flags|=1,In(t,e,s,n),e.child;case 14:return s=e.type,a=Vs(s,e.pendingProps),a=Vs(s.type,a),u2(t,e,s,a,n);case 15:return uI(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Vs(s,a),Mh(t,e),e.tag=1,qn(s)?(t=!0,rf(e)):t=!1,Zo(e,n),iI(e,s,a),sw(e,s,a,n),iw(null,e,s,!0,t,n);case 19:return fI(t,e,n);case 22:return cI(t,e,n)}throw Error(ne(156,e.tag))};function AI(t,e){return sC(t,e)}function NF(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ns(t,e,n,s){return new NF(t,e,n,s)}function ux(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CF(t){if(typeof t=="function")return ux(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Tb)return 11;if(t===Eb)return 14}return 2}function Or(t,e){var n=t.alternate;return n===null?(n=Ns(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Uh(t,e,n,s,a,r){var i=2;if(s=t,typeof t=="function")ux(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Po:return ji(n.children,a,r,e);case $b:i=8,a|=8;break;case $y:return t=Ns(12,n,e,a|2),t.elementType=$y,t.lanes=r,t;case Ty:return t=Ns(13,n,e,a),t.elementType=Ty,t.lanes=r,t;case Ey:return t=Ns(19,n,e,a),t.elementType=Ey,t.lanes=r,t;case BN:return dm(n,a,r,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case LN:i=10;break e;case zN:i=9;break e;case Tb:i=11;break e;case Eb:i=14;break e;case gr:i=16,s=null;break e}throw Error(ne(130,t==null?t:typeof t,""))}return e=Ns(i,n,e,a),e.elementType=t,e.type=s,e.lanes=r,e}function ji(t,e,n,s){return t=Ns(7,t,s,e),t.lanes=n,t}function dm(t,e,n,s){return t=Ns(22,t,s,e),t.elementType=BN,t.lanes=n,t.stateNode={isHidden:!1},t}function ay(t,e,n){return t=Ns(6,t,null,e),t.lanes=n,t}function ry(t,e,n){return e=Ns(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function IF(t,e,n,s,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=z0(0),this.expirationTimes=z0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z0(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function cx(t,e,n,s,a,r,i,o,l){return t=new IF(t,e,n,o,l),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Ns(3,null,null,e),t.current=r,r.stateNode=t,r.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kb(r),t}function $F(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:jo,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function RI(t){if(!t)return Br;t=t._reactInternals;e:{if(co(t)!==t||t.tag!==1)throw Error(ne(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ne(171))}if(t.tag===1){var n=t.type;if(qn(n))return RC(t,n,e)}return e}function DI(t,e,n,s,a,r,i,o,l){return t=cx(n,s,!0,t,a,r,i,o,l),t.context=RI(null),n=t.current,s=En(),a=_r(n),r=Ua(s,a),r.callback=e??null,Rr(n,r,a),t.current.lanes=a,ud(t,a,s),Jn(t,s),t}function pm(t,e,n,s){var a=e.current,r=En(),i=_r(a);return n=RI(n),e.context===null?e.context=n:e.pendingContext=n,e=Ua(r,i),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Rr(a,e,i),t!==null&&(Xs(t,a,i,r),Lh(t,a,i)),i}function bf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function k2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function dx(t,e){k2(t,e),(t=t.alternate)&&k2(t,e)}function TF(){return null}var _I=typeof reportError=="function"?reportError:function(t){console.error(t)};function px(t){this._internalRoot=t}hm.prototype.render=px.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ne(409));pm(t,e,null,null)};hm.prototype.unmount=px.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Hi(function(){pm(null,t,null,null)}),e[Ka]=null}};function hm(t){this._internalRoot=t}hm.prototype.unstable_scheduleHydration=function(t){if(t){var e=cC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<br.length&&e!==0&&e<br[n].priority;n++);br.splice(n,0,t),n===0&&pC(t)}};function hx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function fm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function v2(){}function EF(t,e,n,s,a){if(a){if(typeof s=="function"){var r=s;s=function(){var u=bf(i);r.call(u)}}var i=DI(e,s,t,0,null,!1,!1,"",v2);return t._reactRootContainer=i,t[Ka]=i.current,Rc(t.nodeType===8?t.parentNode:t),Hi(),i}for(;a=t.lastChild;)t.removeChild(a);if(typeof s=="function"){var o=s;s=function(){var u=bf(l);o.call(u)}}var l=cx(t,0,!1,null,null,!1,!1,"",v2);return t._reactRootContainer=l,t[Ka]=l.current,Rc(t.nodeType===8?t.parentNode:t),Hi(function(){pm(e,l,n,s)}),l}function mm(t,e,n,s,a){var r=n._reactRootContainer;if(r){var i=r;if(typeof a=="function"){var o=a;a=function(){var l=bf(i);o.call(l)}}pm(e,i,t,a)}else i=EF(n,e,t,a,s);return bf(i)}lC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=sc(e.pendingLanes);n!==0&&(Db(e,n|1),Jn(e,It()),!(Le&6)&&(pl=It()+500,ni()))}break;case 13:Hi(function(){var s=qa(t,1);if(s!==null){var a=En();Xs(s,t,1,a)}}),dx(t,1)}};_b=function(t){if(t.tag===13){var e=qa(t,134217728);if(e!==null){var n=En();Xs(e,t,134217728,n)}dx(t,134217728)}};uC=function(t){if(t.tag===13){var e=_r(t),n=qa(t,e);if(n!==null){var s=En();Xs(n,t,e,s)}dx(t,e)}};cC=function(){return Ge};dC=function(t,e){var n=Ge;try{return Ge=t,e()}finally{Ge=n}};zy=function(t,e,n){switch(e){case"input":if(Dy(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var a=rm(s);if(!a)throw Error(ne(90));VN(s),Dy(s,a)}}}break;case"textarea":UN(t,n);break;case"select":e=n.value,e!=null&&Jo(t,!!n.multiple,e,!1)}};YN=ix;QN=Hi;var AF={usingClientEntryPoint:!1,Events:[dd,Mo,rm,JN,XN,ix]},Xu={findFiberByHostInstance:Ei,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RF={bundleType:Xu.bundleType,version:Xu.version,rendererPackageName:Xu.rendererPackageName,rendererConfig:Xu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:tr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=tC(t),t===null?null:t.stateNode},findFiberByHostInstance:Xu.findFiberByHostInstance||TF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{tm=yh.inject(RF),wa=yh}catch{}}ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AF;ms.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hx(e))throw Error(ne(200));return $F(t,e,null,n)};ms.createRoot=function(t,e){if(!hx(t))throw Error(ne(299));var n=!1,s="",a=_I;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=cx(t,1,!1,null,null,n,!1,s,a),t[Ka]=e.current,Rc(t.nodeType===8?t.parentNode:t),new px(e)};ms.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ne(188)):(t=Object.keys(t).join(","),Error(ne(268,t)));return t=tC(e),t=t===null?null:t.stateNode,t};ms.flushSync=function(t){return Hi(t)};ms.hydrate=function(t,e,n){if(!fm(e))throw Error(ne(200));return mm(null,t,e,!0,n)};ms.hydrateRoot=function(t,e,n){if(!hx(t))throw Error(ne(405));var s=n!=null&&n.hydratedSources||null,a=!1,r="",i=_I;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=DI(e,null,t,1,n??null,a,!1,r,i),t[Ka]=e.current,Rc(t),s)for(t=0;t<s.length;t++)n=s[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new hm(e)};ms.render=function(t,e,n){if(!fm(e))throw Error(ne(200));return mm(null,t,e,!1,n)};ms.unmountComponentAtNode=function(t){if(!fm(t))throw Error(ne(40));return t._reactRootContainer?(Hi(function(){mm(null,null,t,!1,function(){t._reactRootContainer=null,t[Ka]=null})}),!0):!1};ms.unstable_batchedUpdates=ix;ms.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!fm(n))throw Error(ne(200));if(t==null||t._reactInternals===void 0)throw Error(ne(38));return mm(t,e,n,!1,s)};ms.version="18.3.1-next-f1338f8080-20240426";function OI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(OI)}catch(t){console.error(t)}}OI(),ON.exports=ms;var DF=ON.exports,FI,S2=DF;FI=S2.createRoot,S2.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bc(){return Bc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Bc.apply(this,arguments)}var Sr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Sr||(Sr={}));const N2="popstate";function _F(t){t===void 0&&(t={});function e(a,r){let{pathname:i="/",search:o="",hash:l=""}=po(a.location.hash.substr(1));return!i.startsWith("/")&&!i.startsWith(".")&&(i="/"+i),ww("",{pathname:i,search:o,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(a,r){let i=a.document.querySelector("base"),o="";if(i&&i.getAttribute("href")){let l=a.location.href,u=l.indexOf("#");o=u===-1?l:l.slice(0,u)}return o+"#"+(typeof r=="string"?r:xf(r))}function s(a,r){fx(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(r)+")")}return FF(e,n,s,t)}function Ot(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function fx(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function OF(){return Math.random().toString(36).substr(2,8)}function C2(t,e){return{usr:t.state,key:t.key,idx:e}}function ww(t,e,n,s){return n===void 0&&(n=null),Bc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?po(e):e,{state:n,key:e&&e.key||s||OF()})}function xf(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function po(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function FF(t,e,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:r=!1}=s,i=a.history,o=Sr.Pop,l=null,u=c();u==null&&(u=0,i.replaceState(Bc({},i.state,{idx:u}),""));function c(){return(i.state||{idx:null}).idx}function d(){o=Sr.Pop;let y=c(),m=y==null?null:y-u;u=y,l&&l({action:o,location:g.location,delta:m})}function p(y,m){o=Sr.Push;let w=ww(g.location,y,m);n&&n(w,y),u=c()+1;let b=C2(w,u),x=g.createHref(w);try{i.pushState(b,"",x)}catch(v){if(v instanceof DOMException&&v.name==="DataCloneError")throw v;a.location.assign(x)}r&&l&&l({action:o,location:g.location,delta:1})}function h(y,m){o=Sr.Replace;let w=ww(g.location,y,m);n&&n(w,y),u=c();let b=C2(w,u),x=g.createHref(w);i.replaceState(b,"",x),r&&l&&l({action:o,location:g.location,delta:0})}function f(y){let m=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof y=="string"?y:xf(y);return w=w.replace(/ $/,"%20"),Ot(m,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,m)}let g={get action(){return o},get location(){return t(a,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(N2,d),l=y,()=>{a.removeEventListener(N2,d),l=null}},createHref(y){return e(a,y)},createURL:f,encodeLocation(y){let m=f(y);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:p,replace:h,go(y){return i.go(y)}};return g}var I2;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(I2||(I2={}));function jF(t,e,n){return n===void 0&&(n="/"),PF(t,e,n,!1)}function PF(t,e,n,s){let a=typeof e=="string"?po(e):e,r=mx(a.pathname||"/",n);if(r==null)return null;let i=jI(t);LF(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=JF(r);o=KF(i[l],u,s)}return o}function jI(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(r,i,o)=>{let l={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:i,route:r};l.relativePath.startsWith("/")&&(Ot(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=Fr([s,l.relativePath]),c=n.concat(l);r.children&&r.children.length>0&&(Ot(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),jI(r.children,e,c,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:GF(u,r.index),routesMeta:c})};return t.forEach((r,i)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))a(r,i);else for(let l of PI(r.path))a(r,i,l)}),e}function PI(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,a=n.endsWith("?"),r=n.replace(/\?$/,"");if(s.length===0)return a?[r,""]:[r];let i=PI(s.join("/")),o=[];return o.push(...i.map(l=>l===""?r:[r,l].join("/"))),a&&o.push(...i),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function LF(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:HF(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const zF=/^:[\w-]+$/,BF=3,MF=2,VF=1,WF=10,UF=-2,$2=t=>t==="*";function GF(t,e){let n=t.split("/"),s=n.length;return n.some($2)&&(s+=UF),e&&(s+=MF),n.filter(a=>!$2(a)).reduce((a,r)=>a+(zF.test(r)?BF:r===""?VF:WF),s)}function HF(t,e){return t.length===e.length&&t.slice(0,-1).every((s,a)=>s===e[a])?t[t.length-1]-e[e.length-1]:0}function KF(t,e,n){let{routesMeta:s}=t,a={},r="/",i=[];for(let o=0;o<s.length;++o){let l=s[o],u=o===s.length-1,c=r==="/"?e:e.slice(r.length)||"/",d=T2({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),p=l.route;if(!d&&u&&n&&!s[s.length-1].route.index&&(d=T2({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Fr([r,d.pathname]),pathnameBase:ZF(Fr([r,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(r=Fr([r,d.pathnameBase]))}return i}function T2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=qF(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let r=a[0],i=r.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:s.reduce((u,c,d)=>{let{paramName:p,isOptional:h}=c;if(p==="*"){let g=o[d]||"";i=r.slice(0,r.length-g.length).replace(/(.)\/+$/,"$1")}const f=o[d];return h&&!f?u[p]=void 0:u[p]=(f||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:i,pattern:t}}function qF(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),fx(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function JF(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return fx(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function mx(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function XF(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?po(t):t;return{pathname:n?n.startsWith("/")?n:YF(n,e):e,search:ej(s),hash:tj(a)}}function YF(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function iy(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function QF(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function LI(t,e){let n=QF(t);return e?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function zI(t,e,n,s){s===void 0&&(s=!1);let a;typeof t=="string"?a=po(t):(a=Bc({},t),Ot(!a.pathname||!a.pathname.includes("?"),iy("?","pathname","search",a)),Ot(!a.pathname||!a.pathname.includes("#"),iy("#","pathname","hash",a)),Ot(!a.search||!a.search.includes("#"),iy("#","search","hash",a)));let r=t===""||a.pathname==="",i=r?"/":a.pathname,o;if(i==null)o=n;else{let d=e.length-1;if(!s&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),d-=1;a.pathname=p.join("/")}o=d>=0?e[d]:"/"}let l=XF(a,o),u=i&&i!=="/"&&i.endsWith("/"),c=(r||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Fr=t=>t.join("/").replace(/\/\/+/g,"/"),ZF=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ej=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,tj=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function nj(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const BI=["post","put","patch","delete"];new Set(BI);const sj=["get",...BI];new Set(sj);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mc(){return Mc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Mc.apply(this,arguments)}const gx=X.createContext(null),aj=X.createContext(null),ho=X.createContext(null),gm=X.createContext(null),si=X.createContext({outlet:null,matches:[],isDataRoute:!1}),MI=X.createContext(null);function rj(t,e){let{relative:n}=e===void 0?{}:e;hd()||Ot(!1);let{basename:s,navigator:a}=X.useContext(ho),{hash:r,pathname:i,search:o}=UI(t,{relative:n}),l=i;return s!=="/"&&(l=i==="/"?s:Fr([s,i])),a.createHref({pathname:l,search:o,hash:r})}function hd(){return X.useContext(gm)!=null}function ai(){return hd()||Ot(!1),X.useContext(gm).location}function VI(t){X.useContext(ho).static||X.useLayoutEffect(t)}function WI(){let{isDataRoute:t}=X.useContext(si);return t?bj():ij()}function ij(){hd()||Ot(!1);let t=X.useContext(gx),{basename:e,future:n,navigator:s}=X.useContext(ho),{matches:a}=X.useContext(si),{pathname:r}=ai(),i=JSON.stringify(LI(a,n.v7_relativeSplatPath)),o=X.useRef(!1);return VI(()=>{o.current=!0}),X.useCallback(function(u,c){if(c===void 0&&(c={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let d=zI(u,JSON.parse(i),r,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Fr([e,d.pathname])),(c.replace?s.replace:s.push)(d,c.state,c)},[e,s,i,r,t])}function oj(){let{matches:t}=X.useContext(si),e=t[t.length-1];return e?e.params:{}}function UI(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=X.useContext(ho),{matches:a}=X.useContext(si),{pathname:r}=ai(),i=JSON.stringify(LI(a,s.v7_relativeSplatPath));return X.useMemo(()=>zI(t,JSON.parse(i),r,n==="path"),[t,i,r,n])}function lj(t,e){return uj(t,e)}function uj(t,e,n,s){hd()||Ot(!1);let{navigator:a,static:r}=X.useContext(ho),{matches:i}=X.useContext(si),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let c=ai(),d;if(e){var p;let m=typeof e=="string"?po(e):e;u==="/"||(p=m.pathname)!=null&&p.startsWith(u)||Ot(!1),d=m}else d=c;let h=d.pathname||"/",f=h;if(u!=="/"){let m=u.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(m.length).join("/")}let g=!r&&n&&n.matches&&n.matches.length>0?n.matches:jF(t,{pathname:f}),y=fj(g&&g.map(m=>Object.assign({},m,{params:Object.assign({},l,m.params),pathname:Fr([u,a.encodeLocation?a.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?u:Fr([u,a.encodeLocation?a.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),i,n,s);return e&&y?X.createElement(gm.Provider,{value:{location:Mc({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Sr.Pop}},y):y}function cj(){let t=wj(),e=nj(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},e),n?X.createElement("pre",{style:a},n):null,null)}const dj=X.createElement(cj,null);class pj extends X.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?X.createElement(si.Provider,{value:this.props.routeContext},X.createElement(MI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hj(t){let{routeContext:e,match:n,children:s}=t,a=X.useContext(gx);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),X.createElement(si.Provider,{value:e},s)}function fj(t,e,n,s){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var r;if(!n)return null;if(n.errors)t=n.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=(a=n)==null?void 0:a.errors;if(o!=null){let c=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);c>=0||Ot(!1),i=i.slice(0,Math.min(i.length,c+1))}let l=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let c=0;c<i.length;c++){let d=i[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:p,errors:h}=n,f=d.route.loader&&p[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||f){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((c,d,p)=>{let h,f=!1,g=null,y=null;n&&(h=o&&d.route.id?o[d.route.id]:void 0,g=d.route.errorElement||dj,l&&(u<0&&p===0?(f=!0,y=null):u===p&&(f=!0,y=d.route.hydrateFallbackElement||null)));let m=e.concat(i.slice(0,p+1)),w=()=>{let b;return h?b=g:f?b=y:d.route.Component?b=X.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=c,X.createElement(hj,{match:d,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:b})};return n&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?X.createElement(pj,{location:n.location,revalidation:n.revalidation,component:g,error:h,children:w(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):w()},null)}var GI=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(GI||{}),kf=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(kf||{});function mj(t){let e=X.useContext(gx);return e||Ot(!1),e}function gj(t){let e=X.useContext(aj);return e||Ot(!1),e}function yj(t){let e=X.useContext(si);return e||Ot(!1),e}function HI(t){let e=yj(),n=e.matches[e.matches.length-1];return n.route.id||Ot(!1),n.route.id}function wj(){var t;let e=X.useContext(MI),n=gj(kf.UseRouteError),s=HI(kf.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function bj(){let{router:t}=mj(GI.UseNavigateStable),e=HI(kf.UseNavigateStable),n=X.useRef(!1);return VI(()=>{n.current=!0}),X.useCallback(function(a,r){r===void 0&&(r={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Mc({fromRouteId:e},r)))},[t,e])}function xj(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function _o(t){Ot(!1)}function kj(t){let{basename:e="/",children:n=null,location:s,navigationType:a=Sr.Pop,navigator:r,static:i=!1,future:o}=t;hd()&&Ot(!1);let l=e.replace(/^\/*/,"/"),u=X.useMemo(()=>({basename:l,navigator:r,static:i,future:Mc({v7_relativeSplatPath:!1},o)}),[l,o,r,i]);typeof s=="string"&&(s=po(s));let{pathname:c="/",search:d="",hash:p="",state:h=null,key:f="default"}=s,g=X.useMemo(()=>{let y=mx(c,l);return y==null?null:{location:{pathname:y,search:d,hash:p,state:h,key:f},navigationType:a}},[l,c,d,p,h,f,a]);return g==null?null:X.createElement(ho.Provider,{value:u},X.createElement(gm.Provider,{children:n,value:g}))}function vj(t){let{children:e,location:n}=t;return lj(bw(e),n)}new Promise(()=>{});function bw(t,e){e===void 0&&(e=[]);let n=[];return X.Children.forEach(t,(s,a)=>{if(!X.isValidElement(s))return;let r=[...e,a];if(s.type===X.Fragment){n.push.apply(n,bw(s.props.children,r));return}s.type!==_o&&Ot(!1),!s.props.index||!s.props.children||Ot(!1);let i={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=bw(s.props.children,r)),n.push(i)}),n}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function xw(){return xw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},xw.apply(this,arguments)}function Sj(t,e){if(t==null)return{};var n={},s=Object.keys(t),a,r;for(r=0;r<s.length;r++)a=s[r],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function Nj(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Cj(t,e){return t.button===0&&(!e||e==="_self")&&!Nj(t)}const Ij=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],$j="6";try{window.__reactRouterVersion=$j}catch{}const Tj="startTransition",E2=kO[Tj];function Ej(t){let{basename:e,children:n,future:s,window:a}=t,r=X.useRef();r.current==null&&(r.current=_F({window:a,v5Compat:!0}));let i=r.current,[o,l]=X.useState({action:i.action,location:i.location}),{v7_startTransition:u}=s||{},c=X.useCallback(d=>{u&&E2?E2(()=>l(d)):l(d)},[l,u]);return X.useLayoutEffect(()=>i.listen(c),[i,c]),X.useEffect(()=>xj(s),[s]),X.createElement(kj,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:i,future:s})}const Aj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Rj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ys=X.forwardRef(function(e,n){let{onClick:s,relative:a,reloadDocument:r,replace:i,state:o,target:l,to:u,preventScrollReset:c,viewTransition:d}=e,p=Sj(e,Ij),{basename:h}=X.useContext(ho),f,g=!1;if(typeof u=="string"&&Rj.test(u)&&(f=u,Aj))try{let b=new URL(window.location.href),x=u.startsWith("//")?new URL(b.protocol+u):new URL(u),v=mx(x.pathname,h);x.origin===b.origin&&v!=null?u=v+x.search+x.hash:g=!0}catch{}let y=rj(u,{relative:a}),m=Dj(u,{replace:i,state:o,target:l,preventScrollReset:c,relative:a,viewTransition:d});function w(b){s&&s(b),b.defaultPrevented||m(b)}return X.createElement("a",xw({},p,{href:f||y,onClick:g||r?s:w,ref:n,target:l}))});var A2;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(A2||(A2={}));var R2;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(R2||(R2={}));function Dj(t,e){let{target:n,replace:s,state:a,preventScrollReset:r,relative:i,viewTransition:o}=e===void 0?{}:e,l=WI(),u=ai(),c=UI(t,{relative:i});return X.useCallback(d=>{if(Cj(d,n)){d.preventDefault();let p=s!==void 0?s:xf(u)===xf(c);l(t,{replace:p,state:a,preventScrollReset:r,relative:i,viewTransition:o})}},[u,l,c,s,a,n,t,r,i,o])}/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var _j={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oj=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Sn=(t,e)=>{const n=X.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:o="",children:l,...u},c)=>X.createElement("svg",{ref:c,..._j,width:a,height:a,stroke:s,strokeWidth:i?Number(r)*24/Number(a):r,className:["lucide",`lucide-${Oj(t)}`,o].join(" "),...u},[...e.map(([d,p])=>X.createElement(d,p)),...Array.isArray(l)?l:[l]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=Sn("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=Sn("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=Sn("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=Sn("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fj=Sn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jj=Sn("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pj=Sn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lj=Sn("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=Sn("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zj=Sn("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bj=Sn("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mj=Sn("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vj=Sn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=Sn("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=Sn("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.330.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kc=Sn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),j2=[{name:"Beranda",href:"/"},{name:"Deteksi Benda",href:"/deteksi-benda"},{name:"Artikel",href:"/artikel"},{name:"Tentang NihonMe",href:"/tentang"}],Wj=72,Uj=()=>{const t=ai(),[e,n]=X.useState(!1),[s,a]=X.useState(!1),r=o=>t.pathname===o;X.useEffect(()=>{const o=()=>{a(window.scrollY>50),e&&n(!1)};return window.addEventListener("scroll",o),()=>window.removeEventListener("scroll",o)},[e]),X.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]);const i=()=>{n(!e)};return T.jsxs(T.Fragment,{children:[T.jsx("div",{className:`fixed inset-0 bg-black/70 backdrop-blur-sm z-30 md:hidden transition-opacity duration-300 ${e?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>n(!1),"aria-hidden":"true"}),T.jsx("header",{className:`fixed top-0 left-0 right-0 z-40 transition-all duration-300 ${s?"bg-surface-50 py-3 shadow-lg backdrop-blur-lg":"bg-transparent py-5"}`,children:T.jsxs("div",{className:"container mx-auto flex items-center justify-between relative px-6",children:[" ",T.jsx(Ys,{to:"/",className:"flex items-center gap-2",onClick:()=>e&&n(!1),children:T.jsx("img",{src:"/nihonme/img/icon/nihonme-icon.svg",alt:"NihonMe Logo",className:"h-8 w-auto"})}),T.jsx("nav",{className:"hidden md:flex flex-1 justify-end items-center",children:T.jsx("ul",{className:"flex items-center space-x-6 lg:space-x-8",children:j2.map(o=>T.jsx("li",{children:T.jsx(Ys,{to:o.href,className:`font-medium text-sm lg:text-base transition-colors relative after:absolute after:-bottom-1 after:left-0 after:h-[2px] after:w-0 after:bg-primary-600 hover:after:w-full after:transition-all after:duration-300 ${r(o.href)?"text-primary-600 after:w-full":"text-gray-500 hover:text-primary-600"}`,children:o.name})},o.name))})}),T.jsxs("button",{className:"md:hidden text-primary-500 p-2 z-50 relative",onClick:i,"aria-label":e?"Close menu":"Open menu","aria-expanded":e,"aria-controls":"mobile-menu",children:[T.jsx(Mj,{size:28,className:`transition-opacity duration-300 ${e?"opacity-0 absolute":"opacity-100"}`}),T.jsx(kc,{size:28,className:`transition-opacity duration-300 ${e?"opacity-100":"opacity-0 absolute"}`})]})]})}),T.jsx("div",{id:"mobile-menu",className:`md:hidden fixed inset-x-0 top-0 bg-surface-50 z-30 h-screen transform transition-transform duration-300 ease-in-out flex flex-col ${e?"translate-x-0":"translate-x-full"}`,style:{paddingTop:`${Wj}px`},children:T.jsxs("div",{className:"flex flex-col items-center justify-center flex-grow space-y-8 pb-16",children:[" ",j2.map(o=>T.jsx(Ys,{to:o.href,className:`text-xl font-medium transition-colors ${r(o.href)?"text-primary-600":"text-surface-700 hover:text-primary-600"}`,onClick:()=>n(!1),children:o.name},o.name))]})})]})},Gj=()=>{const[t,e]=X.useState(!1),n=ai();return X.useEffect(()=>{const s=setTimeout(()=>{e(!0);const a=setTimeout(()=>{e(!1)},3e3);return()=>clearTimeout(a)},2e3);return()=>clearTimeout(s)},[n.pathname]),n.pathname==="/deteksi-benda"?null:T.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:T.jsxs("div",{className:"relative",children:[T.jsxs("div",{className:`absolute bottom-full right-0 mb-2 px-4 py-2 bg-surface-900 text-white rounded-lg shadow-lg
                     transform transition-all duration-300 ease-in-out whitespace-nowrap
                     ${t?"opacity-100 translate-y-0":"opacity-0 translate-y-2 pointer-events-none"}`,children:[T.jsx("div",{className:"text-sm",children:"Deteksi Benda dengan AI"}),T.jsx("div",{className:"absolute bottom-0 right-6 transform translate-y-1/2 rotate-45 w-2 h-2 bg-surface-900"})]}),T.jsx(Ys,{to:"/deteksi-benda",className:`flex items-center justify-center w-14 h-14 rounded-full bg-primary-600 text-white\r
                   shadow-lg hover:shadow-xl transform hover:-translate-y-1 active:translate-y-0\r
                   transition-all duration-300 ease-in-out`,onMouseEnter:()=>e(!0),onMouseLeave:()=>e(!1),"aria-label":"Go to Object Detection",children:T.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]})})},Hj=({children:t})=>T.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-surface-50 to-surface-100",children:[T.jsx(Uj,{}),T.jsxs("main",{className:"pt-16 px-4",children:[" ",t]}),T.jsx(Gj,{})]}),Ki={:{japanese:"",romaji:"hito",indonesian:"orang",imageUrl:"/nihonme/img/object/1.webp",sentences:[{japanese:"",romaji:"Hito wa nihongo o benkyou shiteimasu.",indonesian:"Orang itu sedang belajar bahasa Jepang."},{japanese:"",romaji:"Sono hito wa sensei desu.",indonesian:"Orang itu adalah seorang guru."},{japanese:"",romaji:"Hito wa tomodachi to asobimasu.",indonesian:"Orang itu bermain dengan teman-temannya."}],description:"Kata  berarti orang, dan ini adalah salah satu kata benda paling dasar dalam bahasa Jepang, digunakan untuk merujuk pada setiap manusia."},:{japanese:"",romaji:"jitensha",indonesian:"sepeda",imageUrl:"/nihonme/img/object/2.webp",sentences:[{japanese:"",romaji:"Jitensha de gakkou e ikimasu.",indonesian:"Saya pergi ke sekolah dengan sepeda."},{japanese:"",romaji:"Atarashii jitensha o kaimashita.",indonesian:"Saya membeli sepeda baru."},{japanese:"",romaji:"Jitensha wa kankyou ni ii desu.",indonesian:"Sepeda baik untuk lingkungan."}],description:" berarti sepeda, gabungan dari  (sendiri) dan  (kendaraan), menjadikannya kendaraan yang Anda kayuh sendiri."},:{japanese:"",romaji:"kuruma",indonesian:"mobil",imageUrl:"/nihonme/img/object/3.webp",sentences:[{japanese:"",romaji:"Kuruma de suupaa ni ikimasu.",indonesian:"Saya pergi ke supermarket dengan mobil."},{japanese:"",romaji:"Kuruma wa hayai desu.",indonesian:"Mobil itu cepat."},{japanese:"",romaji:"Kuruma o unten shimasu.",indonesian:"Saya mengendarai mobil."}],description:" berarti mobil, alat transportasi umum di Jepang dan seluruh dunia."},:{japanese:"",romaji:"ootobai",indonesian:"sepeda motor",imageUrl:"/nihonme/img/object/4.webp",sentences:[{japanese:"",romaji:"Ootobai de tsuuringu shimasu.",indonesian:"Saya pergi touring dengan sepeda motor."},{japanese:"",romaji:"Ootobai wa hayai desu.",indonesian:"Sepeda motor itu cepat."},{japanese:"",romaji:"Ootobai ni noru no ga suki desu.",indonesian:"Saya suka mengendarai sepeda motor."}],description:" dipinjam dari kata bahasa Inggris 'auto bike' yang berarti sepeda motor, banyak digunakan di Jepang."},:{japanese:"",romaji:"hikouki",indonesian:"pesawat terbang",imageUrl:"/nihonme/img/object/5.webp",sentences:[{japanese:"",romaji:"Hikouki de tobimasu.",indonesian:"Saya terbang dengan pesawat."},{japanese:"",romaji:"Hikouki wa sora o tobimasu.",indonesian:"Pesawat terbang di langit."},{japanese:"",romaji:"Hikouki no chiketto o kaimashita.",indonesian:"Saya membeli tiket pesawat."}],description:" berarti pesawat terbang, dari  (penerbangan) dan  (mesin)."},:{japanese:"",romaji:"basu",indonesian:"bus",imageUrl:"/nihonme/img/object/6.webp",sentences:[{japanese:"",romaji:"Basu de gakkou e ikimasu.",indonesian:"Saya pergi ke sekolah dengan bus."},{japanese:"",romaji:"Basu wa ookii desu.",indonesian:"Bus itu besar."},{japanese:"",romaji:"Basu o matteimasu.",indonesian:"Saya sedang menunggu bus."}],description:" adalah kata pinjaman dari bahasa Inggris 'bus,' merujuk pada kendaraan transportasi umum."},:{japanese:"",romaji:"densha",indonesian:"kereta listrik",imageUrl:"/nihonme/img/object/7.webp",sentences:[{japanese:"",romaji:"Densha ni norimasu.",indonesian:"Saya naik kereta listrik."},{japanese:"",romaji:"Densha wa hayai desu.",indonesian:"Kereta listrik itu cepat."},{japanese:"",romaji:"Densha de shigoto ni ikimasu.",indonesian:"Saya pergi kerja dengan kereta listrik."}],description:" berarti kereta listrik, metode transportasi yang sangat populer di Jepang."},:{japanese:"",romaji:"torakku",indonesian:"truk",imageUrl:"/nihonme/img/object/8.webp",sentences:[{japanese:"",romaji:"Torakku ga douro o hashitteimasu.",indonesian:"Truk itu berjalan di jalan raya."},{japanese:"",romaji:"Torakku wa ookii desu.",indonesian:"Truk itu besar."},{japanese:"",romaji:"Torakku de nimotsu o hakobimasu.",indonesian:"Saya membawa barang dengan truk."}],description:" dipinjam dari bahasa Inggris 'truck,' digunakan untuk mengangkut barang."},:{japanese:"",romaji:"booto",indonesian:"perahu",imageUrl:"/nihonme/img/object/9.webp",sentences:[{japanese:"",romaji:"Booto de umi o watarimasu.",indonesian:"Saya menyeberangi laut dengan perahu."},{japanese:"",romaji:"Booto wa mizu no ue o utsukushii desu.",indonesian:"Perahu itu indah di atas air."},{japanese:"",romaji:"Booto ni noru no ga tanoshii desu.",indonesian:"Naik perahu itu menyenangkan."}],description:" dipinjam dari bahasa Inggris 'boat,' sebuah kapal air kecil."},:{japanese:"",romaji:"shingouki",indonesian:"lampu lalu lintas",imageUrl:"/nihonme/img/object/10.webp",sentences:[{japanese:"",romaji:"Shingouki wa aka desu.",indonesian:"Lampu lalu lintas berwarna merah."},{japanese:"",romaji:"Shingouki ga midori ni narimashita.",indonesian:"Lampu lalu lintas berubah menjadi hijau."},{japanese:"",romaji:"Michi o shingouki de watarimasu.",indonesian:"Saya menyeberang jalan di lampu lalu lintas."}],description:"Kata  (shingouki) menggabungkan  (shingou) yang berarti 'sinyal' dan  (ki) yang berarti 'mesin'. Lampu lalu lintas di Jepang seringkali berwarna biru, bukan hijau, untuk 'jalan', yang disebut  (ao)!"},:{japanese:"",romaji:"shoukasen",indonesian:"hidran kebakaran",imageUrl:"/nihonme/img/object/11.webp",sentences:[{japanese:"",romaji:"Shoukasen wa akai desu.",indonesian:"Hidran kebakaran itu berwarna merah."},{japanese:"",romaji:"Koko ni shoukasen ga arimasu.",indonesian:"Ada hidran kebakaran di sini."},{japanese:"",romaji:"Shoukasen no mizu wa tsuyoi desu.",indonesian:"Air dari hidran kebakaran itu kuat."}],description:" (shoukasen) berarti 'hidran kebakaran'. Anda akan melihatnya di jalanan di Jepang, seringkali berwarna merah, siap membantu petugas pemadam kebakaran. Kata ini terdiri dari  (shouka - pemadaman api) dan  (sen - sumbat/katup)."},:{japanese:"",romaji:"sutoppu sain",indonesian:"rambu berhenti",imageUrl:"/nihonme/img/object/12.webp",sentences:[{japanese:"",romaji:"Sutoppu sain de tomarimasu.",indonesian:"Saya berhenti di rambu berhenti."},{japanese:"",romaji:"Ano sutoppu sain ga miemasu ka.",indonesian:"Apakah Anda bisa melihat rambu berhenti itu?"},{japanese:"",romaji:"Sutoppu sain wa taisetsu desu.",indonesian:"Rambu berhenti itu penting."}],description:" (sutoppu sain) adalah kata Jepang untuk 'rambu berhenti', diambil langsung dari bahasa Inggris! Di Jepang, rambu berhenti berbentuk segitiga terbalik berwarna merah dan seringkali bertuliskan  (tomare), yang berarti 'Berhenti!'."},:{japanese:"",romaji:"paakingu meetaa",indonesian:"meteran parkir",imageUrl:"/nihonme/img/object/13.webp",sentences:[{japanese:"",romaji:"Paakingu meetaa ni okane o iremasu.",indonesian:"Saya memasukkan uang ke meteran parkir."},{japanese:"",romaji:"Kono paakingu meetaa wa kowareteimasu.",indonesian:"Meteran parkir ini rusak."},{japanese:"",romaji:"Paakingu meetaa no jikan ga kiremashita.",indonesian:"Waktu di meteran parkir sudah habis."}],description:" (paakingu meetaa) adalah kata pinjaman dari bahasa Inggris untuk 'meteran parkir'. Di Jepang, Anda akan menemukannya di area kota yang sibuk untuk mengatur ruang dan waktu parkir."},:{japanese:"",romaji:"benchi",indonesian:"bangku",imageUrl:"/nihonme/img/object/14.webp",sentences:[{japanese:"",romaji:"Kouen no benchi ni suwarimasu.",indonesian:"Saya duduk di bangku di taman."},{japanese:"",romaji:"Kono benchi wa atarashii desu.",indonesian:"Bangku ini baru."},{japanese:"",romaji:"Eki no hoomu ni benchi ga arimasu.",indonesian:"Ada bangku di peron stasiun."}],description:" (benchi) berasal dari kata Inggris 'bench'. Anda dapat menemukan bangku di taman, stasiun kereta, dan banyak tempat umum di Jepang untuk orang duduk dan beristirahat."},:{japanese:"",romaji:"tori",indonesian:"burung",imageUrl:"/nihonme/img/object/15.webp",sentences:[{japanese:"",romaji:"Tori ga sora o tondeimasu.",indonesian:"Seekor burung sedang terbang di langit."},{japanese:"",romaji:"Kawaii tori ga imasu ne.",indonesian:"Ada burung yang lucu ya."},{japanese:"",romaji:"Asa, tori no koe ga kikoemasu.",indonesian:"Di pagi hari, saya bisa mendengar suara burung."}],description:" (tori) berarti 'burung' dalam bahasa Jepang. Ini adalah kata yang sederhana dan umum. Jepang memiliki banyak spesies burung asli yang indah, dan motif burung populer dalam seni tradisional."},:{japanese:"",romaji:"neko",indonesian:"kucing",imageUrl:"/nihonme/img/object/16.webp",sentences:[{japanese:"",romaji:"Neko ga suki desu.",indonesian:"Saya suka kucing."},{japanese:"",romaji:"Sono neko wa shiroi desu.",indonesian:"Kucing itu berwarna putih."},{japanese:"",romaji:"Neko ga hirune o shiteimasu.",indonesian:"Kucing itu sedang tidur siang."}],description:" (neko) berarti 'kucing'. Kucing sangat populer di Jepang, dan Anda mungkin tahu  (maneki-neko), patung kucing yang melambai yang dipercaya membawa keberuntungan!"},:{japanese:"",romaji:"inu",indonesian:"anjing",imageUrl:"/nihonme/img/object/17.webp",sentences:[{japanese:"",romaji:"Inu to sanpo ni ikimasu.",indonesian:"Saya pergi jalan-jalan dengan anjing."},{japanese:"",romaji:"Kono inu wa otonashii desu.",indonesian:"Anjing ini tenang."},{japanese:"",romaji:"Inu ga wanwan hoeteimasu.",indonesian:'Anjing itu menggonggong "guk guk".'}],description:" (inu) berarti 'anjing'. Anjing juga merupakan hewan peliharaan populer di Jepang. Akita Inu dan Shiba Inu adalah ras anjing Jepang terkenal di seluruh dunia."},:{japanese:"",romaji:"uma",indonesian:"kuda",imageUrl:"/nihonme/img/object/18.webp",sentences:[{japanese:"",romaji:"Uma ga hashitteimasu.",indonesian:"Kuda itu sedang berlari."},{japanese:"",romaji:"Watashi wa uma ni noru koto ga dekimasu.",indonesian:"Saya bisa menunggang kuda."},{japanese:"",romaji:"Uma wa ninjin ga suki desu.",indonesian:"Kuda suka wortel."}],description:" (uma) berarti 'kuda'. Kuda telah menjadi penting dalam sejarah Jepang, terutama bagi samurai. Anda juga bisa melihatnya dalam festival tradisional dan pacuan kuda."},:{japanese:"",romaji:"hitsuji",indonesian:"domba",imageUrl:"/nihonme/img/object/19.webp",sentences:[{japanese:"",romaji:"Hitsuji wa shirokute fuwafuwa desu.",indonesian:"Domba itu putih dan berbulu halus."},{japanese:"",romaji:"Bokujou ni takusan no hitsuji ga imasu.",indonesian:"Ada banyak domba di peternakan."},{japanese:"",romaji:"Hitsuji wa mee mee nakimasu.",indonesian:'Domba mengembik "mbe mbe".'}],description:" (hitsuji) berarti 'domba'. Meskipun secara historis tidak seumum hewan lain di Jepang, domba dikenal karena wolnya dan sering terlihat di kebun binatang mini atau peternakan di pedesaan."},:{japanese:"",romaji:"ushi",indonesian:"sapi",imageUrl:"/nihonme/img/object/20.webp",sentences:[{japanese:"",romaji:"Ushi ga kusa o tabeteimasu.",indonesian:"Sapi itu sedang makan rumput."},{japanese:"",romaji:"Kono ushi wa ookii desu.",indonesian:"Sapi ini besar."},{japanese:"",romaji:"Ushi kara gyuunyuu ga toremasu.",indonesian:"Kita bisa mendapatkan susu dari sapi."}],description:" (ushi) berarti 'sapi' atau 'ternak'. Daging sapi Jepang terkenal seperti Wagyu berasal dari hewan ini. Mereka juga penting untuk produk susu."},:{japanese:"",romaji:"zou",indonesian:"gajah",imageUrl:"/nihonme/img/object/21.webp",sentences:[{japanese:"",romaji:"Doubutsuen de zou o mimashita.",indonesian:"Saya melihat gajah di kebun binatang."},{japanese:"",romaji:"Zou no hana wa nagai desu.",indonesian:"Belalai gajah itu panjang."},{japanese:"",romaji:"Zou wa kashikoi doubutsu desu.",indonesian:"Gajah adalah hewan yang cerdas."}],description:" (zou) adalah kata Jepang untuk 'gajah'. Meskipun bukan asli Jepang, gajah adalah hewan populer yang ditemukan di kebun binatang dan sering ditampilkan dalam cerita anak-anak."},:{japanese:"",romaji:"kuma",indonesian:"beruang",imageUrl:"/nihonme/img/object/22.webp",sentences:[{japanese:"",romaji:"Mori no naka ni kuma ga imasu.",indonesian:"Ada beruang di dalam hutan."},{japanese:"",romaji:"Kuma wa hachimitsu ga suki desu.",indonesian:"Beruang suka madu."},{japanese:"",romaji:"Ano kuma no nuigurumi wa kawaii desu.",indonesian:"Boneka beruang itu lucu."}],description:" (kuma) berarti 'beruang'. Jepang memiliki spesies beruang asli, seperti beruang coklat Ussuri di Hokkaido dan beruang hitam Asia. Hati-hati saat mendaki di habitat beruang!"},:{japanese:"",romaji:"shimauma",indonesian:"zebra",imageUrl:"/nihonme/img/object/23.webp",sentences:[{japanese:"",romaji:"Shimauma wa kuro to shiro desu.",indonesian:"Zebra berwarna hitam dan putih."},{japanese:"",romaji:"Doubutsuen de shimauma o mimashita.",indonesian:"Saya melihat zebra di kebun binatang."},{japanese:"",romaji:"Shimauma wa afurika ni sundeimasu.",indonesian:"Zebra tinggal di Afrika."}],description:" (shimauma) secara harfiah berarti 'kuda bergaris' ( shima = garis,  uma = kuda). Ini adalah nama yang lugas dan deskriptif untuk hewan ini!"},:{japanese:"",romaji:"kirin",indonesian:"jerapah",imageUrl:"/nihonme/img/object/24.webp",sentences:[{japanese:"",romaji:"Kirin wa kubi ga nagai desu.",indonesian:"Jerapah memiliki leher yang panjang."},{japanese:"",romaji:"Kirin wa takai ki no ha o tabemasu.",indonesian:"Jerapah makan daun dari pohon tinggi."},{japanese:"",romaji:"Ano kirin wa ookii desu ne.",indonesian:"Jerapah itu besar ya."}],description:" (kirin) adalah kata Jepang untuk 'jerapah'. Menariknya, 'Kirin' juga merupakan makhluk mitos dalam cerita rakyat Asia Timur, mirip unicorn, dan jerapah dinamai menurut namanya karena sifatnya yang lembut dan tinggi badannya yang mengesankan."},:{japanese:"",romaji:"ryukkusakku",indonesian:"ransel",imageUrl:"/nihonme/img/object/25.webp",sentences:[{japanese:"",romaji:"Ryukkusakku ni okashi o iremasu.",indonesian:"Saya memasukkan makanan ringan ke dalam ransel."},{japanese:"",romaji:"Kono ryukkusakku wa karui desu.",indonesian:"Ransel ini ringan."},{japanese:"",romaji:"Gakkou e ryukkusakku o motte ikimasu.",indonesian:"Saya membawa ransel ke sekolah."}],description:" (ryukkusakku) berasal dari kata Jerman 'Rucksack'. Ini umum digunakan di Jepang untuk ransel, sering disingkat menjadi  (ryukku)."},:{japanese:"",romaji:"kasa",indonesian:"payung",imageUrl:"/nihonme/img/object/26.webp",sentences:[{japanese:"",romaji:"Ame ga futteiru node, kasa o sashimasu.",indonesian:"Karena hujan, saya akan menggunakan payung."},{japanese:"",romaji:"Watashi wa aoi kasa o motteimasu.",indonesian:"Saya punya payung biru."},{japanese:"",romaji:"Dekakeru mae ni, kasa o wasurenaide kudasai.",indonesian:"Tolong jangan lupa payungmu sebelum pergi keluar."}],description:" (kasa) berarti 'payung' atau 'parasol'. Jepang memiliki budaya payung yang kuat karena musim hujannya, dan Anda akan melihat banyak payung yang unik dan bergaya."},:{japanese:"",romaji:"handobaggu",indonesian:"tas tangan",imageUrl:"/nihonme/img/object/27.webp",sentences:[{japanese:"",romaji:"Ano hito wa atarashii handobaggu o kaimashita.",indonesian:"Orang itu membeli tas tangan baru."},{japanese:"",romaji:"Handobaggu no naka ni saifu ga arimasu.",indonesian:"Ada dompet di dalam tas tangan."},{japanese:"",romaji:"Kono handobaggu wa totemo oshare desu.",indonesian:"Tas tangan ini sangat modis."}],description:" (handobaggu) adalah kata pinjaman langsung dari bahasa Inggris untuk 'tas tangan'. Ini digunakan untuk merujuk pada berbagai gaya tas yang dibawa dengan tangan atau di lengan."},:{japanese:"",romaji:"nekutai",indonesian:"dasi",imageUrl:"/nihonme/img/object/28.webp",sentences:[{japanese:"",romaji:"Chichi wa shigoto ni nekutai o shimasu.",indonesian:"Ayah saya memakai dasi untuk bekerja."},{japanese:"",romaji:"Akai nekutai ga suki desu.",indonesian:"Saya suka dasi merah."},{japanese:"",romaji:"Kono nekutai wa purezento desu.",indonesian:"Dasi ini adalah hadiah."}],description:" (nekutai) berasal dari kata Inggris 'necktie'. Ini adalah bagian penting dari pakaian bisnis untuk pria di Jepang, yang sering disebut 'salaryman'."},:{japanese:"",romaji:"suutsukeesu",indonesian:"koper",imageUrl:"/nihonme/img/object/29.webp",sentences:[{japanese:"",romaji:"Ryokou no tame ni suutsukeesu o junbi shimasu.",indonesian:"Saya akan menyiapkan koper untuk perjalanan."},{japanese:"",romaji:"Suutsukeesu ga omoi desu.",indonesian:"Koper itu berat."},{japanese:"",romaji:"Kuukou de suutsukeesu o azukemasu.",indonesian:"Saya akan menitipkan koper saya di bandara."}],description:" (suutsukeesu) adalah kata pinjaman dari bahasa Inggris, 'suitcase'. Ini sangat diperlukan untuk bepergian, dan di Jepang, Anda akan sering melihat orang menggunakannya, terutama di kereta ke dan dari bandara."},:{japanese:"",romaji:"furisubii",indonesian:"frisbi",imageUrl:"/nihonme/img/object/30.webp",sentences:[{japanese:"",romaji:"Kouen de furisubii o shimashou.",indonesian:"Ayo bermain frisbi di taman."},{japanese:"",romaji:"Inu ga furisubii o torimashita.",indonesian:"Anjing itu menangkap frisbi."},{japanese:"",romaji:"Furisubii o tooku e nagemasu.",indonesian:"Saya melempar frisbi jauh."}],description:" (furisubii) berasal langsung dari nama merek 'Frisbee'. Ini adalah barang populer untuk bermain di taman dan di pantai di Jepang."},:{japanese:"",romaji:"sukii",indonesian:"ski",imageUrl:"/nihonme/img/object/31.webp",sentences:[{japanese:"",romaji:"Watashi wa atarashii sukii ga hoshii desu.",indonesian:"Saya ingin ski (peralatan) baru."},{japanese:"",romaji:"Kono sukii wa nagakute aoi desu.",indonesian:"Ski (peralatan) ini panjang dan biru."},{japanese:"",romaji:"Sukii o kuruma ni tsumimashita.",indonesian:"Saya memuat ski (peralatan) ke dalam mobil."}],description:" (sukii) adalah 'ski', peralatan yang digunakan untuk meluncur di atas salju. Menyewa  umum dilakukan di resor ski Jepang."},:{japanese:"",romaji:"sunooboodo",indonesian:"papan salju",imageUrl:"/nihonme/img/object/32.webp",sentences:[{japanese:"",romaji:"Atarashii sunooboodo o kaitai desu.",indonesian:"Saya ingin membeli papan salju baru."},{japanese:"",romaji:"Ano hito no atarashii sunooboodo wa kakkoii desu.",indonesian:"Papan salju baru orang itu keren."},{japanese:"",romaji:"Kono sunooboodo wa dezain ga suteki desu.",indonesian:"Papan salju ini desainnya bagus."}],description:" (sunooboodo) adalah 'papan salju', sebuah papan yang digunakan untuk meluncur di atas salju. Banyak anak muda di Jepang menikmati menggunakan ."},:{japanese:"",romaji:"supootsubooru",indonesian:"bola olahraga",imageUrl:"/nihonme/img/object/33.webp",sentences:[{japanese:"",romaji:"Kodomotachi wa supootsubooru de asondeimasu.",indonesian:"Anak-anak sedang bermain dengan bola olahraga."},{japanese:"",romaji:"Kono supootsubooru wa sakkaa you desu ka.",indonesian:"Apakah bola olahraga ini untuk sepak bola?"},{japanese:"",romaji:"Takusan no shurui no supootsubooru ga arimasu.",indonesian:"Ada banyak jenis bola olahraga."}],description:" (supootsubooru) adalah gabungan dari 'sports' (olahraga) dan 'ball' (bola). Ini adalah istilah umum untuk bola yang digunakan dalam berbagai olahraga seperti sepak bola, bola basket, dll."},:{japanese:"",romaji:"tako",indonesian:"layang-layang",imageUrl:"/nihonme/img/object/34.webp",sentences:[{japanese:"",romaji:"Oshougatsu ni tako o agemasu.",indonesian:"Kami menerbangkan layang-layang pada Hari Tahun Baru."},{japanese:"",romaji:"Tako ga takaku agarimashita.",indonesian:"Layang-layang itu terbang tinggi."},{japanese:"",romaji:"Kaze ga tsuyoi node, tako ga yoku tobimasu.",indonesian:"Karena anginnya kencang, layang-layang terbang dengan baik."}],description:" (tako) bisa berarti 'layang-layang' atau 'gurita' dalam bahasa Jepang! Konteks biasanya memperjelasnya. Menerbangkan layang-layang adalah kegiatan tradisional Tahun Baru di Jepang."},:{japanese:"",romaji:"yakyuu batto",indonesian:"tongkat bisbol",imageUrl:"/nihonme/img/object/35.webp",sentences:[{japanese:"",romaji:"Ano hito wa yakyuu batto o motteimasu.",indonesian:"Orang itu memegang tongkat bisbol."},{japanese:"",romaji:"Yakyuu batto de booru o uchimasu.",indonesian:"Saya memukul bola dengan tongkat bisbol."},{japanese:"",romaji:"Kono yakyuu batto wa karui desu.",indonesian:"Tongkat bisbol ini ringan."}],description:" (yakyuu) berarti 'bisbol' dan  (batto) berasal dari bahasa Inggris 'bat'. Bisbol adalah olahraga yang sangat populer di Jepang!"},:{japanese:"",romaji:"yakyuu guroobu",indonesian:"sarung tangan bisbol",imageUrl:"/nihonme/img/object/36.webp",sentences:[{japanese:"",romaji:"Atarashii yakyuu guroobu o kaimashita.",indonesian:"Saya membeli sarung tangan bisbol baru."},{japanese:"",romaji:"Yakyuu guroobu de booru o torimasu.",indonesian:"Saya menangkap bola dengan sarung tangan bisbol."},{japanese:"",romaji:"Kono yakyuu guroobu wa kawa de dekiteimasu.",indonesian:"Sarung tangan bisbol ini terbuat dari kulit."}],description:" (yakyuu) adalah 'bisbol' dan  (guroobu) berasal dari 'glove'. Pemain bisbol Jepang dikenal dengan sarung tangan berkualitas tinggi mereka."},:{japanese:"",romaji:"sukeetoboodo",indonesian:"papan luncur",imageUrl:"/nihonme/img/object/37.webp",sentences:[{japanese:"",romaji:"Kouen de sukeetoboodo o shimasu.",indonesian:"Saya bermain papan luncur di taman."},{japanese:"",romaji:"Sukeetoboodo ni noru no wa tanoshii desu.",indonesian:"Naik papan luncur itu menyenangkan."},{japanese:"",romaji:"Ano ko wa sukeetoboodo ga jouzu desu.",indonesian:"Anak itu pandai bermain papan luncur."}],description:" (sukeetoboodo) berasal dari 'skateboard'. Papan luncur menjadi semakin populer di Jepang, terutama setelah dimasukkan dalam Olimpiade."},:{japanese:"",romaji:"saafuboodo",indonesian:"papan selancar",imageUrl:"/nihonme/img/object/38.webp",sentences:[{japanese:"",romaji:"Nami ni noru tame ni saafuboodo o tsukaimasu.",indonesian:"Saya menggunakan papan selancar untuk menaiki ombak."},{japanese:"",romaji:"Ano hito no saafuboodo wa karafuru desu.",indonesian:"Papan selancar orang itu berwarna-warni."},{japanese:"",romaji:"Atarashii saafuboodo ga hoshii desu.",indonesian:"Saya ingin papan selancar baru."}],description:" (saafuboodo) berasal dari 'surfboard'. Jepang memiliki banyak daerah pesisir di mana berselancar adalah kegiatan populer, terutama di tempat-tempat seperti Chiba dan Shonan."},:{japanese:"",romaji:"tenisu raketto",indonesian:"raket tenis",imageUrl:"/nihonme/img/object/39.webp",sentences:[{japanese:"",romaji:"Tenisu o suru toki, tenisu raketto ga irimasu.",indonesian:"Anda memerlukan raket tenis saat bermain tenis."},{japanese:"",romaji:"Kono tenisu raketto wa totemo karui desu.",indonesian:"Raket tenis ini sangat ringan."},{japanese:"",romaji:"Tomodachi to tenisu raketto o katte, tenisu o shimashita.",indonesian:"Saya membeli raket tenis dengan teman saya dan bermain tenis."}],description:" (tenisu raketto) berarti 'raket tenis'. Tenis adalah olahraga populer di Jepang, baik untuk dimainkan maupun ditonton, dengan pemain tenis Jepang yang terkenal."},:{japanese:"",romaji:"botoru",indonesian:"botol",imageUrl:"/nihonme/img/object/40.webp",sentences:[{japanese:"",romaji:"Mizu ga botoru ni haitteimasu.",indonesian:"Air ada di dalam botol."},{japanese:"",romaji:"Kono botoru wa purasuchikku de dekiteimasu.",indonesian:"Botol ini terbuat dari plastik."},{japanese:"",romaji:"Ano hito wa atarashii botoru o kaimashita.",indonesian:"Orang itu membeli botol baru."}],description:" (botoru) berasal dari kata Inggris 'bottle'. Anda akan sering melihat orang membawa  (botoru) mereka sendiri yang dapat digunakan kembali di Jepang, yang disebut  (mai botoru - botol saya)."},:{japanese:"",romaji:"wain gurasu",indonesian:"gelas anggur",imageUrl:"/nihonme/img/object/41.webp",sentences:[{japanese:"",romaji:"Wain gurasu de wain o nomimasu.",indonesian:"Saya minum anggur dari gelas anggur."},{japanese:"",romaji:"Kono wain gurasu wa kirei desu.",indonesian:"Gelas anggur ini cantik."},{japanese:"",romaji:"Resutoran de wain gurasu o mikakemashita.",indonesian:"Saya melihat gelas anggur di restoran."}],description:" (wain gurasu) adalah gabungan dari 'wine' (anggur) dan 'glass' (gelas). Meskipun sake adalah minuman tradisional, anggur juga dinikmati di Jepang, dan Anda akan menemukan  di banyak restoran."},:{japanese:"",romaji:"kappu",indonesian:"cangkir",imageUrl:"/nihonme/img/object/42.webp",sentences:[{japanese:"",romaji:"Koohii o kappu ni iremasu.",indonesian:"Saya menuang kopi ke dalam cangkir."},{japanese:"",romaji:"Atsui ocha ga kappu ni haitteimasu.",indonesian:"Teh panas ada di dalam cangkir."},{japanese:"",romaji:"Kono kappu wa watashi no okiniiri desu.",indonesian:"Cangkir ini favorit saya."}],description:" (kappu) berasal dari 'cup'. Ini bisa merujuk pada cangkir teh, cangkir kopi, atau bahkan gelas ukur. Gelas kertas untuk minuman juga umum."},:{japanese:"",romaji:"fooku",indonesian:"garpu",imageUrl:"/nihonme/img/object/43.webp",sentences:[{japanese:"",romaji:"Fooku de supagetti o tabemasu.",indonesian:"Saya makan spageti dengan garpu."},{japanese:"",romaji:"Teeburu no ue ni naifu to fooku ga arimasu.",indonesian:"Ada pisau dan garpu di atas meja."},{japanese:"",romaji:"Kono fooku wa gin'iro desu.",indonesian:"Garpu ini berwarna perak."}],description:" (fooku) berasal dari kata Inggris 'fork'. Meskipun sumpit ( - hashi) adalah tradisional,  umum digunakan untuk makanan gaya Barat di Jepang."},:{japanese:"",romaji:"naifu",indonesian:"pisau",imageUrl:"/nihonme/img/object/44.webp",sentences:[{japanese:"",romaji:"Naifu de pan o kirimasu.",indonesian:"Saya memotong roti dengan pisau."},{japanese:"",romaji:"Suteeki o taberu toki, naifu o tsukaimasu.",indonesian:"Saya menggunakan pisau saat makan steik."},{japanese:"",romaji:"Kono naifu wa yoku kiremasu.",indonesian:"Pisau ini tajam."}],description:" (naifu) berasal dari 'knife'. Ini digunakan untuk memotong makanan, terutama dalam masakan Barat. Masakan Jepang juga memiliki pisau khusus sendiri ( - houchou)."},:{japanese:"",romaji:"supuun",indonesian:"sendok",imageUrl:"/nihonme/img/object/45.webp",sentences:[{japanese:"",romaji:"Supuun de suupu o nomimasu.",indonesian:"Saya minum sup dengan sendok."},{japanese:"",romaji:"Kareeraisu wa supuun de taberu koto ga ooi desu.",indonesian:"Nasi kari sering dimakan dengan sendok."},{japanese:"",romaji:"Kodomo wa chiisai supuun o tsukaimasu.",indonesian:"Anak-anak menggunakan sendok kecil."}],description:" (supuun) berasal dari 'spoon'. Ini digunakan untuk makan sup, kari, makanan penutup, dan juga untuk mengaduk minuman seperti kopi atau teh."},:{japanese:"",romaji:"booru",indonesian:"mangkuk",imageUrl:"/nihonme/img/object/46.webp",sentences:[{japanese:"",romaji:"Sarada o booru ni iremashita.",indonesian:"Saya menaruh salad di mangkuk."},{japanese:"",romaji:"Kono booru wa suupu ni choudo ii desu.",indonesian:"Mangkuk ini pas untuk sup."},{japanese:"",romaji:"Asagohan ni shiriaru o booru de tabemasu.",indonesian:"Saya makan sereal di mangkuk untuk sarapan."}],description:" (booru) berasal dari 'bowl'. Di Jepang, Anda akan menggunakan berbagai jenis mangkuk untuk nasi ( - ochawan), sup ( - owan), atau salad dan mi."},:{japanese:"",romaji:"banana",indonesian:"pisang",imageUrl:"/nihonme/img/object/47.webp",sentences:[{japanese:"",romaji:"Banana wa kiiroi desu.",indonesian:"Pisang berwarna kuning."},{japanese:"",romaji:"Asagohan ni banana o tabemasu.",indonesian:"Saya makan pisang untuk sarapan."},{japanese:"",romaji:"Banana wa karada ni ii desu.",indonesian:"Pisang baik untuk tubuh."}],description:" (banana) adalah buah populer di Jepang, sering dimakan sebagai camilan cepat atau untuk sarapan. Biasanya diimpor tetapi sangat umum di supermarket."},:{japanese:"",romaji:"ringo",indonesian:"apel",imageUrl:"/nihonme/img/object/48.webp",sentences:[{japanese:"",romaji:"Ringo wa akakute oishii desu.",indonesian:"Apel berwarna merah dan enak."},{japanese:"",romaji:"Mainichi ringo o hitotsu tabemasu.",indonesian:"Saya makan satu apel setiap hari."},{japanese:"",romaji:"Kono ringo wa totemo ookii desu.",indonesian:"Apel ini sangat besar."}],description:" (ringo) berarti 'apel'. Prefektur Aomori di Jepang terkenal dengan  yang lezat, dan ada banyak varietas yang tersedia."},:{japanese:"",romaji:"sandouicchi",indonesian:"roti lapis",imageUrl:"/nihonme/img/object/49.webp",sentences:[{japanese:"",romaji:"Hirugohan ni sandouicchi o tabemasu.",indonesian:"Saya makan roti lapis untuk makan siang."},{japanese:"",romaji:"Tamago sandouicchi ga suki desu.",indonesian:"Saya suka roti lapis telur."},{japanese:"",romaji:"Pikunikku ni sandouicchi o motte ikimashou.",indonesian:"Ayo bawa roti lapis ke piknik."}],description:" (sandouicchi) berasal dari 'sandwich'. Toko serba ada Jepang ( - konbini) menjual berbagai macam  yang lezat dan seringkali unik!"},:{japanese:"",romaji:"orenji",indonesian:"jeruk",imageUrl:"/nihonme/img/object/50.webp",sentences:[{japanese:"",romaji:"Orenji wa bitamin shii ga ooi desu.",indonesian:"Jeruk kaya akan Vitamin C."},{japanese:"",romaji:"Orenji juusu o nomitai desu.",indonesian:"Saya ingin minum jus jeruk."},{japanese:"",romaji:"Kono orenji wa totemo amai desu.",indonesian:"Jeruk ini sangat manis."}],description:" (orenji) berarti 'jeruk' (buah). Ini adalah buah jeruk populer di Jepang, dan Anda juga dapat menemukan banyak minuman dan permen rasa jeruk."},:{japanese:"",romaji:"burokkorii",indonesian:"brokoli",imageUrl:"/nihonme/img/object/51.webp",sentences:[{japanese:"",romaji:"Burokkorii wa midoriiro no yasai desu.",indonesian:"Brokoli adalah sayuran berwarna hijau."},{japanese:"",romaji:"Watashi wa burokkorii ga suki desu.",indonesian:"Saya suka brokoli."},{japanese:"",romaji:"Burokkorii o yudete tabemasu.",indonesian:"Saya merebus brokoli dan memakannya."}],description:" (burokkorii) adalah 'brokoli'. Ini adalah sayuran umum dalam masakan Jepang, sering digunakan dalam salad, tumisan, atau sebagai lauk."},:{japanese:"",romaji:"ninjin",indonesian:"wortel",imageUrl:"/nihonme/img/object/52.webp",sentences:[{japanese:"",romaji:"Ninjin wa orenji iro desu.",indonesian:"Wortel berwarna oranye."},{japanese:"",romaji:"Usagi wa ninjin ga daisuki desu.",indonesian:"Kelinci sangat suka wortel."},{japanese:"",romaji:"Suupu ni ninjin o iremashita.",indonesian:"Saya memasukkan wortel ke dalam sup."}],description:" (ninjin) berarti 'wortel'. Wortel digunakan dalam banyak hidangan Jepang, seperti nasi kari () dan nikujaga ( - semur daging dan kentang)."},:{japanese:"",romaji:"hottodoggu",indonesian:"hot dog",imageUrl:"/nihonme/img/object/53.webp",sentences:[{japanese:"",romaji:"Hottodoggu ni kechappu o kakemasu.",indonesian:"Saya memberi saus tomat pada hot dog saya."},{japanese:"",romaji:"Yakyuu no shiai de hottodoggu o tabemashita.",indonesian:"Saya makan hot dog di pertandingan bisbol."},{japanese:"",romaji:"Kono hottodoggu wa oishisou desu.",indonesian:"Hot dog ini kelihatannya enak."}],description:" (hottodoggu) berasal dari 'hot dog'. Anda dapat menemukannya di toko serba ada, festival, dan beberapa tempat makanan cepat saji di Jepang."},:{japanese:"",romaji:"piza",indonesian:"pizza",imageUrl:"/nihonme/img/object/54.webp",sentences:[{japanese:"",romaji:"Tomodachi to piza o tabemasu.",indonesian:"Saya makan pizza dengan teman-teman."},{japanese:"",romaji:"Ookii piza o chuumon shimashita.",indonesian:"Saya memesan pizza besar."},{japanese:"",romaji:"Kono piza ni wa chiizu ga takusan haitteimasu.",indonesian:"Pizza ini banyak kejunya."}],description:" (piza) adalah 'pizza'. Ini sangat populer di Jepang, dengan banyak rantai pizza Jepang yang menawarkan topping unik seperti makanan laut atau ayam teriyaki."},:{japanese:"",romaji:"doonatsu",indonesian:"donat",imageUrl:"/nihonme/img/object/55.webp",sentences:[{japanese:"",romaji:"Amai doonatsu ga suki desu.",indonesian:"Saya suka donat manis."},{japanese:"",romaji:"Koohii to issho ni doonatsu o tabemasu.",indonesian:"Saya makan donat dengan kopi."},{japanese:"",romaji:"Iroiro na doonatsu ga arimasu ne.",indonesian:"Ada berbagai macam donat ya."}],description:" (doonatsu) berasal dari 'donut'. Ada banyak toko donat populer di Jepang yang menawarkan berbagai macam rasa dan desain lucu."},:{japanese:"",romaji:"keeki",indonesian:"kue",imageUrl:"/nihonme/img/object/56.webp",sentences:[{japanese:" ",romaji:"Tanjoubi ni keeki o tabemasu.",indonesian:"Saya makan kue di hari ulang tahun saya."},{japanese:"",romaji:"Kono keeki wa totemo oishii desu.",indonesian:"Kue ini sangat enak."},{japanese:"",romaji:"Chokoreeto keeki o tsukurimashita.",indonesian:"Saya membuat kue cokelat."}],description:" (keeki) adalah 'kue'. Kue Jepang terkenal ringan, lembut, dan dihias dengan indah, terutama kue tart stroberi."},:{japanese:"",romaji:"isu",indonesian:"kursi",imageUrl:"/nihonme/img/object/57.webp",sentences:[{japanese:"",romaji:"Heya ni isu ga arimasu.",indonesian:"Ada kursi di kamar."},{japanese:"",romaji:"Kono isu ni suwatte kudasai.",indonesian:"Silakan duduk di kursi ini."},{japanese:"",romaji:"Isu wa ki de dekiteimasu.",indonesian:"Kursi itu terbuat dari kayu."}],description:" (isu) berarti 'kursi'. Di rumah tradisional Jepang, orang sering duduk di atas tikar tatami, tetapi  umum di rumah modern, kantor, dan restoran."},:{japanese:"",romaji:"sofaa",indonesian:"sofa",imageUrl:"/nihonme/img/object/58.webp",sentences:[{japanese:"",romaji:"Ribingu ni sofaa ga arimasu.",indonesian:"Ada sofa di ruang tamu."},{japanese:"",romaji:"Kono sofaa wa totemo fukafuka desu.",indonesian:"Sofa ini sangat empuk."},{japanese:"",romaji:"Sofaa de hon o yomimasu.",indonesian:"Saya membaca buku di sofa."}],description:" (sofaa) berasal dari 'sofa'. Ini adalah perabot umum di ruang tamu Jepang untuk bersantai dan menonton TV."},:{japanese:"",romaji:"uekibachi",indonesian:"tanaman pot",imageUrl:"/nihonme/img/object/59.webp",sentences:[{japanese:"",romaji:"Kono uekibachi ni wa kirei na hana ga arimasu.",indonesian:"Tanaman pot ini memiliki bunga yang indah."},{japanese:"",romaji:"Madobe ni chiisana uekibachi o okimashita.",indonesian:"Saya meletakkan tanaman pot kecil di dekat jendela."},{japanese:"",romaji:"Mise no mae ni takusan no uekibachi ga narandeimasu.",indonesian:"Banyak tanaman pot berjejer di depan toko."}],description:" (uekibachi) merujuk pada 'tanaman pot' ( ueki = tanaman,  hachi = pot). Umumnya terlihat berbagai  menambah kehijauan di rumah dan jalanan di Jepang."},:{japanese:"",romaji:"beddo",indonesian:"tempat tidur",imageUrl:"/nihonme/img/object/60.webp",sentences:[{japanese:"",romaji:"Watashi wa beddo de nemasu.",indonesian:"Saya tidur di tempat tidur."},{japanese:"",romaji:"Kono beddo wa ookii desu.",indonesian:"Tempat tidur ini besar."},{japanese:"",romaji:"Maiasa beddo o kirei ni shimasu.",indonesian:"Saya merapikan tempat tidur setiap pagi."}],description:" (beddo) berasal dari 'bed'. Meskipun futon () yang diletakkan di atas tikar tatami adalah tradisional,  gaya Barat sangat umum di rumah modern Jepang."},:{japanese:"",romaji:"shokutaku",indonesian:"meja makan",imageUrl:"/nihonme/img/object/61.webp",sentences:[{japanese:"",romaji:"Shokutaku no ue ni ryouri ga arimasu.",indonesian:"Ada makanan di atas meja makan."},{japanese:"",romaji:"Minna de shokutaku o kakomimasu.",indonesian:"Semua orang berkumpul di sekitar meja makan."},{japanese:"",romaji:"Kono shokutaku wa mokusei desu.",indonesian:"Meja makan ini terbuat dari kayu."}],description:" (shokutaku) berarti 'meja makan'. Keluarga berkumpul di sekitar  untuk makan bersama."},:{japanese:"",romaji:"toire",indonesian:"toilet",imageUrl:"/nihonme/img/object/62.webp",sentences:[{japanese:"",romaji:"Toire wa doko desu ka.",indonesian:"Di mana toiletnya?"},{japanese:"",romaji:"Kono hoteru no toire wa kirei desu.",indonesian:"Toilet di hotel ini bersih."},{japanese:"",romaji:"Toire no ato, te o araimasu.",indonesian:"Saya mencuci tangan setelah menggunakan toilet."}],description:" (toire) berasal dari 'toilet'.  Jepang terkenal di seluruh dunia karena sangat berteknologi tinggi, dengan fitur seperti kursi berpemanas dan bidet internal!"},:{japanese:"",romaji:"terebi",indonesian:"TV",imageUrl:"/nihonme/img/object/63.webp",sentences:[{japanese:"",romaji:"Ribingu de terebi o mimasu.",indonesian:"Saya menonton TV di ruang tamu."},{japanese:"",romaji:"Atarashii terebi o kaimashita.",indonesian:"Saya membeli TV baru."},{japanese:"",romaji:"Suki na terebi bangumi ga arimasu.",indonesian:"Saya punya acara TV favorit."}],description:" (terebi) adalah singkatan dari  (terebijon - televisi). Menonton  adalah hiburan umum di Jepang, dengan banyak acara TV Jepang yang unik."},:{japanese:"",romaji:"nooto pasokon",indonesian:"komputer laptop",imageUrl:"/nihonme/img/object/64.webp",sentences:[{japanese:"",romaji:"Nooto pasokon de shigoto o shimasu.",indonesian:"Saya bekerja dengan komputer laptop saya."},{japanese:"",romaji:"Kono nooto pasokon wa karukute benri desu.",indonesian:"Komputer laptop ini ringan dan praktis."},{japanese:"",romaji:"Kafe de nooto pasokon o tsukatteimasu.",indonesian:"Saya sedang menggunakan komputer laptop saya di kafe."}],description:" (nooto pasokon) berarti 'komputer laptop', secara harfiah 'komputer pribadi buku catatan'. Sering disingkat menjadi PC (nooto pii shii)."},:{japanese:"",romaji:"mausu",indonesian:"mouse",imageUrl:"/nihonme/img/object/65.webp",sentences:[{japanese:"",romaji:"Mausu de kurikku shimasu.",indonesian:"Saya mengklik dengan mouse."},{japanese:"",romaji:"Kono mausu wa waiyaresu desu.",indonesian:"Mouse ini nirkabel."},{japanese:"",romaji:"Atarashii mausu ga hoshii desu.",indonesian:"Saya ingin mouse baru."}],description:" (mausu) berasal dari 'mouse', merujuk pada mouse komputer. Ini adalah aksesori penting bagi sebagian besar pengguna desktop dan banyak pengguna laptop."},:{japanese:"",romaji:"rimokon",indonesian:"remote control",imageUrl:"/nihonme/img/object/66.webp",sentences:[{japanese:"",romaji:"Terebi no rimokon wa doko desu ka.",indonesian:"Di mana remote control TV?"},{japanese:"",romaji:"Rimokon de channeru o kaemasu.",indonesian:"Saya mengganti saluran dengan remote control."},{japanese:"",romaji:"Kono rimokon wa tsukaiyasui desu.",indonesian:"Remote control ini mudah digunakan."}],description:" (rimokon) adalah singkatan dari 'remote controller'. Ini digunakan untuk TV, pendingin udara ( - eakon), dan banyak perangkat elektronik lainnya di Jepang."},:{japanese:"",romaji:"kiiboodo",indonesian:"keyboard",imageUrl:"/nihonme/img/object/67.webp",sentences:[{japanese:"",romaji:"Kiiboodo de taipu shimasu.",indonesian:"Saya mengetik di keyboard."},{japanese:"",romaji:"Kono kiiboodo wa atarashii desu.",indonesian:"Keyboard ini baru."},{japanese:"",romaji:"Nooto pasokon ni kiiboodo ga tsuiteimasu.",indonesian:"Laptop itu memiliki keyboard terpasang."}],description:" (kiiboodo) berasal dari 'keyboard'. Keyboard Jepang memiliki tombol ekstra untuk beralih antara huruf Romawi ( - roomaji) dan karakter Jepang ( - kana)."},:{japanese:"",romaji:"keitai denwa",indonesian:"telepon seluler",imageUrl:"/nihonme/img/object/68.webp",sentences:[{japanese:"",romaji:"Keitai denwa de tomodachi ni hanashimasu.",indonesian:"Saya berbicara dengan teman saya di telepon seluler."},{japanese:"",romaji:"Atarashii keitai denwa o kaimashita.",indonesian:"Saya membeli telepon seluler baru."},{japanese:"",romaji:"Keitai denwa de shashin o torimasu.",indonesian:"Saya mengambil foto dengan telepon seluler saya."}],description:" (keitai denwa) berarti 'telepon seluler', sering disingkat menjadi  (keitai). Jepang dikenal dengan teknologi dan budaya telepon selulernya yang canggih."},:{japanese:"",romaji:"denshi renji",indonesian:"oven microwave",imageUrl:"/nihonme/img/object/69.webp",sentences:[{japanese:"",romaji:"Tabemono o denshi renji de atatamemasu.",indonesian:"Saya memanaskan makanan di oven microwave."},{japanese:"",romaji:"Kono ryouri wa denshi renji de tsukuremasu.",indonesian:"Hidangan ini bisa dibuat di oven microwave."},{japanese:"",romaji:"Denshi renji wa totemo benri desu.",indonesian:"Oven microwave sangat praktis."}],description:" (denshi renji) berarti 'oven microwave' ( denshi = elektron,  renji = rentang/oven). Ini adalah peralatan yang sangat umum dan penting di dapur Jepang untuk memanaskan makanan dengan cepat."},:{japanese:"",romaji:"oobun",indonesian:"oven",imageUrl:"/nihonme/img/object/70.webp",sentences:[{japanese:"",romaji:"Oobun de keeki o yakimasu.",indonesian:"Saya memanggang kue di oven."},{japanese:"",romaji:"Kono oobun wa atarashii desu.",indonesian:"Oven ini baru."},{japanese:"",romaji:"Piza o oobun ni iremasu.",indonesian:"Saya memasukkan pizza ke dalam oven."}],description:" (oobun) berasal dari 'oven'. Meskipun tidak se-standar oven microwave di semua dapur Jepang, banyak dapur modern memiliki fungsi , seringkali digabungkan dengan microwave ( - oobun renji)."},:{japanese:"",romaji:"toosutaa",indonesian:"pemanggang roti",imageUrl:"/nihonme/img/object/71.webp",sentences:[{japanese:"",romaji:"Toosutaa de pan o yakimasu.",indonesian:"Saya memanggang roti di pemanggang roti."},{japanese:"",romaji:"Maiasa toosutaa o tsukaimasu.",indonesian:"Saya menggunakan pemanggang roti setiap pagi."},{japanese:"",romaji:"Kono toosutaa wa chiisai desu.",indonesian:"Pemanggang roti ini kecil."}],description:" (toosutaa) berasal dari 'toaster', khusus untuk memanggang roti. Banyak orang Jepang menikmati roti panggang tebal ( - shokupan) untuk sarapan."},:{japanese:"",romaji:"nagashi",indonesian:"bak cuci piring",imageUrl:"/nihonme/img/object/72.webp",sentences:[{japanese:"",romaji:"Shokki o nagashi de araimasu.",indonesian:"Saya mencuci piring di bak cuci piring."},{japanese:"",romaji:"Nagashi o kirei ni shite kudasai.",indonesian:"Tolong bersihkan bak cuci piring."},{japanese:"",romaji:"Nagashi de te o araimasu.",indonesian:"Saya mencuci tangan di bak cuci piring."}],description:" (nagashi) atau  (nagashidai) merujuk pada bak cuci piring dapur. Di sinilah Anda mencuci piring ( - saraarai) dan menyiapkan makanan."},:{japanese:"",romaji:"reizouko",indonesian:"kulkas",imageUrl:"/nihonme/img/object/73.webp",sentences:[{japanese:"",romaji:"Tabemono o reizouko ni iremasu.",indonesian:"Saya memasukkan makanan ke dalam kulkas."},{japanese:"",romaji:"Reizouko no naka ni juusu ga arimasu.",indonesian:"Ada jus di dalam kulkas."},{japanese:"",romaji:"Kono reizouko wa ookii desu.",indonesian:"Kulkas ini besar."}],description:" (reizouko) berarti 'kulkas'. Ini adalah peralatan penting di setiap rumah untuk menjaga makanan tetap segar. Kulkas Jepang sering memiliki kompartemen khusus."},:{japanese:"",romaji:"hon",indonesian:"buku",imageUrl:"/nihonme/img/object/74.webp",sentences:[{japanese:"",romaji:"Watashi wa hon o yomu no ga suki desu.",indonesian:"Saya suka membaca buku."},{japanese:"",romaji:"Toshokan de hon o karimasu.",indonesian:"Saya meminjam buku dari perpustakaan."},{japanese:"",romaji:"Kono hon wa omoshiroi desu.",indonesian:"Buku ini menarik."}],description:" (hon) berarti 'buku'. Jepang memiliki tradisi sastra yang kaya, dan toko buku ( - honya) umum ditemukan. Manga () adalah jenis  yang sangat populer."},:{japanese:"",romaji:"tokei",indonesian:"jam",imageUrl:"/nihonme/img/object/75.webp",sentences:[{japanese:"",romaji:"Heya ni kabekake no tokei ga arimasu.",indonesian:"Ada jam dinding di kamar."},{japanese:"",romaji:"Ano furui tokei wa mada ugoiteimasu.",indonesian:"Jam tua itu masih berfungsi."},{japanese:"",romaji:"Dejitaru tokei yori anarogu tokei ga suki desu.",indonesian:"Saya lebih suka jam analog daripada jam digital."}],description:" (tokei) berarti 'jam'. Ini adalah alat yang digunakan untuk mengetahui waktu, ditemukan di dinding ( - kabedokei) atau meja di rumah dan gedung."},:{japanese:"",romaji:"kabin",indonesian:"vas",imageUrl:"/nihonme/img/object/76.webp",sentences:[{japanese:"",romaji:"Kabin ni hana o ikemasu.",indonesian:"Saya merangkai bunga di vas."},{japanese:"",romaji:"Kono kabin wa totemo kirei desu.",indonesian:"Vas ini sangat indah."},{japanese:"",romaji:"Teeburu no ue ni kabin o okimashita.",indonesian:"Saya meletakkan vas di atas meja."}],description:" (kabin) berarti 'vas'. Ini digunakan untuk memajang bunga ( - hana). Merangkai bunga, atau  (ikebana), adalah seni tradisional Jepang."},:{japanese:"",romaji:"hasami",indonesian:"gunting",imageUrl:"/nihonme/img/object/77.webp",sentences:[{japanese:"",romaji:"Kami o hasami de kirimasu.",indonesian:"Saya memotong kertas dengan gunting."},{japanese:"",romaji:"Kono hasami wa yoku kiremasu ka.",indonesian:"Apakah gunting ini tajam?"},{japanese:"",romaji:"Kodomo wa anzen na hasami o tsukaimasu.",indonesian:"Anak-anak menggunakan gunting yang aman."}],description:" (hasami) berarti 'gunting'. Digunakan untuk memotong kertas, kain, dan banyak hal lainnya. Ada berbagai jenis untuk tujuan yang berbeda."},:{japanese:"",romaji:"tedi bea",indonesian:"boneka beruang",imageUrl:"/nihonme/img/object/78.webp",sentences:[{japanese:"",romaji:"Watashi wa chiisai toki, tedi bea o motteimashita.",indonesian:"Saya punya boneka beruang ketika saya kecil."},{japanese:"",romaji:"Kono tedi bea wa totemo kawaii desu.",indonesian:"Boneka beruang ini sangat lucu."},{japanese:"",romaji:"Tomodachi ni tedi bea o purezento shimashita.",indonesian:"Saya memberi teman saya hadiah boneka beruang."}],description:" (tedi bea) berasal dari 'teddy bear'. Boneka beruang ini adalah mainan dan barang koleksi populer di Jepang, sama seperti di banyak negara lain."},:{japanese:"",romaji:"hea doraiyaa",indonesian:"pengering rambut",imageUrl:"/nihonme/img/object/79.webp",sentences:[{japanese:"",romaji:"Ofuro no ato, hea doraiyaa o tsukaimasu.",indonesian:"Saya menggunakan pengering rambut setelah mandi."},{japanese:"",romaji:"Kono hea doraiyaa wa atarashii moderu desu.",indonesian:"Pengering rambut ini model baru."},{japanese:"",romaji:"Hea doraiyaa de kami o kawakashimasu.",indonesian:"Saya mengeringkan rambut dengan pengering rambut."}],description:" (hea doraiyaa) berasal dari 'hair dryer'. Ini adalah peralatan umum yang digunakan setelah mandi untuk mengeringkan rambut."},:{japanese:"",romaji:"ha burashi",indonesian:"sikat gigi",imageUrl:"/nihonme/img/object/80.webp",sentences:[{japanese:"",romaji:"Mainichi, ha burashi de ha o migakimasu.",indonesian:"Setiap hari, saya menggosok gigi dengan sikat gigi."},{japanese:"",romaji:"Atarashii ha burashi o kaimashita.",indonesian:"Saya membeli sikat gigi baru."},{japanese:"",romaji:"Kono ha burashi wa yawarakai desu.",indonesian:"Sikat gigi ini lembut."}],description:" (ha burashi), sering ditulis , berarti 'sikat gigi'. Kebersihan mulut itu penting, dan toko obat di Jepang menawarkan berbagai macam ."}},vw=[{link:"https://wkwk-japanese.com/?p=4330",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/thumbnail_standard-520x300.png",title:"Cara Mulai Belajar Bahasa Jepang Ala WKWK JAPANESE!",date:"2023-10-03"},{link:"https://wkwk-japanese.com/?p=4257",img:"https://wkwk-japanese.com/wp-content/uploads/2023/09/200.png",title:"Jenis Kata dalam Bahasa Jepang ()",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=2772",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Kata-penghubung-Tapi.png",title:"Penggunaan Konjungsi (Kata Penghubung) TAPI | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=2378",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Cuaca.png",title:"Kosakata tentang Cuaca dalam bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2401",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Dalam-kelas.png",title:"Kosakata Bahasa Jepang yang Sering Digunakan di Dalam Kelas",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2357",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Minuman.png",title:"Kosakata tentang Minuman dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2362",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Barang-rumah.png",title:"Kosakata tentang Barang yang ada di rumah dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=2370",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Tempat-bangunan.png",title:"Kosakata tentang nama tempat dan Bangunan dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=2471",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Letak-posisi.png",title:"Kosakata tentang Letak dan Posisi dalam bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2670",img:"https://wkwk-japanese.com/wp-content/uploads/2023/08/Bulan.png",title:"Kosakata Bahasa Jepang yang Berkaitan dengan Bulan",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2374",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Pekerjaan.png",title:"Kosakata tentang Pekerjaan/Profesi dalam bahasa Jepang",date:"2023-08-16"},{link:"https://wkwk-japanese.com/?p=2405",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Negara.png",title:"Nama-nama negara dalam bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2398",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Musik.png",title:"Kosakata tentang Musik dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2395",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Orahraga.png",title:"Kosakata tentang Olahraga dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2389",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Hobi.png",title:"Kosakata tentang Hobi dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2382",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Transportasi.png",title:"Kosakata tentang Alat Transportasi dalam Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2435",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Musim.png",title:"Kosakata tentang Musim dalam bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2463",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Hari.png",title:"Kosakata Bahasa Jepang yang Berkaitan dengan Hari",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=2345",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/Makanan.png",title:"Kosakata tentang Makanan dalam bahasa Jepang",date:"2023-08-03"},{link:"https://wkwk-japanese.com/?p=2330",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/1-1.png",title:"Daftar Artikel Tingkat Pemula (N5)",date:"2023-10-23"},{link:"https://wkwk-japanese.com/?p=134",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/14-1-520x300.png",title:"Daftar Kata Kerja Bahasa Jepang N5",date:"2023-09-05"},{link:"https://wkwk-japanese.com/?p=1344",img:"https://wkwk-japanese.com/wp-content/uploads/2022/12/135.png",title:"Tata Bahasa / Pola Kalimat N5 : ~darou | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=953",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/63-3-520x300.png",title:"Kata Keterangan: Takusan, Sukoshi, Amari, Zenzen | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=950",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/64-3-520x300.png",title:"Kata Keterangan: Yoku, Daitai, Sukoshi, Amari, Zenzen | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=947",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/182-1-520x300.png",title:"Kata Bantu Bilangan untuk Bangunan dan Lantai | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=943",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/182.png",title:"Kata Bantu Bilangan untuk Hewan dalam bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=939",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/185.png",title:"Kata Bantu Bilangan untuk Benda dalam bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=936",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/181.png",title:"Kata Bantu Bilangan Orang dalam bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=930",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/180.png",title:"Perubahan Kata Sifat Positif dan Negatif Lampau | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=925",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/179.png",title:"Perubahan Kata Sifat ke Bentuk Negatif | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=916",img:"https://wkwk-japanese.com/wp-content/uploads/2022/11/178.png",title:"Daftar Kata Sifat Bahasa Jepang N5",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=907",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/154.png",title:"Perbedaan  made VS  made ni | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=903",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/158.png",title:"8 Kata Tanya dalam bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=899",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/149.png",title:"Tata Bahasa / Pola Kalimat N5 : ~(ga) kakarimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=892",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/159.png",title:"Kata Tunjuk dalam bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=888",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/175.png",title:"Perbedaan Partikel TO dan YA () & () | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=884",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/166.png",title:"Mengenal Partikel TO | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=881",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/170.png",title:"Mengenal Partikel Yori | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=876",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/177.png",title:"Perbedaan Partikel NE dan YO () & () | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=872",img:"https://wkwk-japanese.com/wp-content/uploads/2022/10/176.png",title:"Perbedaan Partikel E dan NI () & () | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=869",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/174.png",title:"Perbedaan Partikel  WA dan Partikel  GA | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=866",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/173.png",title:"Perbedaan Partikel  NI dan  DE | Bahasa Jepang",date:"2023-10-25"},{link:"https://wkwk-japanese.com/?p=861",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/172.png",title:"Mengenal Partikel NE  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=857",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/171.png",title:"Mengenal Partikel YO  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=853",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/169.png",title:"Mengenal Partikel Made | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=850",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/Thumbnail-Artikel-N5-1056--609-piksel-12-520x300.png",title:"Mengenal Partikel YA  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=841",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/168.png",title:"Mengenal Partikel Kara | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=837",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/64-2-520x300.png",title:"Mengenal Partikel NO  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=833",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/167.png",title:"Mengenal Partikel KA   | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=830",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/165.png",title:"Mengenal Partikel E  | Bahasa Jepang",date:"2023-10-12"},{link:"https://wkwk-japanese.com/?p=826",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/164.png",title:"Mengenal Partikel O  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=823",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/10/163.png",title:"Mengenal Partikel MO  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=817",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/Thumbnail-Artikel-N5-1056--609-piksel-11-520x300.png",title:"Mengenal Partikel GA  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=813",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/162.png",title:"Mengenal Partikel WA  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=792",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/161.png",title:"Mengenal Partikel NI | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=788",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/157.png",title:"Kata Tanya 5W1H dalam bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=784",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/143-1.png",title:"Tata Bahasa / Pola Kalimat N5 : ga kikoemasu / miemasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=781",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/140.png",title:"Tata Bahasa / Pola Kalimat N5 : sugiru  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=778",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/160.png",title:"Mengenal Partikel DE  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=772",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/156.png",title:"Cara Memperkenalkan Diri dalam bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=767",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/155.png",title:"Perbedaan Agemasu dan Kuremasu",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=763",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/153.png",title:"Perbedaan IMASU dan ARIMASU",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=759",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/152.png",title:"Tata Bahasa / Pola Kalimat N5 : Modifikasi Kata Benda dengan Kata Kerja | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=756",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/151.png",title:"Tata Bahasa / Pola Kalimat N5 : (KS + KB) womasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=752",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/150.png",title:"Tata Bahasa / Pola Kalimat N5 : KS + KB desu (Modifikasi KB dengan KS) | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=749",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/148.png",title:"Tata Bahasa / Pola Kalimat N5 : (Jangka Waktu) masu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=745",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/147.png",title:"Tata Bahasa / Pola Kalimat N5 : . Shikashi, | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=742",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/146.png",title:"Tata Bahasa / Pola Kalimat N5 : dake | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=739",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/145.png",title:"Tata Bahasa / Pola Kalimat N5 : demo | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=736",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/144.png",title:"Tata Bahasa / Pola Kalimat N5 : wa, dou desu ka | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=733",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/142.png",title:"Tata Bahasa / Pola Kalimat N5 : no ga heta | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=729",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/141.png",title:"Tata Bahasa / Pola Kalimat N5 : no ga jouzu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=726",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/139.png",title:"Tata Bahasa / Pola Kalimat N5:tsumori da  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=723",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/137.png",title:"Tata Bahasa / Pola Kalimat N5 : kedo/dakedo, | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=715",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/138.png",title:"Tata Bahasa / Pola Kalimat N5 :cha ikenai /ja ikenai | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=712",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/136.png",title:"Tata Bahasa / Pola Kalimat N5 : nakucha | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=708",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/134.png",title:"Tata Bahasa / Pola Kalimat N5 : ~keredomo/keredo, ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=705",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/29.png",title:"Jangka Waktu (Jam, Menit dan Detik) dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=702",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/132.png",title:"Tata Bahasa / Pola Kalimat N5 : nakute wa ikenai | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=698",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/09/133.png",title:"Tata Bahasa / Pola Kalimat N5 : . Demo, | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=694",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/39.png",title:"Kosakata tentang Alam dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=688",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/32.png",title:"Nama-nama Hewan dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=683",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/34.png",title:"Cara Menyatakan dan Menanyakan Umur/Usia dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=676",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/35.png",title:"Kosakata tentang Pakaian dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=672",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/26.png",title:"10 Kata Kerja Memakai dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=668",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/130.png",title:"Tata Bahasa / Pola Kalimat N5 : naide | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=664",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/129.png",title:"Tata Bahasa / Pola Kalimat N5 : wo kudasai | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=661",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/126.png",title:"Tata Bahasa / Pola Kalimat N5 : naito ikemasen | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=658",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/124.png",title:"Tata Bahasa / Pola Kalimat N5 :kata | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=654",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/123.png",title:"Tata Bahasa / Pola Kalimat N5 : no ga suki | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=651",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/121.png",title:"Tata Bahasa / Pola Kalimat N5 : Mada | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=647",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/116.png",title:"Tata Bahasa / Pola Kalimat N5 :toki | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=643",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/114.png",title:"Tata Bahasa / Pola Kalimat N5 : Mada te imasen | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=638",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/112.png",title:"Tata Bahasa / Pola Kalimat N5 : tari, tari shimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=630",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/131.png",title:"Tata Bahasa / Pola Kalimat N5 : nakya ikenai | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=622",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/127.png",title:"Tata Bahasa / Pola Kalimat N5 :yori, hou ga | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=613",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/125.png",title:"Tata Bahasa / Pola Kalimat N5 :node,  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=605",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/122.png",title:"Tata Bahasa / Pola Kalimat N5 : hou ga ii | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=590",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/120.png",title:"Tata Bahasa / Pola Kalimat N5 : dega arimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=585",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/Thumbnail-Artikel-N5-1056--609-piksel-9-520x300.png",title:"Tradisi Musim Panas di Jepang",date:"2023-07-20"},{link:"https://wkwk-japanese.com/?p=582",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/119.png",title:"Tata Bahasa / Pola Kalimat N5 : deshou? | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=579",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/118.png",title:"Tata Bahasa / Pola Kalimat N5 : to,  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=576",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/117.png",title:"Tata Bahasa / Pola Kalimat N5 : te imasu (secara rutin) | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=572",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/115.png",title:"Tata Bahasa / Pola Kalimat N5 : Moumashita | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=569",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/113.png",title:"Tata Bahasa / Pola Kalimat N5 : ku/ni narimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=566",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2023/07/55-2-520x300.png",title:"Tata Bahasa / Pola Kalimat N5 : to iimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=563",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/08/111.png",title:"Tata Bahasa / Pola Kalimat N5 : to omoimasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=560",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/109.png",title:"Tata Bahasa / Pola Kalimat N5: kaka | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=556",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/95.png",title:"Tata Bahasa / Pola Kalimat N5 : KB wo KK transitif | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=553",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/93.png",title:"Tata Bahasa / Pola Kalimat N5 : ta koto ga arimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=550",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/86.png",title:"Tata Bahasa / Pola Kalimat N5 : te wa ikemasen | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=541",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/104.png",title:"Tata Bahasa / Pola Kalimat N5 : kara,  | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=537",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/102.png",title:"Tata Bahasa / Pola Kalimat N5 : ~te ~te ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=534",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/98.png",title:"Tata Bahasa / Pola Kalimat N5 : KB demasu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=531",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/108.png",title:"Tata Bahasa / Pola Kalimat N5: ~ ya ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=527",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/107.png",title:"Tata Bahasa / Pola Kalimat N5 : no naka dega ichibandesu| Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=523",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/106.png",title:"Tata Bahasa / Pola Kalimat N5 : wayoridesu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=519",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/105.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ ga ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=516",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/103.png",title:"Tata Bahasa / Pola Kalimat N5: ~ kute / de | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=511",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/101.png",title:"Tata Bahasa / Pola Kalimat N5: ~ te kara, ~ | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=507",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/100.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ mashou ka | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=503",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/99.png",title:"Tata Bahasa / Pola Kalimat N5 : wago dedesu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=500",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/97.png",title:"Tata Bahasa / Pola Kalimat N5 : KB1 wa KB2 ga KS desu | Bahasa Jepang",date:"2023-10-11"},{link:"https://wkwk-japanese.com/?p=496",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/96.png",title:"Tata Bahasa / Pola Kalimat N5 : KB wa KS deshita/ -katta desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=492",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/94.png",title:"Tata Bahasa N5: Kata Benda de Kata Kerja | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=489",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/07/91.png",title:"Tata Bahasa / Pola Kalimat N5 : no shumi wa~ desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=485",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/92.png",title:"Tata Bahasa / Pola Kalimat N5 : ga dekimasu /koto ga dekimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=482",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/90.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ made ni | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=479",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/89.png",title:"Tata Bahasa / Pola Kalimat N5: ~ nakute mo ii | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=472",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/88.png",title:"Tata Bahasa / Pola Kalimat N5 : agemasu /moraimasu/kuremasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=468",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/87.png",title:"Tata Bahasa / Pola Kalimat N5 : mae ni, | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=463",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/85.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ te mo ii | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=459",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/84.png",title:"Tata Bahasa / Pola Kalimat N5 : nakereba narimasen | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=456",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/83.png",title:"Tata Bahasa / Pola Kalimat N5 :  naide kudasai | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=452",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/82.png",title:"Tata Bahasa / Pola Kalimat N5 : ga tokui / nigate | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=448",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/81.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ ga jouzu / tokui / heta | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=444",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/80.png",title:"Tata Bahasa / Pola Kalimat N5 :  ga suki / ga kirai | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=440",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/33.png",title:"Anggota Tubuh dalam bahasa Jepang | Kosakata dan Ungkapan",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=436",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/31.png",title:"Nama-nama Warna dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=431",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/06/25.png",title:"Jangka Waktu (Tahun, Bulan, Minggu, Hari) dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=428",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/30.png",title:"Kosakata tentang Anggota Keluarga dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=418",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/16.png",title:"Daftar Kata Kerja Bahasa Jepang N5",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=413",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/28.png",title:"Jam, Menit dan Detik dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=408",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/24.png",title:"Nama-nama Bulan dan Penyebutan Tanggal dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=318",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/27.png",title:"Angka dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=313",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/23.png",title:"Nama-nama Hari dan Kata Keterangan Waktu dalam bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=310",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/79.png",title:"Tata Bahasa / Pola Kalimat N5 : KB to KK | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=308",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/78.png",title:"Tata Bahasa / Pola Kalimat N5 : A to B | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=305",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/77.png",title:"Tata Bahasa / Pola Kalimat N5 : eni ikimasu / kimasu / kaerimasu| Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=303",img:"https://wkwk-japanese.com/wp-content/uploads/2022/06/76.png",title:"Tata Bahasa / Pola Kalimat N5 : KB de ikimasu / kimasu / kaerimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=301",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/75.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ kara ~ made KK-masu/desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=299",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/74.png",title:"Tata Bahasa / Pola Kalimat N5 : e ikimasu / kimasu / kaerimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=294",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/73.png",title:"Tata Bahasa / Pola Kalimat N5 : ~ tai desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=290",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/72.png",title:"Tata Bahasa / Pola Kalimat N5 :  ga hoshii | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=288",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/71.png",title:"Tata Bahasa / Pola Kalimat N5 : te imasu (sedang) | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=286",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/22.png",title:"Kata Kerja -MASU, -MASEN, -MASHITA, -MASEN DESHITA",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=282",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/70.png",title:"Tata Bahasa / Pola Kalimat N5 : te kudasai | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=278",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/69.png",title:"Pola Kalimat N5 : KB wa KS dewa arimasen / -kunai desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=275",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/68.png",title:"Tata Bahasa / Pola Kalimat N5 : KB wa KS desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=273",img:"https://cdn.wkwk-japanese.com/wp-content/uploads/2022/05/67.png",title:"Tata Bahasa / Pola Kalimat N5 : mashou | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=271",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/66.png",title:"Tata Bahasa / Pola Kalimat N5 : masen ka | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=269",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/65.png",title:"Tata Bahasa / Pola Kalimat N5 : A ni B | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=267",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/64.png",title:"Tata Bahasa / Pola Kalimat N5 : wani imasu / arimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=264",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/63.png",title:"Tata Bahasa / Pola Kalimat N5 : niga imasu / arimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=254",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/62.png",title:"Tata Bahasa / Pola Kalimat N5 : ga imasu / arimasu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=250",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/61.png",title:"Tata Bahasa / Pola Kalimat N5 : wa kochira / sochira / achira desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=248",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/60.png",title:"Tata Bahasa / Pola Kalimat N5 : wa koko / soko / asoko desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=245",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/59.png",title:"Tata Bahasa / Pola Kalimat N5 : Kono / Sono / Anowadesu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=242",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/58.png",title:"Tata Bahasa / Pola Kalimat N5 : Kore / Sore / Are wadesu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=239",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/57.png",title:"Tata Bahasa / Pola Kalimat N5 : A  B | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=232",img:"https://wkwk-japanese.com/wp-content/uploads/2023/07/62-2-520x300.png",title:"Tata Bahasa / Pola Kalimat N5 : A mo B desu | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=223",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/14.png",title:"Daftar Kanji JLPT N5 | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=210",img:"https://wkwk-japanese.com/wp-content/uploads/2022/05/18.png",title:"Kata Kerja Bentuk Lampau / Bentuk -TA | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=199",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/56.png",title:"Tata Bahasa / Pola Kalimat N5 : A wa B desu ka | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=196",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/55.png",title:"Tata Bahasa / Pola Kalimat N5 : A wa B dewa/ja arimasen | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=183",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/52-1.png",title:"A wa B desu : Tata Bahasa / Pola Kalimat N5 | Bahasa Jepang",date:"2023-10-10"},{link:"https://wkwk-japanese.com/?p=128",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/17.png",title:"Kata Kerja Bentuk Kamus dan Bentuk -MASU | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=120",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/15.png",title:"Pengelompokkan Kata Kerja Bahasa Jepang (Golongan 1, 2 dan 3)",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=113",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/21.png",title:"Perubahan Kata Kerja Bentuk Biasa (Doushi Futsuu-kei) | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=107",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/20.png",title:"Kata Kerja Bentuk Negatif (Bentuk -NAI dan Bentuk -NAKATTA) | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=103",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/19.png",title:"Perubahan Kata Kerja Bentuk  TE | Bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=93",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/11.png",title:"Mengenal Kanji | Huruf bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=74",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/10.png",title:"Tips Menghafal Hiragana dan Katakana dengan Mudah dan Efektif",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=71",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/9.png",title:"Katakana Dakuon, Handakuon, Youon, Sokuon dan Chouon",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=65",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/8.png",title:"Mengenal Katakana | Huruf bahasa Jepang",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=55",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/7.png",title:"Hiragana Dakuon, Handakuon, Youon, Sokuon dan Chouon",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=54",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/6.png",title:"Mengenal Hiragana | Huruf bahasa Jepang",date:"2023-10-25"},{link:"https://wkwk-japanese.com/?p=34",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/5.png",title:"Bahasa Jepang : Sejarah, Sistem Penulisan dan Struktur Kalimat",date:"2023-10-09"},{link:"https://wkwk-japanese.com/?p=14",img:"https://wkwk-japanese.com/wp-content/uploads/2022/04/4.png",title:"Peta Pembelajaran N5/N4",date:"2023-10-09"}],Kj=[{id:1,fact:"Jepang memiliki lebih dari 5 juta mesin penjual otomatis (vending machine) - lebih banyak dari negara manapun di dunia!",icon:"",gradient:"from-blue-500/20 to-purple-500/20"},{id:2,fact:"Di Jepang, ada lebih dari 200 gunung berapi aktif, termasuk Gunung Fuji yang terkenal.",icon:"",gradient:"from-red-500/20 to-orange-500/20"},{id:3,fact:"Jepang memiliki lebih dari 1.500 gempa bumi setiap tahunnya, tapi kebanyakan tidak terasa.",icon:"",gradient:"from-yellow-500/20 to-red-500/20"},{id:4,fact:"Kereta Shinkansen (bullet train) di Jepang memiliki keterlambatan rata-rata hanya 36 detik per tahun!",icon:"",gradient:"from-green-500/20 to-blue-500/20"},{id:5,fact:"Jepang memiliki lebih dari 5.000 pulau, tapi hanya 400 yang berpenghuni.",icon:"",gradient:"from-teal-500/20 to-blue-500/20"},{id:6,fact:"Tokyo adalah kota dengan jumlah restoran bintang Michelin terbanyak di dunia.",icon:"",gradient:"from-purple-500/20 to-pink-500/20"},{id:7,fact:"Sumo adalah olahraga nasional Jepang dan telah ada selama berabad-abad.",icon:"",gradient:"from-orange-500/20 to-yellow-500/20"},{id:8,fact:"Bunga sakura (cherry blossom) adalah simbol nasional Jepang dan melambangkan keindahan dan kefanaan hidup.",icon:"",gradient:"from-pink-500/20 to-red-500/20"},{id:9,fact:"Tidur siang di tempat kerja, yang disebut 'inemuri', dianggap dapat meningkatkan produktivitas di Jepang.",icon:"",gradient:"from-indigo-500/20 to-purple-500/20"},{id:10,fact:"Jepang adalah salah satu negara dengan harapan hidup tertinggi di dunia.",icon:"",gradient:"from-green-500/20 to-teal-500/20"},{id:11,fact:"Ada kafe khusus kucing di Jepang di mana Anda bisa minum kopi sambil bermain dengan kucing.",icon:"",gradient:"from-brown-500/20 to-orange-500/20"},{id:12,fact:"Istana Kekaisaran Tokyo dibangun di atas bekas reruntuhan Kastil Edo.",icon:"",gradient:"from-gray-500/20 to-blue-500/20"},{id:13,fact:"Jepang memiliki tingkat literasi hampir 100%.",icon:"",gradient:"from-blue-500/20 to-indigo-500/20"},{id:14,fact:"Kentut di depan umum dianggap tidak sopan di Jepang.",icon:"",gradient:"from-yellow-500/20 to-green-500/20"},{id:15,fact:"Kit Kat memiliki lebih dari 300 rasa unik di Jepang, termasuk wasabi, sake, dan teh hijau.",icon:"",gradient:"from-red-500/20 to-brown-500/20"},{id:16,fact:"Ada sebuah pulau di Jepang yang dihuni oleh ribuan kelinci liar, bernama Okunoshima.",icon:"",gradient:"from-pink-500/20 to-white-500/20"},{id:17,fact:"Kimono, pakaian tradisional Jepang, berarti 'benda untuk dipakai'.",icon:"",gradient:"from-purple-500/20 to-teal-500/20"},{id:18,fact:"Jepang memiliki salah satu sistem transportasi umum paling efisien dan tepat waktu di dunia.",icon:"",gradient:"from-blue-500/20 to-green-500/20"},{id:19,fact:"Musim semi di Jepang dirayakan dengan festival 'Hanami' (melihat bunga).",icon:"",gradient:"from-orange-500/20 to-pink-500/20"},{id:20,fact:"Orang Jepang sering menyeruput mie saat makan sebagai tanda bahwa mereka menikmati makanan.",icon:"",gradient:"from-yellow-500/20 to-red-500/20"},{id:21,fact:"Manga (komik Jepang) dan Anime (animasi Jepang) sangat populer di seluruh dunia.",icon:"",gradient:"from-blue-500/20 to-purple-500/20"},{id:22,fact:"Jepang adalah negara pertama yang mengembangkan teknologi telepon seluler 3G.",icon:"",gradient:"from-green-500/20 to-blue-500/20"},{id:23,fact:"Ada lebih dari 60.000 perusahaan yang berusia lebih dari 100 tahun di Jepang.",icon:"",gradient:"from-gray-500/20 to-brown-500/20"},{id:24,fact:"Jepang memiliki festival 'Naked Man' di mana pria memakai pakaian minimalis dan berlari di musim dingin.",icon:"",gradient:"from-red-500/20 to-orange-500/20"},{id:25,fact:"Memberi tip tidak umum dan bahkan bisa dianggap tidak sopan di Jepang.",icon:"",gradient:"from-yellow-500/20 to-green-500/20"},{id:26,fact:"Terdapat sebuah kota bernama 'Nagoro' di Jepang yang dihuni oleh lebih banyak boneka daripada manusia.",icon:"",gradient:"from-pink-500/20 to-purple-500/20"},{id:27,fact:"Jepang adalah penemu Karaoke.",icon:"",gradient:"from-blue-500/20 to-teal-500/20"},{id:28,fact:"Sekolah di Jepang tidak memiliki petugas kebersihan; siswa dan guru membersihkan sekolah sendiri.",icon:"",gradient:"from-brown-500/20 to-gray-500/20"},{id:29,fact:"Jepang memiliki 'Pulau Kucing' lain bernama Aoshima, di mana kucing jauh lebih banyak daripada manusia.",icon:"",gradient:"from-black-500/20 to-gray-500/20"},{id:30,fact:"Mata uang Jepang adalah Yen ().",icon:"",gradient:"from-green-500/20 to-yellow-500/20"},{id:31,fact:"Jepang memiliki beberapa 'onsen' (pemandian air panas) yang terkenal.",icon:"",gradient:"from-red-500/20 to-orange-500/20"},{id:32,fact:"Fuku, ikan buntal, adalah makanan lezat yang berbahaya jika tidak disiapkan dengan benar.",icon:"",gradient:"from-blue-500/20 to-green-500/20"},{id:33,fact:"Jepang memiliki hutan bambu yang sangat indah dan terkenal, yaitu Hutan Bambu Arashiyama di Kyoto.",icon:"",gradient:"from-green-500/20 to-teal-500/20"},{id:34,fact:"Boneka Daruma adalah jimat keberuntungan di Jepang.",icon:"",gradient:"from-red-500/20 to-blue-500/20"},{id:35,fact:"Jepang memiliki sebuah 'Pulau Seni' bernama Naoshima, yang dipenuhi dengan museum dan instalasi seni.",icon:"",gradient:"from-purple-500/20 to-pink-500/20"},{id:36,fact:"Kuil Fushimi Inari-taisha di Kyoto terkenal dengan ribuan gerbang torii merah oranye.",icon:"",gradient:"from-orange-500/20 to-red-500/20"},{id:37,fact:"Jepang adalah produsen robot terbesar di dunia.",icon:"",gradient:"from-gray-500/20 to-blue-500/20"},{id:38,fact:"Jepang memiliki kereta api yang melayang menggunakan teknologi maglev (magnetic levitation).",icon:"",gradient:"from-blue-500/20 to-purple-500/20"},{id:39,fact:"Terdapat kuil bernama 'Meiji Jingu' di Tokyo yang didedikasikan untuk Kaisar Meiji dan Permaisuri Shoken.",icon:"",gradient:"from-green-500/20 to-brown-500/20"},{id:40,fact:"Jepang memiliki budaya minum teh yang kaya dan kompleks, disebut 'Chanoyu' atau upacara teh.",icon:"",gradient:"from-teal-500/20 to-green-500/20"},{id:41,fact:"Ada festival salju yang terkenal di Sapporo setiap tahunnya, menampilkan patung-patung es raksasa.",icon:"",gradient:"from-blue-500/20 to-white-500/20"},{id:42,fact:"Jepang adalah salah satu negara dengan tingkat kejahatan terendah di dunia.",icon:"",gradient:"from-black-500/20 to-gray-500/20"},{id:43,fact:"Restoran sushi pertama di dunia dibuka di Jepang.",icon:"",gradient:"from-red-500/20 to-orange-500/20"},{id:44,fact:"Jepang memiliki 'hari libur' untuk menghargai gunung, yaitu Hari Gunung (Mountain Day) pada tanggal 11 Agustus.",icon:"",gradient:"from-brown-500/20 to-green-500/20"},{id:45,fact:"Origami, seni melipat kertas, berasal dari Jepang.",icon:"",gradient:"from-white-500/20 to-pink-500/20"},{id:46,fact:"Ada 'Kuil Tikus' di Jepang yang didedikasikan untuk tikus sebagai dewa kesuburan.",icon:"",gradient:"from-gray-500/20 to-brown-500/20"},{id:47,fact:"Jepang adalah salah satu dari sedikit negara di dunia yang masih memiliki kaisar.",icon:"",gradient:"from-yellow-500/20 to-orange-500/20"},{id:48,fact:"Shinjuku Gyoen National Garden di Tokyo adalah salah satu taman terindah di Jepang.",icon:"",gradient:"from-green-500/20 to-blue-500/20"},{id:49,fact:"Jepang memiliki festival 'Cherry Blossom' yang sangat populer, di mana orang-orang piknik di bawah pohon sakura.",icon:"",gradient:"from-pink-500/20 to-purple-500/20"},{id:50,fact:"Ada sebuah 'Museum Ramen' di Yokohama yang memungkinkan pengunjung untuk menjelajahi sejarah dan variasi ramen.",icon:"",gradient:"from-orange-500/20 to-red-500/20"}],qj=()=>{const[t,e]=X.useState(0),[n,s]=X.useState(!1),a=X.useMemo(()=>[...Kj].sort(()=>.5-Math.random()).slice(0,4),[]);X.useEffect(()=>{if(!n){const o=setInterval(()=>{e(l=>(l+1)%a.length)},5e3);return()=>clearInterval(o)}},[n,a.length]);const r=()=>{e(o=>o===0?a.length-1:o-1)},i=()=>{e(o=>(o+1)%a.length)};return T.jsx("div",{className:"w-full mb-8",children:T.jsx("div",{className:`backdrop-blur-lg bg-white/30 rounded-2xl p-4 sm:p-6 md:p-8 shadow-lg border border-white/20\r
                   hover:shadow-xl transition-all duration-300`,onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),children:T.jsxs("div",{className:"relative overflow-hidden",children:[T.jsx("button",{onClick:r,className:`hidden sm:block absolute left-3 top-1/2 -translate-y-1/2 z-10 p-2 sm:p-3 rounded-full\r
                     bg-white/50 hover:bg-white/80 transition-all duration-300\r
                     shadow-lg hover:shadow-xl border border-white/30\r
                     transform hover:scale-110 active:scale-95`,"aria-label":"Previous fact",children:T.jsx("svg",{className:"w-5 h-5 sm:w-7 sm:h-7 text-surface-900",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),T.jsx("button",{onClick:i,className:`hidden sm:block absolute right-3 top-1/2 -translate-y-1/2 z-10 p-2 sm:p-3 rounded-full\r
                     bg-white/50 hover:bg-white/80 transition-all duration-300\r
                     shadow-lg hover:shadow-xl border border-white/30\r
                     transform hover:scale-110 active:scale-95`,"aria-label":"Next fact",children:T.jsx("svg",{className:"w-5 h-5 sm:w-7 sm:h-7 text-surface-900",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),T.jsx("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:`translateX(-${t*100}%)`},children:a.map(o=>T.jsxs("div",{className:`w-full flex-shrink-0 flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-6 md:gap-8 p-4 sm:p-6 md:p-8
                           bg-gradient-to-r ${o.gradient} rounded-xl min-h-[180px] sm:min-h-[200px]`,children:[T.jsx("div",{className:`flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-full\r
                              bg-white/50 backdrop-blur-sm shadow-lg border border-white/30\r
                              transform transition-transform duration-300 hover:scale-110`,children:T.jsx("span",{className:"text-4xl sm:text-5xl",children:o.icon})}),T.jsx("p",{className:"text-base sm:text-lg md:text-xl text-surface-900 font-medium max-w-2xl leading-relaxed text-center sm:text-left",children:o.fact})]},o.id))}),T.jsx("div",{className:"flex justify-center gap-2 sm:gap-3 mt-4 sm:mt-6 md:mt-8",children:a.map((o,l)=>T.jsx("button",{onClick:()=>e(l),className:`h-2 sm:h-2.5 rounded-full transition-all duration-300 ${l===t?"bg-primary-600 w-8 sm:w-10":"bg-surface-300 w-2 sm:w-2.5 hover:bg-surface-400"}`,"aria-label":`Go to fact ${l+1}`},l))}),T.jsxs("div",{className:"sm:hidden flex justify-between mt-4",children:[T.jsx("button",{onClick:r,className:`px-4 py-2 bg-white/50 rounded-xl border border-white/30\r
                       hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                       active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                       transition-all duration-300 text-surface-900 font-medium`,children:"Sebelumnya"}),T.jsx("button",{onClick:i,className:`px-4 py-2 bg-white/50 rounded-xl border border-white/30\r
                       hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                       active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                       transition-all duration-300 text-surface-900 font-medium`,children:"Selanjutnya"})]})]})})})},Jj=()=>{ai();const[t,e]=X.useState(""),n=()=>{const h=window.innerWidth;return h<768?4:h<1024?6:9},[s,a]=X.useState(()=>{const h=sessionStorage.getItem("visibleItems");return h?parseInt(h,10):n()}),[r,i]=X.useState(()=>{const h=window.innerWidth;return h<768?"mobile":h<1024?"tablet":"desktop"});X.useEffect(()=>{const h=sessionStorage.getItem("scrollPos");if(h){const f=parseInt(h,10);if(!isNaN(f)){let g=setTimeout(()=>{requestAnimationFrame(()=>{window.scrollTo(0,f)})},10);return()=>clearTimeout(g)}}},[]),X.useEffect(()=>{const h=()=>{sessionStorage.removeItem("visibleItems"),sessionStorage.removeItem("scrollPos")};return window.addEventListener("beforeunload",h),()=>window.removeEventListener("beforeunload",h)},[]),X.useEffect(()=>{const h=()=>{const f=window.innerWidth;let g,y;f<768?(g="mobile",y=4):f<1024?(g="tablet",y=6):(g="desktop",y=9),i(g),a(y),sessionStorage.setItem("visibleItems",y.toString())};return window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]);const o=X.useMemo(()=>{const h=t.toLowerCase();return Object.entries(Ki).filter(([f,g])=>g.japanese.toLowerCase().includes(h)||g.romaji.toLowerCase().includes(h)||g.indonesian.toLowerCase().includes(h))},[t]),l=()=>{a(h=>{let f;switch(r){case"mobile":f=4;break;case"tablet":f=6;break;case"desktop":default:f=9;break}const g=h+f;return sessionStorage.setItem("visibleItems",g.toString()),g})},u=o.slice(0,s),c=s<o.length,d=vw.slice(0,2),p=()=>{sessionStorage.setItem("visibleItems",s.toString()),sessionStorage.setItem("scrollPos",window.scrollY.toString())};return T.jsxs("main",{className:"container mx-auto px-4 py-8",children:[T.jsx(qj,{}),T.jsxs("div",{className:"w-full mb-12 pt-4",children:[" ",T.jsx("div",{className:"backdrop-blur-lg bg-white/30 rounded-2xl p-6 shadow-lg border border-white/20",children:T.jsxs("div",{className:"relative",children:[T.jsx("input",{type:"text",placeholder:"Cari kosakata bahasa Jepang...",value:t,onChange:h=>e(h.target.value),className:"w-full px-4 py-3 pl-12 rounded-xl border border-surface-200 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),T.jsx(Vj,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-surface-400",size:20})]})})]}),T.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:u.map(([h,f])=>T.jsxs(Ys,{to:`/benda/${h}`,state:{from:"homePage"},onClick:p,className:"group bg-white/50 rounded-xl overflow-hidden transition-all duration-300 hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0 border border-white/30",children:[T.jsx("div",{className:"aspect-video overflow-hidden",children:T.jsx("img",{src:f.imageUrl,alt:f.indonesian,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),T.jsxs("div",{className:"p-4",children:[T.jsxs("h3",{className:"text-lg font-semibold text-surface-900 mb-2",children:[f.japanese," (",f.indonesian,")"]}),T.jsx("p",{className:"text-surface-600 mb-1",children:f.romaji})]})]},h))}),c&&T.jsx("div",{className:"flex justify-center",children:T.jsxs("button",{onClick:l,className:"group relative inline-flex items-center gap-2 px-8 py-3.5 bg-gradient-to-r from-primary-500 to-primary-600 rounded-xl text-white font-medium overflow-hidden transition-all duration-300 hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:translate-y-0",children:[T.jsx("span",{className:"relative z-10",children:"Lihat Lebih Banyak"}),T.jsx("svg",{className:"w-5 h-5 relative z-10 transition-transform duration-300 group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),T.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary-600 to-primary-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]})}),T.jsxs("div",{className:"backdrop-blur-lg bg-white/30 rounded-2xl p-6 shadow-lg border border-white/20 mt-12",children:[T.jsxs("div",{className:"flex justify-between items-center mb-6",children:[T.jsxs("div",{className:"flex items-center gap-4",children:[T.jsx("h2",{className:"hidden md:block text-2xl font-bold text-surface-900",children:"Belajar Bersama"}),T.jsx("img",{src:"https://wkwk-japanese.com/wp-content/uploads/2022/12/logo_wkwkjapanese.png",alt:"WKWK Japanese Logo",className:"h-8 w-auto"}),T.jsx("span",{className:"hidden md:block text-lg font-medium text-surface-900",children:"WKWK JAPANESE"})]}),T.jsx(Ys,{to:"/artikel",className:"px-4 py-2 bg-white/50 rounded-xl border border-white/30 hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0 transition-all duration-300 text-surface-900 font-medium",children:"Lihat Artikel"})]}),T.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:d.map((h,f)=>T.jsxs("a",{href:h.link,target:"_blank",rel:"noopener noreferrer",className:"group bg-white/50 rounded-xl overflow-hidden transition-all duration-300 hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1 active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0 border border-white/30",children:[T.jsx("div",{className:"aspect-video overflow-hidden",children:T.jsx("img",{src:h.img,alt:h.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),T.jsxs("div",{className:"p-4",children:[T.jsx("h3",{className:"text-lg font-semibold text-surface-900 mb-2 line-clamp-2",children:h.title}),T.jsx("p",{className:"text-surface-500 text-sm",children:new Date(h.date).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})})]})]},f))})]})]})},Xj=()=>T.jsx("main",{className:"container mx-auto px-4 py-8",children:T.jsxs("div",{className:"max-w-3xl mx-auto space-y-8",children:[T.jsxs("div",{className:"neu-card p-8",children:[T.jsx("h1",{className:"text-3xl font-bold text-surface-900 mb-6",children:"Tentang NihonMe"}),T.jsx("p",{className:"text-surface-600 leading-relaxed",children:"NihonMe adalah aplikasi pembelajaran bahasa Jepang yang menggunakan teknologi AI untuk membantu pengguna mempelajari kosakata bahasa Jepang melalui deteksi objek. Aplikasi ini dirancang untuk membuat pembelajaran bahasa Jepang lebih interaktif dan menyenangkan."})]}),T.jsxs("div",{className:"neu-card p-8",children:[T.jsx("h2",{className:"text-2xl font-bold text-surface-900 mb-4",children:"Teknologi yang Digunakan"}),T.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[T.jsxs("div",{className:"space-y-2",children:[T.jsx("h3",{className:"font-semibold text-surface-800",children:"Frontend"}),T.jsxs("ul",{className:"list-disc list-inside text-surface-600",children:[T.jsx("li",{children:"React 18"}),T.jsx("li",{children:"TypeScript"}),T.jsx("li",{children:"Tailwind CSS"}),T.jsx("li",{children:"Vite"}),T.jsx("li",{children:"React Router DOM"})]})]}),T.jsxs("div",{className:"space-y-2",children:[T.jsx("h3",{className:"font-semibold text-surface-800",children:"AI & Machine Learning"}),T.jsxs("ul",{className:"list-disc list-inside text-surface-600",children:[T.jsx("li",{children:"TensorFlow.js"}),T.jsx("li",{children:"COCO-SSD model"})]})]})]})]}),T.jsxs("div",{className:"neu-card p-8",children:[T.jsx("h2",{className:"text-2xl font-bold text-surface-900 mb-6",children:"Tentang Pengembang"}),T.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[T.jsx("div",{className:"w-48 h-48 rounded-full overflow-hidden",children:T.jsx("img",{src:"https://media.licdn.com/dms/image/v2/D5603AQEkQs8ABe_Ipg/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1709478662180?e=1752710400&v=beta&t=CFmIEshJQ2ImGw8HUWRBe4wxRoIEJoc8_EVKhBFU_BI",alt:"Foto Pengembang",className:"w-full h-full object-cover"})}),T.jsxs("div",{className:"flex-1 space-y-4",children:[T.jsxs("div",{children:[T.jsx("h3",{className:"text-xl font-semibold text-surface-800",children:"Arindra Rifky Saputra"}),T.jsx("p",{className:"text-surface-600",children:"Mahasiswa Program Studi Pendidikan Bahasa Jepang UNNES"})]}),T.jsx("p",{className:"text-surface-600",children:"Seorang mahasiswa yang bersemangat dalam mengembangkan aplikasi web untuk pengenalan kosakata benda dalam bahasa Jepang, yang dirancang khusus untuk pembelajar pemula. Saya bertujuan untuk mengintegrasikan teknologi AI object detection guna menciptakan pengalaman belajar yang sangat visual dan interaktif. Melalui aplikasi ini, pengguna dapat dengan mudah mengarahkan kamera pada objek di sekitar mereka, dan AI akan membantu mengidentifikasi serta menyajikan kosakata bahasa Jepang yang relevan, sehingga proses belajar menjadi lebih menarik, kontekstual, dan efektif dalam meningkatkan keinginan belajar siswa."}),T.jsxs("div",{className:"flex gap-4",children:[T.jsx("a",{href:"https://github.com/rifkydelta",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700",children:"GitHub"}),T.jsx("a",{href:"https://linkedin.com/in/rifkydelta",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-700",children:"LinkedIn"})]})]})]})]})]})}),Yj=({mode:t,onModeChange:e,modelLoaded:n})=>T.jsxs("div",{className:"flex w-full gap-2",children:[T.jsxs("button",{onClick:()=>e("webcam"),disabled:!n,className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl transition-all ${t==="webcam"?"bg-primary-500 text-white shadow-lg":"bg-surface-100 text-surface-700 shadow-neu"} ${n?"":"opacity-50 cursor-not-allowed"}`,children:[T.jsx(qI,{size:20}),T.jsx("span",{children:"Webcam"})]}),T.jsxs("button",{onClick:()=>e("upload"),disabled:!n,className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl transition-all ${t==="upload"?"bg-primary-500 text-white shadow-lg":"bg-surface-100 text-surface-700 shadow-neu"} ${n?"":"opacity-50 cursor-not-allowed"}`,children:[T.jsx(kw,{size:20}),T.jsx("span",{children:"Upload"})]})]});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qj=1e-7,Zj=1e-4;class yx{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class ym{refCount(e){return Bn("refCount")}incRef(e){return Bn("incRef")}timerAvailable(){return!0}time(e){return Bn("time")}read(e){return Bn("read")}readSync(e){return Bn("readSync")}readToGPU(e,n){return Bn("readToGPU")}numDataIds(){return Bn("numDataIds")}disposeData(e,n){return Bn("disposeData")}write(e,n,s){return Bn("write")}move(e,n,s,a,r){return Bn("move")}createTensorFromGPUData(e,n,s){return Bn("createTensorFromGPUData")}memory(){return Bn("memory")}floatPrecision(){return Bn("floatPrecision")}epsilon(){return this.floatPrecision()===32?Qj:Zj}dispose(){return Bn("dispose")}}function Bn(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wx(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,Ba(t,e,n)}function eP(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,s=0;for(;n>0;)s=Math.random()*n|0,n--,Ba(t,n,s),Ba(e,n,s)}function Mr(t,e,n){return Math.max(t,Math.min(e,n))}function wm(t){return t%2===0?t:t+1}function Ba(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function JI(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function tP(t,e){const n=Math.random();return e*n+(1-n)*t}function nP(t,e){let n=0;for(let s=0;s<t.length;s++){const a=Number(t[s])-Number(e[s]);n+=a*a}return n}function C(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function en(t,e,n=""){C(Re(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function fo(t){C(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function H(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function sP(t){return t.length===0}function XI(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function Re(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function qi(t){return t%1===0}function aP(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function vf(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function rP(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return wx(e),e}function Pi(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Sw(t,e=a=>0,n,s){return new Promise((a,r)=>{let i=0;const o=()=>{if(t()){a();return}i++;const l=e(i);if(n!=null&&i>=n){r();return}s!=null?s(o,l):setTimeout(o,l)};o()})}function bx(t,e){let n=1,s=-1;for(let r=0;r<t.length;++r)if(t[r]>=0)n*=t[r];else if(t[r]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${r}`);s=r}else if(t[r]<0)throw Error(`Shapes can not be < 0. Found ${t[r]} at dim ${r}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const a=t.slice();return a[s]=e/n,a}function Ee(t,e){const n=e.length;return t=t==null?e.map((s,a)=>a):[].concat(t),C(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),C(t.every(s=>qi(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function nr(t,e){const n=[],s=[],a=e!=null&&Array.isArray(e)&&e.length===0,r=e==null||a?null:Ee(e,t).sort();let i=0;for(let o=0;o<t.length;++o){if(r!=null){if(r[i]===o&&t[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${t[o]}' is not 1`);(r[i]==null||r[i]>o)&&t[o]===1&&(n.push(t[o]),s.push(o)),r[i]<=o&&i++}t[o]!==1&&(n.push(t[o]),s.push(o))}return{newShape:n,keptDims:s}}function Wt(t,e){return gt(t,e)}function gt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function YI(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function QI(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function xx(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Vc(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function ZI(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function ga(t){return typeof t=="string"||t instanceof String}function e$(t){return typeof t=="boolean"}function Sf(t){return typeof t=="number"}function mo(t){return Array.isArray(t)?mo(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Sf(t)?"float32":ga(t)?"string":e$(t)?"bool":"float32"}function Vr(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Nf(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function ye(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function t$(t,e,n,s=!1){const a=new Array;if(e.length===1){const r=e[0]*(s?2:1);for(let i=0;i<r;i++)a[i]=n[t+i]}else{const r=e[0],i=e.slice(1),o=i.reduce((l,u)=>l*u)*(s?2:1);for(let l=0;l<r;l++)a[l]=t$(t+l*o,i,n,s)}return a}function cs(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((a,r)=>a*r)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return t$(0,t,e,n)}function n$(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function bm(t,e){const n=Zt(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Zt(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function kx(t,e){const n=t.reduce((s,a)=>s*a,1);if(e==null||e==="float32")return cs(t,new Float32Array(n));if(e==="int32")return cs(t,new Int32Array(n));if(e==="bool")return cs(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function es(t){t.forEach(e=>{C(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Qs(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let a=0;a<t.length-1;++a)s+=n[a]*t[a];return s}function go(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let a=0;a<s.length-1;++a)s[a]=Math.floor(t/n[a]),t-=s[a]*n[a];return s[s.length-1]=t,s}function Wr(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P2="tfjsflags";class s${constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=iP,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(V().getBool("IS_TEST")||V().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const a=this.urlFlags[e];V().getBool("IS_TEST")||V().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${a}.`),this.set(e,a)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Wr(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);P2 in e&&e[P2].split(",").forEach(s=>{const[a,r]=s.split(":");this.urlFlags[a]=lP(a,r)})}}function iP(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(oP(e,s[0],s[1]),s.join("="))),e}function oP(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function lP(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function V(){return vx}let vx=null;function uP(t){vx=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let oy;function a$(){if(oy==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");oy=t}return oy}function cP(){const t=a$();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Sx(t,e){const n=cP();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const fd="Abs",Rl="Acos",Dl="Acosh",yo="Add",md="AddN",xm="All",km="Any",gd="ArgMax",yd="ArgMin",_l="Asin",Ol="Asinh",Fl="Atan",jl="Atanh",Pl="Atan2",wd="AvgPool",vm="AvgPoolGrad",bd="AvgPool3D",Sm="AvgPool3DGrad",xd="BatchMatMul",kd="BatchToSpaceND",Nm="Bincount",vd="BitwiseAnd",r$="BroadcastTo",Cm="BroadcastArgs",Ll="Cast",zl="Ceil",Bl="ClipByValue",Im="Complex",Sd="ComplexAbs",Nd="Concat",Cd="Conv2D",$m="Conv2DBackpropFilter",Id="Conv2DBackpropInput",$d="Conv3D",Tm="Conv3DBackpropFilterV2",Em="Conv3DBackpropInputV2",Ml="Cos",Vl="Cosh",Am="Cumprod",Td="Cumsum",Rm="CropAndResize",Dm="DenseBincount",_m="DepthToSpace",Ed="DepthwiseConv2dNative",Om="DepthwiseConv2dNativeBackpropFilter",Fm="DepthwiseConv2dNativeBackpropInput",jm="Diag",Ad="Dilation2D",Cf="Dilation2DBackpropInput",If="Dilation2DBackpropFilter",Pm="Draw",Wl="RealDiv",Lm="Einsum",Ul="Elu",zm="EluGrad",Gl="Erf",Rd="Equal",Hl="Exp",Dd="ExpandDims",Kl="Expm1",Bm="FFT",Mm="Fill",Vm="FlipLeftRight",ql="Floor",Jl="FloorDiv",_d="FusedBatchNorm",Od="GatherV2",Wm="GatherNd",Fd="Greater",Xl="GreaterEqual",Yl="Identity",Um="IFFT",Gm="Imag",Ql="IsFinite",Zl="IsInf",eu="IsNan",jd="LeakyRelu",Pd="Less",Ld="LessEqual",Hm="LinSpace",tu="Log",nu="Log1p",zd="LogicalAnd",Bd="LogicalNot",Md="LogicalOr",dP="LogicalXor",i$="LogSoftmax",pP="LowerBound",Vd="LRN",Km="LRNGrad",hP="MatrixBandPart",Wd="Max",su="Maximum",Ud="MaxPool",qm="MaxPoolGrad",Gd="MaxPool3D",Jm="MaxPool3DGrad",Xm="MaxPoolWithArgmax",Hd="Mean",Kd="Min",au="Minimum",qd="MirrorPad",ru="Mod",Ym="Multinomial",iu="Multiply",Jd="Neg",Xd="NotEqual",Qm="NonMaxSuppressionV3",Zm="NonMaxSuppressionV4",eg="NonMaxSuppressionV5",Yd="OnesLike",Qd="OneHot",Zd="Pack",ep="PadV2",fP="Pool",ou="Pow",tp="Prelu",np="Prod",tg="RaggedGather",ng="RaggedRange",sg="RaggedTensorToTensor",ag="Range",rg="Real",lu="Reciprocal",uu="Relu",sp="Reshape",ap="ResizeNearestNeighbor",ig="ResizeNearestNeighborGrad",rp="ResizeBilinear",og="ResizeBilinearGrad",cu="Relu6",ip="Reverse",du="Round",pu="Rsqrt",lg="ScatterNd",ug="TensorScatterUpdate",cg="SearchSorted",op="Select",hu="Selu",lp="Slice",fu="Sin",mu="Sinh",gu="Sign",yu="Sigmoid",wu="Softplus",bu="Sqrt",up="Sum",cp="SpaceToBatchND",dp="SplitV",pp="Softmax",dg="SparseFillEmptyRows",pg="SparseReshape",hg="SparseSegmentMean",fg="SparseSegmentSum",mg="SparseToDense",xu="SquaredDifference",gg="Square",hp="StaticRegexReplace",yg="StridedSlice",wg="StringNGrams",bg="StringSplit",xg="StringToHashBucketFast",ku="Sub",vu="Tan",Su="Tanh",Nu="Tile",kg="TopK",vg="Transform",Li="Transpose",Sg="Unique",fp="Unpack",mp="UnsortedSegmentSum",mP="UpperBound",gp="ZerosLike",Cu="Step",$f="FromPixels",Ng="RotateWithOffset",Wc="_FusedMatMul",Uc="FusedConv2D",Gc="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function as(...t){V().getBool("IS_TEST")||V().getBool("PROD")||console.warn(...t)}function gP(...t){V().getBool("IS_TEST")||V().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hl=Sx("kernelRegistry",()=>new Map),Hc=Sx("gradRegistry",()=>new Map);function Kc(t,e){const n=Nx(t,e);return hl.get(n)}function Nw(t){return Hc.get(t)}function Tf(t){const e=hl.entries(),n=[];for(;;){const{done:s,value:a}=e.next();if(s)break;const[r,i]=a,[o]=r.split("_");o===t&&n.push(i)}return n}function Cg(t){const{kernelName:e,backendName:n}=t,s=Nx(e,n);hl.has(s)&&as(`The kernel '${e}' for backend '${n}' is already registered`),hl.set(s,t)}function o$(t){const{kernelName:e}=t;Hc.has(e)&&V().getBool("DEBUG")&&as(`Overriding the gradient for '${e}'`),Hc.set(e,t)}function yP(t,e){const n=Nx(t,e);if(!hl.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);hl.delete(n)}function wP(t){if(!Hc.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);Hc.delete(t)}function bP(t,e){Tf(t).forEach(s=>{const a=Object.assign({},s,{backendName:e});Cg(a)})}function Nx(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l$(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var u$=et,Cs=null;try{Cs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function et(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}et.prototype.__isLong__;Object.defineProperty(et.prototype,"__isLong__",{value:!0});function ts(t){return(t&&t.__isLong__)===!0}et.isLong=ts;var L2={},z2={};function wo(t,e){var n,s,a;return e?(t>>>=0,(a=0<=t&&t<256)&&(s=z2[t],s)?s:(n=tt(t,(t|0)<0?-1:0,!0),a&&(z2[t]=n),n)):(t|=0,(a=-128<=t&&t<128)&&(s=L2[t],s)?s:(n=tt(t,t<0?-1:0,!1),a&&(L2[t]=n),n))}et.fromInt=wo;function Is(t,e){if(isNaN(t))return e?Di:$s;if(e){if(t<0)return Di;if(t>=c$)return h$}else{if(t<=-M2)return Hn;if(t+1>=M2)return p$}return t<0?Is(-t,e).neg():tt(t%fl|0,t/fl|0,e)}et.fromNumber=Is;function tt(t,e,n){return new et(t,e,n)}et.fromBits=tt;var Ef=Math.pow;function Cx(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return $s;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return Cx(t.substring(1),e,n).neg();for(var a=Is(Ef(n,8)),r=$s,i=0;i<t.length;i+=8){var o=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+o),n);if(o<8){var u=Is(Ef(n,o));r=r.mul(u).add(Is(l))}else r=r.mul(a),r=r.add(Is(l))}return r.unsigned=e,r}et.fromString=Cx;function ia(t,e){return typeof t=="number"?Is(t,e):typeof t=="string"?Cx(t,e):tt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}et.fromValue=ia;var B2=65536,xP=1<<24,fl=B2*B2,c$=fl*fl,M2=c$/2,V2=wo(xP),$s=wo(0);et.ZERO=$s;var Di=wo(0,!0);et.UZERO=Di;var qo=wo(1);et.ONE=qo;var d$=wo(1,!0);et.UONE=d$;var Cw=wo(-1);et.NEG_ONE=Cw;var p$=tt(-1,2147483647,!1);et.MAX_VALUE=p$;var h$=tt(-1,-1,!0);et.MAX_UNSIGNED_VALUE=h$;var Hn=tt(0,-2147483648,!1);et.MIN_VALUE=Hn;var oe=et.prototype;oe.toInt=function(){return this.unsigned?this.low>>>0:this.low};oe.toNumber=function(){return this.unsigned?(this.high>>>0)*fl+(this.low>>>0):this.high*fl+(this.low>>>0)};oe.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Hn)){var n=Is(e),s=this.div(n),a=s.mul(n).sub(this);return s.toString(e)+a.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var r=Is(Ef(e,6),this.unsigned),i=this,o="";;){var l=i.div(r),u=i.sub(l.mul(r)).toInt()>>>0,c=u.toString(e);if(i=l,i.isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}};oe.getHighBits=function(){return this.high};oe.getHighBitsUnsigned=function(){return this.high>>>0};oe.getLowBits=function(){return this.low};oe.getLowBitsUnsigned=function(){return this.low>>>0};oe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Hn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};oe.isZero=function(){return this.high===0&&this.low===0};oe.eqz=oe.isZero;oe.isNegative=function(){return!this.unsigned&&this.high<0};oe.isPositive=function(){return this.unsigned||this.high>=0};oe.isOdd=function(){return(this.low&1)===1};oe.isEven=function(){return(this.low&1)===0};oe.equals=function(e){return ts(e)||(e=ia(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};oe.eq=oe.equals;oe.notEquals=function(e){return!this.eq(e)};oe.neq=oe.notEquals;oe.ne=oe.notEquals;oe.lessThan=function(e){return this.comp(e)<0};oe.lt=oe.lessThan;oe.lessThanOrEqual=function(e){return this.comp(e)<=0};oe.lte=oe.lessThanOrEqual;oe.le=oe.lessThanOrEqual;oe.greaterThan=function(e){return this.comp(e)>0};oe.gt=oe.greaterThan;oe.greaterThanOrEqual=function(e){return this.comp(e)>=0};oe.gte=oe.greaterThanOrEqual;oe.ge=oe.greaterThanOrEqual;oe.compare=function(e){if(ts(e)||(e=ia(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};oe.comp=oe.compare;oe.negate=function(){return!this.unsigned&&this.eq(Hn)?Hn:this.not().add(qo)};oe.neg=oe.negate;oe.add=function(e){ts(e)||(e=ia(e));var n=this.high>>>16,s=this.high&65535,a=this.low>>>16,r=this.low&65535,i=e.high>>>16,o=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,p=0,h=0;return h+=r+u,p+=h>>>16,h&=65535,p+=a+l,d+=p>>>16,p&=65535,d+=s+o,c+=d>>>16,d&=65535,c+=n+i,c&=65535,tt(p<<16|h,c<<16|d,this.unsigned)};oe.subtract=function(e){return ts(e)||(e=ia(e)),this.add(e.neg())};oe.sub=oe.subtract;oe.multiply=function(e){if(this.isZero())return $s;if(ts(e)||(e=ia(e)),Cs){var n=Cs.mul(this.low,this.high,e.low,e.high);return tt(n,Cs.get_high(),this.unsigned)}if(e.isZero())return $s;if(this.eq(Hn))return e.isOdd()?Hn:$s;if(e.eq(Hn))return this.isOdd()?Hn:$s;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(V2)&&e.lt(V2))return Is(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,a=this.high&65535,r=this.low>>>16,i=this.low&65535,o=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,p=0,h=0,f=0;return f+=i*c,h+=f>>>16,f&=65535,h+=r*c,p+=h>>>16,h&=65535,h+=i*u,p+=h>>>16,h&=65535,p+=a*c,d+=p>>>16,p&=65535,p+=r*u,d+=p>>>16,p&=65535,p+=i*l,d+=p>>>16,p&=65535,d+=s*c+a*u+r*l+i*o,d&=65535,tt(h<<16|f,d<<16|p,this.unsigned)};oe.mul=oe.multiply;oe.divide=function(e){if(ts(e)||(e=ia(e)),e.isZero())throw Error("division by zero");if(Cs){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Cs.div_u:Cs.div_s)(this.low,this.high,e.low,e.high);return tt(n,Cs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Di:$s;var s,a,r;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Di;if(e.gt(this.shru(1)))return d$;r=Di}else{if(this.eq(Hn)){if(e.eq(qo)||e.eq(Cw))return Hn;if(e.eq(Hn))return qo;var i=this.shr(1);return s=i.div(e).shl(1),s.eq($s)?e.isNegative()?qo:Cw:(a=this.sub(e.mul(s)),r=s.add(a.div(e)),r)}else if(e.eq(Hn))return this.unsigned?Di:$s;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=$s}for(a=this;a.gte(e);){s=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(s)/Math.LN2),l=o<=48?1:Ef(2,o-48),u=Is(s),c=u.mul(e);c.isNegative()||c.gt(a);)s-=l,u=Is(s,this.unsigned),c=u.mul(e);u.isZero()&&(u=qo),r=r.add(u),a=a.sub(c)}return r};oe.div=oe.divide;oe.modulo=function(e){if(ts(e)||(e=ia(e)),Cs){var n=(this.unsigned?Cs.rem_u:Cs.rem_s)(this.low,this.high,e.low,e.high);return tt(n,Cs.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};oe.mod=oe.modulo;oe.rem=oe.modulo;oe.not=function(){return tt(~this.low,~this.high,this.unsigned)};oe.and=function(e){return ts(e)||(e=ia(e)),tt(this.low&e.low,this.high&e.high,this.unsigned)};oe.or=function(e){return ts(e)||(e=ia(e)),tt(this.low|e.low,this.high|e.high,this.unsigned)};oe.xor=function(e){return ts(e)||(e=ia(e)),tt(this.low^e.low,this.high^e.high,this.unsigned)};oe.shiftLeft=function(e){return ts(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?tt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):tt(0,this.low<<e-32,this.unsigned)};oe.shl=oe.shiftLeft;oe.shiftRight=function(e){return ts(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?tt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):tt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};oe.shr=oe.shiftRight;oe.shiftRightUnsigned=function(e){if(ts(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return tt(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?tt(n,0,this.unsigned):tt(n>>>e-32,0,this.unsigned)};oe.shru=oe.shiftRightUnsigned;oe.shr_u=oe.shiftRightUnsigned;oe.toSigned=function(){return this.unsigned?tt(this.low,this.high,!1):this};oe.toUnsigned=function(){return this.unsigned?this:tt(this.low,this.high,!0)};oe.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};oe.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};oe.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};et.fromBytes=function(e,n,s){return s?et.fromBytesLE(e,n):et.fromBytesBE(e,n)};et.fromBytesLE=function(e,n){return new et(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};et.fromBytesBE=function(e,n){return new et(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const f$=vN(u$),kP=kN({__proto__:null,default:f$},[u$]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ni=f$||kP;function yp(t){return Ni.fromString(t,!0,16)}const m$=yp("c3a5c85c97cb3127"),vi=yp("b492b66fbe98f273"),wn=yp("9ae16a3b2f90404f");function Iw(t){return t.xor(t.shru(47))}function g$(t,e,n){const s=t.slice(e,e+n);return Ni.fromBytes(Array.from(s),!0,!0)}function Xe(t,e){return g$(t,e,8)}function W2(t,e){return g$(t,e,4)}function zt(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function jr(t,e,n=yp("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let a=e.xor(s).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function vP(t,e,n,s,a,r){a=a.add(t),r=zt(r.add(a).add(s),21);const i=a;return a=a.add(e),a=a.add(n),r=r.add(zt(a,44)),[a.add(s),r.add(i)]}function wh(t,e,n,s){return vP(Xe(t,e),Xe(t,e+8),Xe(t,e+16),Xe(t,e+24),n,s)}function SP(t,e=t.length){if(e>=8){const n=wn.add(e*2),s=Xe(t,0).add(wn),a=Xe(t,e-8),r=zt(a,37).mul(n).add(s),i=zt(s,25).add(a).mul(n);return jr(r,i,n)}if(e>=4){const n=wn.add(e*2),s=W2(t,0);return jr(s.shl(3).add(e),W2(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],a=t[e-1],r=n+(s<<8),i=e+(a<<2);return Iw(wn.mul(r).xor(m$.mul(i))).mul(wn)}return wn}function NP(t,e=t.length){const n=wn.add(e*2),s=Xe(t,0).mul(vi),a=Xe(t,8),r=Xe(t,e-8).mul(n),i=Xe(t,e-16).mul(wn);return jr(zt(s.add(a),43).add(zt(r,30)).add(i),s.add(zt(a.add(wn),18)).add(r),n)}function CP(t,e=t.length){const n=wn.add(e*2),s=Xe(t,0).mul(wn),a=Xe(t,8),r=Xe(t,e-8).mul(n),i=Xe(t,e-16).mul(wn),o=zt(s.add(a),43).add(zt(r,30)).add(i),l=jr(o,s.add(zt(a.add(wn),18)).add(r),n),u=Xe(t,16).mul(n),c=Xe(t,24),d=o.add(Xe(t,e-32)).mul(n),p=l.add(Xe(t,e-24)).mul(n);return jr(zt(u.add(c),43).add(zt(d,30)).add(p),u.add(zt(c.add(s),18)).add(d),n)}function y$(t,e=t.length){const n=Ni.fromNumber(81,!0);if(e<=32)return e<=16?SP(t,e):NP(t,e);if(e<=64)return CP(t,e);let s=n,a=n.mul(vi).add(113),r=Iw(a.mul(wn).add(113)).mul(wn),i=[Ni.UZERO,Ni.UZERO],o=[Ni.UZERO,Ni.UZERO];s=s.mul(wn).add(Xe(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do s=zt(s.add(a).add(i[0]).add(Xe(t,l+8)),37).mul(vi),a=zt(a.add(i[1]).add(Xe(t,l+48)),42).mul(vi),s=s.xor(o[1]),a=a.add(i[0]).add(Xe(t,l+40)),r=zt(r.add(o[0]),33).mul(vi),i=wh(t,l,i[1].mul(vi),s.add(o[0])),o=wh(t,l+32,r.add(o[1]),a.add(Xe(t,l+16))),[r,s]=[s,r],l+=64;while(l!==u);const d=vi.add(r.and(255).shl(1));return l=c,o[0]=o[0].add(e-1&63),i[0]=i[0].add(o[0]),o[0]=o[0].add(i[0]),s=zt(s.add(a).add(i[0]).add(Xe(t,l+8)),37).mul(d),a=zt(a.add(i[1]).add(Xe(t,l+48)),42).mul(d),s=s.xor(o[1].mul(9)),a=a.add(i[0].mul(9).add(Xe(t,l+40))),r=zt(r.add(o[0]),33).mul(d),i=wh(t,l,i[1].mul(d),s.add(o[0])),o=wh(t,l+32,r.add(o[1]),a.add(Xe(t,l+16))),[r,s]=[s,r],jr(jr(i[0],o[0],d).add(Iw(a).mul(m$)).add(r),jr(i[1],o[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sr(t,e){return e==="string"?xa(t):ri([t],e)}function IP(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function ri(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Ca(t)),V().getBool("DEBUG")&&YI(t,e),IP(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function mn(){return V().platform.now()}function $P(t,e){return V().platform.fetch(t,e)}function xa(t,e="utf-8"){return e=e||"utf-8",V().platform.encode(t,e)}function Xa(t,e="utf-8"){return e=e||"utf-8",V().platform.decode(t,e)}function Bt(t){return V().platform.isTypedArray!=null?V().platform.isTypedArray(t):l$(t)}function Ca(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Wr(t)||t==null||Bt(t)&&n)e.push(t);else if(Array.isArray(t)||Bt(t))for(let s=0;s<t.length;++s)Ca(t[s],e,n);else{let s=-1;for(const a of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(a)&&(s=Math.max(s,Number(a)));for(let a=0;a<=s;a++)Ca(t[a],e,n)}return e}const TP=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Re,arraysEqualWithNull:XI,assert:C,assertNonNegativeIntegerDimensions:es,assertNonNull:fo,assertShapesMatch:en,bytesFromStringArray:ZI,bytesPerElement:Vc,checkConversionForErrors:YI,clamp:Mr,computeStrides:ye,convertBackendValuesAndArrayBuffer:n$,createScalarValue:sr,createShuffledIndices:rP,decodeString:Xa,distSquared:nP,encodeString:xa,fetch:$P,fingerPrint64:y$,flatten:Ca,getArrayFromDType:gt,getTypedArrayFromDType:Wt,hasEncodingLoss:xx,hexToLong:yp,indexToLoc:go,inferDtype:mo,inferFromImplicitShape:bx,isBoolean:e$,isFunction:Vr,isInt:qi,isNumber:Sf,isPromise:Wr,isScalarShape:sP,isString:ga,isTypedArray:Bt,isValidDtype:QI,locToIndex:Qs,makeOnesTypedArray:bm,makeZerosNestedTypedArray:kx,makeZerosTypedArray:Zt,nearestDivisor:Nf,nearestLargerEven:wm,now:mn,parseAxisParam:Ee,randUniform:tP,repeatedTry:Sw,rightPad:Pi,shuffle:wx,shuffleCombo:eP,sizeFromShape:H,sizeToSquarishShape:vf,squeezeShape:nr,sum:JI,swap:Ba,tanh:aP,toNestedArray:cs,toTypedArray:ri},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EP{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new RP)}profileKernel(e,n,s){let a;const r=()=>{a=s()};let i;const o=mn();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(r);else{r();for(const u of a)u.dataSync();i=Promise.resolve({kernelMs:mn()-o})}if(V().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<a.length;u++){const c=a[u];c.data().then(d=>{AP(d,c.dtype,e)})}return{kernelName:e,outputs:a,inputs:n,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:a,inputs:r,extraInfo:i}=e;s.forEach(o=>{Promise.all([o.data(),a,i]).then(l=>{this.logger.logKernelProfile(n,o,l[0],l[1],r,l[2])})})}}function AP(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const a=t[s];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${n}'`),!0}return!1}class RP{logKernelProfile(e,n,s,a,r,i){const o=typeof a=="number"?Pi(`${a}ms`,9):a.error,l=Pi(e,25),u=n.rank,c=n.size,d=Pi(n.shape.toString(),14);let p="";for(const h in r){const f=r[h];if(f!=null){const g=f.shape||n.shape,y=g.length;p+=`${h}: ${y}D ${y>0?g:""} `}}console.log(`%c${l}	%c${o}	%c${u}D ${d}	%c${c}	%c${p}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DP(t,e,n){const s={},a={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const p=c[d];let h=!1;for(let f=0;f<e.length;f++)if(s[p.id]){u.outputs.forEach(g=>s[g.id]=!0),h=!0,a[u.id]=!0;break}if(h)break}}const r={};r[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(r[u.outputs[d].id]){for(const p in c)r[c[p].id]=!0,i[u.id]=!0;break}}const o=[];for(let l=0;l<t.length;l++){const u=t[l];if(a[u.id]&&i[u.id]){const c={};for(const p in u.inputs){const h=u.inputs[p];s[h.id]&&(c[p]=h)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,o.push(d)}}return o}function _P(t,e,n,s){for(let a=e.length-1;a>=0;a--){const r=e[a],i=[];if(r.outputs.forEach(l=>{const u=t[l.id];u!=null?i.push(u):i.push(null)}),r.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${r.kernelName}.`);const o=r.gradient(i);for(const l in r.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const u=n(()=>o[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=r.inputs[l];if(!Re(u.shape,c.shape))throw new Error(`Error in gradient for op ${r.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=s(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U2=20,Yu=3,ly=7;function OP(t,e,n,s){const a=ye(e),r=FP(t,e,n,a),i=e.length,o=Gh(t,e,n,a,r),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(u=>"    "+u).join(`
`)),l.join(`
`)}function FP(t,e,n,s){const a=H(e),r=s[s.length-1],i=new Array(r).fill(0),o=e.length,l=n==="complex64"?ic(t):t;if(o>1)for(let u=0;u<a/r;u++){const c=u*r;for(let d=0;d<r;d++)i[d]=Math.max(i[d],rc(l[c+d],0,n).length)}return i}function rc(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(ly))} + ${parseFloat(t[1].toFixed(ly))}j`:ga(t)?s=`'${t}'`:n==="bool"?s=w$(t):s=parseFloat(t.toFixed(ly)).toString(),Pi(s,e)}function w$(t){return t===0?"false":"true"}function Gh(t,e,n,s,a,r=!0){const i=n==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=ic(t);return[rc(g[0],0,n)]}return n==="bool"?[w$(t[0])]:[t[0].toString()]}if(l===1){if(o>U2){const y=Yu*i;let m=Array.from(t.slice(0,y)),w=Array.from(t.slice((o-Yu)*i,o*i));return n==="complex64"&&(m=ic(m),w=ic(w)),["["+m.map((b,x)=>rc(b,a[x],n)).join(", ")+", ..., "+w.map((b,x)=>rc(b,a[o-Yu+x],n)).join(", ")+"]"]}return["["+(n==="complex64"?ic(t):Array.from(t)).map((y,m)=>rc(y,a[m],n)).join(", ")+"]"]}const u=e.slice(1),c=s.slice(1),d=s[0]*i,p=[];if(o>U2){for(let g=0;g<Yu;g++){const y=g*d,m=y+d;p.push(...Gh(t.slice(y,m),u,n,c,a,!1))}p.push("...");for(let g=o-Yu;g<o;g++){const y=g*d,m=y+d;p.push(...Gh(t.slice(y,m),u,n,c,a,g===o-1))}}else for(let g=0;g<o;g++){const y=g*d,m=y+d;p.push(...Gh(t.slice(y,m),u,n,c,a,g===o-1))}const h=l===2?",":"";p[0]="["+(o>0?p[0]+h:"");for(let g=1;g<p.length-1;g++)p[g]=" "+p[g]+h;let f=`,
`;for(let g=2;g<l;g++)f+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(r?"":f),p}function ic(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tt{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=H(e),s!=null){const a=s.length;C(a===this.size,()=>`Length of values '${a}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||gt(n,this.size),this.strides=ye(e)}set(e,...n){n.length===0&&(n=[0]),C(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const a of e){if(a<0||a>=this.shape[n]){const r=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(r)}n++}let s=e[e.length-1];for(let a=0;a<e.length-1;++a)s+=this.strides[a]*e[a];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Hs().makeTensor(this.values,this.shape,this.dtype)}}let Hs=null,Oo=null;function jP(t){Hs=t}function PP(t){Oo=t}class ze{constructor(e,n,s,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=H(e),this.strides=ye(e),this.dataId=s,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Oo.buffer(this.shape,this.dtype,e)}bufferSync(){return Oo.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return cs(this.shape,e,this.dtype==="complex64")}arraySync(){return cs(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Hs().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>Xa(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Hs().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Hs().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Xa(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Hs().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Hs().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Oo.print(this,e)}clone(){return this.throwIfDisposed(),Oo.clone(this)}toString(e=!1){const n=this.dataSync();return OP(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Oo.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),Hs().makeVariable(this,e,n,s)}}Object.defineProperty(ze,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function q(){return Sx("Tensor",()=>ze)}q();class qc extends ze{constructor(e,n,s,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Re(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Hs().disposeTensor(this),this.dataId=e.dataId,Hs().incRef(this,null)}dispose(){Hs().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(qc,Symbol.hasInstance,{value:t=>t instanceof ze&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var $w;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})($w||($w={}));var Tw;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Tw||(Tw={}));var Ew;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Ew||(Ew={}));var Aw;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Aw||(Aw={}));var Rw;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Rw||(Rw={}));const LP={float32:Aw,int32:Tw,bool:Ew,complex64:Rw};function Rn(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return LP[t][e]}function Ig(t){return Rn(t,"int32")}function b$(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function x$(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pt(t,e){if(t.dtype===e.dtype)return[t,e];const n=Rn(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function k$(t,e){C(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function zP(t,e){return e.some(n=>n.id===t.id)}function Ix(t){const e=[];return v$(t,e,new Set),e}function v$(t,e,n){if(t==null)return;if(t instanceof ze){e.push(t);return}if(!BP(t))return;const s=t;for(const a in s){const r=s[a];n.has(r)||(n.add(r),v$(r,e,n))}}function BP(t){return Array.isArray(t)||typeof t=="object"}const MP=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:k$,getTensorsInContainer:Ix,isTensorInList:zP,makeTypesMatch:pt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uy(t){return t.kernelName!=null}class G2{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class ml{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new G2}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(as(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new EP(this.backendInstance),!0}setupRegisteredKernels(){Tf(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Tf(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof ym)&&typeof s.then=="function"){const a=++this.pendingBackendInitId,r=s.then(i=>a<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,as(`Initialization of backend ${e} failed`),as(i.stack||i.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return as(`Initialization of backend ${e} failed`),as(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:a,asyncInit:r}=this.initializeBackend(s);if(r||a)return{name:s,asyncInit:r}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),a=s.backend,r=this.readSync(n),i=a.refCount(n);a.disposeData(n,!0),s.backend=e,e.move(n,r,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let a;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(a),()=>(a=n(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(e,n,s){e();try{const a=s();return n(),a}catch(a){throw n(),a}}nextTensorId(){return ml.nextTensorId++}nextVariableId(){return ml.nextVariableId++}clone(e){const n=R.runKernel(Yl,{x:e}),s={x:e},a=i=>({x:()=>{const o="float32",l={x:i},u={dtype:o};return R.runKernel(Ll,l,u)}}),r=[];return this.addTapeNode(this.state.activeScope.name,s,[n],a,r,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(Kc(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const a=this.backend.numDataIds();let r=0;s.forEach(l=>{r+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=a-n-r-i;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const a=this.isTapeOn(),r=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const u=uy(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(uy(e)){const{kernelName:f,inputs:g,attrs:y}=e;this.backendName==null&&this.backend;const m=Kc(f,this.backendName);C(m!=null,()=>`Cannot find registered kernel '${f}' for backend '${this.backendName}'`),o=()=>{const w=this.backend.numDataIds();l=m.kernelFunc({inputs:g,attrs:y,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(f,w,b);const x=b.map(v=>v.rank!=null?v:this.makeTensorFromTensorInfo(v));if(a){const v=this.getTensorsForGradient(f,g,x);s=this.saveTensorsForBackwardMode(v)}return x}}else{const{forwardFunc:f}=e,g=y=>{a&&(s=y.map(m=>this.keep(this.clone(m))))};o=()=>{const y=this.backend.numDataIds();l=this.tidy(()=>f(this.backend,g));const m=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,y,m),m}}const{inputs:c,attrs:d}=e,p=uy(e)?null:e.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=o():(h=this.profiler.profileKernel(u,c,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),a&&this.addTapeNode(u,c,n,p,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-r,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(f=>c[f]!=null?c[f].shape:null),outputShapes:n.map(f=>f.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const a=Nw(e);if(a!=null){const r=a.inputsToSave||[],i=a.outputsToSave||[];let o;a.saveAllInputs?(C(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(n).map(u=>n[u])):o=r.map(u=>n[u]);const l=s.filter((u,c)=>i[c]);return o.concat(l)}return[]}makeTensor(e,n,s,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",a=a||this.backend;let r=e;s==="string"&&ga(e[0])&&(r=e.map(l=>xa(l)));const i=a.write(r,n,s),o=new ze(n,s,i,this.nextTensorId());if(this.trackTensor(o,a),s==="string"){const l=this.state.tensorInfo.get(i),u=ZI(r);this.state.numBytes+=u-l.bytes,l.bytes=u}return o}makeTensorFromDataId(e,n,s,a){s=s||"float32";const r={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(r,a)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:a,dtype:r}=e,i=new ze(a,r,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,s,a){s=s||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.cast(a));const r=new qc(e,n,s,this.nextTensorId());if(this.state.registeredVariables[r.name]!=null)throw new Error(`Variable with name ${r.name} was already registered`);return this.state.registeredVariables[r.name]=r,this.incRef(r,this.backend),r}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*Vc(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof qc||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*Vc(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,a,r,i){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:r},l=Nw(e);l!=null&&(a=l.gradFunc),a!=null&&(o.gradient=u=>(u=u.map((c,d)=>{if(c==null){const p=s[d],h=Zt(p.size,p.dtype);return this.makeTensor(h,p.shape,p.dtype)}return c}),a(u.length>1?u:u[0],r,i))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=Ix(e),s=new Set(n.map(r=>r.id));for(let r=0;r<this.state.activeScope.track.length;r++){const i=this.state.activeScope.track[r];!i.kept&&!s.has(i.id)&&i.dispose()}const a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(r=>{!r.kept&&r.scopeId===a.id&&this.track(r)})}gradients(e,n,s,a=!1){if(C(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const r=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));C(r instanceof ze,()=>"The result y returned by f() must be a tensor.");const i=DP(this.state.activeTape,n,r);if(!a&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[r.id]=s??VP(r.shape),_P(o,i,u=>this.tidy(u),WP);const l=n.map(u=>o[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:r,grads:l}})}customGrad(e){return C(Vr(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{C(n.every(o=>o instanceof ze),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const a={};n.forEach((o,l)=>{a[l]=o});const r=(o,l)=>(s=e(...n,l),C(s.value instanceof ze,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),C(Vr(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(o,l)=>{const u=s.gradFunc(o,l),c=Array.isArray(u)?u:[u];C(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),C(c.every(p=>p instanceof ze),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((p,h)=>{d[h]=()=>p}),d};return this.runKernelFunc({forwardFunc:r,backwardsFunc:i,inputs:a})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=mn(),s=await this.backend.time(e);return s.wallMs=mn()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new G2;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}ml.nextTensorId=0;ml.nextVariableId=0;function VP(t){const e=bm(H(t),"float32");return R.makeTensor(e,t,"float32")}function S$(){const t=a$();if(t._tfengine==null){const e=new s$(t);t._tfengine=new ml(e)}return uP(t._tfengine.ENV),jP(()=>t._tfengine),t._tfengine}const R=S$();function WP(t,e){const n={a:t,b:e};return R.runKernel(yo,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UP(){return typeof navigator<"u"&&navigator!=null}let Dw;function GP(t){Dw=t}function $x(t){if(Dw!==void 0)return Dw;if(t||UP()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function Tx(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const HP=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:Tx,isMobile:$x,mockIsMobile:GP},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dn=V();Dn.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Dn.registerFlag("IS_BROWSER",()=>Tx());Dn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Dn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Dn.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Dn.registerFlag("PROD",()=>!1);Dn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Dn.getBool("DEBUG"));Dn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Dn.registerFlag("IS_TEST",()=>!1);Dn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Dn.getBool("DEBUG"));Dn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Dn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Dn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ia(t,e){let n=t;if(Bt(t))return e==="string"?[]:[t.length];if(b$(t)){const a=t.channels||"RGBA";return[t.height,t.width*a.length]}else if(x$(t))return[t.buffer.size/(e==null?4:Vc(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||Bt(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&V().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&N$(t,s,[]),s}function N$(t,e,n){if(n=n||[],!Array.isArray(t)&&!Bt(t)){C(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}C(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),C(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let a=0;a<t.length;++a)N$(t[a],s,n.concat(a))}function H2(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function I(t,e,n,s="numeric"){if(t instanceof q())return H2(s,t.dtype,e,n),t;let a=mo(t);if(a!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(a=s),H2(s,a,e,n),t==null||!Bt(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const r=Ia(t,a);!Bt(t)&&!Array.isArray(t)&&(t=[t]);const o=a!=="string"?ri(t,a):Ca(t,[],!0);return R.makeTensor(o,r,a)}function Jc(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((r,i)=>I(r,`${e}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ex="__op";function D(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Ex;const a=(...r)=>{R.startScope(n);try{const i=s(...r);return Wr(i)&&console.error("Cannot return a Promise inside of tidy."),R.endScope(i),i}catch(i){throw R.endScope(null),i}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KP(t,e){const n=I(t,"real","complex"),s=I(e,"imag","complex");en(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const a={real:n,imag:s};return R.runKernel(Im,a)}const Ya=D({complex_:KP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ii(t,e,n,s){if(s==null)s=mo(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(x$(t)||b$(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return R.backend.createTensorFromGPUData(t,e||n,s)}if(!Bt(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){es(e);const a=H(e),r=H(n);C(a===r,()=>`Based on the provided shape, [${e}], the tensor should have ${a} values but has ${r}`);for(let i=0;i<n.length;++i){const o=n[i],l=i===n.length-1?o!==H(e.slice(i)):!0;C(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Bt(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?ri(t,s):Ca(t,[],!0),R.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rs(t,e,n){const s=Ia(t,n);return ii(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ji={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class oa{static join(e){return new oa(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>Bt(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const a=e[s];s!==e.length-1&&a.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const r=n+a.byteLength;this.shards.push({buffer:a,start:n,end:r}),n=r}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const a=n-e,r=new ArrayBuffer(a),i=new Uint8Array(r);let o=0;for(let l=s;l<this.shards.length;l++){const u=this.shards[l],d=e+o-u.start,p=o,f=Math.min(n,u.end)-u.start,g=new Uint8Array(u.buffer,d,f-d);if(i.set(g,p),o+=g.length,n<u.end)break}return r}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(a){return e<a.start?-1:e>=a.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=qP(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function qP(t,e){let n=0,s=t.length;for(;n<=s;){const a=Math.floor((s-n)/2)+n,r=e(t[a]);if(r===0)return a;r<0?s=a:n=a+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JP(){V().set("PROD",!0)}function XP(){V().set("DEBUG",!0)}function YP(){V().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function QP(t){V().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function ZP(){R.disposeVariables()}function Ws(){return R}function _w(){return R.memory()}function eL(t){return R.profile(t)}function B(t,e){return R.tidy(t,e)}function Te(t){Ix(t).forEach(n=>n.dispose())}function Rt(t){return R.keep(t)}function tL(t){return R.time(t)}function nL(t){return R.setBackend(t)}function C$(){return R.ready()}function I$(){return R.backendName}function sL(t){R.removeBackend(t)}function aL(t){return R.findBackend(t)}function rL(t){return R.findBackendFactory(t)}function Ax(t,e,n=1){return R.registerBackend(t,e,n)}function Rx(){return R.backend}function iL(t,e){V().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ur=4;async function Ow(t,e){const n=[],s=[],a=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<a.length;++i){const o=a[i],l=Array.isArray(t)?t[i].tensor:t[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const u={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const p=await l.bytes(),h=p.reduce((y,m)=>y+m.length,0)+Ur*p.length,f=new Uint8Array(h);let g=0;for(let y=0;y<p.length;y++){const m=p[y],w=new Uint8Array(new Uint32Array([m.length]).buffer);f.set(w,g),g+=Ur,f.set(m,g),g+=m.length}d(f)});s.push(c)}else s.push(l.data());e!=null&&(u.group=e),n.push(u)}const r=await Promise.all(s);return{data:uL(r),specs:n}}function $$(t,e){const n=new oa(t),s={};let a=0;for(const r of e){const i=oL(r,(o,l)=>n.slice(a+o,a+l));s[r.name]=T$(r,n.slice(a,a+i)),a+=i}return s}function oL(t,e){const n=H(t.shape);let s;if("quantization"in t){const a=t.quantization;s=Ji[a.dtype]}else if(t.dtype==="string"){let a=0;for(let r=0;r<n;r++)a+=Ur+new Uint32Array(e(a,a+Ur))[0];return a}else s=Ji[t.dtype];return n*s}async function lL(t,e){const n=H(t.shape);let s;if("quantization"in t){const a=t.quantization;s=Ji[a.dtype]}else if(t.dtype==="string"){let a=0;for(let r=0;r<n;r++)a+=Ur+new Uint32Array(await e(a,a+Ur))[0];return a}else s=Ji[t.dtype];return n*s}function T$(t,e){const n=t.name,s=t.dtype,a=t.shape,r=H(a);let i,o=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=Ji[l.dtype],c=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(c.length);for(let d=0;d<c.length;d++){const p=c[d];i[d]=p*l.scale+l.min}}else if(l.dtype==="float16")i=mL()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(c.length);for(let d=0;d<c.length;d++){const p=c[d];i[d]=Math.round(p*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);o+=r*u}else if(s==="string"){const l=H(t.shape);i=[];for(let u=0;u<l;u++){const c=new Uint32Array(e.slice(o,o+Ur))[0];o+=Ur;const d=new Uint8Array(e.slice(o,o+c));i.push(d),o+=c}}else{const l=Ji[s];if(s==="float32")i=new Float32Array(e);else if(s==="int32")i=new Int32Array(e);else if(s==="bool")i=new Uint8Array(e);else if(s==="complex64"){i=new Float32Array(e);const u=new Float32Array(i.length/2),c=new Float32Array(i.length/2);for(let f=0;f<u.length;f++)u[f]=i[f*2],c[f]=i[f*2+1];const d=Rs(u,a,"float32"),p=Rs(c,a,"float32"),h=Ya(d,p);return d.dispose(),p.dispose(),h}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);o+=r*l}return Rs(i,a,s)}async function K2(t,e,n){let s=new Uint8Array(e);for(;s.byteLength<n;){const{done:a,value:r}=await t.read();if(a&&r==null){const o=n-s.byteLength;throw new Error(`Reader is done but ${o} bytes are still expected`)}const i=new Uint8Array(s.length+r.byteLength);i.set(s,0),i.set(new Uint8Array(r),s.length),s=i}return s.buffer}async function E$(t,e){const n={},s=t.getReader();let a=new ArrayBuffer(0);for(const r of e){const i=await lL(r,async(u,c)=>(a=await K2(s,a,c),a.slice(u,c)));a=await K2(s,a,i);const o=a.slice(0,i);a=a.slice(i);const l=T$(r,o);if(n[r.name]=l,I$()==="webgpu"){const u=Rx();"uploadToGPU"in u&&H(l.shape)>=V().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function uL(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(r=>{if(e+=r.byteLength,n.push(r.byteLength===r.buffer.byteLength?r:new r.constructor(r)),!(r instanceof Float32Array||r instanceof Int32Array||r instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${r.constructor.name}`)});const s=new Uint8Array(e);let a=0;return n.forEach(r=>{s.set(new Uint8Array(r.buffer),a),a+=r.byteLength}),s.buffer}const Dx=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function q2(t){return Dx?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function cL(t){if(Dx)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,a=e.length;s<a;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function dL(t){if(Dx){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function A$(t){return oa.join(t)}function J2(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function R$(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function _x(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function Ox(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),_x(t,n,s)}function wp(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:q2(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:q2(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new oa(t.weightData).byteLength}}function Af(t){const e=[];for(const n of t)e.push(...n.weights);return e}function pL(){const t=n=>{let s=n<<13,a=0;for(;!(s&8388608);)a-=8388608,s<<=1;return s&=-8388609,a+=947912704,s|a},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function hL(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function fL(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function mL(){const t=pL(),e=hL(),n=fL();return s=>{const a=new ArrayBuffer(4*s.length),r=new Uint32Array(a);for(let i=0;i<s.length;i++){const o=s[i],l=t[n[o>>10]+(o&1023)]+e[o>>10];r[i]=l}return new Float32Array(a)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return lt.instance==null&&(lt.instance=new lt),lt.instance}static registerSaveRouter(e){lt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){lt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return lt.getHandlers(e,"save")}static getLoadHandlers(e,n){return lt.getHandlers(e,"load",n)}static getHandlers(e,n,s){const a=[];return(n==="load"?lt.getInstance().loadRouters:lt.getInstance().saveRouters).forEach(i=>{const o=i(e,s);o!==null&&a.push(o)}),a}}const gL=t=>lt.registerSaveRouter(t),yL=t=>lt.registerLoadRouter(t),D$=t=>lt.getSaveHandlers(t),wL=(t,e)=>lt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fw="tensorflowjs",jw=1,_i="models_store",Nr="model_info_store";function _$(){if(!V().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Pw(t){const e=t.result;e.createObjectStore(_i,{keyPath:"modelPath"}),e.createObjectStore(Nr,{keyPath:"modelPath"})}class Xi{constructor(e){if(this.indexedDB=_$(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,a)=>{const r=this.indexedDB.open(Fw,jw);r.onupgradeneeded=()=>Pw(r),r.onsuccess=()=>{const i=r.result;if(n==null){const o=i.transaction(_i,"readonly"),u=o.objectStore(_i).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),a(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=c=>(i.close(),a(u.error)),o.oncomplete=()=>i.close()}else{n.weightData=oa.join(n.weightData);const o=wp(n),l=i.transaction(Nr,"readwrite");let u=l.objectStore(Nr),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(p){return a(p)}let d;c.onsuccess=()=>{d=i.transaction(_i,"readwrite");const p=d.objectStore(_i);let h;try{h=p.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:o})}catch(f){return a(f)}h.onsuccess=()=>s({modelArtifactsInfo:o}),h.onerror=f=>{u=l.objectStore(Nr);const g=u.delete(this.modelPath);g.onsuccess=()=>(i.close(),a(h.error)),g.onerror=y=>(i.close(),a(h.error))}},c.onerror=p=>(i.close(),a(c.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},r.onerror=i=>a(r.error)})}}Xi.URL_SCHEME="indexeddb://";const O$=t=>V().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Xi.URL_SCHEME)?bL(t.slice(Xi.URL_SCHEME.length)):null;lt.registerSaveRouter(O$);lt.registerLoadRouter(O$);function bL(t){return new Xi(t)}function xL(t){return t.startsWith(Xi.URL_SCHEME)?t.slice(Xi.URL_SCHEME.length):t}class kL{constructor(){this.indexedDB=_$()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(Fw,jw);s.onupgradeneeded=()=>Pw(s),s.onsuccess=()=>{const a=s.result,r=a.transaction(Nr,"readonly"),o=r.objectStore(Nr).getAll();o.onsuccess=()=>{const l={};for(const u of o.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},o.onerror=l=>(a.close(),n(o.error)),r.oncomplete=()=>a.close()},s.onerror=a=>n(s.error)})}async removeModel(e){return e=xL(e),new Promise((n,s)=>{const a=this.indexedDB.open(Fw,jw);a.onupgradeneeded=()=>Pw(a),a.onsuccess=()=>{const r=a.result,i=r.transaction(Nr,"readwrite"),o=i.objectStore(Nr),l=o.get(e);let u;l.onsuccess=()=>{if(l.result==null)return r.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=o.delete(e),d=()=>{u=r.transaction(_i,"readwrite");const h=u.objectStore(_i).delete(e);h.onsuccess=()=>n(l.result.modelArtifactsInfo),h.onerror=f=>s(l.error)};c.onsuccess=d,c.onerror=p=>(d(),r.close(),s(l.error))}},l.onerror=c=>(r.close(),s(l.error)),i.oncomplete=()=>{u==null?r.close():u.oncomplete=()=>r.close()}},a.onerror=r=>s(a.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ma="/",Fo="tensorflowjs_models",F$="info",vL="model_topology",SL="weight_specs",NL="weight_data",CL="model_metadata";function j$(t){return{info:[Fo,t,F$].join(Ma),topology:[Fo,t,vL].join(Ma),weightSpecs:[Fo,t,SL].join(Ma),weightData:[Fo,t,NL].join(Ma),modelMetadata:[Fo,t,CL].join(Ma)}}function P$(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function IL(t){const e=t.split(Ma);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Ma)}function $L(t){return t.startsWith(Yi.URL_SCHEME)?t.slice(Yi.URL_SCHEME.length):t}class Yi{constructor(e){if(!V().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=j$(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),a=wp(e),r=oa.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,cL(r));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:a}}catch{throw P$(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${a.modelTopologyBytes}, weightSpecsBytes=${a.weightSpecsBytes}, weightDataBytes=${a.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(a==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=a;const r=this.LS.getItem(this.keys.modelMetadata);if(r!=null){const o=JSON.parse(r);n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,o.signature!=null&&(n.signature=o.signature),o.userDefinedMetadata!=null&&(n.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(n.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(n.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(n.trainingConfig=o.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=dL(i),n}}Yi.URL_SCHEME="localstorage://";const L$=t=>V().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Yi.URL_SCHEME)?TL(t.slice(Yi.URL_SCHEME.length)):null;lt.registerSaveRouter(L$);lt.registerLoadRouter(L$);function TL(t){return new Yi(t)}class EL{constructor(){C(V().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),C(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Fo+Ma,s=Ma+F$;for(let a=0;a<this.LS.length;++a){const r=this.LS.key(a);if(r.startsWith(n)&&r.endsWith(s)){const i=IL(r);e[i]=JSON.parse(this.LS.getItem(r))}}return e}async removeModel(e){e=$L(e);const n=j$(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return P$(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tl="://";class gn{constructor(){this.managers={}}static getInstance(){return gn.instance==null&&(gn.instance=new gn),gn.instance}static registerManager(e,n){C(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(tl)&&(e=e.slice(0,e.indexOf(tl))),C(e.length>0,()=>"scheme must not be an empty string.");const s=gn.getInstance();C(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=gn.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(gn.getInstance().managers)}}function Hh(t){if(t.indexOf(tl)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${gn.getSchemes().join(",")}`);return{scheme:t.split(tl)[0],path:t.split(tl)[1]}}async function z$(t,e,n=!1){C(t!==e,()=>`Old path and new path are the same: '${t}'`);const s=lt.getLoadHandlers(t);C(s.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),C(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${t}.`);const a=s[0],r=lt.getSaveHandlers(e);C(r.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),C(r.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const i=r[0],o=Hh(t).scheme,l=Hh(t).path,u=o===Hh(t).scheme,c=await a.load();n&&u&&await gn.getManager(o).removeModel(l);const d=await i.save(c);return n&&!u&&await gn.getManager(o).removeModel(l),d.modelArtifactsInfo}async function AL(){const t=gn.getSchemes(),e={};for(const n of t){const s=await gn.getManager(n).listModels();for(const a in s){const r=n+tl+a;e[r]=s[a]}}return e}async function RL(t){const e=Hh(t);return gn.getManager(e.scheme).removeModel(e.path)}async function DL(t,e){return z$(t,e,!1)}async function _L(t,e){return z$(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OL{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!V().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const a=this.functionRefs[s.data.index];a(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return l$(e)}}if(V().get("IS_BROWSER")){V().setPlatform("browser",new OL);try{gn.registerManager(Yi.URL_SCHEME,new EL)}catch{}try{gn.registerManager(Xi.URL_SCHEME,new kL)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FL={importFetch:()=>require("node-fetch")};let cy;class jL{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return V().global.fetch!=null?V().global.fetch(e,n):(cy==null&&(cy=FL.importFetch()),cy(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}V().get("IS_NODE")&&!V().get("IS_BROWSER")&&V().setPlatform("node",new jL);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Se(t,e="float32",n){return e=e||"float32",es(t),new Tt(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PL(t,e){const n=I(t,"x","cast");if(!QI(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},a={dtype:e};return R.runKernel(Ll,s,a)}const re=D({cast_:PL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LL(t){const n={x:I(t,"x","clone","string_or_numeric")};return R.runKernel(Yl,n)}const ka=D({clone_:LL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fx(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */S$();const zL={buffer:Se,cast:re,clone:ka,print:Fx};PP(zL);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BL(t,e){let n=I(t,"a","add"),s=I(e,"b","add");[n,s]=pt(n,s);const a={a:n,b:s};return R.runKernel(yo,a)}const Z=D({add_:BL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ML(t,e){let n=I(t,"a","floorDiv"),s=I(e,"b","floorDiv");[n,s]=pt(n,s);const a={a:n,b:s};return R.runKernel(Jl,a)}const $g=D({floorDiv_:ML});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VL(t,e){let n=I(t,"a","div"),s=I(e,"b","div");if([n,s]=pt(n,s),n.dtype==="int32"&&s.dtype==="int32")return $g(n,s);const a={a:n,b:s},r={};return R.runKernel(Wl,a,r)}const ge=D({div_:VL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WL(t,e){let n=I(t,"a","mul"),s=I(e,"b","mul");[n,s]=pt(n,s);const a={a:n,b:s};return R.runKernel(iu,a)}const _=D({mul_:WL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UL(t){const e=I(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return R.runKernel(Sd,n)}else{const n={x:e};return R.runKernel(fd,n)}}const Ct=D({abs_:UL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GL(t){const n={x:I(t,"x","acos")};return R.runKernel(Rl,n)}const jx=D({acos_:GL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HL(t){const n={x:I(t,"x","acosh")};return R.runKernel(Dl,n)}const Px=D({acosh_:HL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KL(t){C(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),C(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((a,r)=>I(a,`tensors${r}`,"addN")),n=e[0];e.forEach(a=>{if(a.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(a=>{if(!Re(a.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return R.runKernel(md,s)}const B$=D({addN_:KL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(t,e=null,n=!1){const a={x:I(t,"x","all","bool")},r={axis:e,keepDims:n};return R.runKernel(xm,a,r)}const Tg=D({all_:qL});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JL(t,e=null,n=!1){const a={x:I(t,"x","any","bool")},r={axis:e,keepDims:n};return R.runKernel(km,a,r)}const Xc=D({any_:JL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XL(t,e=0){const s={x:I(t,"x","argMax")},a={axis:e};return R.runKernel(gd,s,a)}const Qi=D({argMax_:XL});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YL(t,e=0){const s={x:I(t,"x","argMin")},a={axis:e};return R.runKernel(yd,s,a)}const Lx=D({argMin_:YL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QL(t){const n={x:I(t,"x","asin")};return R.runKernel(_l,n)}const zx=D({asin_:QL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZL(t){const n={x:I(t,"x","asinh")};return R.runKernel(Ol,n)}const Bx=D({asinh_:ZL});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ez(t){const n={x:I(t,"x","atan")};return R.runKernel(Fl,n)}const Mx=D({atan_:ez});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(t,e){let n=I(t,"a","atan2"),s=I(e,"b","atan2");[n,s]=pt(n,s);const a={a:n,b:s};return R.runKernel(Pl,a)}const Vx=D({atan2_:tz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nz(t){const n={x:I(t,"x","atanh")};return R.runKernel(jl,n)}const Wx=D({atanh_:nz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bp(t,e,n,s,a="NHWC",r){const i=t[3],o=[...e,i],l=rr(a);return Gt(t,o,n,r,s,null,null,l)}function Fs(t,e,n,s,a,r,i="channelsLast"){const[o,l]=Yc(e);let u;if(i==="channelsLast")u=[o,l,t[3],t[3]];else if(i==="channelsFirst")u=[o,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Gt(t,u,n,s,a,r,!1,i)}function ar(t,e,n,s,a,r,i="NDHWC"){const[o,l,u]=Lw(e);let c,d;if(i==="NDHWC")d="channelsLast",c=[o,l,u,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",c=[o,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return oi(t,c,n,s,a,!1,d,r)}function Gt(t,e,n,s,a,r,i=!1,o="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,d]=t;else if(o==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${o}`);const[p,h,,f]=e,[g,y]=Yc(n),[m,w]=Yc(s),b=nl(p,m),x=nl(h,w),{padInfo:v,outHeight:S,outWidth:N}=rz(a,u,c,g,y,b,x,r,o),$=i?f*d:f;let E;return o==="channelsFirst"?E=[l,$,S,N]:o==="channelsLast"&&(E=[l,S,N,$]),{batchSize:l,dataFormat:o,inHeight:u,inWidth:c,inChannels:d,outHeight:S,outWidth:N,outChannels:$,padInfo:v,strideHeight:g,strideWidth:y,filterHeight:p,filterWidth:h,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:m,dilationWidth:w,inShape:t,outShape:E,filterShape:e}}function oi(t,e,n,s,a,r=!1,i="channelsLast",o){let[l,u,c,d,p]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d,p]=t;else if(i==="channelsFirst")[l,p,u,c,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[h,f,g,,y]=e,[m,w,b]=Lw(n),[x,v,S]=Lw(s),N=nl(h,x),$=nl(f,v),E=nl(g,S),{padInfo:A,outDepth:L,outHeight:W,outWidth:U}=iz(a,u,c,d,m,w,b,N,$,E,o),j=r?y*p:y;let z;return i==="channelsFirst"?z=[l,j,L,W,U]:i==="channelsLast"&&(z=[l,L,W,U,j]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:c,inWidth:d,inChannels:p,outDepth:L,outHeight:W,outWidth:U,outChannels:j,padInfo:A,strideDepth:m,strideHeight:w,strideWidth:b,filterDepth:h,filterHeight:f,filterWidth:g,effectiveFilterDepth:N,effectiveFilterHeight:$,effectiveFilterWidth:E,dilationDepth:x,dilationHeight:v,dilationWidth:S,inShape:t,outShape:z,filterShape:e}}function sz(t,e,n,s,a){s==null&&(s=Ux(t,e,n));const r=t[0],i=t[1],o=Qc((r-e+2*s)/n+1,a),l=Qc((i-e+2*s)/n+1,a);return[o,l]}function az(t,e,n,s,a,r){a==null&&(a=Ux(t,e[0],s[0]));const i=[0,0,0,n];for(let o=0;o<3;o++)t[o]+2*a>=e[o]&&(i[o]=Qc((t[o]-e[o]+2*a)/s[o]+1,r));return i}function Ux(t,e,n,s=1){const a=nl(e,s);return Math.floor((t[0]*(n-1)-n+a)/2)}function Yc(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Lw(t){return typeof t=="number"?[t,t,t]:t}function nl(t,e){return e<=1?t:t+(t-1)*(e-1)}function rz(t,e,n,s,a,r,i,o,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const h=sz([e,n],r,s,t,o);c=h[0],d=h[1]}else if(t==="same"){c=Math.ceil(e/s),d=Math.ceil(n/a);const p=Math.max(0,(c-1)*s+r-e),h=Math.max(0,(d-1)*a+i-n),f=Math.floor(p/2),g=p-f,y=Math.floor(h/2),m=h-y;u={top:f,bottom:g,left:y,right:m,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-r+1)/s),d=Math.ceil((n-i+1)/a);else if(typeof t=="object"){const p=l==="channelsLast"?t[1][0]:t[2][0],h=l==="channelsLast"?t[1][1]:t[2][1],f=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];u={top:p,bottom:h,left:f,right:g,type:p===0&&h===0&&f===0&&g===0?"VALID":"EXPLICIT"},c=Qc((e-r+p+h)/s+1,o),d=Qc((n-i+f+g)/a+1,o)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function iz(t,e,n,s,a,r,i,o,l,u,c){let d,p,h,f;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=az([e,n,s,1],[o,l,u],1,[a,r,i],t,c);p=y[0],h=y[1],f=y[2]}else if(t==="same"){p=Math.ceil(e/a),h=Math.ceil(n/r),f=Math.ceil(s/i);const g=(p-1)*a+o-e,y=(h-1)*r+l-n,m=(f-1)*i+u-s,w=Math.floor(g/2),b=g-w,x=Math.floor(y/2),v=y-x,S=Math.floor(m/2),N=m-S;d={top:x,bottom:v,left:S,right:N,front:w,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:p,outHeight:h,outWidth:f}}function Qc(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Gr(t){const[e,n,s]=Yc(t);return e===1&&n===1&&s===1}function tn(t,e){return Gr(t)||Gr(e)}function Zi(t){return Yc(t).every(e=>e>0)}function rr(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Nn(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")C(qi(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(a=>{C(qi(a),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${a}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oz(t,e){const s={x:I(t,"x","reshape","string_or_numeric")},a={shape:e};return R.runKernel(sp,s,a)}const F=D({reshape_:oz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lz(t,e,n,s,a){const r=I(t,"x","avgPool","float32"),i=1;C(tn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let o=r,l=!1;r.rank===3&&(l=!0,o=F(r,[1,r.shape[0],r.shape[1],r.shape[2]])),C(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),Nn("avgPool",s,a);const u={x:o},c={filterSize:e,strides:n,pad:s,dimRoundingMode:a};let d=R.runKernel(wd,u,c);return d=re(d,r.dtype),l?F(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const xp=D({avgPool_:lz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uz(t,e,n,s,a,r="NDHWC"){const i=I(t,"x","avgPool3d","float32");let o=i,l=!1;i.rank===4&&(l=!0,o=F(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),C(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),C(r==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),C(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Nn("avgPool3d",s,a);const u={x:o},c={filterSize:e,strides:n,pad:s,dimRoundingMode:a,dataFormat:r};let d=R.runKernel(bd,u,c);return d=re(d,o.dtype),l?F(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Gx=D({avgPool3d_:uz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cz(t,e=0){C(t.length>=1,()=>"Pass at least one tensor to concat");const n=Jc(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(r=>{if(r.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${r.dtype}. `)}),n.length===1)return ka(n[0]);const s=n,a={axis:e};return R.runKernel(Nd,s,a)}const xt=D({concat_:cz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dz(t,e,n=!1,s=!1){let a=I(t,"a","matMul"),r=I(e,"b","matMul");[a,r]=pt(a,r);const i={a,b:r},o={transposeA:n,transposeB:s};return R.runKernel(xd,i,o)}const $e=D({matMul_:dz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pz(t){const n={x:I(t,"x","sigmoid","float32")};return R.runKernel(yu,n)}const Zs=D({sigmoid_:pz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hz(t,e,n){const s=I(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const a={x:s},r={begin:e,size:n};return R.runKernel(lp,a,r)}const _e=D({slice_:hz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fz(t){const n={x:I(t,"x","tanh","float32")};return R.runKernel(Su,n)}const Hr=D({tanh_:fz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mz(t,e,n,s,a,r){const i=I(t,"forgetBias","basicLSTMCell"),o=I(e,"lstmKernel","basicLSTMCell"),l=I(n,"lstmBias","basicLSTMCell"),u=I(s,"data","basicLSTMCell"),c=I(a,"c","basicLSTMCell"),d=I(r,"h","basicLSTMCell"),p=xt([u,d],1),h=$e(p,o),f=Z(h,l),g=f.shape[0],y=f.shape[1]/4,m=[g,y],w=_e(f,[0,0],m),b=_e(f,[0,y],m),x=_e(f,[0,y*2],m),v=_e(f,[0,y*3],m),S=Z(_(Zs(w),Hr(b)),_(c,Zs(Z(i,x)))),N=_(Hr(S),Zs(v));return[S,N]}const M$=D({basicLSTMCell_:mz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gz(t,e,n){const s=I(t,"x","batchToSpaceND"),a=e.reduce((o,l)=>o*l);C(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),C(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),C(s.shape[0]%a===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${a}`);const r={x:s},i={blockShape:e,crops:n};return R.runKernel(kd,r,i)}const kp=D({batchToSpaceND_:gz});function yz(t){let e;return t.rank===0||t.rank===1?e=F(t,[1,1,1,t.size]):t.rank===2?e=F(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=F(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(t,e,n,s,a,r){r==null&&(r=.001);const i=I(t,"x","batchNorm"),o=I(e,"mean","batchNorm"),l=I(n,"variance","batchNorm");let u;a!=null&&(u=I(a,"scale","batchNorm"));let c;s!=null&&(c=I(s,"offset","batchNorm")),C(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),C(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),C(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:yz(i),scale:u,offset:c,mean:o,variance:l},h={varianceEpsilon:r},f=R.runKernel(_d,p,h);return F(f,i.shape)}const Iu=D({batchNorm_:wz});function bz(t,e,n,s,a,r){const i=I(t,"x","batchNorm"),o=I(e,"mean","batchNorm"),l=I(n,"variance","batchNorm");let u;a!=null&&(u=I(a,"scale","batchNorm"));let c;return s!=null&&(c=I(s,"offset","batchNorm")),C(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),C(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),C(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&C(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&C(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Iu(i,o,l,c,u,r)}const Hx=D({batchNorm2d_:bz});function xz(t,e,n,s,a,r){const i=I(t,"x","batchNorm"),o=I(e,"mean","batchNorm"),l=I(n,"variance","batchNorm");let u;a!=null&&(u=I(a,"scale","batchNorm"));let c;return s!=null&&(c=I(s,"offset","batchNorm")),C(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),C(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),C(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&C(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&C(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Iu(i,o,l,c,u,r)}const Kx=D({batchNorm3d_:xz});function kz(t,e,n,s,a,r){const i=I(t,"x","batchNorm"),o=I(e,"mean","batchNorm"),l=I(n,"variance","batchNorm");let u;a!=null&&(u=I(a,"scale","batchNorm"));let c;return s!=null&&(c=I(s,"offset","batchNorm")),C(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),C(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),C(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&C(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&C(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Iu(i,o,l,c,u,r)}const qx=D({batchNorm4d_:kz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vz(t,e,n){const s=I(t,"x","bincount"),a=I(e,"weights","bincount");C(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),C(n>=0,()=>`size must be non-negative, but got ${n}.`),C(a.size===s.size||a.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${a.shape}.`);const r={x:s,weights:a},i={size:n};return R.runKernel(Nm,r,i)}const Jx=D({bincount_:vz});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sz(t,e){const n=I(t,"x","bitwiseAnd"),s=I(e,"y","bitwiseAnd");if(!Re(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const a={a:n,b:s};return R.runKernel(vd,a)}const V$=D({bitwiseAnd_:Sz});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nz(t,e){const n=I(t,"s0","broadcastArgs","int32"),s=I(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const a={s0:n,s1:s};return R.runKernel(Cm,a)}const W$=D({broadcastArgs_:Nz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cz(t,e){let n=I(t,"broadcastTo","x");const s=n.shape;if(es(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=F(n,u)}const a=n.shape,r=Array.from(e);for(let u=e.length-1;u>=0;u--)if(a[u]===e[u])r[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(r.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return ka(n);const o={x:n},l={reps:r};return R.runKernel(Nu,o,l)}const zi=D({broadcastTo_:Cz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iz(t){const n={x:I(t,"x","ceil","float32")};return R.runKernel(zl,n)}const Xx=D({ceil_:Iz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bo(t,e,n){es(t),n=n||mo(e);const s={shape:t,value:e,dtype:n};return R.runKernel(Mm,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $z(t,e,n){const s=I(t,"x","clipByValue");if(C(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return bo(s.shape,e,s.dtype);const a={x:s},r={clipValueMin:e,clipValueMax:n};return R.runKernel(Bl,a,r)}const _n=D({clipByValue_:$z});function Tz(t){return xt(t,0)}const Yx=D({concat1d_:Tz});function Ez(t,e){return xt(t,e)}const Qx=D({concat2d_:Ez});function Az(t,e){return xt(t,e)}const Zx=D({concat3d_:Az});function Rz(t,e){return xt(t,e)}const ek=D({concat4d_:Rz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dz(t,e,n,s,a="NHWC",r=[1,1],i){const o=I(t,"x","conv2d","float32"),l=I(e,"filter","conv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=F(o,[1,o.shape[0],o.shape[1],o.shape[2]])),C(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),C(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Nn("conv2d",s,i);const d=a==="NHWC"?u.shape[3]:u.shape[1];C(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),C(tn(n,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`),C(Zi(r),()=>"Error in conv2D: Dilated rates should be larger than 0."),C(Zi(n),()=>"Error in conv2D: Strides should be larger than 0.");const p={x:u,filter:l},h={strides:n,pad:s,dataFormat:a,dilations:r,dimRoundingMode:i},f=R.runKernel(Cd,p,h);return c?F(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Qa=D({conv2d_:Dz});function _z(t,e,n,s,a="NWC",r=1,i){const o=I(t,"x","conv1d"),l=I(e,"filter","conv1d");let u=o,c=!1;o.rank===2&&(c=!0,u=F(o,[1,o.shape[0],o.shape[1]])),C(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),C(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Nn("conv1d",s,i),C(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),C(tn(n,r),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${r}'`),C(Zi(r),()=>"Error in conv1D: Dilated rates should be larger than 0."),C(Zi(n),()=>"Error in conv1D: Stride should be larger than 0."),C(a==="NWC",()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);const d=F(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=F(u,[u.shape[0],1,u.shape[1],u.shape[2]]),y=Qa(p,d,[1,n],s,"NHWC",[1,r],i);return c?F(y,[y.shape[2],y.shape[3]]):F(y,[y.shape[0],y.shape[2],y.shape[3]])}const Eg=D({conv1d_:_z});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oz(t,e,n,s,a,r="NHWC",i){C(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,l=e,u=!1;e.rank===3&&(u=!0,l=F(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,t[0],t[1],t[2]]),C(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),C(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),C(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=r==="NHWC"?o[3]:o[1],d=r==="NHWC"?l.shape[3]:l.shape[1];C(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),C(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Nn("conv2dDerInput",a,i);const p={dy:l,filter:n},h={strides:s,pad:a,dataFormat:r,dimRoundingMode:i,inputShape:o},f=R.runKernel(Id,p,h);return u?F(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const tk=D({conv2DBackpropInput_:Oz});function Fz(t,e,n,s,a,r){const i=I(t,"x","conv2dTranspose"),o=I(e,"filter","conv2dTranspose");return tk(n,i,o,s,a,"NHWC",r)}const Ag=D({conv2dTranspose_:Fz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jz(t,e,n,s,a="NDHWC",r=[1,1,1]){const i=I(t,"x","conv3d"),o=I(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=F(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),C(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),C(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),C(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),C(tn(n,r),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`),C(a==="NDHWC",()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`),C(Zi(r),()=>"Error in conv3D: Dilated rates should be larger than 0."),C(Zi(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:o},d={strides:n,pad:s,dataFormat:a,dilations:r},p=R.runKernel($d,c,d);return u?F(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const nk=D({conv3d_:jz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pz(t,e,n,s,a){C(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let r=t,i=e,o=!1;e.rank===4&&(o=!0,i=F(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),r=[1,t[0],t[1],t[2],t[3]]);const l=r[4],u=i.shape[4];C(r.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${r.length}.`),C(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),C(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),C(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),C(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:i,filter:n},d={pad:a,strides:s,inputShape:r},p=R.runKernel(Em,c,d);return o?F(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const U$=D({conv3DBackpropInput_:Pz});function Lz(t,e,n,s,a){const r=I(t,"x","conv3dTranspose"),i=I(e,"filter","conv3dTranspose");return U$(n,r,i,s,a)}const sk=D({conv3dTranspose_:Lz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zz(t){const n={x:I(t,"x","cos","float32")};return R.runKernel(Ml,n)}const vp=D({cos_:zz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(t){const n={x:I(t,"x","cosh","float32")};return R.runKernel(Vl,n)}const Rg=D({cosh_:Bz});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mz(t,e=0,n=!1,s=!1){const r={x:I(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:s};return R.runKernel(Am,r,i)}const Zc=D({cumprod_:Mz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vz(t,e=0,n=!1,s=!1){const r={x:I(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:s};return R.runKernel(Td,r,i)}const Dg=D({cumsum_:Vz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wz(t,e,n,s=!1){const a=I(t,"x","denseBincount"),r=I(e,"weights","denseBincount");C(a.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`),C(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),C(n>=0,()=>`size must be non-negative, but got ${n}.`),C(r.size===a.size||r.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${r.shape}.`);const i={x:a,weights:r},o={size:n,binaryOutput:s};return R.runKernel(Dm,i,o)}const Rf=D({denseBincount_:Wz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(t,e,n="NHWC"){const s=I(t,"x","depthToSpace","float32"),a=n==="NHWC"?s.shape[1]:s.shape[2],r=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];C(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),C(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e}  for depthToSpace with input shape
    ${s.shape}`),C(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e} for depthToSpace with input shape
        ${s.shape}`),C(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const o={x:s},l={blockSize:e,dataFormat:n};return R.runKernel(_m,o,l)}const ak=D({depthToSpace_:Uz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gz(t,e,n,s,a="NHWC",r=[1,1],i){const o=I(t,"x","depthwiseConv2d","float32"),l=I(e,"filter","depthwiseConv2d","float32");let u=o,c=!1;o.rank===3&&(c=!0,u=F(o,[1,o.shape[0],o.shape[1],o.shape[2]])),C(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),C(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=a==="NHWC"?u.shape[3]:u.shape[1];C(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Nn("depthwiseConv2d",s,i);const p={x:u,filter:l},h={strides:n,pad:s,dataFormat:a,dilations:r,dimRoundingMode:i},f=R.runKernel(Ed,p,h);return c?F(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const $u=D({depthwiseConv2d_:Gz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(t){const n={x:I(t,"x","diag")};return R.runKernel(jm,n)}const G$=D({diag_:Hz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kz(t,e,n,s,a=[1,1],r="NHWC"){const i=I(t,"x","dilation2d"),o=I(e,"filter","dilation2d");C(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),C(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),C(r==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${r}`);let l=i,u=!1;i.rank===3&&(l=F(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),C(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const c={x:l,filter:o},d={strides:n,pad:s,dilations:a},p=R.runKernel(Ad,c,d);return u?F(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const rk=D({dilation2d_:Kz});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eo(t,e){const n=t.length,s=[];for(let a=0;a<n;a++){const r=n-1-a,i=t[r]||1;(e[e.length-1-a]||1)>1&&i===1&&s.unshift(r)}return s}function Et(t,e){const n=[];for(let s=0;s<e.length;s++){const a=t[t.length-s-1],r=e.length-s-1,i=e[r];(a==null||a===1&&i>1)&&n.unshift(r)}return n}function ve(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let a=0;a<n;a++){let r=t[t.length-a-1];r==null&&(r=1);let i=e[e.length-a-1];if(i==null&&(i=1),r===1)s[n-a-1]=i;else if(i===1)s[n-a-1]=r;else if(r!==i){const o=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(o)}else s[n-a-1]=r}return s}const qz=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:ve,getBroadcastDims:eo,getReductionAxes:Et},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz(t,e){let n=I(t,"a","equal","string_or_numeric"),s=I(e,"b","equal","string_or_numeric");[n,s]=pt(n,s),ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(Rd,a)}const Os=D({equal_:Jz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xz(t,e,n){const s=I(e,"a","where"),a=I(n,"b","where"),r=I(t,"condition","where","bool"),i=ve(ve(r.shape,s.shape),a.shape),o=zi(r,i),l=zi(s,i),u=zi(a,i),c={condition:o,t:l,e:u};return R.runKernel(op,c)}const Qt=D({where_:Xz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yz(t){const n={x:I(t,"x","zerosLike")};return R.runKernel(gp,n)}const Oe=D({zerosLike_:Yz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qz(t,e){let n=I(t,"a","div"),s=I(e,"b","div");[n,s]=pt(n,s);const a=ge(n,s),r=Oe(a),i=Os(s,r);return Qt(i,r,a)}const ik=D({divNoNan_:Qz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zz(t,e){const n=I(t,"t1","dot"),s=I(e,"t2","dot");C((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const a=n.rank===1?n.size:n.shape[1],r=s.rank===1?s.size:s.shape[0];if(C(a===r,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${r}.`),n.rank===1&&s.rank===1){const i=F(n,[1,-1]),o=F(s,[-1,1]),l=$e(i,o);return F(l,[])}else if(n.rank===1&&s.rank===2){const i=F(n,[1,-1]),o=F(s,[s.shape[0],s.shape[1]]),l=$e(i,o);return F(l,[l.size])}else if(n.rank===2&&s.rank===1){const i=F(s,[-1,1]),o=$e(n,i);return F(o,[o.size])}else{const i=F(s,[s.shape[0],s.shape[1]]);return $e(n,i)}}const ok=D({dot_:Zz});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eB(t,...e){const n=e.map((a,r)=>I(a,`tensors${r}`,"einsum")),s={equation:t};return R.runKernel(Lm,n,s)}const Ci=D({einsum_:eB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tB(t){const n={x:I(t,"x","elu","float32")};return R.runKernel(Ul,n)}const Tu=D({elu_:tB});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(t,e){const n=I(t,"x","ensureShape","string_or_numeric");if(!XI(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const H$=D({ensureShape_:nB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sB(t){let e=I(t,"x","erf");C(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=re(e,"float32"));const n={x:e};return R.runKernel(Gl,n)}const _g=D({erf_:sB});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lk(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function K$(t,e,n){const s=t.length+e.length,a=[];let r=0,i=0;for(let o=0;o<s;o++)n.indexOf(o)===-1?a.push(t[r++]):a.push(e[i++]);return a}function Ht(t,e){const n=[],s=t.length;for(let r=0;r<s;r++)e.indexOf(r)===-1&&n.push(t[r]);const a=e.map(r=>t[r]);return[n,a]}function kt(t,e){const n=e.map(s=>1);return K$(t,n,e)}function nn(t,e,n){C(lk(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function ht(t,e){if(lk(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function li(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function vt(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aB(t,e=null,n=!1){const a={x:I(t,"x","max")},r={reductionIndices:e,keepDims:n};return R.runKernel(Wd,a,r)}const ds=D({max_:aB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rB(t,e=null,n=!1){const a={x:I(t,"x","min")},r={axis:e,keepDims:n};return R.runKernel(Kd,a,r)}const gl=D({min_:rB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iB(t,e){let n=I(t,"base","pow"),s=I(e,"exp","pow");[n,s]=pt(n,s);const a={a:n,b:s};return R.runKernel(ou,a)}const $a=D({pow_:iB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function we(t,e){if((Bt(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Bt(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ii(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oB(t){const n={x:I(t,"x","sqrt","float32")};return R.runKernel(bu,n)}const Ut=D({sqrt_:oB});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lB(t){const e=I(t,"x","square"),n={};return R.runKernel("Square",{x:e},n)}const Ue=D({square_:lB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uB(t,e=null,n=!1){let s=I(t,"x","sum");s.dtype==="bool"&&(s=re(s,"int32"));const a={x:s},r={axis:e,keepDims:n};return R.runKernel(up,a,r)}const pe=D({sum_:uB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cB(t,e="euclidean",n=null,s=!1){t=I(t,"x","norm");const a=q$(t,e,n);let r=a.shape;if(s){const i=Ee(n,t.shape);r=kt(a.shape,i)}return F(a,r)}function q$(t,e,n=null){if(t.rank===0)return Ct(t);if(t.rank!==1&&n===null)return q$(F(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return pe(Ct(t),n);if(e===1/0)return ds(Ct(t),n);if(e===-1/0)return gl(Ct(t),n);if(e==="euclidean"||e===2)return Ut(pe($a(Ct(t),we(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return ds(pe(Ct(t),n[0]),n[1]-1);if(e===1/0)return ds(pe(Ct(t),n[1]),n[0]);if(e===-1/0)return gl(pe(Ct(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Ut(pe(Ue(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Eu=D({norm_:cB});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dB(t,e=null,n=!1){return Eu(t,"euclidean",e,n)}const uk=D({euclideanNorm_:dB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(t){const n={x:I(t,"x","exp")};return R.runKernel(Hl,n)}const On=D({exp_:pB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hB(t,e=0){const n=I(t,"x","expandDims","string_or_numeric");C(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},a={dim:e};return R.runKernel(Dd,s,a)}const on=D({expandDims_:hB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fB(t){const n={x:I(t,"x","expm1")};return R.runKernel(Kl,n)}const ck=D({expm1_:fB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mB(t,e){const n=I(t,"x","tile","string_or_numeric");C(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},a={reps:e};return R.runKernel(Nu,s,a)}const os=D({tile_:mB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gB(t,e,n,s="float32"){e==null&&(e=t);const a=Se([t,e],s),r=t<=e?t:e;for(let o=0;o<r;++o)a.set(1,o,o);const i=F(a.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return os(on(i,0),[n[0],1,1]);if(n.length===2)return os(on(on(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return os(on(on(on(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const Og=D({eye_:gB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yB(t){const n={x:I(t,"x","floor","float32")};return R.runKernel(ql,n)}const Au=D({floor_:yB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wB(t,e,n=0,s=0){const a=I(t,"x","gather"),r=I(e,"indices","gather","int32"),i={x:a,indices:r},o={axis:n,batchDims:s};return R.runKernel(Od,i,o)}const Ru=D({gather_:wB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bB(t,e){let n=I(t,"a","greater","string_or_numeric"),s=I(e,"b","greater","string_or_numeric");[n,s]=pt(n,s),ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(Fd,a)}const zn=D({greater_:bB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xB(t,e){let n=I(t,"a","greaterEqual","string_or_numeric"),s=I(e,"b","greaterEqual","string_or_numeric");[n,s]=pt(n,s),ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(Xl,a)}const ir=D({greaterEqual_:xB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kB(t){const n={input:I(t,"input","imag")};return R.runKernel(Gm,n)}const Sp=D({imag_:kB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vB(t){const n={x:I(t,"x","isFinite")};return R.runKernel(Ql,n)}const dk=D({isFinite_:vB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SB(t){const n={x:I(t,"x","isInf")};return R.runKernel(Zl,n)}const pk=D({isInf_:SB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NB(t){const n={x:I(t,"x","isNaN")};return R.runKernel(eu,n)}const hk=D({isNaN_:NB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CB(t,e=.2){const s={x:I(t,"x","leakyRelu")},a={alpha:e};return R.runKernel(jd,s,a)}const Np=D({leakyRelu_:CB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IB(t,e){let n=I(t,"a","less","string_or_numeric"),s=I(e,"b","less","string_or_numeric");[n,s]=pt(n,s),ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(Pd,a)}const yl=D({less_:IB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $B(t,e){let n=I(t,"a","lessEqual","string_or_numeric"),s=I(e,"b","lessEqual","string_or_numeric");[n,s]=pt(n,s),ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(Ld,a)}const ui=D({lessEqual_:$B});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:t,stop:e,num:n};return R.runKernel(Hm,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TB(t,e=5,n=1,s=1,a=.5){const r=I(t,"x","localResponseNormalization");C(r.rank===4||r.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${r.rank}.`),C(qi(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=r,o=!1;r.rank===3&&(o=!0,i=F(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={x:i},u={depthRadius:e,bias:n,alpha:s,beta:a},c=R.runKernel(Vd,l,u);return o?F(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const fk=D({localResponseNormalization_:TB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EB(t){const n={x:I(t,"x","log","float32")};return R.runKernel(tu,n)}const Xn=D({log_:EB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AB(t){const n={x:I(t,"x","log1p")};return R.runKernel(nu,n)}const Cp=D({log1p_:AB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RB(t){return C(Vr(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const s=I(e,"x","tf.grad","string_or_numeric"),a=n!=null?I(n,"dy","tf.grad"):null;return R.tidy(()=>{const{value:r,grads:i}=R.gradients(()=>t(s),[s],a);return a!=null&&en(r.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Fg(i),i[0]})}}function DB(t){return C(Vr(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{C(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=Jc(e,"args","tf.grads","string_or_numeric"),a=n!=null?I(n,"dy","tf.grads"):null;return R.tidy(()=>{const{value:r,grads:i}=R.gradients(()=>t(...s),s,a);return a!=null&&en(r.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Fg(i),i})}}function _B(t){return C(Vr(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{C(e instanceof ze,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),C(n==null||n instanceof ze,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:a}=R.gradients(()=>t(e),[e],n);return Fg(s),{grad:s[0],value:a}}}function OB(t){return C(Vr(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{C(Array.isArray(e)&&e.every(a=>a instanceof ze),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),C(n==null||n instanceof ze,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=R.gradients(()=>t(...e),e,n);return n!=null&&en(s.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Fg(s.grads),s}}function X$(t,e){C(Vr(t),()=>"The f passed in variableGrads(f) must be a function"),C(e==null||Array.isArray(e)&&e.every(u=>u instanceof qc),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in R.registeredVariables)e.push(R.registeredVariables[u])}const s=n?e.filter(u=>!u.trainable):null,a=e.length;e=e.filter(u=>u.trainable),C(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);const r=!0,{value:i,grads:o}=R.gradients(t,e,null,r);C(o.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),C(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,c)=>{o[c]!=null&&(l[u.name]=o[c])}),s!=null&&s.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Ta(t){return R.customGrad(t)}function Fg(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FB(t){const n={x:I(t,"x","neg")};return R.runKernel(Jd,n)}const Ye=D({neg_:FB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jB(t){const n={x:I(t,"x","softplus")};return R.runKernel(wu,n)}const xo=D({softplus_:jB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PB(t){const e=I(t,"x","logSigmoid");return Ta(s=>({value:Ye(xo(Ye(s))),gradFunc:i=>_(i,Zs(Ye(s)))}))(e)}const mk=D({logSigmoid_:PB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LB(t,e){let n=I(t,"a","sub"),s=I(e,"b","sub");[n,s]=pt(n,s);const a={a:n,b:s};return R.runKernel(ku,a)}const ce=D({sub_:LB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zB(t,e=-1){const n=I(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Ta((a,r)=>{const o=ds(a,e,!0),l=ce(a,o),u=ce(re(l,"float32"),Xn(pe(On(l),e,!0)));return r([u]),{value:u,gradFunc:(d,p)=>{const[h]=p,f=!0,g=On(h);return ce(d,_(pe(d,e,f),g))}}})(n)}const jg=D({logSoftmax_:zB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BB(t,e=null,n=!1){const s=I(t,"x","logSumExp"),a=Ee(e,s.shape),r=ds(s,a,!0),i=ce(s,r),o=On(i),l=pe(o,a),u=Xn(l),c=Z(F(r,u.shape),u);if(n){const d=kt(c.shape,a);return F(c,d)}return c}const Ip=D({logSumExp_:BB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MB(t,e){const n=I(t,"a","logicalAnd","bool"),s=I(e,"b","logicalAnd","bool");ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(zd,a)}const na=D({logicalAnd_:MB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VB(t){const n={x:I(t,"x","logicalNot","bool")};return R.runKernel(Bd,n)}const $p=D({logicalNot_:VB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WB(t,e){const n=I(t,"a","logicalOr","bool"),s=I(e,"b","logicalOr","bool");ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(Md,a)}const Pg=D({logicalOr_:WB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UB(t,e){const n=I(t,"a","logicalXor","bool"),s=I(e,"b","logicalXor","bool");return ve(n.shape,s.shape),na(Pg(t,e),$p(na(t,e)))}const gk=D({logicalXor_:UB});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bh=2147483648;function GB(t,e,n="left"){const s=I(t,"sortedSequence","searchSorted"),a=I(e,"values","searchSorted"),r=s.shape[s.shape.length-1],i=a.shape[a.shape.length-1],o=F(s,[-1,r]),l=F(a,[-1,i]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(H(l.shape)>=bh)throw new Error(`values tensor size must less than ${bh}`);if(o.shape[1]>=bh)throw new Error(`trailing dim_size must less than ${bh} for int32 output type, was ${o.shape[1]}`);const u={sortedSequence:o,values:l},c={side:n};return R.runKernel(cg,u,c)}const Lg=D({searchSorted_:GB});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y$(t,e){return Lg(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HB(t,e,n,s,a){const r=I(t,"x","maxPool"),i=1;let o=r,l=!1;r.rank===3&&(l=!0,o=F(r,[1,r.shape[0],r.shape[1],r.shape[2]])),C(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),C(tn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Nn("maxPool",s,a);const u={x:o},c={filterSize:e,strides:n,pad:s,dimRoundingMode:a},d=R.runKernel(Ud,u,c);return l?F(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Tp=D({maxPool_:HB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KB(t,e=[1,1,1],n,s,a,r="NDHWC"){const i=I(t,"x","maxPool3d");let o=i,l=!1;i.rank===4&&(l=!0,o=F(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),C(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),C(r==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${r}`),Nn("maxPool3d",s,a);const u={x:o},c={filterSize:e,strides:n,pad:s,dimRoundingMode:a,dataFormat:r},d=R.runKernel(Gd,u,c);return l?F(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const yk=D({maxPool3d_:KB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(t,e,n,s,a=!1){const i={x:I(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:s,includeBatchInIndex:a},l=R.runKernel(Xm,i,o);return{result:l[0],indexes:l[1]}}const Q$=D({maxPoolWithArgmax_:qB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JB(t,e){let n=I(t,"a","maximum"),s=I(e,"b","maximum");[n,s]=pt(n,s),n.dtype==="bool"&&(n=re(n,"int32"),s=re(s,"int32")),ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(su,a)}const Ra=D({maximum_:JB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XB(t,e=null,n=!1){const a={x:I(t,"x","mean")},r={axis:e,keepDims:n};return R.runKernel(Hd,a,r)}const ct=D({mean_:XB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $t(t,e="float32"){if(es(t),e==="complex64"){const s=$t(t,"float32"),a=$t(t,"float32");return Ya(s,a)}const n=Zt(H(t),e);return R.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tn(t,e="float32"){if(es(t),e==="complex64"){const s=Tn(t,"float32"),a=$t(t,"float32");return Ya(s,a)}const n=bm(H(t),e);return R.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z$(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let s=I(t,"x","meshgrid",t instanceof ze?t.dtype:"float32");if(e===void 0)return[s];let a=I(e,"y","meshgrid",e instanceof ze?e.dtype:"float32");const r=H(s.shape),i=H(a.shape);return n==="xy"?(s=F(s,[1,-1]),a=F(a,[-1,1]),[$e(Tn([i,1],s.dtype),s),$e(a,Tn([1,r],a.dtype))]):(s=F(s,[-1,1]),a=F(a,[1,-1]),[$e(s,Tn([1,i],s.dtype)),$e(Tn([r,1],a.dtype),a)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(t,e){let n=I(t,"a","minimum"),s=I(e,"b","minimum");[n,s]=pt(n,s),n.dtype==="bool"&&(n=re(n,"int32"),s=re(s,"int32")),ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(au,a)}const Kr=D({minimum_:YB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QB(t,e,n){C(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=I(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");C(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const a=n==="reflect"?1:0;for(let o=0;o<s.rank;o++)C(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),C(e[o][0]>=0&&e[o][0]<=s.shape[o]-a&&e[o][1]>=0&&e[o][1]<=s.shape[o]-a,()=>`Padding in dimension ${o} cannot be greater than or equal to ${s.shape[o]-a} or less than 0 for input of shape ${s.shape}`);const r={paddings:e,mode:n},i={x:s};return R.runKernel(qd,i,r)}const wk=D({mirrorPad_:QB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(t,e){let n=I(t,"a","mod"),s=I(e,"b","mod");[n,s]=pt(n,s);const a={a:n,b:s};return R.runKernel(ru,a)}const bk=D({mod_:ZB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eM(t,e=null,n=!1){t=I(t,"x","moments");const s=Ee(e,t.shape),a=ct(t,s,n);let r=a.shape;n||(r=kt(a.shape,s));const i=Ue(ce(re(t,"float32"),F(a,r))),o=ct(i,s,n);return{mean:a,variance:o}}const Ep=D({moments_:eM});function tM(t,e,n,s){const a=I(e,"data","multiRNNCell"),r=Jc(n,"c","multiRNNCell"),i=Jc(s,"h","multiRNNCell");let o=a;const l=[];for(let d=0;d<t.length;d++){const p=t[d](o,r[d],i[d]);l.push(p[0]),l.push(p[1]),o=p[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const eT=D({multiRNNCell_:tM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nM(t,e,n,s=!1){const a=I(t,"logits","multinomial"),r=a.size,i=a.rank;if(r<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${r}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();const l={logits:i===1?F(a,[1,-1]):a},u={numSamples:e,seed:n,normalized:s},c=R.runKernel(Ym,l,u);return i===1?F(c,[c.size]):c}const tT=D({multinomial_:nM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sM(t,e){let n=I(t,"a","notEqual","string_or_numeric"),s=I(e,"b","notEqual","string_or_numeric");[n,s]=pt(n,s),ve(n.shape,s.shape);const a={a:n,b:s};return R.runKernel(Xd,a)}const to=D({notEqual_:sM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aM(t,e,n=1,s=0,a="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:I(t,"indices","oneHot","int32")},o={dtype:a,depth:e,onValue:n,offValue:s};return R.runKernel(Qd,i,o)}const wl=D({oneHot_:aM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rM(t){const n={x:I(t,"x","onesLike")};return R.runKernel(Yd,n)}const Yn=D({onesLike_:rM});function iM(t,e){const n=I(t,"v1","outerProduct"),s=I(e,"v2","outerProduct");C(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const a=F(n,[-1,1]),r=F(s,[1,-1]);return $e(a,r)}const nT=D({outerProduct_:iM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oM(t,e,n=0){const s=I(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:n},r={x:s};return R.runKernel(ep,r,a)}const or=D({pad_:oM});function lM(t,e,n=0){return C(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),or(t,[e],n)}const sT=D({pad1d_:lM});function uM(t,e,n=0){return C(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),or(t,e,n)}const aT=D({pad2d_:uM});function cM(t,e,n=0){return C(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),or(t,e,n)}const rT=D({pad3d_:cM});function dM(t,e,n=0){return C(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),or(t,e,n)}const iT=D({pad4d_:dM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pM(t,e,n){const s=I(t,"x","spaceToBatchND");C(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),C(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),C(s.shape.reduce((i,o,l)=>l>0&&l<=e.length?i&&(o+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const a={x:s},r={blockShape:e,paddings:n};return R.runKernel(cp,a,r)}const Ap=D({spaceToBatchND_:pM});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hM(t,e,n,s,a,r,i){a==null&&(a=[1,1]),r==null&&(r=1),s===0&&(s="valid");const o=I(t,"x","maxPool");let l=o,u=!1;o.rank===3&&(u=!0,l=F(o,[1,o.shape[0],o.shape[1],o.shape[2]])),C(tn(r,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${r} and dilations '${a}'`);const c=Fs(l.shape,e,r,a,s),d=[c.dilationHeight,c.dilationWidth];let p;s==="same"?p=mM([c.filterHeight,c.filterWidth],d):p=[[0,0],[0,0]];const h=d[0]===1&&d[1]===1,[f,g]=fM([c.inHeight,c.inWidth],d,p),y=h?s:"valid",m=h?l:Ap(l,d,f),b=(n==="avg"?()=>xp(m,e,r,y,i):()=>Tp(m,e,r,y,i))(),x=h?b:kp(b,d,g);return u?F(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function fM(t,e,n){const s=n.map(c=>c[0]),a=n.map(c=>c[1]),r=t.concat(s,a),i=e.map((c,d)=>(c-r[d]%c)%c),o=a.map((c,d)=>c+i[d]),l=e.map((c,d)=>[s[d],o[d]]),u=e.map((c,d)=>[0,i[d]]);return[l,u]}function mM(t,e){const s=t.map((i,o)=>i+(i-1)*(e[o]-1)).map(i=>i-1),a=s.map(i=>Math.floor(i/2)),r=s.map((i,o)=>i-a[o]);return s.map((i,o)=>[a[o],r[o]])}const xk=D({pool_:hM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gM(t,e){const n=I(t,"x","prelu"),s=I(e,"alpha","prelu"),a={x:n,alpha:s};return R.runKernel(tp,a)}const Rp=D({prelu_:gM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yM(t,e=null,n=!1){let s=I(t,"x","prod");s.dtype==="bool"&&(s=re(s,"int32"));const a={x:s},r={axis:e,keepDims:n};return R.runKernel(np,a,r)}const kk=D({prod_:yM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wM(t,e,n,s){const a=t.map((c,d)=>I(c,`tensors${d}`,"raggedGather","int32")),r=I(e,"paramsDenseValues","raggedGather"),i=I(n,"indices","raggedGather","int32"),o={paramsNestedSplits:a,paramsDenseValues:r,indices:i},l={outputRaggedRank:s},u=R.runKernel(tg,o,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const oT=D({raggedGather_:wM});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bM(t,e,n){const s=I(t,"starts","raggedRange"),a=I(e,"limits","raggedRange",s.dtype),r=I(n,"deltas","raggedRange",s.dtype),i={starts:s,limits:a,deltas:r},o=R.runKernel(ng,i);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}const lT=D({raggedRange_:bM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xM(t,e,n,s,a){const r=I(t,"shape","raggedTensorToTensor","int32"),i=I(e,"values","raggedTensorToTensor"),o=I(n,"defaultValue","raggedTensorToTensor",i.dtype),l=s.map((d,p)=>I(d,`tensors${p}`,"raggedTensorToTensor","int32")),u={shape:r,values:i,defaultValue:o,rowPartitionTensors:l},c={rowPartitionTypes:a};return R.runKernel(sg,u,c)}const uT=D({raggedTensorToTensor_:xM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kM(t,e,n){es(t);const s=H(t);let a=null;if(n==null||n==="float32")a=new Float32Array(s);else if(n==="int32")a=new Int32Array(s);else if(n==="bool")a=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let r=0;r<s;r++)a[r]=e();return R.makeTensor(a,t,n)}const cT=D({rand_:kM});var vk={exports:{}};vk.exports;(function(t){(function(e,n,s){function a(l){var u=this,c=o();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function r(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var c=new a(l),d=u&&u.state,p=c.next;return p.int32=function(){return c.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&r(d,c),p.state=function(){return r(c,{})}),p}function o(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(Zr,t)})(vk);var vM=vk.exports,Sk={exports:{}};Sk.exports;(function(t){(function(e,n,s){function a(o){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function r(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function i(o,l){var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.xor128=i})(Zr,t)})(Sk);var SM=Sk.exports,Nk={exports:{}};Nk.exports;(function(t){(function(e,n,s){function a(o){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:u+=o;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function r(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function i(o,l){var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.xorwow=i})(Zr,t)})(Nk);var NM=Nk.exports,Ck={exports:{}};Ck.exports;(function(t){(function(e,n,s){function a(o){var l=this;l.next=function(){var c=l.x,d=l.i,p,h;return p=c[d],p^=p>>>7,h=p^p<<24,p=c[d+1&7],h^=p^p>>>10,p=c[d+3&7],h^=p^p>>>3,p=c[d+4&7],h^=p^p<<7,p=c[d+7&7],p=p^p<<13,h^=p^p<<9,c[d]=h,l.i=d+1&7,h};function u(c,d){var p,h=[];if(d===(d|0))h[0]=d;else for(d=""+d,p=0;p<d.length;++p)h[p&7]=h[p&7]<<15^d.charCodeAt(p)+h[p+1&7]<<13;for(;h.length<8;)h.push(0);for(p=0;p<8&&h[p]===0;++p);for(p==8?h[7]=-1:h[p],c.x=h,c.i=0,p=256;p>0;--p)c.next()}u(l,o)}function r(o,l){return l.x=o.x.slice(),l.i=o.i,l}function i(o,l){o==null&&(o=+new Date);var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.x&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.xorshift7=i})(Zr,t)})(Ck);var CM=Ck.exports,Ik={exports:{}};Ik.exports;(function(t){(function(e,n,s){function a(o){var l=this;l.next=function(){var c=l.w,d=l.X,p=l.i,h,f;return l.w=c=c+1640531527|0,f=d[p+34&127],h=d[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,f=d[p]=f^h,l.i=p,f+(c^c>>>16)|0};function u(c,d){var p,h,f,g,y,m=[],w=128;for(d===(d|0)?(h=d,d=null):(d=d+"\0",h=0,w=Math.max(w,d.length)),f=0,g=-32;g<w;++g)d&&(h^=d.charCodeAt((g+32)%d.length)),g===0&&(y=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,g>=0&&(y=y+1640531527|0,p=m[g&127]^=h+y,f=p==0?f+1:0);for(f>=128&&(m[(d&&d.length||0)&127]=-1),f=127,g=4*128;g>0;--g)h=m[f+34&127],p=m[f=f+1&127],h^=h<<13,p^=p<<17,h^=h>>>15,p^=p>>>12,m[f]=h^p;c.w=y,c.X=m,c.i=f}u(l,o)}function r(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function i(o,l){o==null&&(o=+new Date);var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(c.X&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.xor4096=i})(Zr,t)})(Ik);var IM=Ik.exports,$k={exports:{}};$k.exports;(function(t){(function(e,n,s){function a(o){var l=this,u="";l.next=function(){var d=l.b,p=l.c,h=l.d,f=l.a;return d=d<<25^d>>>7^p,p=p-h|0,h=h<<24^h>>>8^f,f=f-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-h|0,l.d=h<<16^p>>>16^f,l.a=f-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):u+=o;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function r(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function i(o,l){var u=new a(o),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,h=(u.next()>>>0)/4294967296,f=(p+h)/(1<<21);while(f===0);return f},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&r(c,u),d.state=function(){return r(u,{})}),d}n&&n.exports?n.exports=i:this.tychei=i})(Zr,t)})($k);var $M=$k.exports,dT={exports:{}};const TM={},EM=Object.freeze(Object.defineProperty({__proto__:null,default:TM},Symbol.toStringTag,{value:"Module"})),AM=bb(EM);(function(t){(function(e,n,s){var a=256,r=6,i=52,o="random",l=s.pow(a,r),u=s.pow(2,i),c=u*2,d=a-1,p;function h(x,v,S){var N=[];v=v==!0?{entropy:!0}:v||{};var $=m(y(v.entropy?[x,b(n)]:x??w(),3),N),E=new f(N),A=function(){for(var L=E.g(r),W=l,U=0;L<u;)L=(L+U)*a,W*=a,U=E.g(1);for(;L>=c;)L/=2,W/=2,U>>>=1;return(L+U)/W};return A.int32=function(){return E.g(4)|0},A.quick=function(){return E.g(4)/4294967296},A.double=A,m(b(E.S),n),(v.pass||S||function(L,W,U,j){return j&&(j.S&&g(j,E),L.state=function(){return g(E,{})}),U?(s[o]=L,W):L})(A,$,"global"in v?v.global:this==s,v.state)}function f(x){var v,S=x.length,N=this,$=0,E=N.i=N.j=0,A=N.S=[];for(S||(x=[S++]);$<a;)A[$]=$++;for($=0;$<a;$++)A[$]=A[E=d&E+x[$%S]+(v=A[$])],A[E]=v;(N.g=function(L){for(var W,U=0,j=N.i,z=N.j,G=N.S;L--;)W=G[j=d&j+1],U=U*a+G[d&(G[j]=G[z=d&z+W])+(G[z]=W)];return N.i=j,N.j=z,U})(a)}function g(x,v){return v.i=x.i,v.j=x.j,v.S=x.S.slice(),v}function y(x,v){var S=[],N=typeof x,$;if(v&&N=="object")for($ in x)try{S.push(y(x[$],v-1))}catch{}return S.length?S:N=="string"?x:x+"\0"}function m(x,v){for(var S=x+"",N,$=0;$<S.length;)v[d&$]=d&(N^=v[d&$]*19)+S.charCodeAt($++);return b(v)}function w(){try{var x;return p&&(x=p.randomBytes)?x=x(a):(x=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(x)),b(x)}catch{var v=e.navigator,S=v&&v.plugins;return[+new Date,e,S,e.screen,b(n)]}}function b(x){return String.fromCharCode.apply(0,x)}if(m(s.random(),n),t.exports){t.exports=h;try{p=AM}catch{}}else s["seed"+o]=h})(typeof self<"u"?self:Zr,[],Math)})(dT);var RM=dT.exports,DM=vM,_M=SM,OM=NM,FM=CM,jM=IM,PM=$M,ko=RM;ko.alea=DM;ko.xor128=_M;ko.xorwow=OM;ko.xorshift7=FM;ko.xor4096=jM;ko.tychei=PM;var zg=ko;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LM=.001,pT=.1;function zM(t,e,n){return n==null&&(n=Tk()),zw(t,e,(s,a)=>Ek(s,a,n))}function Tk(){return R.backend.floatPrecision()===32?LM:pT}function zw(t,e,n){let s=!0;if((Bt(t)||Bt(e))&&(s=!1),Bt(t)&&Bt(e)&&(s=!0),s){const i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${o}`)}if(Array.isArray(t)&&Array.isArray(e)){const i=Ia(t),o=Ia(e);if(!Re(i,o))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${o}]`)}const a=Bt(t)?t:Ca(t),r=Bt(e)?e:Ca(e);if(a.length!==r.length)throw new Error(`Arrays have different lengths actual: ${a.length} vs expected: ${r.length}.
Actual:   ${a}.
Expected: ${r}.`);for(let i=0;i<r.length;++i){const o=a[i],l=r[i];if(!n(o,l))throw new Error(`Arrays differ: actual[${i}] = ${o}, expected[${i}] = ${l}.
Actual:   ${a}.
Expected: ${r}.`)}typeof expect<"u"&&expect().nothing()}function BM(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function MM(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return ga(t)||ga(t[0])||ga(e)||ga(e[0])?zw(t,n,(s,a)=>s==a):zw(t,e,(s,a)=>Ek(s,a,0))}function VM(t,e,n){if(n==null&&(n=Tk()),!Ek(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function Ek(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function WM(t,e,n){for(let s=0;s<t.length;s++)if(t[s]<e||t[s]>n)throw new Error(`Value out of range:${t[s]} low: ${e}, high: ${n}`)}function UM(t,e){const n=new Float32Array(t),s=new Float32Array(e);if(n.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${n.length}`);for(let a=0;a<s.length;a++)if(n[a]!==s[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${s[a]} but got ${n[a]} instead`)}function hT(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?hT(n):t[e]=xa(n)}return t}function GM(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",s=>n(e)),e.load()})}async function HM(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const KM=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:pT,createVideoElement:GM,encodeStrings:hT,expectArrayBuffersEqual:UM,expectArraysClose:zM,expectArraysEqual:MM,expectNumbersClose:VM,expectPromiseToFail:BM,expectValuesInRange:WM,play:HM,testEpsilon:Tk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ak{constructor(e,n,s,a,r){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=r||Math.random();this.random=zg.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const a=this.nextVal;return this.nextVal=NaN,a}let e,n,s=!1;for(;!s;){let a,r,i;do a=2*this.random()-1,r=2*this.random()-1,i=a*a+r*r;while(i>=1||i===0);const o=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*a*o,n=this.mean+this.stdDev*r*o,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class qM{constructor(e,n,s,a){this.alpha=e,this.beta=1/n,this.dtype=s;const r=a||Math.random();this.randu=zg.alea(r.toString()),this.randn=new Ak(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,s,a,r,i;for(;;){do a=this.randn.nextValue(),i=1+this.c*a;while(i<=0);if(i*=i*i,e=a*a,n=1-.331*e*e,s=.5*e+this.d*(1-i+Math.log(i)),r=this.randu(),r<n||Math.log(r)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class JM{constructor(e=0,n=1,s,a){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=zg.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XM(t,e,n=1,s="float32",a){if(es(t),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const r=new qM(e,n,s,a),i=Se(t,s);for(let o=0;o<i.values.length;o++)i.values[o]=r.nextValue();return i.toTensor()}const fT=D({randomGamma_:XM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YM(t,e=0,n=1,s,a){if(es(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const r=new Ak(e,n,s,!1,a),i=Se(t,s);for(let o=0;o<i.values.length;o++)i.values[o]=r.nextValue();return i.toTensor()}const Bg=D({randomNormal_:YM});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QM(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return Bg(t,0,1,e,n)}const mT=D({randomStandardNormal_:QM});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZM(t,e=0,n=1,s="float32",a){es(t);const r=Se(t,s),i=new JM(e,n,null,a);for(let o=0;o<r.values.length;o++)r.values[o]=i.nextValue();return r.toTensor()}const ci=D({randomUniform_:ZM});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4(t,e,n,s){return ci(t,e,n,"int32",s)}const gT=D({randomUniformInt_:e4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function no(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const a={start:t,stop:e,step:n,dtype:s};return R.runKernel(ag,{},a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4(t){const n={input:I(t,"input","real")};return R.runKernel(rg,n)}const bl=D({real_:t4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4(t){const n={x:I(t,"x","reciprocal")};return R.runKernel(lu,n)}const Rk=D({reciprocal_:n4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4(t){const n={x:I(t,"x","relu")};return R.runKernel(uu,n)}const la=D({relu_:s4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4(t){const n={x:I(t,"x","relu6")};return R.runKernel(cu,n)}const Mg=D({relu6_:a4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r4(t,e){const s={x:I(t,"x","reverse")},a={dims:e};return R.runKernel(ip,s,a)}const hs=D({reverse_:r4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4(t){const e=I(t,"x","reverse");return C(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),hs(e,0)}const yT=D({reverse1d_:i4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4(t,e){const n=I(t,"x","reverse");return C(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),hs(n,e)}const wT=D({reverse2d_:o4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4(t,e){const n=I(t,"x","reverse");return C(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),hs(n,e)}const bT=D({reverse3d_:l4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u4(t,e){const n=I(t,"x","reverse");return C(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),hs(n,e)}const xT=D({reverse4d_:u4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c4(t){const n={x:I(t,"x","round")};return R.runKernel(du,n)}const Vg=D({round_:c4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4(t){const n={x:I(t,"x","rsqrt","float32")};return R.runKernel(pu,n)}const Wg=D({rsqrt_:d4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p4(t){const n={x:I(t,"x","selu")};return R.runKernel(hu,n)}const Ug=D({selu_:p4});function h4(t,e,n,s,a,r=[1,1],i="NHWC"){const o=I(t,"x","separableConv2d"),l=I(e,"depthwiseFilter","separableConv2d"),u=I(n,"pointwiseFilter","separableConv2d");let c=o,d=!1;if(o.rank===3&&(d=!0,c=F(o,[1,o.shape[0],o.shape[1],o.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");C(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),C(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),C(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),C(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),C(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const p=l.shape[2],h=l.shape[3];C(u.shape[2]===p*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*h}, but got ${u.shape[2]}.`);const f=$u(c,l,s,a,i,r),y=Qa(f,u,1,"valid",i);return d?F(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Gg=D({separableConv2d_:h4});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function f4(t,e){const n=I(t,"x","setdiff1d"),s=I(e,"y","setdiff1d");C(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),C(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),C(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const a=await n.data(),r=await s.data(),i=new Set(r);let o=0;for(let c=0;c<a.length;c++)i.has(a[c])||o++;const l=new Tt([o],n.dtype),u=new Tt([o],"int32");for(let c=0,d=0;c<a.length;c++)i.has(a[c])||(l.values[d]=a[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const kT=f4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m4(t){const n={x:I(t,"x","sign")};return R.runKernel(gu,n)}const Dk=D({sign_:m4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g4(t){const n={x:I(t,"x","sin","float32")};return R.runKernel(fu,n)}const Hg=D({sin_:g4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4(t){const n={x:I(t,"x","sinh")};return R.runKernel(mu,n)}const Kg=D({sinh_:y4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w4(t,e,n){const s=I(t,"x","slice1d");return C(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),_e(s,[e],[n])}const Dp=D({slice1d_:w4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4(t,e,n){const s=I(t,"x","slice2d");return C(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),_e(s,e,n)}const qg=D({slice2d_:b4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4(t,e,n){const s=I(t,"x","slice3d");return C(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),_e(s,e,n)}const _p=D({slice3d_:x4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k4(t,e,n){const s=I(t,"x","slice4d");return C(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),_e(s,e,n)}const xl=D({slice4d_:k4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v4(t,e=-1){const n=I(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},a={dim:e};return R.runKernel(pp,s,a)}const Op=D({softmax_:v4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S4(t){C(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return R.runKernel(Bm,e)}const Fp=D({fft_:S4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4(t){C(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return R.runKernel(Um,e)}const kl=D({ifft_:N4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const a=F(t,[n,e]);s=kl(a)}else{const a=[n,2*(e-1)],r=F(bl(t),[n,e]),i=F(Sp(t),[n,e]),o=hs(_e(r,[0,1],[n,e-2]),1),l=_(hs(_e(i,[0,1],[n,e-2]),1),we(-1)),u=xt([r,o],1),c=xt([i,l],1),d=F(Ya(u,c),[a[0],a[1]]);s=kl(d)}if(s=bl(s),t.rank===3&&t.shape[0]!==0){const a=s,r=t.shape[0];s=F(s,[r,s.shape[0]/r,s.shape[1]]),a.dispose()}return s}const Jg=D({irfft_:C4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I4(t,e,n=0){const a={x:I(t,"x","split")},r={numOrSizeSplits:e,axis:n};return R.runKernel(dp,a,r)}const An=D({split_:I4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4(t,e){C(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let a;if(e!=null&&e<n){const f=t.shape.map(y=>0),g=t.shape.map(y=>y);g[t.shape.length-1]=e,a=_e(t,f,g),n=e}else if(e!=null&&e>n){const f=t.shape.map(g=>g);f[t.shape.length-1]=e-n,a=xt([t,$t(f)],t.shape.length-1),n=e}else a=t;const r=Oe(a),i=F(Ya(a,r),[s,n]),o=Fp(i),l=Math.floor(n/2)+1,u=bl(o),c=Sp(o),d=An(u,[l,n-l],u.shape.length-1),p=An(c,[l,n-l],c.shape.length-1),h=a.shape.slice();return h[a.shape.length-1]=l,F(Ya(d[0],p[0]),h)}const jp=D({rfft_:$4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T4(t,e){let n=I(t,"a","squaredDifference"),s=I(e,"b","squaredDifference");[n,s]=pt(n,s),ve(n.shape,s.shape);const a={a:n,b:s},r={};return R.runKernel(xu,a,r)}const Xg=D({squaredDifference_:T4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E4(t,e){const n=I(t,"x","squeeze","string_or_numeric");return F(n,nr(n.shape,e).newShape)}const di=D({squeeze_:E4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A4(t,e=0){const n=Jc(t,"tensors","stack","string_or_numeric");C(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&C(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,a={axis:e};return R.runKernel(Zd,s,a)}const Fn=D({stack_:A4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4(t,e=0){const s={x:I(t,"x","step")},a={alpha:e};return R.runKernel(Cu,s,a)}const vo=D({step_:R4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D4(t,e,n,s,a=0,r=0,i=0,o=0,l=0){const c={x:I(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:a,endMask:r,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};return R.runKernel(yg,c,d)}const _k=D({stridedSlice_:D4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4(t){const n={x:I(t,"x","tan","float32")};return R.runKernel(vu,n)}const Ok=D({tan_:_4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ln(t,e){fo(t);const n=Ia(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ii(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sl(t,e,n){if(fo(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Ia(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ii(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fk(t,e,n){if(fo(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Ia(t,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ii(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vT(t,e,n){if(fo(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Ia(t,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ii(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ST(t,e,n){if(fo(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Ia(t,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ii(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NT(t,e,n){if(fo(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Ia(t,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,ii(t,e,s,n)}function jk(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,r=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(r+` update.rank < ${a}. `);if(t.length<s+(n.rank-a))throw new Error(r+` Output shape length < ${s+(n.rank-a)}`);if(n.rank!==a+t.length-s)throw new Error(r+` update.rank != ${a+t.length-s}`);for(let i=0;i<a;++i)if(n.shape[i]!==e.shape[i])throw new Error(r+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-a;++i)if(n.shape[i+a]!==t[i+s])throw new Error(r+` updates.shape[${i+a}] (${n.shape[i+a]}) != shape[${i+a}] (${t[i+a]})`)}function Yg(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}jk(n,e,t)}function pi(t,e,n){const s=e.shape.length,a=s>1?e.shape[s-1]:1,r=n.length;let i=1;for(let d=a;d<r;++d)i*=n[d];const o=a<1?1:a,l=H(e.shape)/o,u=[...ye(n.slice(0,a)),1],c=H(n);return{sliceRank:a,numUpdates:l,sliceSize:i,strides:u,outputSize:c}}const O4=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:pi,validateInput:Yg,validateUpdateShape:jk},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F4(t,e,n){const s=I(t,"tensor","tensorScatterupdate"),a=I(e,"indices","tensorScatterupdate","int32"),r=I(n,"updates","tensorScatterupdate");if(Yg(r,a,s.shape),s.dtype!==r.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${r.dtype}.`);const i={tensor:s,indices:a,updates:r},o={};return R.runKernel(ug,i,o)}const CT=D({tensorScatterUpdate_:F4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j4(t,e=1,n=!0){const s=I(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const a=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${e}`);const r={x:s},i={k:e,sorted:n},[o,l]=R.runKernel(kg,r,i);return{values:o,indices:l}}const Pk=D({topk_:j4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4(t,e=0,n=1,s,a){if(es(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const r=new Ak(e,n,s,!0,a),i=Se(t,s);for(let o=0;o<i.values.length;o++)i.values[o]=r.nextValue();return i.toTensor()}const Qg=D({truncatedNormal_:P4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L4(t,e=0){const n=I(t,"x","unique","string_or_numeric");C(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},a={axis:e},[r,i]=R.runKernel(Sg,s,a);return{values:r,indices:i}}const Lk=D({unique_:L4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z4(t,e,n){const s=I(t,"x","unsortedSegmentSum"),a=I(e,"segmentIds","unsortedSegmentSum","int32");C(qi(n),()=>"numSegments must be of dtype int");const r={x:s,segmentIds:a},i={numSegments:n};return R.runKernel(mp,r,i)}const Zg=D({unsortedSegmentSum_:z4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B4(t,e=0){const n=I(t,"x","unstack","string_or_numeric");C(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},a={axis:e};return R.runKernel(fp,s,a)}const fs=D({unstack_:B4});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IT(t,e){return Lg(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zk(t,e=!0,n,s){return R.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e0(t,e){const n=[];for(let r=0;r<e.length;r++)e[r]&&n.push(r);const s=Se(t,"int32"),a=Se([n.length,t.length],"int32");for(let r=0;r<n.length;r++){const i=s.indexToLoc(n[r]),o=r*t.length;a.values.set(i,o)}return a.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function M4(t){const e=I(t,"condition","whereAsync","bool"),n=await e.data(),s=e0(e.shape,n);return t!==e&&e.dispose(),s}const Bk=M4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function V4(t,e,n){const s=I(t,"tensor","boolMask"),a=I(e,"mask","boolMask","bool"),r=n??0,i=a.rank,o=s.shape;C(i>0,()=>"mask cannot be scalar"),en(o.slice(r,r+i),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=r;g<r+i;g++)l*=o[g];const u=o.slice(0,r).concat([l],o.slice(r+i)),c=F(s,u),d=F(a,[-1]),p=await Bk(d),h=di(p,[1]),f=Ru(c,h,r);return t!==s&&s.dispose(),e!==a&&a.dispose(),h.dispose(),c.dispose(),d.dispose(),p.dispose(),f}const $T=V4;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4(t,e,n){const s=I(t,"x","transpose");if(e==null&&(e=s.shape.map((i,o)=>o).reverse()),C(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{C(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const a={x:s},r={perm:e};return s.dtype==="complex64"?B(()=>{let i=bl(s),o=Sp(s);return i=R.runKernel(Li,{x:i},r),o=R.runKernel(Li,{x:o},r),n&&(o=Ye(o)),Ya(i,o)}):R.runKernel(Li,a,r)}const De=D({transpose_:W4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U4(t,e,n,s,a=!0){const r=I(t,"v","movingAverage"),i=I(e,"x","movingAverage"),o=I(n,"decay","movingAverage");k$(r,i),C(Re(r.shape,i.shape),()=>"Shape mismatch in v and x");const l=we(1),u=ce(l,o);let c=_(ce(i,r),u);if(a){C(s!=null,()=>"When using zeroDebias: true, step is required.");const d=I(s,"step","movingAverage");c=ge(c,ce(l,$a(o,d)))}return Z(r,c)}const TT=D({movingAverage_:U4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G4(t,e,n){es(n);const s=I(t,"indices","scatterND","int32"),a=I(e,"updates","scatterND");Yg(a,s,n);const r={indices:s,updates:a},i={shape:n};return R.runKernel(lg,r,i)}const ET=D({scatterND_:G4});function H4(t,e,n,s){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const a=t.rank>0?t.shape[0]:1,r=t.rank>1?t.shape[1]:1;if(n.length!==r)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${r}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===a))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${a}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K4(t,e,n,s=0){es(n);const a=I(t,"sparseIndices","sparseToDense","int32"),r=I(e,"sparseValues","sparseToDense","string_or_numeric"),i=I(s,"defaultValue","sparseToDense",r.dtype);H4(a,r,n,i);const o={sparseIndices:a,sparseValues:r,defaultValue:i},l={outputShape:n};return R.runKernel(mg,o,l)}const AT=D({sparseToDense_:K4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q4(t,e){const n=I(e,"indices","gatherND","int32"),a={params:I(t,"x","gatherND","string_or_numeric"),indices:n};return R.runKernel(Wm,a)}const RT=D({gatherND_:q4});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J4(t,e){if(e==null)return t.shape.slice();if(Re(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X4(t,e,n,s){const a=I(t,"x","dropout");if(C(a.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),C(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof ze?a.clone():a;const r=J4(a,n),i=1-e,o=ge(Au(Z(ci(r,0,1,"float32",s),i)),i);return _(a,o)}const Mk=D({dropout_:X4});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vk(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function t0(t,e,n){const s=1-t%2,a=new Float32Array(t);for(let r=0;r<t;++r){const i=2*Math.PI*r/(t+s-1);a[r]=e-n*Math.cos(i)}return ln(a,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Y4(t,e,n=1){const s=I(t,"predictions","inTopK"),a=I(e,"targets","inTopK");C(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),C(s.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${a.rank}`),en(s.shape.slice(0,s.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const r=s.shape[s.shape.length-1];C(n>0&&n<=r,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${r}), but got ${n}`);const i=await s.data(),o=await a.data(),[l,u]=[i.length/r,r],c=Wt("bool",l);for(let d=0;d<l;d++){const p=d*u,h=i.subarray(p,p+u),f=[];for(let g=0;g<h.length;g++)f.push({value:h[g],index:g});f.sort((g,y)=>y.value-g.value),c[d]=0;for(let g=0;g<n;g++)if(f[g].index===o[d]){c[d]=1;break}}return t!==s&&s.dispose(),e!==a&&a.dispose(),Rs(c,a.shape,"bool")}const DT=Y4;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q4(t,e,n,s,a,r="NHWC",i){let o=t;t.rank===3&&(o=F(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=F(e,[1,e.shape[0],e.shape[1],e.shape[2]])),C(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),C(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),C(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=r==="NHWC"?o.shape[3]:o.shape[1],c=r==="NHWC"?l.shape[3]:l.shape[1];C(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),C(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Nn("conv2dDerFilter",a,i);const d={x:o,dy:l},p={strides:s,pad:a,dataFormat:r,dimRoundingMode:i,filterShape:n};return R.runKernel($m,d,p)}const Wk=D({conv2DBackpropFilter_:Q4});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n0(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return _(t,vo(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function s0(t,e){let n=e;const s=Et(t.shape,e.shape);return s.length>0&&(n=pe(n,s)),F(n,t.shape)}function a0(t,e,n,s){if(e==="linear")return t;if(e==="relu")return la(t);if(e==="elu")return Tu(t);if(e==="relu6")return Mg(t);if(e==="prelu")return Rp(t,n);if(e==="leakyrelu")return Np(t,s);if(e==="sigmoid")return Zs(t);throw new Error(`Unknown fused activation ${e}.`)}const r0=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4({x:t,filter:e,strides:n,pad:s,dataFormat:a="NHWC",dilations:r=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",r0(R.state.gradientDepth,l)===!1){C(a==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let S=Qa(t,e,n,s,a,r,i);return o!=null&&(S=Z(S,o)),a0(S,l,u,c)}const d=I(t,"x","conv2d","float32"),p=I(e,"filter","conv2d","float32");let h=d,f=!1;d.rank===3&&(f=!0,h=F(d,[1,d.shape[0],d.shape[1],d.shape[2]])),C(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),C(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Nn("fused conv2d",s,i);const g=a==="NHWC"?h.shape[3]:h.shape[1];C(p.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${p.shape[2]}.`),C(tn(n,r),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`);const y=Gt(h.shape,p.shape,n,r,s,i);let m;o!=null&&(m=I(o,"bias","fused conv2d"),[m]=pt(m,d),a==="NHWC"?ve(y.outShape,m.shape):(C(m.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${m.shape.length}.`),C(m.shape.length===0||m.shape[0]===y.outChannels||m.shape[0]===1,()=>`Error in fused conv2d: bias shape (${m.shape}) is not compatible with the number of output channels (${y.outChannels})`)));let w;if(u!=null){const S=u.shape;if(C(S.length<=1||S.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${S.length}.`),S.length===1)C(S[0]===1||S[0]===y.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the number of output channels (${y.outChannels}).`);else if(S.length===3)try{ve(S,y.outShape)}catch{const $=`Error in fused conv2d: PReLU activation weights (${S}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error($)}w=I(u,"prelu weights","fused conv2d")}const b=(S,N)=>{C(a==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);const[$,E,A,L]=N,W=n0(S,A,l);C(Gr(r),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const U=tk(E.shape,W,$,n,s),j=Wk(E,W,$.shape,n,s),z=[U,j];if(L!=null){const G=s0(L,W);z.push(G)}return z},x={x:h,filter:p,bias:m,preluActivationWeights:w},v={strides:n,pad:s,dataFormat:a,dilations:r,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return o==null?Ta((N,$,E)=>{let A=R.runKernel(Uc,x,v);return E([$,N,A]),f&&(A=F(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:b}})(h,p):Ta((N,$,E,A)=>{let L=R.runKernel(Uc,x,v);return A([$,N,L,E]),f&&(L=F(L,[L.shape[1],L.shape[2],L.shape[3]])),{value:L,gradFunc:b}})(h,p,m)}const _T=D({fusedConv2d_:Z4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eV(t,e,n,s,a,r=[1,1],i){let o=t;t.rank===3&&(o=F(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=F(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:o,dy:l},c={strides:s,pad:a,dimRoundingMode:i,dilations:r,filterShape:n};return R.runKernel(Om,u,c)}const OT=D({depthwiseConv2dNativeBackpropFilter_:eV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tV(t,e,n,s,a,r=[1,1],i){let o=e,l=!1;e.rank===3&&(l=!0,o=F(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:o,filter:n},c={strides:s,pad:a,dimRoundingMode:i,dilations:r,inputShape:t},d=R.runKernel(Fm,u,c);return l?F(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const FT=D({depthwiseConv2dNativeBackpropInput_:tV});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nV({x:t,filter:e,strides:n,pad:s,dataFormat:a="NHWC",dilations:r=[1,1],dimRoundingMode:i,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(r0(R.state.gradientDepth,l)===!1){let v=$u(t,e,n,s,a,r,i);return o!=null&&(v=Z(v,o)),a0(v,l,u,c)}const d=I(t,"x","depthwiseConv2d","float32"),p=I(e,"filter","depthwiseConv2d","float32");let h=d,f=!1;d.rank===3&&(f=!0,h=F(d,[1,d.shape[0],d.shape[1],d.shape[2]])),C(h.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),C(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),C(h.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),r==null&&(r=[1,1]),C(tn(n,r),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${r}'`),Nn("fused depthwiseConv2d",s,i);const g=Gt(h.shape,p.shape,n,r,s,i,!0);let y;o!=null&&(y=I(o,"bias","fused conv2d"),[y]=pt(y,d),ve(g.outShape,y.shape));let m;u!=null&&(m=I(u,"prelu weights","fused depthwiseConv2d"));const w=(v,S)=>{C(Gr(r),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${r}'`);const[N,$,E,A]=S,L=n0(v,E,l),W=FT($.shape,L,N,n,s,r,i),U=OT($,L,N.shape,n,s,r,i);if(A!=null){const j=s0(y,L);return[W,U,j]}return[W,U]},b={x:h,filter:p,bias:y,preluActivationWeights:m},x={strides:n,pad:s,dataFormat:a,dilations:r,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return o==null?Ta((S,N,$)=>{let E=R.runKernel(Gc,b,x);return $([N,S,E]),f&&(E=F(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:w}})(h,p):Ta((S,N,$,E)=>{let A=R.runKernel(Gc,b,x);return E([N,S,A,$]),f&&(A=F(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:w}})(h,p,y)}const sV=D({fusedDepthwiseConv2d_:nV});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:a,activation:r="linear",preluActivationWeights:i,leakyreluAlpha:o=.2}){if(r0(R.state.gradientDepth,r)===!1){let L=$e(t,e,n,s);return a!=null&&(L=Z(L,a)),a0(L,r,i,o)}let l=I(t,"a","fused matMul"),u=I(e,"b","fused matMul");[l,u]=pt(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?u.shape[u.rank-1]:u.shape[u.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=s?u.shape[u.rank-2]:u.shape[u.rank-1],f=l.shape.slice(0,-2),g=u.shape.slice(0,-2),y=H(f),m=H(g);C(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${s} must match.`);const b=ve(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,h]),x=n?F(l,[y,c,p]):F(l,[y,p,c]),v=s?F(u,[m,h,d]):F(u,[m,d,h]);let S;a!=null&&(S=I(a,"bias","fused matMul"),[S]=pt(S,l),ve(b,S.shape));let N;i!=null&&(N=I(i,"prelu weights","fused matMul"));const $=(L,W)=>{const[U,j,z,G]=W,J=n0(F(L,z.shape),z,r);let O,M;if(!n&&!s?(O=$e(J,j,!1,!0),M=$e(U,J,!0,!1)):!n&&s?(O=$e(J,j,!1,!1),M=$e(J,U,!0,!1)):n&&!s?(O=$e(j,J,!1,!0),M=$e(U,J,!1,!1)):(O=$e(j,J,!0,!0),M=$e(J,U,!0,!0)),a!=null){const K=s0(G,J);return[O,M,K]}else return[O,M]},E={a:x,b:v,bias:S,preluActivationWeights:N},A={transposeA:n,transposeB:s,activation:r,leakyreluAlpha:o};return a==null?Ta((W,U,j)=>{const z=R.runKernel(Wc,E,A);return j([W,U,z]),{value:F(z,b),gradFunc:$}})(x,v):Ta((W,U,j,z)=>{const G=R.runKernel(Wc,E,A);return z([W,U,G,j]),{value:F(G,b),gradFunc:$}})(x,v,S)}const Bw=D({fusedMatMul_:aV});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jT=Object.freeze(Object.defineProperty({__proto__:null,conv2d:_T,depthwiseConv2d:sV,matMul:Bw},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rV(t){return t0(t,.54,.46)}const iV=D({hammingWindow_:rV});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(t){return t0(t,.5,.5)}const PT=D({hannWindow_:oV});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(t,e,n,s=!1,a=0){let r=0;const i=[];for(;r+e<=t.size;)i.push(_e(t,r,e)),r+=n;if(s)for(;r<t.size;){const o=r+e-t.size,l=xt([_e(t,r,e-o),bo([o],a)]);i.push(l),r+=n}return i.length===0?sl([],[0,e]):F(xt(i),[i.length,e])}const LT=D({frame_:lV});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uV(t,e,n,s,a=PT){s==null&&(s=Vk(e));const r=LT(t,e,n),i=_(r,a(e));return jp(i,s)}const cV=D({stft_:uV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(t,e,n,s,a="bilinear",r=0){const i=I(t,"image","cropAndResize"),o=I(e,"boxes","cropAndResize","float32"),l=I(n,"boxInd","cropAndResize","int32"),u=o.shape[0];C(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),C(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`),C(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`),C(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),C(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),C(a==="bilinear"||a==="nearest",()=>`method must be bilinear or nearest, but was ${a}`);const c={image:i,boxes:o,boxInd:l},d={method:a,extrapolationValue:r,cropSize:s};return R.runKernel(Rm,c,d)}const pV=D({cropAndResize_:dV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(t){const e=I(t,"image","flipLeftRight","float32");C(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return R.runKernel(Vm,n,{})}const fV=D({flipLeftRight_:hV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(t){const e=I(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];C(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),C(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const a=new Array(e.rank);return a.fill(1,0,n),a[n]=3,os(e,a)}const gV=D({grayscaleToRGB_:mV});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yV(t){const e=I(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];C(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),C(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const a=e.dtype,r=re(e,"float32"),i=ln([.2989,.587,.114]);let o;switch(e.rank){case 2:o=Ci("ij,j->i",r,i);break;case 3:o=Ci("ijk,k->ij",r,i);break;case 4:o=Ci("ijkl,l->ijk",r,i);break;case 5:o=Ci("ijklm,m->ijkl",r,i);break;case 6:o=Ci("ijklmn,n->ijklm",r,i);break;default:throw new Error("Not a valid tensor rank.")}return o=on(o,-1),re(o,a)}const wV=D({rgbToGrayscale_:yV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bV(t,e,n=0,s=.5){const a=I(t,"image","rotateWithOffset","float32");C(a.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);const r={image:a},i={radians:e,fillValue:n,center:s};return R.runKernel(Ng,r,i)}const xV=D({rotateWithOffset_:bV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Du(t,e,n,s,a,r){s==null&&(s=.5),a==null&&(a=Number.NEGATIVE_INFINITY),r==null&&(r=0);const i=t.shape[0];return n=Math.min(n,i),C(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),C(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),C(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),C(e.rank===1,()=>"scores must be a 1D tensor"),C(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),C(0<=r&&r<=1,()=>`softNmsSigma must be in [0, 1], but was '${r}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:a,softNmsSigma:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kV(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY){const r=I(t,"boxes","nonMaxSuppression","float32"),i=I(e,"scores","nonMaxSuppression","float32"),o=Du(r,i,n,s,a);n=o.maxOutputSize,s=o.iouThreshold,a=o.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:a};return R.runKernel(Qm,{boxes:r,scores:i},l)}const vV=D({nonMaxSuppression_:kV});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(t,e,n){const s=NV(t,e,n),a=s<0?-(s+1):s;t.splice(a,0,e)}function NV(t,e,n){return IV(t,e,n||CV)}function CV(t,e){return t>e?1:t<e?-1:0}function IV(t,e,n){let s=0,a=t.length,r=0,i=!1;for(;s<a;){r=s+(a-s>>>1);const o=n(e,t[r]);o>0?s=r+1:(a=r,i=!o)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0(t,e,n,s,a){return Uk(t,e,n,s,a,0)}function o0(t,e,n,s,a,r){return Uk(t,e,n,s,a,0,!1,r,!0)}function l0(t,e,n,s,a,r){return Uk(t,e,n,s,a,r,!0)}function Uk(t,e,n,s,a,r,i=!1,o=!1,l=!1){const u=[];for(let y=0;y<e.length;y++)e[y]>a&&u.push({score:e[y],boxIndex:y,suppressBeginIndex:0});u.sort(X2);const c=r>0?-.5/r:0,d=[],p=[];for(;d.length<n&&u.length>0;){const y=u.pop(),{score:m,boxIndex:w,suppressBeginIndex:b}=y;if(m<a)break;let x=!1;for(let v=d.length-1;v>=b;--v){const S=$V(t,w,d[v]);if(S>=s){x=!0;break}if(y.score=y.score*TV(s,c,S),y.score<=a)break}y.suppressBeginIndex=d.length,x||(y.score===m?(d.push(w),p.push(y.score)):y.score>a&&SV(u,y,X2))}const h=d.length,f=n-h;o&&f>0&&(d.push(...new Array(f).fill(0)),p.push(...new Array(f).fill(0)));const g={selectedIndices:d};return i&&(g.selectedScores=p),l&&(g.validOutputs=h),g}function $V(t,e,n){const s=t.subarray(e*4,e*4+4),a=t.subarray(n*4,n*4+4),r=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),o=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),u=Math.min(a[0],a[2]),c=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),h=(o-r)*(l-i),f=(d-u)*(p-c);if(h<=0||f<=0)return 0;const g=Math.max(r,u),y=Math.max(i,c),m=Math.min(o,d),w=Math.min(l,p),b=Math.max(m-g,0)*Math.max(w-y,0);return b/(h+f-b)}function TV(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function X2(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function EV(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY){const r=I(t,"boxes","nonMaxSuppressionAsync"),i=I(e,"scores","nonMaxSuppressionAsync"),o=Du(r,i,n,s,a);n=o.maxOutputSize,s=o.iouThreshold,a=o.scoreThreshold;const l=await Promise.all([r.data(),i.data()]),u=l[0],c=l[1],{selectedIndices:d}=i0(u,c,n,s,a);return r!==t&&r.dispose(),i!==e&&i.dispose(),ln(d,"int32")}const AV=EV;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RV(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY,r=0){const i=I(t,"boxes","nonMaxSuppression"),o=I(e,"scores","nonMaxSuppression"),l=Du(i,o,n,s,a,r);n=l.maxOutputSize,s=l.iouThreshold,a=l.scoreThreshold,r=l.softNmsSigma;const u={boxes:i,scores:o},c={maxOutputSize:n,iouThreshold:s,scoreThreshold:a,softNmsSigma:r},d=R.runKernel(eg,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const DV=D({nonMaxSuppressionWithScore_:RV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _V(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY,r=0){const i=I(t,"boxes","nonMaxSuppressionAsync"),o=I(e,"scores","nonMaxSuppressionAsync"),l=Du(i,o,n,s,a,r);n=l.maxOutputSize,s=l.iouThreshold,a=l.scoreThreshold,r=l.softNmsSigma;const u=await Promise.all([i.data(),o.data()]),c=u[0],d=u[1],{selectedIndices:p,selectedScores:h}=l0(c,d,n,s,a,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),{selectedIndices:ln(p,"int32"),selectedScores:ln(h)}}const OV=_V;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FV(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY,r=!1){const i=I(t,"boxes","nonMaxSuppression"),o=I(e,"scores","nonMaxSuppression"),l=Du(i,o,n,s,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,p={boxes:i,scores:o},h={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:r},f=R.runKernel(Zm,p,h);return{selectedIndices:f[0],validOutputs:f[1]}}const jV=D({nonMaxSuppressionPadded_:FV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function PV(t,e,n,s=.5,a=Number.NEGATIVE_INFINITY,r=!1){const i=I(t,"boxes","nonMaxSuppressionAsync"),o=I(e,"scores","nonMaxSuppressionAsync"),l=Du(i,o,n,s,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[p,h]=await Promise.all([i.data(),o.data()]),{selectedIndices:f,validOutputs:g}=o0(p,h,u,c,d,r);return i!==t&&i.dispose(),o!==e&&o.dispose(),{selectedIndices:ln(f,"int32"),validOutputs:we(g,"int32")}}const LV=PV;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zV(t,e,n=!1,s=!1){const a=I(t,"images","resizeBilinear");C(a.rank===3||a.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),C(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),C(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let r=a,i=!1;a.rank===3&&(i=!0,r=F(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const o={images:r},l={alignCorners:n,halfPixelCenters:s,size:e},u=R.runKernel(rp,o,l);return i?F(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const zT=D({resizeBilinear_:zV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BV(t,e,n=!1,s=!1){const a=I(t,"images","resizeNearestNeighbor");C(a.rank===3||a.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),C(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),C(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),C(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let r=a,i=!1;a.rank===3&&(i=!0,r=F(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const o={images:r},l={alignCorners:n,halfPixelCenters:s,size:e},u=R.runKernel(ap,o,l);return i?F(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const BT=D({resizeNearestNeighbor_:BV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MV(t,e="binary",n=!1,s=.5){const a=I(t,"image","threshold"),r=.2989,i=.587,o=.114,l=a.shape[0]*a.shape[1];let u=_(ln([s]),255),c,d,p,h;if(C(a.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),C(a.shape[2]===3||a.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),C(a.dtype==="int32"||a.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),C(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),a.shape[2]===3){[c,d,p]=An(a,[1,1,1],-1);const y=_(c,r),m=_(d,i),w=_(p,o);h=Z(Z(y,m),w)}else h=t;if(e==="otsu"){const y=Jx(re(Vg(h),"int32"),Rs([]),256);u=VV(y,l)}const f=n?ui(h,u):zn(h,u);return re(_(f,255),"int32")}function VV(t,e){let n=ln([-1]),s=ln([0]),a=ln([0]),r,i,o,l,u,c;for(let d=0;d<t.size-1;d++){r=_e(t,0,d+1),i=_e(t,d+1),u=ge(pe(r),e),c=ge(pe(i),e);const p=pe(_(r,no(0,r.size)));o=ge(p,pe(r));const h=bo(i.shape,r.size),f=Z(no(0,i.size),h),g=_(i,f);l=ge(pe(g),pe(i));const y=ce(o,l),m=ce(o,l),w=_(u,c);a=_(_(w,y),m);const b=zn(a,s);s=Qt(b,a,s),n=Qt(b,ln([d]),n)}return n}const WV=D({threshold_:MV});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UV(t,e,n="nearest",s="constant",a=0,r){const i=I(t,"image","transform","float32"),o=I(e,"transforms","transform","float32");C(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),C(o.rank===2&&(o.shape[0]===i.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),C(r==null||r.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${r}.`);const l={image:i,transforms:o},u={interpolation:n,fillMode:s,fillValue:a,outputShape:r};return R.runKernel(vg,l,u)}const GV=D({transform_:UV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HV(t,e,n){const s=I(t,"a","bandPart");C(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const a=s.shape,[r,i]=s.shape.slice(-2);let o,l;typeof e=="number"?(C(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),C(e<=r,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${r}).`),o=I(e<0?r:e,"numLower","bandPart")):(C(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Qt(yl(e,0),r,Kr(e,r))),typeof n=="number"?(C(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),C(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=I(n<0?i:n,"numUpper","bandPart")):(C(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Qt(yl(n,0),i,Kr(n,i)));const u=F(no(0,r,1,"int32"),[-1,1]),c=no(0,i,1,"int32"),d=ce(u,c),p=na(ui(d,o),ir(d,Ye(l))),h=$t([r,i],s.dtype);return F(Fn(fs(F(s,[-1,r,i])).map(f=>Qt(p,f,h))),a)}const KV=D({bandPart_:HV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qV(t){let e;if(Array.isArray(t)){e=!1,C(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const a=t[0].shape[0];for(let r=1;r<t.length;++r)C(t[r].shape[0]===a,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[r].shape[0]} vs. ${a})`)}else e=!0,t=An(t,t.shape[0],0).map(a=>di(a,[0]));C(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let a=0;a<t.length;++a)n.push(R.tidy(()=>{let r=s[a];if(a>0)for(let i=0;i<a;++i){const o=_(pe(_(n[i],r)),n[i]);r=ce(r,o)}return ge(r,Eu(r,"euclidean"))}));return e?Fn(n,0):n}const JV=D({gramSchmidt_:qV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XV(t,e=!1){if(C(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return Y2(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),s=fs(F(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],r=[];s.forEach(l=>{const[u,c]=Y2(l,e);a.push(u),r.push(c)});const i=F(Fn(a,0),t.shape),o=F(Fn(r,0),t.shape);return[i,o]}}function Y2(t,e=!1){return R.tidy(()=>{C(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let a=Og(n),r=ka(t);const i=sl([[1]],[1,1]);let o=ka(i);const l=n>=s?s:n;for(let u=0;u<l;++u){const c=r,d=o,p=a;[o,r,a]=R.tidy(()=>{const h=_e(r,[u,u],[n-u,1]),f=Eu(h),g=_e(r,[u,u],[1,1]),y=Qt(zn(g,0),sl([[-1]]),sl([[1]])),m=ce(g,_(y,f)),w=ge(h,m);w.shape[0]===1?o=ka(i):o=xt([i,_e(w,[1,0],[w.shape[0]-1,w.shape[1]])],0);const b=Ye(ge($e(y,m),f)),x=_e(r,[u,0],[n-u,s]),v=_(b,o),S=De(o);if(u===0)r=ce(x,$e(v,$e(S,x)));else{const E=ce(x,$e(v,$e(S,x)));r=xt([_e(r,[0,0],[u,s]),E],0)}const N=De(v),$=_e(a,[0,u],[n,a.shape[1]-u]);if(u===0)a=ce($,$e($e($,o),N));else{const E=ce($,$e($e($,o),N));a=xt([_e(a,[0,0],[n,u]),E],1)}return[o,r,a]}),Te([c,d,p])}return!e&&n>s&&(a=_e(a,[0,0],[n,s]),r=_e(r,[0,0],[s,s])),[a,r]})}const YV=D({qr_:XV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bn;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(bn||(bn={}));function QV(t,e,n=bn.SUM_BY_NONZERO_WEIGHTS){const s=I(t,"losses","computeWeightedLoss");let a=null;e!=null&&(a=I(e,"weights","computeWeightedLoss"));const r=a==null?s:_(s,a);if(n===bn.NONE)return r;if(n===bn.SUM)return pe(r);if(n===bn.MEAN){if(a==null)return ct(r);{const i=s.size/a.size,o=ge(pe(r),pe(a));return i>1?ge(o,we(i)):o}}if(n===bn.SUM_BY_NONZERO_WEIGHTS){if(a==null)return ge(pe(r),we(s.size));{const i=_(a,Tn(s.shape)),o=re(pe(to(i,we(0))),"float32");return ge(pe(r),o)}}throw Error(`Unknown reduction: ${n}`)}const lr=D({computeWeightedLoss_:QV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZV(t,e,n,s=bn.SUM_BY_NONZERO_WEIGHTS){const a=I(t,"labels","absoluteDifference"),r=I(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=I(n,"weights","absoluteDifference")),en(a.shape,r.shape,"Error in absoluteDifference: ");const o=Ct(ce(a,r));return lr(o,i,s)}const eW=D({absoluteDifference_:ZV});function tW(t,e,n,s,a=bn.SUM_BY_NONZERO_WEIGHTS){const r=I(t,"labels","cosineDistance"),i=I(e,"predictions","cosineDistance");let o=null;s!=null&&(o=I(s,"weights","cosineDistance")),en(r.shape,i.shape,"Error in cosineDistance: ");const l=we(1),u=ce(l,pe(_(r,i),n,!0));return lr(u,o,a)}const nW=D({cosineDistance_:tW});function sW(t,e,n,s=bn.SUM_BY_NONZERO_WEIGHTS){let a=I(t,"labels","hingeLoss");const r=I(e,"predictions","hingeLoss");let i=null;n!=null&&(i=I(n,"weights","hingeLoss")),en(a.shape,r.shape,"Error in hingeLoss: ");const o=we(1);a=ce(_(we(2),a),o);const l=la(ce(o,_(a,r)));return lr(l,i,s)}const aW=D({hingeLoss_:sW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rW(t,e,n,s=1,a=bn.SUM_BY_NONZERO_WEIGHTS){const r=I(t,"labels","huberLoss"),i=I(e,"predictions","huberLoss");let o=null;n!=null&&(o=I(n,"weights","huberLoss")),en(r.shape,i.shape,"Error in huberLoss: ");const l=we(s),u=Ct(ce(i,r)),c=Kr(u,l),d=ce(u,c),p=Z(_(we(.5),Ue(c)),_(l,d));return lr(p,o,a)}const iW=D({huberLoss_:rW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(t,e,n,s=1e-7,a=bn.SUM_BY_NONZERO_WEIGHTS){const r=I(t,"labels","logLoss"),i=I(e,"predictions","logLoss");let o=null;n!=null&&(o=I(n,"weights","logLoss")),en(r.shape,i.shape,"Error in logLoss: ");const l=we(1),u=we(s),c=Ye(_(r,Xn(Z(i,u)))),d=_(ce(l,r),Xn(Z(ce(l,i),u))),p=ce(c,d);return lr(p,o,a)}const lW=D({logLoss_:oW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uW(t,e,n,s=bn.SUM_BY_NONZERO_WEIGHTS){const a=I(t,"labels","meanSquaredError"),r=I(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=I(n,"weights","meanSquaredError")),en(a.shape,r.shape,"Error in meanSquaredError: ");const o=Xg(a,r);return lr(o,i,s)}const cW=D({meanSquaredError_:uW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dW(t,e){const n=I(t,"labels","sigmoidCrossEntropyWithLogits"),s=I(e,"logits","sigmoidCrossEntropyWithLogits");en(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=la(s),r=_(s,n),i=Cp(On(Ye(Ct(s))));return Z(ce(a,r),i)}function pW(t,e,n,s=0,a=bn.SUM_BY_NONZERO_WEIGHTS){let r=I(t,"multiClassLabels","sigmoidCrossEntropy");const i=I(e,"logits","sigmoidCrossEntropy");let o=null;if(n!=null&&(o=I(n,"weights","sigmoidCrossEntropy")),en(r.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const u=we(s),c=we(1),d=we(.5);r=Z(_(r,ce(c,u)),_(d,u))}const l=dW(r,i);return lr(l,o,a)}const hW=D({sigmoidCrossEntropy_:pW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fW(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Ta((a,r,i)=>{const l=Ip(r,[n],!0),u=ce(re(r,"float32"),l);i([a,u]);const c=Ye(_(u,a));return{value:pe(c,[n]),gradFunc:(h,f)=>{const[g,y]=f,m=kt(h.shape,[n]);return[_(F(h,m),ce(re(g,"float32"),On(y))),_(F(h,m),ce(On(y),re(g,"float32")))]}}})(t,e)}function mW(t,e,n,s=0,a=bn.SUM_BY_NONZERO_WEIGHTS){let r=I(t,"onehotLabels","softmaxCrossEntropy");const i=I(e,"logits","softmaxCrossEntropy");let o=null;if(n!=null&&(o=I(n,"weights","softmaxCrossEntropy")),en(r.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const u=we(s),c=we(1),d=we(r.shape[1]);r=Z(_(r,ce(c,u)),ge(u,d))}const l=fW(r,i);return lr(l,o,a)}const gW=D({softmaxCrossEntropy_:mW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yW(t,e,n,s){const a=I(t,"indices","sparseFillEmptyRows","int32"),r=I(e,"values","sparseFillEmptyRows"),i=I(n,"denseShape","sparseFillEmptyRows","int32"),o=I(s,"defaultValue","sparseFillEmptyRows",r.dtype);if(a.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(r.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${r.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:a,values:r,denseShape:i,defaultValue:o},u=R.runKernel(dg,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const wW=D({sparseFillEmptyRows_:yW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(t,e,n){const s=I(t,"inputIndices","sparseReshape","int32"),a=I(e,"inputShape","sparseReshape","int32"),r=I(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(a.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(r.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${r.shape}`);const i={inputIndices:s,inputShape:a,newShape:r},o=R.runKernel(pg,i);return{outputIndices:o[0],outputShape:o[1]}}const xW=D({sparseReshape_:bW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kW(t,e,n){const s=I(t,"data","sparseSegmentMean"),a=I(e,"indices","sparseSegmentMean","int32"),r=I(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(r.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${r.shape}`);const i={data:s,indices:a,segmentIds:r};return R.runKernel(hg,i)}const vW=D({sparseSegmentMean_:kW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(t,e,n){const s=I(t,"data","sparseSegmentSum"),a=I(e,"indices","sparseSegmentSum","int32"),r=I(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(r.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${r.shape}`);const i={data:s,indices:a,segmentIds:r};return R.runKernel(fg,i)}const NW=D({sparseSegmentSum_:SW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(t,e,n,s,a,r,i,o){const l=I(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=I(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:s,leftPad:a,rightPad:r,padWidth:i,preserveShortSequences:o},d={data:l,dataSplits:u},p=R.runKernel(wg,d,c);return{nGrams:p[0],nGramsSplits:p[1]}}const IW=D({stringNGrams_:CW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(t,e,n=!0){const s=I(t,"input","stringSplit","string"),a=I(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(a.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);const r={skipEmpty:n},i={input:s,delimiter:a},o=R.runKernel(bg,i,r);return{indices:o[0],values:o[1],shape:o[2]}}const TW=D({stringSplit_:$W});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EW(t,e){const n=I(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return R.runKernel(xg,a,s)}const AW=D({stringToHashBucketFast_:EW});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(t,e,n,s=!0){const a=I(t,"input","staticRegexReplace","string"),r={pattern:e,rewrite:n,replaceGlobal:s};return R.runKernel(hp,{x:a},r)}const DW=D({staticRegexReplace_:RW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MT={fft:Fp,ifft:kl,rfft:jp,irfft:Jg},VT={hammingWindow:iV,hannWindow:PT,frame:LT,stft:cV},qs={flipLeftRight:fV,grayscaleToRGB:gV,resizeNearestNeighbor:BT,resizeBilinear:zT,rgbToGrayscale:wV,rotateWithOffset:xV,cropAndResize:pV,nonMaxSuppression:vV,nonMaxSuppressionAsync:AV,nonMaxSuppressionWithScore:DV,nonMaxSuppressionWithScoreAsync:OV,nonMaxSuppressionPadded:jV,nonMaxSuppressionPaddedAsync:LV,threshold:WV,transform:GV},Gk={bandPart:KV,gramSchmidt:JV,qr:YV},WT={absoluteDifference:eW,computeWeightedLoss:lr,cosineDistance:nW,hingeLoss:aW,huberLoss:iW,logLoss:lW,meanSquaredError:cW,sigmoidCrossEntropy:hW,softmaxCrossEntropy:gW},UT={sparseFillEmptyRows:wW,sparseReshape:xW,sparseSegmentMean:vW,sparseSegmentSum:NW},GT={stringNGrams:IW,stringSplit:TW,stringToHashBucketFast:AW,staticRegexReplace:DW};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _W=new Map,Mw=new Map;class So{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class rs{constructor(){this.classNameMap={}}static getMap(){return rs.instance==null&&(rs.instance=new rs),rs.instance}static register(e){rs.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ee(t,e,n){C(t.className!=null,()=>"Class being registered does not have the static className property defined."),C(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),C(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,a=e+">"+s;return rs.register(t),_W.set(a,t),Mw.set(t,a),t}function OW(t){return Mw.has(t)?Mw.get(t):t.className}const FW=Object.freeze(Object.defineProperty({__proto__:null,Serializable:So,SerializationMap:rs,getRegisteredName:OW,registerClass:ee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ur extends So{minimize(e,n=!1,s){const{value:a,grads:r}=this.computeGradients(e,s);if(s!=null){const i=s.map(o=>({name:o.name,tensor:r[o.name]}));this.applyGradients(i)}else this.applyGradients(r);return Te(r),n?a:(a.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return X$(e,n)}dispose(){this.iterations_!=null&&Te(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:we(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ur,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hk extends ur{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=R.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=R.registeredVariables[s],i=!1;this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:`${s}/accum_grad`,variable:B(()=>Oe(r).variable(i))}),this.accumulatedUpdates[a]==null&&(this.accumulatedUpdates[a]={originalName:`${s}/accum_var`,variable:B(()=>Oe(r).variable(i))});const o=Array.isArray(e)?e[a].tensor:e[s];if(o==null)return;const l=this.accumulatedGrads[a].variable,u=this.accumulatedUpdates[a].variable;B(()=>{const c=Z(_(l,this.rho),_(Ue(o),1-this.rho)),d=_(ge(Ut(Z(u,this.epsilon)),Ut(Z(l,this.epsilon))),o),p=Z(_(u,this.rho),_(Ue(d),1-this.rho));l.assign(c),u.assign(p);const h=Z(_(d,-this.learningRate),r);r.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Te(this.accumulatedGrads.map(e=>e.variable)),Te(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kk extends ur{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=R.registeredVariables[s];this.accumulatedGrads[a]==null&&(this.accumulatedGrads[a]={originalName:`${s}/accumulator`,variable:B(()=>bo(r.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[a].tensor:e[s];if(i==null)return;const o=this.accumulatedGrads[a].variable;B(()=>{const l=Z(o,Ue(i));o.assign(l);const u=Z(_(ge(i,Ut(Z(l,R.backend.epsilon()))),-this.learningRate),r);r.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Te(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qk extends ur{static get className(){return"Adam"}constructor(e,n,s,a=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],B(()=>{this.accBeta1=we(n).variable(),this.accBeta2=we(s).variable()}),a==null&&(this.epsilon=R.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);B(()=>{const s=ce(1,this.accBeta1),a=ce(1,this.accBeta2);n.forEach((r,i)=>{const o=R.registeredVariables[r],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${r}/m`,variable:B(()=>Oe(o).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${r}/v`,variable:B(()=>Oe(o).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[r];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,p=Z(_(c,this.beta1),_(u,1-this.beta1)),h=Z(_(d,this.beta2),_(Ue(u),1-this.beta2)),f=ge(p,s),g=ge(h,a);c.assign(p),d.assign(h);const y=Z(_(ge(f,Z(Ut(g),this.epsilon)),-this.learningRate),o);o.assign(y)}),this.accBeta1.assign(_(this.accBeta1,this.beta1)),this.accBeta2.assign(_(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Te(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Te(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),B(()=>{this.accBeta1.assign($a(this.beta1,this.iterations_+1)),this.accBeta2.assign($a(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jk extends ur{static get className(){return"Adamax"}constructor(e,n,s,a=null,r=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=a,this.decay=r,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],B(()=>{this.iteration=we(0).variable(),this.accBeta1=we(n).variable()}),a==null&&(this.epsilon=R.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);B(()=>{const s=ce(1,this.accBeta1),a=ge(-this.learningRate,Z(_(this.iteration,this.decay),1));n.forEach((r,i)=>{const o=R.registeredVariables[r],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${r}/m`,variable:Oe(o).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${r}/v`,variable:Oe(o).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[r];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,p=Z(_(c,this.beta1),_(u,1-this.beta1)),h=_(d,this.beta2),f=Ct(u),g=Ra(h,f);c.assign(p),d.assign(g);const y=Z(_(ge(a,s),ge(p,Z(g,this.epsilon))),o);o.assign(y)}),this.iteration.assign(Z(this.iteration,1)),this.accBeta1.assign(_(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Te(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Te(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u0 extends ur{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=Array.isArray(e)?e[a].tensor:e[s];if(r==null)return;const i=R.registeredVariables[s];B(()=>{const o=Z(_(this.c,r),i);i.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Rt(we(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xk extends u0{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=we(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=R.registeredVariables[s];this.accumulations[a]==null&&(this.accumulations[a]={originalName:`${s}/momentum`,variable:B(()=>Oe(r).variable(!1))});const i=this.accumulations[a].variable,o=Array.isArray(e)?e[a].tensor:e[s];o!=null&&B(()=>{let l;const u=Z(_(this.m,i),o);this.useNesterov?l=Z(_(this.c,Z(o,_(u,this.m))),r):l=Z(_(this.c,u),r),i.assign(u),r.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Te(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yk extends ur{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,a=null,r=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=r,a==null&&(this.epsilon=R.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,a)=>{const r=R.registeredVariables[s],i=!1;this.accumulatedMeanSquares[a]==null&&(this.accumulatedMeanSquares[a]={originalName:`${s}/rms`,variable:B(()=>Oe(r).variable(i))}),this.accumulatedMoments[a]==null&&(this.accumulatedMoments[a]={originalName:`${s}/momentum`,variable:B(()=>Oe(r).variable(i))}),this.accumulatedMeanGrads[a]==null&&this.centered&&(this.accumulatedMeanGrads[a]={originalName:`${s}/mg`,variable:B(()=>Oe(r).variable(i))});const o=Array.isArray(e)?e[a].tensor:e[s];if(o==null)return;const l=this.accumulatedMeanSquares[a].variable,u=this.accumulatedMoments[a].variable;B(()=>{const c=Z(_(l,this.decay),_(Ue(o),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[a].variable,p=Z(_(d,this.decay),_(o,1-this.decay)),h=ge(_(o,this.learningRate),Ut(ce(c,Z(Ue(p),this.epsilon)))),f=Z(_(u,this.momentum),h);l.assign(c),d.assign(p),u.assign(f);const g=ce(r,f);r.assign(g)}else{const d=Z(_(l,this.decay),_(Ue(o),1-this.decay)),p=Z(_(u,this.momentum),ge(_(o,this.learningRate),Ut(Z(d,this.epsilon))));l.assign(d),u.assign(p);const h=ce(r,p);r.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Te(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Te(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Te(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(a=>({originalName:a.name,variable:a.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jW=[Hk,Kk,qk,Jk,Xk,Yk,u0];function PW(){for(const t of jW)ee(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LW="model",zW=".json",BW=".weights.bin";function Q2(t){return new Promise(e=>setTimeout(e)).then(t)}class so{constructor(e){if(!V().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(so.URL_SCHEME)&&(e=e.slice(so.URL_SCHEME.length)),(e==null||e.length===0)&&(e=LW),this.modelJsonFileName=e+zW,this.weightDataFileName=e+BW}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=oa.join(e.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const a=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r=R$(e,a),i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await Q2(()=>o.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await Q2(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:wp(e)}}}}so.URL_SCHEME="downloads://";class MW{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const s=new FileReader;s.onload=a=>{const r=JSON.parse(a.target.result),i=r.modelTopology;if(i==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(r.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=Ox(r,u=>this.loadWeights(u));e(l)},s.onerror=a=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const n=[],s=[];for(const i of e)n.push(...i.weights),s.push(...i.paths);const a=this.checkManifestAndWeightFiles(e),r=s.map(i=>this.loadWeightsFile(i,a[i]));return Promise.all(r).then(i=>[n,i])}loadWeightsFile(e,n){return new Promise((s,a)=>{const r=new FileReader;r.onload=i=>{const o=i.target.result;s(o)},r.onerror=i=>a(`Failed to weights data from file of path '${e}'.`),r.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],s=this.weightsFiles.map(r=>J2(r.name)),a={};for(const r of e)r.paths.forEach(i=>{const o=J2(i);if(n.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(n.push(o),s.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);a[i]=this.weightsFiles[s.indexOf(o)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return a}}const VW=t=>V().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(so.URL_SCHEME)?WW(t.slice(so.URL_SCHEME.length)):null;lt.registerSaveRouter(VW);function WW(t="model"){return new so(t)}function UW(t){return new MW(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z2(t,e,n,s){i(t),n=n??0,s=s??1,o(n,s);let a=0;const r=l=>(l.then(u=>{const c=n+ ++a/t.length*(s-n);return e(c),u}),l);function i(l){C(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,u){C(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),C(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),C(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function HT(t,e){e==null&&(e={});const n=e.fetchFunc==null?V().platform.fetch:e.fetchFunc,s=t.map(d=>n(d,e.requestInit,{isBinary:!0})),o=(e.onProgress==null?await Promise.all(s):await Z2(s,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(o):await Z2(o,e.onProgress,.5,1)}function GW(t,e){var n;const s=e.fetchFunc==null?V().platform.fetch:e.fetchFunc;let a=0,r;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async i=>{for(var o;a<t.length;){r||(r=(await s(t[a],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await r.read();if(l){a++,r=void 0,(o=e.onProgress)===null||o===void 0||o.call(e,a/t.length);continue}i.enqueue(u);return}i.close()}})}async function HW(t,e="",n,s){return KT(i=>HT(i,{requestInit:s}))(t,e,n)}function KT(t){return async(e,n="",s)=>{const a=e.map(()=>!1),r={},i=s!=null?s.map(()=>!1):[],o=[];if(e.forEach((h,f)=>{let g=0;h.weights.forEach(y=>{const m="quantization"in y?y.quantization.dtype:y.dtype,w=Ji[m]*H(y.shape),b=()=>{a[f]=!0,r[f]==null&&(r[f]=[]),r[f].push({manifestEntry:y,groupOffset:g,sizeBytes:w})};s!=null?s.forEach((x,v)=>{x===y.name&&(b(),i[v]=!0)}):b(),o.push(y.name),g+=w})}),!i.every(h=>h)){const h=s.filter((f,g)=>!i[g]);throw new Error(`Could not find weights in manifest with names: ${h.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=a.reduce((h,f,g)=>(f&&h.push(g),h),[]),u=[];l.forEach(h=>{e[h].paths.forEach(f=>{const g=n+(n.endsWith("/")?"":"/")+f;u.push(g)})});const c=await t(u),d={};let p=0;return l.forEach(h=>{const f=e[h].paths.length,g=new oa(c.slice(p,p+f));r[h].forEach(m=>{const w=g.slice(m.groupOffset,m.groupOffset+m.sizeBytes),b=$$(w,[m.manifestEntry]);for(const x in b)d[x]=b[x]}),p+=f}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KW="application/octet-stream",qW="application/json";class Qk{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(C(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=V().platform.fetch,C(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&C(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=R$(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(a)],{type:qW}),"model.json"),e.weightData!=null){const i=oa.join(e.weightData);n.body.append("model.weights.bin",new Blob([i],{type:KW}),"model.weights.bin")}const r=await this.fetch(this.path,n);if(r.ok)return{modelArtifactsInfo:wp(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=n.modelTopology,a=n.weightsManifest;if(s==null&&a==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return Ox(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=Af(e.weightsManifest),a=()=>GW(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:a})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,a]=JW(n),r=this.weightPathPrefix||s,i=[],o=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?o.push(this.weightUrlConverter(u)):i.push(r+u+a);return this.weightUrlConverter&&i.push(...await Promise.all(o)),i}async loadWeights(e){const n=await this.getWeightUrls(e),s=Af(e),a=await HT(n,this.loadOptions);return[s,a]}}Qk.URL_SCHEME_REGEX=/^https?:\/\//;function JW(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),a=n>e?t.substring(n):"";return[s+"/",a]}function Vw(t){return t.match(Qk.URL_SCHEME_REGEX)!=null}const qT=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>Vw(s)):n=Vw(t),n)return Zk(t,e)}return null};lt.registerSaveRouter(qT);lt.registerLoadRouter(qT);function Zk(t,e){return new Qk(t,e)}function XW(t,e){return Zk(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dy{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class JT{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class YW{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function QW(t,e,n,s){const a=arguments;return new YW(Df(...a))}function Df(t,e,n,s){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new dy(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new dy({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new dy({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:s}))}function ZW(t){return new JT(t)}function eU(t){return new JT(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e1=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:oa,browserFiles:UW,browserHTTPRequest:XW,concatenateArrayBuffers:A$,copyModel:DL,decodeWeights:$$,decodeWeightsStream:E$,encodeWeights:Ow,fromMemory:QW,fromMemorySync:Df,getLoadHandlers:wL,getModelArtifactsForJSON:Ox,getModelArtifactsForJSONSync:_x,getModelArtifactsInfoForJSON:wp,getSaveHandlers:D$,getWeightSpecs:Af,http:Zk,isHTTPScheme:Vw,listModels:AL,loadWeights:HW,moveModel:_L,registerLoadRouter:yL,registerSaveRouter:gL,removeModel:RL,weightsLoaderFactory:KT,withSaveHandler:ZW,withSaveHandlerSync:eU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(t,e,n){const s=I(t,"labels","confusionMatrix"),a=I(e,"predictions","confusionMatrix");C(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),C(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),C(a.rank===1,()=>`Expected the rank of predictions to be 1, but got ${a.rank}`),C(s.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),C(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const r=wl(re(s,"int32"),n),i=wl(re(a,"int32"),n),o=De(r),l=$e(o,i);return re(l,"int32")}const nU=D({confusionMatrix_:tU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sU=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:nU},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let yi,eS=!1;function XT(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,a=!1,r=!1,i=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)r=!0;else if(t.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(Kc($f,R.backendName)!=null){const f={pixels:t},g={numChannels:e};return R.runKernel($f,f,g)}const[u,c]=a?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(i)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(s||n)d=t.data;else if(r||a||o){if(yi==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")yi=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else yi=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});yi.canvas.width=u,yi.canvas.height=c,yi.drawImage(t,0,0,u,c),d=yi.getImageData(0,0,u,c).data}let p;if(e===4)p=new Int32Array(d);else{const f=u*c;p=new Int32Array(f*e);for(let g=0;g<f;g++)for(let y=0;y<e;++y)p[g*e+y]=d[g*4+y]}return Fk(p,[c,u,e],"int32")}function aU(t){return t!=null&&t.data instanceof Uint8Array}function rU(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function iU(t){return t!=null&&t.width!==0&&t.height!==0}function oU(t){return rU()&&!(t instanceof ImageBitmap)&&iU(t)&&!aU(t)}async function lU(t,e=3){let n=null;if(V().getBool("WRAP_TO_IMAGEBITMAP")&&oU(t)){let s;try{s=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===t.width&&s.height===t.height?n=s:n=t}else n=t;return XT(n,e)}function YT(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function uU(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function cU(t,e){let n=I(t,"img","toPixels");if(!(t instanceof ze)){const u=n;n=re(u,"int32"),u.dispose()}YT(n);const[s,a]=n.shape.slice(0,2),r=n.rank===2?1:n.shape[2],i=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(a*s*4);for(let u=0;u<s*a;++u){const c=[0,0,0,255];for(let p=0;p<r;p++){const h=i[u*r+p];if(n.dtype==="float32"){if(h<0||h>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${h}.`)}else if(n.dtype==="int32"&&(h<0||h>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${h}.`);r===1?(c[0]=h*o,c[1]=h*o,c[2]=h*o):c[p]=h*o}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){eS||Kc(Pm,R.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),eS=!0),e.width=a,e.height=s;const u=e.getContext("2d"),c=new ImageData(l,a,s);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}function dU(t,e,n){let s=I(t,"img","draw");if(!(t instanceof ze)){const i=s;s=re(i,"int32"),i.dispose()}YT(s),uU(n==null?void 0:n.imageOptions);const a={image:s},r={canvas:e,options:n};R.runKernel(Pm,a,r)}const pU=D({fromPixels_:XT}),hU=Object.freeze(Object.defineProperty({__proto__:null,draw:dU,fromPixels:pU,fromPixelsAsync:lU,toPixels:cU},Symbol.toStringTag,{value:"Module"}));function c0(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(H(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const a=e.shape,r=a[a.length-1];let i=1;for(let d=0;d<a.length-1;++d)i*=a[d];const o=t.shape,l=a.slice();l.pop();let u=1;for(let d=r;d<n;++d)u*=o[d],l.push(o[d]);const c=[...ye(t.shape).map(d=>d/u),1].slice(0,r);return[l,i,u,c]}const fU=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:c0},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ww=-2,mU=-1;function t1(t,e,n){const s=t.shape.length;C(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),C(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let a=0;a<s;++a)C(e[a]+n[a]<=t.shape[a],()=>`Error in slice${s}D: begin[${a}] + size[${a}] (${e[a]+n[a]}) would overflow input.shape[${a}] (${t.shape[a]})`)}function gU(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function n1(t,e,n){const s=[];for(let a=0;a<t.length;a++)s[a]=Math.ceil((e[a]-t[a])/n[a]);return s}function QT(t,e,n,s){const a=[...t];for(let r=a.length;r<s.length;r++)a.push(1);for(let r=0;r<n;r++)r===0?a[e]=1:(a.splice(e,0,1),a.pop());return a}function ZT(t,e,n){return n<=t?n:n-(e-1)}function eE(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function yU(t,e,n,s,a,r,i,o,l){const u=t.length;let c=new Array(u),d=new Array(u),p=new Array(u);if(e.length&&n>0){const h=e[0],f=n+1;c=tE(i,h,f,s,t),d=nE(o,h,f,a,t),p=QT(r,h,f,t)}else for(let h=0;h<u;h++)c[h]=aE(i,s,r,t,h,l),d[h]=rE(o,a,r,t,h,l),p[h]=sE(r,h,l);return{begin:c,end:d,strides:p}}function tE(t,e,n,s,a){const r=[...a],i=eE(n,e);for(let o=0;o<r.length;o++)if(i.indexOf(o)>-1)r[o]=0;else{const l=ZT(e,n,o);let u=s[l];t&1<<l&&(u=0),r[o]=u}return r}function nE(t,e,n,s,a){const r=[...a],i=eE(n,e);for(let o=0;o<r.length;o++)if(i.indexOf(o)>-1)r[o]=Number.MAX_SAFE_INTEGER;else{const l=ZT(e,n,o);let u=s[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),r[o]=u}for(let o=0;o<r.length;o++){const l=a[o];r[o]<0&&(r[o]+=l),r[o]=Mr(0,r[o],a[o])}return r}function sE(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function aE(t,e,n,s,a,r){let i=e[a];const o=n[a]||1;(t&1<<a||r&1<<a||i==null)&&(o>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[a];return i<0&&(i+=l),i=Mr(0,i,l-1),i}function rE(t,e,n,s,a,r){let i=e[a];const o=n[a]||1;(t&1<<a||r&1<<a||i==null)&&(o>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[a];return i<0&&(i+=l),o>0?i=Mr(0,i,l):i=Mr(-1,i,l-1),i}function s1(t,e,n){let s=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){s=a;break}for(let a=s+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function a1(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function d0(t,e,n){let s;const a=t.shape.length;typeof e=="number"?s=[e,...new Array(a-1).fill(0)]:e.length<a?s=e.concat(new Array(a-e.length).fill(0)):s=e.slice(),s.forEach(i=>{C(i!==-1,()=>"slice() does not support negative begin indexing.")});let r;return n==null?r=new Array(a).fill(-1):typeof n=="number"?r=[n,...new Array(a-1).fill(-1)]:n.length<a?r=n.concat(new Array(a-n.length).fill(-1)):r=n,r=r.map((i,o)=>i>=0?i:(C(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${o}.`),t.shape[o]-s[o])),[s,r]}function r1(t,e,n,s,a,r,i,o,l){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:a,endMask:r,ellipsisMask:i,newAxisMask:o,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)c&&1<<b&o&&d.numAddAxisAfterEllipsis++,1<<b&i&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};wU(d,p);let h=!0,f=!0,g=!0;const y=[],m=[];for(let b=0;b<t.length;++b){if(p.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const x=!!(p.shrinkAxisMask&1<<b),v=t[b];if(v===-1){y.push(x?1:-1);continue}const S=[p.beginMask&1<<b,p.endMask&1<<b],N=[p.strides[b]>0?0:-1,p.strides[b]>0?v:v-1];if(x&&p.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&p.strides[b]===1;const $=!!(p.beginMask&1<<b&&p.endMask&1<<b);if(p.beginValid&&p.endValid){if(x){const W=p.begin[b]<0?v+p.begin[b]:p.begin[b];if(p.begin[b]=W,p.end[b]=p.begin[b]+1,W<0||W>=v)throw Error(`slice index ${p.begin[b]} of dimension ${b} out of bounds.`)}else p.begin[b]=tS(p.begin[b],0,p.strides[b],v,S,N),p.end[b]=tS(p.end[b],1,p.strides[b],v,S,N);const L=p.strides[b]===1&&p.begin[b]===0&&p.end[b]===v;h=h&&L,f=f&&(b===0&&p.strides[b]===1||L)}else h=h&&p.strides[b]===1&&$,f=f&&(b===0&&p.strides[b]===1||$);let E,A=!1;if(p.beginValid&&p.endValid?(E=p.end[b]-p.begin[b],A=!0):x?(E=1,A=!0):$&&v>=0&&(p.strides[b]<0?E=-v:E=v,A=!0),A){let L;E===0||E<0!=p.strides[b]<0?L=0:L=Math.trunc(E/p.strides[b])+(E%p.strides[b]!==0?1:0),y.push(L)}else y.push(-1)}for(let b=0;b<p.finalShapeGatherIndices.length;++b){const x=p.finalShapeGatherIndices[b];x>=0?m.push(y[x]):x===Ww&&m.push(1)}return{finalShapeSparse:m.filter((b,x)=>p.finalShapeGatherIndices[x]!==Ww),finalShape:m,isIdentity:h,sliceDim0:f,isSimpleSlice:g,begin:p.begin,end:p.end,strides:p.strides}}function wU(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const a=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<a;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(Ww),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(mU),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function tS(t,e,n,s,a,r){if(a[e])return n>0?r[e]:r[e+1&1];{const i=t<0?s+t:t;return i<r[0]?r[0]:i>r[1]?r[1]:i}}const iE=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:t1,computeFlatOffset:a1,computeOutShape:n1,getNormalizedAxes:yU,isSliceContinous:s1,maskToAxes:gU,parseSliceParams:d0,sliceInfo:r1,startForAxis:aE,startIndicesWithElidedDims:tE,stopForAxis:rE,stopIndicesWithElidedDims:nE,stridesForAxis:sE,stridesWithElidedDims:QT},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const bU="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oE{static sgd(e){return new u0(e)}static momentum(e,n,s=!1){return new Xk(e,n,s)}static rmsprop(e,n=.9,s=0,a=null,r=!1){return new Yk(e,n,s,a,r)}static adam(e=.001,n=.9,s=.999,a=null){return new qk(e,n,s,a)}static adadelta(e=.001,n=.95,s=null){return new Hk(e,n,s)}static adamax(e=.002,n=.9,s=.999,a=null,r=0){return new Jk(e,n,s,a,r)}static adagrad(e,n=.1){return new Kk(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Si=oE;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xU=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function i1(){return new Promise(t=>xU(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o1(t,e){const n=t[0].length;t.forEach((a,r)=>{C(a.length===n,()=>`Error in concat${n}D: rank of tensors[${r}] must be the same as the rank of the rest (${n})`)}),C(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((a,r)=>{for(let i=0;i<n;i++)C(i===e||a[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${r}] (${a}) does not match the shape of the rest (${s}) along the non-concatenated axis ${r}.`)})}function va(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ks;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Ks||(Ks={}));function lE(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let a=1;a<n.length;++a){const r=n[a],i=s[s.length-n.length+a],o=s[i];if(r>=0)if(o>=0){if(o!==r)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${a+t}] = ${r} but shape[${a+t}] = ${o}`)}else s[i]=r}return s}function uE(t){const e={FIRST_DIM_SIZE:Ks.FIRST_DIM_SIZE,VALUE_ROWIDS:Ks.VALUE_ROWIDS,ROW_LENGTHS:Ks.ROW_LENGTHS,ROW_SPLITS:Ks.ROW_SPLITS,ROW_LIMITS:Ks.ROW_LIMITS,ROW_STARTS:Ks.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function cE(t){return t.length===0?0:t[0]===Ks.FIRST_DIM_SIZE?t.length-1:t.length}function dE(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let a=0;a<Math.min(n,s-1);++a){const r=t[a],i=e[a+1];if(r>=0&&i>=0&&r!==1&&r!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${a-t.length}] = ${r} but ragged tensor input.flatValues.shape[${a-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l1=30;function p0(t){return t<=l1?t:Nf(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1(t,e,n){const s=n*(typeof t=="number"?t:t[0]),a=e*(typeof t=="number"?t:t[1]);return[s,a]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pp(t,e,n,s=!0){let a=[];if(s)a=a.concat(e.slice(0)),a.push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);const r=e.length;for(let i=0;i<r;++i)a=a.concat([t[i+1]/e[i],e[i]]);a=a.concat(t.slice(r+1))}return a}function Lp(t,e,n=!0){const s=[];if(n){s.push(e);for(let a=e+1;a<t;++a)a<=2*e?(s.push(a),s.push(a-(e+1))):s.push(a)}else{const a=[],r=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?r.push(i):a.push(i);s.push(...a),s.push(0),s.push(...r)}return s}function zp(t,e,n,s=!0){const a=[];s?a.push(t[0]/n):a.push(t[0]*n);for(let r=1;r<t.length;++r)r<=e.length?s?a.push(e[r-1]*t[r]):a.push(t[r]/e[r-1]):a.push(t[r]);return a}function c1(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function d1(t,e,n){const s=t.slice(0,1);for(let a=0;a<n;++a)s.push(t[a+1]-e[a][0]-e[a][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h0=1.7580993408473768,f0=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p1=.3275911,h1=.254829592,f1=-.284496736,m1=1.421413741,g1=-1.453152027,y1=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Za(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function pE(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function hE(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],s[Math.floor(a/4)]=t[a+1];return{real:n,imag:s}}function fE(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],s[Math.floor(a/4)]=t[a+1];return{real:n,imag:s}}function w1(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function mE(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function gE(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let a=0;a<Math.ceil(t/2);a++){const r=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(r),s[a]=Math.sin(r)}return{real:n,imag:s}}function yE(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),a=Math.cos(s),r=Math.sin(s);return{real:a,imag:r}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const py="->",kU=/->/g,nS=",",sS="...";function b1(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(kU,"").length)/py.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${py}").`);const[s,a]=t.split(py);C(s.indexOf(sS)===-1,()=>`The ellipsis notation ("${sS}") is not supported yet.`);const r=s.split(nS),i=r.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let p=0;p<a.length;++p){const h=a[p];if(!r.some(f=>f.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);o.indexOf(h)===-1&&o.push(h)}for(let p=0;p<s.length;++p){const h=s[p];o.indexOf(h)===-1&&h!==nS&&o.push(h)}const l=new Array(r.length);for(let p=0;p<i;++p){if(new Set(r[p].split("")).size!==r[p].length)throw new Error(`Found duplicate axes in input component ${r[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let h=0;h<r[p].length;++h)l[p].push(o.indexOf(r[p][h]))}const u=o.length,c=a.length,d=[];for(let p=c;p<u;++p)d.push(p);return{allDims:o,summedDims:d,idDims:l}}function x1(t,e){let n=new Array(t);n.fill(-1);for(let a=0;a<e.length;++a)n[e[a]]=a;const s=[];for(let a=0;a<t;++a)n[a]===-1&&s.push(a);return n=n.filter(a=>a!==-1),{permutationIndices:n,expandDims:s}}function k1(t,e,n){const s=new Array(t);for(let a=0;a<n.length;++a){const r=n[a].shape;for(let i=0;i<e[a].length;++i)s[e[a][i]]===void 0?s[e[a][i]]=r[i]:C(s[e[a][i]]===r[i],()=>`Expected dimension ${s[e[a][i]]} at axis ${i} of input shaped ${JSON.stringify(r)}, but got dimension ${r[i]}`)}}function v1(t,e){const n=t,s=[];let a=0;t.length===0&&n.push(-1),a=t.length+1;for(let i=0;i<a;++i)s.push([]);const r=[];for(let i=0;i<n.length;++i){const o=n[i],l=vU(e,o);for(const u of l)r.indexOf(u)===-1&&(s[i].push(u),r.push(u))}return{path:n,steps:s}}function S1(t){return t.every((e,n)=>e===n)}function vU(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function N1(t,e,n=0){let s=[];if(typeof e=="number")C(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const a=e.reduce((i,o)=>(o===-1&&(i+=1),i),0);C(a<=1,()=>"There should be only one negative value in split array.");const r=e.indexOf(-1);if(r!==-1){const i=e.reduce((o,l)=>l>0?o+l:o);e[r]=t.shape[n]-i}C(t.shape[n]===e.reduce((i,o)=>i+o),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wE(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function bE(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function xE(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kE(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function vE(t,e){return`size ${t} must be non-negative, not ${e}`}function SE(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function NE(t,e){const n=H(t),s=H(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function CE(t,e){const n=H(t),s=H(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uw(){return"segment ids must be >= 0"}function IE(){return"segment ids are not increasing"}function $E(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function TE(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EE(t,e){let n=!1,s;for(t<=l1?(s=t,n=!0):s=Nf(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=Nf(t,s+1);return s}function AE(t,e,n){const s=[],a=t.length;for(let r=0;r<a;r++)r!==e?s.push(t[r]):s.push(n);return s}function C1(t,e,n,s){const a=e.shape.length,r=t.shape.length;if(s!==0&&(s<-a||s>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${s}`);if(s<0&&(s+=a),s>r)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${r}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],o=[];let l=1,u=1,c=1;for(let d=0;d<s;++d)o.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)o.push(t.shape[d]),u*=t.shape[d];for(let d=s;d<a;d++)o.push(e.shape[d]);for(let d=n+1;d<r;d++)o.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:i,outputShape:o}}const SU=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:C1,computeOutShape:AE,segOpComputeOptimalWindowSize:EE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function er(t){try{return t.map(e=>Xa(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function RE(t){return t.map(e=>xa(e))}const DE=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:h1,ERF_A2:f1,ERF_A3:m1,ERF_A4:g1,ERF_A5:y1,ERF_P:p1,PARALLELIZE_THRESHOLD:l1,get RowPartitionType(){return Ks},SELU_SCALE:f0,SELU_SCALEALPHA:h0,applyActivation:a0,assertAndGetBroadcastShape:ve,assertAxesAreInnerMostDims:nn,assertParamsConsistent:o1,assignToTypedArray:mE,axesAreInnerMostDims:lk,calculateShapes:pi,checkEinsumDimSizes:k1,checkPadOnDimRoundingMode:Nn,combineLocations:K$,combineRaggedTensorToTensorShapes:lE,complexWithEvenIndex:hE,complexWithOddIndex:fE,computeConv2DInfo:Gt,computeConv3DInfo:oi,computeDefaultPad:Ux,computeDilation2DInfo:bp,computeOptimalWindowSize:p0,computeOutAndReduceShapes:Ht,computeOutShape:va,computePool2DInfo:Fs,computePool3DInfo:ar,convertConv2DDataFormat:rr,decodeEinsumEquation:b1,eitherStridesOrDilationsAreOne:tn,expandShapeToKeepDim:kt,exponent:yE,exponents:gE,fromStringArrayToUint8:RE,fromUint8ToStringArray:er,getAxesPermutation:ht,getBroadcastDims:eo,getComplexWithIndex:w1,getEinsumComputePath:v1,getEinsumPermutation:x1,getFusedBiasGradient:s0,getFusedDyActivation:n0,getImageCenter:u1,getInnerMostAxes:vt,getPermuted:Lp,getRaggedRank:cE,getReductionAxes:Et,getReshaped:Pp,getReshapedPermuted:zp,getRowPartitionTypesHelper:uE,getSliceBeginCoords:c1,getSliceSize:d1,getSparseFillEmptyRowsIndicesDenseShapeMismatch:wE,getSparseFillEmptyRowsNegativeIndexErrorMessage:bE,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:xE,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:SE,getSparseReshapeInputOutputMismatchErrorMessage:CE,getSparseReshapeInputOutputMultipleErrorMessage:NE,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:kE,getSparseReshapeNegativeOutputDimErrorMessage:vE,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:TE,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Uw,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:IE,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:$E,getUndoAxesPermutation:li,isIdentityPermutation:S1,log:gP,mergeRealAndImagArrays:Za,prepareAndValidate:c0,prepareSplitSize:N1,segment_util:SU,shouldFuse:r0,slice_util:iE,splitRealAndImagArrays:pE,stridesOrDilationsArePositive:Zi,tupleValuesAreOne:Gr,upcastType:Rn,validateDefaultValueShape:dE,validateInput:Yg,validateUpdateShape:jk,warn:as},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NU=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:i0,nonMaxSuppressionV4Impl:o0,nonMaxSuppressionV5Impl:l0,whereImpl:e0},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */PW();const CU=Object.freeze(Object.defineProperty({__proto__:null,Abs:fd,Acos:Rl,Acosh:Dl,AdadeltaOptimizer:Hk,AdagradOptimizer:Kk,AdamOptimizer:qk,AdamaxOptimizer:Jk,Add:yo,AddN:md,All:xm,Any:km,ArgMax:gd,ArgMin:yd,Asin:_l,Asinh:Ol,Atan:Fl,Atan2:Pl,Atanh:jl,AvgPool:wd,AvgPool3D:bd,AvgPool3DGrad:Sm,AvgPoolGrad:vm,BatchMatMul:xd,BatchToSpaceND:kd,Bincount:Nm,BitwiseAnd:vd,BroadcastArgs:Cm,BroadcastTo:r$,Cast:Ll,Ceil:zl,ClipByValue:Bl,Complex:Im,ComplexAbs:Sd,Concat:Nd,Conv2D:Cd,Conv2DBackpropFilter:$m,Conv2DBackpropInput:Id,Conv3D:$d,Conv3DBackpropFilterV2:Tm,Conv3DBackpropInputV2:Em,Cos:Ml,Cosh:Vl,CropAndResize:Rm,Cumprod:Am,Cumsum:Td,DataStorage:yx,DenseBincount:Dm,DepthToSpace:_m,DepthwiseConv2dNative:Ed,DepthwiseConv2dNativeBackpropFilter:Om,DepthwiseConv2dNativeBackpropInput:Fm,Diag:jm,Dilation2D:Ad,Dilation2DBackpropFilter:If,Dilation2DBackpropInput:Cf,Draw:Pm,get ENV(){return vx},Einsum:Lm,Elu:Ul,EluGrad:zm,Environment:s$,Equal:Rd,Erf:Gl,Exp:Hl,ExpandDims:Dd,Expm1:Kl,FFT:Bm,Fill:Mm,FlipLeftRight:Vm,Floor:ql,FloorDiv:Jl,FromPixels:$f,FusedBatchNorm:_d,FusedConv2D:Uc,FusedDepthwiseConv2D:Gc,GatherNd:Wm,GatherV2:Od,Greater:Fd,GreaterEqual:Xl,IFFT:Um,Identity:Yl,Imag:Gm,IsFinite:Ql,IsInf:Zl,IsNan:eu,KernelBackend:ym,LRN:Vd,LRNGrad:Km,LeakyRelu:jd,Less:Pd,LessEqual:Ld,LinSpace:Hm,Log:tu,Log1p:nu,LogSoftmax:i$,LogicalAnd:zd,LogicalNot:Bd,LogicalOr:Md,LogicalXor:dP,LowerBound:pP,MatrixBandPart:hP,Max:Wd,MaxPool:Ud,MaxPool3D:Gd,MaxPool3DGrad:Jm,MaxPoolGrad:qm,MaxPoolWithArgmax:Xm,Maximum:su,Mean:Hd,Min:Kd,Minimum:au,MirrorPad:qd,Mod:ru,MomentumOptimizer:Xk,Multinomial:Ym,Multiply:iu,Neg:Jd,NonMaxSuppressionV3:Qm,NonMaxSuppressionV4:Zm,NonMaxSuppressionV5:eg,NotEqual:Xd,OP_SCOPE_SUFFIX:Ex,OneHot:Qd,OnesLike:Yd,Optimizer:ur,OptimizerConstructors:oE,Pack:Zd,PadV2:ep,Pool:fP,Pow:ou,Prelu:tp,Prod:np,RMSPropOptimizer:Yk,RaggedGather:tg,RaggedRange:ng,RaggedTensorToTensor:sg,Range:ag,get Rank(){return $w},Real:rg,RealDiv:Wl,Reciprocal:lu,get Reduction(){return bn},Relu:uu,Relu6:cu,Reshape:sp,ResizeBilinear:rp,ResizeBilinearGrad:og,ResizeNearestNeighbor:ap,ResizeNearestNeighborGrad:ig,Reverse:ip,RotateWithOffset:Ng,Round:du,Rsqrt:pu,SGDOptimizer:u0,ScatterNd:lg,SearchSorted:cg,Select:op,Selu:hu,Sigmoid:yu,Sign:gu,Sin:fu,Sinh:mu,Slice:lp,Softmax:pp,Softplus:wu,SpaceToBatchND:cp,SparseFillEmptyRows:dg,SparseReshape:pg,SparseSegmentMean:hg,SparseSegmentSum:fg,SparseToDense:mg,SplitV:dp,Sqrt:bu,Square:gg,SquaredDifference:xu,StaticRegexReplace:hp,Step:Cu,StridedSlice:yg,StringNGrams:wg,StringSplit:bg,StringToHashBucketFast:xg,Sub:ku,Sum:up,Tan:vu,Tanh:Su,Tensor:ze,TensorBuffer:Tt,TensorScatterUpdate:ug,Tile:Nu,TopK:kg,Transform:vg,Transpose:Li,Unique:Sg,Unpack:fp,UnsortedSegmentSum:mp,UpperBound:mP,Variable:qc,ZerosLike:gp,_FusedMatMul:Wc,abs:Ct,acos:jx,acosh:Px,add:Z,addN:B$,all:Tg,any:Xc,argMax:Qi,argMin:Lx,asin:zx,asinh:Bx,atan:Mx,atan2:Vx,atanh:Wx,avgPool:xp,avgPool3d:Gx,backend:Rx,backend_util:DE,basicLSTMCell:M$,batchNorm:Iu,batchNorm2d:Hx,batchNorm3d:Kx,batchNorm4d:qx,batchToSpaceND:kp,bincount:Jx,bitwiseAnd:V$,booleanMaskAsync:$T,broadcastArgs:W$,broadcastTo:zi,broadcast_util:qz,browser:hU,buffer:Se,cast:re,ceil:Xx,clipByValue:_n,clone:ka,complex:Ya,concat:xt,concat1d:Yx,concat2d:Qx,concat3d:Zx,concat4d:ek,conv1d:Eg,conv2d:Qa,conv2dTranspose:Ag,conv3d:nk,conv3dTranspose:sk,copyRegisteredKernels:bP,cos:vp,cosh:Rg,cosineWindow:t0,cumprod:Zc,cumsum:Dg,customGrad:Ta,denseBincount:Rf,deprecationWarn:QP,depthToSpace:ak,depthwiseConv2d:$u,device_util:HP,diag:G$,dilation2d:rk,disableDeprecationWarnings:YP,dispose:Te,disposeVariables:ZP,div:ge,divNoNan:ik,dot:ok,dropout:Mk,einsum:Ci,elu:Tu,enableDebugMode:XP,enableProdMode:JP,enclosingPowerOfTwo:Vk,engine:Ws,ensureShape:H$,env:V,equal:Os,erf:_g,euclideanNorm:uk,exp:On,expandDims:on,expm1:ck,eye:Og,fft:Fp,fill:bo,findBackend:aL,findBackendFactory:rL,floor:Au,floorDiv:$g,fused:jT,gather:Ru,gatherND:RT,gather_util:fU,getBackend:I$,getGradient:Nw,getKernel:Kc,getKernelsForBackend:Tf,grad:RB,grads:DB,greater:zn,greaterEqual:ir,ifft:kl,imag:Sp,image:qs,inTopKAsync:DT,io:e1,irfft:Jg,isFinite:dk,isInf:pk,isNaN:hk,keep:Rt,kernel_impls:NU,leakyRelu:Np,less:yl,lessEqual:ui,linalg:Gk,linspace:J$,localResponseNormalization:fk,log:Xn,log1p:Cp,logSigmoid:mk,logSoftmax:jg,logSumExp:Ip,logicalAnd:na,logicalNot:$p,logicalOr:Pg,logicalXor:gk,losses:WT,lowerBound:Y$,matMul:$e,math:sU,max:ds,maxPool:Tp,maxPool3d:yk,maxPoolWithArgmax:Q$,maximum:Ra,mean:ct,memory:_w,meshgrid:Z$,min:gl,minimum:Kr,mirrorPad:wk,mod:bk,moments:Ep,movingAverage:TT,mul:_,multiRNNCell:eT,multinomial:tT,neg:Ye,nextFrame:i1,norm:Eu,notEqual:to,oneHot:wl,ones:Tn,onesLike:Yn,op:D,outerProduct:nT,pad:or,pad1d:sT,pad2d:aT,pad3d:rT,pad4d:iT,pool:xk,pow:$a,prelu:Rp,print:Fx,prod:kk,profile:eL,raggedGather:oT,raggedRange:lT,raggedTensorToTensor:uT,rand:cT,randomGamma:fT,randomNormal:Bg,randomStandardNormal:mT,randomUniform:ci,randomUniformInt:gT,range:no,ready:C$,real:bl,reciprocal:Rk,registerBackend:Ax,registerGradient:o$,registerKernel:Cg,relu:la,relu6:Mg,removeBackend:sL,reshape:F,reverse:hs,reverse1d:yT,reverse2d:wT,reverse3d:bT,reverse4d:xT,rfft:jp,round:Vg,rsqrt:Wg,scalar:we,scatterND:ET,scatter_util:O4,searchSorted:Lg,selu:Ug,separableConv2d:Gg,serialization:FW,setBackend:nL,setPlatform:iL,setdiff1dAsync:kT,sigmoid:Zs,sign:Dk,signal:VT,sin:Hg,sinh:Kg,slice:_e,slice1d:Dp,slice2d:qg,slice3d:_p,slice4d:xl,slice_util:iE,softmax:Op,softplus:xo,spaceToBatchND:Ap,sparse:UT,sparseToDense:AT,spectral:MT,split:An,sqrt:Ut,square:Ue,squaredDifference:Xg,squeeze:di,stack:Fn,step:vo,stridedSlice:_k,string:GT,sub:ce,sum:pe,sumOutType:Ig,tan:Ok,tanh:Hr,tensor:Rs,tensor1d:ln,tensor2d:sl,tensor3d:Fk,tensor4d:vT,tensor5d:ST,tensor6d:NT,tensorScatterUpdate:CT,tensor_util:MP,test_util:KM,tidy:B,tile:os,time:tL,topk:Pk,train:Si,transpose:De,truncatedNormal:Qg,unique:Lk,unregisterGradient:wP,unregisterKernel:yP,unsortedSegmentSum:Zg,unstack:fs,upcastType:Rn,upperBound:IT,util:TP,valueAndGrad:_B,valueAndGrads:OB,variable:zk,variableGrads:X$,version_core:bU,where:Qt,whereAsync:Bk,zeros:$t,zerosLike:Oe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _E={kernelName:fd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,vo(re(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IU={kernelName:Rl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ue(re(n,"float32")),a=Ut(ce(we(1),s));return Ye(ge(t,a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $U={kernelName:Dl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ut(ce(Ue(re(n,"float32")),1));return ge(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TU={kernelName:yo,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=ve(n.shape,s.shape);return{a:()=>{let o=t;const l=Et(n.shape,a);return l.length>0&&(o=pe(o,l)),F(o,n.shape)},b:()=>{let o=t;const l=Et(s.shape,a);return l.length>0&&(o=pe(o,l)),F(o,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EU={kernelName:md,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,a)=>{n[a]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AU={kernelName:gd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Oe(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RU={kernelName:yd,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Oe(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DU={kernelName:_l,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,Ut(ce(we(1),Ue(re(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _U={kernelName:Ol,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ut(Z(we(1),Ue(re(n,"float32"))));return ge(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OU={kernelName:Pl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=ve(n.shape,s.shape);return{a:()=>{const o=Z(Ue(n),Ue(s));let l=_(t,ge(s,o));const u=Et(n.shape,a);return u.length>0&&(l=pe(l,u)),F(l,n.shape)},b:()=>{const o=Z(Ue(n),Ue(s));let l=Ye(_(t,ge(n,o)));const u=Et(s.shape,a);return u.length>0&&(l=pe(l,u)),F(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FU={kernelName:Fl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,Z(Ue(re(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jU={kernelName:jl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,ce(we(1),Ue(re(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PU(t,e,n,s,a,r){const i=I(t,"dy","avgPool3dGrad"),o=I(e,"input","avgPool3dGrad");let l=i,u=o,c=!1;o.rank===4&&(c=!0,l=F(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),u=F(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),C(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),C(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Nn("avgPool3dGrad",a,r);const d={dy:l,input:u},p={filterSize:n,strides:s,pad:a,dimRoundingMode:r},h=R.runKernel(Sm,d,p);return c?F(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const LU=D({avgPool3dGrad_:PU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zU={kernelName:bd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:a,strides:r,pad:i,dimRoundingMode:o}=n;return{x:()=>LU(t,s,a,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BU(t,e,n,s,a){const r=I(t,"dy","avgPoolGrad"),i=I(e,"input","avgPoolGrad");C(i.rank===r.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${r.rank})`);let o=i,l=r,u=!1;i.rank===3&&(u=!0,o=F(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=F(r,[1,r.shape[0],r.shape[1],r.shape[2]])),C(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),C(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const c={dy:l,input:o},d={filterSize:n,strides:s,pad:a},p=R.runKernel(vm,c,d);return u?F(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const MU=D({avgPoolGrad_:BU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VU={kernelName:wd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:a,strides:r,pad:i}=n;return{x:()=>MU(t,s,a,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WU={kernelName:xd,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,a]=e,{transposeA:r,transposeB:i}=n;return!r&&!i?{a:()=>$e(t,a,!1,!0),b:()=>$e(s,t,!0,!1)}:!r&&i?{a:()=>$e(t,a,!1,!1),b:()=>$e(t,s,!0,!1)}:r&&!i?{a:()=>$e(a,t,!1,!0),b:()=>$e(s,t,!1,!1)}:{a:()=>$e(a,t,!0,!0),b:()=>$e(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UU={kernelName:kd,gradFunc:(t,e,n)=>{const{blockShape:s,crops:a}=n;return{x:()=>Ap(t,s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GU={kernelName:r$,gradFunc:(t,e,n)=>{const s=n,a=s.inputShape,r=s.shape,i=Array.from(r);for(let l=a.length-1;l>=0;l--)if(a[l]===r[l])i[l]=1;else if(a[l]!==1)throw new Error(`broadcastTo(): [${a}] cannot be broadcast to [${r}].`);const o=[];for(let l=0;l<i.length;l++)i[l]>1&&o.push(l);return{x:()=>pe(t,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HU={kernelName:Ll,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KU={kernelName:zl,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qU={kernelName:Bl,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:a,clipValueMax:r}=n;return{x:()=>Qt(na(ir(s,a),ui(s,r)),t,Oe(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JU={kernelName:Sd,inputsToSave:["x"],gradFunc:_E.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XU={kernelName:Nd,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:a}=n,r=Ee(a,e[0].shape)[0],i=s.map(l=>l[r]);return An(t,i,r).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YU={kernelName:Cd,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,a]=e,{dilations:r,strides:i,pad:o,dataFormat:l}=n;return C(Gr(r),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`),{x:()=>tk(s.shape,t,a,i,o,l),filter:()=>Wk(s,t,a.shape,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QU={kernelName:Id,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,a]=e,{strides:r,pad:i,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>Qa(t,a,r,i,o,1,l),filter:()=>Wk(t,s,a.shape,r,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZU(t,e,n,s,a){let r=t;t.rank===4&&(r=F(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=F(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),C(r.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${r.shape}.`),C(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),C(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),C(r.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${r.shape[4]}) must match input depth in filter (${n[3]}.`),C(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const o={x:r,dy:i},l={strides:s,pad:a,filterShape:n};return R.runKernel(Tm,o,l)}const e5=D({conv3DBackpropFilter_:ZU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t5={kernelName:$d,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:a,pad:r}=n;C(Gr(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,o]=e;return{x:()=>U$(i.shape,t,o,a,r),filter:()=>e5(i,t,o.shape,a,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n5={kernelName:Ml,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(Ye(Hg(re(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s5={kernelName:Vl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(Kg(re(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a5={kernelName:Td,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:a,exclusive:r,reverse:i}=n;return{x:()=>{const o=ht([a],s.rank);let l=Dg(t,a,r,!i);return o!=null&&(l=De(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r5={kernelName:Ed,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:a,pad:r,dimRoundingMode:i}=n,o=s??[1,1];C(Gr(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,u]=e;return C(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),C(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),C(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),C(tn(a,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${a} and dilations '${o}'.`),Nn("depthwiseConv2d",r,i),{x:()=>FT(l.shape,t,u,a,r,o,i),filter:()=>OT(l,t,u.shape,a,r,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i5={kernelName:Ad,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,a]=e,r={x:s,filter:a,dy:t},i={x:s,filter:a,dy:t};return{x:()=>R.runKernel(Cf,r,n),filter:()=>R.runKernel(If,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o5={kernelName:Ul,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>R.runKernel(zm,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l5={kernelName:Gl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=_(On(Ye(Ue(n))),2/Math.sqrt(Math.PI));return{x:()=>_(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u5={kernelName:Hl,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c5={kernelName:Dd,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>F(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d5={kernelName:Kl,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,On(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p5={kernelName:ql,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h5={kernelName:Jl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=ve(n.shape,s.shape);return{a:()=>{const o=ge(t,re(s,"float32")),l=Et(n.shape,a);return l.length>0?F(pe(o,l),n.shape):o},b:()=>{let o=_(t,re(n,"float32"));const l=Et(s.shape,a);l.length>0&&(o=F(pe(o,l),s.shape));const u=Ue(s);return Ye(ge(o,re(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f5={kernelName:_d,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[a,r,i,o]=e,l=o??we(1),u=Et(r.shape,a.shape),c=[];if(r.rank===1){for(let x=0;x<a.shape.length-1;++x)c.push(a.shape[x]);c.push(1)}const d=ce(a,r),p=_(t,l),h=Wg(Z(i,we(s))),f=_(_(_(h,h),h),we(-.5));return{x:()=>r.rank===1?F(_(_(t,os(F(h,[1,1,1,r.shape[0]]),c)),l),a.shape):F(_(_(t,h),l),a.shape),mean:()=>{let x=_(_(h,we(-1)),p);return r.rank===1&&(x=pe(x,u)),F(x,r.shape)},variance:()=>{let x=_(_(f,d),p);return r.rank===1&&(x=pe(x,u)),F(x,r.shape)},scale:()=>{const x=_(d,h);let v=_(t,x);return r.rank===1&&(v=pe(v,u)),F(v,r.shape)},offset:()=>{let x=t;return r.rank===1&&(x=pe(x,u)),F(x,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m5={kernelName:Od,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,a]=e,{axis:r,batchDims:i}=n,o=Ee(r,s.shape)[0],l=(u,c,d)=>()=>{const p=u.shape,h=c.size,f=p.slice(0,o),g=f.length,y=p.slice(r,p.length).slice(1),m=y.length,w=aS(0,g),b=aS(g+1,g+1+m),x=rS([f,[h],y]),v=F(d,x),S=F(c,[h]),N=rS([[g],w,b]),$=De(v,N);let E=Zg($,S,u.shape[o]);const A=li(N);return E=De(E,A),E};if(i===1){const u=s.shape[0],c=s.split(u,0);return{x:()=>Fn(c.map((h,f)=>l(h,a.slice(f,1),t.slice(f,1))())).reshape(s.shape),indices:()=>a}}else return{x:l(s,a,t),indices:()=>a}}};function aS(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function rS(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g5={kernelName:Xl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Oe(n),b:()=>Oe(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y5={kernelName:Yl,gradFunc:t=>({x:()=>re(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w5={kernelName:Ql,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b5={kernelName:Zl,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x5={kernelName:eu,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k5={kernelName:jd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:a}=n,r=zn(s,0);return{x:()=>Qt(r,t,_(t,a))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v5={kernelName:nu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,Z(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5={kernelName:tu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,re(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N5={kernelName:i$,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:a}=n;return{logits:()=>{const i=On(s);return ce(t,_(pe(t,a,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C5(t,e,n,s=5,a=1,r=1,i=.5){const o={x:t,y:e,dy:n},l={depthRadius:s,bias:a,alpha:r,beta:i};return R.runKernel(Km,o,l)}const I5=D({localResponseNormalizationBackprop_:C5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $5={kernelName:Vd,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,a]=e,{depthRadius:r,bias:i,alpha:o,beta:l}=n;return{x:()=>I5(s,a,t,r,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OE(t,e,n,s){return e.rank<n.rank&&(e=F(e,kt(e.shape,s))),t.rank<n.rank&&(t=F(t,kt(t.shape,s))),{x:()=>_(t,re(Os(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iS={kernelName:Wd,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:a}=s,r=e[0],i=e[1],o=Ee(a,r.shape),l=OE(t,i,r,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T5={kernelName:su,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>_(t,re(ir(n,s),"float32")),b:()=>_(t,re(yl(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E5(t,e,n,s,a,r,i){const o=I(t,"dy","maxPool3dGrad"),l=I(e,"input","maxPool3dGrad"),u=I(n,"output","maxPool3dGrad");let c=o,d=l,p=u,h=!1;l.rank===4&&(h=!0,c=F(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=F(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=F(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),C(c.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),C(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),C(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),Nn("maxPool3dGrad",r,i);const f={dy:c,input:d,output:p},g={filterSize:s,strides:a,pad:r,dimRoundingMode:i},y=R.runKernel(Jm,f,g);return h?F(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const A5=D({maxPool3dGrad_:E5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R5={kernelName:Gd,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,a]=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=n;return{x:()=>A5(t,s,a,r,i,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D5(t,e,n,s,a,r,i){const o=I(t,"dy","maxPoolGrad"),l=I(e,"input","maxPoolGrad"),u=I(n,"output","maxPoolGrad");C(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),C(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),C(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Nn("maxPoolGrad",r,i);const c={dy:o,input:l,output:u},d={filterSize:s,strides:a,pad:r,dimRoundingMode:i};return R.runKernel(qm,c,d)}const _5=D({maxPoolGrad_:D5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O5={kernelName:Ud,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,a]=e,{filterSize:r,strides:i,pad:o}=n;return{x:()=>_5(t,s,a,r,i,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F5={kernelName:Hd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:a}=n,r=Ee(a,s.shape),o=Ht(s.shape,r)[1],l=H(o);return{x:()=>{const c=s.shape.slice();r.forEach(h=>{c[h]=1});const d=F(t,c);return ge(_(d,Tn(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j5={kernelName:Kd,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:a}=s,[r,i]=e,o=Ee(a,r.shape),l=OE(t,i,r,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P5={kernelName:au,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>_(t,re(ui(n,s),"float32")),b:()=>_(t,re(zn(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L5={kernelName:qd,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:a}=n,r=a.map(i=>i[0]);return{x:()=>_e(t,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z5={kernelName:ru,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=ve(n.shape,s.shape);return{a:()=>{const o=Et(n.shape,a);return o.length>0?F(pe(t,o),n.shape):t},b:()=>{const o=_(t,Ye(Au(ge(n,s)))),l=Et(s.shape,a);return l.length>0?F(pe(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B5={kernelName:iu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=ve(n.shape,s.shape);return{a:()=>{const o=_(t,re(s,"float32")),l=Et(n.shape,a);return l.length>0?F(pe(o,l),n.shape):o},b:()=>{const o=_(t,re(n,"float32")),l=Et(s.shape,a);return l.length>0?F(pe(o,l),s.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M5={kernelName:Jd,gradFunc:t=>({x:()=>Ye(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V5={kernelName:Qd,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>$t(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W5={kernelName:Yd,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U5={kernelName:Zd,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return fs(t,s).map(r=>()=>r)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oS={kernelName:ep,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:a}=n,r=a.map(i=>i[0]);return{x:()=>_e(t,r,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G5={kernelName:ou,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,a]=e,r=n,i=s,o=ve(r.shape,i.shape);return{a:()=>{const c=re(i,"float32");let d=_(t,_(c,$a(r,ce(c,we(1)))));const p=Et(r.shape,o);return p.length>0&&(d=pe(d,p)),F(d,r.shape)},b:()=>{const c=zn(r,0),d=Qt(c,Xn(r),Oe(r));let p=_(t,_(a,d));const h=Et(i.shape,o);return h.length>0&&(p=pe(p,h)),F(p,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H5={kernelName:tp,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,a=zn(n,0);return{x:()=>Qt(a,t,_(t,s)),alpha:()=>{let r=Qt(a,Oe(t),_(t,n));const i=Et(s.shape,t.shape);return i.length>0&&(r=pe(r,i)),F(r,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K5(t,e,n){const s=t.shape.slice();s[n]=1;const a=F(e,s),r=Zc(t,n,!0,!1),i=Zc(t,n,!0,!0),o=_(r,i);return _(a,o)}function q5(t,e,n){const s=t.shape.length,a=s-n.length,r=ht(n,s);let i=t;r!=null&&(i=De(t,r));const o=i.shape.slice(),u=o.splice(s-n.length,n.length).reduce((p,h)=>p*h,1);o.push(u);const c=i.reshape(o);let d=K5(c,e,a);if(d=d.reshape(i.shape),r!=null){const p=li(r);d=De(d,p)}return d}const J5={kernelName:np,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:a}=n;let r=[];return a==null?r=s.shape.map((i,o)=>o):typeof a=="number"?r=[a]:r=a,{x:()=>q5(s,t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X5={kernelName:Wl,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=ve(n.shape,s.shape);return{a:()=>{const o=ge(t,re(s,"float32")),l=Et(n.shape,a);return l.length>0?F(pe(o,l),n.shape):o},b:()=>{let o=_(t,re(n,"float32"));const l=Et(s.shape,a);l.length>0&&(o=F(pe(o,l),s.shape));const u=Ue(s);return Ye(ge(o,re(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y5={kernelName:lu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,Ye(Ue(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q5={kernelName:cu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=_(ui(n,6),vo(n));return{x:()=>_(t,re(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z5={kernelName:uu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,re(vo(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eG={kernelName:sp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>F(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tG={kernelName:rp,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,a={dy:t,images:s};return{images:()=>R.runKernel(og,a,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nG={kernelName:ap,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,a={dy:t,images:s};return{images:()=>R.runKernel(ig,a,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sG={kernelName:ip,gradFunc:(t,e,n)=>{const{dims:s}=n,a=Ee(s,t.shape);return{x:()=>hs(t,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aG={kernelName:du,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rG={kernelName:pu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ye(ge(t,_($a(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iG={kernelName:op,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>re(Oe(n),"float32"),t:()=>_(t,re(n,t.dtype)),e:()=>_(t,re($p(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oG={kernelName:hu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=zn(n,we(0)),a=we(h0),r=we(f0),i=_(t,r),o=_(_(t,a),On(re(n,"float32")));return Qt(s,i,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lG={kernelName:yu,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,_(n,ce(we(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uG={kernelName:gu,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cG={kernelName:fu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(vp(re(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dG={kernelName:mu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(Rg(re(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pG={kernelName:lp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:a,size:r}=n,i=s.shape,[o,l]=d0(s,a,r),u=[];for(let c=0;c<t.rank;c++)u.push([o[c],i[c]-o[c]-l[c]]);return{x:()=>or(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hG={kernelName:pp,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:a}=n,r=!0,i=_(t,s);return{logits:()=>ce(i,_(pe(i,[a],r),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fG={kernelName:wu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,Zs(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lS={kernelName:cp,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:a}=n;return{x:()=>kp(t,s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uS={kernelName:dp,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>xt(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mG={kernelName:bu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,_(Ut(re(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gG={kernelName:gg,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(t,_(re(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yG={kernelName:xu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=we(2);return{a:()=>_(t,_(a,ce(n,s))),b:()=>_(t,_(a,ce(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wG={kernelName:Cu,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bG={kernelName:ku,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,a=ve(n.shape,s.shape);return{a:()=>{let o=t;const l=Et(n.shape,a);return l.length>0&&(o=pe(o,l)),F(o,n.shape)},b:()=>{let o=t;const l=Et(s.shape,a);return l.length>0&&(o=pe(o,l)),F(Ye(o),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xG={kernelName:up,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,a=s.shape.slice(),{axis:r}=n;Ee(r,s.shape).forEach(u=>{a[u]=1});const o=F(t,a),l=_(o,Tn(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kG={kernelName:vu,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,Ue(vp(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vG={kernelName:Su,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_(ce(we(1),Ue(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SG={kernelName:Nu,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:a}=n;return{x:()=>{let i=Oe(s);if(s.rank===1)for(let o=0;o<a[0];++o)i=Z(i,_e(t,[o*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let o=0;o<a[0];++o)for(let l=0;l<a[1];++l)i=Z(i,_e(t,[o*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let o=0;o<a[0];++o)for(let l=0;l<a[1];++l)for(let u=0;u<a[2];++u)i=Z(i,_e(t,[o*s.shape[0],l*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let o=0;o<a[0];++o)for(let l=0;l<a[1];++l)for(let u=0;u<a[2];++u)for(let c=0;c<a[3];++c)i=Z(i,_e(t,[o*s.shape[0],l*s.shape[1],u*s.shape[2],c*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NG={kernelName:Li,gradFunc:(t,e,n)=>{const s=n,{perm:a}=s,r=li(a);return{x:()=>De(t,r)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CG={kernelName:fp,gradFunc:(t,e,n)=>{const s=n,{axis:a}=s;return{value:()=>Fn(t,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IG={kernelName:mp,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>$G(t,n)}}};function $G(t,e){const n=Ra(e,Oe(e)),s=Ru(t,n);let a=ir(e,we(0,"int32"));const r=s.rank-a.rank;for(let o=0;o<r;++o)a=on(a,o+1);a=na(a,Tn(s.shape,"bool"));const i=Oe(s);return Qt(a,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TG={kernelName:gp,gradFunc:t=>({x:()=>Oe(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EG=[_E,IU,$U,TU,EU,AU,RU,DU,_U,OU,FU,jU,zU,VU,WU,UU,GU,HU,KU,qU,JU,XU,QU,YU,t5,n5,s5,a5,r5,i5,X5,o5,l5,u5,c5,d5,h5,p5,f5,m5,g5,y5,w5,b5,x5,k5,v5,S5,N5,$5,iS,iS,T5,R5,O5,F5,j5,P5,L5,z5,B5,M5,V5,W5,U5,oS,oS,G5,H5,J5,Y5,Q5,Z5,eG,tG,nG,sG,aG,rG,iG,oG,lG,uG,cG,dG,pG,hG,fG,lS,lS,uS,uS,mG,yG,gG,wG,bG,xG,kG,vG,SG,NG,CG,IG,TG];for(const t of EG)o$(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.abs=function(){return this.throwIfDisposed(),Ct(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.acos=function(){return this.throwIfDisposed(),jx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.acosh=function(){return this.throwIfDisposed(),Px(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.add=function(t){return this.throwIfDisposed(),Z(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.all=function(t,e){return this.throwIfDisposed(),Tg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.any=function(t,e){return this.throwIfDisposed(),Xc(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.argMax=function(t){return this.throwIfDisposed(),Qi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.argMin=function(t){return this.throwIfDisposed(),Lx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asScalar=function(){return this.throwIfDisposed(),C(this.size===1,()=>"The array must have only 1 element."),F(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asType=function(t){return this.throwIfDisposed(),re(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as1D=function(){return this.throwIfDisposed(),F(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as2D=function(t,e){return this.throwIfDisposed(),F(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),F(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),F(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.as5D=function(t,e,n,s,a){return this.throwIfDisposed(),F(this,[t,e,n,s,a])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asin=function(){return this.throwIfDisposed(),zx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.asinh=function(){return this.throwIfDisposed(),Bx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.atan=function(){return this.throwIfDisposed(),Mx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.atan2=function(t){return this.throwIfDisposed(),Vx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.atanh=function(){return this.throwIfDisposed(),Wx(this)};q().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),xp(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),kp(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.batchNorm=function(t,e,n,s,a){return this.throwIfDisposed(),Iu(this,t,e,n,s,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.broadcastTo=function(t){return this.throwIfDisposed(),zi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cast=function(t){return this.throwIfDisposed(),re(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.ceil=function(){return this.throwIfDisposed(),Xx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),_n(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof ze&&(t=[t]),xt([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.conv1d=function(t,e,n,s,a,r){return this.throwIfDisposed(),Eg(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.conv2dTranspose=function(t,e,n,s,a){return this.throwIfDisposed(),Ag(this,t,e,n,s,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.conv2d=function(t,e,n,s,a,r){return this.throwIfDisposed(),Qa(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cos=function(){return this.throwIfDisposed(),vp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cosh=function(){return this.throwIfDisposed(),Rg(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Zc(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Dg(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),ak(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.depthwiseConv2d=function(t,e,n,s,a,r){return this.throwIfDisposed(),$u(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.dilation2d=function(t,e,n,s,a){return this.throwIfDisposed(),rk(this,t,e,n,s,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.divNoNan=function(t){return this.throwIfDisposed(),ik(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.div=function(t){return this.throwIfDisposed(),ge(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.dot=function(t){return this.throwIfDisposed(),ok(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.elu=function(){return this.throwIfDisposed(),Tu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.equal=function(t){return this.throwIfDisposed(),Os(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.erf=function(){return this.throwIfDisposed(),_g(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),uk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.exp=function(){return this.throwIfDisposed(),On(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.expandDims=function(t){return this.throwIfDisposed(),on(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.expm1=function(){return this.throwIfDisposed(),ck(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.fft=function(){return this.throwIfDisposed(),Fp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.flatten=function(){return this.throwIfDisposed(),F(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.floor=function(){return this.throwIfDisposed(),Au(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.floorDiv=function(t){return this.throwIfDisposed(),$g(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.gather=function(t,e,n){return this.throwIfDisposed(),Ru(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.greaterEqual=function(t){return this.throwIfDisposed(),ir(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.greater=function(t){return this.throwIfDisposed(),zn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.ifft=function(){return this.throwIfDisposed(),kl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.irfft=function(){return this.throwIfDisposed(),Jg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.isFinite=function(){return this.throwIfDisposed(),dk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.isInf=function(){return this.throwIfDisposed(),pk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.isNaN=function(){return this.throwIfDisposed(),hk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.leakyRelu=function(t){return this.throwIfDisposed(),Np(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.lessEqual=function(t){return this.throwIfDisposed(),ui(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.less=function(t){return this.throwIfDisposed(),yl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),fk(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logSigmoid=function(){return this.throwIfDisposed(),mk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logSoftmax=function(t){return this.throwIfDisposed(),jg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),Ip(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.log=function(){return this.throwIfDisposed(),Xn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.log1p=function(){return this.throwIfDisposed(),Cp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalAnd=function(t){return this.throwIfDisposed(),na(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalNot=function(){return this.throwIfDisposed(),$p(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalOr=function(t){return this.throwIfDisposed(),Pg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.logicalXor=function(t){return this.throwIfDisposed(),gk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),$e(this,t,e,n)};q().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),Tp(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.max=function(t,e){return this.throwIfDisposed(),ds(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.maximum=function(t){return this.throwIfDisposed(),Ra(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mean=function(t,e){return this.throwIfDisposed(),ct(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.min=function(t,e){return this.throwIfDisposed(),gl(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.minimum=function(t){return this.throwIfDisposed(),Kr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),wk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mod=function(t){return this.throwIfDisposed(),bk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.mul=function(t){return this.throwIfDisposed(),_(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.neg=function(){return this.throwIfDisposed(),Ye(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Eu(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.notEqual=function(t){return this.throwIfDisposed(),to(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),wl(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.onesLike=function(){return this.throwIfDisposed(),Yn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.pad=function(t,e){return this.throwIfDisposed(),or(this,t,e)};q().prototype.pool=function(t,e,n,s,a,r){return this.throwIfDisposed(),xk(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.pow=function(t){return this.throwIfDisposed(),$a(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.prelu=function(t){return this.throwIfDisposed(),Rp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.prod=function(t,e){return this.throwIfDisposed(),kk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reciprocal=function(){return this.throwIfDisposed(),Rk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.relu=function(){return this.throwIfDisposed(),la(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.relu6=function(){return this.throwIfDisposed(),Mg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reshapeAs=function(t){return this.throwIfDisposed(),F(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reshape=function(t){return this.throwIfDisposed(),F(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),zT(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),BT(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.reverse=function(t){return this.throwIfDisposed(),hs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.rfft=function(){return this.throwIfDisposed(),jp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.round=function(){return this.throwIfDisposed(),Vg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.rsqrt=function(){return this.throwIfDisposed(),Wg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.selu=function(){return this.throwIfDisposed(),Ug(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.separableConv2d=function(t,e,n,s,a,r){return this.throwIfDisposed(),Gg(this,t,e,n,s,a,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sigmoid=function(){return this.throwIfDisposed(),Zs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sign=function(){return this.throwIfDisposed(),Dk(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sin=function(){return this.throwIfDisposed(),Hg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sinh=function(){return this.throwIfDisposed(),Kg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.slice=function(t,e){return this.throwIfDisposed(),_e(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.softmax=function(t){return this.throwIfDisposed(),Op(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.softplus=function(){return this.throwIfDisposed(),xo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Ap(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.split=function(t,e){return this.throwIfDisposed(),An(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sqrt=function(){return this.throwIfDisposed(),Ut(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.square=function(){return this.throwIfDisposed(),Ue(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Xg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.squeeze=function(t){return this.throwIfDisposed(),di(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof ze?[this,t]:[this,...t];return Fn(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.step=function(t){return this.throwIfDisposed(),vo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.stridedSlice=function(t,e,n,s,a,r,i,o){return this.throwIfDisposed(),_k(this,t,e,n,s,a,r,i,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sub=function(t){return this.throwIfDisposed(),ce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.sum=function(t,e){return this.throwIfDisposed(),pe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.tan=function(){return this.throwIfDisposed(),Ok(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.tanh=function(){return this.throwIfDisposed(),Hr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.tile=function(t){return this.throwIfDisposed(),os(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.toBool=function(){return this.throwIfDisposed(),re(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.toFloat=function(){return this.throwIfDisposed(),re(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.toInt=function(){return this.throwIfDisposed(),re(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.topk=function(t,e){return this.throwIfDisposed(),Pk(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.transpose=function(t){return this.throwIfDisposed(),De(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.unique=function(t){return this.throwIfDisposed(),Lk(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Zg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.unstack=function(t){return this.throwIfDisposed(),fs(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.where=function(t,e){return this.throwIfDisposed(),Qt(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q().prototype.zerosLike=function(){return this.throwIfDisposed(),Oe(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class pa extends Error{constructor(e){super(e),Object.setPrototypeOf(this,pa.prototype)}}class Ts extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ts.prototype)}}class P extends Error{constructor(e){super(e),Object.setPrototypeOf(this,P.prototype)}}class Ce extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ce.prototype)}}class I1 extends Error{constructor(e){super(e),Object.setPrototypeOf(this,I1.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FE{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ao(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function ha(t,e){if(!t)throw new I1(e)}function cS(t,e){let n=0;for(const s of t)s===e&&n++;return n}function $n(t){return t.length===1?t[0]:t}function Me(t){return Array.isArray(t)?t:[t]}function Pa(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Ii(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let ws={};function $1(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function Gw(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>Gw(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:Gw(s))}}}function Bp(t,e={},n={},s="object",a=!1){if(typeof t=="string"){const r=t;let i;if(r in n)i=n[r];else if(r in ws)i=ws[r];else if(i=e[r],i==null)throw new P(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const r=t;if(r.className==null||r.config==null)throw new P(`${s}: Improper config format: ${JSON.stringify(r)}.
'className' and 'config' must set.`);const i=r.className;let o,l;if(i in n?[o,l]=n[i]:i in ws?[o,l]=ws.className:i in e&&([o,l]=e[i]),o==null)throw new P(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const h of Object.keys(ws))u[h]=ws[h];for(const h of Object.keys(n))u[h]=n[h];const c=r.config;c.customObjects=u;const d=Object.assign({},ws);for(const h of Object.keys(n))ws[h]=n[h];Gw(r.config);const p=l(o,r.config,n,a);return ws=Object.assign({},d),p}else{const u=Object.assign({},ws);for(const d of Object.keys(n))ws[d]=n[d];const c=new o(r.config);return ws=Object.assign({},u),c}}}function AG(t,e){return t<e?-1:t>e?1:0}function xh(t,e){return-1*AG(t,e)}function Pr(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function RG(t){if(t==null)throw new P(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function No(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new P(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function T1(t,e,n=0,s=1/0){return ha(n>=0),ha(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(a=>typeof a===e)}function Vt(t,e){Array.isArray(t)?(C(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>Vt(n,`element ${s+1} of ${e}`))):C(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${jE(t)}.`)}function jE(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>jE(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function DG(t,e,n){let s=n!=null?n():mn(),a;return(...i)=>{const o=n!=null?n():mn();return o-s<e||(s=o,a=t(...i)),a}}function PE(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let _G=0;function LE(){return _G++}const kh={};function m0(t=""){return t in kh||(kh[t]=0),kh[t]+=1,t+kh[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const OG=["channelsFirst","channelsLast"],FG=["nearest","bilinear"],jG=["valid","same","causal"],PG=["max","avg"],LG=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ro=new Map;function St(t){No(OG,"DataFormat",t)}function zG(t){No(FG,"InterpolationFormat",t)}function ys(t){No(jG,"PaddingMode",t)}function zE(t){No(PG,"PoolMode",t)}const vc=[],dS="/";function Bi(t,e){vc.push(t);try{const n=e();return vc.pop(),n}catch(n){throw vc.pop(),n}}function BG(){return vc.length===0?"":vc.join(dS)+dS}function BE(t){if(!VE(t))throw new Error("Not a valid tensor name: '"+t+"'");return BG()+t}function ME(t){if(!VE(t))throw new Error("Not a valid tensor name: '"+t+"'");Ro.has(t)||Ro.set(t,0);const e=Ro.get(t);if(Ro.set(t,Ro.get(t)+1),e>0){const n=`${t}_${e}`;return Ro.set(n,1),n}else return t}const MG=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function VE(t){return!!t.match(MG)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function VG(t){return t===parseInt(t.toString(),10)}function Lr(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let a=e;a<n;++a)s*=t[a];return s}function vl(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function qr(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function sa(t,e){if(e<t)throw new P(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let hy;function Dt(){return hy==null&&(hy=Rx().epsilon()),hy}function aa(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sa(t,e){return re(t,e)}function Mp(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),F(t,n)}function WG(t,e){return B(()=>{if(t.shape.length!==2)throw new P(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Mp(t,1);return Hw(n,[1,e,1])})}function UG(t){const e=[Lr(t.shape)];return F(t,e)}function GG(t){if(t.rank<=1)throw new P(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Lr(t.shape,1)];return F(t,e)}function Mi(t,e,n){return B(()=>{switch(t.rank){case 1:return Dp(t,e,n);case 2:return qg(t,[e,0],[n,t.shape[1]]);case 3:return _p(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return xl(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return _e(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return _e(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new P(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function fy(t,e,n){return B(()=>{switch(t.rank){case 1:return Dp(t,e,n);case 2:return qg(t,[0,e],[t.shape[0],n]);case 3:return _p(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return xl(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new P(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function vh(t,e,n,s){return B(()=>{switch(t.rank){case 1:return Dp(t,e,n);case 2:switch(s){case 1:return Mi(t,e,n);case 2:return fy(t,e,n);default:throw new P(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Mi(t,e,n);case 2:return _p(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return fy(t,e,n);default:throw new P(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Mi(t,e,n);case 2:return xl(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return xl(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return fy(t,e,n);default:throw new P(`The axis is not within the rank of the tensor ${s}`)}default:throw new P(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function E1(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),xt(t,e)}function pS(t,e){switch(t.rank){case 1:return Yx([t,e]);case 2:return Qx([t,e],0);case 3:return Zx([t,e],0);case 4:return ek([t,e],0);default:throw new P(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Hw(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new P(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return os(t,e)}function g0(t,e=0,n=1,s,a){return Bg(t,e,n,s,a)}function Na(t,e,n,s){if(t.rank<2||e.rank<2)throw new Ce(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const a=t.shape.slice(-1)[0],r=e.shape.slice(-2)[0];if(a!==r)throw new Ce(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return Bw({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Kw(t.rank,s,aa()):null,activation:n});{const a=t.shape.slice(),r=a.pop();t=F(t,[-1,r]);const i=e.shape.slice(),o=i.pop(),l=i.pop(),u=[...i,o],c=Array.from({length:e.rank},(f,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=F(De(e,c),[l,-1]);const d=[...a,...u];return F(Bw({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Kw(t.rank,s,aa()):null,activation:n}),d)}}function WE(t,e,n){return B(()=>(Array.isArray(e)?e=ln(e,"int32"):e=re(e,"int32"),Ru(t,e,n)))}function Vp(t){return _(t,t)}function Kw(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new P(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?F(e,[1,s[0],1,1,1]):F(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?F(e,[1,1,1,1,s[0]]):F(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?F(e,[1,s[0],1,1]):F(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?F(e,[1,1,1,s[0]]):F(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?F(e,[1,s[0],1]):F(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?F(e,[1,1,s[0]]):F(e,[1].concat(s))}else if(t<3)return e;throw new P(`Unsupported input rank by biasAdd: ${e.rank}`)}function ua(t,e,n){return B(()=>(n==null&&(n=aa()),St(n),Z(t,Kw(t.rank,e,n))))}function HG(t,e=1){if(e!==1)throw new Ce(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Tu(t)}function KG(t){return B(()=>ge(t,Z(Ct(t),1)))}function UE(t,e,n,s){return B(()=>Mk(t,e,n,s))}function qG(t){return B(()=>{const e=Z(.5,_(.2,t));return _n(e,0,1)})}function Wp(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const JG=["fanIn","fanOut","fanAvg"],XG=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function YG(t){No(JG,"FanMode",t)}function QG(t){No(XG,"Distribution",t)}class js extends So{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class GE extends js{apply(e,n){return $t(e,n)}}GE.className="Zeros";ee(GE);class A1 extends js{apply(e,n){return Tn(e,n)}}A1.className="Ones";ee(A1);class HE extends js{constructor(e){if(super(),typeof e!="object")throw new P(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new P(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return B(()=>_(we(this.value),Tn(e,n)))}getConfig(){return{value:this.value}}}HE.className="Constant";ee(HE);class KE extends js{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return ci(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}KE.className="RandomUniform";ee(KE);class qE extends js{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ce(`randomNormal does not support dType ${n}.`);return g0(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}qE.className="RandomNormal";ee(qE);class JE extends js{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ce(`truncatedNormal does not support dType ${n}.`);return Qg(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}JE.className="TruncatedNormal";ee(JE);class XE extends js{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return B(()=>{if(e.length!==2||e[0]!==e[1])throw new P("Identity matrix initializer can only be used for 2D square matrices.");return _(this.gain,Og(e[0]))})}getConfig(){return{gain:this.gain}}}XE.className="Identity";ee(XE);function ZG(t,e="channelsLast"){let n,s;if(St(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const a=Lr(t,2);n=t[1]*a,s=t[0]*a}else if(e==="channelsLast"){const a=Lr(t,0,t.length-2);n=t[t.length-2]*a,s=t[t.length-1]*a}}else{const a=Lr(t);n=Math.sqrt(a),s=Math.sqrt(a)}return[n,s]}class Qn extends js{constructor(e){if(super(),e.scale<0)throw new P(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,YG(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,QG(this.distribution),this.seed=e.seed}apply(e,n){const s=ZG(e),a=s[0],r=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,a):this.mode==="fanOut"?i/=Math.max(1,r):i/=Math.max(1,(a+r)/2),this.distribution==="normal"){const o=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Ce(`${this.getClassName()} does not support dType ${n}.`);return Qg(e,0,o,n,this.seed)}else{const o=Math.sqrt(3*i);return ci(e,-o,o,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Qn.className="VarianceScaling";ee(Qn);class R1 extends Qn{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Qn.className}}R1.className="GlorotUniform";ee(R1);class D1 extends Qn{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Qn.className}}D1.className="GlorotNormal";ee(D1);class _1 extends Qn{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Qn.className}}_1.className="HeNormal";ee(_1);class O1 extends Qn{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Qn.className}}O1.className="HeUniform";ee(O1);class F1 extends Qn{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Qn.className}}F1.className="LeCunNormal";ee(F1);class j1 extends Qn{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Qn.className}}j1.className="LeCunUniform";ee(j1);class YE extends js{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return B(()=>{if(e.length<2)throw new Ce("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=H(e.slice(0,-1)),a=e[e.length-1],r=s*a;r>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${r}) elements: Slowness may result.`);const i=[Math.max(a,s),Math.min(a,s)],o=g0(i,0,1,n,this.seed),l=Gk.qr(o,!1);let u=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(a,s)*Math.min(a,s)],[Math.min(a,s)+1]);return u=_(u,d.sign()),s<a&&(u=u.transpose()),_(we(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}YE.className="Orthogonal";ee(YE);const hS={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function fS(t,e={}){return Bp(t,rs.getMap().classNameMap,e,"initializer")}function dt(t){return $1(t)}function rt(t){if(typeof t=="string"){const e=t in hS?hS[t]:t;if(e==="GlorotNormal")return new D1;if(e==="GlorotUniform")return new R1;if(e==="HeNormal")return new _1;if(e==="HeUniform")return new O1;if(e==="LeCunNormal")return new F1;if(e==="LeCunUniform")return new j1;{const n={};return n.className=e,n.config={},fS(n)}}else return t instanceof js?t:fS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qw(t){return Array.isArray(t)&&Array.isArray(t[0])}function _f(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function ke(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new P(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Pe(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new P(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Of(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,a)=>s*a);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mS="Variable";class e6{constructor(e,n="float32",s=mS,a=!0,r=null){this.dtype=n??"float32",this.shape=e.shape,this.id=LE(),s=s??mS,this.originalName=BE(s),this.name=ME(this.originalName),this.trainable_=a,this.constraint=r,this.val=zk(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),t6(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function t6(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function Jw(t){return t.map(e=>e.read())}function P1(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _t{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Ea{constructor(e,n,s,a,r,i,o){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=a,this.callArgs=r,this.outputTensorIndex=o,this.id=LE(),i!=null&&(this.originalName=BE(i),this.name=ME(this.originalName)),this.rank=n.length}}let n6=0;class y0{constructor(e,n){this.callArgs=n,this.id=n6++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let s6=0;class Ae extends So{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=s6++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=Pa(s)+"_"+m0(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let r=null;e.batchSize!=null&&(r=e.batchSize),s=[r].concat(e.inputShape)}this.batchInputShape=s;let a=e.dtype;a==null&&(a=e.inputDType),a==null&&(a="float32"),this.dtype=a}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Ts(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new P(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return $n(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return $n(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new pa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new pa(`Layer ${this.name} is not connected, no input to return.`);return $n(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new pa(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new pa(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return $n(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Me(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Me(this.inputSpec);if(n.length!==s.length)throw new P(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let a=0;a<n.length;a++){const r=n[a],i=s[a];if(i==null)continue;const o=r.rank;if(i.ndim!=null&&o!==i.ndim)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${o}`);if(i.maxNDim!=null&&o>i.maxNDim)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${o}`);if(i.minNDim!=null&&o<i.minNDim)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${o}.`);if(i.dtype!=null&&r.dtype!==i.dtype)throw new P(`Input ${a} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${r.dtype}.`);if(i.axes){const l=r.shape;for(const u in i.axes){const c=Number(u),d=i.axes[u],p=c>=0?l[c]:l[l.length+c];if(d!=null&&[d,null].indexOf(p)===-1)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected axis ${c} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const u=i.shape[l],c=r.shape[l];if(u!=null&&c!=null&&u!==c)throw new P(`Input ${a} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${r.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Me(e),a=i6(e),r=o6(e);if(a===r)throw new P("Arguments to apply() must be all SymbolicTensors or all Tensors");return Bi(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const o of Me(e))i.push(o.shape);this.build($n(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&r&&(this._refCount=1)}if(this.assertInputCompatibility(e),r){let i=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,i);const o=Me(i),l=[];for(let u of o)s.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(i=$n(l),this.activityRegularizer!=null)throw new Ce("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=a6(e),o=this.computeOutputShape(i);let l;const u=r6(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((c,d)=>new Ea(u,c,this,Me(e),n,this.name,d)):l=new Ea(u,o,this,Me(e),n,this.name),this.addInboundNode(e,l,null,null,i,o,n),this._refCount++,this.activityRegularizer!=null)throw new Ce("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,a)=>{s!=null&&e[a]!=null&&e[a]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new pa(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new pa(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Ts(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Of(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Jw(e?this.trainableWeights:this.weights)}setWeights(e){B(()=>{const n=this.weights;if(n.length!==e.length)throw new P(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],a=Jw(n);for(let r=0;r<a.length;++r){const i=a[r],o=n[r],l=e[r];if(!Re(i.shape,l.shape))throw new P(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([o,l])}P1(s)})}addWeight(e,n,s,a,r,i,o,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new P(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(a=l!=null?l():rt("zeros"));const u=a.apply(n,s),c=new e6(u,s,e,i,o);return u.dispose(),r!=null&&this.addLoss(()=>r.apply(c.read())),i==null&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Me(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const a=this.computeMask(e,s),r=Me(n),i=Me(a);if(r.length!==i.length)throw new Error(`${this.name} outputs ${r.length} tensors but ${r.length} masks for those tensors`);for(let o=0;o<r.length;o++)r[o].kerasMask=i[o]}addInboundNode(e,n,s,a,r,i,o=null){const l=Me(e);n=Me(n),s=Me(s),a=Me(a),r=_f(r),i=_f(i);const u=[],c=[],d=[];for(const p of l)u.push(p.sourceLayer),c.push(p.nodeIndex),d.push(p.tensorIndex);new y0({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:a,inputShapes:r,outputShapes:i},o);for(let p=0;p<n.length;p++)n[p].sourceLayer=this,n[p].nodeIndex=this.inboundNodes.length-1,n[p].tensorIndex=p}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function a6(t){t=Me(t);const e=[];for(const n of t)e.push(n.shape);return $n(e)}function r6(t){return"float32"}function QE(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const a=[];for(let r=0;r<s.inboundLayers.length;r++){const i=s.inputTensors[r],o=s.inboundLayers[r],l=s.nodeIndices[r],u=QE(i,o,l);for(const c of u)a.indexOf(c)===-1&&a.push(c)}return a}}}function i6(t){let e=!0;for(const n of Me(t))if(!(n instanceof Ea)){e=!1;break}return e}function o6(t){let e=!0;for(const n of Me(t))if(n instanceof Ea){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Up extends Ae{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:m0("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new P("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new P("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new P("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const a=new Ea(this.dtype,this.batchInputShape,this,[],{},this.name);a.nodeIndex=0,a.tensorIndex=0,new y0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[a],outputTensors:[a],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new P(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Up.className="InputLayer";ee(Up);function l6(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new P("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Up({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function u6(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return re(e,t.dtype)}catch{throw new P(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Cr{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Cr)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=u6(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new P(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Ea){if(this.id2Value[e.id]==null)throw new P(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new P(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Ea){if(this.id2Value[e.id]==null)throw new P(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new P(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Te(this.id2Mask)}}const Ff=new FE,jf=new FE;function c6(t){Ff!=null&&Ff.setMaxEntries(t),jf!=null&&jf.setMaxEntries(t)}function oc(t,e,n,s){const a=n==null?!1:n.training,r=Array.isArray(t),i=r?t:[t],o=i.map(f=>f.name),l=[],u=e.names();for(const f of o)u.indexOf(f)!==-1?l.push(e.getValue(f)):l.push(null);const c=o.join(",")+"|"+e.names().sort().join(",");let d=Ff.get(c),p;if(d==null){const f=d6(i,e);d=f.sorted,p=f.recipientCounts,Ff.put(c,d),jf.put(c,p)}p={},a||Object.assign(p,jf.get(c));const h=new Cr(e);for(let f=0;f<d.length;++f){const g=d[f],y=g.sourceLayer;if(y instanceof Up)continue;const m=[],w=[],b=[];let x=!1;for(const E of g.inputs){const A=h.getValue(E),L=h.getMask(E);m.push(A),w.push(L),L!=null&&(x=!0),a||(p[E.name]--,p[E.name]===0&&!e.hasKey(E)&&o.indexOf(E.name)===-1&&!A.isDisposed&&E.sourceLayer.stateful!==!0&&b.push(A))}x&&(n=n||{},n.mask=w[0]);const v=Me(y.apply(m,n));let S=null;y.supportsMasking&&(S=y.computeMask(m,w));const N=h6(g),$=Array.isArray(N)?N:[N];for(let E=0;E<$.length;++E){h.hasKey($[E])||h.add($[E],v[E],Array.isArray(S)?S[0]:S);const A=o.indexOf($[E].name);A!==-1&&(l[A]=v[E])}a||Te(b)}return h.disposeMasks(),r?l:l[0]}function d6(t,e){C(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const a=gS(t[0],e);n=a.sorted,s=a.recipientMap}else{const a=new Set;for(const r of t){const{sorted:i,recipientMap:o}=gS(r,e);for(const l of i)a.has(l.name)||(n.push(l),a.add(l.name));for(const l in o)s[l]==null&&(s[l]=new Set),o[l].forEach(u=>s[l].add(u))}}return{sorted:n,recipientCounts:p6(s)}}function p6(t){const e={};for(const n in t)e[n]=t[n].size;return e}function gS(t,e){const n=new Set,s=[],a={};for(const o of e.names())n.add(o);const r=[],i=[];for(r.push(t);r.length>0;){const o=r[r.length-1];if(n.has(o.name)){r.pop();continue}const l=i[i.length-1]===r.length-1;if(o.inputs.length===0||l)r.pop(),s.push(o),n.add(o.name),l&&i.pop();else{i.push(r.length-1);for(const u of o.inputs)a[u.name]==null&&(a[u.name]=new Set),a[u.name].add(o.name),!n.has(u.name)&&r.push(u)}}return{sorted:s,recipientMap:a}}function h6(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const a of t.sourceLayer.inboundNodes[s].outputTensors)if(a.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f6=V();f6.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,c6);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function L1(t,e){return B(()=>Ut(pe(_(t,t),e,!0)))}class Gp extends So{getConfig(){return{}}}class ZE extends Gp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return B(()=>{const n=L1(e,this.axis),s=_n(n,0,this.maxValue);return _(e,ge(s,Z(Dt(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}ZE.className="MaxNorm";ee(ZE);class eA extends Gp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return B(()=>ge(e,Z(Dt(),L1(e,this.axis))))}getConfig(){return{axis:this.axis}}}eA.className="UnitNorm";ee(eA);class tA extends Gp{apply(e){return la(e)}}tA.className="NonNeg";ee(tA);class nA extends Gp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return B(()=>{const n=L1(e,this.axis),s=Z(_(this.rate,_n(n,this.minValue,this.maxValue)),_(1-this.rate,n));return _(e,ge(s,Z(Dt(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}nA.className="MinMaxNorm";ee(nA);const yS={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Ft(t){return $1(t)}function wS(t,e={}){return Bp(t,rs.getMap().classNameMap,e,"constraint")}function jt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in yS?yS[t]:t,config:{}};return wS(n)}else return t instanceof Gp?t:wS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function wi(t){if(t==null)return;const e=[],n=[],s=[];for(const a in t){const r=t[a];if(typeof r!="number"){const i=r;e.push(i.data()),n.push(a),s.push(i)}}if(e.length>0){const a=await Promise.all(e);for(let r=0;r<a.length;++r)t[n[r]]=a[r][0];Te(s)}}function sA(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var bS;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(bS||(bS={}));const m6=125;class ed{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class g6{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class y6 extends ed{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const a in n){const r=n[a];if(typeof r=="number")this.totals.hasOwnProperty(a)||(this.totals[a]=0),this.totals[a]=this.totals[a]+r*s;else{let i;a in this.totals?i=this.totals[a]:this.totals[a]=0;const o=B(()=>Z(this.totals[a],_(r,s)));this.totals[a]=o,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:B(()=>{const a=_(ge(1,this.seen),this.totals[s]);n[s]=a,this.totals[s].dispose(),Rt(n[s])}))}}class w6 extends ed{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const r in this.history){const i=this.history[r];for(let o=0;o<i.length;++o)if(typeof i[o]!="number"){const l=i[o];e.push(l.data()),n.push(r),s.push(o)}}const a=await Promise.all(e);for(let r=0;r<a.length;++r)this.history[n[r]][s[r]].dispose(),this.history[n[r]][s[r]]=a[r][0]}}class b6 extends ed{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||i1,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=m6),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Sf(this.yieldEvery)&&(this.maybeWait=DG(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const a=[];this.yield!=null&&(await wi(s),a.push(this.yield(e,n,s))),a.push(this.nextFrameFunc()),await Promise.all(a)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await wi(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await wi(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await wi(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await wi(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Sf(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await wi(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await wi(e),await this.trainEnd(e))}}function aA(t,e){return t==null&&(t={}),t instanceof ed?[t]:Array.isArray(t)&&t[0]instanceof ed?t:Me(t).map(s=>new b6(s,e))}class xs{constructor(){}static registerCallbackConstructor(e,n){C(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),xs.checkForDuplicate(n),xs.constructors[e]==null&&(xs.constructors[e]=[]),xs.constructors[e].push(n)}static checkForDuplicate(e){for(const n in xs.constructors)xs.constructors[+n].forEach(a=>{if(a===e)throw new P("Duplicate callback constructor.")})}static clear(){xs.constructors={}}static createCallbacks(e){const n=[];for(const s in xs.constructors){const a=+s;e>=a&&n.push(...xs.constructors[a])}return n.map(s=>new s)}}xs.constructors={};function rA(t,e,n,s,a,r,i,o,l){const u=new w6,c=[new y6,...xs.createCallbacks(e)];t!=null&&c.push(...t),c.push(u);const d=new g6(c);return d.setParams({epochs:n,initialEpoch:s,samples:a,steps:r,batchSize:i,verbose:e,doValidation:o,metrics:l}),{callbackList:d,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ga(t,e={},n=!1){return Bp(t,rs.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pf(t,e){return B(()=>{t.dtype!=="float32"&&(t=re(t,"float32"));const n=pe(Vp(t),e,!0),s=bo(n.shape,Dt()),a=Ut(Ra(n,s));return ge(t,a)})}function w0(t,e){return B(()=>ct(Vp(ce(e,t)),-1))}function z1(t,e){return B(()=>ct(Ct(ce(e,t)),-1))}function B1(t,e){return B(()=>{const n=ce(t,e),s=_n(Ct(t),Dt(),Number.MAX_VALUE),a=Ct(ge(n,s));return _(100,ct(a,-1))})}function x6(t,e){return B(()=>{const n=_n(e,Dt(),Number.MAX_VALUE),s=Xn(Z(1,n)),a=_n(t,Dt(),Number.MAX_VALUE),r=Xn(Z(1,a));return ct(Vp(ce(s,r)),-1)})}function k6(t,e){return B(()=>{const n=Ra(0,ce(1,_(t,e)));return ct(Vp(n),-1)})}function v6(t,e){return B(()=>{const n=Ra(0,ce(1,_(t,e)));return ct(n,-1)})}function S6(t,e){return B(()=>{const n=pe(_(t,e),-1),s=ds(_(ce(1,t),e),-1);return Ra(0,Z(1,ce(s,n)))})}function N6(t,e){return B(()=>{const n=Math.log(2),s=ce(e,t),a=ce(Z(s,xo(_(-2,s))),n);return ct(a,-1)})}function td(t,e,n=!1){return B(()=>{if(n)e=Op(e);else{const s=pe(e,e.shape.length-1,!0);e=ge(e,s)}return e=_n(e,Dt(),1-Dt()),Ye(pe(_(re(t,"float32"),Xn(e)),e.shape.length-1))})}function Lf(t,e,n=!1){return B(()=>{const s=re(Au(UG(t)),"int32");e=_n(e,Dt(),1-Dt());const a=e.shape,r=F(wl(s,a[a.length-1]),a);return td(r,e,n)})}function C6(t,e){if(!Re(t.shape,e.shape))throw new P(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return B(()=>{const n=la(e),s=Ye(Ct(e));return Z(ce(n,_(e,t)),Cp(On(s)))})}function b0(t,e){return B(()=>{let n;return n=_n(e,Dt(),1-Dt()),n=Xn(ge(n,ce(1,n))),ct(C6(t,n),-1)})}function I6(t,e){return B(()=>{const n=_n(t,Dt(),1),s=_n(e,Dt(),1);return pe(_(t,Xn(ge(n,s))),-1)})}function $6(t,e){return B(()=>{const n=Xn(Z(Dt(),e));return ct(ce(e,_(t,n)),-1)})}function iA(t,e){return B(()=>{const n=Pf(t,-1),s=Pf(e,-1),a=_(n,s);return Ye(pe(a,-1))})}const zf={meanSquaredError:w0,meanAbsoluteError:z1,meanAbsolutePercentageError:B1,meanSquaredLogarithmicError:x6,squaredHinge:k6,hinge:v6,categoricalHinge:S6,logcosh:N6,categoricalCrossentropy:td,sparseCategoricalCrossentropy:Lf,binaryCrossentropy:b0,kullbackLeiblerDivergence:I6,poisson:$6,cosineProximity:iA};function my(t){if(typeof t=="string"){if(t in zf)return zf[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new P(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oA(t,e){return B(()=>{const n=_(.5,Yn(e)),s=Sa(zn(e,n),t.dtype);return ct(Os(t,s),-1)})}function lA(t,e){return B(()=>Sa(Os(Qi(t,-1),Qi(e,-1)),"float32"))}function T6(t,e){return B(()=>re(pe(na(Os(t,1),Os(e,1))),"float32"))}function E6(t,e){return B(()=>re(pe(na(Os(t,0),Os(e,1))),"float32"))}function A6(t,e){return B(()=>{const n=T6(t,e),s=E6(t,e),a=Z(n,s);return re(Qt(zn(a,0),ge(n,a),0),"float32")})}function R6(t,e){return b0(t,e)}function D6(t,e){return t.rank===e.rank&&(t=di(t,[t.rank-1])),e=Qi(e,-1),e.dtype!==t.dtype&&(e=re(e,t.dtype)),re(Os(t,e),"float32")}const _6=w0,O6=w0,F6=z1,j6=z1,P6=B1,L6=B1,uA=td,z6=iA,cA=Lf,Bf={binaryAccuracy:oA,categoricalAccuracy:lA,precision:A6,categoricalCrossentropy:uA,sparseCategoricalCrossentropy:cA,mse:_6,MSE:O6,mae:F6,MAE:j6,mape:P6,MAPE:L6,cosine:z6};function B6(t){if(typeof t=="string"&&t in Bf)return Bf[t];if(typeof t!="string"&&t!=null)return t;throw new P(`Unknown metric ${t}`)}function Sh(t){if(ha(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(zf))if(zf[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Bf))if(Bf[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function M6(t){const e={Adagrad:()=>Si.adagrad(.01),Adadelta:()=>Si.adadelta(1,.95,Dt()),Adam:()=>Si.adam(.001,.9,.999,Dt()),Adamax:()=>Si.adamax(.002,.9,.999,Dt(),0),RMSProp:()=>Si.rmsprop(.001,.9,0,Dt()),SGD:()=>Si.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new P(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const xS=1*1024*1024;function kS(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!Xw(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>xS&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${xS}.`)}}function Xw(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!Xw(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!Xw(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function V6(t,e,n,s=console.log){const a=U6(t),r=["Layer (type)","Input Shape","Output shape","Param #"];a?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(c=>Math.floor(e*c)));let i;if(!a){r.push("Receives inputs"),i=[];for(const c in t.nodesByDepth)i.push(...t.nodesByDepth[c])}s("_".repeat(e)),Mf(r,n,s),s("=".repeat(e));const o=t.layers;for(let c=0;c<o.length;++c)a?G6(o[c],n,s):H6(o[c],n,i,s),s((c===o.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=W6(t),u=Of(t.nonTrainableWeights);s(`Total params: ${l+u}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function W6(t){let e;return t.collectedTrainableWeights!=null?e=Of(t.collectedTrainableWeights):e=Of(t.trainableWeights),e}function U6(t){let e=!0;const n=[],s=[];for(const a in t.nodesByDepth)n.push(t.nodesByDepth[a]);for(const a of n){if(a.length>1||a.length===1&&a[0].inboundLayers.length>1){e=!1;break}s.push(...a)}if(e)for(const a of t.layers){let r=!1;for(const i of a.inboundNodes)if(s.indexOf(i)!==-1)if(r){e=!1;break}else r=!0;if(!e)break}return e}function Mf(t,e,n=console.log){let s="";for(let a=0;a<t.length;++a)a>0&&(s=s.slice(0,s.length-1)+" "),s+=t[a],s=s.slice(0,e[a]),s+=" ".repeat(e[a]-s.length);n(s)}function G6(t,e,n){let s,a;try{a=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{a="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const r=t.name,i=t.getClassName(),o=[`${r} (${i})`,a,s,t.countParams().toString()];Mf(o,e,n)}function H6(t,e,n,s){let a,r;try{r=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{r="multiple"}try{a=JSON.stringify(t.outputShape)}catch{a="multiple"}const i=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let p=0;p<d.inboundLayers.length;++p){const h=d.inboundLayers[p].name,f=d.nodeIndices[p],g=d.tensorIndices[p];i.push(`${h}[${f}][${g}]`)}const o=t.name,l=t.getClassName(),u=i.length===0?"":i[0],c=[`${o} (${l})`,r,a,t.countParams().toString(),u];Mf(c,e,s);for(let d=1;d<i.length;++d)Mf(["","","","",i[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dA(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function Yw(t,e){if(t===null)return null;if(typeof t=="string")return Ii(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let a=0;a<s;++a){const r=t[a];dA(e,a,r)?n.push(r):n.push(Yw(r,e))}return n}else{const n={};for(const s of Object.keys(t)){const a=t[s];if(s==="name"&&typeof a=="string")n[s]=a;else{const r=Ii(s);n[r]=Yw(a,r)}}return n}}function Qw(t,e){if(t==null)return null;if(typeof t=="string")return Pa(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let a=0;a<s;++a){const r=t[a];dA(e,a,r)?n.push(r):n.push(Qw(r,e))}return n}else{const n={};for(const s of Object.keys(t)){const a=t[s],r=Pa(s);(s==="name"||s==="className")&&typeof a=="string"?n[r]=a:n[r]=Qw(a,s)}return n}}/** @license See the LICENSE file. */const pA="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const K6=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Ms extends Ae{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const w=this.getClassName().toLowerCase();this.name=m0(w)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Pr(this.inputs).length!==this.inputs.length)throw new P(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(w=>w.name)}`);Pr(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(w=>w.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const w of this.outputs){const b=w.sourceLayer,x=w.nodeIndex,v=w.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(x),this.outputLayersTensorIndices.push(v)}for(const w of this.inputs){const b=w.sourceLayer,x=w.nodeIndex,v=w.tensorIndex;ha(x===0,"input layer has >1 nodes"),ha(v===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(x),this.inputLayersTensorIndices.push(v)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let w=0;w<this.inputLayers.length;w++){const b=this.inputLayers[w];if(!(b instanceof Up))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${w} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const w of this.outputLayers)this.outputNames.push(w.name);this.internalInputShapes=this.inputs.map(w=>w.shape),this.internalOutputShapes=this.outputs.map(w=>w.shape);const n={},s={},a={},r={},i={},o=[],l=(w,b,x,v,S,N)=>{(v==null||S==null||N==null)&&(v=w.sourceLayer,S=w.nodeIndex,N=w.tensorIndex);const $=v.inboundNodes[S];if(x.indexOf($)!==-1)throw new Ts(`The tensor ${w.name} at layer "${v.name}" is part of a cycle.`);if(b.indexOf($)!==-1)return;this.containerNodes.add(Ms.nodeKey(v,S)),v.id in i||(i[v.id]=Object.keys(i).length),x.indexOf($)===-1&&x.push($);const E=$.inboundLayers.length;for(let A=0;A<E;A++){const L=$.inputTensors[A],W=$.inboundLayers[A],U=$.nodeIndices[A],j=$.tensorIndices[A];l(L,b,x,W,U,j)}for(b.push($);x.indexOf($)>=0;)x.splice(x.indexOf($),1);o.push($)},u=[],c=[];for(const w of this.outputs)l(w,u,c);const d=o.slice().reverse();for(const w of d){s[w.id]=w,w.id in n||(n[w.id]=0);let b=n[w.id];const x=a[w.outboundLayer.id]==null?0:a[w.outboundLayer.id];b=Math.max(b,x),a[w.outboundLayer.id]=b,r[w.outboundLayer.id]=w.outboundLayer,n[w.id]=b;for(let v=0;v<w.inboundLayers.length;v++){const S=w.inboundLayers[v],N=w.nodeIndices[v],$=S.inboundNodes[N],E=n[$.id]==null?0:n[$.id];n[$.id]=Math.max(b+1,E),s[$.id]=$}}const p={};for(const w in n){const b=n[w];b in p||(p[b]=[]),p[b].push(s[w])}const h={};for(const w in a){const b=a[w];b in h||(h[b]=[]),h[b].push(r[w])}let f=Object.keys(h).map(w=>parseInt(w,10)).sort(xh);this.layers=[];for(const w of f){const b=h[w];b.sort((x,v)=>{const S=i[x.id],N=i[v.id];return S<N?-1:S>N?1:0});for(const x of b)x instanceof Ms&&this.internalContainerRefs.push(x),this.layers.push(x)}this.layersByDepth=h,f=Object.keys(p).map(w=>parseInt(w,10)).sort(xh);const g=this.inputs.slice(),y=[];for(const w of f)for(const b of p[w]){const x=b.outboundLayer;if(x!=null){for(const v of b.inputTensors)if(g.indexOf(v)===-1)throw new Ts(`Graph disconnected: cannot obtain value for tensor ${v} at layer "${x.name}". The following previous layers were accessed without issue: ${y}`);for(const v of b.outputTensors)g.push(v);y.push(x.name)}}this.nodesByDepth=p;const m=this.layers.map(w=>w.name);for(const w of m){const b=m.filter(x=>x===w).length;if(b!==1)throw new Ts(`The name "${w}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(m))}this.outboundNodes=[],this.inboundNodes=[],new y0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(w=>null),outputMasks:this.outputs.map(w=>null),inputShapes:this.inputs.map(w=>w.shape),outputShapes:this.outputs.map(w=>w.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new P("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let a=0;const r=K6(e);r&&this.parseWeights(e);for(const o of this.layers)for(const[l,u]of o.weights.entries()){const c=r?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(s[c]!=null)throw new P(`Duplicate weight name: ${c}`);s[c]=u,a++}const i=[];for(const o in e){let l=o;if(s[o]==null){const u=o.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],e[o]]);else if(n)throw new P(`Provided weight data has no target variable: ${o}`);delete s[l]}if(n){const o=[];for(const l in s)o.push(l);if(o.length>0)throw new P(`${o.length} of ${a} weights are not set: ${o}`)}P1(i)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),a=["vars","layer_checkpoint_dependencies"],r=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!a.includes(i)).join("/");r!==n&&(e[r]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${pA}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=Qw(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return B(()=>{e=Me(e);const s=new Cr;for(let a=0;a<this.inputs.length;++a)s.add(this.inputs[a],e[a]);return oc(this.outputs,s,n)})}computeMask(e,n){return B(()=>{e=Me(e);let s;return n==null?s=ao(null,e.length):s=Me(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=_f(e);if(n.length!==this.inputLayers.length)throw new P(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let o=0;o<n.length;o++){const l=this.inputLayers[o],u=n[o],c=l.name+"_0_0";s[c]=u}const a=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(xh);if(a.length>1)for(const o of a){const l=this.nodesByDepth[o];for(const u of l){const c=u.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(c.id)!==-1)continue;const d=[];for(let g=0;g<u.inboundLayers.length;g++){const y=u.inboundLayers[g],m=u.nodeIndices[g],w=u.tensorIndices[g],b=`${y.name}_${m}_${w}`,x=s[b];d.push(x)}const p=c.computeOutputShape($n(d)),h=_f(p),f=c.inboundNodes.indexOf(u);for(let g=0;g<h.length;g++){const y=`${c.name}_${f}_${g}`;s[y]=h[g]}}}const r=[],i=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],u=this.outputLayersNodeIndices[o],c=this.outputLayersTensorIndices[o],d=`${l.name}_${u}_${c}`;i.push(d)}for(let o=0;o<i.length;o++){const l=i[o];ha(l in s),r.push(s[l])}return $n(r)}runInternalGraph(e,n){n==null&&(n=ao(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],c=e[l],d=n[l];s[u.id]=[c,d]}const a=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(xh);for(const l of a){const u=this.nodesByDepth[l];for(const c of u){const d=c.outboundLayer,p=c.inputTensors,h=c.outputTensors,f=new Array;for(const g of p)g.id in s&&f.push(s[g.id]);if(f.length===p.length){let g={},y,m,w,b;if(c.callArgs!=null&&(g=c.callArgs),f.length===1){const[x,v]=f[0];g.mask==null&&(g.mask=v),w=Me(d.call(x,g)),b=Me(d.computeMask(x,v)),y=[x],m=[v]}else y=f.map(x=>x[0]),m=f.map(x=>x[1]),g.mask==null&&(g.mask=m),w=Me(d.call(y,g)),b=Me(d.computeMask(y,m));if(d.activityRegularizer)throw new Ce("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let x=0;x<h.length;++x){const v=h[x],S=w[x],N=b[x];s[v.id]=[S,N]}}}}const r=[],i=[],o=[];for(const l of this.outputs){ha(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[u,c]=s[l.id];o.push(u.shape),r.push(u),i.push(c)}return[r,i,o]}buildNodeConversionMap(e){const n={};let s;for(const a of this.layers){s=a instanceof Ms?1:0;for(let r=0;r<a.inboundNodes.length;r++){const i=Ms.nodeKey(a,r);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new P("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new P(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new P(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return B(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const a=Ms.nodeKey(n,s);this.containerNodes.has(a)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const o=i.getClassName(),l=i.getConfig(),u=[];for(let d=0;d<i.inboundNodes.length;d++){const p=i.inboundNodes[d],h=Ms.nodeKey(i,d);let f={};if(this.containerNodes.has(h)){if(p.callArgs)try{JSON.stringify(p.callArgs),f=p.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),f={}}if(p.inboundLayers.length>0){const g=[];for(let y=0;y<p.inboundLayers.length;y++){const m=p.inboundLayers[y],w=p.nodeIndices[y],b=p.tensorIndices[y],x=Ms.nodeKey(m,w);let v=n[x];v==null&&(v=0),g.push([m.name,v,b,f])}u.push(g)}}}const c={};c.name=i.name,c.className=o,c.config=l,c.inboundNodes=u,s.push(c)}e.layers=s;const a=[];for(let i=0;i<this.inputLayers.length;i++){const o=this.inputLayers[i],l=this.inputLayersNodeIndices[i],u=Ms.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.inputLayersTensorIndices[i];a.push([o.name,c,d])}e.inputLayers=a;const r=[];for(let i=0;i<this.outputLayers.length;i++){const o=this.outputLayers[i],l=this.outputLayersNodeIndices[i],u=Ms.nodeKey(o,l);if(!this.containerNodes.has(u))continue;let c=n[u];c==null&&(c=0);const d=this.outputLayersTensorIndices[i];r.push([o.name,c,d])}return e.outputLayers=r,e}static fromConfig(e,n,s={},a=!1){const r={},i={};function o(y,m){y.name in i?i[y.name].push(m):i[y.name]=[m]}function l(y,m){const w=[];let b;for(const x of m){const v=x[0],S=x[1],N=x[2];if(b=x[3]==null?{}:x[3],!(v in r)){o(y,m);return}const $=r[v];if($.inboundNodes.length<=S){o(y,m);return}const E=$.inboundNodes[S];w.push(E.outputTensors[N])}w.length>0&&y.apply($n(w),b)}function u(y){const m=y.name,w=Ga(y,n.customObjects!=null?n.customObjects:{});w.setFastWeightInitDuringBuild(a),r[m]=w,y.inboundNodes.forEach(x=>{if(!(x instanceof Array))throw new P(`Corrupted configuration, expected array for nodeData: ${x}`);o(w,x)})}const c=n.name,d=n.layers;for(const y of d)u(y);for(;!RG(i);)for(const y of d){const m=r[y.name];if(m.name in i){const w=i[m.name];delete i[m.name];for(const b of w)l(m,b)}}const p=[],h=[],f=n.inputLayers;for(const y of f){const m=y[0],w=y[1],b=y[2];ha(m in r);const v=r[m].inboundNodes[w].outputTensors;p.push(v[b])}const g=n.outputLayers;for(const y of g){const m=y[0],w=y[1],b=y[2];ha(m in r);const v=r[m].inboundNodes[w].outputTensors;h.push(v[b])}return new e({inputs:p,outputs:h,name:c})}get stateful(){if(this._stateful)throw new P("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){B(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function q6(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(a=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const a=[];return e.forEach(r=>{r in t?a.push(t[r]):a.push(null)}),a}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function hA(t,e){return q6(t,e,"classWeight")}async function fA(t,e,n,s){if(n!=null){const a=B(()=>{if(t.shape.length===1)return ka(t);if(t.shape.length===2){if(t.shape[1]>1)return Qi(t,1);if(t.shape[1]===1)return F(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(await a.data());Te(a);const i=[];return r.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);i.push(n[o])}),ln(i,"float32")}else return null}function J6(t,e){return _(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const X6=32;function mA(t,e){let n,s;const a=e;n=a.xs,s=a.ys,C(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const r=vS("input",t.inputNames,n),i=vS("output",t.outputNames,s),o=r[0].shape[0];C(r.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${r.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),C(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<r.length;l++)C(r[l].shape[0]===o,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${r[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)C(i[l].shape[0]===o,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);return{xs:r,ys:i}}function vS(t,e,n){if(n instanceof ze)return[n];if(Array.isArray(n))return C(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const a of e){if(n[a]==null)throw new P(`The feature data generated by the dataset lacks the required ${t} key '${a}'.`);s.push(n[a])}return s}}function Y6(t){if(t.length===3)throw new Ce("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function Q6(t,e,n){const s=n.batchesPerEpoch!=null;if(C(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),C(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),C(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),C(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),C(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const a=n.validationData!=null;let r,i;if(a)if(SS(n.validationData))C(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const y=Y6(n.validationData);r=y.xs,i=y.ys}const o=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let u;a?u=l.slice().concat(l.map(y=>"val_"+y)):u=l.slice();const c=aA(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:p,history:h}=rA(c,d,n.epochs,null,null,Z6(e,n),null,a,u);p.setModel(t),t.history=h,await p.onTrainBegin(),t.stopTraining_=!1;let f=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;f<n.epochs;){const y={};await p.onEpochBegin(f);let m=0,w=0;for(s||(g=await e.iterator());!s||m<n.batchesPerEpoch;){const b=await g.next();if(s&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${m} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:x,ys:v}=mA(t,b.value),S={};S.batch=w,S.size=x[0].shape[0],await p.onBatchBegin(w,S);const N=[];if(n.classWeight!=null){const A=hA(n.classWeight,t.outputNames);for(let L=0;L<A.length;++L)N.push(await fA(v[L],null,A[L]))}const $=x.concat(v).concat(N),E=o($);Te($);for(let A=0;A<l.length;++A){const L=l[A],W=E[A];S[L]=W,Rt(W)}await p.onBatchEnd(w,S),sA(S),w++,m++}if(s?m>=n.batchesPerEpoch:b.done){if(a){let x;SS(n.validationData)?x=Me(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):x=Me(t.evaluate(r,i,{batchSize:n.validationBatchSize==null?X6:n.validationBatchSize,verbose:0}));for(let v=0;v<t.metricsNames.length;++v)y[`val_${t.metricsNames[v]}`]=x[v]}break}if(t.stopTraining_)break}if(await p.onEpochEnd(f,y),f++,t.stopTraining_)break}return await p.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Z6(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function SS(t){return typeof t.iterator=="function"}function eH(t){return typeof t.next=="function"}async function tH(t,e,n){n=n||{};const s=n.batches!=null,a=t.testFunction;let r=[];if(n.verbose>0)throw new Ce("Verbose mode is not implemented yet.");C(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=eH(e)?e:await e.iterator();let o=0,l=0;for(;!s||l<n.batches;){const u=await i.next();if(r=B(()=>{if(u.value){const{xs:c,ys:d}=mA(t,u.value),p=c.concat(d),h=B(()=>a(p));if(Te(p),l===0)for(let g=0;g<h.length;++g)r.push(we(0));const f=p[0].shape[0];for(let g=0;g<h.length;++g){const y=h[g],m=r[g];r[g]=B(()=>Z(r[g],_(f,y))),l>0&&Te(m)}Te(h),o+=f,++l}return r}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<r.length;++u){const c=r[u];r[u]=ge(r[u],o),Te(c)}return $n(r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gy(t){C(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Qu(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>Mi(s,e,n-e)):Mi(t,e,n-e)}function Zw(t,e){return B(()=>t==null?null:Array.isArray(t)?t.map(n=>Zw(n,e)):WE(t,e.dtype==="int32"?e:re(e,"int32")))}function yy(t,e){const n=[];let s=0,a=null;for(;s<t;)a=s+e,a>=t&&(a=t),n.push([s,a]),s=a;return n}function gA(t){const e=[];t instanceof ze&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(Mp(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Bs(t,e){if(t==null)return;const n=[];if(e instanceof ze)n.push(e.id);else if(Array.isArray(e))e.forEach(a=>n.push(a.id));else if(e!=null)for(const a in e){const r=e[a];n.push(r.id)}const s=[];if(t instanceof ze)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(a=>{n.indexOf(a.id)===-1&&s.push(a)});else if(t!=null)for(const a in t){const r=t[a];n.indexOf(r.id)===-1&&s.push(r)}s.forEach(a=>{a.isDisposed||a.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nH(t){return t instanceof ze}function eb(t){return Array.isArray(t)}function NS(t){return!nH(t)&&!eb(t)}function CS(t,e,n,s=!0,a=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(eb(t)&&t.length>0)i=!0;else if(NS(t)){for(const o in t)if(t.hasOwnProperty(o)){i=!0;break}}else i=!0;if(i)throw new P(`Error when checking model ${a} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let r;if(NS(t)){t=t,r=[];for(const i of e){if(t[i]==null)throw new P(`No data provided for "${i}". Need data for each key in: ${e}`);r.push(t[i])}}else if(eb(t)){if(t=t,t.length!==e.length)throw new P(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);r=t}else{if(t=t,e.length>1)throw new P(`The model ${a} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);r=[t]}if(r=gA(r),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const o=r[i];if(o.shape.length!==n[i].length)throw new P(`Error when checking ${a}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const u=o.shape[l],c=n[i][l];if(c!=null&&c>=0&&u!==c)throw new P(`${a} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${a} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return r}function sH(t,e,n){const s=Pr(t.map(r=>r.shape[0]));s.sort();const a=Pr(e.map(r=>r.shape[0]));if(a.sort(),s.length>1)throw new P(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(r=>r.shape))}`);if(a.length>1)throw new P(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(r=>r.shape))}`);if(s.length>0&&a.length>0&&!Re(s,a))throw new P(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${a[0]} target sample(s).`)}function aH(t,e,n){const s=[w0,b0,td];for(let a=0;a<t.length;++a){const r=t[a],i=e[a],o=n[a];if(i!=null){if(i===td&&r.shape[r.shape.length-1]===1)throw new P(`You are passing a target array of shape ${r.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=r.shape.slice(1),u=o.slice(1);for(let c=0;c<l.length;++c){const d=l[c],p=u[c];if(p!=null&&d!==p)throw new P(`A target Tensor with shape ${r.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function IS(t,e,n,s=!0,a=""){let r;if(Array.isArray(t)){if(t.length!==e.length)throw new P(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);r=t}else{if(e.length>1)throw new P(`The model expects ${e.length} ${a} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);r=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const o=r[i];if(o.shape.length!==n[i].length)throw new P(`Error when checking ${a}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const u=o.shape[l],c=n[i][l];if(c!=null&&c!==u)throw new P(`Error when checking ${a}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function rH(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const a of e){let r=n.hasOwnProperty(a)?n[a]:[];Array.isArray(r)||(r=[r]),s.push(r)}return s}}const iH="layers-model";class al extends Ms{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new P("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");V6(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=M6(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ur))throw new P("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new P(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(my(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new P(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(o=>my(o))}else{const i=my(e.loss);this.outputs.forEach(o=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const o=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Bi("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([o,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const a=rH(e.metrics,this.outputNames),r=(i,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[i]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,i])};Bi("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const o=a[i];(u=>{const c="";let d,p,h;for(const f of u){if(typeof f=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(f)!==-1){const y=this.internalOutputShapes[i];y[y.length-1]===1||this.lossFunctions[i]===b0?["accuracy","acc"].indexOf(f)!==-1?p=oA:["crossentropy","ce"].indexOf(f)!==-1&&(p=R6):this.lossFunctions[i]===Lf?["accuracy","acc"].indexOf(f)!==-1?p=D6:["crossentropy","ce"].indexOf(f)!==-1&&(p=cA):["accuracy","acc"].indexOf(f)!==-1?p=lA:["crossentropy","ce"].indexOf(f)!==-1&&(p=uA);let m;["accuracy","acc"].indexOf(f)!==-1?m="acc":["crossentropy","ce"].indexOf(f)!==-1&&(m="ce"),h=p,d=c+m}else h=B6(f),d=c+Sh(f);let g;Bi(d,()=>{g=h}),r(i,d,g)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const a=s.batchSize==null?32:s.batchSize;gy(a);const i=this.standardizeUserDataXY(e,n,!0,a);try{const o=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,o,a,s.verbose,s.steps);return $n(u)}finally{Bs(i[0],e),Bs(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),tH(this,e,n)}checkNumSamples(e,n,s,a="steps"){let r;if(s!=null){if(r=null,n!=null)throw new P(`If ${a} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?r=e[0].shape[0]:r=e.shape[0];else throw new P(`Either the input data should have a defined shape, or ${a} shoud be specified.`);return r}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new P("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),a=s?n:[n],r=this.retrieveSymbolicTensors(a),i=new Cr;if(e instanceof ze&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new P(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new P(`No value is provided for the model's input ${l.name}`);i.add(l,u)}const o=oc(r,i);return s?o:o[0]}retrieveSymbolicTensors(e){const n=ao(null,e.length);let s=e.length;for(const a of this.layers){const r=Array.isArray(a.output)?a.output:[a.output],i=r.map(o=>o.name);for(let o=0;o<e.length;++o){const l=i.indexOf(e[o]);if(l!==-1&&(n[o]=r[l],s--),s===0)break}if(s===0)break}if(s>0){const a=[];throw n.forEach((r,i)=>{r==null&&a.push(e[i])}),new P(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(a)}`)}return n}predictLoop(e,n=32,s=!1){return B(()=>{const a=this.checkNumSamples(e);if(s)throw new Ce("Verbose predictLoop() is not implemented yet.");const r=yy(a,n),i=this.outputs.map(o=>[]);for(let o=0;o<r.length;++o)B(()=>{const u=r[o][0],c=r[o][1],d=Qu(e,u,c),p=[];if(Array.isArray(d))for(let f=0;f<d.length;++f)p.push({key:this.inputs[f],value:d[f]});else p.push({key:this.inputs[0],value:d});const h=new Cr(p);return oc(this.outputs,h)}).forEach((u,c)=>i[c].push(u));return $n(i.map(o=>xt(o,0)))})}predict(e,n={}){const s=gA(e);IS(s,this.inputNames,this.feedInputShapes,!1);try{const a=n.batchSize==null?32:n.batchSize;return gy(a),this.predictLoop(s,a)}finally{Bs(s,e)}}predictOnBatch(e){IS(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,a){if(this.optimizer_==null)throw new Ts("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const r=[];for(let i=0;i<this.feedOutputShapes.length;++i){const o=this.feedOutputShapes[i];this.feedLossFns[i]===Lf?r.push(o.slice(0,o.length-1).concat([1])):r.push(o)}if(e=CS(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=CS(n,this.feedOutputNames,r,!1,"target"),sH(e,n),aH(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&a!=null&&a>0&&e[0].shape[0]%a!==0)throw new P(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${a}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,a,r=!0,i){const[o,l]=this.standardizeUserDataXY(e,n,r,i);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(a!=null){const c=hA(a,this.outputNames);u=[];for(let d=0;d<c.length;++d)u.push(await fA(l[d],null,c[d]))}return[o,l,u]}testLoop(e,n,s,a=0,r){return B(()=>{const i=this.checkNumSamples(n,s,r,"steps"),o=[];if(a>0)throw new Ce("Verbose mode is not implemented yet.");if(r!=null)throw new Ce("steps mode in testLoop() is not implemented yet");{const l=yy(i,s),u=ln(sa(0,i));for(let c=0;c<l.length;++c){const d=l[c][0],p=l[c][1],h=Mi(u,d,p-d),f=Zw(n,h),g=e(f);if(c===0)for(let y=0;y<g.length;++y)o.push(we(0));for(let y=0;y<g.length;++y){const m=g[y];o[y]=Z(o[y],_(p-d,m))}}for(let c=0;c<o.length;++c)o[c]=ge(o[c],i)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const a=e[s];let r=a;if(cS(e,a)>1){const i=cS(e.slice(0,s),a);r+=`_${i}`}n.push(r)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),r=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],o=()=>{const d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:s[g]});const p=new Cr(d),h=oc(this.outputs,p,{training:!0});let f;for(let g=0;g<this.lossFunctions.length;++g){const y=this.lossFunctions[g];let m=y(a[g],h[g]);r[g]!=null&&(m=J6(m,r[g]));const w=ct(m);n.push(w),g===0?f=m:f=Z(f,m)}for(let g=0;g<this.metricsTensors.length;++g){let y;if(this.outputs.length>1&&g<this.outputs.length)y=n[g];else{const m=this.metricsTensors[g][0],w=this.metricsTensors[g][1];y=ct(m(a[w],h[w]))}Rt(y),i.push(y)}return f=ct(f),this.calculateLosses().forEach(g=>{f=Z(f,g)}),f},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(o,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>B(()=>{const n=[];let s;const a=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let u=0;u<this.inputs.length;++u)i.push({key:this.inputs[u],value:a[u]});const o=new Cr(i),l=oc(this.outputs,o);for(let u=0;u<this.lossFunctions.length;++u){const c=this.lossFunctions[u],d=ct(c(r[u],l[u]));u===0?s=d:s=Z(s,d),n.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const c=this.metricsTensors[u][0],d=this.metricsTensors[u][1],p=ct(c(r[d],l[d]));n.push(p)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let a,r,i,o,l,u,c,d,p;try{const h=s.batchSize==null?32:s.batchSize;gy(h);const g=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,h);a=g[0],r=g[1],p=g[2];let y=!1,m;if(s.validationData!=null&&s.validationData.length>0){if(y=!0,s.validationData.length===2)l=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new Ce("validationData including sample weights is not supported yet."):new P(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const A=await this.standardizeUserData(l,u,null,null,!0,h);c=A[0],d=A[1],m=c.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){y=!0;const E=Math.floor(a[0].shape[0]*(1-s.validationSplit)),A=a[0].shape[0];c=Qu(a,E,A),i=a,a=Qu(a,0,E),d=Qu(r,E,A),o=r,r=Qu(r,0,E),m=c.concat(d)}else s.validationSteps!=null&&(y=!0);const w=a.concat(r).concat(p);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),x=this.getDedupedMetricsNames();let v,S;y?(this.makeTestFunction(),v=this.testFunction,S=x.slice().concat(x.map(E=>"val_"+E))):(v=null,m=[],S=x.slice());const N=aA(s.callbacks,s.yieldEvery);return await this.fitLoop(b,w,x,h,s.epochs,s.verbose,N,v,m,s.shuffle,S,s.initialEpoch,null,null)}finally{this.isTraining=!1,Bs(a,e),Bs(r,n),Bs(i,e),Bs(o,n),Bs(c,l),Bs(d,u),p!=null&&Te(p)}}async fitLoop(e,n,s,a,r,i,o,l,u,c,d,p,h,f){a==null&&(a=32),r==null&&(r=1),c==null&&(c=!0),p==null&&(p=0);let g=!1;if(l!=null&&u!=null&&(g=!0),f!=null&&(g=!0,h==null))throw new P("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const y=this.checkNumSamples(n,a,h,"steps_per_epoch");let m;y!=null&&(m=sa(0,y)),i==null&&(i=1);const{callbackList:w,history:b}=rA(o,i,r,p,y,h,a,g,d);w.setModel(this),this.history=b,await w.onTrainBegin(),this.stopTraining_=!1;for(let x=p;x<r;++x){await w.onEpochBegin(x);const v={};if(h!=null)throw new Ce("stepsPerEpoch mode is not implemented yet.");{if(c==="batch")throw new Ce("batch shuffling is not implemneted yet");c&&wx(m);const S=ln(m),N=yy(y,a);for(let $=0;$<N.length;++$){const E={};if(await w.onBatchBegin($,E),B(()=>{const A=N[$][0],L=N[$][1],W=Mi(S,A,L-A);E.batch=$,E.size=L-A;const U=Zw(n,W),j=e(U);for(let z=0;z<s.length;++z){const G=s[z],J=j[z];E[G]=J,Rt(J)}if($===N.length-1&&g){const z=this.testLoop(l,u,a);for(let G=0;G<s.length;++G){const J=s[G],O=z[G];Rt(O),v["val_"+J]=O}}}),await w.onBatchEnd($,E),sA(E),this.stopTraining_)break}S.dispose()}if(await w.onEpochEnd(x,v),this.stopTraining_)break}return await w.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return Q6(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),a=s[0],r=s[1],o=this.makeTrainFunction()(a.concat(r)),l=[];for(const u of o){const c=await u.data();l.push(c[0])}return Te(o),Bs(s[0],e),Bs(s[1],n),$n(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,a=s?this.trainableWeights:this.weights,r=this.getWeights(s);for(let i=0;i<a.length;++i)s&&!a[i].trainable||n.push({name:a[i].originalName,tensor:r[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=_w().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-_w().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Pa(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Pa(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const a of n)if(typeof s[a]=="string")e[a]=Pa(s[a]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Pa(Sh(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Pa(Sh(e)));{const e={};for(const n in this.metrics)e[n]=Pa(Sh(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=Yw(e.optimizer_config),s=Ga(n);let a;if(typeof e.loss=="string")a=Ii(e.loss);else if(Array.isArray(e.loss))a=e.loss.map(i=>Ii(i));else if(e.loss!=null){a={};for(const i in e.loss)a[i]=Ii(e.loss[i])}let r;if(Array.isArray(e.metrics))r=e.metrics.map(i=>Ii(i));else if(e.metrics!=null){r={};for(const i in e.metrics)r[i]=Ii(e.metrics[i])}this.compile({loss:a,metrics:r,optimizer:s})}async save(e,n){if(typeof e=="string"){const u=D$(e);if(u.length===0)throw new P(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new P(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new P("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await Ow(this.getNamedWeights(n)),o={modelTopology:this.toJSON(null,!1),format:iH,generatedBy:`TensorFlow.js tfjs-layers v${pA}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:c,specs:d}=await Ow(await this.optimizer.getWeights(),u);s.specs.push(...d),s.data=A$([s.data,c])}return this.userDefinedMetadata!=null&&(kS(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=s.data,o.weightSpecs=s.specs,e.save(o)}setUserDefinedMetadata(e){kS(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}al.className="Model";ee(al);class yA extends al{}yA.className="Functional";ee(yA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nd extends al{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:m0("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new P(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof nd||e instanceof al;let s;if(n){if(s=e,s.outputs.length!==1)throw new P("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new P("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new P("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const a=l6({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new P(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new P("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=QE(this.outputs[0])}this.inboundNodes=[],new y0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ao(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(a=>a.shape),outputShapes:this.outputs[0].shape})}else{const a=e.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Pe(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new al({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Ts("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Ts("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Ts("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Ts("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},a=!1){let r,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new P("Legacy serialization format not supported yet.");r=n}else C(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),r=n.layers,delete n.layers,i=n;const o=new e(i);if(!(o instanceof nd))throw new Ce(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of r){const c=Ga(l,void 0,a);a&&c.setFastWeightInitDuringBuild(!0),o.add(c)}return o}set stopTraining(e){if(this.model==null)throw new P("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new P("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}nd.className="Sequential";ee(nd);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let dn=class extends So{getConfig(){return{}}};class wA extends dn{apply(e,n=1){return HG(e,n)}}wA.className="elu";ee(wA);class bA extends dn{apply(e){return Ug(e)}}bA.className="selu";ee(bA);class xA extends dn{apply(e){return la(e)}}xA.className="relu";ee(xA);class kA extends dn{apply(e){return B(()=>Kr(6,la(e)))}}kA.className="relu6";ee(kA);class vA extends dn{apply(e){return e}}vA.className="linear";ee(vA);class SA extends dn{apply(e){return Zs(e)}}SA.className="sigmoid";ee(SA);class NA extends dn{apply(e){return qG(e)}}NA.className="hardSigmoid";ee(NA);class CA extends dn{apply(e){return xo(e)}}CA.className="softplus";ee(CA);class IA extends dn{apply(e){return KG(e)}}IA.className="softsign";ee(IA);class $A extends dn{apply(e){return Hr(e)}}$A.className="tanh";ee($A);let M1=class extends dn{apply(e,n=-1){return Op(e,n)}};M1.className="softmax";ee(M1);class TA extends dn{apply(e,n=-1){return jg(e,n)}}TA.className="logSoftmax";ee(TA);class EA extends dn{apply(e){return B(()=>B(()=>{const n=Math.sqrt(2),s=_(.5,Z(1,_g(ge(e,n))));return _(e,s)}))}}EA.className="gelu";ee(EA);class AA extends dn{apply(e){return B(()=>_(.5,_(e,Z(1,Hr(_(Ut(ge(2,Math.PI)),Z(e,_(.044715,$a(e,3)))))))))}}AA.className="gelu_new";ee(AA);class RA extends dn{apply(e){return B(()=>_(e,Hr(xo(e))))}}RA.className="mish";ee(RA);class DA extends dn{apply(e,n=1){return B(()=>_(Zs(_(e,n)),e))}}DA.className="swish";ee(DA);function Jr(t){return t.getClassName()}function wy(t,e={}){return Bp(t,rs.getMap().classNameMap,e,"activation")}function Xr(t){if(t==null){const e={};return e.className="linear",e.config={},wy(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},wy(e)}else return t instanceof dn?t:wy(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oH(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class _A extends So{}class OA extends _A{constructor(e){super(),oH(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return B(()=>{let n=$t([1]);return this.hasL1&&(n=Z(n,pe(_(this.l1,Ct(e))))),this.hasL2&&(n=Z(n,pe(_(this.l2,Vp(e))))),F(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}OA.className="L1L2";ee(OA);const $S={l1l2:"L1L2"};function Ke(t){return $1(t)}function TS(t,e={}){return Bp(t,rs.getMap().classNameMap,e,"regularizer")}function it(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in $S?$S[t]:t,config:{}};return TS(n)}else return t instanceof _A?t:TS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FA extends Ae{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=ke(e);let s=la(e);return this.maxValue!=null&&(s=_n(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}FA.className="ReLU";ee(FA);class jA extends Ae{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=ke(e);return Np(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}jA.className="LeakyReLU";ee(jA);class PA extends Ae{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=rt(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=it(e.alphaRegularizer),this.alphaConstraint=jt(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new P(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Pe(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const a of this.sharedAxes)n[a-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let a=1;a<e.length;++a)s[a]=e[a];this.inputSpec=[new _t({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=ke(e),Rp(e,this.alpha.read())}getConfig(){const e={alphaInitializer:dt(this.alphaInitializer),alphaRegularizer:Ke(this.alphaRegularizer),alphaConstraint:Ft(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}PA.className="PReLU";ee(PA);let LA=class extends Ae{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Ce(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=ke(e);return Tu(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};LA.className="ELU";ee(LA);class zA extends Ae{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=ke(e);return _(s,re(zn(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}zA.className="ThresholdedReLU";ee(zA);class BA extends Ae{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new M1().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return B(()=>{let s=ke(e);const a=n.mask;if(a!=null){const r=_(ce(Tn(s.shape),re(a,s.dtype)),we(-1e9));s=Z(s,r)}return this.axis instanceof Array?this.axis.length>1?On(ce(s,Ip(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}BA.className="Softmax";ee(BA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rl(t,e,n){if(typeof t=="number")return ao(t,e);if(t.length!==e)throw new P(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const a=t[s];if(!VG(a))throw new P(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${a}`)}return t}function ea(t,e,n,s,a=1){if(t==null)return t;const r=e+(e-1)*(a-1);let i;return n==="same"?i=t:i=t-r+1,Math.floor((i+s-1)/s)}function fa(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+qr([n-e,0]);else if(s==="same")t=t*e;else throw new P(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function V1(t,e){return B(()=>(St(e),e==="channelsFirst"?De(t,[0,2,3,1]):t))}function MA(t,e){return B(()=>(St(e),e==="channelsFirst"?De(t,[0,2,3,4,1]):t))}function lH(t,e,n,s=1,a="valid",r,i=1){return B(()=>{if(r==null&&(r=aa()),St(r),t.shape.length!==3)throw new P(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new P(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new P(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(r==="channelsFirst"&&(t=De(t,[0,2,1])),a==="causal")throw new Ce("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=Eg(t,e,s,a==="same"?"same":"valid","NWC",i);return n!=null&&(o=ua(o,n)),o})}function ES(t,e,n,s=[1,1],a="valid",r,i,o=null){return B(()=>{if(r==null&&(r=aa()),St(r),t.rank!==3&&t.rank!==4)throw new P(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new P(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=V1(t,r);if(a==="causal")throw new Ce("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=_T({x:l,filter:e,strides:s,pad:a==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:o}),r==="channelsFirst"&&(l=De(l,[0,3,1,2])),l})}function uH(t,e,n,s=[1,1,1],a="valid",r,i){return B(()=>{if(r==null&&(r=aa()),St(r),t.rank!==4&&t.rank!==5)throw new P(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new P(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let o=MA(t,r);if(a==="causal")throw new Ce("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=nk(o,e,s,a==="same"?"same":"valid","NDHWC",i),n!=null&&(o=ua(o,n)),r==="channelsFirst"&&(o=De(o,[0,4,1,2,3])),o})}class x0 extends Ae{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",x0.verifyArgs(n),this.rank=e,Vt(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Ce(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=rl(n.kernelSize,e,"kernelSize"),this.strides=rl(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,ys(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,St(this.dataFormat),this.activation=Xr(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=rt(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=jt(n.biasConstraint),this.biasRegularizer=it(n.biasRegularizer),this.activityRegularizer=it(n.activityRegularizer),this.dilationRate=rl(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new P(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new P(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new P(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(ha("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!T1(e.kernelSize,"number",1,3))throw new P(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Jr(this.activation),useBias:this.useBias,biasInitializer:dt(this.biasInitializer),biasRegularizer:Ke(this.biasRegularizer),activityRegularizer:Ke(this.activityRegularizer),biasConstraint:Ft(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class _u extends x0{constructor(e,n){super(e,n),this.kernel=null,_u.verifyArgs(n),this.filters=n.filters,Vt(this.filters,"filters"),this.kernelInitializer=rt(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=jt(n.kernelConstraint),this.kernelRegularizer=it(n.kernelRegularizer)}build(e){e=Pe(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new P(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],a=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return B(()=>{e=ke(e);let s;const a=this.bias==null?null:this.bias.read(),r=PE(this.activation.getClassName());if(r!=null&&this.rank===2)s=ES(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(this.rank===1)s=lH(e,this.kernel.read(),a,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=ES(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=uH(e,this.kernel.read(),a,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Ce("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Pe(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let r=0;r<s.length;++r){const i=ea(s[r],this.kernelSize[r],this.padding,this.strides[r],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[r]);n.push(i)}let a=[e[0]];return this.dataFormat==="channelsLast"?(a=a.concat(n),a.push(this.filters)):(a.push(this.filters),a=a.concat(n)),a}getConfig(){const e={filters:this.filters,kernelInitializer:dt(this.kernelInitializer),kernelRegularizer:Ke(this.kernelRegularizer),kernelConstraint:Ft(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new P(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Hp extends _u{constructor(e){super(2,e),Hp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!T1(e.kernelSize,"number",1,2))throw new P(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Hp.className="Conv2D";ee(Hp);class Kp extends _u{constructor(e){super(3,e),Kp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new P(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Kp.className="Conv3D";ee(Kp);class VA extends Hp{constructor(e){if(super(e),this.inputSpec=[new _t({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new P(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Pe(e),e.length!==4)throw new P("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new P("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],a=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new _t({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return B(()=>{let s=ke(e);if(s.shape.length!==4)throw new P(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const a=s.shape,r=a[0];let i,o;this.dataFormat==="channelsFirst"?(i=2,o=3):(i=1,o=2);const l=a[i],u=a[o],c=this.kernelSize[0],d=this.kernelSize[1],p=this.strides[0],h=this.strides[1],f=fa(l,p,c,this.padding),g=fa(u,h,d,this.padding),y=[r,f,g,this.filters];this.dataFormat!=="channelsLast"&&(s=De(s,[0,2,3,1]));let m=Ag(s,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(m=De(m,[0,3,1,2])),this.bias!=null&&(m=ua(m,this.bias.read(),this.dataFormat)),this.activation!=null&&(m=this.activation.apply(m)),m})}computeOutputShape(e){e=Pe(e);const n=e.slice();let s,a,r;this.dataFormat==="channelsFirst"?(s=1,a=2,r=3):(s=3,a=1,r=2);const i=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return n[s]=this.filters,n[a]=fa(n[a],l,i,this.padding),n[r]=fa(n[r],u,o,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}VA.className="Conv2DTranspose";ee(VA);class WA extends Kp{constructor(e){if(super(e),this.inputSpec=[new _t({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new P(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Pe(e),e.length!==5)throw new P("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new P("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],a=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",a,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new _t({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return B(()=>{let s=ke(e);if(s.shape.length!==5)throw new P(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const a=s.shape,r=a[0];let i,o,l;this.dataFormat==="channelsFirst"?(l=2,i=3,o=4):(l=1,i=2,o=3);const u=a[l],c=a[i],d=a[o],p=this.kernelSize[0],h=this.kernelSize[1],f=this.kernelSize[2],g=this.strides[0],y=this.strides[1],m=this.strides[2],w=fa(u,g,p,this.padding),b=fa(c,y,h,this.padding),x=fa(d,m,f,this.padding),v=[r,w,b,x,this.filters];this.dataFormat!=="channelsLast"&&(s=De(s,[0,2,3,4,1]));let S=sk(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=De(S,[0,4,1,2,3])),this.bias!==null&&(S=ua(S,this.bias.read(),this.dataFormat)),this.activation!==null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=Pe(e);const n=e.slice();let s,a,r,i;this.dataFormat==="channelsFirst"?(s=1,a=2,r=3,i=4):(s=4,a=1,r=2,i=3);const o=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],d=this.strides[1],p=this.strides[2];return n[s]=this.filters,n[a]=fa(n[a],c,o,this.padding),n[r]=fa(n[r],d,l,this.padding),n[i]=fa(n[i],p,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}WA.className="Conv3DTranspose";ee(WA);class UA extends _u{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new P("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new P("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new P(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=rt(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=it(n.depthwiseRegularizer),this.depthwiseConstraint=jt(n.depthwiseConstraint),this.pointwiseInitializer=rt(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=it(n.pointwiseRegularizer),this.pointwiseConstraint=jt(n.pointwiseConstraint)}build(e){if(e=Pe(e),e.length<this.rank+2)throw new P(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new P(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],a=this.kernelSize.concat([s,this.depthMultiplier]),r=[];for(let o=0;o<this.rank;++o)r.push(1);r.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",a,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",r,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new _t({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return B(()=>{e=ke(e);let s;if(this.rank===1)throw new Ce("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=De(e,[0,2,3,1])),s=Gg(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=ua(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=De(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=dt(this.depthwiseInitializer),e.pointwiseInitializer=dt(this.pointwiseInitializer),e.depthwiseRegularizer=Ke(this.depthwiseRegularizer),e.pointwiseRegularizer=Ke(this.pointwiseRegularizer),e.depthwiseConstraint=Ft(this.depthwiseConstraint),e.pointwiseConstraint=Ft(this.pointwiseConstraint),e}}UA.className="SeparableConv";class GA extends UA{constructor(e){super(2,e)}}GA.className="SeparableConv2D";ee(GA);class k0 extends _u{constructor(e){super(1,e),k0.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!T1(e.kernelSize,"number",1,1))throw new P(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}k0.className="Conv1D";ee(k0);class HA extends Ae{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return B(()=>{if(e=ke(e),this.dataFormat==="channelsLast"){const s=vh(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return vh(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=vh(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return vh(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}HA.className="Cropping2D";ee(HA);class KA extends Ae{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,St(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,zG(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return B(()=>{let s=ke(e);const a=s.shape;if(this.dataFormat==="channelsFirst"){s=De(s,[0,2,3,1]);const r=this.size[0]*a[2],i=this.size[1]*a[3],o=this.interpolation==="nearest"?qs.resizeNearestNeighbor(s,[r,i]):qs.resizeBilinear(s,[r,i]);return De(o,[0,3,1,2])}else{const r=this.size[0]*a[1],i=this.size[1]*a[2];return this.interpolation==="nearest"?qs.resizeNearestNeighbor(s,[r,i]):qs.resizeBilinear(s,[r,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}KA.className="UpSampling2D";ee(KA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cH(t,e,n=[1,1],s="valid",a,r){return B(()=>{a==null&&(a=aa()),St(a);let i=V1(t,a);if(t.rank!==4)throw new P(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new P(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=$u(i,e,n,s==="same"?"same":"valid","NHWC",r),a==="channelsFirst"&&(i=De(i,[0,3,1,2])),i})}class qA extends x0{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=rt(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=jt(e.depthwiseConstraint),this.depthwiseRegularizer=it(e.depthwiseRegularizer)}build(e){if(e=Pe(e),e.length<4)throw new P(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new P(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],a=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",a,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return B(()=>{e=ke(e);let s=cH(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=ua(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Pe(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],a=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=ea(n,this.kernelSize[0],this.padding,this.strides[0]),i=ea(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],a,r,i]:[e[0],r,i,a]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=dt(this.depthwiseInitializer),e.depthwiseRegularizer=Ke(this.depthwiseRegularizer),e.depthwiseConstraint=Ft(this.depthwiseRegularizer),e}}qA.className="DepthwiseConv2D";ee(qA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JA(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new P("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function a(r){return r==null||Array.isArray(r)?r:[r]}return e=a(e),n=a(n),{inputs:t,initialState:e,constants:n}}function XA(t,e,n,s=!1,a,r,i=!1,o=!1){return B(()=>{const l=e.shape.length;if(l<3)throw new P(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(sa(2,l));e=De(e,u),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),a!=null&&(a=re(re(a,"bool"),"float32"),a.rank===l-1&&(a=on(a,-1)),a=De(a,u)),s&&(e=hs(e,0),a!=null&&(a=hs(a,0)));const c=[];let d,p=n;const h=e.shape[0],f=fs(e);let g;a!=null&&(g=fs(a));for(let m=0;m<h;++m){const w=f[m],b=B(()=>t(w,p));if(a==null)d=b[0],p=b[1];else{const x=B(()=>{const v=g[m],S=ce(Yn(v),v),N=Z(_(b[0],v),_(p[0],S)),$=p.map((E,A)=>Z(_(b[1][A],v),_(E,S)));return{output:N,newStates:$}});d=x.output,p=x.newStates}o&&c.push(d)}let y;return o&&(y=Fn(c,1)),[d,y,p]})}class hi extends Ae{constructor(e){super(e);let n;if(e.cell==null)throw new P("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new G1({cells:e.cell}):n=e.cell,n.stateSize==null)throw new P("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new _t({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return sa(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){qw(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let a;if(this.returnSequences?a=[e[0],e[1],s]:a=[e[0],s],this.returnState){const r=[];for(const i of n)r.push([e[0],i]);return[a].concat(r)}else return a}computeMask(e,n){return B(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const a=this.states.map(r=>null);return[s].concat(a)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Ce("Constants support is not implemented in RNN yet.");qw(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new _t({shape:[n,null,...s]});const a=[e[0]].concat(e.slice(2));this.cell.build(a);let r;if(Array.isArray(this.cell.stateSize)?r=this.cell.stateSize:r=[this.cell.stateSize],this.stateSpec!=null){if(!Re(this.stateSpec.map(i=>i.shape[i.shape.length-1]),r))throw new P(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=r.map(i=>new _t({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){B(()=>{if(!this.stateful)throw new pa("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new P("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>$t([s,a])):this.states_=[$t([s,this.cell.stateSize])];else if(e==null)Te(this.states_),this.keptStates!=null&&(Te(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(a=>$t([s,a])):this.states_[0]=$t([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new P(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Te(this.states_);for(let a=0;a<this.states_.length;++a){const r=e[a],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[a]:this.cell.stateSize,o=[s,i];if(!Re(r.shape,o))throw new P(`State ${a} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${r.shape}`);this.states_[a]=r}}this.states_=this.states_.map(a=>Rt(a.clone()))})}apply(e,n){let s=n==null?null:n.initialState,a=n==null?null:n.constants;n==null&&(n={});const r=JA(e,s,a,this.numConstants);e=r.inputs,s=r.initialState,a=r.constants;let i=[],o=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new _t({shape:u.shape}));o=o.concat(this.stateSpec)}if(a!=null&&(n.constants=a,i=i.concat(a),this.numConstants=a.length),i[0]instanceof Ea){const u=[e].concat(i),c=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=c;const p=super.apply(u,n);return this.inputSpec=d,p}else return super.apply(e,n)}call(e,n){return B(()=>{const s=n==null?null:n.mask,a=n==null?null:n.training;let r=n==null?null:n.initialState;e=ke(e),r==null&&(this.stateful?r=this.states_:r=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(r.length!==i)throw new P(`RNN Layer has ${i} state(s) but was passed ${r.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:a},u=XA((f,g)=>{const y=this.cell.call([f].concat(g),o);return[y[0],y.slice(1)]},e,r,this.goBackwards,s,null,this.unroll,this.returnSequences),c=u[0],d=u[1],p=u[2];this.stateful&&this.resetStates(p,a);const h=this.returnSequences?d:c;return this.returnState?[h].concat(p):h})}getInitialState(e){return B(()=>{let n=$t(e.shape);return n=pe(n,[1,2]),n=Mp(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?Hw(n,[1,s]):n):this.cell.stateSize>1?[Hw(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===hi.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const a=n.cell,r=Ga(a,s);return new e(Object.assign(n,{cell:r}))}}hi.className="RNN";ee(hi);class v0 extends Ae{}class W1 extends v0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Vt(this.units,"units"),this.activation=Xr(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=rt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=rt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=rt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=it(e.kernelRegularizer),this.recurrentRegularizer=it(e.recurrentRegularizer),this.biasRegularizer=it(e.biasRegularizer),this.kernelConstraint=jt(e.kernelConstraint),this.recurrentConstraint=jt(e.recurrentConstraint),this.biasConstraint=jt(e.biasConstraint),this.dropout=vl([1,qr([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=vl([1,qr([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Pe(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return B(()=>{if(e=e,e.length!==2)throw new P(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const a=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Yr({ones:()=>Yn(e),rate:this.dropout,training:a,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Yr({ones:()=>Yn(s),rate:this.recurrentDropout,training:a,dropoutFunc:this.dropoutFunc}));let r;const i=this.dropoutMask,o=this.recurrentDropoutMask;i!=null?r=Na(_(e,i),this.kernel.read()):r=Na(e,this.kernel.read()),this.bias!=null&&(r=ua(r,this.bias.read())),o!=null&&(s=_(s,o));let l=Z(r,Na(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Jr(this.activation),useBias:this.useBias,kernelInitializer:dt(this.kernelInitializer),recurrentInitializer:dt(this.recurrentInitializer),biasInitializer:dt(this.biasInitializer),kernelRegularizer:Ke(this.kernelRegularizer),recurrentRegularizer:Ke(this.recurrentRegularizer),biasRegularizer:Ke(this.biasRegularizer),activityRegularizer:Ke(this.activityRegularizer),kernelConstraint:Ft(this.kernelConstraint),recurrentConstraint:Ft(this.recurrentConstraint),biasConstraint:Ft(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}W1.className="SimpleRNNCell";ee(W1);class YA extends hi{constructor(e){e.cell=new W1(e),super(e)}call(e,n){return B(()=>{this.cell.dropoutMask!=null&&(Te(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Te(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,a=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:a,initialState:r})})}static fromConfig(e,n){return new e(n)}}YA.className="SimpleRNN";ee(YA);class U1 extends v0{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new P("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Vt(this.units,"units"),this.activation=Xr(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Xr(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=rt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=rt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=rt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=it(e.kernelRegularizer),this.recurrentRegularizer=it(e.recurrentRegularizer),this.biasRegularizer=it(e.biasRegularizer),this.kernelConstraint=jt(e.kernelConstraint),this.recurrentConstraint=jt(e.recurrentConstraint),this.biasConstraint=jt(e.biasConstraint),this.dropout=vl([1,qr([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=vl([1,qr([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Pe(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return B(()=>{if(e=e,e.length!==2)throw new P(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let a=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Yr({ones:()=>Yn(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Yr({ones:()=>Yn(a),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const r=this.dropoutMask,i=this.recurrentDropoutMask;let o,l,u;0<this.dropout&&this.dropout<1&&(e=_(e,r[0]));let c=Na(e,this.kernel.read());this.useBias&&(c=ua(c,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(a=_(a,i[0]));const d=this.recurrentKernel.read(),[p,h]=An(d,[2*this.units,this.units],d.rank-1),f=Na(a,p),[g,y,m]=An(c,3,c.rank-1),[w,b]=An(f,2,f.rank-1);o=this.recurrentActivation.apply(Z(g,w)),l=this.recurrentActivation.apply(Z(y,b));const x=Na(_(l,a),h);u=this.activation.apply(Z(m,x));const v=Z(_(o,a),_(Z(1,Ye(o)),u));return[v,v]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Jr(this.activation),recurrentActivation:Jr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:dt(this.kernelInitializer),recurrentInitializer:dt(this.recurrentInitializer),biasInitializer:dt(this.biasInitializer),kernelRegularizer:Ke(this.kernelRegularizer),recurrentRegularizer:Ke(this.recurrentRegularizer),biasRegularizer:Ke(this.biasRegularizer),activityRegularizer:Ke(this.activityRegularizer),kernelConstraint:Ft(this.kernelConstraint),recurrentConstraint:Ft(this.recurrentConstraint),biasConstraint:Ft(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}U1.className="GRUCell";ee(U1);class QA extends hi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new U1(e),super(e)}call(e,n){return B(()=>{this.cell.dropoutMask!=null&&(Te(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Te(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,a=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:a,initialState:r})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}QA.className="GRU";ee(QA);class S0 extends v0{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Vt(this.units,"units"),this.activation=Xr(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Xr(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=rt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=rt(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=rt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=it(e.kernelRegularizer),this.recurrentRegularizer=it(e.recurrentRegularizer),this.biasRegularizer=it(e.biasRegularizer),this.kernelConstraint=jt(e.kernelConstraint),this.recurrentConstraint=jt(e.recurrentConstraint),this.biasConstraint=jt(e.biasConstraint),this.dropout=vl([1,qr([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=vl([1,qr([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Pe(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let a;if(this.useBias){if(this.unitForgetBias){const r=this.biasInitializer,i=this.units;a=new(n=class extends js{apply(l,u){const c=r.apply([i]),d=new A1().apply([i]),p=r.apply([i*2]);return pS(pS(c,d),p)}},n.className="CustomInit",n)}else a=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,a,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return B(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new P(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let a=e[1];const r=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Yr({ones:()=>Yn(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Yr({ones:()=>Yn(a),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let l,u,c,d;0<this.dropout&&this.dropout<1&&(e=_(e,i[0]));let p=Na(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(a=_(a,o[0])),p=Z(p,Na(a,this.recurrentKernel.read())),this.useBias&&(p=ua(p,this.bias.read()));const[h,f,g,y]=An(p,4,p.rank-1);l=this.recurrentActivation.apply(h),u=this.recurrentActivation.apply(f),c=Z(_(u,r),_(l,this.activation.apply(g))),d=this.recurrentActivation.apply(y);const m=_(d,this.activation.apply(c));return[m,m,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:Jr(this.activation),recurrentActivation:Jr(this.recurrentActivation),useBias:this.useBias,kernelInitializer:dt(this.kernelInitializer),recurrentInitializer:dt(this.recurrentInitializer),biasInitializer:dt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Ke(this.kernelRegularizer),recurrentRegularizer:Ke(this.recurrentRegularizer),biasRegularizer:Ke(this.biasRegularizer),activityRegularizer:Ke(this.activityRegularizer),kernelConstraint:Ft(this.kernelConstraint),recurrentConstraint:Ft(this.recurrentConstraint),biasConstraint:Ft(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}S0.className="LSTMCell";ee(S0);class ZA extends hi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new S0(e),super(e)}call(e,n){return B(()=>{this.cell.dropoutMask!=null&&(Te(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Te(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,a=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:a,initialState:r})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}ZA.className="LSTM";ee(ZA);class G1 extends v0{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return B(()=>{e=e;let s=e.slice(1);const a=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?a.push(s.splice(0,o.stateSize.length)):a.push(s.splice(0,1));a.reverse();const r=[];let i;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];s=a[o],o===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,n),r.push(i.slice(1))}s=[];for(const o of r.slice().reverse())s.push(...o);return[i[0]].concat(s)})}build(e){qw(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,a)=>{Bi(`RNNCell_${a}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=r=>({className:r.getClassName(),config:r.getConfig()}),a={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),a)}static fromConfig(e,n,s={}){const a=[];for(const r of n.cells)a.push(Ga(r,s));return new e({cells:a})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return Jw(e)}setWeights(e){const n=[];for(const s of this.cells){const a=s.weights.length,r=e.splice(a);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],r[i]])}P1(n)}}G1.className="StackedRNNCells";ee(G1);function Yr(t){const{ones:e,rate:n,training:s=!1,count:a=1,dropoutFunc:r}=t,i=()=>r!=null?r(e(),n):UE(e(),n),o=()=>Wp(i,e,s);return!a||a<=1?Rt(o().clone()):Array(a).fill(void 0).map(o).map(u=>Rt(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var dH=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n};class eR extends hi{constructor(e){if(e.unroll)throw new Ce("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Ce("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new _t({ndim:5})]}call(e,n){return B(()=>{if(this.cell.dropoutMask!=null&&(Te(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Te(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new P("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,a=n==null?null:n.training,r=n==null?null:n.initialState;return super.call(e,{mask:s,training:a,initialState:r})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return B(()=>{const{stateSize:n}=this.cell,s=e.shape,a=this.computeSingleOutputShape(s),r=[a[0],...a.slice(2)],i=$t(r);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){B(()=>{if(!this.stateful)throw new pa("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,a=this.computeSingleOutputShape(s),r=[a[0],...a.slice(2)];if(s[0]==null)throw new P("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>$t(r)):this.states_=[$t(r)];else if(e==null)Te(this.states_),this.keptStates!=null&&(Te(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>$t(r)):this.states_[0]=$t(r);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new P(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Te(this.states_);for(let o=0;o<this.states_.length;++o){const l=e[o],u=r;if(!Re(l.shape,u))throw new P(`State ${o} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>Rt(o.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:a,padding:r,strides:i,dilationRate:o}=this.cell,l=n==="channelsFirst",u=e[l?3:2],c=e[l?4:3],d=ea(u,a[0],r,i[0],o[0]),p=ea(c,a[1],r,i[1],o[1]);return[...e.slice(0,2),...l?[s,d,p]:[d,p,s]]}}eR.className="ConvRNN2D";class H1 extends S0{constructor(e){const{filters:n,kernelSize:s,strides:a,padding:r,dataFormat:i,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Vt(this.filters,"filters"),this.kernelSize=rl(s,2,"kernelSize"),this.kernelSize.forEach(l=>Vt(l,"kernelSize")),this.strides=rl(a||1,2,"strides"),this.strides.forEach(l=>Vt(l,"strides")),this.padding=r||"valid",ys(this.padding),this.dataFormat=i||"channelsLast",St(this.dataFormat),this.dilationRate=rl(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>Vt(l,"dilationRate"))}build(e){var n;e=Pe(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new P(`The channel dimension of the input should be defined. Found ${e[s]}`);const a=e[s],r=4,i=this.kernelSize.concat([a,this.filters*r]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*r]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,c=this.filters;l=new(n=class extends js{apply(p,h){const f=u.apply([c]),g=Tn([c]),y=u.apply([c*2]);return E1([f,g,y])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*r],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return B(()=>{if(e.length!==3)throw new P(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,a=e[0],r=e[1],i=e[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Yr({ones:()=>Yn(a),rate:this.dropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(K,Y,Q)=>!Y||!Y[Q]?K:_(Y[Q],K);let c=u(a,l,0),d=u(a,l,1),p=u(a,l,2),h=u(a,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Yr({ones:()=>Yn(r),rate:this.recurrentDropout,training:s,count:o,dropoutFunc:this.dropoutFunc}));const f=this.recurrentDropoutMask;let g=u(r,f,0),y=u(r,f,1),m=u(r,f,2),w=u(r,f,3);const b=3,[x,v,S,N]=An(this.kernel.read(),o,b),[$,E,A,L]=this.useBias?An(this.bias.read(),o):[null,null,null,null];c=this.inputConv(c,x,$,this.padding),d=this.inputConv(d,v,E,this.padding),p=this.inputConv(p,S,A,this.padding),h=this.inputConv(h,N,L,this.padding);const[W,U,j,z]=An(this.recurrentKernel.read(),o,b);g=this.recurrentConv(g,W),y=this.recurrentConv(y,U),m=this.recurrentConv(m,j),w=this.recurrentConv(w,z);const G=this.recurrentActivation.apply(Z(c,g)),J=this.recurrentActivation.apply(Z(d,y)),O=Z(_(J,i),_(G,this.activation.apply(Z(p,m)))),M=_(this.recurrentActivation.apply(Z(h,w)),this.activation.apply(O));return[M,M,O]})}getConfig(){const e=super.getConfig(),n=dH(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,a){const r=Qa(e,n,this.strides,a||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?ua(r,s,this.dataFormat):r}recurrentConv(e,n){return Qa(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}H1.className="ConvLSTM2DCell";ee(H1);class tR extends eR{constructor(e){const n=new H1(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}tR.className="ConvLSTM2D";ee(tR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class K1 extends Ae{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let a=0;a<this.noiseShape.length;++a)s.push(this.noiseShape[a]==null?n[a]:this.noiseShape[a]);return s}call(e,n){return B(()=>{this.invokeCallHook(e,n);const s=ke(e);if(0<this.rate&&this.rate<1){const a=n.training==null?!1:n.training,r=this.getNoiseShape(s);return Wp(()=>UE(s,this.rate,r,this.seed),()=>s,a)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}K1.className="Dropout";ee(K1);class nR extends K1{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}nR.className="SpatialDropout1D";ee(nR);class sR extends Ae{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Vt(this.units,"units"),this.activation=Xr(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=rt(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=rt(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=jt(e.kernelConstraint),this.biasConstraint=jt(e.biasConstraint),this.kernelRegularizer=it(e.kernelRegularizer),this.biasRegularizer=it(e.biasRegularizer),this.activityRegularizer=it(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Pe(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Pe(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return B(()=>{this.invokeCallHook(e,n);const s=ke(e),a=PE(this.activation.getClassName());let r;return a!=null?r=Na(s,this.kernel.read(),a,this.bias?this.bias.read():null):(r=Na(s,this.kernel.read()),this.bias!=null&&(r=ua(r,this.bias.read())),this.activation!=null&&(r=this.activation.apply(r))),r})}getConfig(){const e={units:this.units,activation:Jr(this.activation),useBias:this.useBias,kernelInitializer:dt(this.kernelInitializer),biasInitializer:dt(this.biasInitializer),kernelRegularizer:Ke(this.kernelRegularizer),biasRegularizer:Ke(this.biasRegularizer),activityRegularizer:Ke(this.activityRegularizer),kernelConstraint:Ft(this.kernelConstraint),biasConstraint:Ft(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}sR.className="Dense";ee(sR);class aR extends Ae{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Pe(e);for(const n of e.slice(1))if(n==null)throw new P(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Lr(e,1)]}call(e,n){return B(()=>{this.invokeCallHook(e,n);let s=ke(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const a=[0];for(let r=2;r<s.rank;++r)a.push(r);a.push(1),s=De(s,a)}return GG(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}aR.className="Flatten";ee(aR);class rR extends Ae{constructor(e){super(e),this.supportsMasking=!0,this.activation=Xr(e.activation)}call(e,n){return B(()=>{this.invokeCallHook(e,n);const s=ke(e);return this.activation.apply(s)})}getConfig(){const e={activation:Jr(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}rR.className="Activation";ee(rR);class iR extends Ae{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return B(()=>(e=ke(e),WG(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}iR.className="RepeatVector";ee(iR);class oR extends Ae{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",a=n.slice();let r=1,i=null;for(let l=0;l<a.length;++l){const u=a[l];if(this.isUnknown(u))if(i===null)i=l;else throw new P("Can only specifiy one unknown dimension.");else r*=u}const o=Lr(e);if(i!==null){if(r===0||o%r!==0)throw new P(s);a[i]=o/r}else if(o!==r)throw new P(s);return a}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return B(()=>{this.invokeCallHook(e,n);const s=ke(e),a=s.shape,r=a.slice(0,1).concat(this.fixUnknownDimension(a.slice(1),this.targetShape));return F(s,r)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}oR.className="Reshape";ee(oR);class lR extends Ae{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=sa(1,e.dims.length+1);if(!Re(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new _t({ndim:this.dims.length+1})]}computeOutputShape(e){e=Pe(e);const n=e.slice();return this.dims.forEach((s,a)=>{n[a+1]=e[s]}),n}call(e,n){return De(ke(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}lR.className="Permute";ee(lR);class uR extends Ae{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=ke(e);return Xc(to(s,this.maskValue),-1)}call(e,n){return B(()=>{this.invokeCallHook(e,n);const s=ke(e),i=Xc(to(s,this.maskValue),-1,!0);return _(s,re(i,s.dtype))})}}uR.className="Masking";ee(uR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cR extends Ae{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Me(e.inputLength))}this.inputDim=e.inputDim,Vt(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Vt(this.outputDim,"outputDim"),this.embeddingsInitializer=rt(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=it(e.embeddingsRegularizer),this.activityRegularizer=it(e.activityRegularizer),this.embeddingsConstraint=jt(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return B(()=>this.maskZero?(e=ke(e),to(e,Oe(e))):null)}computeOutputShape(e){if(e=Pe(e),this.inputLength==null)return[...e,this.outputDim];const n=Me(this.inputLength);if(n.length!==e.length-1)throw new P(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let a=0;a<n.length;++a){const r=n[a],i=e[a+1];if(r!=null&&i!=null&&r!==i)throw new P(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);r==null&&(n[s]=i),s++}}return[e[0],...n,this.outputDim]}call(e,n){return B(()=>{this.invokeCallHook(e,n);let s=ke(e);s.dtype!=="int32"&&(s=Sa(s,"int32"));const a=WE(this.embeddings.read(),F(s,[s.size]));return F(a,Pe(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:dt(this.embeddingsInitializer),embeddingsRegularizer:Ke(this.embeddingsRegularizer),activityRegularizer:Ke(this.activityRegularizer),embeddingsConstraint:Ft(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}cR.className="Embedding";ee(cR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Co extends Ae{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Ce}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let a=0;a<n.length;++a){const r=e[e.length-n.length+a],i=n[a];if(r==null||i==null||r<0||i<0)s.push(null);else if(r===1)s.push(i);else if(i===1)s.push(r);else{if(r!==i)throw new P("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(r)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Pe(e)]),e=e,e.length<2)throw new P(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const r of e)r!=null&&r[0]!==null&&n.push(r[0]);if(n=Pr(n),n.length>1)throw new P(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let r=1;r<e.length;++r){const i=e[r]==null?null:e[r].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const a=e.map(r=>r.length);e.indexOf(null)===-1&&Pr(a).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return B(()=>{if(e=e,this.reshapeRequired){const s=[],a=e.map(r=>r.rank);if(a.indexOf(null)===-1){const r=qr(a);for(let i of e){const o=i.rank;for(let l=0;l<r-o;++l)i=Mp(i,1);s.push(i)}return this.mergeFunction(s)}else{let r=!1;for(const l of e){const u=l.rank;if(u==null){const c=l.shape,d=c[0],p=c.slice(1).concat([d]);let h=F(l,[d].concat(Lr(c.slice(1))));h=De(h,[1,0]),h=F(h,p),s.push(h),r=!0}else if(u>1){const c=sa(1,u).concat([0]);s.push(De(l,c)),r=!0}else s.push(l)}let i=this.mergeFunction(s);const o=i.rank;if(r){if(o==null){const l=i.shape,u=l.length,c=l[u-1],d=[c].concat(l.slice(0,l.length-1));i=F(De(F(i,[-1,c]),[1,0]),d)}else if(o>1){const l=[o-1].concat(sa(0,o-1));i=De(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let a=1;a<e.length;++a){const r=e[a]==null?null:e[a].slice(1);n=this.computeElementwiseOpOutputShape(n,r)}let s=[];for(const a of e)a!=null&&a[0]!==null&&s.push(a[0]);return s=Pr(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return B(()=>{if(n==null)return null;if(!Array.isArray(n))throw new P("`mask` should be an Array");if(!Array.isArray(e))throw new P("`inputs` should be an Array");if(n.length!==e.length)throw new P(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(a=>a==null))return null;n=n.map(a=>a==null?a:on(a,0));let s=n[0];for(let a=1;a<n.length-1;++a)s=na(s,n[a]);return s})}}class dR extends Co{constructor(e){super(e)}mergeFunction(e){return B(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=Z(n,e[s]);return n})}}dR.className="Add";ee(dR);class pR extends Co{constructor(e){super(e)}mergeFunction(e){return B(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=_(n,e[s]);return n})}}pR.className="Multiply";ee(pR);class hR extends Co{constructor(e){super(e)}mergeFunction(e){return B(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=Z(n,e[s]);return _(1/e.length,n)})}}hR.className="Average";ee(hR);class fR extends Co{constructor(e){super(e)}mergeFunction(e){return B(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Ra(n,e[s]);return n})}}fR.className="Maximum";ee(fR);class mR extends Co{constructor(e){super(e)}mergeFunction(e){return B(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Kr(n,e[s]);return n})}}mR.className="Minimum";ee(mR);class gR extends Co{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new P("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const a of e)if(a!=null){n=!1;break}if(n)return;const s=[];for(let a=0;a<e.length;++a){const r=e[a].slice();r.splice(this.axis,1);let i=!1;for(const o of s)if(Re(o,r)){i=!0;break}i||s.push(r)}if(s.length>1)throw new P("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return B(()=>E1(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new P("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),a=this.axis<0?s.length+this.axis:this.axis;for(const r of n.slice(1)){if(s[a]==null||r[a]==null){s[a]=null;break}s[a]+=r[a]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new P("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new P("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new P(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return B(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const a=[];for(let i=0;i<e.length;++i)n[i]==null?a.push(re(Yn(e[i]),"bool")):n[i].rank<e[i].rank?a.push(on(n[i],-1)):a.push(n[i]);const r=xt(a,this.axis);return Tg(r,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}gR.className="Concatenate";ee(gR);function Zu(t,e){for(;t<0;)t+=e;return t}function pH(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Ce("batchDot is not implemented for tensors of 4D or higher rank yet");if(C(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),C(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Ce("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,a=e.shape.length;n==null&&(n=[s-1,a-2]);const r=n;return B(()=>{let i;if(s>a){i=s-a;const l=[];for(let u=0;u<i;++u)l.push(1);e=F(e,e.shape.concat(l))}else if(a>s){i=a-s;const l=[];for(let u=0;u<i;++u)l.push(1);t=F(t,t.shape.concat(l))}else i=0;let o;if(t.shape.length===2&&e.shape.length===2)r[0]===r[1]?o=pe(_(t,e),r[0]):o=pe(_(De(t,[1,0]),e),r[1]);else{const l=r[0]!==t.shape.length-1,u=r[1]===e.shape.length-1;o=$e(t,e,l,u)}if(i>0){let l;s>a?l=s+a-3:l=s-1;const u=[];for(let c=l;c<l+i;++c)u.push(c);o=di(o,u)}return o.shape.length===1&&(o=on(o,1)),o})}class yR extends Co{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){C(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Ce("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(n,s);if(n[a[0]]!==s[a[1]])throw new P(`Dimension incompatibility: ${n[a[0]]} !== ${s[a[1]]}`)}mergeFunction(e){if(e.length!==2)throw new P(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],a;return Array.isArray(this.axes)?a=this.axes.map((r,i)=>Zu(r,e[i].shape.length)):a=[Zu(this.axes,n.shape.length),Zu(this.axes,s.shape.length)],this.normalize&&(n=Pf(n,a[0]),s=Pf(s,a[1])),pH(n,s,a)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Zu(this.axes,e.length),Zu(this.axes,n.length)],s}computeOutputShape(e){C(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Ce("Dot layer does not support tensors of 4D or higher rank yet.");const a=this.interpretAxes(n,s);n.splice(a[0],1),s.splice(a[1],1),s.splice(0,1);const r=n.concat(s);return r.length===1&&r.push(1),r}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}yR.className="Dot";ee(yR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wR extends Ae{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return B(()=>{this.invokeCallHook(e,n);const s=ke(e);return Wp(()=>Z(g0(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}wR.className="GaussianNoise";ee(wR);class bR extends Ae{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return B(()=>{this.invokeCallHook(e,n);const s=ke(e);return this.rate>0&&this.rate<1?Wp(()=>{const r=Math.sqrt(this.rate/(1-this.rate));return _(s,g0(s.shape,1,r))},()=>s,n.training||!1):s})}}bR.className="GaussianDropout";ee(bR);class xR extends Ae{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||ke(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return B(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return Wp(()=>{const r=ke(e),l=-1.6732632423543772*1.0507009873554805;let u=ir(ci(s),this.rate);u=Sa(u,"float32");const c=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-c*l*this.rate,p=Z(_(r,u),_(Z(u,-1),l));return Z(_(p,c),d)},()=>ke(e),n.training||!1)}return e})}}xR.className="AlphaDropout";ee(xR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sd(t,e,n,s,a,r=.001){let i;if(t.rank===2)i=Hx(t,e,n,s,a,r);else if(t.rank===3)i=Kx(t,e,n,s,a,r);else if(t.rank===4)i=qx(t,e,n,s,a,r);else throw new Ce(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function hH(t,e,n,s,a=.001){return B(()=>{const r=Ep(t,s),i=r.mean,o=r.variance;return[sd(t,i,o,n,e,a),i,o]})}function fH(t,e,n,s,a=.001){return B(()=>{const r=Ep(t,s),i=r.mean,o=r.variance,l=[];for(const f of sa(0,t.rank))s.indexOf(f)!==-1?l.push(1):l.push(t.shape[f]);const u=F(i,l),c=F(o,l),d=e==null?null:F(e,l),p=n==null?null:F(n,l);return[sd(t,u,c,p,d,a),i,o]})}function mH(t,e,n,s,a=.001){return Re(s.slice().sort(),sa(0,t.rank-1))?hH(t,e,n,s,a):fH(t,e,n,s,a)}class kR extends Ae{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=rt(e.betaInitializer||"zeros"),this.gammaInitializer=rt(e.gammaInitializer||"ones"),this.movingMeanInitializer=rt(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=rt(e.movingVarianceInitializer||"ones"),this.betaConstraint=jt(e.betaConstraint),this.gammaConstraint=jt(e.gammaConstraint),this.betaRegularizer=it(e.betaRegularizer),this.gammaRegularizer=it(e.gammaRegularizer)}build(e){e=Pe(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new P(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new _t({ndim:e.length,axes:{[n]:s}})];const a=[s];this.scale&&(this.gamma=this.addWeight("gamma",a,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",a,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",a,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",a,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return B(()=>{const s=n.training==null?!1:n.training,a=ke(e),r=a.shape,i=r.length,o=sa(0,i),l=this.axis>=0?this.axis:this.axis+i;o.splice(l,1);const u=ao(1,i);u[l]=r[l];const c=o.slice();c.sort();const d=!Re(c,sa(0,i).slice(0,i-1)),p=()=>{if(d){const w=F(this.movingMean.read(),u),b=F(this.movingVariance.read(),u),x=this.center?F(this.beta.read(),u):null,v=this.scale?F(this.gamma.read(),u):null;return sd(a,w,b,x,v,this.epsilon)}else return sd(a,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return p();const[h,f,g]=mH(a,this.gamma.read(),this.beta.read(),o,this.epsilon),y=(w,b,x)=>{B(()=>{const v=1-x,S=w.read(),N=_(ce(S,b),v);w.write(ce(S,N))})};return(()=>{y(this.movingMean,f,this.momentum),y(this.movingVariance,g,this.momentum)})(),h})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:dt(this.betaInitializer),gammaInitializer:dt(this.gammaInitializer),movingMeanInitializer:dt(this.movingMeanInitializer),movingVarianceInitializer:dt(this.movingVarianceInitializer),betaRegularizer:Ke(this.betaRegularizer),gammaRegularizer:Ke(this.gammaRegularizer),betaConstraint:Ft(this.betaConstraint),gammaConstraint:Ft(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}kR.className="BatchNormalization";ee(kR);class vR extends Ae{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=rt(e.betaInitializer||"zeros"),this.gammaInitializer=rt(e.gammaInitializer||"ones"),this.betaRegularizer=it(e.betaRegularizer),this.gammaRegularizer=it(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Pe(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let r=0;r<this.axis.length;++r)this.axis[r]<0&&(this.axis[r]+=n);for(const r of this.axis)if(r<0||r>=n)throw new Error(`Invalid axis: ${r}`);if(this.axis.length!==Pr(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(r=>e[r]),a=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,a):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,a):this.beta=null,this.built=!0}call(e,n){const s=ke(e),a=s.shape,r=a.length;return B(()=>{let{mean:o,variance:l}=Ep(s,this.axis,!0);const u=ao(1,r);for(const g of this.axis)u[g]=a[g];const c=g=>g!=null&&g.shape.length!==r?F(g,u):g;let d=this.scale?c(this.gamma.read()):null,p=this.center?c(this.beta.read()):null;const h=[],f=[];for(let g=0;g<r;++g)this.axis.indexOf(g)!==-1?(h.push(a[g]),f.push(1)):(h.push(1),f.push(a[g]));return o=os(o,h),l=os(l,h),d!=null&&(d=os(d,f)),p!=null&&(p=os(p,f)),sd(s,o,l,p,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:dt(this.betaInitializer),gammaInitializer:dt(this.gammaInitializer),betaRegularizer:Ke(this.betaRegularizer),gammaRegularizer:Ke(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}vR.className="LayerNormalization";ee(vR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gH(t,e,n){return B(()=>{if(t.rank!==4)throw new P(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new P("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=aa()),n!=="channelsLast"&&n!=="channelsFirst")throw new P(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],or(t,s)})}class SR extends Ae{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?aa():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new P(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new P(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new P(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new _t({ndim:4})]}computeOutputShape(e){e=Pe(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return B(()=>gH(ke(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}SR.className="ZeroPadding2D";ee(SR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function N0(t,e,n,s,a,r){return B(()=>{St(a),zE(r),ys(s),n==null&&(n=[1,1]),s==null&&(s="valid"),a==null&&(a=aa()),r==null&&(r="max"),t=V1(t,a);let i;const o=s==="same"?"same":"valid";return r==="max"?i=Tp(t,e,n,o):i=xp(t,e,n,o),a==="channelsFirst"&&(i=De(i,[0,3,1,2])),i})}function NR(t,e,n,s,a,r){return B(()=>{St(a),zE(r),ys(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),a==null&&(a=aa()),r==null&&(r="max"),t=MA(t,a);let i;const o=s==="same"?"same":"valid";return r==="max"?i=yk(t,e,n,o):i=Gx(t,e,n,o),a==="channelsFirst"&&(i=De(i,[0,4,1,2,3])),i})}class CR extends Ae{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new P(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Vt(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new P(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Vt(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,ys(this.padding),this.inputSpec=[new _t({ndim:3})]}computeOutputShape(e){e=Pe(e);const n=ea(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return B(()=>{this.invokeCallHook(e,n),e=Mp(ke(e),2);const s=this.poolingFunction(ke(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return di(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class IR extends CR{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return St(r),ys(a),N0(e,n,s,a,r,"max")}}IR.className="MaxPooling1D";ee(IR);class $R extends CR{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return St(r),ys(a),N0(e,n,s,a,r,"avg")}}$R.className="AveragePooling1D";ee($R);class TR extends Ae{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new P(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Vt(this.poolSize,"poolSize"),Vt(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,St(this.dataFormat),ys(this.padding),this.inputSpec=[new _t({ndim:4})]}computeOutputShape(e){e=Pe(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=ea(n,this.poolSize[0],this.padding,this.strides[0]),s=ea(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return B(()=>(this.invokeCallHook(e,n),this.poolingFunction(ke(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class ER extends TR{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return St(r),ys(a),N0(e,n,s,a,r,"max")}}ER.className="MaxPooling2D";ee(ER);class AR extends TR{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return St(r),ys(a),N0(e,n,s,a,r,"avg")}}AR.className="AveragePooling2D";ee(AR);class RR extends Ae{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new P(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Vt(this.poolSize,"poolSize"),Vt(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,St(this.dataFormat),ys(this.padding),this.inputSpec=[new _t({ndim:5})]}computeOutputShape(e){e=Pe(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],a=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=ea(n,this.poolSize[0],this.padding,this.strides[0]),s=ea(s,this.poolSize[1],this.padding,this.strides[1]),a=ea(a,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,a]:[e[0],n,s,a,e[4]]}call(e,n){return B(()=>(this.invokeCallHook(e,n),this.poolingFunction(ke(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class DR extends RR{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return St(r),ys(a),NR(e,n,s,a,r,"max")}}DR.className="MaxPooling3D";ee(DR);class _R extends RR{constructor(e){super(e)}poolingFunction(e,n,s,a,r){return St(r),ys(a),NR(e,n,s,a,r,"avg")}}_R.className="AveragePooling3D";ee(_R);class OR extends Ae{constructor(e){super(e),this.inputSpec=[new _t({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Ce}}class FR extends OR{constructor(e){super(e||{})}call(e,n){return B(()=>{const s=ke(e);return ct(s,1)})}}FR.className="GlobalAveragePooling1D";ee(FR);class jR extends OR{constructor(e){super(e||{})}call(e,n){return B(()=>{const s=ke(e);return ds(s,1)})}}jR.className="GlobalMaxPooling1D";ee(jR);class PR extends Ae{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,St(this.dataFormat),this.inputSpec=[new _t({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Ce}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class LR extends PR{call(e,n){return B(()=>{const s=ke(e);return this.dataFormat==="channelsLast"?ct(s,[1,2]):ct(s,[2,3])})}}LR.className="GlobalAveragePooling2D";ee(LR);class zR extends PR{call(e,n){return B(()=>{const s=ke(e);return this.dataFormat==="channelsLast"?ds(s,[1,2]):ds(s,[2,3])})}}zR.className="GlobalMaxPooling2D";ee(zR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class BR extends Ae{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const a=n.layer,r=Ga(a,s);delete n.layer;const i={layer:r};return Object.assign(i,n),new e(i)}}class MR extends BR{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Pe(e),e.length<3)throw new P(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Pe(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),a=e[1];return[s[0],a].concat(s.slice(1))}call(e,n){return B(()=>(e=ke(e),XA((i,o)=>[ke(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}MR.className="TimeDistributed";ee(MR);function yH(t){No(LG,"BidirectionalMergeMode",t)}const wH="concat";class VR extends BR{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=Ga(s),n.goBackwards=n.goBackwards!==!0;const a={};if(a.className=e.layer.getClassName(),a.config=n,this.backwardLayer=Ga(a),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?wH:e.mergeMode,yH(this.mergeMode),e.weights)throw new Ce("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,a,r;return this.returnState&&(r=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,a=[s]):this.mergeMode==null?a=[s,s.slice()]:a=[s],this.returnState?this.mergeMode==null?a.concat(r).concat(r.slice()):[s].concat(r).concat(r.slice()):$n(a)}apply(e,n){let s=n==null?null:n.initialState,a=n==null?null:n.constants;n==null&&(n={});const r=JA(e,s,a,this.numConstants);if(e=r.inputs,s=r.initialState,a=r.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&a==null)return super.apply(e,n);const i=[],o=[];if(s!=null){const u=s.length;if(u%2>0)throw new P("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const c=s.map(d=>new _t({shape:d.shape}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),o.push(...c)}if(a!=null)throw new Ce("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof Ea;for(const u of i)if(u instanceof Ea!==l)throw new P("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(i),c=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=c;const p=super.apply(u,n);return this.inputSpec=d,p}else return super.apply(e,n)}call(e,n){return B(()=>{const s=n.initialState;let a,r;if(s==null)a=this.forwardLayer.call(e,n),r=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),u=s.slice(s.length/2);a=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),r=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let i;this.returnState&&(Array.isArray(a)&&(i=a.slice(1).concat(r.slice(1))),a=a[0],r=r[0]),this.returnSequences&&(r=hs(r,1));let o;return this.mergeMode==="concat"?o=E1([a,r]):this.mergeMode==="sum"?o=Z(a,r):this.mergeMode==="ave"?o=_(.5,Z(a,r)):this.mergeMode==="mul"?o=_(a,r):this.mergeMode==null&&(o=[a,r]),this.returnState?this.mergeMode==null?o.concat(i):[o].concat(i):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){Bi(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),Bi(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const r=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(r).concat(r):[s].concat(r).concat(r)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=Ga(n.layer);if(delete n.layer,n.numConstants!=null)throw new Ce("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const a=n;return a.layer=s,new e(a)}}VR.className="Bidirectional";ee(VR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class WR extends Ae{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return B(()=>(e=ke(e),e.dtype!=="float32"&&(e=Sa(e,"float32")),Z(_(e,this.scale),this.offset)))}}WR.className="Rescaling";ee(WR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:bH,cropAndResize:xH}=qs;class UR extends Ae{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,a,r,i,o,l){return B(()=>{let u,c=!1;const d=n/i,p=s/o,h=(a+n)/i,f=(r+s)/o,g=[d,p,h,f],y=[];e.rank===3?(c=!0,u=Fn([e])):u=e;for(let v=0;v<u.shape[0];v++)y.push(g);const m=Rs(y,[y.length,4]),w=no(0,y.length,1,"int32"),x=xH(u,m,w,[a,r],"nearest");return Sa(c?ke(fs(x)):x,l)})}upsize(e,n,s,a){return B(()=>{const r=bH(e,[n,s]);return Sa(r,a)})}call(e,n){return B(()=>{const s=ke(e),a=s.dtype,r=s.shape,i=r[r.length-3],o=r[r.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let u=0;return o!==this.width&&(u=Math.floor((o-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(s,l,u,this.height,this.width,i,o,a):this.upsize(e,this.height,this.width,a)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Pe(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}UR.className="CenterCrop";ee(UR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function kH(t,e,n,s){let a=ke(t);if(a.dtype!=="int32"&&(a=Sa(a,"int32")),e==="int")return a;const r=a.shape;if(a.rank===0&&(a=on(a,-1)),e==="oneHot"&&a.shape[a.shape.length-1]!==1&&(a=on(a,-1)),a.rank>2)throw new P(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${r} which would result in output rank ${a.rank}.`);const i=["multiHot","oneHot"].includes(e),o=a;let l;if(typeof s<"u"&&e==="count"?l=Rf(o,s,n,i):l=Rf(o,[],n,i),e!=="tfIdf")return l;if(s)return _(l,s);throw new P("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class GR extends Ae{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Pe(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return B(()=>{e=ke(e),e.dtype!=="int32"&&(e=Sa(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new P(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=ke(n.countWeights)}const a=ds(e),r=gl(e),i=zn(this.numTokens,a).bufferSync().get(0),o=ir(r,0).bufferSync().get(0);if(!(i&&o))throw new P(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return kH(e,this.outputMode,this.numTokens,s)})}}GR.className="CategoryEncoding";ee(GR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vH=["bilinear","nearest"],AS=new Set(vH);class HR extends Ae{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(AS.has(e.interpolation))this.interpolation=e.interpolation;else throw new P(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Pe(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return B(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return qs.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return qs.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...AS]} are supported`)})}}HR.className="Resizing";ee(HR);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class KR{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}KR.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class qR extends Ae{constructor(e){super(e),this.randomGenerator=new KR(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}qR.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const SH=["bilinear","nearest"],RS=new Set(SH);class JR extends qR{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new P(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new P(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new P(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(RS.has(s))this.interpolation=s;else throw new P(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Pe(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return B(()=>{const s=ke(e);this.imgHeight=s.shape[s.shape.length-3];const a=s.shape[s.shape.length-2];this.widthFactor=ci([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*a;r=Math.round(r);const i=[this.imgHeight,r];switch(this.interpolation){case"bilinear":return qs.resizeBilinear(e,i);case"nearest":return qs.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...RS]} are supported`)}})}}JR.className="RandomWidth";ee(JR);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NH=V();NH.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Mn;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Mn||(Mn={}));var DS;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(DS||(DS={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q1={};function CH(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};q1[t]=n}function XR(t){return q1[t]}function IH(t){delete q1[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k(t,e,n,s,a){const r=e.inputParams[t];if(r&&r.inputIndexStart!==void 0){const o=r.inputIndexStart,l=r.inputIndexEnd===0?void 0:r.inputIndexEnd===void 0?o+1:r.inputIndexEnd,u=o<0?e.inputNames.length+o:o;if(r.type==="tensor")return Jt(e.inputNames[u],n,s,a);if(r.type==="tensors"){const p=e.inputs.slice(o,l);return e.inputNames.slice(o,l).filter((f,g)=>{var y;return((y=p[g])===null||y===void 0?void 0:y.op)!=="NoOp"}).map(f=>Jt(f,n,s,a))}const c=Jt(e.inputNames[u],n,s,a),d=c.dataSync();return r.type==="number"?d[0]:cs(c.shape,d)}const i=e.attrParams[t];return i&&i.value}function Jt(t,e,n,s){const[a,r]=Vn(t,n);if(s!=null){const o=s.getHashTableHandleByName(a);if(o!=null)return o}const i=n.currentContextIds.find(o=>!!e[Vf(a,o)]);return i!==void 0?e[Vf(a,i)][r]:void 0}function _S(t,e,n){return e[Vf(t,n.currentContextId)]}function La(t,e){const[n,s,a]=Vn(t,e);return[Vf(n,e&&e.currentContextId),s,a]}function Vf(t,e){return e?`${t}-${e}`:t}function Vn(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const r=e.parseNodeNameCache.get(t);if(r!=null)return r}const s=t.split(":");let a;if(s.length===1)a=[t,0,void 0];else{const r=s[0],i=s.length===3?s[1]:void 0,o=Number(s[s.length-1]);a=[r,o,i]}return n&&e.parseNodeNameCache.set(t,a),a}function Kh(t,e,n){let s=k("pad",t,e,n);if(s==="explicit"){s=k("explicitPaddings",t,e,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let r=0;r<4;r++)a[r][0]=s[r*2],a[r][1]=s[r*2+1];return a}return s}function za(t){return t.kept?t:ka(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $H=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],TH=Object.freeze(Object.defineProperty({__proto__:null,json:$H},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EH=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],AH=Object.freeze(Object.defineProperty({__proto__:null,json:EH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RH=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],DH=Object.freeze(Object.defineProperty({__proto__:null,json:RH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _H=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],OH=Object.freeze(Object.defineProperty({__proto__:null,json:_H},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FH=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],jH=Object.freeze(Object.defineProperty({__proto__:null,json:FH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PH=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],LH=Object.freeze(Object.defineProperty({__proto__:null,json:PH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zH=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],BH=Object.freeze(Object.defineProperty({__proto__:null,json:zH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MH=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],VH=Object.freeze(Object.defineProperty({__proto__:null,json:MH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WH=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],UH=Object.freeze(Object.defineProperty({__proto__:null,json:WH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GH=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],HH=Object.freeze(Object.defineProperty({__proto__:null,json:GH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KH=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],qH=Object.freeze(Object.defineProperty({__proto__:null,json:KH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JH=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],XH=Object.freeze(Object.defineProperty({__proto__:null,json:JH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YH=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],QH=Object.freeze(Object.defineProperty({__proto__:null,json:YH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZH=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],eK=Object.freeze(Object.defineProperty({__proto__:null,json:ZH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tK=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],nK=Object.freeze(Object.defineProperty({__proto__:null,json:tK},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sK=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],aK=Object.freeze(Object.defineProperty({__proto__:null,json:sK},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rK=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],iK=Object.freeze(Object.defineProperty({__proto__:null,json:rK},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oK=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],lK=Object.freeze(Object.defineProperty({__proto__:null,json:oK},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uK=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],cK=Object.freeze(Object.defineProperty({__proto__:null,json:uK},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OS{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[TH,AH,DH,OH,jH,LH,BH,VH,UH,HH,qH,XH,QH,eK,nK,aK,iK,lK,cK],n=[].concat(...e.map(s=>s.json));this.opMappers=n.reduce((s,a)=>(s[a.tfOpName]=a,s),{})}transformGraph(e,n={}){const s=e.node,a=[],r=[],i=[],o=s.reduce((g,y)=>(g[y.name]=this.mapNode(y),y.op.startsWith("Placeholder")?a.push(g[y.name]):y.op==="Const"?r.push(g[y.name]):(y.input==null||y.input.length===0)&&i.push(g[y.name]),g),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const p=Object.keys(o);p.forEach(g=>{const y=o[g];y.inputNames.forEach((m,w)=>{const[b,,x]=La(m),v=o[b];if(v.outputs!=null){const S=v.outputs.indexOf(x);if(S!==-1){const N=`${b}:${S}`;y.inputNames[w]=N}}y.inputs.push(v),v.children.push(y)})}),Object.keys(d).length===0?p.forEach(g=>{const y=o[g];y.children.length===0&&u.push(y)}):Object.keys(d).forEach(g=>{const[y]=La(g),m=o[y];m!=null&&(m.signatureKey=d[g],u.push(m))}),Object.keys(c).length>0?Object.keys(c).forEach(g=>{const[y]=La(g),m=o[y];m&&(m.signatureKey=c[g],l.push(m))}):l=a;let h={};e.library!=null&&e.library.function!=null&&(h=e.library.function.reduce((g,y)=>(g[y.signature.name]=this.mapFunction(y),g),{}));const f={nodes:o,inputs:l,outputs:u,weights:r,placeholders:a,signature:n,functions:h};return i.length>0&&(f.initNodes=i),f}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,s)=>(n[e[s].name]=s,n),{})}mapNode(e){const n=XR(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(a=>a.startsWith("^")?a.slice(1):a),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((a,r)=>(a[r.name]={type:r.type,inputIndexStart:r.start,inputIndexEnd:r.end},a),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((a,r)=>{const i=r.type;let o;switch(r.type){case"string":o=tb(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=tb(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"string[]":o=lb(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=lb(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"number":o=sb(e.attr,r.tfName,r.defaultValue||0),o===void 0&&r.tfDeprecatedName&&(o=sb(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"number[]":o=ob(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=ob(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool":o=nb(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=nb(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool[]":o=cb(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=cb(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape":o=ib(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=ib(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape[]":o=ub(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=ub(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype":o=ab(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=ab(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype[]":o=rb(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=rb(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"func":o=FS(e.attr,r.tfName,r.defaultValue),o===void 0&&r.tfDeprecatedName&&(o=FS(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${r.type} for op: ${e.op}`)}return a[r.name]={value:o,type:i},a},{})),s}mapFunction(e){const n=e.nodeDef,s=[],a=[];let r={};n!=null&&(r=n.reduce((d,p)=>(d[p.name]=this.mapNode(p),p.op==="Const"&&a.push(d[p.name]),d),{}));const i=[],o=[];e.signature.inputArg.forEach(d=>{const[p]=La(d.name),h={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:J1(d.type),type:"dtype"}},children:[]};h.signatureKey=d.name,i.push(h),r[p]=h}),Object.keys(r).forEach(d=>{const p=r[d];p.inputNames.forEach((h,f)=>{const[g,,y]=La(h),m=r[g];if(m.outputs!=null){const w=m.outputs.indexOf(y);if(w!==-1){const b=`${g}:${w}`;p.inputNames[f]=b}}p.inputs.push(m),m.children.push(p)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[p,h]=La(u[d.name]),f=r[p];f!=null&&(f.defaultOutput=h,o.push(f))});const c=this.mapArgsToSignature(e);return{nodes:r,inputs:i,outputs:o,weights:a,placeholders:s,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:e.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,e.ret),n),{})}}mapArgToTensorInfo(e,n){let s=e.name;return n!=null&&(s=n[s]),{name:s,dtype:e.type}}}function dK(t){const e=V().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function YR(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):dK(t);return e?n:n.toLowerCase()}function tb(t,e,n,s=!1){const a=t[e];return a!=null?YR(a.s,s):n}function nb(t,e,n){const s=t[e];return s?s.b:n}function sb(t,e,n){const s=t[e]||{},a=s.i!=null?s.i:s.f!=null?s.f:n;return typeof a=="number"?a:parseInt(a,10)}function J1(t){switch(typeof t=="string"&&(t=Mn[t]),t){case Mn.DT_FLOAT:case Mn.DT_HALF:return"float32";case Mn.DT_INT32:case Mn.DT_INT64:case Mn.DT_INT8:case Mn.DT_UINT8:return"int32";case Mn.DT_BOOL:return"bool";case Mn.DT_DOUBLE:return"float32";case Mn.DT_STRING:return"string";case Mn.DT_COMPLEX64:case Mn.DT_COMPLEX128:return"complex64";default:return null}}function FS(t,e,n){const s=t[e];return s&&s.func?s.func.name:n}function ab(t,e,n){const s=t[e];return s&&s.type?J1(s.type):n}function rb(t,e,n){const s=t[e];return s&&s.list&&s.list.type?s.list.type.map(a=>J1(a)):n}function QR(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function ib(t,e,n){const s=t[e];return s&&s.shape?QR(s.shape):n}function ob(t,e,n){const s=t[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):n}function lb(t,e,n,s=!1){const a=t[e];return a&&a.list&&a.list.s?a.list.s.map(r=>YR(r,s)):n}function ub(t,e,n){const s=t[e];return s&&s.list&&s.list.shape?s.list.shape.map(a=>QR(a)):n}function cb(t,e,n){const s=t[e];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pK{constructor(e,n,s){this.node=e,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(a=>this.getInput(a)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((a,r)=>(a[r]=this.getAttr(r),a),{}))}getInput(e){return Jt(e,this.tensorMap,this.context)}getAttr(e,n){const s=this.node.rawAttrs[e];if(s.tensor!=null)return Jt(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return sb(this.node.rawAttrs,e,n);if(s.s!=null)return tb(this.node.rawAttrs,e,n);if(s.b!=null)return nb(this.node.rawAttrs,e,n);if(s.shape!=null)return ib(this.node.rawAttrs,e,n);if(s.type!=null)return ab(this.node.rawAttrs,e,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return ob(this.node.rawAttrs,e,n);if(s.list.s!=null)return lb(this.node.rawAttrs,e,n);if(s.list.shape!=null)return ub(this.node.rawAttrs,e,n);if(s.list.b!=null)return cb(this.node.rawAttrs,e,n);if(s.list.type!=null)return rb(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:Ex,abs:Ct,acos:jx,acosh:Px,add:Z,addN:B$,all:Tg,any:Xc,argMax:Qi,argMin:Lx,asin:zx,asinh:Bx,atan:Mx,atan2:Vx,atanh:Wx,avgPool:xp,avgPool3d:Gx,basicLSTMCell:M$,batchNorm:Iu,batchNorm2d:Hx,batchNorm3d:Kx,batchNorm4d:qx,batchToSpaceND:kp,bincount:Jx,bitwiseAnd:V$,booleanMaskAsync:$T,broadcastArgs:W$,broadcastTo:zi,buffer:Se,cast:re,ceil:Xx,clipByValue:_n,clone:ka,complex:Ya,concat:xt,concat1d:Yx,concat2d:Qx,concat3d:Zx,concat4d:ek,conv1d:Eg,conv2d:Qa,conv2dTranspose:Ag,conv3d:nk,conv3dTranspose:sk,cos:vp,cosh:Rg,cosineWindow:t0,cumprod:Zc,cumsum:Dg,denseBincount:Rf,depthToSpace:ak,depthwiseConv2d:$u,diag:G$,dilation2d:rk,div:ge,divNoNan:ik,dot:ok,dropout:Mk,einsum:Ci,elu:Tu,enclosingPowerOfTwo:Vk,ensureShape:H$,equal:Os,erf:_g,euclideanNorm:uk,exp:On,expandDims:on,expm1:ck,eye:Og,fft:Fp,fill:bo,floor:Au,floorDiv:$g,fused:jT,gather:Ru,gatherND:RT,greater:zn,greaterEqual:ir,ifft:kl,imag:Sp,image:qs,inTopKAsync:DT,irfft:Jg,isFinite:dk,isInf:pk,isNaN:hk,leakyRelu:Np,less:yl,lessEqual:ui,linalg:Gk,linspace:J$,localResponseNormalization:fk,log:Xn,log1p:Cp,logSigmoid:mk,logSoftmax:jg,logSumExp:Ip,logicalAnd:na,logicalNot:$p,logicalOr:Pg,logicalXor:gk,losses:WT,lowerBound:Y$,matMul:$e,max:ds,maxPool:Tp,maxPool3d:yk,maxPoolWithArgmax:Q$,maximum:Ra,mean:ct,meshgrid:Z$,min:gl,minimum:Kr,mirrorPad:wk,mod:bk,moments:Ep,movingAverage:TT,mul:_,multiRNNCell:eT,multinomial:tT,neg:Ye,norm:Eu,notEqual:to,oneHot:wl,ones:Tn,onesLike:Yn,op:D,outerProduct:nT,pad:or,pad1d:sT,pad2d:aT,pad3d:rT,pad4d:iT,pool:xk,pow:$a,prelu:Rp,print:Fx,prod:kk,raggedGather:oT,raggedRange:lT,raggedTensorToTensor:uT,rand:cT,randomGamma:fT,randomNormal:Bg,randomStandardNormal:mT,randomUniform:ci,randomUniformInt:gT,range:no,real:bl,reciprocal:Rk,relu:la,relu6:Mg,reshape:F,reverse:hs,reverse1d:yT,reverse2d:wT,reverse3d:bT,reverse4d:xT,rfft:jp,round:Vg,rsqrt:Wg,scalar:we,scatterND:ET,searchSorted:Lg,selu:Ug,separableConv2d:Gg,setdiff1dAsync:kT,sigmoid:Zs,sign:Dk,signal:VT,sin:Hg,sinh:Kg,slice:_e,slice1d:Dp,slice2d:qg,slice3d:_p,slice4d:xl,softmax:Op,softplus:xo,spaceToBatchND:Ap,sparse:UT,sparseToDense:AT,spectral:MT,split:An,sqrt:Ut,square:Ue,squaredDifference:Xg,squeeze:di,stack:Fn,step:vo,stridedSlice:_k,string:GT,sub:ce,sum:pe,tan:Ok,tanh:Hr,tensor:Rs,tensor1d:ln,tensor2d:sl,tensor3d:Fk,tensor4d:vT,tensor5d:ST,tensor6d:NT,tensorScatterUpdate:CT,tile:os,topk:Pk,transpose:De,truncatedNormal:Qg,unique:Lk,unsortedSegmentSum:Zg,unstack:fs,upperBound:IT,variable:zk,where:Qt,whereAsync:Bk,zeros:$t,zerosLike:Oe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hK=(t,e,n,s=sn)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(k("a",t,e,n),k("b",t,e,n))];case"AddN":return[s.addN(k("tensors",t,e,n))];case"FloorMod":case"Mod":return[s.mod(k("a",t,e,n),k("b",t,e,n))];case"Mul":return[s.mul(k("a",t,e,n),k("b",t,e,n))];case"RealDiv":case"Div":return[s.div(k("a",t,e,n),k("b",t,e,n))];case"DivNoNan":return[s.divNoNan(k("a",t,e,n),k("b",t,e,n))];case"FloorDiv":return[s.floorDiv(k("a",t,e,n),k("b",t,e,n))];case"Sub":return[s.sub(k("a",t,e,n),k("b",t,e,n))];case"Minimum":return[s.minimum(k("a",t,e,n),k("b",t,e,n))];case"Maximum":return[s.maximum(k("a",t,e,n),k("b",t,e,n))];case"Pow":return[s.pow(k("a",t,e,n),k("b",t,e,n))];case"SquaredDifference":return[s.squaredDifference(k("a",t,e,n),k("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fK=(t,e,n,s=sn)=>{switch(t.op){case"Abs":case"ComplexAbs":return[s.abs(k("x",t,e,n))];case"Acos":return[s.acos(k("x",t,e,n))];case"Acosh":return[s.acosh(k("x",t,e,n))];case"Asin":return[s.asin(k("x",t,e,n))];case"Asinh":return[s.asinh(k("x",t,e,n))];case"Atan":return[s.atan(k("x",t,e,n))];case"Atan2":return[s.atan2(k("x",t,e,n),k("y",t,e,n))];case"Atanh":return[s.atanh(k("x",t,e,n))];case"Ceil":return[s.ceil(k("x",t,e,n))];case"Complex":return[s.complex(k("real",t,e,n),k("imag",t,e,n))];case"Cos":return[s.cos(k("x",t,e,n))];case"Cosh":return[s.cosh(k("x",t,e,n))];case"Elu":return[s.elu(k("x",t,e,n))];case"Erf":return[s.erf(k("x",t,e,n))];case"Exp":return[s.exp(k("x",t,e,n))];case"Expm1":return[s.expm1(k("x",t,e,n))];case"Floor":return[s.floor(k("x",t,e,n))];case"Log":return[s.log(k("x",t,e,n))];case"Log1p":return[s.log1p(k("x",t,e,n))];case"Imag":return[s.imag(k("x",t,e,n))];case"Neg":return[s.neg(k("x",t,e,n))];case"Reciprocal":return[s.reciprocal(k("x",t,e,n))];case"Real":return[s.real(k("x",t,e,n))];case"Relu":return[s.relu(k("x",t,e,n))];case"Round":return[s.round(k("x",t,e,n))];case"Selu":return[s.selu(k("x",t,e,n))];case"Sigmoid":return[s.sigmoid(k("x",t,e,n))];case"Sin":return[s.sin(k("x",t,e,n))];case"Sign":return[s.sign(k("x",t,e,n))];case"Sinh":return[s.sinh(k("x",t,e,n))];case"Softplus":return[s.softplus(k("x",t,e,n))];case"Sqrt":return[s.sqrt(k("x",t,e,n))];case"Square":return[s.square(k("x",t,e,n))];case"Tanh":return[s.tanh(k("x",t,e,n))];case"Tan":return[s.tan(k("x",t,e,n))];case"ClipByValue":return[s.clipByValue(k("x",t,e,n),k("clipValueMin",t,e,n),k("clipValueMax",t,e,n))];case"Relu6":return[s.relu6(k("x",t,e,n))];case"Rsqrt":return[s.rsqrt(Jt(t.inputNames[0],e,n))];case"LeakyRelu":return[s.leakyRelu(k("x",t,e,n),k("alpha",t,e,n))];case"Prelu":return[s.prelu(k("x",t,e,n),k("alpha",t,e,n))];case"IsNan":return[s.isNaN(Jt(t.inputNames[0],e,n))];case"IsInf":return[s.isInf(Jt(t.inputNames[0],e,n))];case"IsFinite":return[s.isFinite(Jt(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ks(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){C(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let s=0;s<t.length;s++){const a=t[s],r=e[s];C(a<0||r<0||a===r,()=>n+` Shapes ${t} and ${e} must match`)}}}function jS(t){return!(typeof t=="number"||t.some(e=>e<0))}function ec(t,e,n){let s=db(t,n);const a=!jS(s);if(a&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(a&&e.forEach(r=>{s=db(r.shape,s)}),!jS(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function db(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let s=0;s<t.length;++s){const a=t[s],r=e[s];if(a>=0&&r>=0&&a!==r)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[s]=a>=0?a:r}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mK{constructor(e,n,s,a,r,i,o){this.name=e,this.dtype=n,this.maxSize=s,this.elementShape=a,this.identicalElementShapes=r,this.dynamicSize=i,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=we(0),Rt(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),ks(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=n,Rt(n),s.written=!0,this.tensors[e]=s}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((s,a)=>this.write(s,n[a]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let a=0;a<this.size();a++)e.push(a)}if(e.length===0)return Rs([],[0].concat(this.elementShape));const s=this.readMany(e);return ks(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),Fn(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Rs([],[0].concat(this.elementShape));const n=[];for(let a=0;a<this.size();a++)n.push(a);const s=this.readMany(n);return ks(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),xt(s,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,fs(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const a=e.map(l=>(s+=l,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const r=s===0?0:n.size/s,i=[];B(()=>{n=F(n,[1,s,r]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:a[l-1],0],d=[1,e[l],r];i[l]=F(_e(n,c,d),this.elementShape)}return i});const o=[];for(let l=0;l<e.length;l++)o[l]=l;this.writeMany(o,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ro{get id(){return this.idTensor.id}constructor(e,n,s,a=-1){this.tensors=e,this.elementShape=n,this.elementDtype=s,e!=null&&e.forEach(r=>{if(s!==r.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${r.dtype}`);ks(n,r.shape,"TensorList shape mismatch: "),Rt(r)}),this.idTensor=we(0),this.maxNumElements=a,Rt(this.idTensor)}copy(){return new ro([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);ks(e,this.elementShape,"TensorList shape mismatch: ");const a=ec(this.elementShape,this.tensors,e);return B(()=>{const r=this.tensors.map(i=>F(i,a));return Fn(r,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=ec(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,ks(a.shape,e,"TensorList shape mismatch: "),F(a,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(ks(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Rt(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new ro([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)n.tensors[s]=this.tensors[s];return n}getItem(e,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);ks(this.tensors[e].shape,n,"TensorList shape mismatch: ");const a=ec(this.elementShape,this.tensors,n);return F(this.tensors[e],a)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);ks(this.elementShape,n.shape,"TensorList shape mismatch: "),Rt(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);ks(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const a=ec(this.elementShape,this.tensors,s);return e.length===0?Rs([],[0].concat(a)):B(()=>{const r=e.map(i=>F(this.tensors[i],a));return Fn(r,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);ks(this.elementShape,n,"TensorList shape mismatch: ");const s=ec(this.elementShape,this.tensors,n);return this.size()===0?Rs([],[0].concat(s)):B(()=>{const a=this.tensors.map(r=>F(r,s));return xt(a,0)})}}function gK(t,e,n){const s=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const a=t.shape.slice(1);ks(a,e,"TensorList shape mismatch: ");const r=fs(t);return new ro(r,e,s)}function yK(t,e,n,s){return new ro([],t,e,s)}function wK(t,e,n,s){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const a=Math.max(...e);if(s!=null&&s!==-1&&a>=s)throw new Error(`Max index must be < array size (${a}  vs. ${s})`);const r=new ro([],n,t.dtype,s),i=fs(t,0);return e.forEach((o,l)=>{r.setItem(o,i[l])}),r}function bK(t,e,n){let s=0;const a=e.map(c=>(s+=c,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);const r=t.shape.slice(1),i=db(r,n),o=s===0?0:t.size/s,l=B(()=>{const c=[];t=F(t,[1,s,o]);for(let d=0;d<e.length;++d){const h=[0,d===0?0:a[d-1],0],f=[1,e[d],o];c[d]=F(_e(t,h,f),i)}return t.dispose(),c}),u=new ro([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xK=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const s=k("thenBranch",t,e,n),a=k("elseBranch",t,e,n),r=k("cond",t,e,n),i=k("args",t,e,n);return(await r.data())[0]?n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=k("body",t,e,n),a=k("cond",t,e,n),r=k("args",t,e,n),i=await n.functionMap[a].executeFunctionAsync(r,n.tensorArrayMap,n.tensorListMap),o=r.map(c=>c.id);let l=await i[0].data();i.forEach(c=>{!c.kept&&o.indexOf(c.id)===-1&&c.dispose()});let u=r;for(;l[0];){const c=u;u=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(h=>h.id);c.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()});const p=await n.functionMap[a].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(h=>{!h.kept&&o.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()})}return u}case"LoopCond":{const s=k("pred",t,e,n);return[za(s)]}case"Switch":{const s=k("pred",t,e,n);let a=k("data",t,e,n);return a.kept||(a=za(a)),(await s.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const s=t.inputNames.find(a=>Jt(a,e,n)!==void 0);if(s){const a=Jt(s,e,n);return[za(a)]}return}case"Enter":{const s=k("frameName",t,e,n),a=k("tensor",t,e,n);return n.enterFrame(s),[za(a)]}case"Exit":{const s=k("tensor",t,e,n);return n.exitFrame(),[za(s)]}case"NextIteration":{const s=k("tensor",t,e,n);return n.nextIteration(),[za(s)]}case"TensorArrayV3":{const s=k("size",t,e,n),a=k("dtype",t,e,n),r=k("elementShape",t,e,n),i=k("dynamicSize",t,e,n),o=k("clearAfterRead",t,e,n),l=k("identicalElementShapes",t,e,n),u=k("name",t,e,n),c=new mK(u,a,s,r,l,i,o);return n.addTensorArray(c),[c.idTensor,we(1)]}case"TensorArrayWriteV3":{const s=k("tensorArrayId",t,e,n),a=k("index",t,e,n),r=k("tensor",t,e,n),i=n.getTensorArray(s.id);return i.write(a,r),[i.idTensor]}case"TensorArrayReadV3":{const s=k("tensorArrayId",t,e,n),a=k("index",t,e,n);return[n.getTensorArray(s.id).read(a)]}case"TensorArrayGatherV3":{const s=k("tensorArrayId",t,e,n),a=k("indices",t,e,n),r=k("dtype",t,e,n);return[n.getTensorArray(s.id).gather(a,r)]}case"TensorArrayScatterV3":{const s=k("tensorArrayId",t,e,n),a=k("indices",t,e,n),r=k("tensor",t,e,n),i=n.getTensorArray(s.id);return i.scatter(a,r),[i.idTensor]}case"TensorArrayConcatV3":{const s=k("tensorArrayId",t,e,n),a=n.getTensorArray(s.id),r=k("dtype",t,e,n);return[a.concat(r)]}case"TensorArraySplitV3":{const s=k("tensorArrayId",t,e,n),a=k("tensor",t,e,n),r=k("lengths",t,e,n),i=n.getTensorArray(s.id);return i.split(r,a),[i.idTensor]}case"TensorArraySizeV3":{const s=k("tensorArrayId",t,e,n),a=n.getTensorArray(s.id);return[we(a.size(),"int32")]}case"TensorArrayCloseV3":{const s=k("tensorArrayId",t,e,n),a=n.getTensorArray(s.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const s=k("tensorListId",t,e,n),a=k("index",t,e,n),r=k("tensor",t,e,n),i=n.getTensorList(s.id);return i.setItem(a,r),[i.idTensor]}case"TensorListGetItem":{const s=k("tensorListId",t,e,n),a=k("index",t,e,n),r=k("elementShape",t,e,n),i=k("elementDType",t,e,n);return[n.getTensorList(s.id).getItem(a,r,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=k("indices",t,e,n),a=k("tensor",t,e,n),r=k("elementShape",t,e,n),i=k("numElements",t,e,n),o=wK(a,s,r,i);return n.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=k("elementShape",t,e,n),a=k("elementDType",t,e,n);let r;t.op==="TensorListReserve"?r="numElements":r="maxNumElements";const i=k(r,t,e,n),o=t.op==="TensorListReserve"?-1:i,l=yK(s,a,i,o);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=k("tensorListId",t,e,n),a=k("indices",t,e,n),r=k("elementShape",t,e,n),i=k("elementDType",t,e,n);return[n.getTensorList(s.id).gather(a,i,r)]}case"TensorListStack":{const s=k("tensorListId",t,e,n),a=k("elementShape",t,e,n),r=k("elementDType",t,e,n),i=k("numElements",t,e,n);return[n.getTensorList(s.id).stack(a,r,i)]}case"TensorListFromTensor":{const s=k("tensor",t,e,n),a=k("elementShape",t,e,n),r=k("elementDType",t,e,n),i=gK(s,a,r);return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=k("tensorListId",t,e,n),a=n.getTensorList(s.id),r=k("dtype",t,e,n),i=k("elementShape",t,e,n);return[a.concat(r,i)]}case"TensorListPushBack":{const s=k("tensorListId",t,e,n),a=k("tensor",t,e,n),r=n.getTensorList(s.id);return r.pushBack(a),[r.idTensor]}case"TensorListPopBack":{const s=k("tensorListId",t,e,n),a=k("elementShape",t,e,n),r=k("elementDType",t,e,n);return[n.getTensorList(s.id).popBack(a,r)]}case"TensorListSplit":{const s=k("tensor",t,e,n),a=k("elementShape",t,e,n),r=k("lengths",t,e,n),i=bK(s,r,a);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=k("tensorListId",t,e,n),a=n.getTensorList(s.id);return[we(a.size(),"int32")]}case"TensorListResize":{const s=k("tensorListId",t,e,n),a=k("size",t,e,n),i=n.getTensorList(s.id).resize(a);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PS(t,e,n){const[s,a]=k("fusedOps",t,e,n),r=s==="biasadd",i=!r,o=a==="prelu",l=s==="fusedbatchnorm",u=k("numArgs",t,e,n);if(r){if(o&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&r&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=k("strides",t,e,n),d=Kh(t,e,n),p=k("dataFormat",t,e,n).toUpperCase(),h=k("dilations",t,e,n);let[f,g]=k("args",t,e,n);i&&(g=f,f=void 0);const y=k("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:p,dilations:h,biasArg:f,preluArg:g,activationFunc:a,leakyreluAlpha:y}}const kK=(t,e,n,s=sn)=>{switch(t.op){case"Conv1D":{const a=k("stride",t,e,n),r=k("pad",t,e,n),i=k("dataFormat",t,e,n).toUpperCase(),o=k("dilation",t,e,n);return[s.conv1d(k("x",t,e,n),k("filter",t,e,n),a,r,i,o)]}case"Conv2D":{const a=k("strides",t,e,n),r=Kh(t,e,n),i=k("dataFormat",t,e,n).toUpperCase(),o=k("dilations",t,e,n);return[s.conv2d(k("x",t,e,n),k("filter",t,e,n),[a[1],a[2]],r,i,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:a,pad:r,dataFormat:i,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=PS(t,e,n);return[s.fused.conv2d({x:k("x",t,e,n),filter:k("filter",t,e,n),strides:[a[1],a[2]],pad:r,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:r,dataFormat:i,dilations:o,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=PS(t,e,n);return[s.fused.depthwiseConv2d({x:k("x",t,e,n),filter:k("filter",t,e,n),strides:[a[1],a[2]],pad:r,dataFormat:i,dilations:[o[1],o[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=k("outputShape",t,e,n),r=k("strides",t,e,n),i=Kh(t,e,n);return[s.conv2dTranspose(k("x",t,e,n),k("filter",t,e,n),a,[r[1],r[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=k("strides",t,e,n),r=Kh(t,e,n),i=k("dilations",t,e,n),o=k("dataFormat",t,e,n).toUpperCase();return[s.depthwiseConv2d(k("input",t,e,n),k("filter",t,e,n),[a[1],a[2]],r,o,[i[1],i[2]])]}case"Conv3D":{const a=k("strides",t,e,n),r=k("pad",t,e,n),i=k("dataFormat",t,e,n).toUpperCase(),o=k("dilations",t,e,n);return[s.conv3d(k("x",t,e,n),k("filter",t,e,n),[a[1],a[2],a[3]],r,i,[o[1],o[2],o[3]])]}case"AvgPool":{const a=k("strides",t,e,n),r=k("pad",t,e,n),i=k("kernelSize",t,e,n);return[s.avgPool(k("x",t,e,n),[i[1],i[2]],[a[1],a[2]],r)]}case"MaxPool":{const a=k("strides",t,e,n),r=k("pad",t,e,n),i=k("kernelSize",t,e,n);return[s.maxPool(k("x",t,e,n),[i[1],i[2]],[a[1],a[2]],r)]}case"MaxPoolWithArgmax":{const a=k("strides",t,e,n),r=k("pad",t,e,n),i=k("kernelSize",t,e,n),o=k("includeBatchInIndex",t,e,n),{result:l,indexes:u}=s.maxPoolWithArgmax(k("x",t,e,n),[i[1],i[2]],[a[1],a[2]],r,o);return[l,u]}case"AvgPool3D":{const a=k("strides",t,e,n),r=k("pad",t,e,n),i=k("kernelSize",t,e,n);return[s.avgPool3d(k("x",t,e,n),[i[1],i[2],i[3]],[a[1],a[2],a[3]],r)]}case"MaxPool3D":{const a=k("strides",t,e,n),r=k("pad",t,e,n),i=k("kernelSize",t,e,n);return[s.maxPool3d(k("x",t,e,n),[i[1],i[2],i[3]],[a[1],a[2],a[3]],r)]}case"Dilation2D":{const a=k("strides",t,e,n),r=k("pad",t,e,n),i=k("dilations",t,e,n),o=a[1],l=a[2],u=i[1],c=i[2];return[s.dilation2d(k("x",t,e,n),k("filter",t,e,n),[o,l],r,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vK=(t,e,n,s=sn)=>{switch(t.op){case"Fill":{const a=k("shape",t,e,n),r=k("dtype",t,e,n),i=k("value",t,e,n);return[s.fill(a,i,r)]}case"LinSpace":{const a=k("start",t,e,n),r=k("stop",t,e,n),i=k("num",t,e,n);return[s.linspace(a,r,i)]}case"Multinomial":{const a=k("logits",t,e,n),r=k("numSamples",t,e,n),i=k("seed",t,e,n);return[s.multinomial(a,r,i)]}case"OneHot":{const a=k("indices",t,e,n),r=k("depth",t,e,n),i=k("onValue",t,e,n),o=k("offValue",t,e,n),l=k("dtype",t,e,n);return[s.oneHot(a,r,i,o,l)]}case"Ones":return[s.ones(k("shape",t,e,n),k("dtype",t,e,n))];case"OnesLike":return[s.onesLike(k("x",t,e,n))];case"RandomStandardNormal":return[s.randomStandardNormal(k("shape",t,e,n),k("dtype",t,e,n),k("seed",t,e,n))];case"RandomUniform":return[s.randomUniform(k("shape",t,e,n),k("minval",t,e,n),k("maxval",t,e,n),k("dtype",t,e,n))];case"RandomUniformInt":return[s.randomUniformInt(k("shape",t,e,n),k("minval",t,e,n),k("maxval",t,e,n),k("seed",t,e,n))];case"Range":{const a=k("start",t,e,n),r=k("stop",t,e,n),i=k("step",t,e,n);return[s.range(a,r,i,k("dtype",t,e,n))]}case"TruncatedNormal":{const a=k("shape",t,e,n),r=k("mean",t,e,n),i=k("stdDev",t,e,n),o=k("seed",t,e,n);return[s.truncatedNormal(a,r,i,k("dtype",t,e,n),o)]}case"Zeros":return[s.zeros(k("shape",t,e,n),k("dtype",t,e,n))];case"ZerosLike":return[s.zerosLike(k("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function by(t,e,n){const s=k("boxes",t,e,n),a=k("scores",t,e,n),r=k("maxOutputSize",t,e,n),i=k("iouThreshold",t,e,n),o=k("scoreThreshold",t,e,n),l=k("softNmsSigma",t,e,n);return{boxes:s,scores:a,maxOutputSize:r,iouThreshold:i,scoreThreshold:o,softNmsSigma:l}}const SK=async(t,e,n,s,a=sn)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=by(t,e,n),d=await a.image.nonMaxSuppressionWithScoreAsync(r,i,o,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=by(t,e,n),c=k("padToMaxOutputSize",t,e,n),d=await a.image.nonMaxSuppressionPaddedAsync(r,i,o,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=by(t,e,n);return[await a.image.nonMaxSuppressionAsync(r,i,o,l,u)]}case"Where":{const r=a.cast(k("condition",t,e,n),"bool"),i=[await a.whereAsync(r)];return r.dispose(),i}case"ListDiff":return a.setdiff1dAsync(k("x",t,e,n),k("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NK=(t,e,n,s=sn)=>{switch(t.op){case"LowerBound":{const a=k("sortedSequence",t,e,n),r=k("values",t,e,n);return[s.lowerBound(a,r)]}case"TopKV2":{const a=k("x",t,e,n),r=k("k",t,e,n),i=k("sorted",t,e,n),o=s.topk(a,r,i);return[o.values,o.indices]}case"UpperBound":{const a=k("sortedSequence",t,e,n),r=k("values",t,e,n);return[s.upperBound(a,r)]}case"Unique":{const a=k("x",t,e,n),r=s.unique(a);return[r.values,r.indices]}case"UniqueV2":{const a=k("x",t,e,n),r=k("axis",t,e,n),i=s.unique(a,r);return[i.values,i.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CK=(t,e,n,s=sn)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const a=k("default",t,e,n);return[Jt(t.name,e,n)||a];case"Placeholder":return[Jt(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=k("x",t,e,n);return[za(c)]}case"IdentityN":return k("x",t,e,n).map(c=>za(c));case"Snapshot":const r=k("x",t,e,n);return[za(r)];case"Shape":return[s.tensor1d(k("x",t,e,n).shape,"int32")];case"ShapeN":return k("x",t,e,n).map(c=>s.tensor1d(c.shape));case"Size":return[s.scalar(k("x",t,e,n).size,"int32")];case"Rank":return[s.scalar(k("x",t,e,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=k("x",t,e,n),o=k("data",t,e,n),l=k("message",t,e,n),u=k("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,u));return[i];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IK{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=we(0),this.tensorMap=new Map,Rt(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return we(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return this.tensorMap.forEach(a=>a.dispose()),this.tensorMap.clear(),B(()=>{const a=fs(n),r=s.length,i=a.length;C(r===i,()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${i} elements.`);for(let o=0;o<r;o++){const l=s[o],u=a[o];Rt(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return B(()=>{const a=[];for(let r=0;r<s.length;r++){const i=s[r],o=this.findWithDefault(i,n);a.push(o)}return Fn(a)})}findWithDefault(e,n){const s=this.tensorMap.get(e);return s??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $K=async(t,e,n,s)=>{switch(t.op){case"HashTable":case"HashTableV2":{const a=s.getHashTableHandleByName(t.name);if(a!=null)return[a];{const r=k("keyDType",t,e,n),i=k("valueDType",t,e,n),o=new IK(r,i);return s.addHashTable(t.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const a=k("tableHandle",t,e,n,s),r=k("keys",t,e,n),i=k("values",t,e,n);return[await s.getHashTableById(a.id).import(r,i)]}case"LookupTableFind":case"LookupTableFindV2":{const a=k("tableHandle",t,e,n,s),r=k("keys",t,e,n),i=k("defaultValue",t,e,n);return[await s.getHashTableById(a.id).find(r,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=k("tableHandle",t,e,n,s);return[s.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TK=(t,e,n,s=sn)=>{switch(t.op){case"ResizeBilinear":{const a=k("images",t,e,n),r=k("size",t,e,n),i=k("alignCorners",t,e,n),o=k("halfPixelCenters",t,e,n);return[s.image.resizeBilinear(a,[r[0],r[1]],i,o)]}case"ResizeNearestNeighbor":{const a=k("images",t,e,n),r=k("size",t,e,n),i=k("alignCorners",t,e,n),o=k("halfPixelCenters",t,e,n);return[s.image.resizeNearestNeighbor(a,[r[0],r[1]],i,o)]}case"CropAndResize":{const a=k("image",t,e,n),r=k("boxes",t,e,n),i=k("boxInd",t,e,n),o=k("cropSize",t,e,n),l=k("method",t,e,n),u=k("extrapolationValue",t,e,n);return[s.image.cropAndResize(a,r,i,o,l,u)]}case"ImageProjectiveTransformV3":{const a=k("images",t,e,n),r=k("transforms",t,e,n),i=k("outputShape",t,e,n),o=k("fillValue",t,e,n),l=k("interpolation",t,e,n),u=k("fillMode",t,e,n);return[s.image.transform(a,r,l.toLowerCase(),u.toLowerCase(),o,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EK=(t,e,n,s=sn)=>{switch(t.op){case"Equal":return[s.equal(k("a",t,e,n),k("b",t,e,n))];case"NotEqual":return[s.notEqual(k("a",t,e,n),k("b",t,e,n))];case"Greater":return[s.greater(k("a",t,e,n),k("b",t,e,n))];case"GreaterEqual":return[s.greaterEqual(k("a",t,e,n),k("b",t,e,n))];case"Less":return[s.less(k("a",t,e,n),k("b",t,e,n))];case"LessEqual":return[s.lessEqual(k("a",t,e,n),k("b",t,e,n))];case"LogicalAnd":return[s.logicalAnd(k("a",t,e,n),k("b",t,e,n))];case"LogicalNot":return[s.logicalNot(k("a",t,e,n))];case"LogicalOr":return[s.logicalOr(k("a",t,e,n),k("b",t,e,n))];case"Select":case"SelectV2":return[s.where(k("condition",t,e,n),k("a",t,e,n),k("b",t,e,n))];case"BitwiseAnd":return[s.bitwiseAnd(k("a",t,e,n),k("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AK=(t,e,n,s=sn)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(k("a",t,e,n),k("b",t,e,n),k("transposeA",t,e,n),k("transposeB",t,e,n))];case"Einsum":return[s.einsum(k("equation",t,e,n),...k("tensors",t,e,n))];case"Transpose":return[s.transpose(k("x",t,e,n),k("perm",t,e,n))];case"_FusedMatMul":const[a,r]=k("fusedOps",t,e,n),i=a==="biasadd",o=r==="prelu",l=k("numArgs",t,e,n),u=k("leakyreluAlpha",t,e,n);if(i){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=k("args",t,e,n);return[s.fused.matMul({a:k("a",t,e,n),b:k("b",t,e,n),transposeA:k("transposeA",t,e,n),transposeB:k("transposeB",t,e,n),bias:c,activation:r,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[s.linalg.bandPart(k("a",t,e,n),k("numLower",t,e,n),k("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RK=(t,e,n,s=sn)=>{switch(t.op){case"EuclideanNorm":return[s.euclideanNorm(k("x",t,e,n),k("axis",t,e,n),k("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(k("x",t,e,n),k("mean",t,e,n),k("variance",t,e,n),k("offset",t,e,n),k("scale",t,e,n),k("epsilon",t,e,n))];case"FusedBatchNormV3":return[s.batchNorm(k("x",t,e,n),k("mean",t,e,n),k("variance",t,e,n),k("offset",t,e,n),k("scale",t,e,n),k("epsilon",t,e,n))];case"LRN":return[s.localResponseNormalization(k("x",t,e,n),k("radius",t,e,n),k("bias",t,e,n),k("alpha",t,e,n),k("beta",t,e,n))];case"Softmax":return[s.softmax(k("x",t,e,n))];case"LogSoftmax":return[s.logSoftmax(k("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DK=(t,e,n,s=sn)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:a,outputDenseValues:r}=s.raggedGather(k("paramsNestedSplits",t,e,n),k("paramsDenseValues",t,e,n),k("indices",t,e,n),k("outputRaggedRank",t,e,n));return a.concat(r)}case"RaggedRange":{const{rtNestedSplits:a,rtDenseValues:r}=s.raggedRange(k("starts",t,e,n),k("limits",t,e,n),k("splits",t,e,n));return[a,r]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(k("shape",t,e,n),k("values",t,e,n),k("defaultValue",t,e,n),k("rowPartitionTensors",t,e,n),k("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _K=(t,e,n,s=sn)=>{switch(t.op){case"Max":{const o=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.max(k("x",t,e,n),o,l)]}case"Mean":{const o=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.mean(k("x",t,e,n),o,l)]}case"Min":{const o=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.min(k("x",t,e,n),o,l)]}case"Sum":{const o=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.sum(k("x",t,e,n),o,l)]}case"All":{const o=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.all(k("x",t,e,n),o,l)]}case"Any":{const o=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.any(k("x",t,e,n),o,l)]}case"ArgMax":{const o=k("axis",t,e,n);return[s.argMax(k("x",t,e,n),o)]}case"ArgMin":{const o=k("axis",t,e,n);return[s.argMin(k("x",t,e,n),o)]}case"Prod":{const o=k("axis",t,e,n),l=k("keepDims",t,e,n);return[s.prod(k("x",t,e,n),o,l)]}case"Cumprod":{const o=k("axis",t,e,n),l=k("exclusive",t,e,n),u=k("reverse",t,e,n);return[s.cumprod(k("x",t,e,n),o,l,u)]}case"Cumsum":{const o=k("axis",t,e,n),l=k("exclusive",t,e,n),u=k("reverse",t,e,n);return[s.cumsum(k("x",t,e,n),o,l,u)]}case"Bincount":const a=k("x",t,e,n),r=k("weights",t,e,n),i=k("size",t,e,n);return[s.bincount(a,r,i)];case"DenseBincount":{const o=k("x",t,e,n),l=k("weights",t,e,n),u=k("size",t,e,n),c=k("binaryOutput",t,e,n);return[s.denseBincount(o,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OK=(t,e,n,s=sn)=>{switch(t.op){case"ConcatV2":case"Concat":{const a=k("n",t,e,n),r=k("axis",t,e,n);let i=k("tensors",t,e,n);return i=i.slice(0,a),[s.concat(i,r)]}case"Gather":{const a=k("x",t,e,n),r=k("indices",t,e,n);return[s.gather(a,s.cast(r,"int32"),0)]}case"GatherV2":{const a=k("axis",t,e,n),r=k("batchDims",t,e,n),i=k("x",t,e,n),o=k("indices",t,e,n);return[s.gather(i,s.cast(o,"int32"),a,r)]}case"Reverse":{const a=k("dims",t,e,n),r=[];for(let o=0;o<a.length;o++)a[o]&&r.push(o);const i=k("x",t,e,n);return[s.reverse(i,r)]}case"ReverseV2":{const a=k("axis",t,e,n),r=k("x",t,e,n);return[s.reverse(r,a)]}case"Slice":{const a=k("begin",t,e,n),r=k("size",t,e,n);return[s.slice(k("x",t,e,n),a,r)]}case"StridedSlice":{const a=k("begin",t,e,n),r=k("end",t,e,n),i=k("strides",t,e,n),o=k("beginMask",t,e,n),l=k("endMask",t,e,n),u=k("ellipsisMask",t,e,n),c=k("newAxisMask",t,e,n),d=k("shrinkAxisMask",t,e,n),p=k("x",t,e,n);return[s.stridedSlice(p,a,r,i,o,l,u,c,d)]}case"Pack":return B(()=>{const a=k("axis",t,e,n),r=k("tensors",t,e,n),i=r[0].shape,o=s.squeeze(r[0]).shape,l=r.map(u=>{const c=Re(u.shape,i);if(!c&&!Re(s.squeeze(u).shape,o))throw new Error("the input tensors shape does not match");return c?u:s.reshape(u,i)});return[s.stack(l,a)]});case"Unpack":{const a=k("axis",t,e,n),r=k("tensor",t,e,n);return s.unstack(r,a)}case"Tile":{const a=k("reps",t,e,n);return[s.tile(k("x",t,e,n),a)]}case"Split":case"SplitV":{const a=k("axis",t,e,n),r=k("numOrSizeSplits",t,e,n),i=k("x",t,e,n);return s.split(i,r,a)}case"ScatterNd":{const a=k("indices",t,e,n),r=k("values",t,e,n),i=k("shape",t,e,n);return[s.scatterND(a,r,i)]}case"GatherNd":{const a=k("x",t,e,n),r=k("indices",t,e,n);return[s.gatherND(a,r)]}case"SparseToDense":{const a=k("sparseIndices",t,e,n),r=k("outputShape",t,e,n),i=k("sparseValues",t,e,n),o=k("defaultValue",t,e,n);return[s.sparseToDense(a,i,r,i.dtype===o.dtype?o:s.cast(o,i.dtype))]}case"TensorScatterUpdate":{const a=k("indices",t,e,n),r=k("values",t,e,n),i=k("tensor",t,e,n);return[s.tensorScatterUpdate(i,a,r)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FK=(t,e,n,s=sn)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:r,emptyRowIndicator:i,reverseIndexMap:o}=s.sparse.sparseFillEmptyRows(k("indices",t,e,n),k("values",t,e,n),k("denseShape",t,e,n),k("defaultValue",t,e,n));return[a,r,i,o]}case"SparseReshape":{const{outputIndices:a,outputShape:r}=s.sparse.sparseReshape(k("inputIndices",t,e,n),k("inputShape",t,e,n),k("newShape",t,e,n));return[a,r]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(k("data",t,e,n),k("indices",t,e,n),k("segmentIds",t,e,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(k("data",t,e,n),k("indices",t,e,n),k("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jK=(t,e,n,s=sn)=>{switch(t.op){case"FFT":return[s.fft(k("x",t,e,n))];case"IFFT":return[s.ifft(k("x",t,e,n))];case"RFFT":return[s.rfft(k("x",t,e,n))];case"IRFFT":return[s.irfft(k("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PK=(t,e,n,s=sn)=>{switch(t.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(k("input",t,e,n),k("pattern",t,e,n),k("rewrite",t,e,n),k("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:a,nGramsSplits:r}=s.string.stringNGrams(k("data",t,e,n),k("dataSplits",t,e,n),k("separator",t,e,n),k("nGramWidths",t,e,n),k("leftPad",t,e,n),k("rightPad",t,e,n),k("padWidth",t,e,n),k("preserveShortSequences",t,e,n));return[a,r]}case"StringSplit":{const{indices:a,values:r,shape:i}=s.string.stringSplit(k("input",t,e,n),k("delimiter",t,e,n),k("skipEmpty",t,e,n));return[a,r,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(k("input",t,e,n),k("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LK=(t,e,n,s=sn)=>{switch(t.op){case"Cast":return[s.cast(k("x",t,e,n),k("dtype",t,e,n))];case"ExpandDims":{const a=k("axis",t,e,n);return[s.expandDims(k("x",t,e,n),a)]}case"Squeeze":{const a=k("axis",t,e,n);return[s.squeeze(k("x",t,e,n),a)]}case"Reshape":return[s.reshape(k("x",t,e,n),k("shape",t,e,n))];case"EnsureShape":return[s.ensureShape(k("x",t,e,n),k("shape",t,e,n))];case"MirrorPad":return[s.mirrorPad(k("x",t,e,n),k("padding",t,e,n),k("mode",t,e,n))];case"PadV2":case"Pad":return[s.pad(k("x",t,e,n),k("padding",t,e,n),k("constantValue",t,e,n))];case"SpaceToBatchND":{const a=k("blockShape",t,e,n),r=k("paddings",t,e,n);return[s.spaceToBatchND(k("x",t,e,n),a,r)]}case"BatchToSpaceND":{const a=k("blockShape",t,e,n),r=k("crops",t,e,n);return[s.batchToSpaceND(k("x",t,e,n),a,r)]}case"DepthToSpace":{const a=k("blockSize",t,e,n),r=k("dataFormat",t,e,n).toUpperCase();return[s.depthToSpace(k("x",t,e,n),a,r)]}case"BroadcastTo":return[s.broadcastTo(k("x",t,e,n),k("shape",t,e,n))];case"BroadcastArgs":return[s.broadcastArgs(k("s0",t,e,n),k("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LS(t,e,n,s,a=B){const r=((i,o,l)=>{switch(i.category){case"arithmetic":return a(()=>hK(i,o,l));case"basic_math":return a(()=>fK(i,o,l));case"control":return xK(i,o,l);case"convolution":return a(()=>kK(i,o,l));case"creation":return a(()=>vK(i,o,l));case"dynamic":return SK(i,o,l);case"evaluation":return a(()=>NK(i,o,l));case"image":return a(()=>TK(i,o,l));case"graph":return a(()=>CK(i,o,l));case"logical":return a(()=>EK(i,o,l));case"matrices":return a(()=>AK(i,o,l));case"normalization":return a(()=>RK(i,o,l));case"ragged":return a(()=>DK(i,o,l));case"reduction":return a(()=>_K(i,o,l));case"slice_join":return a(()=>OK(i,o,l));case"sparse":return a(()=>FK(i,o,l));case"spectral":return a(()=>jK(i,o,l));case"string":return a(()=>PK(i,o,l));case"transformation":return a(()=>LK(i,o,l));case"hash_table":return $K(i,o,l,s);case"custom":const u=XR(i.op);if(u&&u.customExecutor)return u.customExecutor(new pK(i,o,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Wr(r)?r.then(i=>[].concat(i)):[].concat(r)}class zS{constructor(e={},n={},s={},a={},r){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=a,this.parseNodeNameCache=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BS(t,e,n,s){const a=new Set,r=[];let i=null,o=null;const l=new Set,u=new Set(Object.keys(t).map(p=>Vn(p)[0]));s=s||[];const c=new Set(s.map(p=>Vn(p.name)[0])),d=[...e];for(;d.length>0;){const p=d.pop();if(($i(p)||HK(p)||KK(p))&&i==null&&(i=p,o=i.children.map(h=>h.name).filter(h=>a.has(h))),a.add(p.name),n[p.name]==null&&!u.has(p.name)&&!c.has(p.name)){if(p.inputs.length===0){r.push(p.name);continue}p.inputs.forEach(h=>{l.has(h.name)||(l.add(h.name),d.push(h))})}}return{inputs:t,outputs:e,usedNodes:a,missingInputs:r,dynamicNode:i,syncInputs:o}}function zK(t,e){const{usedNodes:n,inputs:s}=e,a=Object.keys(s).map(y=>Vn(y)[0]).map(y=>t.nodes[y]),r=t.initNodes||[],i=y=>n.has(typeof y=="string"?y:y.name);function o(y){return[...new Map(y.map(m=>[m.name,m])).values()]}const l=o([...a,...t.weights,...r]).filter(i),u=o([...l,...Object.values(t.nodes)]).filter(i),c=new Map(u.map(y=>[y.name,y])),d={};for(const y of u){d[y.name]=d[y.name]||0;for(const m of y.children)i(m)||(d[m.name]=Number.POSITIVE_INFINITY),d[m.name]=(d[m.name]||0)+1}const p=Object.entries(d).filter(([,y])=>y===0).map(([y])=>y),h=[...p];for(;p.length>0;){const y=p.pop(),m=c.get(y);for(const w of m.children.filter(i))--d[w.name]===0&&(h.push(w.name),p.push(w.name))}const f=h.map(y=>c.get(y)),g=BK(f,l);return MK(g,l),g}function BK(t,e){const n=new Map(t.map(i=>[i.name,i])),s=e.map(i=>i.name),a=new Set(s);for(;s.length>0;){const i=s.pop(),o=n.get(i);for(const l of o.children)!n.has(l.name)||a.has(l.name)||(a.add(l.name),s.push(l.name))}return t.filter(i=>a.has(i.name))}class Nh extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function MK(t,e){const n=new Map(t.map((o,l)=>[o.name,l])),s=new Set(e.map(o=>o.name)),a=o=>s.has(typeof o=="string"?o:o.name),r=new Set(t.map(o=>o.name)),i=o=>r.has(typeof o=="string"?o:o.name);for(const o of t){for(const l of o.children.filter(i)){if(!n.has(l.name))throw new Nh(`Child ${l.name} of node ${o.name} is unreachable.`);if(n.get(o.name)>n.get(l.name))throw new Nh(`Node ${o.name} is scheduled to run after its child ${l.name}.`)}if(!a(o))for(const l of o.inputs){if(!n.has(l.name))throw new Nh(`Input ${l.name} of node ${o.name} is unreachable.`);if(n.get(l.name)>n.get(o.name))throw new Nh(`Node ${o.name} is scheduled to run before its input ${l.name}.`)}}}function VK(t){const e=new Map(t.map((o,l)=>[o.name,l])),n=Number.MAX_SAFE_INTEGER,s=t.map((o,l)=>$i(o)?n:l),a=o=>{const l=s[e.get(o.name)];return l??-1},r=t.map((o,l)=>o.children.map(a).reduce((u,c)=>Math.max(u,c),s[l])),i=new Map;for(let o=0;o<t.length;++o){const l=r[o];if(l===n)continue;const u=t[o],c=t[l];i.has(c.name)||i.set(c.name,[]),i.get(c.name).push(u)}return i}const WK=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),UK=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),GK=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function $i(t){return WK.has(t.op)}function HK(t){return UK.has(t.op)}function KK(t){return GK.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wf{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(s=>e[s].map(a=>a.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new Wf(e.functions[s],this)})}getCompilationKey(e,n){const s=e.map(r=>r.name).sort(),a=n.map(r=>r.name).sort();return s.join(this.SEPARATOR)+"--"+a.join(this.SEPARATOR)}compile(e,n){const s=BS(e,n,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:r,syncInputs:i}=s;if(r!=null)throw new Error(`This execution contains the node '${r.name}', which has the dynamic op '${r.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(a.length>0){const u=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${a}]`)}const o=zK(this.graph,s),l=VK(o);return{orderedNodes:o,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return Rt(n),n}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const a=s.map(p=>this.graph.nodes[Vn(p)[0]]),r=n.map(p=>Vn(p)[0]),i=new Set(r);let o=r.map(p=>this.graph.nodes[p]);o.length===0&&(o=this._outputs);const l=this.getCompilationKey(a,o);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,o),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=V().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const c={},d={};return B(()=>{const p=new zS(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),h=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(m=>{const[w,b]=Vn(m,p),x=[];x[b]=e[m],h[w]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[w]=this.cloneTensorList(x))});const f=this.getFrozenTensorIds(h),{orderedNodes:g,nodeLiveUntilMap:y}=u;for(const m of g){if(h[m.name])continue;const w=LS(m,h,p,this._resourceManager);if(Wr(w))throw new Error(`The execution of the op '${m.op}' returned a promise. Please use model.executeAsync() instead.`);h[m.name]=w,this.keepIntermediateTensors&&(this.clonedTensorsMap[m.name]=this.cloneTensorList(w)),this.checkTensorForDisposalWithNodeLiveUntilInfo(m,h,p,f,i,y.get(m.name))}return this.parent==null&&p.dispose(f),n.map(m=>Jt(m,h,p))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(a=>a.id)));return new Set(n)}checkTensorForDisposal(e,n,s,a,r,i,o){if(!($i(n)||i.has(e))){for(const l of s[e])l!=null&&(o[l.id]=(o[l.id]||0)+n.children.length);for(const l of n.inputs){if($i(l))continue;const u=_S(l.name,s,a);if(u!=null)for(const c of u){if(!c||c.kept||r.has(c.id))continue;const d=o[c.id];d===1?(c.dispose(),delete o[c.id]):d!=null&&o[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,s,a,r,i){function o(l){return $i(l)||r.has(l.name)}if(!($i(e)||i==null))for(const l of i){if(o(l))continue;const u=_S(l.name,n,s);for(const c of u)!c||c.kept||a.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,s=!1,a={},r={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=V().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const i=new zS(this.weightMap,a,r,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const o=await this.executeWithControlFlow(e,i,n,s),l=n.map(p=>Jt(p,o,i)),u=l.map(p=>p.id),c=Object.keys(e).map(p=>e[p].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(o).forEach(p=>{p.forEach(h=>{h&&!h.isDisposed&&!d.has(h.id)&&h.dispose()})}),this.parent==null&&i.dispose(d),l}async executeFunctionAsync(e,n,s){const a=e.reduce((r,i,o)=>(r[this.inputs[o].name]=i,r),{});return this._executeAsync(a,this.outputNodes,!0,n,s)}async executeWithControlFlow(e,n,s,a){const r=Object.keys(e),i=r.map(x=>this.graph.nodes[Vn(x)[0]]),o=s.map(x=>Vn(x)[0]),l=new Set(o);let u=o.map(x=>this.graph.nodes[x]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:p,syncInputs:h}=BS(e,u,this.weightMap,this._initNodes),f=[...i,...this.graph.weights,...this._initNodes||[]].map(x=>({node:x,contexts:n.currentContext})),g=Object.assign({},this.weightMap);Object.keys(e).forEach(x=>{const[v,S]=Vn(x),N=[];N[S]=e[x],g[v]=N});const y={},m=this.getFrozenTensorIds(g),w={};for(;f.length>0;){const x=this.processStack(i,f,n,g,w,m,l,y,c);await Promise.all(x)}p==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=u.filter(x=>!$i(x)&&!Jt(x.name,g,n)).map(x=>x.name);if(b.length>0){let x="";throw p!=null&&(x=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${r}]. Consider providing the following inputs: [${d}]. ${x}`)}return g}processStack(e,n,s,a,r,i,o,l,u){const c=[];for(;n.length>0;){const d=n.pop();s.currentContext=d.contexts;let p="";if(d.node.op==="Enter"&&k("isConstant",d.node,a,s)&&([p]=La(d.node.name,s)),a[d.node.name]==null){const h=LS(d.node,a,s,this._resourceManager);p||([p]=La(d.node.name,s));const f=s.currentContext;Wr(h)?c.push(h.then(g=>(a[p]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(g)),s.currentContext=f,this.checkTensorForDisposal(p,d.node,a,s,i,o,l),this.processChildNodes(d.node,n,s,a,r,u),g))):(a[p]=h,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(h)),this.checkTensorForDisposal(p,d.node,a,s,i,o,l),this.processChildNodes(d.node,n,s,a,r,u))}else this.processChildNodes(d.node,n,s,a,r,u)}return c}processChildNodes(e,n,s,a,r,i){e.children.forEach(o=>{const[l]=La(o.name,s);r[l]||!i.has(o.name)||(o.op==="Merge"?o.inputNames.some(u=>!!Jt(u,a,s))&&(r[l]=!0,n.push({contexts:s.currentContext,node:o})):o.inputNames.every(u=>!!Jt(u,a,s))&&(r[l]=!0,n.push({contexts:s.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const s=e[n],[a]=Vn(n),r=this.graph.nodes[a];if(r.attrParams.shape&&r.attrParams.shape.value){const i=r.attrParams.shape.value,o=i.length===s.shape.length&&s.shape.every((l,u)=>i[u]===-1||i[u]===l);C(o,()=>`The shape of dict['${r.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}r.attrParams.dtype&&r.attrParams.dtype.value&&C(s.dtype===r.attrParams.dtype.value,()=>`The dtype of dict['${r.name}'] provided in model.execute(dict) must be ${r.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var n,s;const a={};for(const r in e){const i=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[r];i!=null?a[i.name]=e[r]:a[r]=e[r]}return a}checkInputs(e){const n=Object.keys(e).filter(s=>{const[a]=Vn(s);return this.graph.nodes[a]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var s,a;const r=(a=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||a===void 0?void 0:a[n];return r!=null?r.name:n},{})}checkOutputs(e){e.forEach(n=>{const[s]=Vn(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class qK{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JK="?tfjs-format=file",XK="model.json";class X1{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},s=e1){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new qK}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Wr(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await E$(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const s=this.artifacts.modelTopology;let a=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const r=this.artifacts.userDefinedMetadata;r.signature!=null&&(a=r.signature),r.structuredOutputKeys!=null&&(this.structuredOutputKeys=r.structuredOutputKeys)}if(this.signature=a,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new Wf(OS.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const r=OS.Instance.transformGraph(e.modelInitializer);this.initializer=new Wf(r),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof ze?[e]:e,s={};return n.forEach((a,r)=>s[this.structuredOutputKeys[r]]=a),s}return e}predict(e,n){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,n){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var n;if(!(e instanceof ze)&&!Array.isArray(e)){const r=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(r!=null)for(const i in r){const o=r[i];o.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[o.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let a=0;return this.inputNodes.reduce((r,i)=>{var o,l,u;const c=(u=(l=(o=this.signature)===null||o===void 0?void 0:o.inputs)===null||l===void 0?void 0:l[i])===null||u===void 0?void 0:u.resourceId;return c!=null?r[i]=this.resourceIdToCapturedInput[c]:r[i]=e[a++],r},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let a=0;a<s.length;a++){const r=s[a],i=n[r];this.resourceIdToCapturedInput[i.resourceId]=e[a]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=this.executor.execute(e,n);return s.length>1?s:s[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(e,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,s)=>(n[s]=[e[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Te(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function YK(t,e={},n=e1){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=ZK(t));const s=new X1(t,e,n);return await s.load(),s}function QK(t){if(t==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(t instanceof Array){const[s,a]=t;if(!s)throw new Error("modelJSON must be the first element of the array");if(!a||!(a instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const r=Af(s.weightsManifest),i=_x(s,r,a);e=Df(i)}else if("load"in t)e=t;else if("modelTopology"in t&&"weightSpecs"in t&&"weightData"in t)e=Df(t);else throw new Error("Unknown model format");const n=new X1(e);return n.load(),n}function ZK(t){return t.endsWith("/")||(t=t+"/"),`${t}${XK}${JK}`}/** @license See the LICENSE file. */const e8="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t8=Object.freeze(Object.defineProperty({__proto__:null,GraphModel:X1,deregisterOp:IH,loadGraphModel:YK,loadGraphModelSync:QK,registerOp:CH,version_converter:e8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var MS;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(MS||(MS={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function he(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&C(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n8=e0;class C0 extends ym{nextDataId(){return C0.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new yx(this,Ws())}write(e,n,s){this.firstUse&&(this.firstUse=!1,V().get("IS_NODE")&&as(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:s,refCount:1}),a}makeTensorInfo(e,n,s){let a;if(n==="string"&&s!=null&&s.length>0&&ga(s[0])){const r=s.map(i=>xa(i));a=this.write(r,e,n)}else a=this.write(s,e,n);return{dataId:a,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,a,r){this.data.set(e,{values:n,dtype:a,refCount:r})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const a=this.readSync(s.real.dataId),r=this.readSync(s.imag.dataId);return Za(a,r)}return n$(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(a=>Xa(a));return Se(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Se(e.shape,e.dtype,n)}makeOutput(e,n,s){return Ws().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=mn();return e(),{kernelMs:mn()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){he([e],"where");const n=this.readSync(e.dataId);return n8(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}C0.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZR(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const s8=t=>{const{x:e}=t.inputs,n=t.backend;he(e,"abs");let s=new Float32Array(H(e.shape));const a=n.data.get(e.dataId).values;return s=ZR(a),n.makeOutput(s,e.shape,e.dtype)},a8={kernelName:fd,backendName:"cpu",kernelFunc:s8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nt(t){return(e,n,s,a,r)=>{const i=ve(e,n),o=i.length,l=ye(i),u=H(i),c=Wt(r,u),d=e.length,p=n.length,h=ye(e),f=ye(n),g=eo(e,i),y=eo(n,i);if(g.length+y.length===0)for(let m=0;m<c.length;++m)c[m]=t(s[m%s.length],a[m%a.length]);else for(let m=0;m<c.length;++m){const w=go(m,o,l),b=w.slice(-d);g.forEach(N=>b[N]=0);const x=Qs(b,d,h),v=w.slice(-p);y.forEach(N=>v[N]=0);const S=Qs(v,p,f);c[m]=t(s[x],a[S])}return[c,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Un(t){const{inputs:e,backend:n}=t,{real:s,imag:a}=e,r=n.data.get(s.dataId).values,i=n.data.get(a.dataId).values,o=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",r),imag:n.makeTensorInfo(a.shape,"float32",i)},o}const r8={kernelName:Im,backendName:"cpu",kernelFunc:Un};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uf(t,e,n="float32"){if(n==="complex64"){const a=Uf(t,e,"float32"),r=Uf(t,e,"float32");return Un({inputs:{real:a,imag:r},backend:t})}const s=Zt(H(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aa(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const i8={kernelName:Yl,backendName:"cpu",kernelFunc:Aa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function io(t){const{inputs:e,backend:n}=t,{input:s}=e,a=n.data.get(s.dataId).complexTensorInfos.real,r=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,r)}const o8={kernelName:rg,backendName:"cpu",kernelFunc:io};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eD(t,e,n,s){if(s==="int32"){const a=Int32Array.from(t);return[e,"int32",a]}if(s==="bool"){const a=ri([0],n),[r,i]=Nt((o,l)=>o!==l?1:0)(e,[],t,a,"bool");return[i,"bool",r]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Qr(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{dtype:r}=s;if(r==="complex64"){if(a.dtype==="complex64")return Aa({inputs:{x:a},backend:n});const c=Uf(n,a.shape,a.dtype),d=Qr({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),p=Un({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),p}if(a.dtype==="complex64"){const c=io({inputs:{input:a},backend:n}),d=Qr({inputs:{x:c},backend:n,attrs:{dtype:r}});return n.disposeIntermediateTensorInfo(c),d}if(!xx(a.dtype,r)){const c=Aa({inputs:{x:a},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:r}}const i=n.data.get(a.dataId).values,[o,l,u]=eD(i,a.shape,a.dtype,r);return n.makeTensorInfo(o,l,u)}const l8={kernelName:Ll,backendName:"cpu",kernelFunc:Qr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pt(t,e,n,s){return n==null?({inputs:a,backend:r})=>{const{a:i,b:o}=a,l=r;he([i,o],t);const u=l.data.get(i.dataId).values,c=l.data.get(o.dataId).values,d=i.dtype==="string"?er(u):u,p=i.dtype==="string"?er(c):c,h=s||i.dtype,[f,g]=e(i.shape,o.shape,d,p,h);return l.makeTensorInfo(g,h,f)}:({inputs:a,backend:r})=>{const{a:i,b:o}=a,l=r;if(i.dtype==="complex64"||o.dtype==="complex64"){const u=Qr({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,p=c.complexTensorInfos.imag,h=l.data.get(d.dataId).values,f=l.data.get(p.dataId).values,g=Qr({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),y=l.data.get(g.dataId),m=y.complexTensorInfos.real,w=y.complexTensorInfos.imag,b=l.data.get(m.dataId).values,x=l.data.get(w.dataId).values,[v,S,N]=n(i.shape,o.shape,h,f,b,x),$=l.makeTensorInfo(N,"float32",v),E=l.makeTensorInfo(N,"float32",S),A=Un({inputs:{real:$,imag:E},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo($),l.disposeIntermediateTensorInfo(E),A}else{const u=l.data.get(i.dataId).values,c=l.data.get(o.dataId).values,d=s||i.dtype,[p,h]=e(i.shape,o.shape,u,c,d);return l.makeTensorInfo(h,d,p)}}}function Y1(t){return(e,n,s,a,r,i)=>{const o=ve(e,n),l=H(o),u=o.length,c=ye(o),d=Wt("float32",l),p=Wt("float32",l),h=eo(e,o),f=eo(n,o),g=Za(s,a),y=Za(r,i),m=e.length,w=ye(e),b=n.length,x=ye(n);if(h.length+f.length===0)for(let v=0;v<d.length;v++){const S=v%g.length,N=v%y.length,$=t(g[S*2],g[S*2+1],y[N*2],y[N*2+1]);d[v]=$.real,p[v]=$.imag}else for(let v=0;v<d.length;v++){const S=go(v,u,c),N=S.slice(-m);h.forEach(W=>N[W]=0);const $=Qs(N,m,w),E=S.slice(-b);f.forEach(W=>E[W]=0);const A=Qs(E,b,x),L=t(g[$*2],g[$*2+1],y[A*2],y[A*2+1]);d[v]=L.real,p[v]=L.imag}return[d,p,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tD=Nt((t,e)=>t+e),u8=Y1((t,e,n,s)=>({real:t+n,imag:e+s})),Sl=Pt(yo,tD,u8),c8={kernelName:yo,backendName:"cpu",kernelFunc:Sl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q1(t,e,n,s,a){const r=H(s),i=Zt(a,n);for(let o=0;o<t.length;o++){const l=t[o];if(l<0)throw new Error("Input x must be non-negative!");l>=a||(r>0?i[l]+=e[o]:i[l]+=1)}return i}function nD(t,e,n,s=!1){const a=t.shape[0],r=t.shape[1],i=Se([a,n],e.dtype);for(let o=0;o<a;o++)for(let l=0;l<r;l++){const u=t.get(o,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(s?i.set(1,o,u):e.size>0?i.set(i.get(o,u)+e.get(o,l),o,u):i.set(i.get(o,u)+1,o,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sD=Nt((t,e)=>t&e),d8=Pt(vd,sD),p8={kernelName:vd,backendName:"cpu",kernelFunc:d8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Da(t){return(e,n,s)=>{const a=gt(n,e.length);for(let r=0;r<e.length;++r)a[r]=t(e[r],s);return a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ve(t,e,n){const s=Da(e);return fi(t,s,n)}function fi(t,e,n){return({inputs:s,attrs:a,backend:r})=>{const{x:i}=s;he(i,t);const o=r,l=o.data.get(i.dataId).values;let u;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=er(l)}else u=l;const c=n||i.dtype,d=e(u,c,a);return o.makeTensorInfo(i.shape,c,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aD=Da(t=>Math.ceil(t)),h8=fi(zl,aD),f8={kernelName:zl,backendName:"cpu",kernelFunc:h8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rD(t,e,n,s){const a=gt(n,H(e));if(s&&n!=="string"){let r=0;t.forEach(i=>{const o=H(i.shape);a.set(i.vals,r),r+=o})}else{let r=0;t.forEach(i=>{const o=n==="string"?er(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const c=u*e[1]+r;for(let d=0;d<i.shape[1];++d)a[c+d]=o[l++]}r+=i.shape[1]})}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iD=Nt((t,e)=>t===e?1:0),oD=Pt(Rd,iD,null,"bool"),m8={kernelName:Rd,backendName:"cpu",kernelFunc:oD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lD=Da(t=>Math.exp(t)),uD=fi(Hl,lD,"float32"),g8={kernelName:Hl,backendName:"cpu",kernelFunc:uD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cD=Da(t=>Math.expm1(t)),y8=fi(Kl,cD),w8={kernelName:Kl,backendName:"cpu",kernelFunc:y8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dD=Da(t=>Math.floor(t)),b8=fi(ql,dD),x8={kernelName:ql,backendName:"cpu",kernelFunc:b8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pD=Nt((t,e)=>Math.floor(t/e)),k8=Pt(Jl,pD,null,"int32"),v8={kernelName:Jl,backendName:"cpu",kernelFunc:k8};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hD(t,e,n,s,a,r,i,o,l){const u=Se([s,r],n);for(let c=0;c<s;c++){const d=[];let p=0;for(let h=0;h<a;h++){const f=t[c*a+h];p+=f*i[h],d.push(f)}if(p<0||p>=l/r)throw new Error(`Invalid indices: ${d} does not index into ${o}`);for(let h=0;h<r;h++)u.values[c*r+h]=e.get(...e.indexToLoc(p*r+h))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fD(t,e,n){const s=Se(n,t.dtype);for(let a=0;a<s.size;++a){const i=s.indexToLoc(a).slice(),o=i[0],l=i[2],u=e.locToIndex([o,l]);i[2]=e.values[u];const c=t.locToIndex(i);0<=c&&c<t.values.length&&(s.values[a]=t.values[c])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mD=Nt((t,e)=>t>e?1:0),S8=Pt(Fd,mD,null,"bool"),N8={kernelName:Fd,backendName:"cpu",kernelFunc:S8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gD=Nt((t,e)=>t>=e?1:0),C8=Pt(Xl,gD,null,"bool"),I8={kernelName:Xl,backendName:"cpu",kernelFunc:C8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yD=Nt((t,e)=>t<e?1:0),$8=Pt(Pd,yD,null,"bool"),T8={kernelName:Pd,backendName:"cpu",kernelFunc:$8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wD=Nt((t,e)=>t<=e?1:0),E8=Pt(Ld,wD,null,"bool"),A8={kernelName:Ld,backendName:"cpu",kernelFunc:E8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bD(t,e,n){const s=(e-t)/(n-1),a=Zt(n,"float32");a[0]=t;for(let r=1;r<a.length;r++)a[r]=a[r-1]+s;return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xD=Da(t=>Math.log(t)),R8=fi(tu,xD),D8={kernelName:tu,backendName:"cpu",kernelFunc:R8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kD(t,e,n,s){const a=Wt(s,H(n));for(let r=0;r<a.length;++r){const i=r*e;let o=t[i];for(let l=0;l<e;++l){const u=t[i+l];(Number.isNaN(u)||u>o)&&(o=u)}a[r]=o}return a}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vD=Nt((t,e)=>Math.max(t,e)),_8=Pt(su,vD),O8={kernelName:su,backendName:"cpu",kernelFunc:_8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SD=Nt((t,e)=>Math.min(t,e)),F8=Pt(au,SD),j8={kernelName:au,backendName:"cpu",kernelFunc:F8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z1=Nt((t,e)=>t*e),P8=Y1((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),I0=Pt(iu,Z1,P8),L8={kernelName:iu,backendName:"cpu",kernelFunc:I0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ND(t,e,n){const s=sr(-1,n);return Z1([],e,s,t,n)}function z8(t){const{inputs:e,backend:n}=t,{x:s}=e;he(s,"neg");const a=n.data.get(s.dataId).values,[r,i]=ND(a,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,r)}const B8={kernelName:Jd,backendName:"cpu",kernelFunc:z8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CD=Nt((t,e)=>t!==e?1:0),M8=Pt(Xd,CD,null,"bool"),V8={kernelName:Xd,backendName:"cpu",kernelFunc:M8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ev(t,e,n,s,a){const r=e.length,i=H(e),o=ye(e),l=ye(a),u=Wt(n,H(a));for(let c=0;c<i;++c){const d=go(c,r,o),p=new Array(d.length);for(let f=0;f<p.length;f++)p[f]=d[s[f]];const h=Qs(p,r,l);u[h]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jn(t){const{inputs:e,attrs:n,backend:s}=t,{x:a}=e,{perm:r}=n;he(a,"transpose");const i=a.shape.length,o=new Array(i);for(let d=0;d<o.length;d++)o[d]=a.shape[r[d]];const l=s.data.get(a.dataId).values,u=ev(l,a.shape,a.dtype,r,o);return{dataId:s.write(u,o,a.dtype),shape:o,dtype:a.dtype}}const W8={kernelName:Li,backendName:"cpu",kernelFunc:jn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ID(t,e,n,s){const[a,r]=Ht(t,s),i=Rn(e,"int32"),o=Zt(H(a),i),l=H(r);for(let u=0;u<o.length;++u){const c=u*l;let d=1;for(let p=0;p<l;++p)d*=n[c+p];o[u]=d}return{outVals:o,outShape:a,outDtype:i}}function U8(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;he(a,"prod");const o=a.shape.length,l=Ee(r,a.shape),u=ht(l,o);let c=l,d=a;const p=[];u!=null&&(d=jn({inputs:{x:a},backend:n,attrs:{perm:u}}),p.push(d),c=vt(c.length,o));const h=n.data.get(d.dataId).values,{outVals:f,outShape:g,outDtype:y}=ID(d.shape,d.dtype,h,c);let m=g;return i&&(m=kt(g,l)),p.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(m,y,f)}const G8={kernelName:np,backendName:"cpu",kernelFunc:U8};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H8(t,e,n){t.forEach((s,a)=>{if(s<0||s>=n){const r=go(a,e.length,ye(e)).join(",");throw new Error(`indices[${r}] = ${s} is not in [0, ${n})`)}})}function K8(t,e){for(let n=0;n<t.length;++n){const s=t[n],a=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>a)throw new Error("Ragged splits must not point past values");for(let r=1;r<s.length;++r)if(s[r-1]>s[r])throw new Error("Ragged splits must be sorted in ascending order")}}function q8(t,e,n,s){const a=[];let r=0;const i=e.length-1+n.length,o=new Array(i).fill(null).map(()=>[0]);K8(n,s);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)o[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let p=0;p<n.length;++p){const h=n[p],f=p+e.length-1;if(f>=0){const g=o[f],y=g[g.length-1]-h[c];for(let m=c;m<d;++m)o[f].push(h[m+1]+y)}c=h[c],d=h[d]}d!==c&&(a.push([c,d]),r+=d-c)}return{outSplits:o,valueSlices:a,numValues:r}}function J8(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,a=gt("int32",s);e.push(a),t[n].forEach((r,i)=>a[i]=r)}return e}function VS(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function X8(t,e,n,s,a,r){const i=VS(e,2)[1],o=VS(r,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<s;++d)a[l*o+d]=t[c*i+d];++l}}function Y8(t,e,n,s,a){const r=e.slice();r[0]=a;const i=gt(n,H(r)),o=t.length,l=o===0?0:o/e[0];return X8(t,e,s,l,i,r),[i,r]}function $D(t,e,n,s,a,r,i,o){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(H8(r,i,l),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:c,valueSlices:d,numValues:p}=q8(r,i,t,u),h=J8(c),f=Y8(n,s,a,d,p);return[h,f[0],f[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WS=2147483647;function TD(t,e,n,s,a,r,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const o=e.length===0,l=a.length===0,u=i.length===0,c=[];o||c.push(e[0]),l||c.push(a[0]),u||c.push(i[0]);for(let y=1;y<c.length;++y)if(c[y]!==c[y-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],p=gt("int32",d+1);p[0]=0;for(let y=0;y<d;++y){const m=o?t[0]:t[y],w=l?s[0]:s[y],b=u?r[0]:r[y];if(b===0)throw new Error("Requires delta != 0");let x;if(b>0&&w<m||b<0&&w>m)x=0;else if(x=Math.ceil(Math.abs((w-m)/b)),x>WS)throw new Error(`Requires ((limit - start) / delta) <= ${WS}`);p[y+1]=p[y]+x}const h=p[d],f=gt(n,h);let g=0;for(let y=0;y<d;++y){const m=p[y+1]-p[y];let w=o?t[0]:t[y];const b=u?r[0]:r[y];for(let x=0;x<m;++x)f[g++]=w,w+=b}return[p,f]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bs=Ks;class Gf{constructor(e,n,s,a,r,i,o,l,u,c){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=a,this.valuesDType=r,this.defaultValue=i,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=uE(c),this.raggedRank=cE(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===bs.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===bs.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case bs.VALUE_ROWIDS:return Gf.getMaxWidthValueRowID(n);case bs.ROW_SPLITS:return Gf.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${bs[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let a=0;a<n-1;++a){const r=e[a+1]-e[a];r>s&&(s=r)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,a=e[0],r=0;for(let i=1;i<n;++i){const o=e[i];o!==a&&(a=o,r=Math.max(i-s,r),s=i)}return Math.max(n-s,r)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return GS(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;dE(s,n);const a=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=lE(this.raggedRank,a,n);i[0]<0&&(i[0]=e);for(let o=1;o<=this.raggedRank;++o)i[o]<0&&(i[o]=this.getMaxWidth(o));return i}calculateFirstParentOutputIndex(e,n,s){const a=Math.min(e,s),r=[];let i=0;for(let o=0;o<a;++o,i+=n)r.push(i);for(let o=a;o<e;++o)r.push(-1);return C(r.length===e,()=>"Final length of result must be equal to firstDimension."),r}calculateOutputIndexRowSplit(e,n,s,a){const r=e.length,i=[];for(let o=0;o<r-1;++o){const l=e[o+1]-e[o];let u=Math.min(a,l),c=n[o];c===-1&&(u=0);for(let d=0;d<u;++d)i.push(c),c+=s;for(let d=0;d<l-u;++d)i.push(-1)}if(r>0&&i.length!==e[r-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,s,a){const r=e.length,i=[];if(r===0)return[];let o=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];i.push(u);for(let c=1;c<r;++c){const d=e[c];if(d===l)u>=0&&(++o,o<a?u+=s:u=-1);else{if(o=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,s,a){const r=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case bs.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(r,n,s,a);case bs.ROW_SPLITS:if(r.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${r.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(r,n,s,a);default:throw new Error(`Unsupported partition type: ${bs[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case bs.FIRST_DIM_SIZE:return e[0];case bs.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case bs.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${bs[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),a=new Array(this.raggedRank+1);a[a.length-1]=1;for(let l=a.length-2;l>=0;--l)a[l]=a[l+1]*s[l+1];const r=GS(s,!1),i=gt(this.valuesDType,H(r));if(a[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,a[0],s[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,a[u],s[u]);this.setOutput(this.raggedRank,l,i,r)}return[r,i]}setOutput(e,n,s,a){if(s.length===0)return;const r=this.values,i=s;let o=a.slice();o=o.slice(e+1);const l=H(o),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const f=this.defaultValueShape;B(()=>{const g=F(c,f);c=zi(g,o).dataSync()})}let d=0,p=0,h=0;for(let f=0;f<=u;++f){let g=f<u?n[f]:-1;if(g===h){++h;continue}if(p<h){const y=r.subarray(d*l),m=i.subarray(p*l),w=(h-p)*l;US(m,y,w)}if(f>=u){const y=s.length;g=Math.floor(y/l)}if(g>h)if(this.defaultValue.length===1)i.subarray(h*l,g*l).fill(this.defaultValue[0]),h=g;else for(;g>h;){const y=i.slice(h*l);US(y,c,l),++h}g<0?(d=f+1,p=h):(d=f,p=h,h=p+1)}}}function US(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function GS(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function ED(t,e,n,s,a,r,i,o,l,u){return new Gf(t,e,n,s,a,r,i,o,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AD(t,e,n,s){const a=t===e,r=t<e&&n<0,i=e<t&&n>1;if(a||r||i)return Zt(0,s);const o=Math.abs(Math.ceil((e-t)/n)),l=Zt(o,s);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RD=Da(t=>1/Math.sqrt(t)),Q8=fi(pu,RD),Z8={kernelName:pu,backendName:"cpu",kernelFunc:Q8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oi(t,e,n,s,a,r,i,o,l,u){const c=[s/a,a],d=t.values,p=e.values;if(s===0)return Se(n,e.dtype);const h=l instanceof Tt?l:Se(c,e.dtype);typeof l=="string"||typeof l=="number"?h.values.fill(l):typeof l=="boolean"&&h.values.fill(+l);for(let f=0;f<r;f++){const g=[];let y=0;for(let m=0;m<i;m++){const w=d[f*i+m];g.push(w),y+=w*o[m]}if(y<0||y>=s/a)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let m=0;m<a;m++)u?h.values[y*a+m]+=p[f*a+m]:h.values[y*a+m]=e.rank===0?p[0]:p[f*a+m]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7=Da(t=>1/(1+Math.exp(-t))),DD=Ve(yu,t=>1/(1+Math.exp(-t))),t7={kernelName:yu,backendName:"cpu",kernelFunc:DD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _D(t,e,n,s,a){const r=s1(s,e,n),i=H(n),o=ye(s);if(r){const d=a1(e,o);return a==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=a==="string"?er(t):t,u=Se(s,a,l),c=Se(n,a);for(let d=0;d<c.size;++d){const p=c.indexToLoc(d),h=p.map((f,g)=>f+e[g]);c.set(u.get(...h),...p)}return a==="string"?RE(c.values):c.values}function oo(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{begin:r,size:i}=s;he(a,"slice");const[o,l]=d0(a,r,i);t1(a,o,l);const u=n.data.get(a.dataId).values,c=_D(u,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,c)}const n7={kernelName:lp,backendName:"cpu",kernelFunc:oo};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OD(t,e,n,s,a,r,i){const o=e[0],l=r[0],u=new Array(l),c=new Array(o),d=e[1];if(l===0){if(o!==0)throw new Error(wE(o));const y=gt(n,0),m=gt(a,0);return[y,[0,d],m,u,c]}let p=!0,h=0;const f=new Array(l).fill(0);for(let y=0;y<o;++y){const m=t[y*d];if(m<0)throw new Error(bE(y,m));if(m>=l)throw new Error(xE(y,m,l));++f[m],p=p&&m>=h,h=m}let g=!0;for(let y=0;y<l;++y){const m=f[y]===0;u[y]=m,g=g&&!m,f[y]=Math.max(f[y],1),y>0&&(f[y]+=f[y-1])}if(g&&p){const y=t,m=s;for(let w=0;w<o;++w)c[w]=w;return[y,[o,d],m,u,c]}else{const y=f[l-1],m=gt(n,y*d),w=gt(a,y),b=new Array(l).fill(0);for(let x=0;x<o;++x){const v=t[x*d],S=b[v],N=(v===0?0:f[v-1])+S;b[v]++;for(let $=0;$<d;++$)m[N*d+$]=t[x*d+$];w[N]=s[x],c[x]=N}for(let x=0;x<l;++x)if(b[x]===0){const S=x===0?0:f[x-1];m[S*d+0]=x;for(let N=1;N<d;++N)m[S*d+N]=0;w[S]=i}return[m,[y,d],w,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FD(t,e,n,s,a){const r=H(s),i=e[0],o=a.length,l=[];let u=1,c=-1;for(let y=0;y<o;++y){const m=a[y];if(m===-1){if(c!==-1)throw new Error(kE(c,y));c=y,l.push(1)}else{if(m<0)throw new Error(vE(y,m));u*=m,l.push(m)}}if(c!==-1){if(u<=0)throw new Error(SE());const y=Math.trunc(r/u);if(u*y!==r)throw new Error(NE(s,l));l[c]=y}if(H(l)!==r)throw new Error(CE(s,l));const p=s.length,h=[];if(p>0){h[p-1]=1;for(let y=p-2;y>=0;--y)h[y]=h[y+1]*s[y+1]}const f=[];if(o>0){f[o-1]=1;for(let y=o-2;y>=0;--y)f[y]=f[y+1]*l[y+1]}const g=gt(n,i*o);for(let y=0;y<i;++y){let m=0;for(let w=0;w<p;++w)m+=t[y*p+w]*h[w];for(let w=0;w<o;++w)g[y*o+w]=Math.trunc(m/f[w]),m%=f[w]}return[g,[i,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tv(t,e,n,s,a,r=!1,i=0){const o=s.length,l=[e[0],t.length/e[0]],u=l[1],d=o>0?a[o-1]+1:0;if(d<0)throw new Error(Uw());const p=e.slice();p[0]=d;const h=p.reduce((b,x)=>b*x,1),f=gt(n,h);if(o===0)return d>0&&f.fill(i),[f,p];if(d<=0)throw new Error(Uw());let g=0,y=1,m=0,w=a[g];for(;;){let b=0;if(y<o){if(b=a[y],w===b){++y;continue}if(w>=b)throw new Error(IE())}if(w<0||w>=d)throw new Error($E(w,d));w>m&&f.fill(i,m*u,w*u);for(let x=g;x<y;++x){const v=s[x];if(v<0||v>=l[0])throw new Error(TE(x,s[x],l[0]));for(let S=0;S<u;S++)f[w*u+S]+=t[v*u+S]}if(r)for(let x=0;x<u;x++)f[w*u+x]/=y-g;if(g=y,++y,m=w+1,w=b,y>o)break}return m<d&&f.fill(i,m*u,d*u),[f,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s7=Da(t=>Math.sqrt(t)),a7=Ve(bu,t=>Math.sqrt(t)),r7={kernelName:bu,backendName:"cpu",kernelFunc:a7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jD=Nt((t,e)=>{const n=t-e;return n*n}),i7=Pt(xu,jD),o7={kernelName:xu,backendName:"cpu",kernelFunc:i7};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PD=Da((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:a}=e;return t.replace(new RegExp(n,s?"g":""),a)}),l7=fi(hp,PD),u7={kernelName:hp,backendName:"cpu",kernelFunc:l7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LD(t,e,n,s){const a=Se(t,e.dtype);for(let r=0;r<a.size;r++){const i=a.indexToLoc(r),o=new Array(i.length);for(let l=0;l<o.length;l++)o[l]=i[l]*n[l]+s[l];a.set(e.get(...o),...i)}return a}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c7{constructor(e,n,s,a,r,i){this.separator=xa(e),this.nGramWidths=n,this.leftPad=xa(s),this.rightPad=xa(a),this.padWidth=r,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,a,r,i){for(let o=0;o<r;++o){const l=this.getPadWidth(i),u=Math.max(0,l-o),c=Math.max(0,l-(r-(o+1))),d=i-(u+c),p=n+(u>0?0:o-l);let h=0;h+=u*this.leftPad.length;for(let w=0;w<d;++w)h+=e[p+w].length;h+=c*this.rightPad.length;const f=u+c+d-1;h+=f*this.separator.length,s[a+o]=new Uint8Array(h);const g=s[a+o];let y=0;const m=w=>w.forEach(b=>g[y++]=b);for(let w=0;w<u;++w)m(this.leftPad),m(this.separator);for(let w=0;w<d-1;++w)m(e[p+w]),m(this.separator);if(d>0){m(e[p+d-1]);for(let w=0;w<c;++w)m(this.separator),m(this.rightPad)}else{for(let w=0;w<c-1;++w)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,n){const s=e.length,a=n.length;if(a>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<a;++u){let c=n[u]>=l;if(c=c&&n[u]<=s,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${s}]`);l=n[u]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const r=a-1,i=gt("int32",a);if(s===0||a===0){const l=new Array(s);for(let u=0;u<=r;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=r;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),i[l]=i[l-1]+c}const o=new Array(i[r]);for(let l=0;l<r;++l){const u=n[l];let c=i[l];if(this.nGramWidths.forEach(d=>{const p=n[l+1]-n[l],h=this.getNumNGrams(p,d);this.createNGrams(e,u,o,c,h,d),c+=h}),this.preserveShort&&c===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const p=d+2*this.padWidth;this.createNGrams(e,u,o,c,1,p)}}return[o,i]}}function zD(t,e,n,s,a,r,i,o){return new c7(n,s,a,r,i,o).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d7(t,e,n,s){if(!t.length)return;if(e.length===0){for(let r=0;r<t.length;++r)s.push(t.subarray(r,r+1));return}if(e.length===1){const r=e[0];let i=t.indexOf(r);for(;i!==-1;){const o=t.subarray(0,i);(!n||o.length!==0)&&s.push(o),t=t.subarray(i+1),i=t.indexOf(r)}(!n||t.length!==0)&&s.push(t);return}let a=0;for(let r=0;r<t.length+1;r++)if(r===t.length||e.indexOf(t[r])!==-1){const i=t.subarray(a,r);(!n||i.length!==0)&&s.push(i),a=r+1}}function BD(t,e,n){const s=t.length,a=[];let r=0,i=0;const o=new Array(s);for(let p=0;p<s;++p){const h=a.length;d7(t[p],e,n,a);const f=a.length-h;o[p]=f,r+=f,i=Math.max(i,f)}const l=gt("int32",r*2),u=new Array(r),c=[s,i];let d=0;for(let p=0;p<s;++p)for(let h=0;h<o[p];++h)l[d*2]=p,l[d*2+1]=h,u[d]=a[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MD(t,e){const n=gt("int32",t.length);for(let s=0;s<t.length;++s)n[s]=y$(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VD=Nt((t,e)=>t-e),p7=Y1((t,e,n,s)=>({real:t-n,imag:e-s})),nv=Pt(ku,VD,p7),h7={kernelName:ku,backendName:"cpu",kernelFunc:nv};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WD(t,e){const n=new Array(t.rank);for(let a=0;a<n.length;a++)n[a]=t.shape[a]*e[a];const s=Se(n,t.dtype);for(let a=0;a<s.values.length;++a){const r=s.indexToLoc(a),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=r[l]%t.shape[l];const o=t.locToIndex(i);s.values[a]=t.values[o]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lc=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function UD(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const o=s-n+1,l=e-n+1,u=Math.log(o),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(o-c)/o)*Math.sign(l-o/2),p=Math.max(n,Math.floor(e-l*c/o+d)),h=Math.min(s,Math.floor(e+(o-l)*c/o+d));UD(t,e,p,h)}const a=t[e];let r=n,i=s;for(Ba(t,n,e),lc(t[s],a)>0&&Ba(t,n,s);r<i;){for(Ba(t,r,i),r++,i--;lc(t[r],a)<0;)r=r+1;for(;lc(t[i],a)>0;)i=i-1}lc(t[n],a)===0?Ba(t,n,i):(i=i+1,Ba(t,i,s)),i<=e&&(n=i+1),e<=i&&(s=i-1)}}function GD(t,e,n,s,a){const r=e[e.length-1],[i,o]=[t.length/r,r],l=Wt(n,i*s),u=Wt("int32",i*s);for(let d=0;d<i;d++){const p=d*o,h=t.subarray(p,p+o);let f=new Array(h.length);h.forEach((w,b)=>f[b]={value:w,index:b}),s<f.length&&(UD(f,s),f=f.slice(0,s)),a&&f.sort(lc);const g=d*s,y=l.subarray(g,g+s),m=u.subarray(g,g+s);for(let w=0;w<s;w++)y[w]=f[w].value,m[w]=f[w].index}const c=e.slice();return c[c.length-1]=s,[Se(c,n,l),Se(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HD(t,e,n,s){const a=Ee(e,n)[0],r=[1,n[0],1];for(let f=0;f<a;f++)r[0]*=n[f];r[1]=n[a];for(let f=a+1;f<n.length;f++)r[2]*=n[f];const i=new Map,o=new Int32Array(n[a]),l=new Tt(r,s,t),u=[],c=r[0]===1&&r[2]===1;for(let f=0;f<n[a];f++){let g;if(c)g=t[f].toString();else{const m=[];for(let w=0;w<r[0];w++)for(let b=0;b<r[2];b++)m.push(l.get(w,f,b));g=m.join(",")}const y=i.get(g);if(y!=null)o[f]=y;else{const m=i.size;i.set(g,m),o[f]=m,u.push(f)}}const d=r.slice();d[1]=i.size;const p=new Tt(d,s);u.forEach((f,g)=>{for(let y=0;y<r[0];y++)for(let m=0;m<r[2];m++)p.set(l.get(y,f,m),y,g,m)});const h=n.slice();return h[a]=d[1],{outputValues:p.values,outputShape:h,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f7=Object.freeze(Object.defineProperty({__proto__:null,addImpl:tD,bincountImpl:Q1,bincountReduceImpl:nD,bitwiseAndImpl:sD,castImpl:eD,ceilImpl:aD,concatImpl:rD,equalImpl:iD,expImpl:lD,expm1Impl:cD,floorDivImpl:pD,floorImpl:dD,gatherNdImpl:hD,gatherV2Impl:fD,greaterEqualImpl:gD,greaterImpl:mD,lessEqualImpl:wD,lessImpl:yD,linSpaceImpl:bD,logImpl:xD,maxImpl:kD,maximumImpl:vD,minimumImpl:SD,multiplyImpl:Z1,negImpl:ND,notEqualImpl:CD,prodImpl:ID,raggedGatherImpl:$D,raggedRangeImpl:TD,raggedTensorToTensorImpl:ED,rangeImpl:AD,rsqrtImpl:RD,scatterImpl:Oi,sigmoidImpl:e7,simpleAbsImpl:ZR,sliceImpl:_D,sparseFillEmptyRowsImpl:OD,sparseReshapeImpl:FD,sparseSegmentReductionImpl:tv,sqrtImpl:s7,squaredDifferenceImpl:jD,staticRegexReplaceImpl:PD,stridedSliceImpl:LD,stringNGramsImpl:zD,stringSplitImpl:BD,stringToHashBucketFastImpl:MD,subImpl:VD,tileImpl:WD,topKImpl:GD,transposeImpl:ev,uniqueImpl:HD},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ax("cpu",()=>new C0,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KD=Ve(Ul,t=>t>=0?t:Math.exp(t)-1),m7={kernelName:Ul,backendName:"cpu",kernelFunc:KD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qD(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{alpha:r}=s;he([a],"leakyRelu");const i=H(a.shape),o=n.data.get(a.dataId).values,l=Wt("float32",i);for(let u=0;u<o.length;u++)l[u]=o[u]<0?r*o[u]:o[u];return n.makeTensorInfo(a.shape,"float32",l)}const g7={kernelName:jd,backendName:"cpu",kernelFunc:qD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y7=Nt((t,e)=>t<0?e*t:t);function JD(t){const{inputs:e,backend:n}=t,{x:s,alpha:a}=e;he([s,a],"prelu");const r=n.data.get(s.dataId).values,i=n.data.get(a.dataId).values,[o,l]=y7(s.shape,a.shape,r,i,"float32");return n.makeTensorInfo(l,"float32",o)}const w7={kernelName:tp,backendName:"cpu",kernelFunc:JD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XD=Ve(uu,t=>Math.max(0,t)),b7={kernelName:uu,backendName:"cpu",kernelFunc:XD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YD=Ve(cu,t=>Math.min(Math.max(0,t),6)),x7={kernelName:cu,backendName:"cpu",kernelFunc:YD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hf(t,e,n,s,a){if(n==="linear")return Aa({inputs:{x:e},backend:t});if(n==="relu")return XD({inputs:{x:e},backend:t});if(n==="elu")return KD({inputs:{x:e},backend:t});if(n==="relu6")return YD({inputs:{x:e},backend:t});if(n==="prelu")return JD({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return qD({inputs:{x:e},backend:t,attrs:{alpha:a}});if(n==="sigmoid")return DD({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{shape:r}=s,i=H(a.shape),o=bx(r,i),l=H(o);C(i===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${a.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(a.dataId);const u=n.data.get(a.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=o,d.shape=o}return{dataId:a.dataId,shape:o,dtype:a.dtype}}const k7={kernelName:sp,backendName:"cpu",kernelFunc:Qe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QD(t){const{inputs:e,backend:n,attrs:s}=t,{a,b:r}=e,{transposeA:i,transposeB:o}=s;he([a,r],"matMul");const l=a.shape.length,u=r.shape.length,c=i?a.shape[l-2]:a.shape[l-1],d=o?r.shape[u-1]:r.shape[u-2],p=i?a.shape[l-1]:a.shape[l-2],h=o?r.shape[u-2]:r.shape[u-1],f=a.shape.slice(0,-2),g=r.shape.slice(0,-2),y=H(f),m=H(g),b=ve(a.shape.slice(0,-2),r.shape.slice(0,-2)).concat([p,h]);C(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${a.shape} and ${r.shape} and transposeA=${i} and transposeB=${o} must match.`);const x=i?[y,c,p]:[y,p,c],v=o?[m,h,d]:[m,d,h],S=Qe({inputs:{x:a},backend:n,attrs:{shape:x}}),N=Qe({inputs:{x:r},backend:n,attrs:{shape:v}}),$=i?S.shape[1]:S.shape[2],E=i?S.shape[2]:S.shape[1],A=o?N.shape[1]:N.shape[2],L=Math.max(y,m),W=n.data.get(S.dataId).values,U=n.data.get(N.dataId).values,j=ye(S.shape),z=ye(N.shape),[G,J,O]=i?[j[0],1,j[1]]:[j[0],j[1],1],[M,K,Y]=o?[1,z[1],z[0]]:[z[1],1,z[0]],Q=E*A,te=Se([L,E,A],S.dtype),ae=te.values,se=n.blockSize;for(let le=0;le<L;le++){const me=le%y,xe=le%m;for(let be=0;be<E;be+=se){const Ne=Math.min(be+se,E);for(let Ie=0;Ie<A;Ie+=se){const Be=Math.min(Ie+se,A);for(let qe=0;qe<$;qe+=se){const ft=Math.min(qe+se,$);for(let Je=be;Je<Ne;Je++)for(let We=Ie;We<Be;We++){let ot=0;for(let nt=qe;nt<ft;nt++){const _a=W[me*G+Je*J+nt*O],Kt=U[nt*M+We*K+xe*Y];ot+=_a*Kt}ae[le*Q+(Je*A+We)]+=ot}}}}}return n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(N),n.makeTensorInfo(b,te.dtype,te.values)}const v7={kernelName:xd,backendName:"cpu",kernelFunc:QD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S7(t){const{inputs:e,backend:n,attrs:s}=t,{a,b:r,bias:i,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=s;let p,h,f;const g=[];p=QD({inputs:{a,b:r},attrs:{transposeA:l,transposeB:u},backend:n}),i&&(h=Sl({inputs:{a:p,b:i},backend:n}),g.push(p),p=h),c&&(f=Hf(n,p,c,o,d),g.push(p),p=f);for(const m of g)n.disposeIntermediateTensorInfo(m);return p}const N7={kernelName:Wc,backendName:"cpu",kernelFunc:S7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C7=Ve(Rl,t=>Math.acos(t)),I7={kernelName:Rl,backendName:"cpu",kernelFunc:C7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $7=Ve(Dl,t=>Math.acosh(t)),T7={kernelName:Dl,backendName:"cpu",kernelFunc:$7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E7(t){const{inputs:e,backend:n}=t,s=e;he(e,"addN");const a=s.map(o=>n.data.get(o.dataId).values),r=Se(s[0].shape,s[0].dtype),i=r.values;for(let o=0;o<s.length;o++){const l=a[o];for(let u=0;u<i.length;u++)i[u]+=l[u]}return n.makeTensorInfo(r.shape,r.dtype,r.values)}const A7={kernelName:md,backendName:"cpu",kernelFunc:E7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R7(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;he(a,"all");const o=Ee(r,a.shape);let l=o;const u=ht(l,a.shape.length);let c=a;u!=null&&(c=jn({inputs:{x:a},backend:n,attrs:{perm:u}}),l=vt(l.length,a.shape.length)),nn("all",l,c.shape.length);const[d,p]=Ht(c.shape,l),h=H(p),f=Zt(H(d),c.dtype),g=n.data.get(c.dataId).values;for(let m=0;m<f.length;++m){const w=m*h;let b=g[w];for(let x=0;x<h;++x){const v=g[w+x];b=b&&v}f[m]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const y=n.makeTensorInfo(d,c.dtype,f);if(i){const m=kt(d,o),w=Qe({inputs:{x:y},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(y),w}return y}const D7={kernelName:xm,backendName:"cpu",kernelFunc:R7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _7(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;he(a,"any");const o=Ee(r,a.shape);let l=o;const u=ht(l,a.shape.length);let c=a;u!=null&&(c=jn({inputs:{x:a},backend:n,attrs:{perm:u}}),l=vt(l.length,a.shape.length)),nn("any",l,c.shape.length);const[d,p]=Ht(c.shape,l),h=H(p),f=Zt(H(d),c.dtype),g=n.data.get(c.dataId).values;for(let m=0;m<f.length;++m){const w=m*h;let b=g[w];for(let x=0;x<h;++x){const v=g[w+x];b=b||v}f[m]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const y=n.makeTensorInfo(d,c.dtype,f);if(i){const m=kt(d,o),w=Qe({inputs:{x:y},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(y),w}return y}const O7={kernelName:km,backendName:"cpu",kernelFunc:_7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F7(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r}=s;he(a,"argMax");let i=Ee(r,a.shape);const o=ht(i,a.shape.length);let l=a;const u=[];o!=null&&(l=jn({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),i=vt(i.length,l.shape.length)),i=[i[0]],nn("argMax",i,l.shape.length);const[c,d]=Ht(l.shape,i),p=H(c),h=Zt(p,"int32"),f=H(d),g=n.data.get(l.dataId).values;for(let y=0;y<h.length;++y){const m=y*f;let w=g[m],b=0;for(let x=0;x<f;++x){const v=g[m+x];v>w&&(w=v,b=x)}h[y]=b}return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(c,"int32",h)}const j7={kernelName:gd,backendName:"cpu",kernelFunc:F7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P7(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r}=s;he(a,"argMin");let i=Ee(r,a.shape);const o=ht(i,a.shape.length);let l=a;const u=[];o!=null&&(l=jn({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),i=vt(i.length,l.shape.length)),i=[i[0]],nn("argMin",i,l.shape.length);const[c,d]=Ht(l.shape,i),p=H(c),h=Zt(p,"int32"),f=H(d),g=n.data.get(l.dataId).values;for(let y=0;y<h.length;++y){const m=y*f;let w=g[m],b=0;for(let x=0;x<f;++x){const v=g[m+x];v<w&&(w=v,b=x)}h[y]=b}return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(c,"int32",h)}const L7={kernelName:yd,backendName:"cpu",kernelFunc:P7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z7=Ve(_l,t=>Math.asin(t)),B7={kernelName:_l,backendName:"cpu",kernelFunc:z7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M7=Ve(Ol,t=>Math.asinh(t)),V7={kernelName:Ol,backendName:"cpu",kernelFunc:M7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7=Ve(Fl,t=>Math.atan(t)),U7={kernelName:Fl,backendName:"cpu",kernelFunc:W7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G7=Nt((t,e)=>Math.atan2(t,e)),H7=Pt(Pl,G7),K7={kernelName:Pl,backendName:"cpu",kernelFunc:H7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q7=Ve(jl,t=>Math.atanh(t)),J7={kernelName:jl,backendName:"cpu",kernelFunc:q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sv(t,e,n,s,a,r){const i=a.strideHeight,o=a.strideWidth,l=a.dilationHeight,u=a.dilationWidth,c=a.effectiveFilterHeight,d=a.effectiveFilterWidth,p=a.padInfo.top,h=a.padInfo.left,f=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Se(a.outShape,n),y=g.values,m=a.outShape[1]*a.outShape[2]*a.outShape[3],w=a.outShape[2]*a.outShape[3],b=a.outShape[3];for(let x=0;x<a.batchSize;++x){const v=x*m,S=x*s[0];for(let N=0;N<a.inChannels;++N)for(let $=0;$<a.outHeight;++$){const E=$*i-p,A=Math.max(0,E),L=Math.min(a.inHeight,c+E),W=v+$*w;for(let U=0;U<a.outWidth;++U){const j=U*o-h,z=Math.max(0,j),G=Math.min(a.inWidth,d+j);let J=f,O=0,M=0;for(let Y=A;Y<L;Y+=l){const Q=S+Y*s[1];for(let te=z;te<G;te+=u){const ae=Q+te*s[2],se=t[ae+N];r==="max"&&se>J?J=se:r==="avg"&&(O+=se,M++)}if(isNaN(J))break}const K=W+U*b+N;y[K]=r==="avg"?O/M:J}}}return g}function ZD(t,e,n,s,a=!1,r=!1){const i=Se(s.outShape,"int32"),o=s.strideHeight,l=s.strideWidth,u=s.dilationHeight,c=s.dilationWidth,d=s.effectiveFilterHeight,p=s.effectiveFilterWidth,h=s.padInfo.top,f=s.padInfo.left,g=Se(e,n,t);for(let y=0;y<s.batchSize;++y)for(let m=0;m<s.inChannels;++m)for(let w=0;w<s.outHeight;++w){const b=w*o-h;let x=b;for(;x<0;)x+=u;const v=Math.min(s.inHeight,d+b);for(let S=0;S<s.outWidth;++S){const N=S*l-f;let $=N;for(;$<0;)$+=c;const E=Math.min(s.inWidth,p+N);let A=Number.NEGATIVE_INFINITY,L=-1;for(let W=x;W<v;W+=u){const U=W-b;for(let j=$;j<E;j+=c){const z=j-N,G=g.get(y,W,j,m);G>A&&(A=G,a?L=r?((y*s.inHeight+W)*s.inWidth+j)*s.inChannels+m:(W*s.inWidth+j)*s.inChannels+m:L=U*p+z)}}i.set(L,y,w,S,m)}}return i}function e_(t,e,n,s,a,r){const i=a.strideDepth,o=a.strideHeight,l=a.strideWidth,u=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,p=a.effectiveFilterDepth,h=a.effectiveFilterHeight,f=a.effectiveFilterWidth,g=a.padInfo.front,y=a.padInfo.top,m=a.padInfo.left,w=r==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Se(a.outShape,n),x=b.values,v=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],S=a.outShape[2]*a.outShape[3]*a.outShape[4],N=a.outShape[3]*a.outShape[4],$=a.outShape[4];for(let E=0;E<a.batchSize;++E){const A=E*v,L=E*s[0];for(let W=0;W<a.inChannels;++W)for(let U=0;U<a.outDepth;++U){const j=U*i-g;let z=j;for(;z<0;)z+=u;const G=Math.min(a.inDepth,p+j),J=A+U*S;for(let O=0;O<a.outHeight;++O){const M=O*o-y;let K=M;for(;K<0;)K+=c;const Y=Math.min(a.inHeight,h+M),Q=J+O*N;for(let te=0;te<a.outWidth;++te){const ae=te*l-m;let se=ae;for(;se<0;)se+=d;const le=Math.min(a.inWidth,f+ae),me=Q+te*$;let xe=w,be=0,Ne=0;for(let Be=z;Be<G;Be+=u){const qe=L+Be*s[1];for(let ft=K;ft<Y;ft+=c){const Je=qe+ft*s[2];for(let We=se;We<le;We+=d){const ot=Je+We*s[3],nt=t[ot+W];if(r==="max"&&nt>xe?xe=nt:r==="avg"&&(be+=nt,Ne++),isNaN(xe))break}if(isNaN(xe))break}if(isNaN(xe))break}const Ie=me+W;x[Ie]=r==="avg"?be/Math.max(Ne,1):xe}}}}return b}function X7(t,e){const n=Se(e.outShape,"int32"),s=e.strideDepth,a=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.front,h=e.padInfo.top,f=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let y=0;y<e.inChannels;++y)for(let m=0;m<e.outDepth;++m){const w=m*s-p;let b=w;for(;b<0;)b+=i;const x=Math.min(e.inDepth,u+w);for(let v=0;v<e.outHeight;++v){const S=v*a-h;let N=S;for(;N<0;)N+=o;const $=Math.min(e.inHeight,c+S);for(let E=0;E<e.outWidth;++E){const A=E*r-f;let L=A;for(;L<0;)L+=l;const W=Math.min(e.inWidth,d+A);let U=Number.NEGATIVE_INFINITY,j=-1;for(let z=b;z<x;z+=i){const G=z-w;for(let J=N;J<$;J+=o){const O=J-S;for(let M=L;M<W;M+=l){const K=M-A,Y=t.get(g,z,J,M,y);Y>=U&&(U=Y,j=G*c*d+O*c+K)}}}n.set(j,g,m,v,E,y)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;he(a,"avgPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=s,u=1;C(tn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Fs(a.shape,r,i,u,o,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&Re(c.inShape,c.outShape))d=Aa({inputs:{x:a},backend:n});else{const p=n.data.get(a.dataId).values,h=ye(a.shape),f=sv(p,a.shape,a.dtype,h,c,"avg");d=n.makeTensorInfo(c.outShape,a.dtype,f.values)}return d}const Q7={kernelName:wd,backendName:"cpu",kernelFunc:Y7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z7(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:l,dataFormat:u}=s;he(a,"avgPool3d");const c=ar(a.shape,r,i,1,o,l,u),d=n.data.get(a.dataId).values,p=e_(d,a.shape,a.dtype,ye(a.shape),c,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}const eq={kernelName:bd,backendName:"cpu",kernelFunc:Z7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tq(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,{filterSize:i,strides:o,pad:l,dimRoundingMode:u}=s;he([a,r],"avgPool3DGrad");const c=ar(r.shape,i,o,1,l,u),d=c.strideDepth,p=c.strideHeight,h=c.strideWidth,f=c.filterDepth,g=c.filterHeight,y=c.filterWidth,m=c.dilationDepth,w=c.dilationHeight,b=c.dilationWidth,x=c.effectiveFilterDepth,v=c.effectiveFilterHeight,S=c.effectiveFilterWidth,N=x-1-c.padInfo.front,$=S-1-c.padInfo.left,E=v-1-c.padInfo.top,A=Se(r.shape,"float32"),L=1/(f*g*y),W=n.bufferSync(a);for(let U=0;U<c.batchSize;++U)for(let j=0;j<c.inChannels;++j)for(let z=0;z<c.inDepth;++z)for(let G=0;G<c.inHeight;++G)for(let J=0;J<c.inWidth;++J){const O=z-N,M=G-E,K=J-$;let Y=0;for(let Q=0;Q<x;Q+=m){const te=(O+Q)/d;if(!(te<0||te>=c.outDepth||Math.floor(te)!==te))for(let ae=0;ae<v;ae+=w){const se=(M+ae)/p;if(!(se<0||se>=c.outHeight||Math.floor(se)!==se))for(let le=0;le<S;le+=b){const me=(K+le)/h;if(me<0||me>=c.outWidth||Math.floor(me)!==me)continue;const xe=W.get(U,te,se,me,j);Y+=xe}}}A.set(Y*L,U,z,G,J,j)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const nq={kernelName:Sm,backendName:"cpu",kernelFunc:tq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,i=r;he([a,r],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=s,c=Fs(i.shape,o,l,1,u),d=c.strideHeight,p=c.strideWidth,h=c.filterHeight,f=c.filterWidth,g=c.dilationHeight,y=c.dilationWidth,m=c.effectiveFilterHeight,w=c.effectiveFilterWidth,b=w-1-c.padInfo.left,x=m-1-c.padInfo.top,v=Se(i.shape,"float32"),S=1/(h*f),N=n.data.get(a.dataId).values,$=Se(a.shape,"float32",N);for(let E=0;E<c.batchSize;++E)for(let A=0;A<c.inChannels;++A)for(let L=0;L<c.inHeight;++L)for(let W=0;W<c.inWidth;++W){const U=L-x,j=W-b;let z=0;for(let G=0;G<m;G+=g){const J=(U+G)/d;if(!(J<0||J>=c.outHeight||Math.floor(J)!==J))for(let O=0;O<w;O+=y){const M=(j+O)/p;if(M<0||M>=c.outWidth||Math.floor(M)!==M)continue;const K=$.get(E,J,M,A);z+=K}}v.set(z*S,E,L,W,A)}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const aq={kernelName:vm,backendName:"cpu",kernelFunc:sq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,scale:r,offset:i,mean:o,variance:l}=e;C(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),C(i==null||o.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),C(r==null||o.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),he([a,o,l,r,i],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const c=n.data.get(a.dataId).values,d=n.data.get(o.dataId).values,p=n.data.get(l.dataId).values,h=r?n.data.get(r.dataId).values:new Float32Array([1]),f=i?n.data.get(i.dataId).values:new Float32Array([0]),g=new Float32Array(c.length),y=f.length,m=h.length,w=p.length,b=d.length;let x=0,v=0,S=0,N=0;for(let $=0;$<c.length;++$)g[$]=f[x++]+(c[$]-d[v++])*h[S++]/Math.sqrt(p[N++]+u),x>=y&&(x=0),v>=b&&(v=0),S>=m&&(S=0),N>=w&&(N=0);return n.makeTensorInfo(a.shape,a.dtype,g)}const iq={kernelName:_d,backendName:"cpu",kernelFunc:rq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockShape:r,crops:i}=s;he([a],"batchToSpaceND");const o=r.reduce((m,w)=>m*w),l=Pp(a.shape,r,o),u=Lp(l.length,r.length),c=zp(a.shape,r,o),d=c1(i,r.length),p=d1(c,i,r.length),h=Qe({inputs:{x:a},backend:n,attrs:{shape:l}}),f=jn({inputs:{x:h},backend:n,attrs:{perm:u}}),g=Qe({inputs:{x:f},backend:n,attrs:{shape:c}}),y=oo({inputs:{x:g},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}const lq={kernelName:kd,backendName:"cpu",kernelFunc:oq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,weights:r}=e,{size:i}=s,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,u=Q1(o,l,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,u)}const cq={kernelName:Nm,backendName:"cpu",kernelFunc:uq};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(t){const{inputs:e,backend:n}=t,{s0:s,s1:a}=e,r=n.data.get(s.dataId).values,i=n.data.get(a.dataId).values,o=ve(Array.from(r),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const pq={kernelName:Cm,backendName:"cpu",kernelFunc:dq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hq=Ve(Bl,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),fq={kernelName:Bl,backendName:"cpu",kernelFunc:hq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mq=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(H(e.shape)),a=n.data.get(e.dataId),r=a.complexTensorInfos.real,i=a.complexTensorInfos.imag,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values;for(let u=0;u<o.length;u++){const c=o[u],d=l[u];s[u]=Math.hypot(c,d)}return n.makeOutput(s,e.shape,"float32")},gq={kernelName:Sd,backendName:"cpu",kernelFunc:mq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nl(t){const{inputs:e,backend:n}=t,{input:s}=e,a=n.data.get(s.dataId).complexTensorInfos.imag,r=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,r)}const yq={kernelName:Gm,backendName:"cpu",kernelFunc:Nl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cl(t){const{inputs:e,backend:n,attrs:s}=t,{axis:a}=s,r=Ee(a,e[0].shape)[0],i=e.map(g=>g.shape);o1(i,r);let o=va(e.map(g=>g.shape),r);if(H(o)===0)return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(g=>H(g.shape)>0);if(l.length===1)return Aa({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(x=>io({inputs:{input:x},backend:n})),y=l.map(x=>Nl({inputs:{input:x},backend:n})),m=Cl({inputs:g,backend:n,attrs:{axis:r}}),w=Cl({inputs:y,backend:n,attrs:{axis:r}}),b=Un({inputs:{real:m,imag:w},backend:n});return g.forEach(x=>n.disposeIntermediateTensorInfo(x)),y.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(w),b}const u=l.map(g=>{const m=[-1,H(g.shape.slice(r))];return Qe({inputs:{x:g},backend:n,attrs:{shape:m}})}),c=u.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));o=va(u.map(g=>g.shape),1);const d=u[0].shape[0]===1,p=rD(c,o,e[0].dtype,d),h=va(l.map(g=>g.shape),r),f=n.makeTensorInfo(h,e[0].dtype,p);return u.forEach(g=>n.disposeIntermediateTensorInfo(g)),f}const wq={kernelName:Nd,backendName:"cpu",kernelFunc:Cl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=s;he([a,r],"conv2d");const d=rr(l),p=Gt(a.shape,r.shape,i,u,o,c,!1,d),h=p.filterHeight,f=p.filterWidth,g=p.dilationHeight,y=p.dilationWidth,m=p.padInfo.left,w=p.padInfo.top,b=p.dataFormat==="channelsLast",x=new Tt(p.outShape,a.dtype),v=ye(a.shape),S=ye(r.shape),N=v[0],$=b?v[1]:v[2],E=b?v[2]:1,A=b?1:v[1],L=x.strides[0],W=b?x.strides[1]:x.strides[2],U=b?x.strides[2]:1,j=b?1:x.strides[1],z=n.data.get(a.dataId).values,G=n.data.get(r.dataId).values,J=x.values;for(let O=0;O<p.batchSize;++O){const M=O*N,K=O*L;for(let Y=0;Y<p.outHeight;++Y){const Q=K+Y*W,te=Y*p.strideHeight-w;for(let ae=0;ae<h;++ae){const se=te+ae*g;if(se<0||se>=p.inHeight)continue;const le=ae*S[0],me=M+se*$;for(let xe=0;xe<p.outWidth;++xe){const be=Q+xe*U,Ne=xe*p.strideWidth-m;for(let Ie=0;Ie<f;++Ie){const Be=Ne+Ie*y;if(Be<0||Be>=p.inWidth)continue;const qe=le+Ie*S[1],ft=me+Be*E;let Je=qe;for(let We=0;We<p.inChannels;++We){const ot=z[ft+We*A];for(let nt=0;nt<p.outChannels;++nt)J[be+nt*j]+=ot*G[Je+nt];Je+=p.outChannels}}}}}}return n.makeTensorInfo(x.shape,x.dtype,J)}const bq={kernelName:Cd,backendName:"cpu",kernelFunc:t_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=s;he([a,r],"conv2dBackpropFilter");const d=rr(l),p=Gt(a.shape,c,i,1,o,u,!1,d),{strideHeight:h,strideWidth:f,filterHeight:g,filterWidth:y}=p,m=p.dataFormat==="channelsLast",w=new Tt(p.filterShape,"float32"),b=p.padInfo.left,x=p.padInfo.top,v=n.data.get(a.dataId).values,S=n.data.get(r.dataId).values,N=new Tt(a.shape,a.dtype,v),$=new Tt(r.shape,r.dtype,S);for(let E=0;E<g;++E){const A=Math.max(0,Math.ceil((x-E)/h)),L=Math.min(p.outHeight,(p.inHeight+x-E)/h);for(let W=0;W<y;++W){const U=Math.max(0,Math.ceil((b-W)/f)),j=Math.min(p.outWidth,(p.inWidth+b-W)/f);for(let z=0;z<p.inChannels;++z)for(let G=0;G<p.outChannels;++G){let J=0;for(let O=0;O<p.batchSize;++O)for(let M=A;M<L;++M){const K=E+M*h-x;for(let Y=U;Y<j;++Y){const Q=W+Y*f-b;m?J+=N.get(O,K,Q,z)*$.get(O,M,Y,G):J+=N.get(O,z,K,Q)*$.get(O,G,M,Y)}}w.set(J,E,W,z,G)}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const kq={kernelName:$m,backendName:"cpu",kernelFunc:xq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{inputShape:i,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=s;he([a,r],"conv2dBackpropInput");const d=ye(r.shape),p=ye(a.shape);let h=rr(u);const f=Gt(i,r.shape,o,1,l,c,!1,h),g=new Tt(f.inShape,"float32"),y=g.values,m=n.data.get(a.dataId).values,w=n.data.get(r.dataId).values,[b,x,v]=d,{batchSize:S,filterHeight:N,filterWidth:$,inChannels:E,inHeight:A,inWidth:L,outChannels:W,outHeight:U,outWidth:j,strideHeight:z,strideWidth:G}=f;h=f.dataFormat;const J=N-1-f.padInfo.top,O=$-1-f.padInfo.left,M=h==="channelsLast",K=g.strides[0],Y=M?g.strides[1]:g.strides[2],Q=M?g.strides[2]:1,te=M?1:g.strides[1],ae=p[0],se=M?p[1]:p[2],le=M?p[2]:1,me=M?1:p[1];for(let xe=0;xe<S;++xe)for(let be=0;be<E;++be)for(let Ne=0;Ne<A;++Ne){const Ie=Ne-J,Be=Math.max(0,Math.ceil(Ie/z)),qe=Math.min(U,(N+Ie)/z);for(let ft=0;ft<L;++ft){const Je=ft-O,We=Math.max(0,Math.ceil(Je/G)),ot=Math.min(j,($+Je)/G);let nt=0;for(let Kt=Be;Kt<qe;++Kt){const dr=Kt*z-Ie;for(let ns=We;ns<ot;++ns){const gi=ns*G-Je,Ls=ae*xe+se*Kt+le*ns,Oa=b*(N-1-dr)+x*($-1-gi)+v*be;for(let pr=0;pr<W;++pr){const hr=m[Ls+me*pr],fr=w[Oa+pr];nt+=hr*fr}}}const _a=K*xe+Y*Ne+Q*ft+te*be;y[_a]=nt}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const Sq={kernelName:Id,backendName:"cpu",kernelFunc:vq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l}=s;he([a,r],"conv3d");const u=oi(a.shape,r.shape,i,l,o),{filterDepth:c,filterHeight:d,filterWidth:p,dilationDepth:h,dilationHeight:f,dilationWidth:g,padInfo:y}=u,m=y.front,w=y.left,b=y.top,x=new Tt(u.outShape,a.dtype),v=n.data.get(a.dataId).values,S=n.data.get(r.dataId).values,N=x.values,$=ye(a.shape),E=ye(r.shape);for(let A=0;A<u.batchSize;++A){const L=A*$[0],W=A*x.strides[0];for(let U=0;U<u.outDepth;++U){const j=W+U*x.strides[1],z=U*u.strideDepth-m;for(let G=0;G<c;++G){const J=z+G*h;if(J<0||J>=u.inDepth)continue;const O=G*E[0],M=L+J*$[1];for(let K=0;K<u.outHeight;++K){const Y=j+K*x.strides[2],Q=K*u.strideHeight-b;for(let te=0;te<d;++te){const ae=Q+te*f;if(ae<0||ae>=u.inHeight)continue;const se=O+te*E[1],le=M+ae*$[2];for(let me=0;me<u.outWidth;++me){const xe=Y+me*u.outChannels,be=me*u.strideWidth-w;for(let Ne=0;Ne<p;++Ne){const Ie=be+Ne*g;if(Ie<0||Ie>=u.inWidth)continue;const Be=se+Ne*E[2],qe=le+Ie*u.inChannels;let ft=Be;for(let Je=0;Je<u.inChannels;++Je){const We=v[qe+Je];for(let ot=0;ot<u.outChannels;++ot)N[xe+ot]+=We*S[ft+ot];ft+=u.outChannels}}}}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Cq={kernelName:$d,backendName:"cpu",kernelFunc:Nq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,pad:o,filterShape:l}=s;he([a,r],"conv3dBackpropFilterV2");const u=ye(a.shape),c=ye(r.shape),d=oi(a.shape,l,i,1,o),p=d.strideDepth,h=d.strideHeight,f=d.strideWidth,g=d.filterDepth,y=d.filterHeight,m=d.filterWidth,w=new Tt(d.filterShape,"float32"),b=w.values,[x,v,S,N]=w.strides,$=n.data.get(r.dataId).values,[E,A,L,W]=c,U=n.data.get(a.dataId).values,[j,z,G,J]=u,O=d.padInfo.front,M=d.padInfo.left,K=d.padInfo.top;for(let Y=0;Y<g;++Y){const Q=Math.max(0,Math.ceil((O-Y)/p)),te=Math.min(d.outDepth,(d.inDepth+O-Y)/p),ae=Y*x;for(let se=0;se<y;++se){const le=Math.max(0,Math.ceil((K-se)/h)),me=Math.min(d.outHeight,(d.inHeight+K-se)/h),xe=se*v+ae;for(let be=0;be<m;++be){const Ne=Math.max(0,Math.ceil((M-be)/f)),Ie=Math.min(d.outWidth,(d.inWidth+M-be)/f),Be=be*S+xe;for(let qe=0;qe<d.inChannels;++qe){const ft=qe*N+Be;for(let Je=0;Je<d.outChannels;++Je){let We=0;for(let ot=0;ot<d.batchSize;++ot){const nt=ot*j,_a=ot*E;for(let Kt=Q;Kt<te;++Kt){const ns=(Y+Kt*p-O)*z+nt,gi=Kt*A+_a;for(let Ls=le;Ls<me;++Ls){const pr=(se+Ls*h-K)*G+ns,hr=Ls*L+gi;for(let fr=Ne;fr<Ie;++fr){const D0=(be+fr*f-M)*J+pr,_0=fr*W+hr;We+=U[D0+qe]*$[_0+Je]}}}}b[ft+Je]=We}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const $q={kernelName:Tm,backendName:"cpu",kernelFunc:Iq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tq(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{pad:i,strides:o,inputShape:l}=s;he([a],"conv3dBackpropInputV2");const u=ye(a.shape),c=ye(r.shape),d=oi(l,r.shape,o,1,i),p=new Tt(d.inShape,"float32"),h=p.values,[f,g,y,m]=p.strides,w=n.data.get(a.dataId).values,[b,x,v,S]=u,N=n.data.get(r.dataId).values,[$,E,A,L]=c,{batchSize:W,filterDepth:U,filterHeight:j,filterWidth:z,inChannels:G,inDepth:J,inHeight:O,inWidth:M,outChannels:K,outDepth:Y,outHeight:Q,outWidth:te,strideDepth:ae,strideHeight:se,strideWidth:le}=d,me=U-1-d.padInfo.front,xe=j-1-d.padInfo.top,be=z-1-d.padInfo.left;for(let Ne=0;Ne<W;++Ne)for(let Ie=0;Ie<G;++Ie)for(let Be=0;Be<J;++Be){const qe=Be-me,ft=Math.max(0,Math.ceil(qe/ae)),Je=Math.min(Y,(U+qe)/ae);for(let We=0;We<O;++We){const ot=We-xe,nt=Math.max(0,Math.ceil(ot/se)),_a=Math.min(Q,(j+ot)/se);for(let Kt=0;Kt<M;++Kt){const dr=Kt-be,ns=Math.max(0,Math.ceil(dr/le)),gi=Math.min(te,(z+dr)/le);let Ls=0;for(let Oa=ft;Oa<Je;++Oa){const pr=Oa*ae-qe;for(let hr=nt;hr<_a;++hr){const fr=hr*se-ot;for(let Vu=ns;Vu<gi;++Vu){const D0=Vu*le-dr,_0=b*Ne+x*Oa+v*hr+S*Vu,nO=$*(U-1-pr)+E*(j-1-fr)+A*(z-1-D0)+L*Ie;for(let eh=0;eh<K;++eh){const sO=w[_0+eh],aO=N[nO+eh];Ls+=sO*aO}}}}h[f*Ne+g*Be+y*We+m*Kt+Ie]=Ls}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Eq={kernelName:Em,backendName:"cpu",kernelFunc:Tq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aq=Ve(Ml,t=>Math.cos(t)),Rq={kernelName:Ml,backendName:"cpu",kernelFunc:Aq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dq=Ve(Vl,t=>Math.cosh(t)),_q={kernelName:Vl,backendName:"cpu",kernelFunc:Dq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oq(t){const{inputs:e,backend:n,attrs:s}=t,{image:a,boxes:r,boxInd:i}=e,{cropSize:o,method:l,extrapolationValue:u}=s,[c,d,p,h]=a.shape,f=r.shape[0],[g,y]=o,m=Se([f,g,y,h],"float32"),w=n.data.get(r.dataId).values,b=n.data.get(i.dataId).values,x=n.data.get(a.dataId).values,v=ye(a.shape),S=ye(m.shape);for(let N=0;N<f;N++){const $=N*4,E=w[$],A=w[$+1],L=w[$+2],W=w[$+3],U=b[N];if(U>=c)continue;const j=g>1?(L-E)*(d-1)/(g-1):0,z=y>1?(W-A)*(p-1)/(y-1):0;for(let G=0;G<g;G++){const J=g>1?E*(d-1)+G*j:.5*(E+L)*(d-1);if(J<0||J>d-1){for(let O=0;O<y;O++)for(let M=0;M<h;M++){const K=M+O*S[2]+G*S[1]+N*S[0];m.values[K]=u}continue}if(l==="bilinear"){const O=Math.floor(J),M=Math.ceil(J),K=J-O;for(let Y=0;Y<y;Y++){const Q=y>1?A*(p-1)+Y*z:.5*(A+W)*(p-1);if(Q<0||Q>p-1){for(let le=0;le<h;le++){const me=le+Y*S[2]+G*S[1]+N*S[0];m.values[me]=u}continue}const te=Math.floor(Q),ae=Math.ceil(Q),se=Q-te;for(let le=0;le<h;le++){let me=le+te*v[2]+O*v[1]+U*v[0];const xe=x[me];me=le+ae*v[2]+O*v[1]+U*v[0];const be=x[me];me=le+te*v[2]+M*v[1]+U*v[0];const Ne=x[me];me=le+ae*v[2]+M*v[1]+U*v[0];const Ie=x[me],Be=xe+(be-xe)*se,qe=Ne+(Ie-Ne)*se;me=le+Y*S[2]+G*S[1]+N*S[0],m.values[me]=Be+(qe-Be)*K}}}else for(let O=0;O<y;++O){const M=y>1?A*(p-1)+O*z:.5*(A+W)*(p-1);if(M<0||M>p-1){for(let Q=0;Q<h;Q++){const te=Q+O*S[2]+G*S[1]+N*S[0];m.values[te]=u}continue}const K=Math.round(M),Y=Math.round(J);for(let Q=0;Q<h;Q++){const te=Q+K*v[2]+Y*v[1]+U*v[0],ae=Q+O*S[2]+G*S[1]+N*S[0];m.values[ae]=x[te]}}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const Fq={kernelName:Rm,backendName:"cpu",kernelFunc:Oq};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,exclusive:i,reverse:o}=s;he(a,"cumprod");const l=ht([r],a.shape.length);let u=a;l!=null&&(u=jn({inputs:{x:a},backend:n,attrs:{perm:l}}));const c=vt(1,a.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=Rn(u.dtype,"int32"),p=bm(H(u.shape),d),h=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],g=o?(m,w)=>m+f-w-1:(m,w)=>m+w;for(let m=0;m<h.length;m+=f)for(let w=0;w<f;w++){const b=g(m,w);if(w===0)p[b]=i?1:h[b];else{const x=g(m,w-1);p[b]=i?h[x]*p[x]:h[b]*p[x]}}const y=n.makeTensorInfo(u.shape,d,p);if(l!=null){const m=li(l),w=jn({inputs:{x:y},backend:n,attrs:{perm:m}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(u),w}return y}const Pq={kernelName:Am,backendName:"cpu",kernelFunc:jq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,exclusive:i,reverse:o}=s;he(a,"cumsum");const l=ht([r],a.shape.length);let u=a;l!=null&&(u=jn({inputs:{x:a},backend:n,attrs:{perm:l}}));const c=vt(1,a.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=Rn(u.dtype,"int32"),p=Zt(H(u.shape),d),h=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],g=o?(m,w)=>m+f-w-1:(m,w)=>m+w;for(let m=0;m<h.length;m+=f)for(let w=0;w<f;w++){const b=g(m,w);if(w===0)p[b]=i?0:h[b];else{const x=g(m,w-1);p[b]=i?h[x]+p[x]:h[b]+p[x]}}const y=n.makeTensorInfo(u.shape,d,p);if(l!=null){const m=li(l),w=jn({inputs:{x:y},backend:n,attrs:{perm:m}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(u),w}return y}const zq={kernelName:Td,backendName:"cpu",kernelFunc:Lq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,weights:r}=e,{size:i,binaryOutput:o}=s;if(a.shape.length===1){const l=n.data.get(a.dataId).values,u=n.data.get(r.dataId).values,c=Q1(l,u,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,c)}else if(a.shape.length===2){const l=n.bufferSync(a),u=n.bufferSync(r),c=nD(l,u,i,o);return n.makeTensorInfo(c.shape,r.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const Mq={kernelName:Dm,backendName:"cpu",kernelFunc:Bq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockSize:r,dataFormat:i}=s;C(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const o=a.shape[0],l=a.shape[1],u=a.shape[2],c=a.shape[3],d=l*r,p=u*r,h=c/(r*r),f=n.data.get(a.dataId).values,g=new Float32Array(o*d*p*h);let y=0;for(let m=0;m<o;++m)for(let w=0;w<d;++w){const b=Math.floor(w/r),x=w%r;for(let v=0;v<p;++v){const S=Math.floor(v/r),N=v%r,$=(x*r+N)*h;for(let E=0;E<h;++E){const L=E+$+c*(S+u*(b+l*m));g[y++]=f[L]}}}return n.makeTensorInfo([o,d,p,h],a.dtype,g)}const Wq={kernelName:_m,backendName:"cpu",kernelFunc:Vq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l,dimRoundingMode:u}=s;he([a,r],"depthwiseConv2DNative");const c=ye(a.shape),d=ye(r.shape);let p=l;p==null&&(p=[1,1]),C(tn(i,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${p}'`);const h=Gt(a.shape,r.shape,i,p,o,u,!0),{filterHeight:f,filterWidth:g,dilationHeight:y,dilationWidth:m,padInfo:w}=h,b=w.left,x=w.top,v=h.outChannels/h.inChannels,S=new Tt(h.outShape,a.dtype),N=n.data.get(a.dataId).values,$=n.data.get(r.dataId).values,E=S.values;for(let A=0;A<h.batchSize;++A){const L=A*c[0],W=A*S.strides[0];for(let U=0;U<h.outHeight;++U){const j=W+U*S.strides[1],z=U*h.strideHeight-x;for(let G=0;G<f;++G){const J=z+G*y;if(J<0||J>=h.inHeight)continue;const O=G*d[0],M=L+J*c[1];for(let K=0;K<h.outWidth;++K){const Y=j+K*S.strides[2],Q=K*h.strideWidth-b;for(let te=0;te<g;++te){const ae=Q+te*m;if(ae<0||ae>=h.inWidth)continue;const se=O+te*d[1],le=M+ae*h.inChannels;let me=Y,xe=se;for(let be=0;be<h.inChannels;++be){const Ne=N[le+be];for(let Ie=0;Ie<v;++Ie)E[me+Ie]+=Ne*$[xe+Ie];me+=v,xe+=v}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const Uq={kernelName:Ed,backendName:"cpu",kernelFunc:n_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gq(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=s;he([a,r],"depthwiseConv2dNativeBackpropFilter");const d=Gt(a.shape,c,i,o,l,u,!0),{strideHeight:p,strideWidth:h,filterHeight:f,filterWidth:g}=d,y=new Tt(d.filterShape,"float32"),m=d.padInfo.left,w=d.padInfo.top,b=d.outChannels/d.inChannels,x=n.data.get(a.dataId).values,v=new Tt(a.shape,a.dtype,x),S=n.data.get(r.dataId).values,N=new Tt(r.shape,r.dtype,S);for(let $=0;$<f;++$){const E=Math.max(0,Math.ceil((w-$)/p)),A=Math.min(d.outHeight,(d.inHeight+w-$)/p);for(let L=0;L<g;++L){const W=Math.max(0,Math.ceil((m-L)/h)),U=Math.min(d.outWidth,(d.inWidth+m-L)/h);for(let j=0;j<d.outChannels;++j){const z=Math.trunc(j/b),G=j%b;let J=0;for(let O=0;O<d.batchSize;++O)for(let M=E;M<A;++M){const K=$+M*p-w;for(let Y=W;Y<U;++Y){const Q=L+Y*h-m;J+=v.get(O,K,Q,z)*N.get(O,M,Y,j)}}y.set(J,$,L,z,G)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Hq={kernelName:Om,backendName:"cpu",kernelFunc:Gq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kq(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=s;he([a,r],"depthwiseConv2DNativeBackpropInput");const d=ye(a.shape),p=ye(r.shape),h=Gt(c,r.shape,i,o,l,u,!0),f=new Tt(h.inShape,"float32"),g=f.values,[y,m,w]=f.strides,b=n.data.get(a.dataId).values,[x,v,S]=d,N=n.data.get(r.dataId).values,[$,E,A]=p,{batchSize:L,filterHeight:W,filterWidth:U,inChannels:j,inHeight:z,inWidth:G,outChannels:J,outHeight:O,outWidth:M,strideHeight:K,strideWidth:Y}=h,Q=W-1-h.padInfo.top,te=U-1-h.padInfo.left,ae=J/j;for(let se=0;se<L;++se)for(let le=0;le<j;++le)for(let me=0;me<z;++me){const xe=me-Q,be=Math.max(0,Math.ceil(xe/K)),Ne=Math.min(O,(W+xe)/K);for(let Ie=0;Ie<G;++Ie){const Be=Ie-te,qe=Math.max(0,Math.ceil(Be/Y)),ft=Math.min(M,(U+Be)/Y);let Je=0;for(let We=be;We<Ne;++We){const ot=We*K-xe;for(let nt=qe;nt<ft;++nt){const _a=nt*Y-Be,Kt=x*se+v*We+S*nt,dr=$*(W-1-ot)+E*(U-1-_a)+A*le;for(let ns=0;ns<ae;++ns){const gi=le*ae+ns,Ls=b[Kt+gi],Oa=N[dr+ns];Je+=Ls*Oa}}}g[y*se+m*me+w*Ie+le]=Je}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const qq={kernelName:Fm,backendName:"cpu",kernelFunc:Kq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jq(t){const{inputs:e,backend:n}=t,{x:s}=e,a=H(s.shape),r=n.data.get(s.dataId).values,i=Se([a,a],s.dtype),o=i.values;for(let u=0;u<r.length;u++)o[u*a+u]=r[u];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const Xq={kernelName:jm,backendName:"cpu",kernelFunc:Jq};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yq={kernelName:Ad,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:a}=t,{strides:r,pad:i,dilations:o}=n,l=e,u=l.data.get(s.dataId).values,c=s.shape.length,d=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:h,inHeight:f,inWidth:g,inChannels:y,outHeight:m,outWidth:w,padInfo:b,strideHeight:x,strideWidth:v,filterHeight:S,filterWidth:N,dilationHeight:$,dilationWidth:E,outShape:A}=bp(s.shape,a.shape,r,i,"NHWC",o),L=H(A),W=A.length,U=gt(s.dtype,L);for(let z=0;z<h;++z)for(let G=0;G<m;++G){const J=G*x-b.top;for(let O=0;O<w;++O){const M=O*v-b.left;for(let K=0;K<y;++K){let Y=Number.MIN_SAFE_INTEGER;for(let te=0;te<S;++te){const ae=J+te*$;if(ae>=0&&ae<f)for(let se=0;se<N;++se){const le=M+se*E;if(le>=0&&le<g){const me=Qs([z,ae,le,K],c,ye(s.shape)),xe=Qs([te,se,K],p,ye(a.shape)),be=u[me]+d[xe];be>Y&&(Y=be)}}}const Q=Qs([z,G,O,K],W,ye(A));U[Q]=Y}}}return{dataId:l.write(ri(U,s.dtype),A,s.dtype),shape:A,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qq={kernelName:If,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:a,dy:r}=t,{strides:i,pad:o,dilations:l}=n,u=e,c=cs(s.shape,u.data.get(s.dataId).values),d=cs(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:g,outHeight:y,outWidth:m,padInfo:w,strideHeight:b,strideWidth:x,filterHeight:v,filterWidth:S,dilationHeight:N,dilationWidth:$,outShape:E}=bp(s.shape,a.shape,i,o,"NHWC",l);C(r.rank===E.length,()=>`Error in ${If}, dy must have the same rank as output ${E.length}, but got ${r.rank}`);const A=cs(E,u.data.get(r.dataId).values),L=kx(a.shape,a.dtype);for(let U=0;U<p;++U)for(let j=0;j<y;++j){const z=j*b-w.top;for(let G=0;G<m;++G){const J=G*x-w.left;for(let O=0;O<g;++O){let M=Number.MIN_SAFE_INTEGER,K=0,Y=0;for(let Q=0;Q<v;++Q){const te=z+Q*N;if(te>=0&&te<h)for(let ae=0;ae<S;++ae){const se=J+ae*$;if(se>=0&&se<f){const le=c[U][te][se][O]+d[Q][ae][O];le>M&&(M=le,K=Q,Y=ae)}}}L[K][Y][O]+=A[U][j][G][O]}}}return{dataId:u.write(ri(L,s.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zq={kernelName:Cf,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:a,dy:r}=t,{strides:i,pad:o,dilations:l}=n,u=e,c=cs(s.shape,u.data.get(s.dataId).values),d=cs(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:h,inWidth:f,inChannels:g,outHeight:y,outWidth:m,padInfo:w,strideHeight:b,strideWidth:x,filterHeight:v,filterWidth:S,dilationHeight:N,dilationWidth:$,outShape:E}=bp(s.shape,a.shape,i,o,"NHWC",l);C(r.rank===E.length,()=>`Error in ${Cf}, dy must have the same rank as output ${E.length}, but got ${r.rank}`);const A=cs(E,u.data.get(r.dataId).values),L=kx(s.shape,s.dtype);for(let U=0;U<p;++U)for(let j=0;j<y;++j){const z=j*b-w.top;for(let G=0;G<m;++G){const J=G*x-w.left;for(let O=0;O<g;++O){let M=Number.MIN_SAFE_INTEGER,K=z<0?0:z,Y=J<0?0:J;for(let Q=0;Q<v;++Q){const te=z+Q*N;if(te>=0&&te<h)for(let ae=0;ae<S;++ae){const se=J+ae*$;if(se>=0&&se<f){const le=c[U][te][se][O]+d[Q][ae][O];le>M&&(M=le,K=te,Y=se)}}}L[U][K][Y][O]+=A[U][j][G][O]}}}return{dataId:u.write(ri(L,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(t){const{inputs:e,backend:n,attrs:s}=t,{image:a}=e,{canvas:r,options:i}=s,{contextOptions:o,imageOptions:l}=i||{},u=(l==null?void 0:l.alpha)||1,c=(o==null?void 0:o.contextType)||"2d";if(c!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const d=r.getContext(c,(o==null?void 0:o.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${c} type.`);const[p,h]=a.shape.slice(0,2),f=a.shape.length===2?1:a.shape[2],g=n.data.get(a.dataId).values,y=a.dtype==="float32"?255:1,m=new Uint8ClampedArray(h*p*4);for(let b=0;b<p*h;++b){const x=[0,0,0,255*u];for(let S=0;S<f;S++){const N=g[b*f+S];if(a.dtype==="float32"){if(N<0||N>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${N}.`)}else if(a.dtype==="int32"&&(N<0||N>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${N}.`);f===1?(x[0]=N*y,x[1]=N*y,x[2]=N*y):x[S]=N*y}const v=b*4;m[v+0]=Math.round(x[0]),m[v+1]=Math.round(x[1]),m[v+2]=Math.round(x[2]),m[v+3]=Math.round(x[3])}r.width=h,r.height=p;const w=new ImageData(m,h,p);return d.putImageData(w,0,0),a}const t9={kernelName:Pm,backendName:"cpu",kernelFunc:e9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qp(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;he(a,"sum");let o;a.dtype==="bool"?o=Qr({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):o=Aa({inputs:{x:a},backend:n});const l=o.shape.length,u=Ee(r,o.shape),c=ht(u,l);let d=u,p=o;c!=null&&(p=jn({inputs:{x:o},backend:n,attrs:{perm:c}}),d=vt(d.length,l)),nn("sum",d,p.shape.length);const[h,f]=Ht(p.shape,d),g=Rn(p.dtype,"int32");let y=Uf(n,h,g);const m=H(f),w=n.data.get(y.dataId).values,b=n.data.get(p.dataId).values;for(let x=0;x<w.length;++x){const v=x*m;let S=0;for(let N=0;N<m;++N)S+=b[v+N];w[x]=S}if(i){const x=kt(y.shape,u),v=y;y=Qe({inputs:{x:y},backend:n,attrs:{shape:x}}),n.disposeIntermediateTensorInfo(v)}return n.disposeIntermediateTensorInfo(o),c!=null&&n.disposeIntermediateTensorInfo(p),y}const n9={kernelName:up,backendName:"cpu",kernelFunc:qp};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(t){const{inputs:e,backend:n,attrs:s}=t,{equation:a}=s,r=e,{allDims:i,summedDims:o,idDims:l}=b1(a,r.length);k1(i.length,l,r);const{path:u,steps:c}=v1(o,l),d=c.length;let p=null,h=i.length;const f=[];for(let g=0;g<d;++g){for(const y of c[g]){const{permutationIndices:m,expandDims:w}=x1(h,l[y]);let b;S1(m)?b=r[y]:(b=jn({inputs:{x:r[y]},backend:n,attrs:{perm:m}}),f.push(b));const x=b.shape.slice();for(let v=0;v<w.length;++v)x.splice(w[v],0,1);Re(b.shape,x)||(b=Qe({inputs:{x:b},backend:n,attrs:{shape:x}}),f.push(b)),p===null?p=b:(p=I0({inputs:{a:b,b:p},backend:n}),f.push(p))}g<d-1&&(u[g]>=0&&(p=qp({inputs:{x:p},backend:n,attrs:{axis:u[g]-(i.length-h),keepDims:!1}}),f.push(p)),h--)}for(const g of f)g!==p&&n.disposeIntermediateTensorInfo(g);return p}const a9={kernelName:Lm,backendName:"cpu",kernelFunc:s9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r9(t){const{inputs:e,backend:n}=t,{dy:s,y:a}=e;he([s,a],"eluGrad");const r=new Float32Array(H(a.shape)),i=n.data.get(a.dataId).values,o=n.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const u=i[l];u>=0?r[l]=o[l]:r[l]=o[l]*(u+1)}return n.makeTensorInfo(a.shape,"float32",r)}const i9={kernelName:zm,backendName:"cpu",kernelFunc:r9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o9=p1,l9=h1,u9=f1,c9=m1,d9=g1,p9=y1,h9=Ve(Gl,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+o9*n);return e*(1-((((p9*s+d9)*s+c9)*s+u9)*s+l9)*s*Math.exp(-n*n))}),f9={kernelName:Gl,backendName:"cpu",kernelFunc:h9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kf(t){const{inputs:e,backend:n,attrs:s}=t,{input:a}=e,{dim:r}=s,i=a.shape.length,o=a.shape.slice();let l=r;return r<0&&(C(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),o.splice(l,0,1),Qe({inputs:{x:a},backend:n,attrs:{shape:o}})}const m9={kernelName:Dd,backendName:"cpu",kernelFunc:Kf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g9=Nt((t,e)=>t/e),av=Pt(Wl,g9),pb={kernelName:Wl,backendName:"cpu",kernelFunc:av};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_(t,e,n){const s=t.shape,a=s[0],r=s[1],i=n.data.get(t.dataId),o=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,u=[a,r],c=H(u),d=Wt("float32",c),p=Wt("float32",c);for(let y=0;y<a;y++){const m=oo({inputs:{x:o},backend:n,attrs:{begin:[y,0],size:[1,r]}}),w=oo({inputs:{x:l},backend:n,attrs:{begin:[y,0],size:[1,r]}}),b=Un({inputs:{real:m,imag:w},backend:n}),{real:x,imag:v}=y9(b,e,n),S=Za(x,v);for(let N=0;N<r;N++){const $=w1(S,N);d[y*r+N]=$.real,p[y*r+N]=$.imag}n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(w),n.disposeIntermediateTensorInfo(b)}const h=n.makeTensorInfo(u,"float32",d),f=n.makeTensorInfo(u,"float32",p),g=Un({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),g}function y9(t,e,n){const s=H(t.shape),a=n.data.get(t.dataId),r=n.data.get(a.complexTensorInfos.real.dataId).values,i=n.data.get(a.complexTensorInfos.imag.dataId).values;if(w9(s)){const o=hb(r,i,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",o.real),c=n.makeTensorInfo(l,"float32",o.imag),d=n.makeTensorInfo([],"float32",sr(s,"float32")),p=Aa({inputs:{x:d},backend:n}),h=pb.kernelFunc({inputs:{a:u,b:d},backend:n}),f=pb.kernelFunc({inputs:{a:c,b:p},backend:n}),g=n.data.get(h.dataId).values,y=n.data.get(f.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),{real:g,imag:y}}return o}else{const o=Za(r,i),l=b9(o,s,e);return pE(l)}}function w9(t){return(t&t-1)===0}function hb(t,e,n,s,a){if(n===1)return{real:t,imag:e};const r=Za(t,e),i=n/2,o=hE(r),l=o.real,u=o.imag,c=[l.length],d=a.makeTensorInfo(c,"float32",l),p=a.makeTensorInfo(c,"float32",u),h=Un({inputs:{real:d,imag:p},backend:a}),f=fE(r),g=f.real,y=f.imag,m=[g.length],w=a.makeTensorInfo(m,"float32",g),b=a.makeTensorInfo(m,"float32",y),x=Un({inputs:{real:w,imag:b},backend:a}),v=hb(l,u,i,s,a),S=v.real,N=v.imag,$=[S.length],E=a.makeTensorInfo($,"float32",S),A=a.makeTensorInfo($,"float32",N),L=Un({inputs:{real:E,imag:A},backend:a}),W=hb(g,y,i,s,a),U=W.real,j=W.imag,z=[U.length],G=a.makeTensorInfo(z,"float32",U),J=a.makeTensorInfo(z,"float32",j),O=Un({inputs:{real:G,imag:J},backend:a}),M=gE(n,s),K=[M.real.length],Y=a.makeTensorInfo(K,"float32",M.real),Q=a.makeTensorInfo(K,"float32",M.imag),te=Un({inputs:{real:Y,imag:Q},backend:a}),ae=I0({inputs:{a:te,b:O},backend:a}),se=Sl({inputs:{a:L,b:ae},backend:a}),le=nv({inputs:{a:L,b:ae},backend:a}),me=io({inputs:{input:se},backend:a}),xe=io({inputs:{input:le},backend:a}),be=Nl({inputs:{input:se},backend:a}),Ne=Nl({inputs:{input:le},backend:a}),Ie=Cl({inputs:[me,xe],backend:a,attrs:{axis:0}}),Be=Cl({inputs:[be,Ne],backend:a,attrs:{axis:0}}),qe=a.data.get(Ie.dataId).values,ft=a.data.get(Be.dataId).values;return a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(w),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(J),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(Y),a.disposeIntermediateTensorInfo(Q),a.disposeIntermediateTensorInfo(te),a.disposeIntermediateTensorInfo(ae),a.disposeIntermediateTensorInfo(se),a.disposeIntermediateTensorInfo(le),a.disposeIntermediateTensorInfo(me),a.disposeIntermediateTensorInfo(be),a.disposeIntermediateTensorInfo(xe),a.disposeIntermediateTensorInfo(Ne),a.disposeIntermediateTensorInfo(Ie),a.disposeIntermediateTensorInfo(Be),{real:qe,imag:ft}}function b9(t,e,n){const s=new Float32Array(e*2);for(let a=0;a<e;a++){let r=0,i=0;for(let o=0;o<e;o++){const l=yE(a*o,e,n),u=w1(t,o);r+=u.real*l.real-u.imag*l.imag,i+=u.real*l.imag+u.imag*l.real}n&&(r/=e,i/=e),mE(s,r,i,a)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9(t){const{inputs:e,backend:n}=t,{input:s}=e,a=H(s.shape),r=s.shape[s.shape.length-1],i=a/r,o=Qe({inputs:{x:s},backend:n,attrs:{shape:[i,r]}}),l=s_(o,!1,n),u=Qe({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const k9={kernelName:Bm,backendName:"cpu",kernelFunc:x9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rv(t){const{backend:e,attrs:n}=t,{shape:s,value:a,dtype:r}=n,i=r||mo(a),o=gt(i,H(s));return S9(o,a,i),e.makeTensorInfo(s,i,o)}const v9={kernelName:Mm,backendName:"cpu",kernelFunc:rv};function S9(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N9={kernelName:Vm,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,a=n,r=Wt(s.dtype,H(s.shape)),[i,o,l,u]=s.shape,c=a.data.get(s.dataId).values;for(let p=0;p<i;p++){const h=p*l*o*u;for(let f=0;f<o;f++){const g=f*(l*u);for(let y=0;y<l;y++){const m=y*u;for(let w=0;w<u;w++){const b=Math.round(l-y-1),x=h+g+m+w;let v=c[x];if(b>=0&&b<l){const S=b*u,N=h+g+S+w;v=c[N]}r[x]=v}}}}return{dataId:a.write(r,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r,bias:i,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=s;let g=t_({inputs:{x:a,filter:r},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(i){const y=g;if(c==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const m=Qe({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});g=Sl({inputs:{a:g,b:m},backend:n}),n.disposeIntermediateTensorInfo(m)}else g=Sl({inputs:{a:g,b:i},backend:n});n.disposeIntermediateTensorInfo(y)}if(h){const y=g;if(c==="NCHW"&&h==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const m=Qe({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=Hf(n,g,h,m,f),n.disposeIntermediateTensorInfo(m)}else g=Hf(n,g,h,o,f);n.disposeIntermediateTensorInfo(y)}return g}const I9={kernelName:Uc,backendName:"cpu",kernelFunc:C9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $9(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r,bias:i,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=s;let g=n_({inputs:{x:a,filter:r},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(i){const y=g;g=Sl({inputs:{a:g,b:i},backend:n}),n.disposeIntermediateTensorInfo(y)}if(h){const y=g;g=Hf(n,g,h,o,f),n.disposeIntermediateTensorInfo(y)}return g}const T9={kernelName:Gc,backendName:"cpu",kernelFunc:$9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9(t){const{inputs:e,backend:n}=t,{params:s,indices:a}=e,r=H(s.shape),i=a.shape,o=i[i.length-1],[l,u,c,d]=c0(s,a);if(u===0)return n.makeTensorInfo(l,s.dtype,[]);const p=n.data.get(a.dataId).values,h=n.bufferSync(s),f=hD(p,h,s.dtype,u,o,c,d,s.shape,r);return n.makeTensorInfo(l,s.dtype,f.values)}const A9={kernelName:Wm,backendName:"cpu",kernelFunc:E9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,indices:r}=e,{axis:i,batchDims:o}=s;he([a,r],"gatherV2");const l=Ee(i,a.shape)[0],u=n.data.get(r.dataId).values,c=a.shape[l];for(let x=0;x<u.length;++x){const v=u[x];C(v<=c-1&&v>=0,()=>`GatherV2: the index value ${v} is not in [0, ${c-1}]`)}let d=o;o==null&&(d=0);const p=H(r.shape),h=C1(a,r,l,d),f=Qe({inputs:{x:a},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),g=Qe({inputs:{x:r},backend:n,attrs:{shape:[h.batchSize,p/h.batchSize]}}),y=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize],m=n.bufferSync(g),w=n.bufferSync(f),b=fD(w,m,y);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(h.outputShape,b.dtype,b.values)}const D9={kernelName:Od,backendName:"cpu",kernelFunc:R9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9(t){const{inputs:e,backend:n}=t,{input:s}=e,a=H(s.shape),r=s.shape[s.shape.length-1],i=a/r,o=Qe({inputs:{x:s},backend:n,attrs:{shape:[i,r]}}),l=s_(o,!0,n),u=Qe({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const O9={kernelName:Um,backendName:"cpu",kernelFunc:_9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F9=Ve(Ql,t=>Number.isFinite(t)?1:0,"bool"),j9={kernelName:Ql,backendName:"cpu",kernelFunc:F9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P9=Ve(Zl,t=>Math.abs(t)===1/0?1:0,"bool"),L9={kernelName:Zl,backendName:"cpu",kernelFunc:P9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z9=Ve(eu,t=>Number.isNaN(t)?1:0,"bool"),B9={kernelName:eu,backendName:"cpu",kernelFunc:z9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(t){const{backend:e,attrs:n}=t,{start:s,stop:a,num:r}=n,i=bD(s,a,r);return e.makeTensorInfo([i.length],"float32",i)}const V9={kernelName:Hm,backendName:"cpu",kernelFunc:M9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W9=Ve(nu,t=>Math.log1p(t)),U9={kernelName:nu,backendName:"cpu",kernelFunc:W9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G9=Nt((t,e)=>t&&e),H9=Pt(zd,G9,null,"bool"),K9={kernelName:zd,backendName:"cpu",kernelFunc:H9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q9=Ve(Bd,t=>t?0:1,"bool"),J9={kernelName:Bd,backendName:"cpu",kernelFunc:q9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X9=Nt((t,e)=>t||e),Y9=Pt(Md,X9,null,"bool"),Q9={kernelName:Md,backendName:"cpu",kernelFunc:Y9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{depthRadius:r,bias:i,alpha:o,beta:l}=s;he(a,"LRN");const u=a.shape[3],c=u-1,d=n.data.get(a.dataId).values,p=H(a.shape),h=new Float32Array(p);function f(g){const y=g%u;let m=g-y+Math.max(0,y-r);const w=g-y+Math.min(y+r,c);let b=0;for(;m<=w;m++){const x=d[m];b+=x*x}return b}for(let g=0;g<p;g++){const y=f(g),m=d[g]*Math.pow(i+o*y,-l);h[g]=m}return n.makeTensorInfo(a.shape,a.dtype,h)}const eJ={kernelName:Vd,backendName:"cpu",kernelFunc:Z9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tJ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,y:r,dy:i}=e,{depthRadius:o,bias:l,alpha:u,beta:c}=s;he(i,"LRNGrad");const d=H(i.shape),p=i.shape[3],h=n.data.get(i.dataId).values,f=n.data.get(a.dataId).values,g=n.data.get(r.dataId).values,y=new Float32Array(d),m=d;for(let w=0;w<m;w++){const b=w%p,x=w-b+Math.max(0,b-o),v=w-b+Math.min(p,b+o+1);let S=0;for(let N=x;N<v;N++)S+=Math.pow(f[N],2);S=u*S+l;for(let N=x;N<v;N++){let $=-2*u*c*f[N]*g[w]/S;w===N&&($+=Math.pow(S,-c)),$*=h[w],y[N]+=$}}return n.makeTensorInfo(i.shape,a.dtype,y)}const nJ={kernelName:Km,backendName:"cpu",kernelFunc:tJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{reductionIndices:r,keepDims:i}=s,o=n;let l=a.shape;const u=l.length,c=Ee(r,l);let d=c;const p=ht(d,u);let h=o.data.get(a.dataId).values;if(p!=null){const x=new Array(u);for(let v=0;v<x.length;v++)x[v]=l[p[v]];h=ev(h,l,a.dtype,p,x),d=vt(d.length,u),l=x}he(a,"max"),nn("max",d,u);const[f,g]=Ht(l,d),y=H(g),m=kD(h,y,f,a.dtype),w=o.write(m,f,a.dtype);let b=f;return i&&(b=kt(f,c)),{dataId:w,shape:b,dtype:a.dtype}}const sJ={kernelName:Wd,backendName:"cpu",kernelFunc:a_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aJ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;he(a,"maxPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=s,u=1;C(tn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Fs(a.shape,r,i,u,o,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&Re(c.inShape,c.outShape))d=Aa({inputs:{x:a},backend:n});else{const p=n.data.get(a.dataId).values,h=ye(a.shape),f=sv(p,a.shape,a.dtype,h,c,"max");d=n.makeTensorInfo(c.outShape,a.dtype,f.values)}return d}const rJ={kernelName:Ud,backendName:"cpu",kernelFunc:aJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iJ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:l,dataFormat:u}=s;he(a,"maxPool3d");const c=ar(a.shape,r,i,1,o,l,u),d=n.data.get(a.dataId).values,p=e_(d,a.shape,a.dtype,ye(a.shape),c,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}const oJ={kernelName:Gd,backendName:"cpu",kernelFunc:iJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lJ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,{filterSize:i,strides:o,pad:l,dimRoundingMode:u}=s;he([a,r],"maxPool3DGrad");const c=ar(r.shape,i,o,1,l,u),d=n.bufferSync(r),p=X7(d,c),h=c.strideDepth,f=c.strideHeight,g=c.strideWidth,y=c.dilationDepth,m=c.dilationHeight,w=c.dilationWidth,b=c.effectiveFilterDepth,x=c.effectiveFilterHeight,v=c.effectiveFilterWidth,S=b-1-c.padInfo.front,N=v-1-c.padInfo.left,$=x-1-c.padInfo.top,E=Se(r.shape,"float32"),A=n.bufferSync(a);for(let L=0;L<c.batchSize;++L)for(let W=0;W<c.inChannels;++W)for(let U=0;U<c.inDepth;++U)for(let j=0;j<c.inHeight;++j)for(let z=0;z<c.inWidth;++z){const G=U-S,J=j-$,O=z-N;let M=0;for(let K=0;K<b;K+=y){const Y=(G+K)/h;if(!(Y<0||Y>=c.outDepth||Math.floor(Y)!==Y))for(let Q=0;Q<x;Q+=m){const te=(J+Q)/f;if(!(te<0||te>=c.outHeight||Math.floor(te)!==te))for(let ae=0;ae<v;ae+=w){const se=(O+ae)/g;if(se<0||se>=c.outWidth||Math.floor(se)!==se)continue;const le=b*x*v-1-p.get(L,Y,te,se,W),me=K*x*v+Q*v+ae,xe=le===me?1:0;if(xe===0)continue;const be=A.get(L,Y,te,se,W);M+=be*xe}}}E.set(M,L,U,j,z,W)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const uJ={kernelName:Jm,backendName:"cpu",kernelFunc:lJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cJ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r,output:i}=e,o=r;he([r,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=s,p=Fs(o.shape,l,u,1,c,d),h=n.data.get(o.dataId).values,f=Se(p.outShape,o.dtype,ZD(h,o.shape,o.dtype,p).values),g=p.strideHeight,y=p.strideWidth,m=p.dilationHeight,w=p.dilationWidth,b=p.effectiveFilterHeight,x=p.effectiveFilterWidth,v=x-1-p.padInfo.left,S=b-1-p.padInfo.top,N=Se(o.shape,"float32"),$=n.data.get(a.dataId).values,E=Se(a.shape,"float32",$);for(let A=0;A<p.batchSize;++A)for(let L=0;L<p.inChannels;++L)for(let W=0;W<p.inHeight;++W)for(let U=0;U<p.inWidth;++U){const j=W-S,z=U-v;let G=0;for(let J=0;J<b;J+=m){const O=(j+J)/g;if(!(O<0||O>=p.outHeight||Math.floor(O)!==O))for(let M=0;M<x;M+=w){const K=(z+M)/y;if(K<0||K>=p.outWidth||Math.floor(K)!==K)continue;const Y=b*x-1-f.get(A,O,K,L),Q=J*x+M,te=Y===Q?1:0;if(te===0)continue;const ae=E.get(A,O,K,L);G+=ae*te}}N.set(G,A,W,U,L)}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const dJ={kernelName:qm,backendName:"cpu",kernelFunc:cJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pJ(t,e,n,s,a){const r=ye(e),i=sv(t,e,n,r,a,"max"),o=ZD(t,e,n,a,!0,s);return[i.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hJ={kernelName:Xm,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:a,strides:r,pad:i,includeBatchInIndex:o}=e,l=n;he(s,"MaxPoolWithArgmax");const u=l.data.get(s.dataId).values,c=Fs(s.shape,a,r,[1,1],i),[d,p]=pJ(u,s.shape,s.dtype,o,c),h=l.write(d,c.outShape,s.dtype),f=l.write(p,c.outShape,s.dtype);return[{dataId:h,shape:c.outShape,dtype:s.dtype},{dataId:f,shape:c.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fJ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=Ee(r,a.shape),u=Ht(a.shape,o)[1],c=H(u),d=[],p=n.makeTensorInfo([],"float32",new Float32Array([c]));d.push(p);const h=Qr({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});d.push(h);const f=av({inputs:{a:h,b:p},backend:n});d.push(f);const g=qp({inputs:{x:f},backend:n,attrs:{axis:r,keepDims:i}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const mJ={kernelName:Hd,backendName:"cpu",kernelFunc:fJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gJ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;he(a,"min");const o=Ee(r,a.shape);let l=o;const u=ht(l,a.shape.length);let c=a;u!=null&&(c=jn({inputs:{x:a},backend:n,attrs:{perm:u}}),l=vt(l.length,a.shape.length)),nn("min",l,c.shape.length);const[d,p]=Ht(c.shape,l),h=H(p),f=Zt(H(d),c.dtype),g=n.data.get(c.dataId).values;for(let m=0;m<f.length;++m){const w=m*h;let b=g[w];for(let x=0;x<h;++x){const v=g[w+x];(Number.isNaN(v)||v<b)&&(b=v)}f[m]=b}u!=null&&n.disposeIntermediateTensorInfo(c);const y=n.makeTensorInfo(d,c.dtype,f);if(i){const m=kt(d,o),w=Qe({inputs:{x:y},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(y),w}return y}const yJ={kernelName:Kd,backendName:"cpu",kernelFunc:gJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wJ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{paddings:r,mode:i}=s;he(a,"mirrorPad");const o=r.map((b,x)=>b[0]+a.shape[x]+b[1]),l=r.map(b=>b[0]),u=r.map((b,x)=>b[0]+a.shape[x]),c=i==="reflect"?0:1,d=n.data.get(a.dataId).values,p=a.shape.length,h=ye(a.shape),f=H(o),g=o.length,y=ye(o),m=Wt(a.dtype,f);for(let b=0;b<f;b++){let x=go(b,g,y);for(let S=0;S<g;S++)x[S]<l[S]?x[S]=l[S]*2-x[S]-c:x[S]>=u[S]&&(x[S]=(u[S]-1)*2-x[S]+c);x=x.map((S,N)=>S-l[N]);const v=Qs(x,p,h);m[b]=d[v]}return{dataId:n.write(m,o,a.dtype),shape:o,dtype:a.dtype}}const bJ={kernelName:qd,backendName:"cpu",kernelFunc:wJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xJ=Nt((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),kJ=Pt(ru,xJ),vJ={kernelName:ru,backendName:"cpu",kernelFunc:kJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r_(t){const{inputs:e,backend:n,attrs:s}=t,{logits:a}=e,{dim:r}=s,i=a.shape.length;let o=r;if(o===-1&&(o=i-1),o!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${o}`);const l=Ee([o],a.shape),u=a_({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=kt(u.shape,l),d=Qe({inputs:{x:u},backend:n,attrs:{shape:c}}),p=nv({inputs:{a,b:d},backend:n}),h=uD({inputs:{x:p},backend:n}),f=qp({inputs:{x:h},backend:n,attrs:{axis:l,keepDims:!1}}),g=Qe({inputs:{x:f},backend:n,attrs:{shape:c}}),y=av({inputs:{a:h,b:g},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}const SJ={kernelName:pp,backendName:"cpu",kernelFunc:r_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NJ(t){const{inputs:e,backend:n,attrs:s}=t,{logits:a}=e,{numSamples:r,seed:i,normalized:o}=s;he(a,"multinomial");const l=o?a:r_({inputs:{logits:a},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,p=[u,r],h=Zt(H(p),"int32");for(let f=0;f<u;++f){const g=f*c,y=new Float32Array(c-1);y[0]=d[g];for(let b=1;b<y.length;++b)y[b]=y[b-1]+d[g+b];const m=zg.alea(i.toString()),w=f*r;for(let b=0;b<r;++b){const x=m();h[w+b]=y.length;for(let v=0;v<y.length;v++)if(x<y[v]){h[w+b]=v;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",h)}const CJ={kernelName:Ym,backendName:"cpu",kernelFunc:NJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IJ=i0;function $J(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s;he(a,"NonMaxSuppression");const u=n.data.get(a.dataId).values,c=n.data.get(r.dataId).values,{selectedIndices:d}=IJ(u,c,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const TJ={kernelName:Qm,backendName:"cpu",kernelFunc:$J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EJ=o0;function AJ(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=s;he(a,"NonMaxSuppressionPadded");const c=n.data.get(a.dataId).values,d=n.data.get(r.dataId).values,{selectedIndices:p,validOutputs:h}=EJ(c,d,i,o,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const RJ={kernelName:Zm,backendName:"cpu",kernelFunc:AJ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DJ=l0;function _J(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=s;he(a,"NonMaxSuppressionWithScore");const c=n.data.get(a.dataId).values,d=n.data.get(r.dataId).values,p=i,h=o,f=l,g=u,{selectedIndices:y,selectedScores:m}=DJ(c,d,p,h,f,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}const OJ={kernelName:eg,backendName:"cpu",kernelFunc:_J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FJ(t){const{inputs:e,backend:n,attrs:s}=t,{indices:a}=e,{dtype:r,depth:i,onValue:o,offValue:l}=s;he(a,"oneHot");const u=H(a.shape),c=new Float32Array(u*i);c.fill(l);const d=n.data.get(a.dataId).values;for(let p=0;p<u;++p)d[p]>=0&&d[p]<i&&(c[p*i+d[p]]=o);return n.makeTensorInfo([...a.shape,i],r,c)}const jJ={kernelName:Qd,backendName:"cpu",kernelFunc:FJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qf(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const a=io({inputs:{input:s},backend:n}),r=qf({inputs:{x:a},backend:n}),i=Nl({inputs:{input:s},backend:n}),o=qf({inputs:{x:i},backend:n}),l=Un({inputs:{real:r,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return rv({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const PJ={kernelName:gp,backendName:"cpu",kernelFunc:qf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i_(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const a=io({inputs:{input:s},backend:n}),r=i_({inputs:{x:a},backend:n}),i=Nl({inputs:{input:s},backend:n}),o=qf({inputs:{x:i},backend:n}),l=Un({inputs:{real:r,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return rv({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const LJ={kernelName:Yd,backendName:"cpu",kernelFunc:i_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_(t){const{inputs:e,backend:n,attrs:s}=t,{axis:a}=s;if(e.length===1)return Kf({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const r=e[0].shape,i=e[0].dtype;e.forEach(c=>{en(r,c.shape,"All tensors passed to stack must have matching shapes"),C(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(c=>{const d=Kf({inputs:{input:c},backend:n,attrs:{dim:a}});return o.push(d),d}),u=Cl({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const zJ={kernelName:Zd,backendName:"cpu",kernelFunc:o_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BJ(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{paddings:r,constantValue:i}=s;he(a,"pad");const o=r.map((w,b)=>w[0]+a.shape[b]+w[1]),l=r.map(w=>w[0]),u=n.data.get(a.dataId).values,c=H(a.shape),d=a.shape.length,p=ye(a.shape),h=H(o),f=o.length,g=ye(o),y=Wt(a.dtype,h);i!==0&&y.fill(i);for(let w=0;w<c;w++){const x=go(w,d,p).map((S,N)=>S+l[N]),v=Qs(x,f,g);y[v]=u[w]}return{dataId:n.write(y,o,a.dtype),shape:o,dtype:a.dtype}}const l_={kernelName:ep,backendName:"cpu",kernelFunc:BJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MJ=Nt((t,e)=>Math.pow(t,e)),VJ=Pt(ou,MJ),WJ={kernelName:ou,backendName:"cpu",kernelFunc:VJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UJ(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:a,paramsDenseValues:r,indices:i}=e,o=a.map(y=>n.data.get(y.dataId).values),l=a.map(y=>y.shape),u=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,[d,p,h]=$D(o,l,u,r.shape,r.dtype,c,i.shape),f=d.map(y=>n.makeTensorInfo([y.length],"int32",y)),g=n.makeTensorInfo(h,r.dtype,p);return f.concat([g])}const GJ={kernelName:tg,backendName:"cpu",kernelFunc:UJ};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HJ(t){const{inputs:e,backend:n}=t,{starts:s,limits:a,deltas:r}=e,i=n.data.get(s.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,[u,c]=TD(i,s.shape,s.dtype,o,a.shape,l,r.shape),d=n.makeTensorInfo([u.length],"int32",u),p=n.makeTensorInfo([c.length],s.dtype,c);return[d,p]}const KJ={kernelName:ng,backendName:"cpu",kernelFunc:HJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qJ(t){const{inputs:e,backend:n,attrs:s}=t,{shape:a,values:r,defaultValue:i,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,u=n.data.get(a.dataId).values,c=n.data.get(r.dataId).values,d=n.data.get(i.dataId).values,p=o.map(y=>n.data.get(y.dataId).values),h=o.map(y=>y.shape),[f,g]=ED(u,a.shape,c,r.shape,r.dtype,d,i.shape,p,h,l);return n.makeTensorInfo(f,r.dtype,g)}const JJ={kernelName:sg,backendName:"cpu",kernelFunc:qJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XJ(t){const{backend:e,attrs:n}=t,{start:s,stop:a,dtype:r,step:i}=n,o=AD(s,a,i,r);return e.makeTensorInfo([o.length],r,o)}const YJ={kernelName:ag,backendName:"cpu",kernelFunc:XJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QJ=Ve(lu,t=>1/t),ZJ={kernelName:lu,backendName:"cpu",kernelFunc:QJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eX(t){const{inputs:e,backend:n,attrs:s}=t,{images:a}=e,{alignCorners:r,halfPixelCenters:i,size:o}=s;he(a,"resizeBilinear");const l=ye(a.shape),[u,c]=o,[d,p,h,f]=a.shape,g=n.data.get(a.dataId).values,y=new Float32Array(H([d,u,c,f])),m=[r&&u>1?p-1:p,r&&c>1?h-1:h],w=[r&&u>1?u-1:u,r&&c>1?c-1:c];let b=0;const x=m[0]/w[0],v=m[1]/w[1];for(let S=0;S<d;S++)for(let N=0;N<u;N++){let $;i?$=x*(N+.5)-.5:$=x*N;const E=Math.max(0,Math.floor($)),A=$-E,L=Math.min(p-1,Math.ceil($)),W=S*l[0]+E*l[1],U=S*l[0]+L*l[1];for(let j=0;j<c;j++){let z;i?z=v*(j+.5)-.5:z=v*j;const G=Math.max(0,Math.floor(z)),J=z-G,O=Math.min(h-1,Math.ceil(z)),M=W+G*l[2],K=U+G*l[2],Y=W+O*l[2],Q=U+O*l[2];for(let te=0;te<f;te++){const ae=g[M+te],se=g[K+te],le=g[Y+te],me=g[Q+te],xe=ae+(le-ae)*J,be=se+(me-se)*J,Ne=xe+(be-xe)*A;y[b++]=Ne}}}return n.makeTensorInfo([d,u,c,f],"float32",y)}const tX={kernelName:rp,backendName:"cpu",kernelFunc:eX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nX(t){const{inputs:e,backend:n,attrs:s}=t,{images:a,dy:r}=e,{alignCorners:i}=s;he([r,a],"resizeBilinearGrad");const o=ye(a.shape),[l,u,c,d]=a.shape,[,p,h]=r.shape,f=new Float32Array(l*u*c*d),g=[i&&p>1?u-1:u,i&&h>1?c-1:c],y=[i&&p>1?p-1:p,i&&h>1?h-1:h],m=g[0]/y[0],w=g[1]/y[1],b=n.data.get(r.dataId).values;let x=0;for(let v=0;v<l;v++){const S=v*o[0];for(let N=0;N<p;N++){const $=N*m,E=Math.floor($),A=Math.min(Math.ceil($),u-1),L=S+E*o[1],W=S+A*o[1],U=$-E,j=1-U;for(let z=0;z<h;z++){const G=z*w,J=Math.floor(G),O=Math.min(Math.ceil(G),c-1),M=G-J,K=1-M,Y=L+J*o[2],Q=L+O*o[2],te=W+J*o[2],ae=W+O*o[2],se=j*K,le=j*M,me=U*K,xe=U*M;for(let be=0;be<d;be++){const Ne=b[x++];f[Y+be]+=Ne*se,f[Q+be]+=Ne*le,f[te+be]+=Ne*me,f[ae+be]+=Ne*xe}}}}return n.makeTensorInfo([l,c,u,d],"float32",f)}const sX={kernelName:og,backendName:"cpu",kernelFunc:nX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aX(t){const{inputs:e,backend:n,attrs:s}=t,{images:a}=e,{alignCorners:r,halfPixelCenters:i,size:o}=s;he(a,"resizeNearestNeighbor");const l=ye(a.shape),[u,c]=o,[d,p,h,f]=a.shape,g=n.data.get(a.dataId).values,y=new Float32Array(d*u*c*f),m=[r&&u>1?p-1:p,r&&c>1?h-1:h],w=[r&&u>1?u-1:u,r&&c>1?c-1:c],b=m[0]/w[0],x=m[1]/w[1];let v=0;for(let S=0;S<d;S++){const N=S*l[0];for(let $=0;$<u;$++){const E=i?b*($+.5):b*$;let A=Math.min(p-1,r?Math.round(E):Math.floor(E));i&&(A=Math.max(0,A));const L=N+A*l[1];for(let W=0;W<c;W++){const U=i?x*(W+.5):x*W;let j=Math.min(h-1,r?Math.round(U):Math.floor(U));i&&(j=Math.max(0,j));const z=L+j*l[2];for(let G=0;G<f;G++){const J=g[z+G];y[v++]=J}}}}return n.makeTensorInfo([d,u,c,f],a.dtype,y)}const rX={kernelName:ap,backendName:"cpu",kernelFunc:aX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iX(t){const{inputs:e,backend:n,attrs:s}=t,{images:a,dy:r}=e,{alignCorners:i}=s;he([r,a],"resizeNearestNeighborGrad");const o=ye(a.shape),l=ye(r.shape),[u,c,d,p]=a.shape,[,h,f]=r.shape,g=new Float32Array(u*c*d*p),y=n.data.get(r.dataId).values,m=[i&&h>1?c-1:c,i&&f>1?d-1:d],w=[i&&h>1?h-1:h,i&&f>1?f-1:f],b=m[0]/w[0],x=m[1]/w[1],v=1/b,S=1/x,N=Math.ceil(v)*2+2,$=Math.ceil(S)*2+2;for(let E=0;E<u;E++){const A=E*o[0];for(let L=0;L<c;L++){const W=A+L*o[1],U=Math.floor(L*v),j=Math.floor(U-N/2);for(let z=0;z<d;z++){const G=W+z*o[2],J=Math.floor(z*S),O=Math.floor(J-$/2);for(let M=0;M<p;M++){let K=0;for(let Y=0;Y<N;Y++){const Q=Y+j;if(Q<0||Q>=h)continue;const te=A+Q*l[1],ae=Q*b,se=Math.min(c-1,i?Math.round(ae):Math.floor(ae));if(L===se)for(let le=0;le<$;le++){const me=le+O;if(me<0||me>=f)continue;const xe=te+me*l[2],be=me*x,Ne=Math.min(d-1,i?Math.round(be):Math.floor(be));z===Ne&&(K+=y[xe+M])}}g[G+M]=K}}}}return n.makeTensorInfo(a.shape,a.dtype,g)}const oX={kernelName:ig,backendName:"cpu",kernelFunc:iX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lX(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{dims:r}=s;he(a,"reverse");const i=a.shape.length,o=Ee(r,a.shape);if(i===0)return Aa({inputs:{x:a},backend:n});const l=new Tt(a.shape,a.dtype),u=n.bufferSync(a);for(let c=0;c<l.size;c++){const d=l.indexToLoc(c),p=d.slice();o.forEach(h=>p[h]=a.shape[h]-1-p[h]),l.set(u.get(...p),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const uX={kernelName:ip,backendName:"cpu",kernelFunc:lX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cX={kernelName:Ng,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:a,fillValue:r,center:i}=e,o=n,l=Wt(s.dtype,H(s.shape)),[u,c,d,p]=s.shape,[h,f]=u1(i,c,d),g=255,y=Math.sin(a),m=Math.cos(a),w=o.data.get(s.dataId).values;for(let x=0;x<u;x++){const v=x*d*c*p;for(let S=0;S<c;S++){const N=S*(d*p);for(let $=0;$<d;$++){const E=$*p;for(let A=0;A<p;A++){const L=[u,S,$,A],W=L[2],U=L[1];let j=(W-h)*m-(U-f)*y,z=(W-h)*y+(U-f)*m;j=Math.round(j+h),z=Math.round(z+f);let G=r;if(typeof r!="number"&&(A===3?G=g:G=r[A]),j>=0&&j<d&&z>=0&&z<c){const O=z*(d*p),M=j*p,K=v+O+M+A;G=w[K]}const J=v+N+E+A;l[J]=G}}}}return{dataId:o.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dX=Ve(du,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),pX={kernelName:du,backendName:"cpu",kernelFunc:dX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hX(t){const{inputs:e,backend:n,attrs:s}=t,{indices:a,updates:r}=e,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=pi(r,a,i),p=!0,h=n.bufferSync(a),f=n.bufferSync(r),g=Oi(h,f,i,d,u,l,o,c,0,p);return n.makeTensorInfo(i,g.dtype,g.values)}const fX={kernelName:lg,backendName:"cpu",kernelFunc:hX};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mX(t,e){let n=0,s=t.length,a=0;for(;n<s;)a=Math.floor((n+s)/2),t[a]<e?n=a+1:s=a;return s}function gX(t,e){let n=0,s=t.length,a=0;for(;n<s;)a=Math.floor((n+s)/2),t[a]<=e?n=a+1:s=a;return s}function yX(t,e,n,s,a,r){const i=gt("int32",n*a);for(let o=0;o<n;++o){const l=t.slice(o*s,(o+1)*s),u=o*a;for(let c=0;c<a;++c)i[u+c]=r==="left"?mX(l,e[c+u]):gX(l,e[c+u])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wX(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:a,values:r}=e,{side:i}=s,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,u=yX(o,l,a.shape[0],a.shape[1],r.shape[1],i);return n.makeTensorInfo(r.shape,"int32",u)}const bX={kernelName:cg,backendName:"cpu",kernelFunc:wX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xX(t){const{inputs:e,backend:n}=t,{condition:s,t:a,e:r}=e;he([s,a,r],"select");const i=s.shape.length,o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(r.dataId).values,c=Rn(a.dtype,r.dtype),d=Zt(H(a.shape),c);let p=0;const h=i===0||i>1||a.shape.length===1?1:H(a.shape.slice(1));for(let f=0;f<o.length;f++)for(let g=0;g<h;g++)o[f]===1?d[p++]=l[f]:d[p++]=u[f];return n.makeTensorInfo(a.shape,c,d)}const kX={kernelName:op,backendName:"cpu",kernelFunc:xX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vX=h0,SX=f0,NX=Ve(hu,t=>t>=0?SX*t:vX*(Math.exp(t)-1)),CX={kernelName:hu,backendName:"cpu",kernelFunc:NX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX=Ve(gu,t=>t<0?-1:t>0?1:0),$X={kernelName:gu,backendName:"cpu",kernelFunc:IX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX=Ve(fu,t=>Math.sin(t)),EX={kernelName:fu,backendName:"cpu",kernelFunc:TX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX=Ve(mu,t=>Math.sinh(t)),RX={kernelName:mu,backendName:"cpu",kernelFunc:AX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DX=11920928955078125e-23,HS=Math.log(DX)+2,_X=Ve(wu,t=>{const e=t>-HS,n=t<HS,s=Math.exp(t);let a;return n?a=s:e?a=t:a=Math.log(1+s),a}),OX={kernelName:wu,backendName:"cpu",kernelFunc:_X};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FX(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockShape:r,paddings:i}=s;he([a],"spaceToBatchND");const o=H(r),l=[[0,0]];l.push(...i);for(let S=1+r.length;S<a.shape.length;++S)l.push([0,0]);const u=l_.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),c=Pp(u.shape,r,o,!1),d=Lp(c.length,r.length,!1),p=zp(u.shape,r,o,!1),g=Qe({inputs:{x:u},backend:n,attrs:{shape:c}}),w=jn({inputs:{x:g},backend:n,attrs:{perm:d}}),v=Qe({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(w),v}const jX={kernelName:cp,backendName:"cpu",kernelFunc:FX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PX(t){const{inputs:e,backend:n}=t,{indices:s,values:a,denseShape:r,defaultValue:i}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${a.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values[0],[d,p,h,f,g]=OD(o,s.shape,s.dtype,l,a.dtype,u,c);return[n.makeTensorInfo(p,s.dtype,d),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(y=>Number(y)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const LX={kernelName:dg,backendName:"cpu",kernelFunc:PX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zX(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:a,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const i=Array.from(n.data.get(a.dataId).values),o=n.data.get(s.dataId).values,l=Array.from(n.data.get(r.dataId).values),[u,c,d]=FD(o,s.shape,s.dtype,i,l);return[n.makeTensorInfo(c,s.dtype,u),n.makeTensorInfo([d.length],r.dtype,new Int32Array(d))]}const BX={kernelName:pg,backendName:"cpu",kernelFunc:zX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MX(t){const{inputs:e,backend:n}=t,{data:s,indices:a,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${a.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${r.shape}`);if(a.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,[u,c]=tv(i,s.shape,s.dtype,o,l,!0);return n.makeTensorInfo(c,s.dtype,u)}const VX={kernelName:hg,backendName:"cpu",kernelFunc:MX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WX(t){const{inputs:e,backend:n}=t,{data:s,indices:a,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${a.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${r.shape}`);if(a.shape[0]!==r.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,o=n.data.get(a.dataId).values,l=n.data.get(r.dataId).values,[u,c]=tv(i,s.shape,s.dtype,o,l);return n.makeTensorInfo(c,s.dtype,u)}const UX={kernelName:fg,backendName:"cpu",kernelFunc:WX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GX(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:a,sparseValues:r,defaultValue:i}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=pi(r,a,o),h=!1,f=n.bufferSync(a);let g;switch(r.dtype){case"bool":{const y=n.bufferSync(r),m=!!n.data.get(i.dataId).values[0];g=Oi(f,y,o,p,c,u,l,d,m,h);break}case"float32":{const y=n.bufferSync(r),m=n.data.get(i.dataId).values[0];g=Oi(f,y,o,p,c,u,l,d,m,h);break}case"int32":{const y=n.bufferSync(r),m=n.data.get(i.dataId).values[0];g=Oi(f,y,o,p,c,u,l,d,m,h);break}case"string":{const y=n.bufferSync(r),m=Xa(n.data.get(i.dataId).values[0]);g=Oi(f,y,o,p,c,u,l,d,m,h);break}default:throw new Error(`Unsupported type ${r.dtype}`)}return n.makeTensorInfo(o,g.dtype,g.values)}const HX={kernelName:mg,backendName:"cpu",kernelFunc:GX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KX(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{numOrSizeSplits:r,axis:i}=s,o=Ee(i,a.shape)[0],l=N1(a,r,o),u=new Array(a.shape.length).fill(0),c=a.shape.slice();return l.map(d=>{const p=[...c];p[o]=d;const h=oo({inputs:{x:a},backend:n,attrs:{begin:u,size:p}});return u[o]+=d,h})}const qX={kernelName:dp,backendName:"cpu",kernelFunc:KX};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JX={kernelName:gg,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;he(n,"square");const a=s.data.get(n.dataId).values,r=new Float32Array(a.length);for(let o=0;o<a.length;++o){const l=a[o];r[o]=l*l}return{dataId:s.write(r,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XX=Ve(Cu,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),YX={kernelName:Cu,backendName:"cpu",kernelFunc:XX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QX(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{begin:r,end:i,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=s;he(a,"stridedSlice");const{finalShapeSparse:h,finalShape:f,isIdentity:g,sliceDim0:y,isSimpleSlice:m,begin:w,end:b,strides:x}=r1(a.shape,r,i,o,l,u,c,d,p);let v;if(g)v=Qe({inputs:{x:a},backend:n,attrs:{shape:f}});else if(y||m){C(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const S=n1(w,b,x),N=oo({inputs:{x:a},backend:n,attrs:{begin:w,size:S}});v=Qe({inputs:{x:N},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(N)}else{const S=n.bufferSync(a),N=LD(h,S,x,w);v=n.makeTensorInfo(f,N.dtype,N.values)}return v}const ZX={kernelName:yg,backendName:"cpu",kernelFunc:QX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eY(t){const{inputs:e,backend:n,attrs:s}=t,{separator:a,nGramWidths:r,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:u}=s,{data:c,dataSplits:d}=e,p=n.data.get(c.dataId).values,h=n.data.get(d.dataId).values,[f,g]=zD(p,h,a,r,i,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",g)]}const tY={kernelName:wg,backendName:"cpu",kernelFunc:eY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nY(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:a}=s,{input:r,delimiter:i}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values[0],[u,c,d]=BD(o,l,a),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const sY={kernelName:bg,backendName:"cpu",kernelFunc:nY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aY(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:a}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(r.dataId).values,o=MD(i,a);return n.makeTensorInfo(r.shape,"int32",o)}const rY={kernelName:xg,backendName:"cpu",kernelFunc:aY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iY=Ve(vu,t=>Math.tan(t)),oY={kernelName:vu,backendName:"cpu",kernelFunc:iY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lY=Ve(Su,t=>Math.tanh(t)),uY={kernelName:Su,backendName:"cpu",kernelFunc:lY};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cY(t){const{inputs:e,backend:n}=t,{tensor:s,indices:a,updates:r}=e,{sliceRank:i,numUpdates:o,sliceSize:l,strides:u,outputSize:c}=pi(r,a,s.shape),d=!1,p=n.bufferSync(a),h=n.bufferSync(r),f=n.bufferSync(s),g=Oi(p,h,s.shape,c,l,o,i,u,f,d);return n.makeTensorInfo(s.shape,g.dtype,g.values)}const dY={kernelName:ug,backendName:"cpu",kernelFunc:cY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pY(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{reps:r}=s;he(a,"tile");const i=WD(n.bufferSync(a),r);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const hY={kernelName:Nu,backendName:"cpu",kernelFunc:pY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fY(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{k:r,sorted:i}=s;he(a,"topk");const o=n.data.get(a.dataId).values,[l,u]=GD(o,a.shape,a.dtype,r,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const mY={kernelName:kg,backendName:"cpu",kernelFunc:fY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gY(t){const{inputs:e,attrs:n,backend:s}=t,{image:a,transforms:r}=e,{interpolation:i,fillMode:o,fillValue:l,outputShape:u}=n,[c,d,p,h]=a.shape,[f,g]=u??[d,p],y=[c,f,g,h],m=ye(a.shape),w=m[0],b=m[1],x=m[2],v=ye(y),S=v[0],N=v[1],$=v[2],E=Wt(a.dtype,H(y));E.fill(l);const A=s.data.get(a.dataId).values,L=s.data.get(r.dataId).values;for(let U=0;U<c;++U){const j=r.shape[0]===1?L:L.subarray(U*8,U*8+8);for(let z=0;z<f;++z)for(let G=0;G<g;++G)for(let J=0;J<h;++J){let O;const M=j[6]*G+j[7]*z+1;if(M===0)continue;const K=(j[0]*G+j[1]*z+j[2])/M,Y=(j[3]*G+j[4]*z+j[5])/M,Q=KS(K,p,o),te=KS(Y,d,o);switch(i){case"nearest":O=vY(A,d,p,w,b,x,U,te,Q,J,l);break;case"bilinear":O=SY(A,d,p,w,b,x,U,te,Q,J,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const ae=U*S+z*N+G*$+J;E[ae]=O}return s.makeTensorInfo(y,a.dtype,E)}return{dataId:s.write(E,y,a.dtype),shape:a.shape,dtype:a.dtype}}const yY={kernelName:vg,backendName:"cpu",kernelFunc:gY};function KS(t,e,n){switch(n){case"reflect":return wY(t,e);case"wrap":return bY(t,e);case"nearest":return kY(t,e);case"constant":default:return xY(t)}}function wY(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return Mr(0,n,e-1)}function bY(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return Mr(0,n,e-1)}function xY(t,e){return t}function kY(t,e){return Mr(0,t,e-1)}function uc(t,e,n,s,a,r,i,o,l,u,c){const d=i*s+o*a+l*r+u;return 0<=o&&o<e&&0<=l&&l<n?t[d]:c}function vY(t,e,n,s,a,r,i,o,l,u,c){const d=Math.round(o),p=Math.round(l);return uc(t,e,n,s,a,r,i,d,p,u,c)}function SY(t,e,n,s,a,r,i,o,l,u,c){const d=Math.floor(o),p=Math.floor(l),h=d+1,f=p+1,g=(f-l)*uc(t,e,n,s,a,r,i,d,p,u,c)+(l-p)*uc(t,e,n,s,a,r,i,d,f,u,c),y=(f-l)*uc(t,e,n,s,a,r,i,h,p,u,c)+(l-p)*uc(t,e,n,s,a,r,i,h,f,u,c);return(h-o)*g+(o-d)*y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NY(t){const{inputs:e,attrs:n,backend:s}=t,{axis:a}=n,{x:r}=e;he(r,"unique");const i=s.data.get(r.dataId).values,{outputValues:o,outputShape:l,indices:u}=HD(i,a,r.shape,r.dtype);return[s.makeTensorInfo(l,r.dtype,o),s.makeTensorInfo([u.length],"int32",u)]}const CY={kernelName:Sg,backendName:"cpu",kernelFunc:NY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IY(t){const{inputs:e,backend:n,attrs:s}=t,{value:a}=e;let{axis:r}=s;r<0&&(r+=a.shape.length);const i=a.shape.length,o=a.shape[r],l=new Array(i-1);let u=0;for(let h=0;h<i;h++)h!==r&&(l[u++]=a.shape[h]);const c=new Array(i).fill(0),d=a.shape.slice();d[r]=1;const p=new Array(o);for(let h=0;h<p.length;h++){c[r]=h;const f=oo({inputs:{x:a},backend:n,attrs:{begin:c,size:d}});p[h]=Qe({inputs:{x:f},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(f)}return p}const $Y={kernelName:fp,backendName:"cpu",kernelFunc:IY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TY(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,segmentIds:r}=e,{numSegments:i}=s;he(a,"unsortedSegmentSum");const o=a.shape.length,l=r.shape.length,u=[],c=[],d=o-l;let p=r;for(let f=0;f<d;++f){const g=Kf({inputs:{input:p},backend:n,attrs:{dim:f+1}});p=g,c.push(g)}for(let f=0;f<i;++f){const g=sr(f,"int32"),y=n.makeTensorInfo([],"int32",g),m=oD({inputs:{a:y,b:p},backend:n}),w=Qr({inputs:{x:m},backend:n,attrs:{dtype:"float32"}}),b=I0({inputs:{a:w,b:a},backend:n}),x=qp({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});u.push(x),c.push(y),c.push(m),c.push(w),c.push(b),c.push(x)}const h=o_({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}const EY={kernelName:mp,backendName:"cpu",kernelFunc:TY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AY=[N7,a8,I7,T7,c8,A7,D7,O7,j7,L7,B7,V7,U7,K7,J7,Q7,eq,nq,aq,v7,iq,lq,cq,p8,pq,l8,f8,fq,r8,gq,wq,bq,kq,Sq,Cq,$q,Eq,Rq,_q,Fq,Pq,zq,Mq,Wq,Uq,Hq,qq,Xq,Yq,Qq,Zq,t9,a9,m7,i9,m8,f9,g8,m9,w8,k9,v9,N9,x8,v8,I9,T9,A9,D9,N8,I8,i8,O9,yq,j9,L9,B9,g7,T8,A8,V9,D8,U9,K9,J9,Q9,eJ,nJ,sJ,O8,rJ,oJ,uJ,dJ,hJ,mJ,yJ,j8,bJ,vJ,CJ,L8,B8,TJ,RJ,OJ,V8,jJ,LJ,zJ,l_,WJ,w7,G8,GJ,KJ,JJ,YJ,o8,pb,ZJ,b7,x7,k7,tX,sX,rX,oX,uX,cX,pX,Z8,fX,bX,kX,CX,t7,$X,EX,RX,n7,SJ,OX,jX,LX,BX,VX,UX,HX,qX,r7,JX,o7,u7,YX,ZX,tY,sY,rY,h7,n9,oY,uY,dY,hY,mY,yY,W8,CY,$Y,EY,PJ];for(const t of AY)Cg(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ti={},Ch={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function RY(t,e){Ti[t]=e}function ra(t,e){if(!(t in Ti)||e!=null){const s=_Y(t,e);if(s!==null)Ti[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=Ti[t];return n==null||n.isContextLost()?(delete Ti[t],ra(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ti[t])}function DY(t){if(!V().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function _Y(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??DY(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Ti[t]},!1),V().getBool("SOFTWARE_WEBGL_ENABLED")&&(Ch.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Ch)||n.getContext("experimental-webgl",Ch):n.getContext("webgl2",Ch)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ad;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(ad||(ad={}));var ls;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(ls||(ls={}));var Xt;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Xt||(Xt={}));function Jp(t,e){return[e,t]}function OY(t,e){return t*e}function Ih(t){const e=H(t),n=Math.ceil(e/4);return vf(n)}function Ou(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function FY(t,e){const[n,s]=Ou(t,e);return n*s*4}function iv(t,e){const n=t;let s,a,r,i,o,l,u,c,d,p;return V().getNumber("WEBGL_VERSION")===2?(s=n.R32F,a=n.R16F,r=n.RGBA16F,i=n.RGBA32F,o=n.RED,u=4,c=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(s=t.RGBA,a=t.RGBA,r=t.RGBA,i=n.RGBA,o=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,p=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:r,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ue(t,e){const n=e();return V().getBool("DEBUG")&&jY(t),n}function jY(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+BY(t,e))}const PY=596e-10,LY=65504;function zY(t){return!!(V().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||PY<Math.abs(t)&&Math.abs(t)<LY)}function BY(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function $h(t,e){return cr(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function MY(t,e){const n=cr(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(ue(t,()=>t.shaderSource(n,e)),ue(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function VY(t,e){const n=cr(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(ue(t,()=>t.shaderSource(n,e)),ue(t,()=>t.compileShader(n)),V().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw u_(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const WY=/ERROR: [0-9]+:([0-9]+):/g;function u_(t,e){const n=WY.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],a=t.split(`
`),r=a.length.toString().length+2,i=a.map((d,p)=>Pi((p+1).toString(),r)+d);let o=0;for(let d=0;d<i.length;d++)o=Math.max(i[d].length,o);const l=i.slice(0,s-1),u=i.slice(s-1,s),c=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Pi(u[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function UY(t){return cr(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function GY(t,e){if(ue(t,()=>t.linkProgram(e)),!V().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function xy(t,e){if(ue(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function HY(t,e){const n=cr(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),ue(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function KY(t,e){const n=cr(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return ue(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),ue(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function qY(t){return cr(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function JY(t,e){const n=V().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,a=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+a+".")}}function XY(t){return cr(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function qS(t,e,n,s,a,r,i){const o=t.getAttribLocation(e,n);return o===-1?!1:(ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),ue(t,()=>t.vertexAttribPointer(o,a,t.FLOAT,!1,r,i)),ue(t,()=>t.enableVertexAttribArray(o)),!0)}function YY(t,e,n){nQ(t,n),ue(t,()=>t.activeTexture(t.TEXTURE0+n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function QY(t,e,n){return cr(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function ZY(t,e,n){return t.getUniformLocation(e,n)}function eQ(t,e,n,s){ue(t,()=>YY(t,e,s)),ue(t,()=>t.uniform1i(n,s))}function ky(t,e,n){ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function JS(t,e){ue(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),ue(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Th(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+tQ(t,e))}function tQ(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function cr(t,e,n){const s=ue(t,()=>e());if(s==null)throw new Error(n);return s}function nQ(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const a=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${a}.`)}}function Il(t,e=2){return H(t.slice(0,t.length-e))}function $l(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Eh(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Il(t),...$l(t)]),e}function sQ(t,e=!1){let n=V().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=V().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&V().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((o,l)=>l>=t.length-2?wm(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=nr(t).newShape);let a=H(t),r=null;t.length<=1&&a<=n?r=[1,a]:t.length===2&&t[0]<=n&&t[1]<=n?r=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?r=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?r=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?r=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(r=[t[0],t[1]*t[2]*t[3]]);const i=r!=null&&Math.max(...r)>s&&Math.min(...r)<=(e?2:1)&&Math.min(...r)>0;if(r==null||i)if(e){const o=Il(t);let l=2,u=2;t.length&&([l,u]=$l(t)),a=o*(l/2)*(u/2),r=vf(a).map(c=>c*2)}else r=vf(a);return r}function Ah(t){return t%2===0}function Jf(t,e){if(t=t.slice(-2),e=e.slice(-2),Re(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||Ah(n)&&Ah(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Ah(t[0])&&Ah(e[0])}let vy,Sy;function aQ(t){if(vy==null){const e=ra(t);vy=e.getParameter(e.MAX_TEXTURE_SIZE)}return vy}function rQ(t){if(Sy==null){const e=ra(t);Sy=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Sy)}function iQ(t){if(t===0)return 0;let e;const n=ra(t);return Es(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Es(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Es(t,e){return t.getExtension(e)!=null}function XS(t){try{if(ra(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function oQ(t){if(t===0)return!1;const e=ra(t);if(t===1){if(!Es(e,"OES_texture_float"))return!1}else if(!Es(e,"EXT_color_buffer_float"))return!1;return fb(e)}function lQ(t){if(t===0)return!1;const e=ra(t);if(t===1){if(!Es(e,"OES_texture_float")||!Es(e,"WEBGL_color_buffer_float"))return!1}else{if(Es(e,"EXT_color_buffer_float"))return fb(e);const s="EXT_color_buffer_half_float";if(Es(e,s)){const a=e.getExtension(s);return uQ(e,a)}return!1}return fb(e)}function fb(t){const e=iv(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function uQ(t,e){const n=iv(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(i),o}function cQ(t){return t!==2?!1:ra(t).fenceSync!=null}function Xp(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&C(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fe=V();fe.registerFlag("HAS_WEBGL",()=>fe.getNumber("WEBGL_VERSION")>0);fe.registerFlag("WEBGL_VERSION",()=>XS(2)?2:XS(1)?1:0);fe.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);fe.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>fe.get("WEBGL_VERSION")===2);fe.registerFlag("WEBGL_CPU_FORWARD",()=>!0);fe.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);fe.registerFlag("WEBGL_PACK",()=>fe.getBool("HAS_WEBGL"));fe.registerFlag("WEBGL_PACK_NORMALIZATION",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_PACK_CLIP",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_PACK_REDUCE",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_LAZILY_UNPACK",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_CONV_IM2COL",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>fe.getBool("WEBGL_PACK"));fe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>aQ(fe.getNumber("WEBGL_VERSION")));fe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>rQ(fe.getNumber("WEBGL_VERSION")));fe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=fe.getNumber("WEBGL_VERSION");return t===0?0:iQ(t)});fe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>fe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!$x());fe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>oQ(fe.getNumber("WEBGL_VERSION")));fe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>fe.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:fe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));fe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>lQ(fe.getNumber("WEBGL_VERSION")));fe.registerFlag("WEBGL_FENCE_API_ENABLED",()=>cQ(fe.getNumber("WEBGL_VERSION")));fe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>fe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);fe.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});fe.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>$x()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});fe.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);fe.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);fe.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);fe.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);fe.registerFlag("WEBGL_EXP_CONV",()=>!1);fe.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>fe.getBool("IS_TEST"));fe.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);fe.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);fe.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);fe.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cn(){let t,e,n,s,a,r,i,o,l,u;return V().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",a="texture",r="outputColor",i="out vec4 outputColor;",o=V().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",a="texture2D",r="gl_FragColor",i="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:a,output:r,defineOutput:i,defineSpecialNaN:o,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Io(t,e,n="index"){const s=ye(e);return s.map((a,r)=>{const i=`int ${t[r]} = ${n} / ${a}`,o=r===s.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * ${a}`:`index -= ${t[r]} * ${a}`;return`${i}; ${o};`}).join("")}function $0(t,e,n="index"){const s=ye(e);return s.map((a,r)=>{const i=`int ${t[r]} = ${n} / outShapeStrides[${r}]`,o=r===s.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * outShapeStrides[${r}]`:`index -= ${t[r]} * outShapeStrides[${r}]`;return`${i}; ${o};`}).join("")}function dQ(t,e){const n=t.length,s=t.map(r=>`${e}[${r}]`),a=new Array(n-1);a[n-2]=s[n-1];for(let r=n-3;r>=0;--r)a[r]=`(${a[r+1]} * ${s[r+1]})`;return a}function pQ(t,e,n="index"){const s=t.map((r,i)=>i),a=dQ(s,e);return a.map((r,i)=>{const o=`int ${t[i]} = ${n} / ${a[i]}`,l=i===a.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${a[i]}`:`index -= ${t[i]} * ${a[i]}`;return`${o}; ${l};`}).join("")}function ov(t){const e=ye(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function lv(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const c_=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:d_}=DE;function hQ(t,e,n){const s=[];if(t.forEach(h=>{const f=H(h.shapeInfo.logicalShape);if(h.shapeInfo.isUniform?s.push(`uniform float ${h.name}${f>1?`[${f}]`:""};`):(s.push(`uniform sampler2D ${h.name};`),s.push(`uniform int offset${h.name};`)),n.enableShapeUniforms){const{uniformShape:g}=uv(n.packedInputs,h.shapeInfo.logicalShape,h.shapeInfo.texShape);switch(g.length){case 1:s.push(`uniform int ${h.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${h.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${h.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${h.name}Shape;`);break}s.push(`uniform ivec2 ${h.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(h=>{s.push(`uniform ${h.type} ${h.name}${h.arrayIndex?`[${h.arrayIndex}]`:""};`)});const a=s.join(`
`),r=t.map(h=>fQ(h,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,o=Cn(),l=yQ(o);let u,c,d=xQ(o);return e.isPacked?(u=mQ(e.logicalShape,i,n.enableShapeUniforms),c=bQ(o)):(u=gQ(e.logicalShape,i,n.enableShapeUniforms),c=wQ(o)),n.packedInputs&&(d+=NQ),[d,l,c,a,u,r,n.userCode].join(`
`)}function Fu(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return jQ(t,e);case 1:return LQ(t,e);case 2:return BQ(t,e);case 3:return VQ(t,e);case 4:return UQ(t,e);case 5:return GQ(t);case 6:return HQ(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function p_(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return FQ(t);case 1:return PQ(t,e);case 2:return zQ(t,e);case 3:return MQ(t,e);default:return WQ(t,e)}}function fQ(t,e,n=!1,s){let a="";n?a+=p_(t,s):a+=Fu(t,s);const r=t.shapeInfo.logicalShape,i=e.logicalShape;return r.length<=i.length&&(n?a+=KQ(t,e):a+=qQ(t,e)),a}function mQ(t,e,n){switch(t.length){case 0:return h_();case 1:return CQ(t,e,n);case 2:return _Q(t,e,n);case 3:return $Q(t,e,n);default:return EQ(t,e,n)}}function gQ(t,e,n){switch(t.length){case 0:return h_();case 1:return IQ(t,e,n);case 2:return OQ(t,e,n);case 3:return TQ(t,e,n);case 4:return AQ(t,e,n);case 5:return RQ(t,e);case 6:return DQ(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function yQ(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function wQ(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function bQ(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function xQ(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${kQ}
    ${vQ}
    ${SQ}
  `}const kQ=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,vQ=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,SQ=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,NQ=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function h_(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function CQ(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function IQ(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function $Q(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[2]/2),r=a*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec3(b, r, c);
    }
  `}function TQ(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${$0(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Io(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function EQ(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[t.length-1]/2),r=a*Math.ceil(t[t.length-2]/2);let i=r,o="",l="b, r, c";for(let u=2;u<t.length-1;u++)i*=t[t.length-u-1],o=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+o,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${o}

      int b = index / ${r};
      index -= b * ${r};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec${t.length}(${l});
    }
  `}function AQ(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${$0(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Io(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function RQ(t,e){const n=Io(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function DQ(t,e){const n=Io(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function _Q(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Re(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const a=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec2(r, c);
    }
  `}function OQ(t,e,n){return Re(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function $o(t){return`offset${t}`}function FQ(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=Cn();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function jQ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[a,r]=t.shapeInfo.texShape;if(a===1&&r===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=$o(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[o,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function PQ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,r=Cn();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${r.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${r.texture2D}(${n}, uv);
    }
  `}function LQ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${ju(t)}
      }
    `;const a=t.shapeInfo.texShape,r=a[0],i=a[1];if(i===1&&r===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=$o(n);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${r}.0);
        return sampleTexture(${n}, uv);
      }
    `:r===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${r}, ${i}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function zQ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t.shapeInfo.texShape,i=r[0],o=r[1],l=Cn();if(r!=null&&Re(n,r))return e?`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${a}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${a}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function BQ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t.shapeInfo.texShape;if(r!=null&&Re(n,r)){if(e)return`
      float ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const p=r[0],h=r[1];return`
    float ${a}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:o}=nr(n),l=i;if(l.length<n.length){const p=Pu(t,l),h=["row","col"];return`
      ${Fu(p,e)}
      float ${a}(int row, int col) {
        return ${a}(${Lu(h,o)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${ju(t)}
      }
    `;const u=r[0],c=r[1],d=$o(s);return c===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${a}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${a}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${s}, uv);
  }
`}function MQ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];if(n[0]===1){const p=n.slice(1),h=[1,2],f=Pu(t,p),g=["b","row","col"];return`
        ${p_(f,e)}
        vec4 ${a}(int b, int row, int col) {
          return ${a}(${Lu(g,h)});
        }
      `}const o=Cn();if(e)return`
    vec4 ${a}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `;const l=i[0],u=i[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${a}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${o.texture2D}(${s}, uv);
    }
  `}function VQ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n[1]*n[2],i=n[2],{newShape:o,keptDims:l}=nr(n),u=o;if(u.length<n.length){const g=Pu(t,u),y=["row","col","depth"];return`
        ${Fu(g,e)}
        float ${a}(int row, int col, int depth) {
          return ${a}(${Lu(y,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${r}, ${i}, 1)));
        ${ju(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],p=c[1],h=t.shapeInfo.flatOffset;if(p===r&&h==null)return e?`
      float ${a}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${a}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(p===i&&h==null)return e?`
      float ${a}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${a}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const f=$o(s);return e?`
    float ${a}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${f};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${a}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r} + col * ${i} + depth + ${f};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${s}, uv);
      }
  `}function WQ(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),a=Cn();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${n}, uv);
    }
  `;const r=t.shapeInfo.logicalShape,i=r.length,o=t.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=l[0],c=l[1],d=Math.ceil(r[i-1]/2);let p=d*Math.ceil(r[i-2]/2),h="int b, int row, int col",f=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<i-1;g++)h=`int b${g}, `+h,p*=r[i-g-1],f=`b${g} * ${p} + `+f;return`
    vec4 ${s}(${h}) {
      int index = ${f};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${a.texture2D}(${n}, uv);
    }
  `}function UQ(t,e){const n=t.shapeInfo.logicalShape,s=t.name,a="get"+s.charAt(0).toUpperCase()+s.slice(1),r=n[3],i=n[2]*r,o=n[1]*i,{newShape:l,keptDims:u}=nr(n);if(l.length<n.length){const w=Pu(t,l),b=["row","col","depth","depth2"];return`
      ${Fu(w,e)}
      float ${a}(int row, int col, int depth, int depth2) {
        return ${a}(${Lu(b,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${i}, ${r}, 1)));
        ${ju(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],h=d[1],f=`int stride2 = ${s}Shape[3];`,g=`int stride1 = ${s}Shape[2] * stride2;`,y=`int stride0 = ${s}Shape[1] * stride1;`;if(h===o&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        ${f}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(h===r&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;const m=$o(s);return e?`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${f}
      ${g}
      ${y}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${m});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} +
          depth * ${r} + depth2;
      vec2 uv = uvFromFlat(${p}, ${h}, index + ${m});
      return sampleTexture(${s}, uv);
    }
  `}function GQ(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],r=e[3]*a,i=e[2]*r,o=e[1]*i,{newShape:l,keptDims:u}=nr(e);if(l.length<e.length){const g=Pu(t,l),y=["row","col","depth","depth2","depth3"];return`
      ${Fu(g)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Lu(y,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${i}, ${r}, ${a})) +
          depth3;
        ${ju(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],h=d[1];if(h===o&&c==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${r}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===a&&c==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const f=$o(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${i} + depth * ${r} +
          depth2 * ${a} + depth3 + ${f};
      vec2 uv = uvFromFlat(${p}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function HQ(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:r}=nr(e);if(a.length<e.length){const y=Pu(t,a),m=["row","col","depth","depth2","depth3","depth4"];return`
      ${Fu(y)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Lu(m,r)});
      }
    `}const i=e[5],o=e[4]*i,l=e[3]*o,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${ju(t)}
      }
    `;const d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,h=p[0],f=p[1];if(f===c&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${o}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===i&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=$o(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${o} + depth3 * ${i} + depth4 + ${g};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function ju(t){const e=t.name,n=H(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function KQ(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),a="get"+s+"AtOutCoords",r=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,o=d_(t.shapeInfo.logicalShape,e.logicalShape),l=He(i),u=i-r;let c;const d=["x","y","z","w","u","v"];r===0?c="":i<2&&o.length>=1?c="coords = 0;":c=o.map(w=>`coords.${d[w+u]} = 0;`).join(`
`);let p="";i<2&&r>0?p="coords":p=t.shapeInfo.logicalShape.map((w,b)=>`coords.${d[b+u]}`).join(", ");let h="return outputValue;";const g=H(t.shapeInfo.logicalShape)===1,m=H(e.logicalShape)===1;if(r===1&&!g&&!m)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!m)i===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(o.length){const w=r-2,b=r-1;o.indexOf(w)>-1&&o.indexOf(b)>-1?h="return vec4(outputValue.x);":o.indexOf(w)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(b)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${a}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${s}(${p});
      ${h}
    }
  `}function qQ(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),a="get"+s+"AtOutCoords",r=e.texShape,i=t.shapeInfo.texShape,o=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===l&&t.shapeInfo.flatOffset==null&&Re(i,r))return`
      float ${a}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=He(l),c=d_(t.shapeInfo.logicalShape,e.logicalShape),d=l-o;let p;const h=["x","y","z","w","u","v"];o===0?p="":l<2&&c.length>=1?p="coords = 0;":p=c.map(g=>`coords.${h[g+d]} = 0;`).join(`
`);let f="";return l<2&&o>0?f="coords":f=t.shapeInfo.logicalShape.map((g,y)=>`coords.${h[y+d]}`).join(", "),`
    float ${a}() {
      ${u} coords = getOutputCoords();
      ${p}
      return get${s}(${f});
    }
  `}function He(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function uv(t,e,n){const{newShape:s,keptDims:a}=nr(e),r=e.length,i=t&&r===3&&e[0]===1,o=i?e.slice(1):s,l=!t&&r>1&&!Re(e,n)&&s.length<r||i;return{useSqueezeShape:l,uniformShape:l?o:e,keptDims:a}}function Pu(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Lu(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JQ(t,e,n,s){const a=n.map((c,d)=>{const p={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(p.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:p}}),r=a.map(c=>c.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},o=hQ(a,i,e),l=VY(t.gl,o),u=t.createProgram(l);return V().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:r,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:o,webGLProgram:u,inShapeInfos:r,outShapeInfo:i},f_(t,e,u)))}function f_(t,e,n){const s=[],a=[];let r,i,o,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),V().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const p={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(p.shape=t.getUniformLocation(n,`${d}Shape`,c),p.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),s.push(p)}if(e.enableShapeUniforms&&(r=t.getUniformLocation(n,"outShape",c),o=t.getUniformLocation(n,"outShapeStrides",c),i=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)a.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:s,customUniformLocations:a,infLoc:l,nanLoc:u,outShapeLocation:r,outShapeStridesLocation:o,outTexShapeLocation:i}}function YS(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const a=n.logicalShape,r=e[s],i=r.shape;if(!Re(a,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${a} and ${i} must match`);if(n.isUniform&&r.isUniform)return;const o=n.texShape,l=r.isUniform?null:r.texData.texShape;if(!Re(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function XQ(t,e,n,s,a){e.program.enableShapeUniforms||(YS(e.inShapeInfos,n),YS([e.outShapeInfo],[s]));const r=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(r.texture,i[0],i[1]):t.setOutputMatrixTexture(r.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),V().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:p,texShape:h}=e.variablesLocations[l];if(p){const{uniformShape:f}=uv(e.program.packedInputs,u.shape,u.texData.texShape);switch(f.length){case 1:t.gl.uniform1iv(p,new Int32Array(f));break;case 2:t.gl.uniform2iv(p,new Int32Array(f));break;case 3:t.gl.uniform3iv(p,new Int32Array(f));break;case 4:t.gl.uniform4iv(p,new Int32Array(f));break}}if(h&&t.gl.uniform2i(h,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(H(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let f=u.uniformValues;f instanceof Float32Array||(f=new Float32Array(f)),t.gl.uniform1fv(c,f)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const o=e.outShapeLocation;if(o)switch(s.shape.length){case 1:t.gl.uniform1iv(o,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(o,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(o,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(o,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=ye(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&a)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=a[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function YQ(t,e,n){let s="";e.concat(n).forEach(i=>{const o=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=uv(t.packedInputs,i.shape,l);let p="",h="",f="";if(c.length===1&&t.packedInputs){const v=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${v[0]>1}_${v[1]>1}`}else if(c.length===2&&!t.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const v=ye(c);f=`${v[0]===l[1]}_${v[v.length-1]===l[1]}`}const g=i.shape.length,y=c.length===2&&Re(i.shape,l),m=H(i.shape)===1,w=eo(i.shape,n.shape),b=!t.packedInputs&&g===n.shape.length&&Re(l,n.texData.texShape),x=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${g}_${b}_${u?d:""}_${c.length}_${m}_${w}_${y}_${p}_${h}_${f}_${x}_${o}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${o}`}});const a=t.userCode;let r=t.constructor.name;return r+="_"+s+"_"+a+`${V().getNumber("WEBGL_VERSION")}`,r}function pn(t){return V().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QQ{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=ad.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Cn();this.outputShape=e,this.enableShapeUniforms=pn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?$0(["r","c","d"],e):Io(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZQ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=ad.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Cn();this.outputShape=e,this.enableShapeUniforms=pn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?$0(["r","c","d"],e):Io(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eZ{constructor(e){this.variableNames=["A"],this.outTexUsage=ls.DOWNLOAD;const n=Cn();this.outputShape=e,this.userCode=`
      ${c_}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tZ{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ls.DOWNLOAD;const n=Cn();this.outputShape=e,this.userCode=`
      ${c_}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nZ={R:0,G:1,B:2,A:3};class QS{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const a=Cn();this.outputShape=e,this.enableShapeUniforms=pn(this.outputShape.length);let r="result";n&&(r="floor(result * 255. + 0.5)");let i="";for(let o=0;o<s.length;o++){const l=s[o];i+=`
          if(offset == ${o}) {
            result = values[${nZ[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?lv():ov(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${a.texture2D}(A, uv);
          ${i}
        }
        ${a.output} = vec4(${r}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sZ{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Cn();this.outputShape=e,this.enableShapeUniforms=pn(this.outputShape.length);let a="",r="result";n&&(r="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let o=0;o<=1;o++){const l=i*2+o;a+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?lv():ov(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${a}

          ${s.output} = ${r};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aZ(t){const e=Cn(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return MY(t,n)}function rZ(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return HY(t,e)}function iZ(t){const e=new Uint16Array([0,1,2,2,1,3]);return KY(t,e)}function Yp(t,e,n,s,a,r){JY(e,n);const i=qY(t),o=t.TEXTURE_2D;return ue(t,()=>t.bindTexture(o,i)),ue(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),ue(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),ue(t,()=>t.texParameteri(o,t.TEXTURE_MIN_FILTER,t.NEAREST)),ue(t,()=>t.texParameteri(o,t.TEXTURE_MAG_FILTER,t.NEAREST)),V().getNumber("WEBGL_VERSION")===1?ue(t,()=>t.texImage2D(o,0,s,e,n,0,a,r,null)):ue(t,()=>t.texStorage2D(o,1,s,e,n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function m_(t){return t.internalFormatFloat}function oZ(t,e,n,s){const[a,r]=Jp(e,n);return Yp(t,a,r,m_(s),s.textureFormatFloat,t.FLOAT)}function g_(t){return t.internalFormatHalfFloat}function lZ(t,e,n,s){const[a,r]=Jp(e,n);return Yp(t,a,r,g_(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function y_(t){return t.downloadTextureFormat}function uZ(t,e,n,s){const[a,r]=Jp(e,n);return Yp(t,a,r,y_(s),t.RGBA,t.UNSIGNED_BYTE)}function w_(t){return t.internalFormatPackedFloat}function cZ(t,e,n,s){const[a,r]=Ou(e,n);return Yp(t,a,r,w_(s),t.RGBA,t.FLOAT)}function b_(t){return t.internalFormatPackedHalfFloat}function dZ(t,e,n,s){const[a,r]=Ou(e,n);return Yp(t,a,r,b_(s),t.RGBA,s.textureTypeHalfFloat)}function pZ(t,e,n){return ue(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),qS(t,e,"clipSpacePos",n,3,20,0)&&qS(t,e,"uv",n,2,20,12)}function hZ(t,e,n,s,a,r){ue(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,o,l;a instanceof Uint8Array?(i=new Uint8Array(n*s*4),o=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*s*4),o=t.FLOAT,l=r.internalFormatPackedFloat),i.set(a),V().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,o,i)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,o,i)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function fZ(t,e,n){ue(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?V().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):V().getNumber("WEBGL_VERSION")===2?ue(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):ue(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),ue(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function mZ(t,e,n,s){const a=t.createBuffer();ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,a));const o=4*4*e*n;return ue(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)),ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),ue(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),a}function gZ(t,e,n){const s=t,a=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,a),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),a}function yZ(t,e,n,s){const[a,r]=Jp(e,n),i=4,o=new Uint8Array(OY(e*n,i));return ue(t,()=>t.readPixels(0,0,a,r,s.downloadTextureFormat,t.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function wZ(t,e,n,s,a,r,i,o){const l=t,u=new Float32Array(FY(r,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function bZ(t,e,n){const s=new Float32Array(e*n*4);return ue(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ny{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=V().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,RY(n,e)):this.gl=ra(n),e=this.gl,V().getNumber("WEBGL_VERSION")===2){const r=e;this.createVertexArray=()=>ue(r,()=>r.createVertexArray()),this.bindVertexArray=i=>ue(r,()=>r.bindVertexArray(i)),this.deleteVertexArray=i=>ue(r,()=>r.deleteVertexArray(i)),this.getVertexArray=()=>ue(r,()=>r.getParameter(r.VERTEX_ARRAY_BINDING))}else if(e!=null){const r=e.getExtension("OES_vertex_array_object");if(r==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>ue(e,()=>r.createVertexArrayOES()),this.bindVertexArray=i=>ue(e,()=>r.bindVertexArrayOES(i)),this.deleteVertexArray=i=>ue(e,()=>r.deleteVertexArrayOES(i)),this.getVertexArray=()=>ue(e,()=>e.getParameter(r.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),V().getNumber("WEBGL_VERSION")===1){const r="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=$h(this.gl,r),Es(this.gl,i))this.textureHalfFloatExtension=$h(this.gl,i);else if(V().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Es(this.gl,a))this.colorBufferHalfFloatExtension=$h(this.gl,a);else if(V().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Es(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Es(this.gl,a))this.colorBufferHalfFloatExtension=this.gl.getExtension(a);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=rZ(this.gl),this.indexBuffer=iZ(this.gl),this.framebuffer=XY(this.gl),this.textureConfig=iv(this.gl,this.textureHalfFloatExtension)}get debug(){return V().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;ue(e,()=>e.finish()),ue(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),ue(e,()=>e.deleteFramebuffer(this.framebuffer)),ue(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),ue(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),ue(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),oZ(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),lZ(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),uZ(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),fZ(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,a){this.throwIfDisposed(),hZ(this.gl,e,n,s,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),dZ(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),cZ(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(JS(this.gl,this.framebuffer),this.outputTexture=null),ue(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>yZ(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,a,r,i){return wZ(this.gl,e,n,s,a,r,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return gZ(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const a=mZ(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(V().getBool("WEBGL_FENCE_API_ENABLED")){const a=e,r=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=a.clientWaitSync(r,0,0);return i===a.ALREADY_SIGNALED||i===a.CONDITION_SATISFIED},n=r}else V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>bZ(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=aZ(n));const s=UY(n);ue(n,()=>n.attachShader(s,this.vertexShader)),ue(n,()=>n.attachShader(s,e)),GY(n,s);const a=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&xy(n,a),a}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;ue(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),pZ(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(ue(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&xy(this.gl,this.program),ue(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?QY(this.gl,e,n):ZY(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),ue(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),eQ(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[a,r]=Ou(n,s);this.setOutputMatrixTextureDriver(e,a,r)}setOutputMatrixWriteRegion(e,n,s,a){this.setOutputMatrixWriteRegionDriver(s,e,a,n)}setOutputPackedMatrixWriteRegion(e,n,s,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&xy(this.gl,this.program),Th(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}ue(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),ue(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=$h(this.gl,V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,a=this.getQueryTimerExtensionWebGL2(),r=s.createQuery();return s.beginQuery(a.TIME_ELAPSED_EXT,r),r}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await Sw(()=>this.disposed||this.isQueryAvailable(e,V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,a=this.getQueryTimerExtensionWebGL2(),r=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),r&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),a=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),a&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=xZ(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in V().platform&&(s=V().platform.setTimeoutCustom.bind(V().platform)),Sw(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),ky(this.gl,e,this.framebuffer),this.debug&&Th(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(ky(this.gl,this.outputTexture,this.framebuffer),this.debug&&Th(this.gl)):JS(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const a=this.gl;ky(a,e,this.framebuffer),this.debug&&Th(a),this.outputTexture=e,ue(a,()=>a.viewport(0,0,n,s)),ue(a,()=>a.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,a){this.throwIfDisposed(),ue(this.gl,()=>this.gl.scissor(e,n,s,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function xZ(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:kZ,bincountImpl:x_,bincountReduceImpl:vZ,bitwiseAndImpl:SZ,castImpl:NZ,ceilImpl:CZ,concatImpl:IZ,equalImpl:$Z,expImpl:TZ,expm1Impl:EZ,floorImpl:AZ,gatherNdImpl:RZ,gatherV2Impl:DZ,greaterImpl:_Z,greaterEqualImpl:OZ,lessImpl:FZ,lessEqualImpl:jZ,linSpaceImpl:PZ,logImpl:LZ,maxImpl:zZ,maximumImpl:BZ,minimumImpl:MZ,multiplyImpl:VZ,negImpl:WZ,notEqualImpl:UZ,prodImpl:GZ,raggedGatherImpl:HZ,raggedRangeImpl:KZ,raggedTensorToTensorImpl:qZ,rangeImpl:JZ,rsqrtImpl:XZ,scatterImpl:YZ,sigmoidImpl:QZ,simpleAbsImpl:k_,sliceImpl:ZZ,sparseFillEmptyRowsImpl:eee,sparseReshapeImpl:tee,sparseSegmentReductionImpl:v_,sqrtImpl:nee,staticRegexReplaceImpl:see,stridedSliceImpl:aee,stringNGramsImpl:ree,stringSplitImpl:iee,stringToHashBucketFastImpl:oee,subImpl:lee,tileImpl:uee,topKImpl:cee,transposeImpl:cv,uniqueImpl:dee}=f7;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S_(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function xn(t,e){return e===1?[t]:S_(t,e)}function pee(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hee{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=pn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=xn("rc",this.rank),s=He(this.rank),a=this.getOutOfBoundsCondition(n),r=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${a}) {
            setOutput(vec4(0));
          } else {
            ${r}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let a=0;a<=1;a++){let r=`${s===0?"r":"rp1"}, ${a===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)r=`${e[e.length-1-i]},`+r;n.push(r)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],a=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${a};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N_{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=pn(this.outputShape.length);let s="";for(let a=0;a<4;a++){let r="thisRC = rc;";a%2===1&&(r+="thisRC.z += 1;"),a>1&&(r+="thisRC.y += 1;"),s+=`
        ${r}
        ${a>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${a}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${a>0?"}":""}
      `}this.userCode=`
      ${fee(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?lv():ov(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function fee(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?pQ(["r","c","d"],"inputShape"):Io(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mee{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const a=eN(n,s),r=tN(e,a,s);r in this.freeTextures||(this.freeTextures[r]=[]),r in this.usedTextures||(this.usedTextures[r]=[]);const i=ZS(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[r].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[r].pop();return this.usedTextures[r].push(l),l}let o;return a===Xt.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===Xt.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===Xt.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===Xt.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===Xt.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[r].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}releaseTexture(e,n,s,a){if(this.freeTextures==null)return;const r=eN(s,a),i=tN(n,r,a);i in this.freeTextures||(this.freeTextures[i]=[]);const o=ZS(n,r,this.gpgpu.gl,this.gpgpu.textureConfig,a),l=V().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const u=this.usedTextures[i],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function gee(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function ZS(t,e,n,s,a){const r=yee(e,s);let i;if(a){const[l,u]=Ou(t[0],t[1]);i=l*u}else{const[l,u]=Jp(t[0],t[1]);i=l*u}const o=gee(n,r);return i*o}function yee(t,e){switch(t){case Xt.PACKED_2X2_FLOAT32:return w_(e);case Xt.PACKED_2X2_FLOAT16:return b_(e);case Xt.UNPACKED_FLOAT32:return m_(e);case Xt.UNPACKED_FLOAT16:return g_(e);case Xt.PACKED_4X1_UNSIGNED_BYTE:return y_(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function wee(t){return V().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Xt.PACKED_2X2_FLOAT32:Xt.UNPACKED_FLOAT32:t?Xt.PACKED_2X2_FLOAT16:Xt.UNPACKED_FLOAT16}function eN(t,e){if(t===ls.UPLOAD)return Xt.PACKED_2X2_FLOAT32;if(t===ls.RENDER||t==null)return wee(e);if(t===ls.DOWNLOAD||t===ls.PIXELS)return Xt.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function tN(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ya{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=pn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ps="if (isnan(x)) return x;",bee="return x;",nN="return abs(x);",xee="return (x >= 0.0) ? x : (exp(x) - 1.0);",kee=Ps+`
  return (x < 0.0) ? 0.0 : x;
`,vee=Ps+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,wr="return x;",See="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nee="return x;",Cee=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Iee=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$ee=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Tee="return 1.0 / (1.0 + exp(-1.0 * x));";class Ir{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=pn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eee{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=pn(this.outputShape.length);const n=e.length,s=xn("rc",n),a=He(n),r=pee(n,s),i=s.slice(-2),o=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${a} rc = getOutputCoords();
        vec4 packedInput = getA(${r});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aee=e0,Ree=1e-7,Dee=1e-4,Rh={};function _ee(t){return t in Rh||(Rh[t]={}),Rh[t]}const Oee=V().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Fee=600;function jee(){return V().global.screen==null?1024:V().global.screen.height*V().global.screen.width*window.devicePixelRatio*Fee/1024/1024}class T0 extends ym{nextDataId(){return T0.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!V().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Ny)n=e;else{const s=ra(V().getNumber("WEBGL_VERSION"),e);n=new Ny(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=ra(V().getNumber("WEBGL_VERSION"));n=new Ny(s),this.binaryCache=_ee(V().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new mee(this.gpgpu),this.numMBBeforeWarning=jee(),this.texData=new yx(this,Ws())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,a,r,i){const o=this.makeTensorInfo(n,s),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[a,r]},l.texShape=[a,r];const u=Eh(n),c=new QS(u,!1,i),d=this.runWebGLProgram(c,[o],s,[[a,r]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(o),d.dataId}write(e,n,s){if((V().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||V().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.texData.set(a,{shape:n,dtype:s,values:e,usage:ls.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,a,r){if(V().getBool("DEBUG")&&this.checkNumericalProblems(n),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:a,values:n,usage:ls.UPLOAD,refCount:r})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:a,complexTensorInfos:r,slice:i,shape:o,isPacked:l}=n;if(i!=null){let p;l?p=new Ir(o,wr):p=new ya(o,wr);const h=this.runWebGLProgram(p,[{dataId:e,shape:o,dtype:a}],a),f=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),f}if(s!=null)return this.convertAndCacheOnCPU(e);if(a==="string")return s;const u=this.activeTimers!=null;let c;u&&(c=mn());let d;if(a==="complex64"){const p=this.readSync(r.real.dataId),h=this.readSync(r.imag.dataId);d=Za(p,h)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=mn()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const f=this.pendingRead.get(e);return new Promise(g=>f.push(g))}const n=this.texData.get(e),{values:s,shape:a,slice:r,dtype:i,complexTensorInfos:o,isPacked:l}=n;if(r!=null){let f;l?f=new Ir(a,wr):f=new ya(a,wr);const g=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:i}],i),y=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(V().getBool("DEBUG")&&!V().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&V().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(i!=="complex64"&&V().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const f=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(f.texture.texture,...Ih(a))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const f=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),g=f[0],y=f[1];d=Za(g,y)}else if(u==null)d=this.getValuesFromTexture(e);else{const f=H(a);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,f)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const f=this.gpgpu.gl;ue(f,()=>f.deleteBuffer(u))}const p=this.convertAndCacheOnCPU(e,d),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(f=>f(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Ws().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,n={}){const s=this.texData.get(e),{values:a,shape:r,slice:i,dtype:o,isPacked:l,texture:u}=s;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let h;l?h=new Ir(r,wr):h=new ya(r,wr);const f=this.runWebGLProgram(h,[{dataId:e,shape:r,dtype:o}],o),g=this.readToGPU(f,n);return this.disposeIntermediateTensorInfo(f),g}if(u==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=Ws().makeTensorFromTensorInfo(c),p=this.texData.get(c.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(a=>Xa(a));return Se(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Se(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!zY(s))throw V().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:a}=this.texData.get(e),r=H(n);if(V().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),h=this.texData.get(p.dataId),f=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...Ih(n)).subarray(0,r);return this.disposeIntermediateTensorInfo(p),f}const i=V().getBool("WEBGL_PACK")&&a===!0,o=i?Eh(n):n,l=i?new tZ(o):new eZ(o),u=this.runWebGLProgram(l,[{shape:o,dtype:s,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,r);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let a=!1;this.programTimersStack==null?(this.programTimersStack=s,a=!0):this.activeTimers.push(s),this.activeTimers=s,e();const r=Ca(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=Ca(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,a&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(r);o.kernelMs=JI(l),o.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:mn(),endMs:null}}endTimer(e){return V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=mn(),e)}async getQueryTime(e){if(V().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:a,usage:r,isPacked:i,slice:o}=this.texData.get(e),l=o&&o.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(a,s),this.textureManager.releaseTexture(n,a,r,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=Oee){return V().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&H(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){as("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return Aee(e.shape,n)}packedUnaryOp(e,n,s){const a=new Ir(e.shape,n),r=this.compileAndRun(a,[e],s);return Ws().makeTensorFromTensorInfo(r)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const a=k_(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,a)}if(V().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,nN,e.dtype);const n=new ya(e.shape,nN),s=this.compileAndRun(n,[e]);return Ws().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let a;if(n==="string"&&s!=null&&s.length>0&&ga(s[0])){const r=s.map(i=>xa(i));a=this.write(r,e,n)}else a=this.write(s,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}}makeOutput(e,n,s){return Ws().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new Eee(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new hee(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[Il(e.shape),...$l(e.shape)],a={dtype:e.dtype,shape:s,dataId:e.dataId},r=[Il(n),...$l(n)],i=new N_(r,s),o=!0,l=[s],u=this.runWebGLProgram(i,[a],e.dtype,l,o);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:a,shape:r,dtype:i}=s;if(n!=null){const p=H(r),h=n[0]*n[1]*4;C(p<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=Eh(r);let l;a?l=new ZQ(o):l=new QQ(o);const u=!0,c=[n??Ih(o)],d=this.runWebGLProgram(l,[{shape:o,dtype:i,dataId:e}],i,c,u,n);return{dtype:i,shape:r,dataId:d.dataId}}runWebGLProgram(e,n,s,a,r=!1,i){const o=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===ad.DENSE){const m=i??Ih(e.outputShape);l.texShape=m.map(w=>w*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),H(o.shape)===0)return l.values=Wt(o.dtype,0),o;const u=[],c=n.map(m=>{if(m.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let w=this.texData.get(m.dataId);if(w.texture==null){if(!e.packedInputs&&H(m.shape)<=V().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:m.shape,texData:null,isUniform:!0,uniformValues:w.values};e.packedInputs&&(w.isPacked=!0,w.shape=m.shape)}if(this.uploadToGPU(m.dataId),!!w.isPacked!=!!e.packedInputs)m=w.isPacked?this.unpackTensor(m):this.packTensor(m),u.push(m),w=this.texData.get(m.dataId);else if(w.isPacked&&!Jf(w.shape,m.shape)){const b=m,x=m.shape;m.shape=w.shape,m=this.packedReshape(m,x),u.push(m),w=this.texData.get(m.dataId),b.shape=x}return{shape:m.shape,texData:w,isUniform:!1}});this.uploadToGPU(o.dataId);const d={shape:o.shape,texData:l,isUniform:!1},p=YQ(e,c,d),h=this.getAndSaveBinary(p,()=>JQ(this.gpgpu,e,c,d)),f=this.activeTimers!=null;let g;f&&(g=this.startTimer()),V().get("ENGINE_COMPILE_ONLY")||XQ(this.gpgpu,h,c,d,a),u.forEach(m=>this.disposeIntermediateTensorInfo(m)),f&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const y=V().getNumber("WEBGL_FLUSH_THRESHOLD");if(y>0){const m=mn();m-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=m)}if(!V().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&r===!1){const m=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),m}return o}compileAndRun(e,n,s,a,r=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,a,r)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(V().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=B(()=>{if(!V().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=V().getBool("DEBUG");V().set("DEBUG",!1);const n=this.abs(we(1e-8)).dataSync()[0];if(V().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Ree:Dee}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:a,values:r,texture:i,usage:o,isPacked:l}=n;if(i!=null)return;const u=this.activeTimers!=null;let c;u&&(c=mn());let d=n.texShape;if(d==null&&(d=sQ(s,l),n.texShape=d),r!=null){const p=Eh(s);let h,f=d[1],g=d[0];const y=r instanceof Uint8Array||r instanceof Uint8ClampedArray;(l||!y)&&([f,g]=Ou(d[0],d[1])),l?h=new sZ(p,y):h=new QS(p,y);const m=y?[g,f]:d,w=this.makeTensorInfo(m,a),b=this.texData.get(w.dataId);y?b.usage=ls.PIXELS:b.usage=ls.UPLOAD,b.texShape=m,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(w.dataId),f,g,r);const x=[[g,f]],S=this.runWebGLProgram(h,[w],a,x,!0),N=this.texData.get(S.dataId);n.texShape=N.texShape,n.isPacked=N.isPacked,n.usage=N.usage,V().get("ENGINE_COMPILE_ONLY")?this.disposeData(S.dataId):(n.texture=N.texture,n.values=null,this.texData.delete(S.dataId)),this.disposeIntermediateTensorInfo(w),u&&(this.uploadWaitMs+=mn()-c)}else{const p=this.acquireTexture(d,o,a,l);n.texture=p}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:a}=s;return n!=null&&(s.values=Pee(n,a)),s.values}acquireTexture(e,n,s,a){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const r=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${r} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,a)}computeBytes(e,n){return e[0]*e[1]*Vc(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(a=>{try{this.checkCompletion_(n),a(!0)}catch(r){throw r}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await i1(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(u_(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:a,nanLoc:r,outShapeLocation:i,outShapeStridesLocation:o,outTexShapeLocation:l}=f_(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=a,e.nanLoc=r,e.outShapeLocation=i,e.outShapeStridesLocation=o,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:a,height:r,width:i,channels:o}=e,l=Ws().backend;if(!l.gpgpu.gl.isTexture(a))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(a,n,s,r,i,o);return Ws().makeTensorFromDataId(u,n,s,l)}}T0.nextDataId=0;function Pee(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Tx()&&Ax("webgl",()=>new T0,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dv=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class lo{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=ve(n,s),this.enableShapeUniforms=pn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const To=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class zu{constructor(e,n,s,a=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ve(n,s);const r=this.outputShape.length;this.enableShapeUniforms=pn(r);let i="";if(a)if(r===0||H(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${He(r)} coords = getOutputCoords();
        `,r===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=xn("coords",r);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[r-2]} + 1) >= outShape[${r} - 2];
            bool nextColOutOfBounds =
              (${l[r-1]} + 1) >= outShape[${r} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[r-2]} + 1) >= ${this.outputShape[r-2]};
            bool nextColOutOfBounds =
              (${l[r-1]} + 1) >= ${this.outputShape[r-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zn(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Lee={kernelName:Yl,backendName:"webgl",kernelFunc:Zn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mi(t){const{inputs:e,backend:n}=t,{real:s,imag:a}=e,r=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(r.dataId),o=Zn({inputs:{x:s},backend:n}),l=Zn({inputs:{x:a},backend:n});return i.complexTensorInfos={real:o,imag:l},r}const zee={kernelName:Im,backendName:"webgl",kernelFunc:mi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C_="return (a < 0.) ? b * a : a;",I_=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Bee(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{alpha:r}=s,i=n.makeTensorInfo([],"float32",sr(r,"float32")),o=V().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zu(I_,a.shape,i.shape):new lo(C_,a.shape,i.shape),l=n.runWebGLProgram(o,[a,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const Mee={kernelName:jd,backendName:"webgl",kernelFunc:Bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $_="return (a < 0.) ? b * a : a;",T_=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Vee(t){const{inputs:e,backend:n}=t,{x:s,alpha:a}=e,r=V().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zu(T_,s.shape,a.shape):new lo($_,s.shape,a.shape);return n.runWebGLProgram(r,[s,a],"float32")}const Wee={kernelName:tp,backendName:"webgl",kernelFunc:Vee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bu="if (isnan(x)) return x;";function je({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:a,backend:r})=>{const{x:i}=a,o=r,l=s||i.dtype;if(o.shouldExecuteOnCPU([i])&&n!=null){const d=o.texData.get(i.dataId),p=n(d.values,l);return o.makeTensorInfo(i.shape,l,p)}const u=V().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new Ir(i.shape,e):c=new ya(i.shape,t),o.runWebGLProgram(c,[i],l)}}function an({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:a,dtype:r}){return({inputs:i,backend:o})=>{const{a:l,b:u}=i,c=o;if(s&&l.dtype==="complex64"){const f=c.texData.get(l.dataId),g=c.texData.get(u.dataId),[y,m]=[[f.complexTensorInfos.real,g.complexTensorInfos.real],[f.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(b=>{const[x,v]=b,S={dataId:x.dataId,dtype:x.dtype,shape:l.shape},N={dataId:v.dataId,dtype:v.dtype,shape:u.shape},$=new lo(t,l.shape,u.shape);return c.runWebGLProgram($,[S,N],Rn(x.dtype,v.dtype))}),w=mi({inputs:{real:y,imag:m},backend:c});return c.disposeIntermediateTensorInfo(y),c.disposeIntermediateTensorInfo(m),w}const d=r||Rn(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&a!=null){const f=c.texData.get(l.dataId).values,g=c.texData.get(u.dataId).values,y=l.dtype==="string"?er(f):f,m=l.dtype==="string"?er(g):g,[w,b]=a(l.shape,u.shape,y,m,d),x=c.makeTensorInfo(b,d),v=c.texData.get(x.dataId);return v.values=w,x}const p=V().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let h;return p?h=new zu(e,l.shape,u.shape,n):h=new lo(t,l.shape,u.shape),c.runWebGLProgram(h,[l,u],d)}}function rd(t,e=!1){if(t==="linear")return e?Nee:bee;if(t==="relu")return e?Iee:kee;if(t==="elu")return e?Cee:xee;if(t==="relu6")return e?$ee:vee;if(t==="prelu")return e?T_:$_;if(t==="leakyrelu")return e?I_:C_;if(t==="sigmoid")return e?Tee:See;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E_{constructor(e,n,s,a=!1,r=!1,i=!1,o=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=pn(this.outputShape.length);const c=a?e[1]:e[2],d=Math.ceil(c/2),p=a?"i * 2, rc.y":"rc.y, i * 2",h=r?"rc.z, i * 2":"i * 2, rc.z",f=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let y="",m="";o&&(l?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:u?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:y=`vec4 activation(vec4 x) {
          ${o}
        }`,m="result = activation(result);");const w=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",x="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(x=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${y}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${x};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${h});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${f[0]} * ${g[0]});
          result += (${f[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${w}

        ${m}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sN={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class aN{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ve(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rN="return a * b;";function pv(t){const{inputs:e,backend:n}=t,{a:s,b:a}=e,r=Rn(s.dtype,a.dtype);if(s.dtype==="complex64"){const o=n.texData.get(s.dataId),l=n.texData.get(a.dataId),u=new aN(sN.REAL,s.shape,a.shape),c=new aN(sN.IMAG,s.shape,a.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:s.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:a.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:a.shape}],p=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),f=mi({inputs:{real:p,imag:h},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}if(n.shouldExecuteOnCPU([s,a])){const o=n.texData.get(s.dataId),l=n.texData.get(a.dataId),[u,c]=VZ(s.shape,a.shape,o.values,l.values,r),d=n.makeTensorInfo(c,r),p=n.texData.get(d.dataId);return p.values=u,d}let i;return V().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new zu(rN,s.shape,a.shape):i=new lo(rN,s.shape,a.shape),n.runWebGLProgram(i,[s,a],r)}const Uee={kernelName:iu,backendName:"webgl",kernelFunc:pv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gee(t,e,n){const s=[Il(t.shape),...$l(t.shape)],a={dtype:t.dtype,shape:s,dataId:t.dataId},r=[Il(e),...$l(e)],i=new N_(r,s),o=!0,l=[s],u=n.runWebGLProgram(i,[a],t.dtype,l,o);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ie(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{shape:r}=s,i=n,o=H(a.shape),l=bx(r,o),u=H(l);C(o===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${a.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const c=i.texData.get(a.dataId);return c.isPacked&&!Jf(a.shape,l)&&!(c.texture!==null&&Jf(c.shape,l))?Gee(a,l,i):(i.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype})}const Hee={kernelName:sp,backendName:"webgl",kernelFunc:ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iN{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:a,inSize:r,outSize:i}=e;this.outputShape=[a,i];const o=Math.floor(s/4)*4,l=s%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${qi(d)?d.toPrecision(2):d}, ones);`}let c="";r%s>0&&(c=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kee{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:a,inSize:r,outSize:i}=e;this.outputShape=[a,i];let o="0.0",l="";n==="prod"?o="1.0":n==="min"?(o="1.0 / 1e-20",l="min"):n==="max"&&(o="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(s/4)*4,d=s%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";n==="all"?(o="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):n==="any"&&(o="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let f="";r%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===2}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===3}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=p0(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function Eo(t,e,n,s){const a=qee(t.shape);let r=t;for(let i=0;i<a.length;i++){const{inSize:o,windowSize:l,outSize:u}=a[i];let c,d;n==="mean"?c=i===0?new iN({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:u},o):new iN({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:u}):c=new Kee({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:u},n),d=r,r=s.runWebGLProgram(c,[r],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jee{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[n[i]];this.outputShape=s,this.rank=s.length;const a=He(this.rank),r=Xee(n);this.userCode=`
    void main() {
      ${a} resRC = getOutputCoords();
      setOutput(getA(${r}));
    }
    `}}function Xee(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let a=0;a<t.length;a++)s[t[a]]=n[a];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yee{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let c=0;c<s.length;c++)s[c]=e[n[c]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const a=He(this.rank),r=S_("rc",this.rank),i=new Array(this.rank);for(let c=0;c<n.length;c++)i[n[c]]=r[c];const o=`vec2(${i.slice(-2).join()})`,l=`++${r[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${o})`;this.userCode=`
    void main() {
      ${a} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${r[this.rank-1]};
      if(++${r[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E0(t,e,n){const s=V().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Yee(t.shape,e):new Jee(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t,e,n,s){const a=e,r=t.shape.length,i=Ee(a,t.shape);let o=i;const l=ht(o,r),u=l!=null;let c=t;u&&(c=E0(t,l,s),o=vt(o.length,r)),nn("sum",o,r);const[d,p]=Ht(c.shape,o);let h=d;n&&(h=kt(d,i));const f=H(p),y=H(t.shape)/f,m=ie({inputs:{x:c},attrs:{shape:[y,f]},backend:s}),w=Ig(t.dtype),b=Eo(m,w,"sum",s),x=ie({inputs:{x:b},attrs:{shape:h},backend:s});return s.disposeIntermediateTensorInfo(m),s.disposeIntermediateTensorInfo(b),u&&s.disposeIntermediateTensorInfo(c),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A0(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s;return Qee(a,r,i,n)}const Zee={kernelName:up,backendName:"webgl",kernelFunc:A0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{perm:r}=s,i=n,o=a.shape.length,l=new Array(o);for(let c=0;c<l.length;c++)l[c]=a.shape[r[c]];let u;if(i.shouldExecuteOnCPU([a])){const d=i.texData.get(a.dataId).values,p=cv(d,a.shape,a.dtype,r,l);u=i.makeTensorInfo(l,a.dtype);const h=i.texData.get(u.dataId);h.values=p}else u=E0(a,r,i);return u}const ete={kernelName:Li,backendName:"webgl",kernelFunc:vn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A_=1e3;function Xf({a:t,b:e,transposeA:n,transposeB:s,backend:a,bias:r=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],p=s?e.shape[c-1]:e.shape[c-2],h=n?t.shape[u-1]:t.shape[u-2],f=s?e.shape[c-2]:e.shape[c-1],g=t.shape.slice(0,-2),y=e.shape.slice(0,-2),m=H(g),w=H(y),x=ve(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([h,f]);C(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const v=n?[m,d,h]:[m,h,d],S=s?[w,f,p]:[w,p,f],N=ie({inputs:{x:t},backend:a,attrs:{shape:v}}),$=ie({inputs:{x:e},backend:a,attrs:{shape:S}}),E=[N,$],A=Math.max(m,w),L=n?N.shape[1]:N.shape[2],W=r!=null,U=i!=null,j=l==="leakyrelu",z=l!=null?rd(l,!0):null,G=W||U||j||z!=null;let J;if((h===1||f===1)&&L>A_&&G===!1){let M=N,K=$;n&&(M=vn({inputs:{x:N},backend:a,attrs:{perm:[0,2,1]}}),E.push(M)),s&&(K=vn({inputs:{x:$},backend:a,attrs:{perm:[0,2,1]}}),E.push(K));const Y=f!==1,Q=f===1;let te=M;Y&&(te=ie({inputs:{x:M},backend:a,attrs:{shape:[A,L,1]}}),E.push(te));const ae=f===1?2:1;let se=K;Q&&(se=ie({inputs:{x:K},backend:a,attrs:{shape:[A,1,L]}}),E.push(se));const le=pv({inputs:{a:te,b:se},backend:a});J=A0({inputs:{x:le},backend:a,attrs:{axis:ae,keepDims:!0}}),E.push(le)}else{const M=Rn(t.dtype,e.dtype),K=new E_(v,S,[A,h,f],n,s,W,z,U,j),Y=[N,$];if(r!=null&&Y.push(r),U&&Y.push(i),j){const Q=a.makeTensorInfo([],"float32",sr(o,"float32"));Y.push(Q),E.push(Q)}J=a.runWebGLProgram(K,Y,M)}const O=ie({inputs:{x:J},backend:a,attrs:{shape:x}});E.push(J);for(const M of E)a.disposeIntermediateTensorInfo(M);return O}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tte(t){const{inputs:e,backend:n,attrs:s}=t,{a,b:r,bias:i,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=s;return Xf({a,b:r,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:o,leakyreluAlpha:d,activation:c})}const nte={kernelName:Wc,backendName:"webgl",kernelFunc:tte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oN="return abs(x);";function ste(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const r=n.texData.get(s.dataId),i=k_(r.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let a;return V().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new Ir(s.shape,oN):a=new ya(s.shape,oN),n.runWebGLProgram(a,[s],s.dtype)}const ate={kernelName:fd,backendName:"webgl",kernelFunc:ste};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rte=Ps+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,ite=je({opSnippet:rte}),ote={kernelName:Rl,backendName:"webgl",kernelFunc:ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lte=Ps+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,ute=je({opSnippet:lte}),cte={kernelName:Dl,backendName:"webgl",kernelFunc:ute};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lN="return a + b;",dte=an({opSnippet:lN,packedOpSnippet:lN,supportsComplex:!0,cpuKernelImpl:kZ}),pte={kernelName:yo,backendName:"webgl",kernelFunc:dte};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hte{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((r,i)=>`T${i}`);const s=[];this.variableNames.forEach(r=>{s.push(`float v${r} = get${r}AtOutCoords();`)});const a=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${a};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fte{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((r,i)=>`T${i}`);const s=[];this.variableNames.forEach(r=>{s.push(`vec4 v${r} = get${r}AtOutCoords();`)});const a=this.variableNames.map(r=>`v${r}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${a};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qh(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return Zn({inputs:{x:s[0]},backend:n});if(s.length>V().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),u=qh({inputs:s.slice(0,l),backend:n}),c=qh({inputs:s.slice(l),backend:n});return qh({inputs:[u,c],backend:n})}const a=s.map(l=>l.dtype).reduce((l,u)=>Rn(l,u)),r=s.map(l=>l.shape),o=V().getBool("WEBGL_PACK")?new fte(s[0].shape,r):new hte(s[0].shape,r);return n.runWebGLProgram(o,s,a)}const mte={kernelName:md,backendName:"webgl",kernelFunc:qh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gte(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=a.shape.length,l=Ee(r,a.shape);let u=l;const c=ht(u,o);let d=a;c!=null&&(d=vn({inputs:{x:a},backend:n,attrs:{perm:c}}),u=vt(u.length,o)),nn("all",u,o);const[p,h]=Ht(d.shape,u),f=H(h),g=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=Eo(g,g.dtype,"all",n);let m;if(i){const w=kt(p,l);m=ie({inputs:{x:y},backend:n,attrs:{shape:w}})}else m=ie({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),m}const yte={kernelName:xm,backendName:"webgl",kernelFunc:gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=a.shape.length,l=Ee(r,a.shape);let u=l;const c=ht(u,o);let d=a;c!=null&&(d=vn({inputs:{x:a},backend:n,attrs:{perm:c}}),u=vt(u.length,o)),nn("any",u,o);const[p,h]=Ht(d.shape,u),f=H(h),g=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=Eo(g,g.dtype,"any",n);let m;if(i){const w=kt(p,l);m=ie({inputs:{x:y},backend:n,attrs:{shape:w}})}else m=ie({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),m}const bte={kernelName:km,backendName:"webgl",kernelFunc:wte};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xte{constructor(e,n,s){this.variableNames=["A"];const{windowSize:a,batchSize:r,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[r,i];const o=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${a};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${a}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kte{constructor(e,n,s,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,C(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const r=e[e.length-1],i=Math.ceil(r/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,u=He(l),c=xn("coords",l);let d,p;if(i===1){p=l+1;const $=He(p);d=`
        ${$} sourceLocR = ${$}(${c.join()}, 0);
        ++${c[l-1]};
        ${$} sourceLocG = ${$}(${c.join()}, 0);
        ++${c[l-2]};
        ${$} sourceLocA = ${$}(${c.join()}, 0);
        --${c[l-1]};
        ${$} sourceLocB = ${$}(${c.join()}, 0);
        --${c[l-2]};`}else p=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const h=["x","y","z","w","u","v"].slice(0,p),f="."+h[p-1],g=h.map($=>"int "+$),y=xn("sourceLocR",p-1).concat("inIdx.r"),m=xn("sourceLocG",p-1).concat("inIdx.g"),w=xn("sourceLocB",p-1).concat("inIdx.b"),b=xn("sourceLocA",p-1).concat("inIdx.a"),x=s==="max"?"greaterThan":"lessThan",v=a?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${b.join()})));`,S=`vec4(
            getAChannel(${y.join()}),
            hasNextCol ? getAChannel(${m.join()}) : 0.,
            hasNextRow ? getAChannel(${w.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,N=a?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${N}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${o[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${S};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${v}
          vec4 candidate = ${S};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_(t,e,n,s=null){let a=e.shape[0],r=e.shape[1];s!=null&&(a=s.shape[0],r=s.shape[1]);const i=p0(r),o={windowSize:i,inSize:r,batchSize:a,outSize:Math.ceil(r/i)},l=new xte(o,n,s==null),u=[e];s!=null&&u.push(s);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=R_(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function D_(t,e,n,s=null){const a=s!=null?s.shape:e.shape,r=a[a.length-1],i=p0(r),o=new kte(a,i,n,s==null),l=s==null?[e]:[e,s],u=t.runWebGLProgram(o,l,"int32");if(u.shape.length===e.shape.length){const c=D_(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function __(t,e,n,s){const a=[n];if(nn("arg"+s.charAt(0).toUpperCase()+s.slice(1),a,e.shape.length),!V().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const r=[],i=t.texData.get(e.dataId),o=i!==null&&i.isPacked;let l=e;o&&(l=t.unpackTensor(e),r.push(l));const[u,c]=Ht(l.shape,a),d=H(c),p=ie({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});r.push(p);const h=R_(t,p,s);r.push(h);const f=ie({inputs:{x:h},backend:t,attrs:{shape:u}});return r.forEach(g=>t.disposeIntermediateTensorInfo(g)),f}return D_(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vte(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r}=s;let i=Ee(r,a.shape);const o=ht(i,a.shape.length);let l=a;const u=[];o!=null&&(l=vn({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),i=vt(i.length,l.shape.length)),nn("argMax",[i[0]],l.shape.length);const c=__(n,l,i[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const Ste={kernelName:gd,backendName:"webgl",kernelFunc:vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r}=s;let i=Ee(r,a.shape);const o=ht(i,a.shape.length);let l=a;const u=[];o!=null&&(l=vn({inputs:{x:a},backend:n,attrs:{perm:o}}),u.push(l),i=vt(i.length,l.shape.length)),nn("argMin",[i[0]],l.shape.length);const c=__(n,l,i[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const Cte={kernelName:yd,backendName:"webgl",kernelFunc:Nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ite=Ps+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,$te=je({opSnippet:Ite}),Tte={kernelName:_l,backendName:"webgl",kernelFunc:$te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ete=Ps+"return log(x + sqrt(x * x + 1.0));",Ate=je({opSnippet:Ete}),Rte={kernelName:Ol,backendName:"webgl",kernelFunc:Ate};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dte=Ps+`
  return atan(x);
`,_te=je({opSnippet:Dte}),Ote={kernelName:Fl,backendName:"webgl",kernelFunc:_te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fte=dv+`
  return atan(a, b);
`,jte=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+To+`
  return result;
`,Pte=an({opSnippet:Fte,packedOpSnippet:jte}),Lte={kernelName:Pl,backendName:"webgl",kernelFunc:Pte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zte=Ps+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Bte=je({opSnippet:zte}),Mte={kernelName:jl,backendName:"webgl",kernelFunc:Bte};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class id{constructor(e,n,s,a=!1,r=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,h=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",y=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,m=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let w="0.0";if(g||(w="-1.0 / 1e-20"),s){const $=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${h}, ${f});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${$} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${a?r?y:m:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let x=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(x="avgValue / max(count, 1.0)");const v=Math.floor(i/4)*4,S=i%4,N=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${h}, ${f});
      const float initializationValue = ${w};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${w});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${v}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${N}
          }

          int xC = xCCorner + ${v};
          if (${S===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${N}
          } else if (${S===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${N}
          } else if (${S===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${N}
          }
        }
        setOutput(${x});
      }
    `}}class hv{constructor(e,n,s,a=!1,r=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,o=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,p=e.dilationWidth,h=e.effectiveFilterDepth,f=e.effectiveFilterHeight,g=e.effectiveFilterWidth,y=e.padInfo.front,m=e.padInfo.top,w=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let x="0.0";if(b||(x="-1.0 / 1e-20"),s){const A=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${u});
        const ivec3 pads = ivec3(${y}, ${m}, ${w});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${f};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${A} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${a?r?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${f} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const v="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / max(count, 1.0)");const N=Math.floor(i/4)*4,$=i%4,E=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${v}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${u});
      const ivec3 pads = ivec3(${y}, ${m}, ${w});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${N}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${E}
            }

            int xC = xCCorner + ${N};
            if (${$===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${$===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${E}
            } else if (${$===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${E}
            }
          }
        }
        setOutput(${S});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vte(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;Xp(a,"avgPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=s,u=1;C(tn(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Fs(a.shape,r,i,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Re(c.inShape,c.outShape))return Zn({inputs:{x:a},backend:n});const d=new id(c,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}const Wte={kernelName:wd,backendName:"webgl",kernelFunc:Vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ute(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{filterSize:r,strides:i,pad:o,dimRoundingMode:l,dataFormat:u}=s,c=[1,1,1],d=ar(a.shape,r,i,c,o,l,u),p=new hv(d,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}const Gte={kernelName:bd,backendName:"webgl",kernelFunc:Ute};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hte{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,p=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Kte{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=d-1-e.padInfo.front,g=p-1-e.padInfo.top,y=h-1-e.padInfo.left,m=1/(n*s*a);this.userCode=`
      const ivec3 pads = ivec3(${f}, ${g}, ${y});
      const float avgMultiplier = float(${m});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${r}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qte(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,i=r,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=s,d=[1,1,1],p=ar(i.shape,o,l,d,u,c),h=new Kte(p);return n.runWebGLProgram(h,[a],i.dtype)}const Jte={kernelName:Sm,backendName:"webgl",kernelFunc:qte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xte(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,i=r;Xp([a,r],"avgPoolGrad");const{filterSize:o,strides:l,pad:u}=s,c=Fs(i.shape,o,l,1,u),d=new Hte(c);return n.runWebGLProgram(d,[a],i.dtype)}const Yte={kernelName:vm,backendName:"webgl",kernelFunc:Xte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qte(t){const{inputs:e,backend:n,attrs:s}=t,{a,b:r}=e,{transposeA:i,transposeB:o}=s;return Xf({a,b:r,transposeA:i,transposeB:o,backend:n})}const Zte={kernelName:xd,backendName:"webgl",kernelFunc:Qte};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ene{constructor(e,n,s,a,r,i){this.outputShape=[],this.variableNames=["x","mean","variance"],ve(e,n),ve(e,s);let o="0.0";a!=null&&(ve(e,a),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";r!=null&&(ve(e,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tne{constructor(e,n,s,a,r,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ve(e,n),ve(e,s);let o="vec4(0.0)";a!=null&&(ve(e,a),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";r!=null&&(ve(e,r),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nne=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:a,variance:r,offset:i,scale:o}=t;C(a.shape.length===r.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),C(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),C(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[s,a,r];let c=null;i!=null&&(c=i.shape,u.push(i));let d=null;o!=null&&(d=o.shape,u.push(o));const p=V().getBool("WEBGL_PACK_NORMALIZATION")?new tne(s.shape,a.shape,r.shape,c,d,l):new ene(s.shape,a.shape,r.shape,c,d,l);return e.runWebGLProgram(p,u,u[0].dtype)},sne={kernelName:_d,backendName:"webgl",kernelFunc:nne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ane{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=He(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=rne(this.rank);let a;const r=e.map((i,o)=>`sourceLoc.${mb[o]} = start[${o}] + coords.${mb[o]};`);a=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${r.join(`
`)}
      `,this.userCode=`
      void main() {
        ${a}
        setOutput(getSource(${s}));
      }
    `}}const mb=["x","y","z","w","u","v"];function rne(t){if(t===1)return"sourceLoc";if(t<=6)return mb.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ine{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=He(this.rank),s=xn("coords",this.rank),a=xn("sourceLoc",this.rank),r=this.rank===1?"sourceLoc":`vec2(${a.slice(-2).join()})`,i=`getChannel(getSource(${a.join()}), ${r})`,o=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${a[this.rank-1]};
        result.y = ${i};
        --${a[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${a[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${a[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${a[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function one(t,e,n,s){const a=s.texData.get(t.dataId),r=s.makeTensorInfo(n,t.dtype),i=s.texData.get(r.dataId);Object.assign(i,a),i.refCount=1,i.shape=n,i.dtype=t.dtype;let o=a1(e,ye(t.shape));a.slice&&(o+=a.slice.flatOffset),i.slice={flatOffset:o,origDataId:a.slice&&a.slice.origDataId||t.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),r}function Mu(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{begin:r,size:i}=s,[o,l]=d0(a,r,i);if(t1(a,o,l),H(l)===0)return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||a.dtype==="string"){const d=n.texData.get(a.dataId),p=ZZ(d.values,o,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,p)}const{isPacked:u}=n.texData.get(a.dataId),c=s1(a.shape,o,l);if(u||!c){const d=V().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ine(l):new ane(l),p=[o];return n.runWebGLProgram(d,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),one(a,o,l,n)}const lne={kernelName:lp,backendName:"webgl",kernelFunc:Mu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const une=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockShape:r,crops:i}=s;C(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=r.reduce((w,b)=>w*b),l=Pp(a.shape,r,o),u=Lp(l.length,r.length),c=zp(a.shape,r,o),d=c1(i,r.length),p=d1(c,i,r.length),h=[],f=ie({inputs:{x:a},backend:n,attrs:{shape:l}}),g=vn({inputs:{x:f},backend:n,attrs:{perm:u}}),y=ie({inputs:{x:g},backend:n,attrs:{shape:c}}),m=Mu({inputs:{x:y},backend:n,attrs:{begin:d,size:p}});return h.push(f),h.push(g),h.push(y),h.forEach(w=>n.disposeIntermediateTensorInfo(w)),m},cne={kernelName:kd,backendName:"webgl",kernelFunc:une};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,weights:r}=e,{size:i}=s,o=n.readSync(a.dataId),l=n.readSync(r.dataId),u=x_(o,l,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,u)}const pne={kernelName:Nm,backendName:"webgl",kernelFunc:dne};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hne=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,fne=`
  return float(int(a.r) & int(b.r));
`;function mne(t){const{inputs:e,backend:n}=t,{a:s,b:a}=e,r=V().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=V().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,a])||i===1){const l=n.texData.get(s.dataId).values,u=n.texData.get(a.dataId).values,[c,d]=SZ(s.shape,a.shape,l,u,s.dtype),p=n.makeTensorInfo(d,s.dtype),h=n.texData.get(p.dataId);return h.values=c,p}let o;return r?o=new zu(hne,s.shape,a.shape,!1):o=new lo(fne,s.shape,a.shape),n.runWebGLProgram(o,[s,a],s.dtype)}const gne={kernelName:vd,backendName:"webgl",kernelFunc:mne};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yne(t){const{inputs:e,backend:n}=t,{s0:s,s1:a}=e,r=n.readSync(s.dataId),i=n.readSync(a.dataId),o=ve(Array.from(r),Array.from(i));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const wne={kernelName:Cm,backendName:"webgl",kernelFunc:yne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bne="return float(a != b);",O_=an({opSnippet:bne,cpuKernelImpl:UZ,dtype:"bool"}),xne={kernelName:Xd,backendName:"webgl",kernelFunc:O_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qp(t){const{inputs:e,backend:n}=t,{input:s}=e,a=n.texData.get(s.dataId);return Zn({inputs:{x:a.complexTensorInfos.real},backend:n})}const kne={kernelName:rg,backendName:"webgl",kernelFunc:Qp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vne="return float(int(x));";function Sne(t,e){const n=new ya(t.shape,vne),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gb(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{dtype:r}=s;if(r==="complex64"){if(a.dtype==="complex64")return Zn({inputs:{x:a},backend:n});const i=$t(a.shape),o=gb({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=mi({inputs:{real:o,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(o),l}if(a.dtype==="complex64"){const i=Qp({inputs:{input:a},backend:n}),o=gb({inputs:{x:i},backend:n,attrs:{dtype:r}});return n.disposeIntermediateTensorInfo(i),o}if(!xx(a.dtype,r)){const i=Zn({inputs:{x:a},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:r}}if(n.shouldExecuteOnCPU([a])){const i=n.texData.get(a.dataId).values,[o,l,u]=NZ(i,a.shape,a.dtype,r);return n.makeTensorInfo(o,l,u)}if(r==="int32")return Sne(a,n);if(r==="bool"){const i=n.makeTensorInfo([],"bool",Wt("bool",1)),l=O_({inputs:{a,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${r}`)}const Nne={kernelName:Ll,backendName:"webgl",kernelFunc:gb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uN="return ceil(x);",Cne=je({opSnippet:uN,packedOpSnippet:uN,cpuKernelImpl:CZ}),Ine={kernelName:zl,backendName:"webgl",kernelFunc:Cne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ne{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{clipValueMin:r,clipValueMax:i}=s;let o;V().getBool("WEBGL_PACK_CLIP")?o=new Tne(a.shape):o=new $ne(a.shape);const l=[[r],[i]];return n.runWebGLProgram(o,[a],a.dtype,l)}const Ane={kernelName:Bl,backendName:"webgl",kernelFunc:Ene};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rne{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cN(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function Dne(t){const{inputs:e,backend:n}=t,{x:s}=e,a=n.texData.get(s.dataId),r=new Rne(s.shape),i=[cN(s,a.complexTensorInfos.real),cN(s,a.complexTensorInfos.imag)];return n.runWebGLProgram(r,i,i[0].dtype)}const _ne={kernelName:Sd,backendName:"webgl",kernelFunc:Dne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class One{constructor(e){this.outputShape=[],this.outputShape=va(e,1),this.variableNames=e.map((i,o)=>`T${o}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const o=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${o}));`)}const a=n.length,r=n[n.length-1];s.push(`else setOutput(getT${a}(yR, yC-${r}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fne{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=va(e,n);const s=this.outputShape,a=s.length,r=He(a),i=xn("coords",a),o=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((g,y)=>`T${y}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const u=o[n],c=o.slice(-2),d=o.join();let p=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let g=1;g<l.length;g++){const y=l[g-1];p+=`
        if (${u} < ${l[g]}  && ${u} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${Dh(o,u,y)}),
            vec2(${Dh(c,u,y)}));
        }`}const h=l.length,f=l[l.length-1];p+=`
        return getChannel(
          getT${h}(${Dh(o,u,f)}),
          vec2(${Dh(c,u,f)}));`,this.userCode=`
      float getValue(${o.map(g=>"int "+g)}) {
        ${p}
      }

      void main() {
        ${r} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[a-1]} = ${i[a-1]} + 1;
        if (${i[a-1]} < ${s[a-1]}) {
          result.g = getValue(${i});
        }

        ${i[a-2]} = ${i[a-2]} + 1;
        if (${i[a-2]} < ${s[a-2]}) {
          result.a = getValue(${i});
        }

        ${i[a-1]} = ${i[a-1]} - 1;
        if (${i[a-2]} < ${s[a-2]} &&
            ${i[a-1]} < ${s[a-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function Dh(t,e,n){const s=t.indexOf(e);return t.map((r,i)=>i===s?`${r} - ${n}`:r).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R0(t){const{inputs:e,backend:n}=t,{input:s}=e,a=n.texData.get(s.dataId);return Zn({inputs:{x:a.complexTensorInfos.imag},backend:n})}const jne={kernelName:Gm,backendName:"webgl",kernelFunc:R0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cc(t,e,n){const s=t[0].dtype;if(s==="complex64"){const h=t.map(w=>Qp({inputs:{input:w},backend:n})),f=t.map(w=>R0({inputs:{input:w},backend:n})),g=cc(h,e,n),y=cc(f,e,n),m=mi({inputs:{real:g,imag:y},backend:n});return h.forEach(w=>n.disposeIntermediateTensorInfo(w)),f.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),m}let a=n.shouldExecuteOnCPU(t);if(s==="string"&&(a=!0),a){const h=t.map(x=>{const S=[-1,H(x.shape.slice(e))];return ie({inputs:{x},backend:n,attrs:{shape:S}})}),f=h.map(x=>({vals:n.readSync(x.dataId),shape:x.shape})),g=va(h.map(x=>x.shape),1),y=h[0].shape[0]===1,m=IZ(f,g,s,y),w=va(t.map(x=>x.shape),e),b=n.makeTensorInfo(w,s,m);return h.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}const r=t.filter(h=>H(h.shape)>0),i=V().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&r[0].shape.length>1;if(r.length===1){const h=i?new ya(t[0].shape,wr):new Ir(t[0].shape,wr);return n.runWebGLProgram(h,t,s)}const o=V().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(r.length>o){const h=[];for(let g=0;g<r.length;g+=o){const y=r.slice(g,g+o);h.push(cc(y,e,n))}const f=cc(h,e,n);for(const g of h)n.disposeIntermediateTensorInfo(g);return f}if(i){const h=new Fne(r.map(f=>f.shape),e);return n.runWebGLProgram(h,r,s)}const{tensors2D:l,outShape:u}=Pne(r,e,n),c=new One(l.map(h=>h.shape)),d=n.runWebGLProgram(c,l,s);l.forEach(h=>n.disposeIntermediateTensorInfo(h));const p=ie({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),p}function Pne(t,e,n){const s=va(t.map(r=>r.shape),e);return{tensors2D:t.map(r=>ie({inputs:{x:r},attrs:{shape:[-1,H(r.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F_(t){const{inputs:e,backend:n,attrs:s}=t,{axis:a}=s,r=Ee(a,e[0].shape)[0],i=e.map(u=>u.shape);o1(i,r);const o=va(e.map(u=>u.shape),r);if(H(o)===0)return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(u=>H(u.shape)>0);return l.length===1?Zn({inputs:{x:l[0]},backend:n}):cc(l,r,n)}const Lne={kernelName:Nd,backendName:"webgl",kernelFunc:F_};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j_{constructor(e,n=!1,s=null,a=!1,r=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,h=e.filterWidth,f=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,y=e.dataFormat==="channelsLast",m=y?1:2,w=y?2:3,b=y?3:1;let x="",v="";s&&(a?x=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?x=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:x=`
          float activation(float x) {
            ${s}
          }
        `,v="result = activation(result);");const S=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${x}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${m}], coords[${w}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${f}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${y}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${y}) {
                dotProd +=
                    getX(batch, xR, xC, ${f}) *
                    getW(wR, wC, ${f}, d2);
              } else {
                dotProd +=
                    getX(batch, ${f}, xR, xC) *
                    getW(wR, wC, ${f}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2)
              );

              if (${y}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2),
                getW(wR, wC, ${f} + 2, d2)
              );

              if (${y}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1),
                  getX(batch, xR, xC, ${f} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC),
                  getX(batch, ${f} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${S}
        ${v}
        setOutput(result);
      }
    `}}class zne{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,a=e.padInfo.left,r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,p=e.filterHeight,h=e.filterWidth,f=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${r}, ${i}, ${o});
      const ivec3 pads = ivec3(${n}, ${s}, ${a});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${f}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${f}) *
                  getW(wF, wR, wC, ${f}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1),
                  getX(batch, xF, xR, xC, ${f} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2),
                  getW(wF, wR, wC, ${f} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P_{constructor(e,n=!1,s=null,a=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=pn(this.outputShape.length);const i=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<c;y++)p+=`
           vec4 xTexelC${y*2};
           int xTexelC${y*2}Ready;
           vec4 xTexelC${y*2+1};
           int xTexelC${y*2+1}Ready;
           vec4 xC${y};`;p+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let y=0;y<c;y++)p+=`
           xTexelC${y*2} = vec4(0.0);
           xTexelC${y*2}Ready = 0;
           xTexelC${y*2+1} = vec4(0.0);
           xTexelC${y*2+1}Ready = 0;
           xC${y} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let y=0;y<(d+1)/2;y++){const m=y*2;if(p+=`
           xC = xCCorner + ${m*l};
           `,o===1){if(m<c&&(i%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }
               `,l===1&&m>0?p+=`
                 xC${m} = vec4(xTexelC${m-2}.zw, xTexelC${m}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${m} = vec4(previous.zw, xTexelC${m}.xy);
                   } else {
                     xC${m} = vec4(0.0, 0.0, xTexelC${m}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xC${m} = xTexelC${m};
                 `,m+1<c)){const w=i%2===0?wm(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${w};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                     xTexelC${m+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${m+1}.zw = vec2(0.0);
                     }
                     xTexelC${m+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${m+1} = vec4(previous.zw, xTexelC${m+1}.xy);
                     } else {
                      xC${m+1} = vec4(0.0, 0.0, xTexelC${m+1}.xy);
                     }
                     `:p+=`
                     xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.xy);
                     `):w===1?p+=`
                     xC${m+1} = xTexelC${m};
                     `:p+=`
                     xCOffset = xC + ${w};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                       xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${m+1}.zw = vec2(0.0);
                       }
                       xTexelC${m+1}Ready = 1;
                     }

                     xC${m+1} = xTexelC${m+1};
                     `}}else m<c&&(i%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.0);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
               `,m+1<c&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${m+1} = vec4(xTexelC${m+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${m}Ready == 0) {
                   xTexelC${m} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${m}.zw = vec2(0.0);
                   }
                   xTexelC${m}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${m+1}Ready == 0) {
                   xTexelC${m+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${m+1}.zw = vec2(0.);
                   }
                   xTexelC${m+1}Ready = 1;
                 }

                 xC${m} = vec4(
                   xTexelC${m}.xy, xTexelC${m+1}.xy);
               `,m+1<c&&(p+=`
                   xC${m+1} = vec4(xTexelC${m}.zw, xTexelC${m+1}.zw);
                 `)));m<c&&(p+=`
             wTexel = getW(r, ${m}, d1, d2);
             dotProd += xC${m}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${m}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,m+1<c&&(p+=`
               wTexel = getW(r, ${m+1}, d1, d2);
               dotProd += xC${m+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${m+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let h="",f="";s&&(a?h=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:r?h=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:h=`vec4 activation(vec4 x) {
           ${s}
         }`,f="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${f}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bne{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=pn(this.outputShape.length);const{dataFormat:s}=n,a=Cn(),r=s==="channelsLast",i=r?1:2,o=r?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${r}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${a.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yf(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function L_({x:t,filter:e,convInfo:n,backend:s,bias:a=null,preluActivationWeights:r=null,leakyreluAlpha:i=0,activation:o=null}){const l=t.shape,u=s.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,h=n.dataFormat==="channelsLast",f=!1,g=!1;let y;const m=[];if(r!=null){const x=Yf(r.shape,h);x!=null&&(r=ie({inputs:{x:r},backend:s,attrs:{shape:x}}),m.push(r))}if(a!=null){const x=Yf(a.shape,h);x!=null&&(a=ie({inputs:{x:a},backend:s,attrs:{shape:x}}),m.push(a))}if(!((d===1||p===1)&&c>A_)&&u.isPacked&&h&&u.texture!=null&&l[2]%2!==0&&Re(u.shape.slice(-3),l.slice(-3))){const x=l[0]*l[1]*(l[2]+1),v={dataId:t.dataId,shape:[1,x,n.inChannels],dtype:t.dtype},S=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,C(Jf(u.shape,v.shape),()=>`packed reshape ${u.shape} to ${v.shape} isn't free`);const N=ie({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});m.push(N);const $=Xf({a:v,b:N,backend:s,transposeA:f,transposeB:g,bias:a,activation:o,preluActivationWeights:r,leakyreluAlpha:i}),E=s.texData.get($.dataId);C(E.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=S,E.shape=n.outShape,y=Zn({inputs:{x:$},backend:s}),y.shape=n.outShape,m.push($)}else{const x=n.outHeight*n.outWidth,v=ie({inputs:{x:t},backend:s,attrs:{shape:h?[n.batchSize,x,n.inChannels]:[n.batchSize,n.inChannels,x]}}),S=ie({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),N=Xf({a:h?v:S,b:h?S:v,transposeA:!h,transposeB:g,backend:s,bias:a,activation:o,preluActivationWeights:r,leakyreluAlpha:i});y=ie({inputs:{x:N},backend:s,attrs:{shape:n.outShape}}),m.push(v),m.push(S),m.push(N)}for(const x of m)s.disposeIntermediateTensorInfo(x);return y}function z_({x:t,filter:e,convInfo:n,backend:s,bias:a=null,preluActivationWeights:r=null,leakyreluAlpha:i=0,activation:o=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:p,dataFormat:h}=n,f=h==="channelsLast",g=l*u*c,y=p*d,m=[n.batchSize,g,y],w=!0,b=!1,x=[];if(r!=null){const O=Yf(r.shape,f);O!=null&&(r=ie({inputs:{x:r},backend:s,attrs:{shape:O}}),x.push(r))}if(a!=null){const O=Yf(a.shape,f);O!=null&&(a=ie({inputs:{x:a},backend:s,attrs:{shape:O}}),x.push(a))}const v=ie({inputs:{x:e},backend:s,attrs:{shape:[1,g,H(e.shape)/g]}});x.push(v);const S=new Bne(m,n),N=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],$=s.runWebGLProgram(S,[t],"float32",N),E=ie({inputs:{x:$},backend:s,attrs:{shape:m}});x.push($),x.push(E);const A=a!=null,L=r!=null,W=o==="leakyrelu",U=o?rd(o,!0):null,j=new E_(f?E.shape:v.shape,f?v.shape:E.shape,f?[n.batchSize,y,n.outChannels]:[n.batchSize,n.outChannels,y],w,b,A,U,L,W),z=f?[E,v]:[v,E];if(a&&z.push(a),L&&z.push(r),W){const O=s.makeTensorInfo([],"float32",sr(i,"float32"));z.push(O),x.push(O)}const G=s.runWebGLProgram(j,z,"float32"),J=ie({inputs:{x:G},backend:s,attrs:{shape:n.outShape}});x.push(G);for(const O of x)s.disposeIntermediateTensorInfo(O);return J}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mne(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dataFormat:l,dilations:u,dimRoundingMode:c}=s,d=rr(l),p=Gt(a.shape,r.shape,i,u,o,c,!1,d);let h;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))h=L_({x:a,filter:r,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&V().getBool("WEBGL_EXP_CONV")){const g=new P_(p),y=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];h=n.runWebGLProgram(g,[a,r],"float32",y)}else if(V().getBool("WEBGL_CONV_IM2COL"))h=z_({x:a,filter:r,convInfo:p,backend:n});else{const g=new j_(p);h=n.runWebGLProgram(g,[a,r],"float32")}const f=ie({inputs:{x:h},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(h),f}const Vne={kernelName:Cd,backendName:"webgl",kernelFunc:Mne};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wne{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Une{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=e.dataFormat==="channelsLast",o=n-1-e.padInfo.top,l=s-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Gne{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,a=e.strideWidth,r=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${r};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${a} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Hne{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,a=e.filterWidth,r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,l=n-1-e.padInfo.front,u=s-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${r}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${a}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${a} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,pad:o,dataFormat:l,dimRoundingMode:u,filterShape:c}=s,d=rr(l),p=Gt(a.shape,c,i,1,o,u,!1,d),h=new Wne(p);return n.runWebGLProgram(h,[a,r],"float32")}const qne={kernelName:$m,backendName:"webgl",kernelFunc:Kne};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jne{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=pn(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,a=n-1-e.padInfo.top,r=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${r});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xne(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{inputShape:i,strides:o,pad:l,dataFormat:u,dimRoundingMode:c}=s,d=rr(u),p=Gt(i,r.shape,o,1,l,c,!1,d);if(V().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const h=[[p.strideHeight,p.strideWidth]],f=new Jne(p);return n.runWebGLProgram(f,[a,r],"float32",h)}else{const h=new Une(p);return n.runWebGLProgram(h,[a,r],"float32")}}const Yne={kernelName:Id,backendName:"webgl",kernelFunc:Xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l}=s,u=oi(a.shape,r.shape,i,l,o),c=new zne(u);return n.runWebGLProgram(c,[a,r],"float32")}const Zne={kernelName:$d,backendName:"webgl",kernelFunc:Qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,pad:o,filterShape:l}=s,u=oi(a.shape,l,i,1,o),c=new Gne(u);return n.runWebGLProgram(c,[a,r],"float32")}const tse={kernelName:Tm,backendName:"webgl",kernelFunc:ese};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nse(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{pad:i,strides:o,inputShape:l}=s,u=oi(l,r.shape,o,1,i),c=new Hne(u);return n.runWebGLProgram(c,[a,r],"float32")}const sse={kernelName:Em,backendName:"webgl",kernelFunc:nse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ase=Bu+`
  return cos(x);
`,rse=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${To}
  return result;
`,ise=je({opSnippet:ase,packedOpSnippet:rse}),ose={kernelName:Ml,backendName:"webgl",kernelFunc:ise};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lse=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,use=je({opSnippet:lse}),cse={kernelName:Vl,backendName:"webgl",kernelFunc:use};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dse{constructor(e,n,s,a,r){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,o,l,u]=e,[c]=n,[d,p]=s;this.outputShape=[c,d,p,u];const h=a==="bilinear"?1:0,[f,g]=[`${o-1}.0`,`${l-1}.0`],[y,m,w]=d>1?[`${(o-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${f} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${f}`],[b,x,v]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${y});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${m};
        float width_scale = ${x};

        float in_y = ${w};
        if( in_y < 0.0 || in_y > ${f} ) {
          setOutput(float(${r}));
          return;
        }
        float in_x = ${v};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${r}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${h} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pse=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:a,boxes:r,boxInd:i}=e,{cropSize:o,method:l,extrapolationValue:u}=s,c=new dse(a.shape,r.shape,o,l,u);return n.runWebGLProgram(c,[a,r,i],"float32")},hse={kernelName:Rm,backendName:"webgl",kernelFunc:pse};var od;(function(t){t.Prod="*",t.Sum="+"})(od||(od={}));class dN{constructor(e,n,s,a){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const r=this.outputShape.length,i=this.op===od.Prod?"1.0":"0.0",o=s?i:`getX(${pN(r,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";s?(u=a?`end != ${l-1}`:"end != 0",c=a?"end + 1":"end - 1"):(u=a?`end + pow2 < ${l}`:"end >= pow2",c=a?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${He(r)} coords = getOutputCoords();
        int end = ${hN(r,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${hN(r,"coords",this.op)} = idx;
          val ${this.op}= getX(${pN(r,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function pN(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function hN(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_(t,e,n,s,a,r){const i=e.shape.length,o=ht([s],i);let l=e;o!=null&&(l=vn({inputs:{x:e},backend:n,attrs:{perm:o}}));const u=vt(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const c=l.shape[u];let d=Zn({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(c))-1;p++){const h=new dN(t,l.shape,!1,r),f=[[p]],g=d;d=n.runWebGLProgram(h,[d],d.dtype,f),n.disposeIntermediateTensorInfo(g)}if(a){const p=new dN(t,l.shape,a,r),h=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(o!=null){const p=li(o),h=vn({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),h}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,exclusive:i,reverse:o}=s;return B_(od.Prod,a,n,r,i,o)}const mse={kernelName:Am,backendName:"webgl",kernelFunc:fse};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gse(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,exclusive:i,reverse:o}=s;return B_(od.Sum,a,n,r,i,o)}const yse={kernelName:Td,backendName:"webgl",kernelFunc:gse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,weights:r}=e,{size:i,binaryOutput:o}=s;if(a.shape.length===1){const l=n.readSync(a.dataId),u=n.readSync(r.dataId),c=x_(l,u,r.dtype,r.shape,i);return n.makeTensorInfo([i],r.dtype,c)}else if(a.shape.length===2){const l=n.bufferSync(a),u=n.bufferSync(r),c=vZ(l,u,i,o);return n.makeTensorInfo(c.shape,r.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const bse={kernelName:Dm,backendName:"webgl",kernelFunc:wse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xse{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kse(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockSize:r,dataFormat:i}=s,o=a.shape[0],l=i==="NHWC"?a.shape[1]:a.shape[2],u=i==="NHWC"?a.shape[2]:a.shape[3],c=i==="NHWC"?a.shape[3]:a.shape[1],d=l*r,p=u*r,h=c/(r*r),f=i==="NHWC"?[o,d,p,h]:[o,h,d,p],g=new xse(f,r,i);return n.runWebGLProgram(g,[a],a.dtype)}const vse={kernelName:_m,backendName:"webgl",kernelFunc:kse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M_{constructor(e,n=!1,s=null,a=!1,r=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=pn(this.outputShape.length);const i=e.filterHeight,o=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";s&&(a?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V_{constructor(e,n=!1,s=null,a=!1,r=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=pn(this.outputShape.length);const i=e.outChannels/e.inChannels,o=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,p=d;let h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<d;m++)h+=`
          vec4 xTexelC${m*2};
          int xTexelC${m*2}Ready;
          vec4 xTexelC${m*2+1};
          int xTexelC${m*2+1}Ready;
          vec4 xC${m};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let m=0;m<d;m++)h+=`
          xTexelC${m*2} = vec4(0.0);
          xTexelC${m*2}Ready = 0;
          xTexelC${m*2+1} = vec4(0.0);
          xTexelC${m*2+1}Ready = 0;
          xC${m} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let m=0;m<(p+1)/2;m++){const w=m*2;if(h+=`
          xC = xCCorner + ${w*u};
          `,l===1){if(w<d&&(o%2===1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }
              `,u===1&&w>0?h+=`
                xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                  } else {
                    xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }

                xC${w} = xTexelC${w};
                `,w+1<d)){const b=o%2===0?wm(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                    xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${w+1}.zw = vec2(0.0);
                    }
                    xTexelC${w+1}Ready = 1;
                  }
                  `,u>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                    } else {
                     xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                    }
                    `:h+=`
                    xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                    `):b===1?h+=`
                    xC${w+1} = xTexelC${w};
                    `:h+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                      xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${w+1}.zw = vec2(0.0);
                      }
                      xTexelC${w+1}Ready = 1;
                    }

                    xC${w+1} = xTexelC${w+1};
                    `}}else w<d&&(o%2===1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                  xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${w+1}.zw = vec2(0.0);
                  }
                  xTexelC${w+1}Ready = 1;
                }

                xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
              `,w+1<d&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                  xTexelC${w} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${w}.zw = vec2(0.0);
                  }
                  xTexelC${w}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                  xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${w+1}.zw = vec2(0.);
                  }
                  xTexelC${w+1}Ready = 1;
                }

                xC${w} = vec4(
                  xTexelC${w}.xy, xTexelC${w+1}.xy);
              `,w+1<d&&(h+=`
                  xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                `)));w<d&&(h+=`
            wTexel = getW(r, ${w}, d1, q);
            dotProd += xC${w} * vec4(wTexel.xz, wTexel.xz);
          `,w+1<d&&(h+=`
              wTexel = getW(r, ${w+1}, d1, q);
              dotProd += xC${w+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  `,h+=`
      }
    `;let f="",g="";s&&(a?f=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:r?f=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:f=`vec4 activation(vec4 x) {
          ${s}
        }`,g="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),r&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${y}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sse(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l,dimRoundingMode:u}=s;let c=l;c==null&&(c=[1,1]),C(tn(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=Gt(a.shape,r.shape,i,c,o,u,!0);let p;V().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new V_(d):p=new M_(d);const h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[a,r],"float32",h)}const Nse={kernelName:Ed,backendName:"webgl",kernelFunc:Sse};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cse{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,a=e.padInfo.top,r=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${r};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Ise{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,a=e.strideHeight,r=e.strideWidth,i=n-1-e.padInfo.top,o=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $se(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,dy:r}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:u,filterShape:c}=s,d=Gt(a.shape,c,i,o,l,u,!0),p=new Cse(d);return n.runWebGLProgram(p,[a,r],"float32")}const Tse={kernelName:Om,backendName:"webgl",kernelFunc:$se};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,filter:r}=e,{strides:i,dilations:o,pad:l,dimRoundingMode:u,inputShape:c}=s,d=Gt(c,r.shape,i,o,l,u,!0),p=new Ise(d);return n.runWebGLProgram(p,[a,r],"float32")}const Ase={kernelName:Fm,backendName:"webgl",kernelFunc:Ese};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rse{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dse(t){const{inputs:e,backend:n}=t,{x:s}=e,a=[...s.shape,...s.shape],r=H(s.shape),i=ie({inputs:{x:s},backend:n,attrs:{shape:[r]}}),o=new Rse(r),l=n.runWebGLProgram(o,[i],i.dtype),u=ie({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}const _se={kernelName:jm,backendName:"webgl",kernelFunc:Dse};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ose{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:a,strideHeight:r,strideWidth:i,filterHeight:o,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:p}=a;this.userCode=`
      const ivec2 strides = ivec2(${r}, ${i});
      const ivec2 pads = ivec2(${d}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fse(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r}=e,{strides:i,pad:o,dilations:l}=s,u=bp(a.shape,r.shape,i,o,"NHWC",l);let c;const d=new Ose(u);c=n.runWebGLProgram(d,[a,r],"float32");const p=ie({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),p}const jse={kernelName:Ad,backendName:"webgl",kernelFunc:Fse};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pse(t){const{inputs:e,backend:n,attrs:s}=t,{equation:a}=s,r=e,{allDims:i,summedDims:o,idDims:l}=b1(a,r.length);k1(i.length,l,r);const{path:u,steps:c}=v1(o,l),d=c.length;let p=null,h=i.length;const f=[];for(let g=0;g<d;++g){for(const y of c[g]){const{permutationIndices:m,expandDims:w}=x1(h,l[y]);let b;S1(m)?b=r[y]:(b=vn({inputs:{x:r[y]},backend:n,attrs:{perm:m}}),f.push(b));const x=b.shape.slice();for(let v=0;v<w.length;++v)x.splice(w[v],0,1);Re(b.shape,x)||(b=ie({inputs:{x:b},backend:n,attrs:{shape:x}}),f.push(b)),p===null?p=b:(p=pv({inputs:{a:b,b:p},backend:n}),f.push(p))}g<d-1&&(u[g]>=0&&(p=A0({inputs:{x:p},backend:n,attrs:{axis:u[g]-(i.length-h),keepDims:!1}}),f.push(p)),h--)}for(const g of f)g!==p&&n.disposeIntermediateTensorInfo(g);return p}const Lse={kernelName:Lm,backendName:"webgl",kernelFunc:Pse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zse="return (x >= 0.0) ? x : (exp(x) - 1.0);",Bse=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Mse=je({opSnippet:zse,packedOpSnippet:Bse}),Vse={kernelName:Ul,backendName:"webgl",kernelFunc:Mse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wse="return (b >= 0.0) ? a : a * (b + 1.0);",Use=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Gse=t=>{const{inputs:e,backend:n}=t,{dy:s,y:a}=e,r=V().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new zu(Use,s.shape,a.shape):new lo(Wse,s.shape,a.shape);return n.runWebGLProgram(r,[s,a],s.dtype)},Hse={kernelName:zm,backendName:"webgl",kernelFunc:Gse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kse=`
  return vec4(equal(a, b));
`,qse="return float(a == b);",Jse=an({opSnippet:qse,packedOpSnippet:Kse,dtype:"bool",cpuKernelImpl:$Z}),Xse={kernelName:Rd,backendName:"webgl",kernelFunc:Jse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yse=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${p1};
  float a1 = ${h1};
  float a2 = ${f1};
  float a3 = ${m1};
  float a4 = ${g1};
  float a5 = ${y1};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Qse=je({opSnippet:Yse}),Zse={kernelName:Gl,backendName:"webgl",kernelFunc:Qse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eae=Bu+`
  return exp(x);
`,tae=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,W_=je({opSnippet:eae,packedOpSnippet:tae,cpuKernelImpl:TZ,dtype:"float32"}),nae={kernelName:Hl,backendName:"webgl",kernelFunc:W_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yb(t){const{inputs:e,attrs:n,backend:s}=t,{dim:a}=n,{input:r}=e,i=r.shape.length,o=r.shape.slice();let l=a;return a<0&&(C(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+a+1),o.splice(l,0,1),ie({inputs:{x:r},backend:s,attrs:{shape:o}})}const sae={kernelName:Dd,backendName:"webgl",kernelFunc:yb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fN="return exp(x) - 1.0;",aae=je({opSnippet:fN,packedOpSnippet:fN,cpuKernelImpl:EZ}),rae={kernelName:Kl,backendName:"webgl",kernelFunc:aae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mN{constructor(e,n,s){this.variableNames=["real","imag"];const a=n[1];this.outputShape=n;const r=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${a}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${r};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${a});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${a}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_(t,e,n){const s=n.texData.get(t.dataId),a=H(t.shape),r=t.shape[t.shape.length-1],i=a/r,o=ie({inputs:{x:t},backend:n,attrs:{shape:[i,r]}}),l=o.shape,u=new mN("real",l,e),c=new mN("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),f=mi({inputs:{real:p,imag:h},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h);const g=ie({inputs:{x:f},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(f),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iae(t){const{inputs:e,backend:n}=t,{input:s}=e;return U_(s,!1,n)}const oae={kernelName:Bm,backendName:"webgl",kernelFunc:iae};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lae{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zp(t){const{backend:e,attrs:n}=t,{shape:s,value:a}=n;let{dtype:r}=n;if(r=r||mo(a),r==="string"){const i=gt(r,H(s));return i.fill(a),e.makeTensorInfo(s,r,i)}else{const i=new lae(s,a),o=[[a]];return e.runWebGLProgram(i,[],r,o)}}const uae={kernelName:Mm,backendName:"webgl",kernelFunc:Zp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cae{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dae={kernelName:Vm,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,a=new cae(n.shape);return s.runWebGLProgram(a,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gN="return floor(x);",pae=je({opSnippet:gN,packedOpSnippet:gN,cpuKernelImpl:AZ}),hae={kernelName:ql,backendName:"webgl",kernelFunc:pae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fae=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,mae=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,gae=an({opSnippet:fae,packedOpSnippet:mae,dtype:"int32"}),yae={kernelName:Jl,backendName:"webgl",kernelFunc:gae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wae{constructor(e){this.variableNames=["A"];const n=Cn(),[s,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${a}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bae{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Cn(),[s,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${a}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xae={kernelName:$f,backendName:"webgl",kernelFunc:kae};let Do,Cy=V().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function kae(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:a}=e;const{numChannels:r}=s,i=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[l,u]=i?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=[u,l],d=[u,l,r];if(o||i){const g=V().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Do==null||g!==Cy)&&(Cy=g,Do=document.createElement("canvas").getContext("2d",{willReadFrequently:Cy})),Do.canvas.width=l,Do.canvas.height=u,Do.drawImage(a,0,0,l,u),a=Do.canvas}const p=n.makeTensorInfo(c,"int32");n.texData.get(p.dataId).usage=ls.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);const h=V().getBool("WEBGL_PACK")?new bae(d):new wae(d),f=n.runWebGLProgram(h,[p],"int32");return n.disposeData(p.dataId),f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vae(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r,bias:i,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:h,leakyreluAlpha:f}=s,g=rr(c),y=Gt(a.shape,r.shape,l,d,u,p,!1,g);let m;const w=[],b=i!=null,x=o!=null,v=h==="leakyrelu",S=()=>{const $=[a,r],E=(A,L)=>{if(L==="NCHW"&&A.shape.length===1&&A.shape[0]!==1){const W=ie({inputs:{x:A},backend:n,attrs:{shape:[A.shape[0],1,1]}});return w.push(W),W}return A};if(b&&$.push(E(i,c)),x&&$.push(E(o,c)),v){const A=n.makeTensorInfo([],"float32",sr(f,"float32"));$.push(A),w.push(A)}return $};if(y.filterHeight===1&&y.filterWidth===1&&y.dilationHeight===1&&y.dilationWidth===1&&y.strideHeight===1&&y.strideWidth===1&&(y.padInfo.type==="SAME"||y.padInfo.type==="VALID"))m=L_({x:a,filter:r,convInfo:y,backend:n,bias:i,activation:h,preluActivationWeights:o,leakyreluAlpha:f});else if(y.strideWidth<=2&&g==="channelsLast"&&V().getBool("WEBGL_EXP_CONV")){const $=h?rd(h,!0):null,E=new P_(y,b,$,x,v),A=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],L=S();m=n.runWebGLProgram(E,L,"float32",A)}else if(V().getBool("WEBGL_CONV_IM2COL"))m=z_({x:a,filter:r,convInfo:y,backend:n,bias:i,activation:h,preluActivationWeights:o,leakyreluAlpha:f});else{const $=h?rd(h,!1):null,E=new j_(y,b,$,x,v),A=S();m=n.runWebGLProgram(E,A,"float32")}const N=ie({inputs:{x:m},backend:n,attrs:{shape:y.outShape}});return w.push(m),w.forEach($=>n.disposeIntermediateTensorInfo($)),N}const Sae={kernelName:Uc,backendName:"webgl",kernelFunc:vae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nae(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,filter:r,bias:i,preluActivationWeights:o}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:p,leakyreluAlpha:h}=s,f=[];let g=c;g==null&&(g=[1,1]),C(tn(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const y=Gt(a.shape,r.shape,l,g,u,d,!0),m=V().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels===1,w=p?rd(p,m):null,b=[a,r],x=i!=null,v=o!=null,S=p==="leakyrelu";if(x&&b.push(i),v&&b.push(o),S){const A=n.makeTensorInfo([],"float32",sr(h,"float32"));b.push(A),f.push(A)}let N;m?N=new V_(y,x,w,v,S):N=new M_(y,x,w,v,S);const $=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],E=n.runWebGLProgram(N,b,"float32",$);return f.forEach(A=>n.disposeIntermediateTensorInfo(A)),E}const Cae={kernelName:Gc,backendName:"webgl",kernelFunc:Nae};class Iae{constructor(e,n,s,a){this.sliceDim=e,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=s;const r=He(s.length);let i=`
    int index;`;for(let o=0;o<this.sliceDim;o++)i+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${r} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ae(t){const{inputs:e,backend:n}=t,{params:s,indices:a}=e,r=a.shape,i=r[r.length-1],o=H(s.shape),[l,u,c,d]=c0(s,a),p=ie({inputs:{x:a},backend:n,attrs:{shape:[u,i]}}),h=ie({inputs:{x:s},backend:n,attrs:{shape:[H(s.shape)/c,c]}});if(n.shouldExecuteOnCPU([s,a])||s.dtype==="string"){const m=n.readSync(a.dataId),w=n.bufferSync(s),b=RZ(m,w,s.dtype,u,i,c,d,s.shape,o);return n.makeTensorInfo(l,s.dtype,b.values)}const f=new Iae(i,d,[u,c],s.shape),g=n.runWebGLProgram(f,[h,p],h.dtype),y=ie({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),y}const Tae={kernelName:Wm,backendName:"webgl",kernelFunc:$ae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eae{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=He(this.rank),a=Aae(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${a}));
      }
    `}}function Aae(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let a=0;a<t.length;a++)a===2?s.push("index"):s.push(`${n[a]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,indices:r}=e,{axis:i,batchDims:o}=s,l=Ee(i,a.shape)[0];if(V().get("DEBUG")){const w=n.readSync(r.dataId),b=a.shape[l];for(let x=0;x<w.length;++x){const v=w[x];C(v<=b-1&&v>=0,()=>`GatherV2: the index value ${v} is not in [0, ${b-1}]`)}}const u=C1(a,r,l,o),c=H(r.shape),d=[],p=ie({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),h=ie({inputs:{x:r},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(p),d.push(h);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,r])||a.dtype==="string"){const w=n.bufferSync(h),b=n.bufferSync(p),x=DZ(b,w,f);return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(u.outputShape,x.dtype,x.values)}const g=new Eae(p.shape,f),y=n.runWebGLProgram(g,[p,h],p.dtype);d.push(y);const m=ie({inputs:{x:y},backend:n,attrs:{shape:u.outputShape}});return d.forEach(w=>n.disposeIntermediateTensorInfo(w)),m}const Rae={kernelName:Od,backendName:"webgl",kernelFunc:G_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dae="return float(a > b);",_ae=`
  return vec4(greaterThan(a, b));
`,Oae=an({opSnippet:Dae,packedOpSnippet:_ae,cpuKernelImpl:_Z,dtype:"bool"}),Fae={kernelName:Fd,backendName:"webgl",kernelFunc:Oae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jae="return float(a >= b);",Pae=`
  return vec4(greaterThanEqual(a, b));
`,Lae=an({opSnippet:jae,packedOpSnippet:Pae,dtype:"bool",cpuKernelImpl:OZ}),zae={kernelName:Xl,backendName:"webgl",kernelFunc:Lae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bae(t){const{inputs:e,backend:n}=t,{input:s}=e;return U_(s,!0,n)}const Mae={kernelName:Um,backendName:"webgl",kernelFunc:Bae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vae="return float(!isnan(x) && !isinf(x));",Wae=je({opSnippet:Vae,dtype:"bool"}),Uae={kernelName:Ql,backendName:"webgl",kernelFunc:Wae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gae="return float(isinf(x));",Hae=je({opSnippet:Gae,dtype:"bool"}),Kae={kernelName:Zl,backendName:"webgl",kernelFunc:Hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qae="return float(isnan(x));",Jae=je({opSnippet:qae,dtype:"bool"}),Xae={kernelName:eu,backendName:"webgl",kernelFunc:Jae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yae="return float(a < b);",Qae=`
  return vec4(lessThan(a, b));
`,Zae=an({opSnippet:Yae,packedOpSnippet:Qae,cpuKernelImpl:FZ,dtype:"bool"}),ere={kernelName:Pd,backendName:"webgl",kernelFunc:Zae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tre="return float(a <= b);",nre=`
  return vec4(lessThanEqual(a, b));
`,sre=an({opSnippet:tre,packedOpSnippet:nre,cpuKernelImpl:jZ,dtype:"bool"}),are={kernelName:Ld,backendName:"webgl",kernelFunc:sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rre(t){const{backend:e,attrs:n}=t,{start:s,stop:a,num:r}=n,i=PZ(s,a,r);return e.makeTensorInfo([i.length],"float32",i)}const ire={kernelName:Hm,backendName:"webgl",kernelFunc:rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ore=Bu+`
  return x < 0.0 ? 0./0. : log(x);
`,lre=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,ure=je({opSnippet:ore,packedOpSnippet:lre,cpuKernelImpl:LZ}),cre={kernelName:tu,backendName:"webgl",kernelFunc:ure};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dre=Bu+`
  return log(1.0 + x);
`,pre=je({opSnippet:dre}),hre={kernelName:nu,backendName:"webgl",kernelFunc:pre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fre="return float(a >= 1.0 && b >= 1.0);",mre=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,gre=an({opSnippet:fre,packedOpSnippet:mre,dtype:"bool"}),yre={kernelName:zd,backendName:"webgl",kernelFunc:gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wre="return float(!(x >= 1.0));",bre=je({opSnippet:wre}),xre={kernelName:Bd,backendName:"webgl",kernelFunc:bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kre="return float(a >= 1.0 || b >= 1.0);",vre=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Sre=an({opSnippet:kre,packedOpSnippet:vre,dtype:"bool"}),Nre={kernelName:Md,backendName:"webgl",kernelFunc:Sre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cre{constructor(e,n,s,a,r){this.variableNames=["x"],this.outputShape=[];const i=n,o=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${a}) * sum`;r===.5?l=`inversesqrt(${u})`:r===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ire{constructor(e,n,s,a,r){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,o=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${a}) * sum`;r===.5?l=`inversesqrt(${u})`:r===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${r}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $re=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{depthRadius:r,bias:i,alpha:o,beta:l}=s,u=V().getBool("WEBGL_PACK_NORMALIZATION")?new Ire(a.shape,r,i,o,l):new Cre(a.shape,r,i,o,l);return n.runWebGLProgram(u,[a],a.dtype)},Tre={kernelName:Vd,backendName:"webgl",kernelFunc:$re};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ere{constructor(e,n,s,a,r){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=a,this.beta=r,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${a}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${a})
                * float(${r})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${r});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Are=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a,y:r,dy:i}=e,{depthRadius:o,bias:l,alpha:u,beta:c}=s,d=new Ere(a.shape,o,l,u,c);return n.runWebGLProgram(d,[a,r,i],a.dtype)},Rre={kernelName:Km,backendName:"webgl",kernelFunc:Are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(t,e,n,s){const a=H(e),i=H(t.shape)/a,o=ie({inputs:{x:t},attrs:{shape:[i,a]},backend:s}),l=Eo(o,t.dtype,"max",s),u=ie({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{reductionIndices:r,keepDims:i}=s,o=a.shape.length,l=Ee(r,a.shape);let u=l;const c=ht(u,o),d=c!=null,p=n.shouldExecuteOnCPU([a]);let h=a;if(d){if(p){const b=n.texData.get(h.dataId).values,x=new Array(o);for(let N=0;N<x.length;N++)x[N]=a.shape[c[N]];const v=cv(b,a.shape,a.dtype,c,x);h=n.makeTensorInfo(x,a.dtype);const S=n.texData.get(h.dataId);S.values=v}else h=E0(a,c,n);u=vt(u.length,o)}nn("max",u,o);const[f,g]=Ht(h.shape,u);let y=f;i&&(y=kt(f,l));let m;if(p){const b=n.texData.get(h.dataId).values,x=zZ(b,H(g),y,a.dtype);m=n.makeTensorInfo(y,a.dtype);const v=n.texData.get(m.dataId);v.values=x}else m=Dre(h,g,y,n);return d&&n.disposeIntermediateTensorInfo(h),m}const _re={kernelName:Wd,backendName:"webgl",kernelFunc:H_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ore=dv+`
  return max(a, b);
`,Fre=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+To+`
  return result;
`,jre=an({opSnippet:Ore,packedOpSnippet:Fre,cpuKernelImpl:BZ}),Pre={kernelName:su,backendName:"webgl",kernelFunc:jre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lre(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;Xp(a,"maxPool");const{filterSize:r,strides:i,pad:o,dimRoundingMode:l}=s,u=1;C(tn(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Fs(a.shape,r,i,u,o,l);if(c.filterWidth===1&&c.filterHeight===1&&Re(c.inShape,c.outShape))return Zn({inputs:{x:a},backend:n});const d=new id(c,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}const zre={kernelName:Ud,backendName:"webgl",kernelFunc:Lre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bre(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{filterSize:r,strides:i,pad:o,dataFormat:l,dimRoundingMode:u}=s,c=[1,1,1],d=ar(a.shape,r,i,c,o,u,l),p=new hv(d,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}const Mre={kernelName:Gd,backendName:"webgl",kernelFunc:Bre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vre{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,a=e.dilationHeight,r=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=r-1-e.padInfo.top,l=i-1-e.padInfo.left,u=r*i-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${r};
          wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class Wre{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,a=e.strideWidth,r=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,p=u-1-e.padInfo.top,h=c-1-e.padInfo.left,f=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${p}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${r}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${f} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ure(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r}=e,i=r,{filterSize:o,strides:l,pad:u,dimRoundingMode:c}=s,d=[1,1,1],p=ar(i.shape,o,l,d,u,c),h=new hv(p,"max",!0),f=n.runWebGLProgram(h,[i],i.dtype),g=new Wre(p),y=n.runWebGLProgram(g,[a,f],i.dtype);return n.disposeIntermediateTensorInfo(f),y}const Gre={kernelName:Jm,backendName:"webgl",kernelFunc:Ure};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hre(t){const{inputs:e,backend:n,attrs:s}=t,{dy:a,input:r,output:i}=e,o=r;Xp([r,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=s,p=Fs(o.shape,l,u,1,c,d),h=!0,f=new id(p,"max",h),g=n.runWebGLProgram(f,[o],o.dtype),y=new Vre(p),m=n.runWebGLProgram(y,[a,g],o.dtype);return n.disposeIntermediateTensorInfo(g),m}const Kre={kernelName:qm,backendName:"webgl",kernelFunc:Hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qre(t,e,n,s){let a=new id(n,"max",!1);const r=s.runWebGLProgram(a,[t],"float32");a=new id(n,"max",!0,!0,e);const i=s.runWebGLProgram(a,[t],"float32");return[r,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jre={kernelName:Xm,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:a,strides:r,pad:i,includeBatchInIndex:o}=e,l=n;C(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];C(tn(r,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${r} and dilations '${u}'`);const c=Fs(s.shape,a,r,u,i),[d,p]=qre(s,o,c,l);return[d,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(t,e,n,s){const a=H(e),i=H(t.shape)/a,o=ie({inputs:{x:t},attrs:{shape:[i,a]},backend:s}),l=Eo(o,"float32","mean",s),u=ie({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(o),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yre={kernelName:Hd,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:a,axis:r}=e,i=n,o=s.shape.length,l=Ee(r,s.shape);let u=l;const c=ht(u,o),d=c!=null,p=i.shouldExecuteOnCPU([s]),h=[];let f=s;if(d){if(p){const x=i.texData.get(f.dataId).values,v=new Array(o);for(let $=0;$<v.length;$++)v[$]=s.shape[c[$]];const S=cv(x,s.shape,s.dtype,c,v);f=i.makeTensorInfo(v,s.dtype);const N=i.texData.get(f.dataId);N.values=S}else f=E0(s,c,i);h.push(f),u=vt(u.length,o)}nn("sum",u,o);const[g,y]=Ht(f.shape,u);let m=g;a&&(m=kt(g,l));const w=Xre(f,y,m,i);for(const b of h)i.disposeIntermediateTensorInfo(b);return w}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qre(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=a.shape.length,l=Ee(r,a.shape);let u=l;const c=ht(u,o);let d=a;c!=null&&(d=vn({inputs:{x:a},backend:n,attrs:{perm:c}}),u=vt(u.length,a.shape.length)),nn("min",u,o);const[p,h]=Ht(d.shape,u),f=H(h),g=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}}),y=Eo(g,g.dtype,"min",n);let m;if(i){const w=kt(p,l);m=ie({inputs:{x:y},backend:n,attrs:{shape:w}})}else m=ie({inputs:{x:y},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),c!=null&&n.disposeIntermediateTensorInfo(d),m}const Zre={kernelName:Kd,backendName:"webgl",kernelFunc:Qre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eie=dv+`
  return min(a, b);
`,tie=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+To+`
  return result;
`,nie=an({opSnippet:eie,packedOpSnippet:tie,cpuKernelImpl:MZ}),sie={kernelName:au,backendName:"webgl",kernelFunc:nie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aie{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const a=e.length,r=He(a),i=n.map(c=>c[0]).join(","),o=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),u=s==="reflect"?0:1;if(a===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${i});
      ${r} end = ${r}(${o});

      void main() {
        ${r} outC = getOutputCoords();
        for (int i = 0; i < ${a}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${r} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rie{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((f,g)=>f[0]+e[g]+f[1]);const a=e.length,r=He(a),i=n.map(f=>f[0]).join(","),o=n.map((f,g)=>f[0]+e[g]).join(","),l=xn("rc",a),u=xn("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,p=s==="reflect"?0:1;let h="";if(a===1){const f=`
        ${r} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;h=`
        ${r} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const f=`
        ${r} source = rc;
        ${r} lt = ${r}(lessThan(source, start));
        ${r} gte = ${r}(greaterThanEqual(source, end));
        ${r} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;h=`
        ${r} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[a-2]} += 1;
        if(${l[a-2]} < ${this.outputShape[a-2]}) {
          ${f}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[a-1]} += 1;
          if(${c}) {
            ${f}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${r} start = ${r}(${i});
      const ${r} end = ${r}(${o});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iie=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:a,mode:r}=n,i=V().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rie(s.shape,a,r):new aie(s.shape,a,r);return e.runWebGLProgram(i,[s],s.dtype)},oie={kernelName:qd,backendName:"webgl",kernelFunc:iie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lie=`if (b == 0.0) return NAN;
  return mod(a, b);`,uie=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+To+`
  return result;
`,cie=an({opSnippet:lie,packedOpSnippet:uie}),die={kernelName:ru,backendName:"webgl",kernelFunc:cie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pie{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hie=`
if (a == b) {
  return 1.0;
};
return a / b;`,fie=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,K_=an({opSnippet:hie,packedOpSnippet:fie,checkOutOfBounds:!0}),mie={kernelName:Wl,backendName:"webgl",kernelFunc:K_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yN="return a - b;",q_=an({opSnippet:yN,packedOpSnippet:yN,supportsComplex:!0,cpuKernelImpl:lee}),gie={kernelName:ku,backendName:"webgl",kernelFunc:q_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_(t){const{inputs:e,backend:n,attrs:s}=t,{logits:a}=e,{dim:r}=s,i=Ee([r],a.shape),o=H_({inputs:{x:a},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=kt(o.shape,i),u=ie({inputs:{x:o},backend:n,attrs:{shape:l}}),c=q_({inputs:{a,b:u},backend:n}),d=W_({inputs:{x:c},backend:n}),p=A0({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),h=ie({inputs:{x:p},backend:n,attrs:{shape:l}}),f=K_({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),f}const yie={kernelName:pp,backendName:"webgl",kernelFunc:J_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wie(t){const{inputs:e,backend:n,attrs:s}=t,{logits:a}=e,{numSamples:r,seed:i,normalized:o}=s,l=o?a:J_({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new pie(u,c,r),p=[[i]],h=n.runWebGLProgram(d,[l],"int32",p);return o||n.disposeIntermediateTensorInfo(l),h}const bie={kernelName:Ym,backendName:"webgl",kernelFunc:wie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xie=Ps+`
  return -x;
`,kie=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function vie(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const r=n.texData.get(s.dataId),[i,o]=WZ(r.values,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,i)}let a;return V().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new Ir(s.shape,kie):a=new ya(s.shape,xie),n.runWebGLProgram(a,[s],s.dtype)}const Sie={kernelName:Jd,backendName:"webgl",kernelFunc:vie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nie=i0;function Cie(t){as("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l}=s,u=n.readSync(a.dataId),c=n.readSync(r.dataId),{selectedIndices:d}=Nie(u,c,i,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Iie={kernelName:Qm,backendName:"webgl",kernelFunc:Cie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ie=o0;function Tie(t){as("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:u}=s,c=n.readSync(a.dataId),d=n.readSync(r.dataId),{selectedIndices:p,validOutputs:h}=$ie(c,d,i,o,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const Eie={kernelName:Zm,backendName:"webgl",kernelFunc:Tie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aie=l0;function Rie(t){as("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:a,scores:r}=e,{maxOutputSize:i,iouThreshold:o,scoreThreshold:l,softNmsSigma:u}=s,c=n.readSync(a.dataId),d=n.readSync(r.dataId),p=i,h=o,f=l,g=u,{selectedIndices:y,selectedScores:m}=Aie(c,d,p,h,f,g);return[n.makeTensorInfo([y.length],"int32",new Int32Array(y)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}const Die={kernelName:eg,backendName:"webgl",kernelFunc:Rie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ie{constructor(e,n,s,a){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${a}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oie=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:a}=e,{dtype:r,depth:i,onValue:o,offValue:l}=s,u=H(a.shape),c=new _ie(u,i,o,l),d=ie({inputs:{x:a},backend:n,attrs:{shape:[u]}}),p=n.runWebGLProgram(c,[d],r);n.disposeIntermediateTensorInfo(d);const h=[...a.shape,i],f=ie({inputs:{x:p},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(p),f},Fie={kernelName:Qd,backendName:"webgl",kernelFunc:Oie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qf(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const a=Qp({inputs:{input:s},backend:n}),r=Qf({inputs:{x:a},backend:n}),i=R0({inputs:{input:s},backend:n}),o=Qf({inputs:{x:i},backend:n}),l=mi({inputs:{real:r,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return Zp({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const jie={kernelName:gp,backendName:"webgl",kernelFunc:Qf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const a=Qp({inputs:{input:s},backend:n}),r=X_({inputs:{x:a},backend:n}),i=R0({inputs:{input:s},backend:n}),o=Qf({inputs:{x:i},backend:n}),l=mi({inputs:{real:r,imag:o},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),l}else return Zp({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const Pie={kernelName:Yd,backendName:"webgl",kernelFunc:X_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lie(t){const{inputs:e,backend:n,attrs:s}=t,{axis:a}=s;if(e.length===1)return yb({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const r=e[0].shape,i=e[0].dtype;e.forEach(c=>{en(r,c.shape,"All tensors passed to stack must have matching shapes"),C(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(c=>{const d=yb({inputs:{input:c},backend:n,attrs:{dim:a}});return o.push(d),d}),u=F_({inputs:l,backend:n,attrs:{axis:a}});return o.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const zie={kernelName:Zd,backendName:"webgl",kernelFunc:Lie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bie{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const a=e.length,r=He(a),i=n.map(u=>u[0]).join(","),o=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);if(a===1){this.userCode=`
        int start = ${i};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${r} start = ${r}(${i});
      ${r} end = ${r}(${o});

      void main() {
        ${r} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${r} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mie{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,y)=>g[0]+e[y]+g[1]);const a=e.length,r=He(a),i=n.map(g=>g[0]).join(","),o=n.map((g,y)=>g[0]+e[y]).join(","),l=xn("rc",a),u=xn("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,p=[`${r} rc = outputLoc;`,`${l[a-1]} += 1;
       if(${c}) {
      `,a===1?"":`}
       rc = outputLoc;
       ${l[a-2]} += 1;
       if(${l[a-2]} < ${this.outputShape[a-2]}) {`,a===1?"":`  ${l[a-1]} += 1;
         if(${c}) {`],h=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let g=0,y=a===1?2:4;g<y;g++)f+=`
        ${p[g]}
        if (${h}) {
          result[${g}] = float(value);
        } else {
          ${r} source = rc - start;
          result[${g}] = getChannel(getX(${u.join()}), ${d});
        }
      `;f+=a===1?"} ":"}}",this.userCode=`
      const ${r} start = ${r}(${i});
      const ${r} end = ${r}(${o});

      void main() {
        ${r} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y_=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{paddings:r,constantValue:i}=s;if(H(a.shape)===0){const u=r.map((c,d)=>c[0]+a.shape[d]+c[1]);return Zp({backend:n,attrs:{shape:u,value:i,dtype:a.dtype}})}const o=V().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Mie(a.shape,r,i):new Bie(a.shape,r,i),l=[[i]];return n.runWebGLProgram(o,[a],a.dtype,l)},Vie={kernelName:ep,backendName:"webgl",kernelFunc:Y_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wie=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Uie=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+To+`
  return result;
`,Gie=an({opSnippet:Wie,packedOpSnippet:Uie}),Hie={kernelName:ou,backendName:"webgl",kernelFunc:Gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kie(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{axis:r,keepDims:i}=s,o=a.shape.length,l=[],u=Ee(r,a.shape);let c=u;const d=ht(c,o);let p=a;d!=null&&(p=vn({inputs:{x:a},backend:n,attrs:{perm:d}}),c=vt(c.length,o),l.push(p)),nn("prod",c,o);let h;if(n.shouldExecuteOnCPU([p])){const f=n.texData.get(p.dataId).values,{outVals:g,outShape:y,outDtype:m}=GZ(p.shape,p.dtype,f,c);h=n.makeTensorInfo(y,m,g)}else{const[f,g]=Ht(p.shape,c),y=H(g),m=ie({inputs:{x:p},backend:n,attrs:{shape:[-1,y]}}),w=Ig(a.dtype),b=Eo(m,w,"prod",n);h=ie({inputs:{x:b},backend:n,attrs:{shape:f}}),l.push(m),l.push(b)}if(i){l.push(h);const f=kt(h.shape,u);h=ie({inputs:{x:h},backend:n,attrs:{shape:f}})}return l.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}const qie={kernelName:np,backendName:"webgl",kernelFunc:Kie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jie(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:a,paramsDenseValues:r,indices:i}=e,{outputRaggedRank:o}=s,l=a.map(m=>n.readSync(m.dataId)),u=a.map(m=>m.shape),c=n.readSync(r.dataId),d=n.readSync(i.dataId),[p,h,f]=HZ(l,u,c,r.shape,r.dtype,d,i.shape,o),g=p.map(m=>n.makeTensorInfo([m.length],"int32",m)),y=n.makeTensorInfo(f,r.dtype,h);return g.concat([y])}const Xie={kernelName:tg,backendName:"webgl",kernelFunc:Jie};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yie(t){const{inputs:e,backend:n}=t,{starts:s,limits:a,deltas:r}=e,i=n.readSync(s.dataId),o=n.readSync(a.dataId),l=n.readSync(r.dataId),[u,c]=KZ(i,s.shape,s.dtype,o,a.shape,l,r.shape),d=n.makeTensorInfo([u.length],"int32",u),p=n.makeTensorInfo([c.length],s.dtype,c);return[d,p]}const Qie={kernelName:ng,backendName:"webgl",kernelFunc:Yie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zie(t){const{inputs:e,backend:n,attrs:s}=t,{shape:a,values:r,defaultValue:i,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=s,u=n.readSync(a.dataId),c=n.readSync(r.dataId),d=n.readSync(i.dataId),p=o.map(y=>n.readSync(y.dataId)),h=o.map(y=>y.shape),[f,g]=qZ(u,a.shape,c,r.shape,r.dtype,d,i.shape,p,h,l);return n.makeTensorInfo(f,r.dtype,g)}const eoe={kernelName:sg,backendName:"webgl",kernelFunc:Zie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q_=t=>{const{backend:e,attrs:n}=t,{start:s,stop:a,step:r,dtype:i}=n,o=JZ(s,a,r,i);return e.makeTensorInfo([o.length],i,o)},toe={kernelName:ag,backendName:"webgl",kernelFunc:Q_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const noe="return 1.0 / x;",soe=je({opSnippet:noe}),aoe={kernelName:lu,backendName:"webgl",kernelFunc:soe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const roe=Ps+`
  return (x < 0.0) ? 0.0 : x;
`,ioe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ooe=je({opSnippet:roe,packedOpSnippet:ioe}),loe={kernelName:uu,backendName:"webgl",kernelFunc:ooe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uoe=Ps+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,coe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,doe=je({opSnippet:uoe,packedOpSnippet:coe}),poe={kernelName:cu,backendName:"webgl",kernelFunc:doe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hoe{constructor(e,n,s,a,r){this.variableNames=["A"],this.outputShape=[];const[i,o,l,u]=e;this.outputShape=[i,n,s,u];const c=[a&&n>1?o-1:o,a&&s>1?l-1:l],d=[a&&n>1?n-1:n,a&&s>1?s-1:s];let p;r?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class foe{constructor(e,n,s,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,u]=e;this.outputShape=[i,n,s,u];const c=[a&&n>1?o-1:o,a&&s>1?l-1:l],d=[a&&n>1?n-1:n,a&&s>1?s-1:s];let p;r?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function moe(t){const{inputs:e,backend:n,attrs:s}=t,{images:a}=e,{alignCorners:r,halfPixelCenters:i,size:o}=s,[l,u]=o,c=V().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new foe(a.shape,l,u,r,i):new hoe(a.shape,l,u,r,i);return n.runWebGLProgram(c,[a],"float32")}const goe={kernelName:rp,backendName:"webgl",kernelFunc:moe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yoe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,r]=n,[,i,o]=e,l=[s&&i>1?a-1:a,s&&o>1?r-1:r],u=[s&&i>1?i-1:i,s&&o>1?o-1:o],c=l[0]/u[0],d=l[1]/u[1],p=1/c,h=1/d,f=Math.ceil(p)*2+2,g=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${h});

        const int winHeight = int(${f});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${a-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${r-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(t){const{inputs:e,backend:n,attrs:s}=t,{images:a,dy:r}=e,{alignCorners:i}=s,o=new yoe(r.shape,a.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const boe={kernelName:og,backendName:"webgl",kernelFunc:woe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xoe{constructor(e,n,s,a,r){this.variableNames=["A"],this.outputShape=[];const[i,o,l,u]=e;this.outputShape=[i,n,s,u];const c=[a&&n>1?o-1:o,a&&s>1?l-1:l],d=[a&&n>1?n-1:n,a&&s>1?s-1:s],p=a?"0.5":"0.0";let h;r?h="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class koe{constructor(e,n,s,a,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,l,u]=e;this.outputShape=[i,n,s,u];const c=[a&&n>1?o-1:o,a&&s>1?l-1:l],d=[a&&n>1?n-1:n,a&&s>1?s-1:s],p=a?"0.5":"0.0";let h;r?h="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function voe(t){const{inputs:e,backend:n,attrs:s}=t,{images:a}=e,{alignCorners:r,halfPixelCenters:i,size:o}=s,[l,u]=o,c=V().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new koe(a.shape,l,u,r,i):new xoe(a.shape,l,u,r,i);return n.runWebGLProgram(c,[a],a.dtype)}const Soe={kernelName:ap,backendName:"webgl",kernelFunc:voe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Noe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,r]=n,[,i,o]=e,l=[s&&i>1?a-1:a,s&&o>1?r-1:r],u=[s&&i>1?i-1:i,s&&o>1?o-1:o],c=l[0]/u[0],d=l[1]/u[1],p=1/c,h=1/d,f=Math.ceil(p)*2+2,g=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${h});

        const int winHeight = int(${f});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Coe(t){const{inputs:e,backend:n,attrs:s}=t,{images:a,dy:r}=e,{alignCorners:i}=s,o=new Noe(r.shape,a.shape,i);return n.runWebGLProgram(o,[r],r.dtype)}const Ioe={kernelName:ig,backendName:"webgl",kernelFunc:Coe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $oe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const a=o=>n.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,r=e.map((o,l)=>a(l)).join(","),i=He(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${r}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Toe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const a=xn("rc",s),r=`${a[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${a[s-2]} + 1 < ${this.outputShape[s-2]}`,o=He(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${r}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(a.slice())};
          if(${r}){
            result.g = ${u(a.slice())};
          }
          if(${i}) {
            result.b = ${c(a.slice())};
            if(${r}) {
              result.a = ${d(a.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(f){return p(f)}function u(f){return f[s-1]="("+f[s-1]+" + 1)",p(f)}function c(f){return f[s-2]="("+f[s-2]+" + 1)",p(f)}function d(f){return f[s-1]="("+f[s-1]+" + 1)",f[s-2]="("+f[s-2]+" + 1)",p(f)}function p(f){const g=e.map((w,b)=>h(b,f)),y=g.join(","),m=g.slice(-2).join(",");return`getChannel(getX(${y}), vec2(${m}))`}function h(f,g){return n.indexOf(f)!==-1&&e[f]!==1?`${e[f]} - ${g[f]} - 1`:`${g[f]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{dims:r}=s,i=a.shape.length,o=Ee(r,a.shape);if(i===0)return Zn({inputs:{x:a},backend:n});const l=V().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Toe(a.shape,o):new $oe(a.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}const Aoe={kernelName:ip,backendName:"webgl",kernelFunc:Eoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Roe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],a=e[2];this.outputShape=e;let r="";typeof n=="number"?r=`float outputValue = ${n.toFixed(2)};`:r=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${r}
          if(coordX >= 0 && coordX < ${a} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Doe={kernelName:Ng,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:a,fillValue:r,center:i}=e,o=n,l=new Roe(s.shape,r),[u,c]=u1(i,s.shape[1],s.shape[2]),d=[[u,c,Math.sin(a),Math.cos(a)]];return o.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _oe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Ooe=je({opSnippet:_oe}),Foe={kernelName:du,backendName:"webgl",kernelFunc:Ooe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const joe="return inversesqrt(x);",Poe=je({opSnippet:joe,cpuKernelImpl:XZ}),Loe={kernelName:pu,backendName:"webgl",kernelFunc:Poe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fv{constructor(e,n,s,a,r,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=He(r.length),c=He(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const p=`getIndices(${d})`;let h="";a===1?h="i":a===2&&(h="i, coords[1]");const f=`getUpdates(${h})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,m=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${r});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${m};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(${y}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zoe{constructor(e,n,s,a,r,i,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=He(r.length),c=He(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const p=`getIndices(${d})`;let h="";a===1?h="i":a===2&&(h="i, coords[1]");const f=`getUpdates(${h})`;let g="";l&&(g="coords[0], coords[1]");const y=`getDefaultValue(${g})`,m=n>1?"strides[j]":"strides",w=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${r});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${p});
              flattenedIndex += index.xz * ${m};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${w};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${f};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${y}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Boe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:a,updates:r}=e,{shape:i}=s,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=pi(r,a,i),p=[d/u,u];if(d===0)return n.makeTensorInfo(i,a.dtype);const h=ie({inputs:{x:a},backend:n,attrs:{shape:[l,o]}}),f=ie({inputs:{x:r},backend:n,attrs:{shape:[l,u]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let y;V().getBool("WEBGL_PACK")?y=new zoe(l,o,h.shape.length,f.shape.length,c,p):y=new fv(l,o,h.shape.length,f.shape.length,c,p);const m=n.runWebGLProgram(y,[f,h,g],f.dtype),w=ie({inputs:{x:m},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),w}const Moe={kernelName:lg,backendName:"webgl",kernelFunc:Boe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Voe{constructor(e,n,s,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const r="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,o=V().getNumber("WEBGL_VERSION")===2?r:i,l=a==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Woe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:a,values:r}=e,{side:i}=s,o=new Voe(a.shape[0],a.shape[1],r.shape[1],i),l=[[a.shape[1]]];return n.runWebGLProgram(o,[a,r],"int32",l)}const Uoe={kernelName:cg,backendName:"webgl",kernelFunc:Woe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Goe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let a,r;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)r="resRC",a="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${o[c]}`),c<e&&l.push(`${o[c]}`);a=l.join(),r=u.join()}const i=He(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${a});
        if (cVal >= 1.0) {
          setOutput(getA(${r}));
        } else {
          setOutput(getB(${r}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hoe(t){const{inputs:e,backend:n}=t,{condition:s,t:a,e:r}=e,i=new Goe(s.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(i,[s,a,r],Rn(a.dtype,r.dtype))}const Koe={kernelName:op,backendName:"webgl",kernelFunc:Hoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qoe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${h0};
  float scale = ${f0};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Joe=je({opSnippet:qoe}),Xoe={kernelName:hu,backendName:"webgl",kernelFunc:Joe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe=Bu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,Qoe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Zoe=je({opSnippet:Yoe,packedOpSnippet:Qoe,cpuKernelImpl:QZ}),ele={kernelName:yu,backendName:"webgl",kernelFunc:Zoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tle=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,nle=je({opSnippet:tle}),sle={kernelName:gu,backendName:"webgl",kernelFunc:nle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ale=Bu+`
  return sin(x);
`,rle=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${To}
  return result;
`,ile=je({opSnippet:ale,packedOpSnippet:rle}),ole={kernelName:fu,backendName:"webgl",kernelFunc:ile};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lle=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,ule=je({opSnippet:lle}),cle={kernelName:mu,backendName:"webgl",kernelFunc:ule};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dle=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,ple=je({opSnippet:dle}),hle={kernelName:wu,backendName:"webgl",kernelFunc:ple};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fle=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{blockShape:r,paddings:i}=s;C(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=r.reduce((m,w)=>m*w),l=[[0,0]];l.push(...i);for(let m=1+r.length;m<a.shape.length;++m)l.push([0,0]);const u=[],c=Y_({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=Pp(c.shape,r,o,!1),p=Lp(d.length,r.length,!1),h=zp(c.shape,r,o,!1),f=ie({inputs:{x:c},backend:n,attrs:{shape:d}}),g=vn({inputs:{x:f},backend:n,attrs:{perm:p}}),y=ie({inputs:{x:g},backend:n,attrs:{shape:h}});return u.push(c),u.push(f),u.push(g),u.forEach(m=>n.disposeIntermediateTensorInfo(m)),y},mle={kernelName:cp,backendName:"webgl",kernelFunc:fle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gle(t){const{inputs:e,backend:n}=t,{indices:s,values:a,denseShape:r,defaultValue:i}=e;if(r.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${r.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${a.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const o=n.readSync(s.dataId),l=n.readSync(a.dataId),u=n.readSync(r.dataId),c=n.readSync(i.dataId)[0],[d,p,h,f,g]=eee(o,s.shape,s.dtype,l,a.dtype,u,c);return[n.makeTensorInfo(p,s.dtype,d),n.makeTensorInfo([p[0]],a.dtype,h),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(y=>Number(y)))),n.makeTensorInfo([g.length],s.dtype,new Int32Array(g))]}const yle={kernelName:dg,backendName:"webgl",kernelFunc:gle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wle(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:a,newShape:r}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(r.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${r.shape}`);const i=Array.from(n.readSync(a.dataId)),o=n.readSync(s.dataId),l=Array.from(n.readSync(r.dataId)),[u,c,d]=tee(o,s.shape,s.dtype,i,l);return[n.makeTensorInfo(c,s.dtype,u),n.makeTensorInfo([d.length],r.dtype,new Int32Array(d))]}const ble={kernelName:pg,backendName:"webgl",kernelFunc:wle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xle(t){const{inputs:e,backend:n}=t,{data:s,indices:a,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${a.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${r.shape}`);const i=n.readSync(s.dataId),o=n.readSync(a.dataId),l=n.readSync(r.dataId),[u,c]=v_(i,s.shape,s.dtype,o,l,!0);return n.makeTensorInfo(c,s.dtype,u)}const kle={kernelName:hg,backendName:"webgl",kernelFunc:xle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vle(t){const{inputs:e,backend:n}=t,{data:s,indices:a,segmentIds:r}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${a.shape}`);if(r.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${r.shape}`);const i=n.readSync(s.dataId),o=n.readSync(a.dataId),l=n.readSync(r.dataId),[u,c]=v_(i,s.shape,s.dtype,o,l);return n.makeTensorInfo(c,s.dtype,u)}const Sle={kernelName:fg,backendName:"webgl",kernelFunc:vle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nle(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:a,sparseValues:r,defaultValue:i}=e,{outputShape:o}=s,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=pi(r,a,o),h=!1;if(r.dtype==="string"){const m=n.bufferSync(a),w=n.bufferSync(r),b=Xa(n.readSync(i.dataId)[0]),x=YZ(m,w,o,p,c,u,l,d,b,h);return n.makeTensorInfo(o,x.dtype,x.values)}const f=new fv(u,l,a.shape.length,r.shape.length,d,[p,1],h),g=n.runWebGLProgram(f,[r,a,i],r.dtype),y=ie({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(g),y}const Cle={kernelName:mg,backendName:"webgl",kernelFunc:Nle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ile(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{numOrSizeSplits:r,axis:i}=s,o=Ee(i,a.shape)[0],l=N1(a,r,o),u=a.shape.length,c=new Array(u).fill(0),d=a.shape.slice();return l.map(p=>{const h=[...d];h[o]=p;const f=Mu({inputs:{x:a},backend:n,attrs:{begin:c,size:h}});return c[o]+=p,f})}const $le={kernelName:dp,backendName:"webgl",kernelFunc:Ile};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wN="return sqrt(x);",Tle=je({opSnippet:wN,packedOpSnippet:wN,cpuKernelImpl:nee}),Ele={kernelName:bu,backendName:"webgl",kernelFunc:Tle};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ale="return x * x;",Rle=je({opSnippet:Ale}),Dle={kernelName:gg,backendName:"webgl",kernelFunc:Rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bN="return (a - b) * (a - b);",_le=an({opSnippet:bN,packedOpSnippet:bN}),Ole={kernelName:xu,backendName:"webgl",kernelFunc:_le};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");const r=n.readSync(a.dataId),i=er(r),o=see(i,"string",s);return n.makeTensorInfo(a.shape,"string",o)}const jle={kernelName:hp,backendName:"webgl",kernelFunc:Fle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ple({inputs:t,attrs:e,backend:n}){const{x:s}=t,a=Ps+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,r=new ya(s.shape,a);return n.runWebGLProgram(r,[s],s.dtype)}const Lle={kernelName:Cu,backendName:"webgl",kernelFunc:Ple};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zle{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const a=s.length,r=He(s.length),i=He(s.length);let o="";if(a===1)o="coords * strides + begin";else{let l=0;o=s.map((u,c)=>(l++,s.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${r} begin = ${r}(${e});
      ${r} strides = ${r}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ble(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{begin:r,end:i,strides:o,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=s,{finalShapeSparse:h,finalShape:f,isIdentity:g,sliceDim0:y,isSimpleSlice:m,begin:w,end:b,strides:x}=r1(a.shape,r,i,o,l,u,c,d,p);let v;if(g)v=ie({inputs:{x:a},backend:n,attrs:{shape:f}});else if(y||m){C(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const N=n1(w,b,x),$=Mu({inputs:{x:a},backend:n,attrs:{begin:w,size:N}});v=ie({inputs:{x:$},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo($)}else if(n.shouldExecuteOnCPU([a])){const $=n.readSync(a.dataId),E=Se(a.shape,a.dtype,$),A=aee(h,E,x,w);v=n.makeTensorInfo(f,a.dtype,A.values)}else{const $=new zle(w,x,h);v=n.runWebGLProgram($,[a],a.dtype)}const S=ie({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(v),S}const Mle={kernelName:yg,backendName:"webgl",kernelFunc:Ble};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vle(t){const{inputs:e,backend:n,attrs:s}=t,{separator:a,nGramWidths:r,leftPad:i,rightPad:o,padWidth:l,preserveShortSequences:u}=s,{data:c,dataSplits:d}=e,p=n.readSync(c.dataId),h=n.readSync(d.dataId),[f,g]=ree(p,h,a,r,i,o,l,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",g)]}const Wle={kernelName:wg,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ule(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:a}=s,{input:r,delimiter:i}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(r.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${r.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const o=n.readSync(r.dataId),l=n.readSync(i.dataId)[0],[u,c,d]=iee(o,l,a),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Gle={kernelName:bg,backendName:"webgl",kernelFunc:Ule};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hle(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:a}=s,{input:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(r.dataId),o=oee(i,a);return n.makeTensorInfo(r.shape,"int32",o)}const Kle={kernelName:xg,backendName:"webgl",kernelFunc:Hle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qle="return tan(x);",Jle=je({opSnippet:qle}),Xle={kernelName:vu,backendName:"webgl",kernelFunc:Jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yle=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Qle=je({opSnippet:Yle}),Zle={kernelName:Su,backendName:"webgl",kernelFunc:Qle};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:a,indices:r,updates:i}=e,{sliceRank:o,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=pi(i,r,a.shape),p=[d/u,u];if(d===0)return n.makeTensorInfo(a.shape,r.dtype);const h=ie({inputs:{x:r},backend:n,attrs:{shape:[l,o]}}),f=ie({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),g=ie({inputs:{x:a},backend:n,attrs:{shape:p}}),y=new fv(l,o,h.shape.length,f.shape.length,c,p,!1,!0),m=n.runWebGLProgram(y,[f,h,g],g.dtype),w=ie({inputs:{x:m},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),w}const tue={kernelName:ug,backendName:"webgl",kernelFunc:eue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nue{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*n[i];this.outputShape=s,this.rank=s.length;const a=He(this.rank),r=sue(e);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        setOutput(getA(${r}));
      }
    `}}function sue(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let a=0;a<t.length;a++)s.push(`imod(${n[a]}, ${t[a]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{reps:r}=s;if(a.dtype==="string"||a.shape.length>5){const l=n.readSync(a.dataId),u=a.dtype==="string"?l.map(p=>Xa(p)):l,c=Se(a.shape,a.dtype,u),d=uee(c,r);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new nue(a.shape,r);return n.runWebGLProgram(i,[a],a.dtype)}const aue={kernelName:Nu,backendName:"webgl",kernelFunc:Z_};class rue{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class iue{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bi(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function xN(t){let e=1;for(;e<t;)e*=2;return e}function oue(t){const{inputs:e,backend:n,attrs:s}=t,{x:a}=e,{k:r,sorted:i}=s,o=V().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=V().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=a.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([a])||c<o||r>l){const A=n.readSync(a.dataId),[L,W]=cee(A,u,a.dtype,r,i);return[n.makeTensorInfo(L.shape,L.dtype,L.values),n.makeTensorInfo(W.shape,W.dtype,W.values)]}if(r===0)return u[u.length-1]=0,[n.makeTensorInfo(u,a.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[a,Zp({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(a.dataId),p=d!==null&&d.isPacked,h=p?n.unpackTensor(a):a,g=H(u)/c,y=ie({inputs:{x:h},attrs:{shape:[g,c]},backend:n});p&&bi(n,h);const m=xN(r),w=xN(c);let b=null;const x=()=>b===null?[y,y]:[y,b],v=(A,L,W)=>{const U=x(),j=new rue(W),G=[[c],[b===null?1:0],[Number.NEGATIVE_INFINITY],[A],[L]],J=b;b=n.runWebGLProgram(j,U,"int32",G),bi(n,J)};for(let A=1;A<m;A*=2){const L=A*2;for(let W=A;W>=1;W/=2)v(L,W,[g,w])}for(let A=w;A>m;A/=2){const L=x(),W=new iue([g,A/2]),j=[[c],[b===null?1:0],[m]],z=b;b=n.runWebGLProgram(W,L,"int32",j),bi(n,z);const G=m/2,J=G*2;for(let O=G;O>=1;O/=2)v(J,O,b.shape)}let S=b;b=Mu({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,r]}}),bi(n,S);let N=G_({inputs:{x:y,indices:b},backend:n,attrs:{axis:1,batchDims:1}});bi(n,y);const $=u.slice(0,-1);$.push(r),S=b,b=ie({inputs:{x:b},attrs:{shape:$},backend:n}),bi(n,S);const E=N;return N=ie({inputs:{x:N},attrs:{shape:$},backend:n}),bi(n,E),[N,b]}const lue={kernelName:kg,backendName:"webgl",kernelFunc:oue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uue{constructor(e,n,s,a,r,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const o=s==="nearest"?1:2;let l;switch(a){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${r});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${r});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(t){const{inputs:e,backend:n,attrs:s}=t,{image:a,transforms:r}=e,{interpolation:i,fillMode:o,fillValue:l,outputShape:u}=s,[c,d,p,h]=a.shape,[f,g]=u??[d,p],y=[c,f,g,h],m=new uue(d,p,i,o,l,y);return n.runWebGLProgram(m,[a,r],"float32")}const due={kernelName:vg,backendName:"webgl",kernelFunc:cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(t){const{inputs:e,attrs:n,backend:s}=t,{axis:a}=n,{x:r}=e;Xp(r,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(r.dataId),{outputValues:o,outputShape:l,indices:u}=dee(i,a,r.shape,r.dtype);return[s.makeTensorInfo(l,r.dtype,o),s.makeTensorInfo([u.length],"int32",u)]}const hue={kernelName:Sg,backendName:"webgl",kernelFunc:pue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(t){const{inputs:e,backend:n,attrs:s}=t,{value:a}=e;let{axis:r}=s;r<0&&(r+=a.shape.length);const i=a,o=i.shape.length,l=a.shape[r],u=new Array(o-1);let c=0;for(let g=0;g<o;g++)g!==r&&(u[c++]=i.shape[g]);const d=[],p=new Array(o).fill(0),h=i.shape.slice();h[r]=1;const f=new Array(l);for(let g=0;g<f.length;g++){p[r]=g;const y=Mu({inputs:{x:i},backend:n,attrs:{begin:p,size:h}}),m=ie({inputs:{x:y},backend:n,attrs:{shape:u}});f[g]=m,d.push(y)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),f}const mue={kernelName:fp,backendName:"webgl",kernelFunc:fue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gue{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,a=e.batchSize,r=e.inSize,i=e.numSegments,o=i*Math.ceil(r/s);this.outputShape=[a,o];const l="0.0",u="sumValue",c=Math.floor(s/4)*4,d=s%4,p=`
        sumValue += dot(values, segFilter);
    `;let h="";r%s>0&&(h=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return initializationValue;
        }
      `);let f="";r%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${r}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${f}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(t){const{inputs:e,backend:n,attrs:s}=t,{x:a,segmentIds:r}=e,{numSegments:i}=s,o=a.shape.length,l=[];let u=0;const c=ht([u],o);let d=a;c!=null&&(d=vn({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(d),u=vt(1,o)[0]);const p=AE(d.shape,u,i),h=H([d.shape[u]]),f=ie({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(f);const g=Ig(a.dtype),y=(x,v,S,N,$)=>{const E=x.shape[0],A=x.shape[1],L=EE(A,$),W={windowSize:L,inSize:A,batchSize:E,numSegments:$},U=new gue(W,v),j=n.compileAndRun(U,[x,S],N);if(l.push(j),j.shape[1]===$)return j;const z=Q_({backend:n,attrs:{start:0,stop:$,step:1,dtype:"float32"}}),G=Z_({inputs:{x:z},backend:n,attrs:{reps:[A/L]}});return l.push(z),l.push(G),y(j,v,G,N,$)},m=y(f,"unsortedSegmentSum",r,g,i),w=ie({inputs:{x:m},backend:n,attrs:{shape:p}});let b=w;if(c!=null){l.push(w);const x=li(c);b=vn({inputs:{x:b},backend:n,attrs:{perm:x}})}return l.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}const wue={kernelName:mp,backendName:"webgl",kernelFunc:yue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bue=[nte,ate,ote,cte,pte,mte,yte,bte,Ste,Cte,Tte,Rte,Ote,Lte,Mte,Wte,Gte,Jte,Yte,Zte,sne,cne,pne,gne,wne,Nne,Ine,Ane,zee,_ne,Lne,Vne,qne,Yne,Zne,tse,sse,ose,cse,hse,mse,yse,bse,vse,Nse,Tse,Ase,_se,jse,Lse,Vse,Hse,Xse,Zse,nae,sae,rae,oae,uae,dae,hae,yae,xae,Sae,Cae,Tae,Rae,Fae,zae,Lee,Mae,jne,Uae,Kae,Xae,Mee,ere,are,ire,cre,hre,yre,xre,Nre,Tre,Rre,_re,Pre,zre,Mre,Gre,Kre,Jre,Yre,Zre,sie,oie,die,bie,Uee,Sie,Iie,Eie,Die,xne,Fie,Pie,zie,Vie,Hie,Wee,qie,Xie,Qie,eoe,toe,kne,mie,aoe,loe,poe,Hee,goe,boe,Soe,Ioe,Aoe,Doe,Foe,Loe,Moe,Uoe,Koe,Xoe,ele,sle,ole,cle,lne,yie,hle,mle,yle,ble,kle,Sle,Cle,$le,Ele,Dle,Ole,jle,Lle,Mle,Wle,Gle,Kle,gie,Zee,Xle,Zle,tue,aue,lue,due,ete,hue,mue,wue,jie];for(const t of bue)Cg(t);var wb={exports:{}};const xue=bb(t8),kue=bb(CU);/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(function(t,e){(function(n,s){s(e,xue,kue)})(Zr,function(n,s,a){const r={1:{name:"/m/01g317",id:1,displayName:"person"},2:{name:"/m/0199g",id:2,displayName:"bicycle"},3:{name:"/m/0k4j",id:3,displayName:"car"},4:{name:"/m/04_sv",id:4,displayName:"motorcycle"},5:{name:"/m/05czz6l",id:5,displayName:"airplane"},6:{name:"/m/01bjv",id:6,displayName:"bus"},7:{name:"/m/07jdr",id:7,displayName:"train"},8:{name:"/m/07r04",id:8,displayName:"truck"},9:{name:"/m/019jd",id:9,displayName:"boat"},10:{name:"/m/015qff",id:10,displayName:"traffic light"},11:{name:"/m/01pns0",id:11,displayName:"fire hydrant"},13:{name:"/m/02pv19",id:13,displayName:"stop sign"},14:{name:"/m/015qbp",id:14,displayName:"parking meter"},15:{name:"/m/0cvnqh",id:15,displayName:"bench"},16:{name:"/m/015p6",id:16,displayName:"bird"},17:{name:"/m/01yrx",id:17,displayName:"cat"},18:{name:"/m/0bt9lr",id:18,displayName:"dog"},19:{name:"/m/03k3r",id:19,displayName:"horse"},20:{name:"/m/07bgp",id:20,displayName:"sheep"},21:{name:"/m/01xq0k1",id:21,displayName:"cow"},22:{name:"/m/0bwd_0j",id:22,displayName:"elephant"},23:{name:"/m/01dws",id:23,displayName:"bear"},24:{name:"/m/0898b",id:24,displayName:"zebra"},25:{name:"/m/03bk1",id:25,displayName:"giraffe"},27:{name:"/m/01940j",id:27,displayName:"backpack"},28:{name:"/m/0hnnb",id:28,displayName:"umbrella"},31:{name:"/m/080hkjn",id:31,displayName:"handbag"},32:{name:"/m/01rkbr",id:32,displayName:"tie"},33:{name:"/m/01s55n",id:33,displayName:"suitcase"},34:{name:"/m/02wmf",id:34,displayName:"frisbee"},35:{name:"/m/071p9",id:35,displayName:"skis"},36:{name:"/m/06__v",id:36,displayName:"snowboard"},37:{name:"/m/018xm",id:37,displayName:"sports ball"},38:{name:"/m/02zt3",id:38,displayName:"kite"},39:{name:"/m/03g8mr",id:39,displayName:"baseball bat"},40:{name:"/m/03grzl",id:40,displayName:"baseball glove"},41:{name:"/m/06_fw",id:41,displayName:"skateboard"},42:{name:"/m/019w40",id:42,displayName:"surfboard"},43:{name:"/m/0dv9c",id:43,displayName:"tennis racket"},44:{name:"/m/04dr76w",id:44,displayName:"bottle"},46:{name:"/m/09tvcd",id:46,displayName:"wine glass"},47:{name:"/m/08gqpm",id:47,displayName:"cup"},48:{name:"/m/0dt3t",id:48,displayName:"fork"},49:{name:"/m/04ctx",id:49,displayName:"knife"},50:{name:"/m/0cmx8",id:50,displayName:"spoon"},51:{name:"/m/04kkgm",id:51,displayName:"bowl"},52:{name:"/m/09qck",id:52,displayName:"banana"},53:{name:"/m/014j1m",id:53,displayName:"apple"},54:{name:"/m/0l515",id:54,displayName:"sandwich"},55:{name:"/m/0cyhj_",id:55,displayName:"orange"},56:{name:"/m/0hkxq",id:56,displayName:"broccoli"},57:{name:"/m/0fj52s",id:57,displayName:"carrot"},58:{name:"/m/01b9xk",id:58,displayName:"hot dog"},59:{name:"/m/0663v",id:59,displayName:"pizza"},60:{name:"/m/0jy4k",id:60,displayName:"donut"},61:{name:"/m/0fszt",id:61,displayName:"cake"},62:{name:"/m/01mzpv",id:62,displayName:"chair"},63:{name:"/m/02crq1",id:63,displayName:"couch"},64:{name:"/m/03fp41",id:64,displayName:"potted plant"},65:{name:"/m/03ssj5",id:65,displayName:"bed"},67:{name:"/m/04bcr3",id:67,displayName:"dining table"},70:{name:"/m/09g1w",id:70,displayName:"toilet"},72:{name:"/m/07c52",id:72,displayName:"tv"},73:{name:"/m/01c648",id:73,displayName:"laptop"},74:{name:"/m/020lf",id:74,displayName:"mouse"},75:{name:"/m/0qjjc",id:75,displayName:"remote"},76:{name:"/m/01m2v",id:76,displayName:"keyboard"},77:{name:"/m/050k8",id:77,displayName:"cell phone"},78:{name:"/m/0fx9l",id:78,displayName:"microwave"},79:{name:"/m/029bxz",id:79,displayName:"oven"},80:{name:"/m/01k6s3",id:80,displayName:"toaster"},81:{name:"/m/0130jx",id:81,displayName:"sink"},82:{name:"/m/040b_t",id:82,displayName:"refrigerator"},84:{name:"/m/0bt_c3",id:84,displayName:"book"},85:{name:"/m/01x3z",id:85,displayName:"clock"},86:{name:"/m/02s195",id:86,displayName:"vase"},87:{name:"/m/01lsmm",id:87,displayName:"scissors"},88:{name:"/m/0kmg4",id:88,displayName:"teddy bear"},89:{name:"/m/03wvsk",id:89,displayName:"hair drier"},90:{name:"/m/012xff",id:90,displayName:"toothbrush"}};class i{constructor(l,u){this.modelPath=u||`https://storage.googleapis.com/tfjs-models/savedmodel/${this.getPrefix(l)}/model.json`}getPrefix(l){return l==="lite_mobilenet_v2"?`ssd${l}`:`ssd_${l}`}async load(){this.model=await s.loadGraphModel(this.modelPath);const l=a.zeros([1,300,300,3],"int32"),u=await this.model.executeAsync(l);await Promise.all(u.map(c=>c.data())),u.map(c=>c.dispose()),l.dispose()}async infer(l,u,c){const d=a.tidy(()=>(l instanceof a.Tensor||(l=a.browser.fromPixels(l)),a.expandDims(l))),p=d.shape[1],h=d.shape[2],f=await this.model.executeAsync(d),g=f[0].dataSync(),y=f[1].dataSync();d.dispose(),a.dispose(f);const[m,w]=this.calculateMaxScores(g,f[0].shape[1],f[0].shape[2]),b=a.getBackend();a.getBackend()==="webgl"&&a.setBackend("cpu");const x=a.tidy(()=>{const S=a.tensor2d(y,[f[1].shape[1],f[1].shape[3]]);return a.image.nonMaxSuppression(S,m,u,c,c)}),v=x.dataSync();return x.dispose(),b!==a.getBackend()&&a.setBackend(b),this.buildDetectedObjects(h,p,y,m,v,w)}buildDetectedObjects(l,u,c,d,p,h){const f=p.length,g=[];for(let y=0;y<f;y++){const m=[];for(let S=0;S<4;S++)m[S]=c[4*p[y]+S];const w=m[0]*u,b=m[1]*l,x=m[2]*u,v=m[3]*l;m[0]=b,m[1]=w,m[2]=v-b,m[3]=x-w,g.push({bbox:m,class:r[h[p[y]]+1].displayName,score:d[p[y]]})}return g}calculateMaxScores(l,u,c){const d=[],p=[];for(let h=0;h<u;h++){let f=Number.MIN_VALUE,g=-1;for(let y=0;y<c;y++)l[h*c+y]>f&&(f=l[h*c+y],g=y);d[h]=f,p[h]=g}return[d,p]}async detect(l,u=20,c=.5){return this.infer(l,u,c)}dispose(){this.model!=null&&this.model.dispose()}}n.ObjectDetection=i,n.load=async function(o={}){if(a==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");const l=o.base||"lite_mobilenet_v2",u=o.modelUrl;if(["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(l)===-1)throw new Error(`ObjectDetection constructed with invalid base model ${l}. Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.`);const c=new i(l,u);return await c.load(),c},n.version="2.2.3",Object.defineProperty(n,"__esModule",{value:!0})})})(wb,wb.exports);var vue=wb.exports;let dc=null;const Sue=async()=>dc||(await C$(),dc=await vue.load({base:"mobilenet_v2"}),dc),Nue=()=>dc,eO={person:"",bicycle:"",car:"",motorcycle:"",airplane:"",bus:"",train:"",truck:"",boat:"","traffic light":"","fire hydrant":"","stop sign":"","parking meter":"",bench:"",bird:"",cat:"",dog:"",horse:"",sheep:"",cow:"",elephant:"",bear:"",zebra:"",giraffe:"",backpack:"",umbrella:"",handbag:"",tie:"",suitcase:"",frisbee:"",skis:"",snowboard:"","sports ball":"",kite:"","baseball bat":"","baseball glove":"",skateboard:"",surfboard:"","tennis racket":"",bottle:"","wine glass":"",cup:"",fork:"",knife:"",spoon:"",bowl:"",banana:"",apple:"",sandwich:"",orange:"",broccoli:"",carrot:"","hot dog":"",pizza:"",donut:"",cake:"",chair:"",couch:"","potted plant":"",bed:"","dining table":"",toilet:"",tv:"",laptop:"",mouse:"",remote:"",keyboard:"","cell phone":"",microwave:"",oven:"",toaster:"",sink:"",refrigerator:"",book:"",clock:"",vase:"",scissors:"","teddy bear":"","hair drier":"",toothbrush:""},Cue=(t,e=eO)=>e[t]||t,tO=async t=>{const e=Nue();if(!e)throw new Error("Model not loaded");try{return(await e.detect(t)).map(s=>({bbox:s.bbox,class:Cue(s.class),score:s.score}))}catch(n){return console.error("Detection error:",n),[]}},Zf=(t,e,n=null)=>{t.clearRect(0,0,t.canvas.width,t.canvas.height),(n?e.filter(a=>a.class===n):e).forEach(a=>{const[r,i,o,l]=a.bbox,u=Math.round(a.score*100);let c="#FF3B30";a.score>.5&&(c="#FFCC00"),a.score>.7&&(c="#34C759"),t.strokeStyle=c,t.lineWidth=2;const d=Math.max(0,Math.min(r,t.canvas.width-2)),p=Math.max(0,Math.min(i,t.canvas.height-2)),h=Math.min(o,t.canvas.width-d-2),f=Math.min(l,t.canvas.height-p-2);t.strokeRect(d,p,h,f),t.fillStyle=`${c}DD`,t.font="14px Arial";const g=t.measureText(`${a.class} ${u}%`),y=20,m=d,w=Math.max(y,p);t.fillRect(m,w-y,g.width+10,y),t.fillStyle="#FFFFFF",t.fillText(`${a.class} ${u}%`,m+5,w-5)})},Iue=t=>t>.7?"text-green-500 dark:text-green-400":t>.5?"text-yellow-500 dark:text-yellow-400":"text-red-500 dark:text-red-400",$ue=({onResults:t,modelLoaded:e,filteredClass:n,onWebcamStateChange:s})=>{const a=X.useRef(null),r=X.useRef(null),[i,o]=X.useState(!1),[l,u]=X.useState(!1),[c,d]=X.useState(null),[p,h]=X.useState([]),f=X.useRef(null),g=X.useRef(null),[y,m]=X.useState(!1);X.useEffect(()=>{const S=()=>{m(window.innerWidth<=768)};return S(),window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[]);const w=async()=>{var S;if(!((S=navigator.mediaDevices)!=null&&S.getUserMedia)){d("Browser Anda tidak mendukung akses webcam");return}try{d(null);const N={video:{facingMode:"environment",aspectRatio:y?3/4:16/9}},$=await navigator.mediaDevices.getUserMedia(N);a.current&&(a.current.srcObject=$,await a.current.play(),u(!0),s==null||s(!0))}catch(N){console.error("Error accessing webcam:",N),d("Tidak dapat mengakses kamera. Pastikan Anda telah memberikan izin untuk mengakses kamera.")}},b=()=>{a.current&&a.current.srcObject&&(a.current.srcObject.getTracks().forEach($=>$.stop()),a.current.srcObject=null,u(!1),s==null||s(!1),f.current!==null&&(clearInterval(f.current),f.current=null),o(!1),t([]),h([]))},x=async()=>{if(!a.current||!r.current||!e)return;const S=a.current,N=r.current,$=N.getContext("2d");if(!(!$||S.paused||S.ended))try{(N.width!==S.videoWidth||N.height!==S.videoHeight)&&(N.width=S.videoWidth,N.height=S.videoHeight);const E=await tO(S);h(E),t(E),Zf($,E,n)}catch(E){console.error("Detection error:",E)}},v=()=>{a.current&&r.current&&(r.current.width=a.current.videoWidth,r.current.height=a.current.videoHeight)};return X.useEffect(()=>{if(r.current&&p.length>0){const S=r.current.getContext("2d");S&&Zf(S,p,n)}},[n,p]),X.useEffect(()=>()=>{f.current!==null&&clearInterval(f.current),b()},[]),X.useEffect(()=>{l&&e&&!i&&(o(!0),x(),f.current=window.setInterval(x,y?41.67:100))},[l,e,y]),T.jsxs("div",{className:"relative flex-1 flex flex-col bg-black rounded-2xl overflow-hidden",children:[!l&&!c&&T.jsxs("div",{className:`absolute inset-0 flex items-center justify-center flex-col p-6 z-10 bg-surface-50 ${y?"aspect-[3/4]":""}`,children:[T.jsx(qI,{size:48,className:"text-surface-400 mb-4"}),T.jsx("h3",{className:"text-lg font-medium mb-2 text-surface-900",children:"Akses Kamera Diperlukan"}),T.jsx("p",{className:"text-surface-600 text-center mb-4",children:"Klik tombol di bawah untuk mengaktifkan kamera Anda untuk deteksi objek secara langsung"}),T.jsx("button",{onClick:w,disabled:!e,className:"neu-button text-primary-600 font-medium",children:"Aktifkan Kamera"})]}),c&&T.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col p-6 z-10 bg-surface-50",children:[T.jsx(KI,{size:48,className:"text-accent-500 mb-4"}),T.jsx("h3",{className:"text-lg font-medium text-surface-800 mb-2",children:"Error Kamera"}),T.jsx("p",{className:"text-surface-600 text-center mb-4",children:c}),T.jsx("button",{onClick:()=>window.location.reload(),className:"neu-button text-primary-600 font-medium",children:"Ulangi"})]}),T.jsxs("div",{ref:g,className:`relative flex-1 flex items-center justify-center ${y?"aspect-[3/4]":"aspect-[16/9]"}`,children:[T.jsx("video",{ref:a,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0,onLoadedMetadata:v}),T.jsx("canvas",{ref:r,className:"absolute top-0 left-0 w-full h-full"}),l&&y&&T.jsx("button",{onClick:b,className:"absolute top-4 right-4 p-2 bg-surface-800/70 text-white rounded-full hover:bg-surface-700 transition-colors","aria-label":"Stop camera",children:T.jsx(kc,{size:20})})]}),l&&!y&&T.jsxs("div",{className:"p-4 flex flex-col sm:flex-row sm:justify-between gap-4 bg-surface-50",children:[T.jsx("div",{className:"text-sm flex items-center justify-center sm:justify-start",children:i?T.jsxs("span",{className:"flex items-center text-primary-600",children:[T.jsx("span",{className:"inline-block w-2 h-2 bg-primary-500 rounded-full mr-2 animate-pulse"}),"Deteksi aktif"]}):T.jsx("span",{className:"text-surface-600",children:"Deteksi berhenti"})}),T.jsx("div",{className:"grid grid-cols-2 sm:flex gap-2",children:T.jsx("button",{onClick:b,className:"neu-button flex-1 sm:flex-initial min-w-[120px] text-accent-600",children:"Hentikan Kamera"})})]})]})},Tue=({onResults:t,modelLoaded:e,filteredClass:n})=>{const[s,a]=X.useState(null),[r,i]=X.useState(!1),[o,l]=X.useState(!1),[u,c]=X.useState(null),[d,p]=X.useState([]),[h,f]=X.useState(!1),g=X.useRef(null),y=X.useRef(null),m=X.useRef(null),w=X.useRef(null),b=X.useRef(0),[x,v]=X.useState(!1);X.useEffect(()=>{const j=()=>{f(window.innerWidth<=768)};return j(),window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[]);const S=j=>{if(!j.type.startsWith("image/")){c("Please upload an image file (JPEG, PNG, etc.)");return}c(null),p([]),t([]),i(!1);const z=new FileReader;z.onload=G=>{var J;(J=G.target)!=null&&J.result&&a(G.target.result)},z.onerror=()=>{c("Failed to read the image file")},z.readAsDataURL(j)},N=j=>{const z=j.target.files;z&&z.length>0&&S(z[0])},$=j=>{j.preventDefault(),j.stopPropagation(),b.current++,j.dataTransfer.items&&j.dataTransfer.items.length>0&&v(!0)},E=j=>{j.preventDefault(),j.stopPropagation(),b.current--,b.current===0&&v(!1)},A=j=>{j.preventDefault(),j.stopPropagation()},L=j=>{j.preventDefault(),j.stopPropagation(),v(!1),b.current=0;const z=j.dataTransfer.files;z&&z.length>0&&(S(z[0]),j.dataTransfer.clearData())},W=()=>{if(a(null),i(!1),p([]),t([]),c(null),g.current&&(g.current.value=""),m.current){const j=m.current.getContext("2d");j==null||j.clearRect(0,0,m.current.width,m.current.height)}},U=async()=>{if(!y.current||!m.current||!e||!s||!r){console.log("processImage: Aborting, conditions not met",{modelLoaded:e,imageUrl:s,isImageLoaded:r,imageRef:!!y.current,canvasRef:!!m.current});return}if(!o){l(!0),console.log("processImage: Starting");try{const j=y.current,z=m.current,G=w.current;if(!G){console.warn("processImage: Referensi kontainer tidak ditemukan."),l(!1);return}if(j.naturalWidth===0||j.naturalHeight===0){console.warn("processImage: Dimensi gambar alami adalah nol. Gambar mungkin tidak dimuat secara penuh atau rusak."),l(!1);return}const J=G.getBoundingClientRect();if(J.width===0||J.height===0){console.warn("processImage: Dimensi kontainer adalah nol. Tidak dapat mengubah ukuran gambar untuk canvas."),l(!1);return}const O=Math.min(J.width/j.naturalWidth,J.height/j.naturalHeight);if(z.width=j.naturalWidth*O,z.height=j.naturalHeight*O,z.width===0||z.height===0){console.warn("processImage: Dimensi canvas yang dihitung adalah nol. Melewati deteksi."),l(!1);return}const M=z.getContext("2d");if(!M){console.warn("processImage: Tidak dapat mendapatkan konteks 2D dari canvas."),l(!1);return}const K=await tO(j);console.log("processImage: Detection results:",K),p(K),t(K);const Y=K.map(Q=>({...Q,bbox:[Q.bbox[0]*O,Q.bbox[1]*O,Q.bbox[2]*O,Q.bbox[3]*O]}));Zf(M,Y,n)}catch(j){console.error("Error deteksi dalam processImage:",j),c("Error deteksi objek dalam gambar")}finally{l(!1),console.log("processImage: Selesai")}}};return X.useEffect(()=>{s&&r&&e?(console.log("useEffect [imageUrl, isImageLoaded, modelLoaded]: Semua kondisi terpenuhi, memanggil processImage."),U()):console.log("useEffect [imageUrl, isImageLoaded, modelLoaded]: Kondisi tidak terpenuhi.",{imageUrl:!!s,isImageLoaded:r,modelLoaded:e})},[s,r,e]),X.useEffect(()=>{if(m.current&&d.length>0&&s&&r){console.log("useEffect [filteredClass, detections, imageUrl, isImageLoaded, isMobile]: Menggambar ulang untuk perubahan filter.");const j=y.current,z=m.current,G=z.getContext("2d"),J=w.current;if(G&&j&&J&&j.naturalWidth>0&&j.naturalHeight>0){const O=J.getBoundingClientRect();if(O.width===0||O.height===0)return;const M=Math.min(O.width/j.naturalWidth,O.height/j.naturalHeight);if(z.width=j.naturalWidth*M,z.height=j.naturalHeight*M,z.width===0||z.height===0)return;const K=d.map(Y=>({...Y,bbox:[Y.bbox[0]*M,Y.bbox[1]*M,Y.bbox[2]*M,Y.bbox[3]*M]}));Zf(G,K,n)}}},[n,d,s,r,h]),X.useEffect(()=>{const j=()=>{s&&r&&e&&(console.log("handleResize: Kondisi terpenuhi, memanggil processImage setelah delay."),setTimeout(()=>U(),100))};return window.addEventListener("resize",j),()=>window.removeEventListener("resize",j)},[s,r,e]),T.jsxs("div",{className:"relative flex-1 flex flex-col bg-black rounded-2xl overflow-hidden",onDragEnter:$,onDragLeave:E,onDragOver:A,onDrop:L,children:[s?T.jsxs(T.Fragment,{children:[T.jsxs("div",{ref:w,className:`relative flex-1 flex items-center justify-center ${h?"aspect-[3/4]":"aspect-[16/9]"}`,children:[T.jsx("img",{ref:y,src:s,alt:"Unggah",className:"max-w-full max-h-full object-contain",onLoad:()=>{console.log("img.onLoad: Gambar telah dimuat."),i(!0)},onError:()=>{console.error("img.onError: Gagal memuat gambar."),c("Gagal memuat gambar. Gambar mungkin rusak atau format tidak didukung."),i(!1)}}),T.jsx("canvas",{ref:m,className:"absolute top-0 left-0 w-full h-full"}),o&&T.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:T.jsx("div",{className:"inline-block w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})}),h&&T.jsx("button",{onClick:W,className:"absolute top-4 right-4 p-2 bg-surface-800/70 text-white rounded-full hover:bg-surface-700 transition-colors z-10","aria-label":"Clear image",children:T.jsx(kc,{size:20})})]}),T.jsx("div",{className:"p-4 bg-surface-50 flex flex-col sm:flex-row gap-2 justify-center",children:T.jsxs("button",{onClick:W,className:"neu-button text-accent-600 flex-1 sm:flex-initial min-w-[120px] inline-flex items-center justify-center",children:[T.jsx(kc,{size:18,className:"mr-2"}),"Hapus gambar"]})})]}):T.jsxs("div",{className:`relative flex-1 flex flex-col items-center justify-center p-6 bg-surface-50 transition-all duration-300 ${h?"aspect-[3/4]":"aspect-[16/9]"} ${x?"ring-4 ring-primary-500 bg-primary-50 scale-[0.99]":""}`,children:[T.jsx("input",{type:"file",ref:g,onChange:N,accept:"image/*",className:"hidden"}),x?T.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-primary-50/70 backdrop-blur-sm animate-pulse",children:[T.jsx(kw,{size:64,className:"text-primary-600 mb-4 animate-bounce"}),T.jsx("h3",{className:"text-xl font-medium text-primary-700",children:"Letakkan gambar di sini"})]}):T.jsxs(T.Fragment,{children:[T.jsx(zj,{size:48,className:"text-surface-400 mb-4"}),T.jsx("h3",{className:"text-lg font-medium mb-2 text-surface-900",children:"Unggah gambar"}),T.jsx("p",{className:"text-surface-600 text-center mb-4",children:"Tarik dan lepas gambar di sini, atau klik tombol di bawah untuk memilih satu"}),T.jsxs("button",{onClick:()=>{var j;return(j=g.current)==null?void 0:j.click()},disabled:!e,className:"neu-button text-primary-600 font-medium inline-flex items-center",children:[T.jsx(kw,{size:18,className:"mr-2"}),"Pilih gambar"]})]})]}),u&&T.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col p-6 z-20 bg-surface-50",children:[T.jsx(kc,{size:32,className:"text-accent-500 mb-4"}),T.jsx("h3",{className:"text-lg font-medium text-surface-800 mb-2",children:"Error"}),T.jsx("p",{className:"text-surface-600 text-center mb-4",children:u}),T.jsx("button",{onClick:W,className:"neu-button text-primary-600 font-medium",children:"Tutup"})]})]})},Eue=({results:t,onFilterChange:e,filteredClass:n})=>{const[s,a]=X.useState("confidence"),[r,i]=X.useState("desc"),o=X.useMemo(()=>{const d=new Set(t.map(p=>p.class));return Array.from(d)},[t]),l=d=>{s===d?i(r==="asc"?"desc":"asc"):(a(d),i(d==="confidence"?"desc":"asc"))},u=X.useMemo(()=>[...t].sort((d,p)=>s==="confidence"?r==="asc"?d.score-p.score:p.score-d.score:r==="asc"?d.class.localeCompare(p.class):p.class.localeCompare(d.class)),[t,s,r]),c=X.useMemo(()=>{const d={};return t.forEach(p=>{d[p.class]=(d[p.class]||0)+1}),d},[t]);return T.jsxs("div",{className:"h-full flex flex-col bg-surface-50 rounded-2xl shadow-neu",children:[T.jsxs("div",{className:"p-4 border-b border-surface-200",children:[T.jsx("h2",{className:"text-lg font-semibold mb-1 text-surface-900",children:"Hasil Deteksi"}),T.jsx("p",{className:"text-sm text-surface-600",children:t.length===0?"Tidak ada objek yang terdeteksi":`${t.length} objek${t.length!==1?"s":""} ditemukan`})]}),t.length>0&&T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"p-4 border-b border-surface-200 bg-surface-100",children:[T.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center text-surface-800",children:[T.jsx(O2,{size:16,className:"mr-1"}),"Filter berdasarkan Kelompok"]}),T.jsxs("div",{className:"flex flex-wrap gap-2",children:[T.jsxs("button",{onClick:()=>e(null),className:`px-2 py-1 text-xs rounded-full transition-colors ${n===null?"bg-primary-500 text-white":"bg-surface-200 hover:bg-surface-300"}`,children:["Semua (",t.length,")"]}),o.map(d=>T.jsxs("button",{onClick:()=>e(d),className:`px-2 py-1 text-xs rounded-full transition-colors ${n===d?"bg-primary-500 text-white":"bg-surface-200 hover:bg-surface-300"}`,children:[d," (",c[d],")"]},d))]})]}),T.jsx("div",{className:"p-2 border-b border-surface-200",children:T.jsxs("div",{className:"flex items-center text-sm font-medium text-surface-600 px-2",children:[T.jsxs("button",{onClick:()=>l("class"),className:"flex items-center flex-1",children:["Kelompok",s==="class"&&T.jsx(_2,{size:14,className:"ml-1"})]}),T.jsxs("button",{onClick:()=>l("confidence"),className:"flex items-center w-24 justify-end",children:["Kemiripan",s==="confidence"&&T.jsx(_2,{size:14,className:"ml-1"})]})]})}),T.jsx("div",{className:"flex-1 overflow-y-auto",children:u.filter(d=>n===null||d.class===n).map((d,p)=>T.jsxs(Ys,{to:`/benda/${d.class}`,state:{from:"detection"},className:`group bg-white/50 rounded-xl overflow-hidden transition-all duration-300\r
                           hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                           active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                           border border-white/30 p-3`,children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center",children:[T.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-500 mr-2"}),T.jsxs("span",{className:"font-medium capitalize text-surface-900",children:[d.class,Ki[d.class]&&` (${Ki[d.class].indonesian})`]})]}),T.jsxs("div",{className:`font-medium ${Iue(d.score)} mr-4`,children:[Math.round(d.score*100),"%"]})]}),T.jsxs("div",{className:"mt-1 text-xs text-surface-600 ml-4",children:["Position: x:",Math.round(d.bbox[0]),", y:",Math.round(d.bbox[1])]})]},p))})]}),t.length===0&&T.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:T.jsxs("div",{className:"text-center",children:[T.jsx(O2,{size:24,className:"mx-auto mb-2 text-surface-400"}),T.jsx("p",{className:"text-surface-600",children:"Tidak ada objek yang terdeteksi. Cobalah arahkan kamera ke objek yang berbeda atau unggah gambar."})]})})]})},Aue=({results:t,filteredClass:e})=>{const[n,s]=X.useState(!1);return WI(),X.useEffect(()=>{console.log("MobileResultsView received results:",t)},[t]),t.length===0?null:T.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 p-4",children:T.jsxs("div",{className:`glass-panel overflow-hidden transition-all duration-300 ease-in-out ${n?"max-h-[70vh]":"max-h-[120px]"}`,children:[T.jsxs("button",{onClick:()=>s(!n),className:"w-full p-4 flex items-center justify-between bg-gradient-to-b from-primary-500/10 to-transparent",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("div",{className:"flex -space-x-1",children:t.slice(0,3).map((a,r)=>T.jsx("div",{className:`w-2 h-2 rounded-full ring-2 ring-white ${a.score>.7?"bg-green-500":a.score>.5?"bg-yellow-500":"bg-red-500"}`},r))}),T.jsxs("span",{className:"font-medium text-surface-800",children:[t.length," Detection",t.length!==1?"s":""]})]}),n?T.jsx(Fj,{size:20,className:"text-surface-600"}):T.jsx(Lj,{size:20,className:"text-surface-600"})]}),T.jsx("div",{className:"divide-y divide-white/10",children:t.filter(a=>e===null||a.class===e).map((a,r)=>T.jsx(Ys,{to:`/benda/${a.class}`,state:{from:"detection"},className:`group bg-white/50 rounded-xl overflow-hidden transition-all duration-300\r
                       hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                       active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                       border border-white/30`,children:T.jsxs("div",{className:"flex items-center justify-between ml-4",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${a.score>.7?"bg-green-500 shadow-lg shadow-green-500/20":a.score>.5?"bg-yellow-500 shadow-lg shadow-yellow-500/20":"bg-red-500 shadow-lg shadow-red-500/20"}`}),T.jsxs("span",{className:"font-medium capitalize text-surface-800",children:[a.class,Ki[a.class]&&` (${Ki[a.class].indonesian})`]})]}),T.jsxs("div",{className:`px-2 py-1 rounded-full text-sm font-semibold ${a.score>.7?"bg-green-50 text-green-700":a.score>.5?"bg-yellow-50 text-yellow-700":"bg-red-50 text-red-700"} mr-3`,children:[Math.round(a.score*100),"%"]})]})},r))})]})})},Rue=()=>{const[t,e]=X.useState("webcam"),[n,s]=X.useState(!1),[a,r]=X.useState(!0),[i,o]=X.useState(null),[l,u]=X.useState([]),[c,d]=X.useState(null),[p,h]=X.useState(!1),[f,g]=X.useState(!1);X.useEffect(()=>{e("webcam"),u([]),d(null),g(!1),r(!0),o(null)},[]),X.useEffect(()=>{const x=()=>{h(window.innerWidth<=1024)};return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),X.useEffect(()=>{(async()=>{try{r(!0),await Sue(),s(!0),o(null)}catch(v){console.error("Failed to load model:",v),o("Gagal memuat model deteksi. Silakan periksa koneksi Anda dan coba lagi.")}finally{r(!1)}})()},[]);const y=x=>{u(x)},m=x=>{e(x),u([]),g(!1)},w=x=>{d(x)},b=x=>{g(x)};return T.jsxs("main",{className:"container mx-auto px-4 py-8 flex flex-col lg:flex-row gap-8",children:[T.jsxs("div",{className:`${p?"w-full":"lg:w-2/3"} flex flex-col gap-6`,children:[T.jsx("div",{className:"flex justify-between items-center",children:T.jsx(Yj,{mode:t,onModeChange:m,modelLoaded:n})}),i&&T.jsxs("div",{className:"flex items-center gap-2 text-red-600 bg-red-50 p-4 rounded-xl",children:[T.jsx(KI,{size:20}),T.jsx("p",{children:i})]}),a?T.jsxs("div",{className:"flex flex-col items-center justify-center h-64 bg-white/50 rounded-xl gap-4",children:[T.jsx(Bj,{className:"w-8 h-8 text-primary-600 animate-spin"}),T.jsx("p",{className:"text-surface-600",children:"Model AI sedang dimuat..."})]}):T.jsx(T.Fragment,{children:t==="webcam"?T.jsx($ue,{onResults:y,modelLoaded:n,filteredClass:c,onWebcamStateChange:b}):T.jsx(Tue,{onResults:y,modelLoaded:n,filteredClass:c})})]}),!p&&T.jsx("div",{className:"lg:w-1/3",children:T.jsx(Eue,{results:l,onFilterChange:w,filteredClass:c})}),p&&l.length>0&&T.jsx(Aue,{results:l,onFilterChange:w,filteredClass:c})]})},Due=()=>{const[t,e]=X.useState(1),n=12,s=Math.ceil(vw.length/n);X.useEffect(()=>{window.scrollTo(0,0)},[]);const a=vw.slice((t-1)*n,t*n);return T.jsx("main",{className:"container mx-auto px-4 py-8",children:T.jsxs("div",{className:"backdrop-blur-lg bg-white/30 rounded-2xl p-6 shadow-lg border border-white/20",children:[T.jsxs("div",{className:"flex justify-between items-center mb-6",children:[T.jsxs("div",{className:"flex items-center gap-4",children:[T.jsx("h2",{className:"hidden md:block text-2xl font-bold text-surface-900",children:"Belajar Bersama"}),T.jsx("img",{src:"https://wkwk-japanese.com/wp-content/uploads/2022/12/logo_wkwkjapanese.png",alt:"WKWK Japanese Logo",className:"h-8 w-auto"}),T.jsx("span",{className:"hidden md:block text-lg font-medium text-surface-900",children:"WKWK JAPANESE"})]}),T.jsx(Ys,{to:"/",className:`px-4 py-2 bg-white/50 rounded-xl border border-white/30\r
                     hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                     active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                     transition-all duration-300 text-surface-900 font-medium`,children:"Kembali ke Beranda"})]}),T.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map((r,i)=>T.jsxs("a",{href:r.link,target:"_blank",rel:"noopener noreferrer",className:`group bg-white/50 rounded-xl overflow-hidden transition-all duration-300\r
                       hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                       active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                       border border-white/30`,children:[T.jsx("div",{className:"aspect-video overflow-hidden",children:T.jsx("img",{src:r.img,alt:r.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"})}),T.jsxs("div",{className:"p-4",children:[T.jsx("h3",{className:"text-lg font-semibold text-surface-900 mb-2 line-clamp-2",children:r.title}),T.jsx("p",{className:"text-surface-500 text-sm",children:new Date(r.date).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})})]})]},i))}),T.jsxs("div",{className:"mt-8 flex justify-center gap-2",children:[T.jsxs("button",{onClick:()=>e(r=>Math.max(r-1,1)),disabled:t===1,className:`px-4 py-2 bg-white/50 rounded-xl border border-white/30\r
                     hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                     active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                     transition-all duration-300 text-surface-900 font-medium\r
                     disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-none disabled:hover:translate-y-0\r
                     flex items-center gap-2`,children:[T.jsx(jj,{className:"w-5 h-5"}),T.jsx("span",{className:"hidden md:inline",children:"Sebelumnya"})]}),T.jsxs("span",{className:"px-4 py-2 bg-white/50 rounded-xl border border-white/30 text-surface-900",children:["Halaman ",t," dari ",s]}),T.jsxs("button",{onClick:()=>e(r=>Math.min(r+1,s)),disabled:t===s,className:`px-4 py-2 bg-white/50 rounded-xl border border-white/30\r
                     hover:shadow-[0_8px_30px_rgba(0,0,0,0.12)] hover:-translate-y-1\r
                     active:shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] active:translate-y-0\r
                     transition-all duration-300 text-surface-900 font-medium\r
                     disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-none disabled:hover:translate-y-0\r
                     flex items-center gap-2`,children:[T.jsx("span",{className:"hidden md:inline",children:"Selanjutnya"}),T.jsx(Pj,{className:"w-5 h-5"})]})]})]})})},_ue=Object.entries(eO).reduce((t,[e,n])=>(t[n]=e,t),{}),Oue=t=>{const e=Ki[t];if(e)return e;const n=_ue[t];return n&&Ki[n]||null},Fue=()=>{var u;const{id:t}=oj(),e=ai(),n=t?Oue(t):null,[s,a]=X.useState(!1),[r,i]=X.useState(null);X.useEffect(()=>{window.scrollTo(0,0)},[t]);const o=((u=e.state)==null?void 0:u.from)==="detection",l=(c,d)=>{if("speechSynthesis"in window){window.speechSynthesis.cancel();const p=new SpeechSynthesisUtterance(c);p.lang="ja-JP",p.onend=()=>{a(!1),i(null)},p.onerror=()=>{a(!1),i(null),console.error("SpeechSynthesisUtterance.onerror")},a(!0),typeof d=="number"&&i(d),window.speechSynthesis.speak(p)}else console.warn("Speech Synthesis not supported in this browser.")};return n?T.jsx("div",{className:"min-h-screen bg-surface-50 p-4 pb-20",children:T.jsxs("div",{className:"container mx-auto max-w-3xl",children:[T.jsxs(Ys,{to:o?"/deteksi-benda":"/",className:"inline-flex items-center text-primary-600 hover:text-primary-700 neu-button",children:[T.jsx(D2,{size:20,className:"mr-2"}),o?"Kembali ke Deteksi":"Kembali ke Beranda"]}),T.jsxs("div",{className:"mt-8 neu-card",children:[T.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[T.jsxs("h1",{className:"text-3xl font-bold text-surface-900",children:[n.japanese," (",n.indonesian,")"]}),T.jsx("button",{onClick:()=>l(n.japanese),disabled:s&&r===null,className:`p-2 rounded-full transition-all ${s&&r===null?"bg-primary-100 text-primary-600 shadow-inner":"bg-surface-100 hover:bg-surface-200 text-surface-600 hover:text-primary-600"}`,"aria-label":"Putar pelafalan",children:T.jsx(F2,{size:18,className:s&&r===null?"animate-pulse":""})})]}),T.jsx("p",{className:"text-xl text-primary-600 font-medium mb-8",children:n.romaji}),T.jsx("div",{className:"relative rounded-2xl overflow-hidden mb-8 shadow-lg",children:T.jsx("img",{src:n.imageUrl,alt:n.japanese,className:"w-full aspect-video object-cover"})}),T.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[T.jsxs("section",{children:[T.jsx("h2",{className:"text-xl font-semibold text-surface-900 mb-4",children:"Contoh Kalimat"}),T.jsx("div",{className:"space-y-4",children:n.sentences.map((c,d)=>T.jsx("div",{className:"bg-surface-100 rounded-xl p-4 hover:bg-surface-200/50 transition-colors",children:T.jsxs("div",{className:"flex items-start gap-3",children:[T.jsxs("div",{className:"flex-1",children:[T.jsx("p",{className:"text-lg text-surface-900 mb-2 leading-relaxed",children:c.japanese}),T.jsx("p",{className:"text-primary-600 text-sm mb-1.5",children:c.romaji}),T.jsx("p",{className:"text-surface-600 text-sm",children:c.indonesian})]}),T.jsx("button",{onClick:()=>l(c.japanese,d),disabled:s&&r!==d,className:`p-2 rounded-full transition-all flex-shrink-0 ${r===d?"bg-primary-100 text-primary-600 shadow-inner":"bg-surface-50 hover:bg-surface-200 text-surface-600 hover:text-primary-600"}`,"aria-label":"Putar pelafalan kalimat",children:T.jsx(F2,{size:18,className:r===d?"animate-pulse":""})})]})},d))})]}),T.jsxs("section",{children:[T.jsx("h2",{className:"text-xl font-semibold text-surface-900 mb-4",children:"Informasi Tambahan"}),T.jsx("div",{className:"bg-surface-100 rounded-xl p-6",children:T.jsx("p",{className:"text-surface-600 leading-relaxed",children:n.description})})]})]})]})]})}):T.jsx("div",{className:"min-h-screen bg-surface-50 p-4",children:T.jsxs("div",{className:"container mx-auto",children:[T.jsxs(Ys,{to:o?"/deteksi-benda":"/",className:"inline-flex items-center text-primary-600 hover:text-primary-700 neu-button",children:[T.jsx(D2,{size:20,className:"mr-2"}),o?"Kembali ke Deteksi":"Kembali ke Beranda"]}),T.jsx("div",{className:"mt-8 text-center",children:T.jsx("p",{className:"text-surface-600",children:"Detail objek tidak ditemukan."})})]})})},jue=()=>T.jsx(Hj,{children:T.jsxs(vj,{children:[T.jsx(_o,{path:"/",element:T.jsx(Jj,{})}),T.jsx(_o,{path:"/tentang",element:T.jsx(Xj,{})}),T.jsx(_o,{path:"/deteksi-benda",element:T.jsx(Rue,{})}),T.jsx(_o,{path:"/artikel",element:T.jsx(Due,{})}),T.jsx(_o,{path:"/benda/:id",element:T.jsx(Fue,{})})]})});FI(document.getElementById("root")).render(T.jsx(X.StrictMode,{children:T.jsx(Ej,{children:T.jsx(jue,{})})}));
//# sourceMappingURL=index-ajlcuY9j.js.map
